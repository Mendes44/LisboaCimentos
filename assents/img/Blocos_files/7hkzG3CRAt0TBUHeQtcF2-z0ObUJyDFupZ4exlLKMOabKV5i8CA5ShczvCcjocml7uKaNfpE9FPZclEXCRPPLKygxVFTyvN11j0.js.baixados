;/*FB_PKG_DELIM*/

__d("AutoplayRulesEngine",[],(function(a,b,c,d,e,f){"use strict";var g=-2,h=-1;a=function(){function a(a){this.$1=g,this.$2=a}var b=a.prototype;b.evaluateAutoplay=function(a,b){b=b();var c=h;if(a)for(var d=0;d<this.$2.length;d++){var e=this.$2[d](a);if(e!=="SKIP"){b=e;c=d;break}}this.$1=c;return b};b.getIndexOfLastWinningRule=function(){return this.$1};b.getRules=function(){return this.$2};return a}();f["default"]=a}),66);
__d("CVCv3DisabledPlayerOrigins",[],(function(a,b,c,d,e,f){a=Object.freeze({BEEPER:"beeper",FB_STORIES:"fb_stories"});f["default"]=a}),66);
__d("CVCv3DisabledPlayerSubOrigins",[],(function(a,b,c,d,e,f){a=Object.freeze({LIVE_BEEPER:"live_beeper"});f["default"]=a}),66);
__d("CvcV3HttpEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1856513");b=d("FalcoLoggerInternal").create("cvc_v3_http_event",a);e=b;g["default"]=e}),98);
__d("CVCv3SubscriptionHelper",["CvcV3HttpEventFalcoEvent","DateConsts","guid"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d){this.$1=a;this.$2=c("guid")();this.$3=((a=b)!=null?a:"null")+"::"+((b=d)!=null?b:"null");this.$4=null;this.$5=null}var b=a.prototype;b.isValidSubscription=function(){return!!this.$1};b.makeCVCv3StateUpdate=function(a,b,c,e){var f=null;a!=null&&!Number.isNaN(a)&&b!=null&&!Number.isNaN(b)&&(f={m:e,pf:Math.floor((b-a)*d("DateConsts").MS_PER_SEC),s:c,sa:Math.floor(a*d("DateConsts").MS_PER_SEC)});e={pps:this.$4,ps:f,si:this.$2,so:this.$3,vi:this.$1};this.$4=f;return e};b.makeUnifiedVideoCVCUpdate=function(a,b,c,d,e){a=this.makeCVCv3StateUpdate(a,b,c,d);this.$5!=null&&(a.tk=this.$5);return babelHelpers["extends"]({},a,e)};b.processUnifiedResponse=function(a){a=a;this.$5=a.tk;return a};b.clearAnyPreviousContext=function(){this.$4=null};b.logHttpRequestSuccess=function(a){var b=this;c("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_success",duration_ms:a!=null?a.toString():null,countable_id:b.$1}})};b.logHttpRequestFailure=function(a,b){var d=this;c("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_failed",error_msg:a,duration_ms:b!=null?b.toString():null,countable_id:d.$1}})};b.logHttpRequestTimeout=function(a){var b=this;c("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_timeout",duration_ms:a!=null?a.toString():null,countable_id:b.$1}})};b.logHttpResponseBad=function(a,b){var d=this;c("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_response_bad",error_msg:a,duration_ms:b!=null?b.toString():null,countable_id:d.$1}})};b.logDebugInfo=function(a){var b=this;c("CvcV3HttpEventFalcoEvent").log(function(){return{name:a,countable_id:b.$1}})};return a}();g["default"]=a}),98);
__d("CappedListItemContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext();g["default"]=b}),98);
__d("CometAudioManagerHooks",["CometAudioManagerContexts","react","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(){var a=i(d("CometAudioManagerContexts").AudioApiContext);return a}g.useAudioApi=a}),98);
__d("makeAudioSymbol",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return b+"::"+a}f["default"]=a}),66);
__d("CoreVideoPlayerAudioClient.react",["CometAudioManagerContexts","CometAudioManagerHooks","CometThrottle","VideoPlayerHooks","VideoPlayerPortalingPlaceInfoProvider.react","createVideoStateHook","makeAudioSymbol","react","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useContext,k=b.useEffect,l=b.useId,m=b.useMemo,n=b.useRef,o=b.useState;e=d("createVideoStateHook").createVideoStateHook();var p=e.valueHook;function a(){var a=p({isVolumeInitialized:!1}),b=l(),e=(i||(i=d("VideoPlayerHooks"))).useInstanceKey(),f=m(function(){return c("makeAudioSymbol")(b,e)},[b,e]),g=d("CometAudioManagerHooks").useAudioApi(),h=n(g);k(function(){h.current=g},[g]);var q=i.useController(),r=200,s=i.useLastPlayReason(),t=i.useLastMuteReason(),u=i.useMuted();r=c("CometThrottle")(i.useVolume,r,{trailing:!0});var v=r(),w=c("usePrevious")(v),x=i.usePaused(),y=j(d("CometAudioManagerContexts").CometAudioLocalScopeContext),z=j(d("CometAudioManagerContexts").CometAudioGroupContext),A=d("VideoPlayerPortalingPlaceInfoProvider.react").useVideoPlayerPortalingPlaceInfo(),B=i.useVolumeSetting(),C=m(function(){return(z==null?void 0:z.groupID)||d("CometAudioManagerContexts").makeAudioGroupID()},[z==null?void 0:z.groupID]);r=o(!0);var D=r[0];r=r[1];var E=m(function(){return{audioLocalScope:y,controller:q,groupID:C,instanceKey:e,lastMuteReason:t,lastPlayReason:s,muted:u,paused:x,previousVolume:w,symbol:f,videoPlayerPortalingPlaceInfo:A,volume:v}},[y,q,C,e,t,s,u,x,w,f,A,v]);k(function(){B!=null&&a.isVolumeInitialized!==!0&&(q.setVolume(B),a.isVolumeInitialized=!0)},[q,a,!0,B]);r=z||{allowSound:D,groupID:C,setAllowSound:r};var F=n(r);k(function(){g&&g.register(E,F.current);return function(){g&&g.unregister(f,C)}},[g,E,C,f]);k(function(){g&&g.update(E)},[g,E]);k(function(){!D&&h.current&&q.setMuted(!0,"audio_manager_initiated")},[D,h,q]);return null}g["default"]=a}),98);
__d("VideoPlayerAutoplayHooks",["VideoPlayerAutoplayContexts","react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(){var a=i(d("VideoPlayerAutoplayContexts").AutoplayApiContext);if(a==null)throw c("unrecoverableViolation")("Empty AutoplayApiContext. Are you rendering useAutoplayApi outside of VideoAutoplayManagerX?","comet_video_player");return a}function b(){return i(d("VideoPlayerAutoplayContexts").VideoAutoplayLocalScopeContext)}g.useAutoplayApi=a;g.useVideoAutoplayLocalScope=b}),98);
__d("VideoPlayerDebugAutoplayAPI",["cr:1453865","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";d=(a=b("cr:1453865"))!=null?a:{useVideoPlayerDebugAPI:c("emptyFunction").thatReturns(null),useVideoPlayerDebugAPIDefinition:c("emptyFunction"),useVideoPlayerDebugInfo:c("emptyFunction").thatReturns(null)};g["default"]=d}),98);
__d("evaluateVideoAutoplayDefaultAllowRule",[],(function(a,b,c,d,e,f){"use strict";function a(){return"ALLOW"}a.displayName="evaluateVideoAutoplayDefaultRule";f["default"]=a}),66);
__d("makeSelectedAutoplayVideoSymbol",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return b+"::"+a}f["default"]=a}),66);
__d("useAutoplayRulesEngine",["AutoplayRulesEngine","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useRef,k=b.useState;function a(a){var b=j(a),d=k(function(){return new(c("AutoplayRulesEngine"))(a)}),e=d[0],f=d[1];i(function(){b.current!==a&&f(function(){return new(c("AutoplayRulesEngine"))(a)})},[a]);i(function(){b.current=e.getRules()},[e]);return e}g["default"]=a}),98);
__d("useConcurrentAutoplayManagementAPI",["react","removeFromArray"],(function(a,b,c,d,e,f,g){"use strict";var h;e=h||d("react");var i=e.useId,j=e.useState;function a(){return i()}function k(){var a=[];return{isControllingComponent:function(b){var c=a.length;return a[c-1]===b},registerControllingComponent:function(b){c("removeFromArray")(a,b),a.push(b)},unregisterControllingComponent:function(b){var d=a.length;d>1&&c("removeFromArray")(a,b);return d>1}}}function b(){var a=j(function(){return k()});a=a[0];return a}g.useAutoplayControlID=a;g.createConcurrentAutoplayManagementAPI=k;g.useConcurrentAutoplayManagementAPI=b}),98);
__d("VideoPlayerContextSensitiveConfigUtils",[],(function(a,b,c,d,e,f){"use strict";var g=function(a,b){return b.every(function(b){return a[b.name]===b.value})};a=function(a,b){return b.find(function(b){return g(a,b.contexts)})};f.getFirstMatchingValueAndContextTargets=a}),66);
__d("VideoPlayerContextSensitiveConfigResolver",["VideoPlayerContextSensitiveConfigPayload","VideoPlayerContextSensitiveConfigUtils","cr:1724253"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1={},this.$2={},a==null?(this.$3=c("VideoPlayerContextSensitiveConfigPayload").static_values,this.$4=c("VideoPlayerContextSensitiveConfigPayload").context_sensitive_values):(this.$3=a.staticValues,this.$4=a.contextSensitiveValues)}var e=a.prototype;e.setContexts=function(a){this.$1=a,this.$2=this.$5(a)};e.getValue=function(a){if(this.$2[a]!=null)return this.$2[a];return this.$3[a]!=null?this.$3[a]:null};e.$5=function(a){var b=this;return Object.keys(this.$4).reduce(function(c,e){var f=b.$4[e];if(f!=null){f=d("VideoPlayerContextSensitiveConfigUtils").getFirstMatchingValueAndContextTargets(a,f);f!=null&&(c[e]=f.value)}return c},{})};a.getPayload=function(){return c("VideoPlayerContextSensitiveConfigPayload")};a.getSources=function(){return b("cr:1724253")};return a}();g["default"]=a}),98);
__d("VideoPlayerShakaGlobalConfig",["VideoPlayerContextSensitiveConfigResolver"],(function(a,b,c,d,e,f,g){var h=new(c("VideoPlayerContextSensitiveConfigResolver"))(),i={};a=function(a){i=a};b=function(a,b){if(!!i&&typeof i[a]==="boolean")return i[a];a=h.getValue(a);return a!=null&&typeof a==="boolean"?a:b};d=function(a,b){if(!!i&&typeof i[a]==="number")return i[a];a=h.getValue(a);return a!=null&&typeof a==="number"?a:b};e=function(a,b){if(!!i&&typeof i[a]==="string")return i[a];a=h.getValue(a);return a!=null&&typeof a==="string"?a:b};g.setGlobalOverrideConfig=a;g.getBool=b;g.getNumber=d;g.getString=e}),98);
__d("VideoPlayerViewabilityHooks",["VideoPlayerHooks"],(function(a,b,c,d,e,f,g){"use strict";var h;g.useVideoPlayerExtendedPassiveViewabilityInfo=(h||(h=d("VideoPlayerHooks"))).useVideoPlayerExtendedPassiveViewabilityInfo;g.useVideoPlayerPassiveViewabilityInfo=h.useVideoPlayerPassiveViewabilityInfo;g.useVideoPlayerViewabilityInfo=h.useVideoPlayerViewabilityInfo}),98);
__d("useEventCallbackOn",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a,b,c){i(function(){a.addEventListener(b,c);return function(){a.removeEventListener(b,c)}},[a,b,c])}g["default"]=a}),98);
__d("useIsBackgrounded",["emptyFunction","react","useEventCallbackOn"],(function(a,b,c,d,e,f,g){"use strict";var h;f=h||d("react");var i=f.useCallback,j=f.useState;function b(){var b=a.document;if(typeof b.hidden!=="undefined")return"visibilitychange";else if(typeof b.mozHidden!=="undefined")return"mozvisibilitychange";else if(typeof b.msHidden!=="undefined")return"msvisibilitychange";else if(typeof b.webkitHidden!=="undefined")return"webkitvisibilitychange";return"visibilitychange"}function k(){var b=a.document;if(typeof b.hidden!=="undefined")return b.hidden;else if(typeof b.mozHidden!=="undefined")return b.mozHidden;else if(typeof b.msHidden!=="undefined")return b.msHidden;else if(typeof b.webkitHidden!=="undefined")return b.webkitHidden;return!1}var l=b();function m(b){var c=a.document.hasFocus?a.document.hasFocus():!0,d=k();return d||(b?!1:!c)}function n(){return k()}function e(b){var d=(b==null?void 0:b.noPauseOnBlurOrFocus)===!0,e=j(function(){return m(d)}),f=e[0],g=e[1];e=j(function(){return n()});var h=e[0],k=e[1],o=!!b&&b.scrollTerminatesHiddenOrBlurred===!0;e=i(function(){g(m(d)),k(n())},[g,d]);b=e;var p=i(function(){var a=m(d);a&&o&&f&&g(!1)},[f,d,o]);d&&(b=c("emptyFunction"));c("useEventCallbackOn")(a.window,"blur",b);c("useEventCallbackOn")(a.window,"focus",b);c("useEventCallbackOn")(a.document,l,e);c("useEventCallbackOn")(a.window,"scroll",p);return{isDocumentHidden:h,isDocumentHiddenOrBlurred:f}}g["default"]=e}),98);
__d("VideoPlayerOzWWWGlobalConfig",["VideoPlayerShakaGlobalConfig"],(function(a,b,c,d,e,f,g){"use strict";var h="oz_www_";a={getBool:function(a,b){return d("VideoPlayerShakaGlobalConfig").getBool(h+a,b)},getNumber:function(a,b){return d("VideoPlayerShakaGlobalConfig").getNumber(h+a,b)},getString:function(a,b){return d("VideoPlayerShakaGlobalConfig").getString(h+a,b)}};b=a;g["default"]=b}),98);
__d("useVideoPlayerBandwidthEstimate",["VideoPlayerOzWWWGlobalConfig","oz-player/networks/OzBandwidthEstimator","react","useInterval"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useState,j=5e3;function a(){var a=function(){return c("oz-player/networks/OzBandwidthEstimator").getBandwidth(c("VideoPlayerOzWWWGlobalConfig"))},b=i(a()),d=b[0],e=b[1];c("useInterval")(function(){return e(a())},j);return d}g["default"]=a}),98);
__d("useVideoAutoplayState",["HiddenSubtreePassiveContext","VideoPlayerHooks","VideoPlayerShakaGlobalConfig","VideoPlayerViewabilityHooks","react","useIsBackgrounded","useVideoPlayerBandwidthEstimate"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.startTransition,k=b.useContext,l=b.useEffect,m=b.useMemo,n=b.useRef,o=b.useState;function a(a){var b=(i||(i=d("VideoPlayerHooks"))).useAdClientToken(),e=i.useAutoplayGatingResult(),f=i.useBroadcastStatus(),g=i.useEnded(),h=i.useIsFrozenPassive(),p=i.useLastPauseReason(),q=i.useLastPlayReason(),r=i.useMuted(),s=i.usePaused(),t=k(c("HiddenSubtreePassiveContext")),u=!b;a=(a==null?void 0:a.noPauseOnBlurOrFocus)===!0||d("VideoPlayerShakaGlobalConfig").getBool("comet_www_no_pause_on_blur_or_focus_events",!1);a=c("useIsBackgrounded")({noPauseOnBlurOrFocus:a,scrollTerminatesHiddenOrBlurred:u});var v=a.isDocumentHidden,w=a.isDocumentHiddenOrBlurred,x=c("useVideoPlayerBandwidthEstimate")(),y=d("VideoPlayerViewabilityHooks").useVideoPlayerPassiveViewabilityInfo(),z=d("VideoPlayerViewabilityHooks").useVideoPlayerExtendedPassiveViewabilityInfo();u=o(t.getCurrentState().backgrounded);var A=u[0],B=u[1];a=o(t.getCurrentState().hidden);var C=a[0],D=a[1];l(function(){var a=function(){j(function(){var a=t.getCurrentState();D(a.hidden);B(a.backgrounded)})},b=t.subscribeToChanges(a);a();return function(){b.remove()}},[t,B,D]);u=o(function(){return h.getCurrentState()});var E=u[0],F=u[1];l(function(){var a=h.subscribeToChanges(function(a){F(a)}),b=h.getCurrentState();F(b);return function(){a.remove()}},[h,F]);var G=m(function(){return{adClientToken:b,autoplayGatingResult:e,bandwidthEstimate:x,broadcastStatus:f,controllerIsFrozen:E,currentSubtreeIsBackgrounded:A,currentSubtreeIsHidden:C,ended:g,hiddenSubtreePassive:t,isDocumentHidden:v,isDocumentHiddenOrBlurred:w,isFrozenPassive:h,lastPauseReason:p,lastPlayReason:q,muted:r,paused:s,videoPlayerExtendedPassiveViewabilityInfo:z,videoPlayerPassiveViewabilityInfo:y}},[b,e,x,f,E,A,C,g,t,v,w,h,p,q,r,s,z,y]);a=o(G);var H=a[0],I=a[1],J=n(H);l(function(){J.current=H},[H]);l(function(){var a=!1;for(var b in G)if(Object.prototype.hasOwnProperty.call(G,b)&&G[b]!==J.current[b]){a=!0;break}a&&I(G)},[G,I]);return H}g["default"]=a}),98);
__d("CoreVideoPlayerAutoplayClient.react",["CoreVideoPlayerAutoplayClientUtils","HiddenSubtreePassiveContext","VideoPlayerAutoplayHooks","VideoPlayerDebugAutoplayAPI","VideoPlayerHooks","VideoPlayerViewabilityConstants","WwwCometVideoAutoplayFalcoEvent","evaluateVideoAutoplayDefaultAllowRule","evaluateVideoAutoplayDefaultIgnoreRule","makeSelectedAutoplayVideoSymbol","react","useAutoplayRulesEngine","useConcurrentAutoplayManagementAPI","useVideoAutoplayState"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useCallback,k=b.useContext,l=b.useEffect,m=b.useId,n=b.useMemo,o=b.useRef,p=b.useState;function a(){var a=m(),b=(i||(i=d("VideoPlayerHooks"))).useCanAutoplay(),e=i.useInstanceKey(),f=n(function(){return c("makeSelectedAutoplayVideoSymbol")(a,e)},[a,e]),g=o(f);l(function(){g.current=f},[f]);var h=k(c("HiddenSubtreePassiveContext")),q=i.useController(),r=o(!1),s=d("useConcurrentAutoplayManagementAPI").useAutoplayControlID();l(function(){d("CoreVideoPlayerAutoplayClientUtils").log(g.current,"[ASSUME CONTROL] "+s),q.registerControllingComponent(s)},[q,s]);var t=i.useVideoPlayerPassiveViewabilityInfo(),u=q.getCurrentState();u=u.paused;var v=o(u),w=d("VideoPlayerAutoplayHooks").useVideoAutoplayLocalScope(),x=o(w);l(function(){x.current=w},[w]);var y=j(function(){var a=q.getCurrentState(),b=a.lastPlayReason;a=a.paused;var d=v.current;v.current=a;var e=t==null?void 0:t.getCurrent();if(e){e=e.visiblePercentage;a=!a&&a!==d;d=e<c("VideoPlayerViewabilityConstants").DEFAULT_VIEWABILITY_PERCENTAGE_FOR_PAUSE&&e>0;x.current.disableScrollBeforePlayWhenOffscreen!==!0&&a&&b==="user_initiated"&&d&&(r.current=!0)}},[q,t]),z=o(y);l(function(){z.current=y},[y]);l(function(){var a=q.subscribe(function(){y()});return function(){a.remove()}},[q,y]);var A=c("useVideoAutoplayState")({noPauseOnBlurOrFocus:w.noPauseOnBlurOrFocus}),B=c("useAutoplayRulesEngine")(w.autoplayLocalRules),C=b==="allow"?c("evaluateVideoAutoplayDefaultAllowRule"):c("evaluateVideoAutoplayDefaultIgnoreRule");u=p(function(){return C});var D=u[0],E=u[1];u=p(null);var F=u[0],G=u[1];u=p(function(){return B.evaluateAutoplay(A,C)});var H=u[0],I=u[1];u=p(null);var J=u[0],K=u[1],L=o(H),M=d("VideoPlayerAutoplayHooks").useAutoplayApi(),N=o(M);l(function(){N.current=M},[M]);var O=b!=="dangerously_disable_autoplay_management";l(function(){M.register(f,e,w,q,h,O);c("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"register",autoplay_scope_id:x.current.autoplayScopeID,event_creation_time:Date.now(),initiator:g.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:M.getAutoplayManagerDebugInfo(x.current).selectedAutoplayVideoSymbol,target:g.current,target_current_autoplay_decision:L.current}});return function(){M.unregister(f),c("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"unregister",autoplay_scope_id:x.current.autoplayScopeID,event_creation_time:Date.now(),initiator:g.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:M.getAutoplayManagerDebugInfo(x.current).selectedAutoplayVideoSymbol,target:g.current,target_current_autoplay_decision:L.current}})}},[M,w,q,h,e,O,f]);l(function(){var a=function(){var b=B.evaluateAutoplay(A,C);L.current=b;var e=B.getRules(),h=B.getIndexOfLastWinningRule(),a=h>=0?e[h]:C;e=t&&t.getCurrent();h=q.getCurrentState();h=h.paused;(J===null||J!==b)&&(I(b),K(b));if(b==="PAUSE"&&!h&&q.isControllingComponent(s)){h=!0;z.current();if(r.current){r.current=!1;var i=e==null?void 0:e.positionToViewport;i&&q.scrollIntoView(i.top<0);h=!1}if(h){i="[PAUSE] via short-circuit on "+a.name+".";d("CoreVideoPlayerAutoplayClientUtils").log(g.current,i);q.pause("autoplay_initiated");c("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:x.current.autoplayScopeID,event_creation_time:Date.now(),initiator:g.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:M.getAutoplayManagerDebugInfo(x.current).selectedAutoplayVideoSymbol,target:g.current,target_current_autoplay_decision:b}})}}(F===null||F!==a)&&(E(function(){return a}),G(function(){return a}),c("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"rule_changed",autoplay_scope_id:x.current.autoplayScopeID,event_creation_time:Date.now(),initiator:g.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:M.getAutoplayManagerDebugInfo(x.current).selectedAutoplayVideoSymbol,target:g.current,target_current_autoplay_decision:b}}));d("CoreVideoPlayerAutoplayClientUtils").log(g.current,"[DECISION: "+b+"] from "+a.name);e&&M.update(f,b,e)},b=h.subscribeToChanges(function(a){h.getCurrentState().hidden||h.getCurrentState().backgrounded?q.isControllingComponent(s)||q.unregisterControllingComponent(s):q.registerControllingComponent(s)}),e=t?t.subscribe(function(){h.getCurrentState().hidden||h.getCurrentState().backgrounded?q.isControllingComponent(s)||q.unregisterControllingComponent(s):q.registerControllingComponent(s),a()}):null;a();return function(){b.remove(),e&&e.remove()}},[M,s,B,q,C,h,F,J,E,I,G,K,f,A,t]);l(function(){var a=q.isControllingComponent(s),b=q.getCurrentState();b=b.paused;d("CoreVideoPlayerAutoplayClientUtils").componentShouldPause(H,L.current,b,a)&&(d("CoreVideoPlayerAutoplayClientUtils").log(g.current,"[PAUSE] the video for "+H),q.pause("autoplay_initiated"),c("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:x.current.autoplayScopeID,event_creation_time:Date.now(),initiator:g.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:N.current.getAutoplayManagerDebugInfo(x.current).selectedAutoplayVideoSymbol,target:g.current,target_current_autoplay_decision:H}}))},[H,q,s]);l(function(){return function(){d("CoreVideoPlayerAutoplayClientUtils").log(g.current,"[RELEASE CONTROL] "+s),q.unregisterControllingComponent(s)}},[q,s]);c("VideoPlayerDebugAutoplayAPI").useVideoPlayerDebugAPIDefinition({applicableRule:D,autoplayApiRef:N,autoplayDecision:H,autoplayLocalScope:w,symbol:f});return null}g["default"]=a}),98);
__d("VideoPlayerViewabilityProvider.react",["VideoPlayerViewabilityContexts","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.children,c=a.isDesktopPictureInPicture,e=a.isFullscreen;a=a.videoPlayerPassiveViewabilityInfo;return i.jsx(d("VideoPlayerViewabilityContexts").VideoPlayerPassiveViewabilityInfoContext.Provider,{value:a,children:i.jsx(d("VideoPlayerViewabilityContexts").VideoPlayerDesktopPictureInPictureContext.Provider,{value:c,children:i.jsx(d("VideoPlayerViewabilityContexts").VideoPlayerFullscreenContext.Provider,{value:e,children:b})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useBlockCappedListItemWhenPlayingVideo",["CappedListItemContext","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect;function a(a,b){var d=(b=i(c("CappedListItemContext")))==null?void 0:b.registerBlocker;j(function(){if(!d)return;var b=null,c=null,e=function(){var e=a.getCurrentState().playing;if(e!==b){b=e;c&&(c(),c=null);if(e){e="playing_video";var f;c=d({reason:e,source:f})}}};e();var f=a.subscribe(e);return function(){f.remove(),c&&(c(),c=null)}},[a,d])}g["default"]=a}),98);
__d("useDisableVirtualizationWhenPlayingVideo",["VirtualizationContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect;function a(a,b){var d=i(c("VirtualizationContext"));j(function(){if(d==null)return;var c=d.createFlag,e=d.createPin,f=null,g=null,h=function(){g==null&&(g=c("HAS_PLAYER","playerInstanceKey: "+b));var d=a.getCurrentState();d.playing?f||(f=e("player "+b+" is playing")):d.isFullscreen?f||(f=e("player "+b+" is fullscreen")):(f==null?void 0:f(),f=null)};h();var i=a.subscribe(h);return function(){i.remove(),g==null?void 0:g(),g=null,f==null?void 0:f(),f=null}},[a,b,d])}g["default"]=a}),98);
__d("wrapWithContextProviders",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a,b){return b.reduceRight(function(a,b){return b(a)},a)}a.displayName=a.name+" [from "+f.id+"]";function b(a,b){return function(c){return i.jsx(a.Provider,{value:b,children:c})}}g.wrapWithContextProviders=a;g.makeRenderProviderFn=b}),98);
__d("VideoPlayerComponentContainer.react",["CometVisualCompletionAttributes","VideoPlayerContexts","VideoPlayerHooks","VideoPlayerViewabilityProvider.react","clearTimeout","cr:6094","react","setTimeout","stylex","useBlockCappedListItemWhenPlayingVideo","useDisableVirtualizationWhenPlayingVideo","wrapWithContextProviders"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.useCallback,n=e.useEffect,o=e.useRef,p=e.useState,q={"default":{height:"x5yr21d",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0},hiddenCursor:{cursor:"xjfk50j",$$css:!0}};function r(a){var b=o(a);n(function(){b.current=a},[a]);var d=p(!1),e=d[0],f=d[1];d=p(function(){var a=null;return{cleanup:function(){a&&a()},pingNotIdle:function(){a&&a();f(!1);var d=c("setTimeout")(function(){f(!0)},b.current);a=function(){c("clearTimeout")(d),a=null}}}});d=d[0];var g=d.cleanup;d=d.pingNotIdle;n(function(){return g},[g]);return{isIdle:e,pingNotIdle:d}}function s(){var a=p(!1),b=a[0],c=a[1];a=3e3;a=r(a);var d=a.isIdle,e=a.pingNotIdle;a=m(function(){c(!0),e()},[e]);var f=m(function(){c(!1),e()},[e]),g=m(function(){c(!0),e()},[e]),h=m(function(){e()},[e]),i=m(function(){e()},[e]);return{isHovering:b,isIdle:d,onMouseDown:h,onMouseEnter:a,onMouseLeave:f,onMouseMove:g,onMouseUp:i}}function t(a){a=a.children;var b=s(),e=b.isHovering,f=b.isIdle,g=b.onMouseDown,i=b.onMouseEnter,m=b.onMouseLeave,n=b.onMouseMove;b=b.onMouseUp;var o=(k||(k=d("VideoPlayerHooks"))).useIsFullscreen();return l.jsx("div",babelHelpers["extends"]({className:(h||(h=c("stylex")))(q["default"],o&&f&&q.hiddenCursor)},c("CometVisualCompletionAttributes").IGNORE,{onMouseDown:g,onMouseEnter:i,onMouseLeave:m,onMouseMove:n,onMouseUp:b,children:l.jsx((j||(j=d("VideoPlayerContexts"))).VideoPlayerMouseHoverContext.Provider,{value:e,children:l.jsx(j.VideoPlayerMouseIdleContext.Provider,{value:f,children:a})})}))}t.displayName=t.name+" [from "+f.id+"]";function a(a){var e=a.children;a=babelHelpers.objectWithoutPropertiesLoose(a,["children"]);var f=a.adClientToken,g=a.audioAvailabilityInfo,h=a.autoplayGatingResult,i=a.broadcastStatus,k=a.canAutoplay,m=a.controller,n=a.dimensions,o=a.initialTracePolicy,p=a.instanceKey,q=a.isDesktopPictureInPicture,r=a.isFullscreen,s=a.isNCSR,u=a.isPremiumMusicVideo,v=a.lastMuteReason,w=a.lastPauseReason,x=a.lastPlayReason,y=a.videoFBID,z=a.videoPixelsAspectRatio,A=a.videoPlayerPassiveViewabilityInfo,B=a.videoState,C=a.volumeSetting,D=B.activeCaptions,E=B.activeEmsgBoxes,F=B.availableAudioTracks,G=B.availableVideoQualities,H=B.availableVideoTracks,I=B.bufferEnd,J=B.captionDisplayStyle,K=B.captionsLoaded,L=B.captionsVisible,M=B.currentAudioTrackID,N=B.currentVideoQuality,O=B.duration,P=B.ended,Q=B.error,R=B.inbandCaptionsAutogenerated,S=B.inPlayStalling,T=B.isAbrEnabled,U=B.isLiveRewindActive,V=B.isLiveRewindAvailable,W=B.lastPlayedTimeMs,X=B.latencyLevel,Y=B.loopCount,Z=B.loopCurrent,$=B.muted,aa=B.paused,ba=B.playerVersion,ca=B.playing,da=B.seekableRanges,ea=B.seeking,fa=B.selectedVideoQuality,ga=B.stalling,ha=B.streamInterrupted,ia=B.targetAudioTrack,ja=B.targetPlaybackRate,ka=B.targetVideoQuality,la=B.volume;B=B.watchTimeMs;e=l.jsx(t,{children:e});b("cr:6094")(p,{controller:m,coreVideoStates:a,videoPlayerPassiveViewabilityInfo:A});a=(a=d("wrapWithContextProviders")).wrapWithContextProviders(e,[a.makeRenderProviderFn((j||(j=d("VideoPlayerContexts"))).VideoFBIDContext,y),d("wrapWithContextProviders").makeRenderProviderFn(j.StallingContext,ga),d("wrapWithContextProviders").makeRenderProviderFn(j.PlayingContext,ca),d("wrapWithContextProviders").makeRenderProviderFn(j.InPlayStallingContext,S),d("wrapWithContextProviders").makeRenderProviderFn(j.BufferEndContext,I),d("wrapWithContextProviders").makeRenderProviderFn(j.LastMuteReasonContext,v),d("wrapWithContextProviders").makeRenderProviderFn(j.LastPlayReasonContext,x),d("wrapWithContextProviders").makeRenderProviderFn(j.LastPauseReasonContext,w),d("wrapWithContextProviders").makeRenderProviderFn(j.PausedContext,aa),d("wrapWithContextProviders").makeRenderProviderFn(j.CurrentAudioTrackIDContext,M),d("wrapWithContextProviders").makeRenderProviderFn(j.CurrentVideoQualityContext,N),d("wrapWithContextProviders").makeRenderProviderFn(j.MutedContext,$),d("wrapWithContextProviders").makeRenderProviderFn(j.TargetAudioTrackContext,ia),d("wrapWithContextProviders").makeRenderProviderFn(j.VolumeContext,la),d("wrapWithContextProviders").makeRenderProviderFn(j.SelectedVideoQualityContext,fa),d("wrapWithContextProviders").makeRenderProviderFn(j.SeekingContext,ea),d("wrapWithContextProviders").makeRenderProviderFn(j.DurationContext,O),d("wrapWithContextProviders").makeRenderProviderFn(j.EndedContext,P),d("wrapWithContextProviders").makeRenderProviderFn(j.ErrorContext,Q),d("wrapWithContextProviders").makeRenderProviderFn(j.DimensionsContext,n||null),d("wrapWithContextProviders").makeRenderProviderFn(j.InstanceKeyContext,p),d("wrapWithContextProviders").makeRenderProviderFn(j.ControllerContext,m),d("wrapWithContextProviders").makeRenderProviderFn(j.AvailableAudioTracksContext,F),d("wrapWithContextProviders").makeRenderProviderFn(j.AvailableVideoQualitiesContext,G),d("wrapWithContextProviders").makeRenderProviderFn(j.AvailableVideoTracksContext,H),d("wrapWithContextProviders").makeRenderProviderFn(j.PlayerVersionContext,ba),d("wrapWithContextProviders").makeRenderProviderFn(j.IsAbrEnabledContext,T),d("wrapWithContextProviders").makeRenderProviderFn(j.TargetVideoQualityContext,ka),d("wrapWithContextProviders").makeRenderProviderFn(j.PlaybackRateContext,ja),d("wrapWithContextProviders").makeRenderProviderFn(j.CanAutoplayContext,k),d("wrapWithContextProviders").makeRenderProviderFn(j.VolumeSettingContext,C),d("wrapWithContextProviders").makeRenderProviderFn(j.AutoplayGatingResultContext,h),d("wrapWithContextProviders").makeRenderProviderFn(j.BroadcastStatusContext,i),d("wrapWithContextProviders").makeRenderProviderFn(j.LoopCountContext,Y),d("wrapWithContextProviders").makeRenderProviderFn(j.LoopCurrentContext,Z),d("wrapWithContextProviders").makeRenderProviderFn(j.AdClientTokenContext,f),d("wrapWithContextProviders").makeRenderProviderFn(j.ActiveCaptionsContext,D),d("wrapWithContextProviders").makeRenderProviderFn(j.CaptionsVisibleContext,L),d("wrapWithContextProviders").makeRenderProviderFn(j.CaptionDisplayStyleContext,J),d("wrapWithContextProviders").makeRenderProviderFn(j.CaptionsLoadedContext,K),d("wrapWithContextProviders").makeRenderProviderFn(j.InbandCaptionsAutogeneratedContext,R),d("wrapWithContextProviders").makeRenderProviderFn(j.StreamInterruptedContext,ha),d("wrapWithContextProviders").makeRenderProviderFn(j.WatchTimeContext,B),d("wrapWithContextProviders").makeRenderProviderFn(j.LastPlayedTimeContext,W),d("wrapWithContextProviders").makeRenderProviderFn(j.SeekableRangesContext,da),d("wrapWithContextProviders").makeRenderProviderFn(j.LatencyLevelContext,X),d("wrapWithContextProviders").makeRenderProviderFn(j.IsLiveRewindActiveContext,U),d("wrapWithContextProviders").makeRenderProviderFn(j.IsLiveRewindAvailableContext,V),d("wrapWithContextProviders").makeRenderProviderFn(j.AudioAvailabilityInfoContext,g),d("wrapWithContextProviders").makeRenderProviderFn(j.IsNCSRContext,s),d("wrapWithContextProviders").makeRenderProviderFn(j.IsPremiumMusicVideoContext,u),d("wrapWithContextProviders").makeRenderProviderFn(j.InitialTracePolicyContext,o),d("wrapWithContextProviders").makeRenderProviderFn(j.ActiveEmsgBoxesContext,E),d("wrapWithContextProviders").makeRenderProviderFn(j.VideoPixelsAspectRatioContext,(e=z)!=null?e:null),function(a){return l.jsx(c("VideoPlayerViewabilityProvider.react"),{isDesktopPictureInPicture:q,isFullscreen:r,videoPlayerPassiveViewabilityInfo:A,children:a})}]);c("useBlockCappedListItemWhenPlayingVideo")(m,p);c("useDisableVirtualizationWhenPlayingVideo")(m,p);return l.jsx("div",{"data-instancekey":p,"data-testid":void 0,children:a})}a.displayName=a.name+" [from "+f.id+"]";e=l.memo(a);g["default"]=e}),98);
__d("GlobalVideoPortsID",["cometUniqueID","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(){return"id-pv-"+c("cometUniqueID")()}function b(a){if(typeof a==="string"){var b="id-pv-";if(a.indexOf(b)===0&&a.length>b.length)return a;else throw c("unrecoverableViolation")('Expected a GlobalVideoPortsVideoID, got a string that does not look like it: "'+a+'"',"comet_video_player")}else return null}function d(){return"id-pp-"+c("cometUniqueID")()}g.makeVideoID=a;g.ensureVideoID=b;g.makePlaceID=d}),98);
__d("VideoPlayerFullscreenController",["CometFullScreen","removeFromArray","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.current!=null&&d("CometFullScreen").getFullScreenElement()===a.current}function a(a){var b=[];function e(){b.forEach(function(a){a()})}var f=null;return{getIsFullscreen:function(){return h(a)},requestSetIsFullscreen:function(b,e){var f=a.current;if(f==null)throw c("unrecoverableViolation")("Requested full screen while the element is not present","comet_video_player");d("CometFullScreen").isSupported()?b!==h(a)&&(b===!0?d("CometFullScreen").requestFullScreen(f):b===!1&&d("CometFullScreen").exitFullScreen()):b&&e!=null&&typeof e.webkitEnterFullScreen==="function"?e.webkitEnterFullScreen():!b&&e!=null&&typeof e.webkitExitFullScreen==="function"&&e.webkitExitFullscreen()},subscribe:function(a){b.length===0&&f==null&&(f=d("CometFullScreen").subscribeToFullScreenChangeEvent(e));b.push(a);return{remove:function(){c("removeFromArray")(b,a),b.length===0&&f!=null&&(f(),f=null)}}}}}g.createFullscreenController=a}),98);
__d("VideoPlayerPortalingPlaceState",["GlobalVideoPortsContexts","GlobalVideoPortsID","gkx","react","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h;f=h||d("react");var i=f.useEffect,j=f.useState;function a(a,b){var e=c("usePrevious")(a);i(function(){a!==e&&(e!==null&&e&&!a&&b(d("GlobalVideoPortsID").makeVideoID()))},[a,e,b])}function b(a,b){var c=j(null),e=c[0];c=c[1];a!==e&&(e!==null&&e&&!a&&b(d("GlobalVideoPortsID").makeVideoID()),c(a))}var k=c("gkx")("24382")?b:a;function e(a){var b=a.portalingEnabled;a=a.portalingFromVideoID;var c=d("GlobalVideoPortsContexts").useGlobalVideoPortsLoader(),e=d("GlobalVideoPortsContexts").useGlobalVideoPortsManager(),f=d("GlobalVideoPortsContexts").useGlobalVideoPortsState(),g=e!=null&&f!=null,h=(g||c!=null)&&(b||a!=null),l=j(function(){return d("GlobalVideoPortsID").makePlaceID()});l=l[0];var m=j(function(){return d("GlobalVideoPortsID").makeVideoID()}),n=m[0];m=m[1];b=h&&b&&a!=null;a=b&&a!=null?a:n;k(b,m);i(function(){h&&!g&&c&&c()},[g,h,c]);return{canBecomePortableLater:h,currentVideoID:a,globalVideoPortsManager:e,globalVideoPortsState:f,thisPlaceID:l}}g.useRegenerateUniqueVideoID_exportedForTest=k;g.useVideoPlayerPortalingPlaceState=e}),98);
__d("getOwnObjectValues",[],(function(a,b,c,d,e,f){function a(a){return Object.keys(a).map(function(b){return a[b]})}f["default"]=a}),66);
__d("VideoPlayerPortalingPlaceWithPortaling.react",["BaseContextualLayerAnchorRootContext","CoreVideoPlayerFitParentContainer.react","GlobalVideoPortsRenderers.react","getOwnObjectValues","killswitch","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useEffect,l=b.useRef,m=b.useState;function a(a){var b=a.coreVideoPlayerMetaData,e=a.currentPlaceID,f=a.currentVideoID,g=a.fullscreenController,h=a.globalVideoPortsManager,n=a.globalVideoPortsState_DEPRECATED,o=a.implementations,p=a.isFullscreen,q=a.portablePlaceMetaData,r=a.previousPlaceMetaData,s=a.renderComponents,t=a.renderPlaceholder,u=a.thisPlaceID,v=a.trackingDataEncrypted,w=a.trackingNodes,x=a.viewportMarginsForViewability;a=m(function(){return d("CoreVideoPlayerFitParentContainer.react").createFitParentContainerDiv({debugRole:null})});var y=a[0],z=l(null);k(function(){h.addOrUpdatePlace({coreVideoPlayerMetaData:b,fullscreenController:g,implementations:o,injectCoreVideoStatesRef:z,isFullscreen:p,portablePlaceContainer:y,portablePlaceID:u,portablePlaceMetaData:q,portableVideoID:f,renderComponents:s,renderPlaceholder:t,trackingDataEncrypted:v,trackingNodes:w,viewportMarginsForViewability:x})},[].concat(c("getOwnObjectValues")(b),[f,g,p,h,y],c("getOwnObjectValues")(q||{}),[s,t,u,v,w,x]));k(function(){return function(){h.removePlace({portablePlaceID:u})}},[h,u]);a=j(c("BaseContextualLayerAnchorRootContext"));var A=l(null);return i.jsxs(c("BaseContextualLayerAnchorRootContext").Provider,{value:p&&!c("killswitch")("WORKPLACE_VIDEO_FULLSCREEN_CONTEXT_LAYER_ROOT")?A:a,children:[i.jsx(d("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentDOMContainer,{debugRole:null,domElement:y},u),i.jsx(d("GlobalVideoPortsRenderers.react").GlobalVideoPortsVideoComponentsRenderer,{currentPlaceID:n!=null?(a=(a=h.getCurrentPlaceStateForVideo(n,f))==null?void 0:a.portablePlaceID)!=null?a:null:e,currentVideoID:f,injectCoreVideoStatesRef:z,previousPlaceMetaData:n!=null?(e=(a=h.getPortableVideoState(n,f))==null?void 0:a.previousPlaceMetaData)!=null?e:null:r,renderComponents:s,thisPlaceID:u}),i.jsx("div",{ref:A})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerPortalingPlace.react",["BaseViewportMarginsContext","CometTrackingCodeContext","CometTrackingNodesContext","CoreVideoPlayer.react","CoreVideoPlayerFitParentContainer.react","GlobalVideoPortsID","GlobalVideoPortsRenderers.react","VideoPlayerFullscreenController","VideoPlayerPortalingPlaceInfoProvider.react","VideoPlayerPortalingPlaceState","VideoPlayerPortalingPlaceWithPortaling.react","react","recoverableViolation","useStable","useUnsafeRef_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useEffect,m=b.useState,n={bottom:0,left:0,right:0,top:0},o=j.forwardRef(function(a,b){var c=a.children,e=a.debugRole;a=a.testid;return j.jsx(d("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentContainer,{debugRole:e,ref:b,testid:void 0,children:c})});function a(a){var b=a.implementations,e=a.portalingEnabled,f=a.portalingFromVideoID,g=a.portalingPlaceMetaData,i=a.renderComponents,p=a.renderPlaceholder;a=babelHelpers.objectWithoutPropertiesLoose(a,["implementations","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","renderComponents","renderPlaceholder"]);l(function(){return function(){}},[]);var q=f!=null?d("GlobalVideoPortsID").ensureVideoID(f):null;f!=null&&q==null&&c("recoverableViolation")("The provided portalingFromVideoID ("+String(f)+") does not look like such an ID. The video player will not use portaling until a valid ID is provided","comet_video_player");f=d("VideoPlayerPortalingPlaceState").useVideoPlayerPortalingPlaceState({portalingEnabled:e,portalingFromVideoID:q});e=f.canBecomePortableLater;q=f.currentVideoID;var r=f.globalVideoPortsManager,s=f.globalVideoPortsState;f=f.thisPlaceID;var t=k(c("BaseViewportMarginsContext")),u=(h||(h=c("useUnsafeRef_DEPRECATED")))(null),v=c("useStable")(function(){return d("VideoPlayerFullscreenController").createFullscreenController(u)}),w=m(v.getIsFullscreen()),x=w[0],y=w[1];l(function(){var a=v.subscribe(function(){var a=v.getIsFullscreen();y(a)});y(v.getIsFullscreen());return function(){a.remove()}},[v,y]);w=k(c("CometTrackingNodesContext"));w=w.join("");var z=k(c("CometTrackingCodeContext"));z=(z=z.encrypted_tracking[0])!=null?z:"";t=x?n:t;var A="comet-video-player-place"+(a.videoFBID!=null?"-vid-"+a.videoFBID:"");if(!e)return j.jsx(o,{debugRole:null,ref:u,testid:void 0,children:j.jsx(d("VideoPlayerPortalingPlaceInfoProvider.react").VideoPlayerPortalingPlaceInfoProvider,{currentPlaceID:f,currentVideoID:q,portalingEnabled:!1,previousPlaceMetaData:null,thisPlaceID:f,children:j.jsx(c("CoreVideoPlayer.react"),babelHelpers["extends"]({},a,{fullscreenController:v,implementations:b,isFullscreen:x,renderWithCoreVideoStates:i,trackingDataEncrypted:z,trackingNodes:w,viewportMarginsForViewability:t}))})});if(r&&s){return j.jsx(o,{debugRole:null,ref:u,testid:void 0,children:j.jsx(c("VideoPlayerPortalingPlaceWithPortaling.react"),{coreVideoPlayerMetaData:a,currentPlaceID:(e=(A=r.getCurrentPlaceStateForVideo(s,q))==null?void 0:A.portablePlaceID)!=null?e:null,currentVideoID:q,fullscreenController:v,globalVideoPortsManager:r,globalVideoPortsState_DEPRECATED:null,implementations:b,isFullscreen:x,portablePlaceMetaData:g,previousPlaceMetaData:(e=(A=r.getPortableVideoState(s,q))==null?void 0:A.previousPlaceMetaData)!=null?e:null,renderComponents:i,renderPlaceholder:p,thisPlaceID:f,trackingDataEncrypted:z,trackingNodes:w,viewportMarginsForViewability:t})})}else{return j.jsx(o,{debugRole:null,ref:u,testid:void 0,children:j.jsx(d("GlobalVideoPortsRenderers.react").GlobalVideoPortsPlaceholderRenderer,{currentPlaceID:null,currentVideoID:q,previousPlaceMetaData:null,renderPlaceholder:p,thisPlaceID:f,videoPixelsAspectRatio:(b=a.videoPixelsAspectRatio)!=null?b:null})})}}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTracePolicyContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||(h=d("react"));var i=h.useContext;c={initialTracePolicy:null,routeTracePolicy:null};var j=b.createContext(c);function a(){return i(j)}g.VideoPlayerTracePolicyContext=j;g.useVideoPlayerTracePolicy=a}),98);
__d("VideoPlayerTracePolicyProvider.react",["VideoPlayerTracePolicyContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useState;function a(a){var b=a.children,c=a.initialTracePolicy,e=a.routeTracePolicy;a=k(c);var f=a[0],g=a[1];a=k(e);var h=a[0],l=a[1];j(function(){f!==c&&g(c),h!==e&&l(e)},[c,e,f,h]);return i.jsx(d("VideoPlayerTracePolicyContext").VideoPlayerTracePolicyContext.Provider,{value:{initialTracePolicy:f,routeTracePolicy:h},children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CoreVideoPlayerWithComponents.react",["VideoPlayerComponentContainer.react","VideoPlayerPortalingPlace.react","VideoPlayerTracePolicyProvider.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a){var b=a.children,d=a.implementations,e=a.portalingEnabled,f=a.portalingFromVideoID,g=a.portalingPlaceMetaData,h=a.portalingRenderPlaceholder;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","implementations","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","portalingRenderPlaceholder"]);var k=j(function(a){return i.jsx(c("VideoPlayerComponentContainer.react"),babelHelpers["extends"]({},a,{children:b}))},[b]);return i.jsx(c("VideoPlayerTracePolicyProvider.react"),{initialTracePolicy:a.initialTracePolicy,routeTracePolicy:a.routeTracePolicy,children:i.jsx(c("VideoPlayerPortalingPlace.react"),babelHelpers["extends"]({},a,{implementations:d,portalingEnabled:e,portalingFromVideoID:f,portalingPlaceMetaData:g,renderComponents:k,renderPlaceholder:h}))})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("DataViewReader",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=0,this.$2=a}var b=a.prototype;b.seek=function(a){this.$1=a};b.skip=function(a){var b=this.$1;this.$1+=a;return b};b.readUint8=function(){return this.$2.getUint8(this.skip(8/8))};b.readUint16=function(a){a===void 0&&(a=!1);return this.$2.getUint16(this.skip(16/8),a)};b.readUint32=function(a){a===void 0&&(a=!1);return this.$2.getUint32(this.skip(32/8),a)};b.readUint64=function(a){a===void 0&&(a=!1);var b;a?(a=this.$2.getUint32(this.skip(32/8),!0),b=this.$2.getUint32(this.skip(32/8),!0)):(b=this.$2.getUint32(this.skip(32/8)),a=this.$2.getUint32(this.skip(32/8)));if(b>2097151)throw new RangeError("Overflow reading 64-bit value.");return Math.pow(2,32)*b+a};b.readInt64=function(a){a===void 0&&(a=!1);var b;a?(a=this.$2.getInt32(this.skip(32/8),!0),b=this.$2.getInt32(this.skip(32/8),!0)):(b=this.$2.getInt32(this.skip(32/8)),a=this.$2.getInt32(this.skip(32/8)));if(b>2097151)throw new RangeError("Overflow reading 64-bit value.");return Math.pow(2,32)*(b|0)+a};b.readInt16=function(a){a===void 0&&(a=!1);return this.$2.getInt16(this.skip(16/8),a)};b.readInt32=function(a){a===void 0&&(a=!1);return this.$2.getInt32(this.skip(32/8),a)};b.readZeroTerminatedString=function(a){var b="",c=0,d;while(c++<a&&(d=this.readUint8()))b+=String.fromCharCode(d);return b};b.readChars=function(a){var b="";while(a-->0)b+=String.fromCharCode(this.$2.getUint8(this.skip(8/8)));return b};b.readBytes=function(a){var b=[];while(a-->0)b.push(this.$2.getUint8(this.skip(8/8)));return b};b.getDataView=function(){return this.$2};b.getCursor=function(){return this.$1};b.hasMoreData=function(){return this.$2.byteLength-this.getCursor()>0};return a}();f["default"]=a}),66);
__d("LatencySensitiveType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NORMAL:0,LOW:1,ULTRA_LOW:2});c=a;f["default"]=c}),66);
__d("LiveTraceWwwVideoPlayerFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1743810");b=d("FalcoLoggerInternal").create("live_trace_www_video_player",a);e=b;g["default"]=e}),98);
__d("MaybeNativePromise",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;c=a.Promise||g||(g=b("Promise"));(g||b("Promise")).resolve();d=c;f["default"]=d}),66);
__d("MediaPlaybackCompoundFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2074");b=d("FalcoLoggerInternal").create("media_playback_compound",a);e=b;g["default"]=e}),98);
__d("MediaPlaybackCompoundEventLogger",["MediaPlaybackCompoundFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";a={logComet:function(a){c("MediaPlaybackCompoundFalcoEvent").log(function(){return a})},logCometImmediately:function(a){c("MediaPlaybackCompoundFalcoEvent").logImmediately(function(){return a})}};b=a;g["default"]=b}),98);
__d("MediaPlaybackCompoundEventStateMachineLogger",["NetworkStatus","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=6e4,i=1e3,j=Object.freeze(["paused","completed","cancelled","error","heartbeat"]);d=b=c("emptyFunction");e=b;f=b;d=b;function k(){return{canLogPausedOrFinishedPlaying:!1,canLogPlayingEvent:!0,errorRecoveryAttemptState:{eventsLogged:0},hasPendingRequestedPlaying:!1,isLoggingBufferingSequence:!1,isLoggingScrubbingSequence:!1,lastLoggedError:null,lastLoggedTagMetadata:{},nextHeartbeatTime:null,shouldIgnoreDomPause:!1,shouldIgnoreDomPlay:!1,shouldLogRequestedPlayingForScrub:!1}}function a(a){var b={},d=a.initialLoggingMetaData;d;var e=[],f=k(),g=[],l={};function m(b){var c,f=b.events;b=b.state;var g=babelHelpers["extends"]({},d.coreVideoPlayerMetaData.additionalSNAPLLogData,l);g=(c=(c=a.metadataProvider)==null?void 0:c.getRequiredMetadata({logDataAdditions:g,loggingMetaData:d,state:b}))!=null?c:{current_watching_module:"",media_id:"",tracking_type:""};b={events:f,required_metadata:g};e.push(b)}function n(a){var c=a.event;a=a.state;g.push(c);if(j.includes(c.event_name)){c=[].concat(g);g=[];m({events:c,state:a})}return b}function o(a){var b=a.snaplOverrides;a=a.state;var c="0";(b==null?void 0:b.video_time_position)!=null?c=Math.round(b.video_time_position*1e3).toString():a.uncontrolledState.videoElementPlayheadPosition!=null&&(c=Math.round(a.uncontrolledState.videoElementPlayheadPosition*1e3).toString());return c}function p(a){d;if(a.type==="notify_logging_metadata_change"){a=a.payload.loggingMetaData;d=a}}function q(a,c,d){if(a.controlledState.playbackState!==c.controlledState.playbackState&&c.controlledState.playbackState==="ended"&&f.canLogPausedOrFinishedPlaying){d={client_time_ms:c.uncontrolledState.clockTimestamp.toString(),event_name:"completed",media_time_ms:o({state:c})};n({event:d,state:c});f.canLogPausedOrFinishedPlaying=!1;return b}else return b}function r(a,c){c={client_time_ms:a.uncontrolledState.clockTimestamp.toString(),event_name:"requested_playing",media_time_ms:o({snaplOverrides:c,state:a}),player_instance_key:d.instanceKey};n({event:c,state:a});f.hasPendingRequestedPlaying=!0;f.canLogPausedOrFinishedPlaying=!0;return b}function s(a){if(!f.canLogPausedOrFinishedPlaying)return b;else if(f.hasPendingRequestedPlaying){t(a);f.canLogPausedOrFinishedPlaying=!1;f.hasPendingRequestedPlaying=!1;return b}else{var c={client_time_ms:a.uncontrolledState.clockTimestamp.toString(),event_name:"paused",media_time_ms:o({state:a})};n({event:c,state:a});f.canLogPausedOrFinishedPlaying=!1;f.hasPendingRequestedPlaying=!1;return b}}function t(a){var c={client_time_ms:a.uncontrolledState.clockTimestamp.toString(),event_name:"cancelled",media_time_ms:o({state:a})};n({event:c,state:a});return b}function u(a,c,d){if(d.type==="dom_event_play_promise_rejected"&&f.hasPendingRequestedPlaying){a=d.payload.playPromiseRejectionReason;if(a!=null&&a.name==="NotAllowedError"){t(c);return b}else return b}else return b}function v(a,c,d){if((d.type==="controller_play_requested"||d.type==="dom_event_play"&&!f.shouldIgnoreDomPlay)&&a.controlledState.playbackState!==c.controlledState.playbackState){r(c);return b}else return b}function w(a){var c={client_time_ms:a.uncontrolledState.clockTimestamp.toString(),event_name:"requested_seek",media_time_ms:o({state:a}),player_instance_key:d.instanceKey};n({event:c,state:a});return b}function x(a,c,d){var e=c.controlledState.playbackState,g=a.controlledState.playbackState;if(d.type==="controller_scrub_begin_requested"&&!a.controlledState.scrubbing&&e!=="paused"&&e!=="ended"){s(c);w(c);f.isLoggingScrubbingSequence=!0;return b}else if(!a.controlledState.seeking&&c.controlledState.seeking&&!f.isLoggingScrubbingSequence&&e!=="paused"&&e!=="ended"&&!f.hasPendingRequestedPlaying){s(c);w(c);f.shouldLogRequestedPlayingForScrub=!0;return b}else if(d.type==="controller_scrub_end_requested"&&a.controlledState.scrubbing&&e!=="paused"&&e!=="ended"){r(c,{video_time_position:d.payload.seekTargetPosition});return b}else if(a.controlledState.seeking&&!c.controlledState.seeking){f.shouldLogRequestedPlayingForScrub&&e!=="paused"&&e!=="ended"&&r(c);f.isLoggingScrubbingSequence=!1;f.shouldLogRequestedPlayingForScrub=!1;g!=="paused"&&g!=="ended"&&(f.canLogPlayingEvent=!0);return b}else return b}function y(a,c,e){if(a.controlledState.playbackState==="stalling"&&c.controlledState.playbackState==="playing"&&f.canLogPlayingEvent){e={client_time_ms:c.uncontrolledState.clockTimestamp.toString(),event_name:"started_playing",media_time_ms:o({state:c}),player_instance_key:d.instanceKey};n({event:e,state:c});f.canLogPlayingEvent=!1;f.hasPendingRequestedPlaying=!1;return b}else return b}function z(a,c,d){if((d.type==="controller_pause_requested"||d.type==="dom_event_pause"&&!f.shouldIgnoreDomPause)&&a.controlledState.playbackState!==c.controlledState.playbackState){s(c);return b}else return b}function A(a,c,d){var e=c.controlledState.playbackState;if(e!=="paused"&&e!=="ended"){d.type==="implementation_video_node_unmounted"?s(a):(d.type==="implementation_unmounted"||d.type==="implementation_engine_destroy_requested")&&s(c);return b}else return b}function B(c,d,e){c=d.controlledState.error;if(c!=null&&c!==f.lastLoggedError&&c.errorCode!=="410"){e=babelHelpers["extends"]({},(e=a.metadataProvider)==null?void 0:e.getErrorMetadata({videoPlayerError:c}),{name:"failed_playing"});e={client_time_ms:d.uncontrolledState.clockTimestamp.toString(),error_metadata:e,event_name:"error",media_time_ms:o({state:d})};n({event:e,state:d});f.lastLoggedError=c}return b}function C(d,e,g){if(g.type==="error_recovery_attempt"&&f.errorRecoveryAttemptState.eventsLogged<i){d=g.payload.recoverableError;if(d!=null&&d.errorName==="OZ_NETWORK"&&!c("NetworkStatus").isOnline())return b;g=babelHelpers["extends"]({},(g=a.metadataProvider)==null?void 0:g.getErrorMetadata({videoPlayerError:d}),{name:"error_recovery_attempt"});d={client_time_ms:e.uncontrolledState.clockTimestamp.toString(),error_metadata:g,event_name:"error",media_time_ms:o({state:e})};n({event:d,state:e});f.errorRecoveryAttemptState.eventsLogged++}return b}function D(a,c,d){d=a.controlledState.playbackState;a=c.controlledState.playbackState;if(f.hasPendingRequestedPlaying||f.shouldLogRequestedPlayingForScrub||f.isLoggingBufferingSequence)return b;if(d!=="stalling"&&a==="stalling"){d={client_time_ms:c.uncontrolledState.clockTimestamp.toString(),event_name:"started_buffering",media_time_ms:o({state:c})};n({event:d,state:c});f.isLoggingBufferingSequence=!0;f.shouldIgnoreDomPause=!0;f.shouldIgnoreDomPlay=!0}return b}function E(a,c,d){a=a.controlledState.playbackState;var e=c.controlledState.playbackState;if(!f.isLoggingBufferingSequence)return b;if((d.type==="dom_event_playing"||d.type==="buffering_end_requested")&&a==="stalling"&&e!=="stalling"){a=0;d.payload.domEventPerfTimestamp!=null&&(a=Math.max(c.uncontrolledState.perfTimestamp-d.payload.domEventPerfTimestamp,0));e=c.uncontrolledState.clockTimestamp-a;d={client_time_ms:e.toString(),event_name:"stopped_buffering",media_time_ms:o({state:c})};n({event:d,state:c});f.isLoggingBufferingSequence=!1;f.shouldIgnoreDomPause=!1;f.shouldIgnoreDomPlay=!1}return b}function F(a,c,d){a=c.controlledState.playbackState;a==="paused"||a==="ended"?f.nextHeartbeatTime=null:a!=="stalling"&&f.nextHeartbeatTime==null&&(f.nextHeartbeatTime=c.uncontrolledState.clockTimestamp+h);d=f.nextHeartbeatTime;if(d!=null){var e=c.uncontrolledState.clockTimestamp;if(e>=d){if(a!=="stalling"){d={client_time_ms:c.uncontrolledState.clockTimestamp.toString(),event_name:"heartbeat",media_time_ms:o({state:c})};n({event:d,state:c})}f.nextHeartbeatTime=e+h}}return b}function G(c,e,g){c=babelHelpers["extends"]({},d.coreVideoPlayerMetaData.additionalSNAPLLogData,l);var h=f.lastLoggedTagMetadata,i=(g=a.metadataProvider)==null?void 0:g.getTagMetadata({logDataAdditions:c,loggingMetaData:d,state:e});if(i&&JSON.stringify(i)!==JSON.stringify(h)){var j={};Object.keys(i).forEach(function(a){if(i[a]!==h[a]){var b;j=babelHelpers["extends"]({},j,(b={},b[a]=i[a],b))}});g={client_time_ms:e.uncontrolledState.clockTimestamp.toString(),event_name:"tags_changed",media_time_ms:o({state:e}),tag_metadata:j};n({event:g,state:e});f.lastLoggedTagMetadata=babelHelpers["extends"]({},h,i)}return b}return{consumeLoggerEvents:function(){return e.length>0?e.splice(0):[]},handleStateMachine:function(a,b,c){p(c);var d=b.controlledState.playbackState,e=[G,u,v,x,D,E,y,q,z,A,B,C,F];e.forEach(function(d){d(a,b,c)});(d==="paused"||d==="ended")&&(f.canLogPlayingEvent=!0);c.type==="controller_pause_requested"&&(f.shouldIgnoreDomPause=!0);c.type==="controller_play_requested"&&(f.shouldIgnoreDomPlay=!0);c.type==="dom_event_pause"&&(f.shouldIgnoreDomPause=!1);c.type==="dom_event_play"&&(f.shouldIgnoreDomPlay=!1)},setSNAPLAdditionalLogData:function(a){Object.assign(l,a)}}}g.HEARTBEAT_INTERVAL=h;g.createMediaPlaybackCompoundEventStateMachineLogger=a}),98);
__d("MediaPlaybackLogFlusher",["MediaPlaybackCompoundEventLogger","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=c("emptyFunction");b=function(){function a(a){this.$1=a}var b=a.prototype;b.flushLogs=function(){var a=this.$1.consumeLoggerEvents();a.forEach(function(a){a.required_metadata.tracking_type==="paid"?c("MediaPlaybackCompoundEventLogger").logCometImmediately(a):c("MediaPlaybackCompoundEventLogger").logComet(a)})};b.discardLogsWithoutFlushing=function(){var a=this.$1.consumeLoggerEvents()};return a}();g["default"]=b}),98);
__d("Mp4Box",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$4=a.getCursor(),this.$1=a.readUint32(),this.$2=a.readChars(4),this.$1===1?this.$1=a.readUint64():this.$1===0&&(this.$1=a.getDataView().byteLength-this.$4),this.$2==="uuid"&&(this.$3=a.readChars(16)),this.$5=a.getCursor()}var b=a.prototype;b.getBodyStart=function(){return this.$5};b.getBodySize=function(){var a=this.$5-this.$4;return this.getSize()-a};b.getSize=function(){return this.$1};b.getType=function(){return this.$2};b.getUuid=function(){return this.$3};b.getStart=function(){return this.$4};b.inspect=function(){return"{ size: "+this.$1+", type: "+this.$2+" }"};return a}();f["default"]=a}),66);
__d("Mp4DASHEventMessageBox",[],(function(a,b,c,d,e,f){a=function(){function a(a,b){this.$1=b,this.$2=null,b.getVersion()==0?this.$2={version:0,schemeIdUri:a.readZeroTerminatedString(this.$4(a,b)),value:a.readZeroTerminatedString(this.$4(a,b)),timescale:a.readUint32(),presentationTimeDelta:a.readUint32(),eventDuration:a.readUint32(),id:a.readUint32()}:b.getVersion()==1&&(this.$2={version:1,timescale:a.readUint32(),presentationTime:a.readUint64(),eventDuration:a.readUint32(),id:a.readUint32(),schemeIdUri:a.readZeroTerminatedString(this.$4(a,b)),value:a.readZeroTerminatedString(this.$4(a,b))}),this.$3=new DataView(a.getDataView().buffer,a.getCursor())}var b=a.prototype;b.getFullBox=function(){return this.$1};b.getEmsgFields=function(){return this.$2};b.getMessageData=function(){return this.$3};b.getStartTime=function(){var a=this.$2;if(a==null)return null;switch(a.version){case 0:return null;case 1:return this.$5(a)}};b.getDuration=function(){var a=this.$2;if(a==null)return null;var b=a.eventDuration;a=a.timescale;return a!==0?b/a:b};b.$5=function(a){var b=a.timescale;a=a.presentationTime;return b!==0?a/b:a};b.$4=function(a,b){return b.getBox().getSize()-(a.getCursor()-b.getBox().getStart())};return a}();a.canonicalType="emsg";f["default"]=a}),66);
__d("Mp4FullBox",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$2=a.readUint8(),this.$1=a.readUint8(),this.$1=a.readUint8()+(this.$1<<8),this.$1=a.readUint8()+(this.$1<<8),this.$3=b}var b=a.prototype;b.getVersion=function(){return this.$2};b.getFlags=function(){return this.$1};b.getBox=function(){return this.$3};return a}();f["default"]=a}),66);
__d("Mp4Demuxer",["DataViewReader","Mp4Box","Mp4FullBox"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=new(c("DataViewReader"))(a)}var b=a.prototype;b.parseBox=function(){return new(c("Mp4Box"))(this.$1)};b.parseFullBox=function(a){return new(c("Mp4FullBox"))(this.$1,a)};b.parseCanonicalBox=function(a,b){return new a(this.$1,b)};b.skipBox=function(a){this.$1.seek(a.getStart()+a.getSize())};b.withinBox=function(a){var b=this.$1.getCursor();return b>=a.getStart()&&b<a.getStart()+a.getSize()};b.atEnd=function(){return this.$1.getCursor()>=this.$1.getDataView().byteLength};b.reset=function(){this.$1.seek(0)};b.readBoxBodyText=function(a){this.$1.seek(a.getBodyStart());var b=new TextDecoder();a=new Uint8Array(this.$1.readBytes(a.getBodySize()));return b.decode(a)};return a}();g["default"]=a}),98);
__d("OzActiveActiveFailoverNetworkRequestStreamHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.onResponse=function(a,b){var c=a.headers;c&&c.has("x-fb-video-replica")&&this.$1(a,b);return null};b.onError=function(a,b){return null};return a}();f["default"]=a}),66);
__d("OzBufferVTTCaptionsVisibleStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.isActive=function(){return!this.$1()};b.getBufferTarget=function(){return 0};return a}();f["default"]=a}),66);
__d("OzCDNSignedQueryParams",["ConstUriUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1={}}var b=a.prototype;b.$2=function(a,b,c){this.$1[a]==null&&(this.$1[a]={}),this.$1[a][b]=c};b.get=function(a){a=this.$1[a];return a==null?null:a};b.update=function(a){a=d("ConstUriUtils").getUri(a);if(a!=null){var b=a.getQueryParams();a=a.getDomain()+a.getPath();var c=b.get("oe");c!=null&&this.$2(a,"oe",String(b.get("oe")));b.get("oh")!=null&&this.$2(a,"oh",String(b.get("oh")))}};return a}();g["default"]=a}),98);
__d("OzCustomParsers",[],(function(a,b,c,d,e,f){function a(){return new Map([["fbProjection",function(a){try{return a.Period[0].AdaptationSet[0].$.FBProjection||null}catch(a){return null}}],["hasInbandCaptionsFromAccessibility",function(a){a=a.Period[0];a=a&&a.AdaptationSet[0].Accessibility;return a&&a[0]?a[0].$.schemeIdUri==="urn:scte:dash:cc:cea-608:2015":!1}],["hasInbandCaptionsFromUsingASRCaptions",function(a){a=Number.parseInt(a.$.usingASRCaptions,0);return!isNaN(a)&&a!=0}],["hasInbandCaptionsFromIsUsingAsrCaptionsEmployeeDogfooding",function(a){a=Number.parseInt(a.$.isUsingAsrCaptionsEmployeeDogfooding,0);return!isNaN(a)&&a!=0}],["hasVTTRepresentationCaptions",function(a){return a.Period[0].AdaptationSet.find(function(a){var b;return((b=a.$.mimeType)==null?void 0:b.startsWith("application"))&&a.$.lang!=null})!=null}],["isLiveTemplated",function(a){return a.$.FBIsLiveTemplated==="true"}],["isFBMS",function(a){return a.$.FBMS==="true"}],["isFBWasLive",function(a){return a.$.FBWasLive==="true"}],["loapStreamType",function(a){return a.$.loapStreamType?parseInt(a.$.loapStreamType,10):0}],["fbManifestIdentifier",function(a){return(a=a.$.FBManifestIdentifier)!=null?a:""}],["lastVideoFrameTs",function(a){return a.$.lastVideoFrameTs?Number.parseInt(a.$.lastVideoFrameTs,10):null}],["currentServerTimeMs",function(a){return a.$.currentServerTimeMs?Number.parseInt(a.$.currentServerTimeMs,10):null}],["validationErrors",function(a){return(a=a.$.validationErrors)!=null?a:""}]])}f.createOzCustomParser=a}),66);
__d("oz-player/manifests/OzSegmentOptions",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=!1,this.$2=null}var b=a.prototype;b.setSegmentNumDecisionTime=function(a){this.$2=a};b.getSegmentNumDecisionTime=function(){return this.$2};b.setIsDVLEnabled=function(a){this.$1=a};b.isDVLEnabled=function(){return this.$1};return a}();f["default"]=a}),66);
__d("oz-player/shims/www/OzURIWWWImplConstUri",["ConstUriUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.getQueryParams();var b={};a.forEach(function(a,c){typeof a==="string"||typeof a==="number"?b[c]=a:b[c]=String(a)});return b}a=function(){function a(a){this.$1=d("ConstUriUtils").getUri(a);if(this.$1==null)throw c("err")("Invalid URI passed to OzURI");this.$2=h(this.$1)}var b=a.prototype;b.addQueryData=function(a,b){var c=this.$1;if(typeof a==="string"){var d;c=(d=c)==null?void 0:d.addQueryParam(a,b===void 0?"":b)}else{var e=new Map();Object.keys(a).forEach(function(b){e.set(b,a[b])});c=(d=c)==null?void 0:d.addQueryParams(e)}c!=null&&(this.$1=c,this.$2=h(this.$1))};b.getQueryData=function(){return this.$2};b.getDomain=function(){var a;return(a=(a=this.$1)==null?void 0:a.getDomain())!=null?a:""};b.toString=function(){var a;return(a=(a=this.$1)==null?void 0:a.toString())!=null?a:""};b.getPath=function(){var a;return(a=(a=this.$1)==null?void 0:a.getPath())!=null?a:""};return a}();g["default"]=a}),98);
__d("oz-player/shims/www/OzURIWWW",["oz-player/shims/www/OzURIWWWImplConstUri"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzURIWWWImplConstUri")}),98);
__d("oz-player/shims/OzURI",["oz-player/shims/www/OzURIWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzURIWWW")}),98);
__d("oz-player/utils/ozConcatUint8Arrays",["oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=0;for(var c=0;c<a.length;++c)b+=a[c].byteLength;var e,f;try{e=new ArrayBuffer(b),f=new Uint8Array(e)}catch(a){throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_ALLOCATION_FAILURE",description:a.name+": "+a.message})}c=0;for(b=0;b<a.length;++b){var g=a[b];f.set(g,c);c+=g.byteLength}return{buffer:e,view:f}}g["default"]=a}),98);
__d("oz-player/utils/OzReadableStreamUtils",["oz-player/utils/ozConcatUint8Arrays"],(function(a,b,c,d,e,f,g){"use strict";var h=typeof TextDecoder!=="undefined"?function(a){return new TextDecoder("utf-8").decode(new Uint8Array(a))}:function(a){return String.fromCharCode.apply(null,a)};function i(a){var b=[],d=function c(){return a.read().then(function(a){var d=a.value;a=a.done;if(a)return null;if(!d)return null;b.push(d);return c()})};return d().then(function(){var a=c("oz-player/utils/ozConcatUint8Arrays")(b);a=a.view;return a})}function a(a){return i(a).then(function(a){return h(a)})}function b(a){var b=new Uint8Array(a.length);return b.map(function(b,c){return a.charCodeAt(c)})}g.pumpAllData=i;g.pumpString=a;g.stringToUint8Array=b}),98);
__d("OzCustomRepresentationParsers",["oz-player/manifests/OzSegmentOptions","oz-player/shims/OzURI","oz-player/utils/OzReadableStreamUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.ozConfig,e=a.startTimestamp;a={timescale:function(a){a=a.SegmentTemplate;if(a&&a.length>0){a=a[0].$;if(a)return Number.parseInt(a.timescale,0)||null}return null}};b.getBool("parse_initialization_binary",!1)&&(a.initializationBinary=function(a){try{a=window.atob(a.FBInitializationBinary[0]._);return d("oz-player/utils/OzReadableStreamUtils").stringToUint8Array(a)}catch(a){return null}});a.playbackResolutionMos=function(a){try{return a.$.FBPlaybackResolutionMos}catch(a){return null}};a.playbackResolutionCsvqm=function(a){try{return a.$.FBPlaybackResolutionCsvqm}catch(a){return null}};a.qualityLabel=function(a){try{return a.$.FBQualityLabel}catch(a){return null}};b.getBool("parse_first_segment",!1)&&(a.firstSegmentParser=function(a){if(e!=null&&e>0)return null;try{var b=a.SegmentBase[0].$.FBFirstSegmentRange.split("-").map(Number),d={startByte:b[0],endByte:b[1]};b=a.BaseURL[0]._;var f=new(c("oz-player/shims/OzURI"))(b),g=new(c("oz-player/manifests/OzSegmentOptions"))();return{getData:function(){return null},getURI:function(){return f},getByteRange:function(){return d},getTimeRange:function(){return{startTime:0,endTime:2}},getSequenceNumber:function(){return null},getOptions:function(){return g}}}catch(a){return null}});return a}g.createOzCustomRepresentationParsers=a}),98);
__d("OzDOMEventListenerImpl",["CometEventListener"],(function(a,b,c,d,e,f,g){"use strict";a={listenDOMEvent:c("CometEventListener").listen,captureDOMEvent:c("CometEventListener").capture,suppressDOMEvent:c("CometEventListener").suppress};b=a;g["default"]=b}),98);
__d("OzMinimumSmallestDimensionRestriction",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.applyRestriction=function(a){var b=this;if(a.length===0)return[];var c=a.filter(function(a){var c=a.getWidth();a=a.getHeight();c=c<a?c:a;return c>=b.$1});return c.length>0?c:[a[a.length-1]]};return a}();f["default"]=a}),66);
__d("OzMosThresholdRestriction",["MosUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$3=new Map(),this.$4=a,this.$1=a.getNumber("mos_upper_threshold",0),this.$2=a.getNumber("mos_lower_threshold",0)}var b=a.prototype;b.$5=function(){return this.$4.getBool("cache_mos_threshold",!1)?{mosUpperThreshold:this.$1,mosLowerThreshold:this.$2}:{mosUpperThreshold:this.$4.getNumber("mos_upper_threshold",0),mosLowerThreshold:this.$4.getNumber("mos_lower_threshold",0)}};b.$6=function(a,b){var c=null;if(this.$3.get(a))c=this.$3.get(a);else{var e=a.getCustomField("playbackResolutionMos");e!=null&&(c=d("MosUtils").parsePlaybackMos(String(e)),c&&this.$3.set(a,c))}return c!=null?d("MosUtils").getMosValue(c,d("MosUtils").getQualityLabel(b.width,b.height)):null};b.$7=function(a,b){var c=this,d=null,e=this.$5(),f=e.mosUpperThreshold;a.forEach(function(a){a=c.$6(a,b);a!=null&&a>f&&(d==null||d>a)&&(d=a)});return d==null?a.slice():a.filter(function(a){a=c.$6(a,b);return a==null?!0:a<=f||a===d})};b.$8=function(a,b){var c=this,d=[],e=this.$5(),f=e.mosLowerThreshold;a.forEach(function(a){var e=c.$6(a,b);e!=null&&e>f&&d.push(a)});d.length===0&&d.push(a[a.length-1]);return d};b.applyRestriction=function(a,b){if(a.length===0)return[];var c=this.$5(),d=c.mosLowerThreshold;c=c.mosUpperThreshold;var e;if(c>0){e=this.$7((c=e)!=null?c:a,b)}if(d>0){e=this.$8((c=e)!=null?c:a,b)}return(d=e)!=null?d:a.slice()};return a}();g["default"]=a}),98);
__d("OzOneSemanticHandlerUtils",["ConstUriUtils","qex","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){b!=null&&(b.indexOf("+RE")>=0&&a.retry()),c!=null&&c()}function a(a,b){var d=b.error;d=d.getExtra();var e=d.code;d=d.headers;var f=null;e==null&&c("recoverableViolation")("A ONE Semantic error response must have an error code.","comet_video_player");d==null&&c("recoverableViolation")("A ONE Semantic error response must contain response Headers.","comet_video_player");if(d!=null){d=d.get("x-fb-one-variant");f=(d=d)!=null?d:null}d=JSON.parse(a.getString("network_retry_intervals_json","{}"));a=d[e];switch(e){case"410":b.endStream();break;case"404":h(b,f,function(){b.retry({behavior:"recover_failed_request"})});break;case"429":b.retry(a);break;case"403":default:}}function i(a){if(a!=null){a=parseInt(a,10);if(3>0)return!isNaN(a)&&a>0&&a<=3}return!1}function j(a,b){if(a!=null&&b!=null){a=parseInt(a,10);b=parseInt(b,10);return!isNaN(a)&&!isNaN(b)&&a>0&&a<=b}return!1}function k(a){if(a!=null){a=d("ConstUriUtils").getUri(a);if(a){a=a.getQueryParam("os_param");return a?String(a).toString():null}}return null}function l(a,b){var d=a!=null;return i(b)||(d||!!c("qex")._("1636"))&&j(b,a)}function b(a){var b=a.getExtra();b=b.headers;b=m(b);a=a.getExtra();var d=a.code;a=a.url;if(b!=null&&d==null){c("recoverableViolation")("A ONE Semantic error response must have an error code.","comet_video_player");return!1}d=k(a);return l(d,b)}function m(a){if(a){a=a.get("x-fb-one");if(a!=null)return parseInt(a,10)>0?a:null}return null}function e(a,b,c){var d=null,e=null;b!=null&&(d=k(b),d!=null&&a.setOneReqWave(parseInt(d,10)));b=c==null?void 0:c.headers;b&&(e=m(b),e!=null&&a.setOneResWave(parseInt(e,10)));a.setOneObserved(l(d,e))}g.maybeRetryForVariant=h;g.evaluateOneSemanticsResponse=a;g.isOneSemanticsForcedForResponseWave=i;g.isOneSemanticsEnabledForWave=j;g.getOneSemanticRequestWave=k;g.shouldRespondWithOneSemantics=b;g.getOneSemanticResponseWave=m;g.setOneSemanticFetchStreamLoggingAttributes=e}),98);
__d("handleOzManifestFetchErrorEvent",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=a.getNumber("initial_manifest_request_retry_count",0),d=JSON.parse(a.getString("network_retry_intervals_json","{}")),e=a.getNumber("live_max_try_attempts_on_404",1),f=["404","503"];a.getBool("live_gracefully_handle_no_network",!1)&&f.push("0");a.getBool("live_gracefully_handle_410",!1)&&f.push("410");a.getBool("live_gracefully_handle_502",!1)&&f.push("502");a.getBool("live_gracefully_handle_429",!1)&&f.push("429");a.getBool("live_gracefully_handle_504",!1)&&f.push("504");a.getBool("normalize_mpd_fetch_errors",!1)&&f.push("20");var g=b.error.getExtra().code;if(a.getBool("no_retry_on_empty_string_error_code",!1)&&g==="")return;a.getBool("handle_mpd_null_error_codes",!1)&&(g=g!=null?g:null);d=d[g];if(b.isInitialRequest)typeof d==="number"&&d>0&&b.retryAttemptCount<c&&b.retry({waitMs:d});else if(g!=null&&f.indexOf(g)>-1)switch(g){case"410":b.endStream();break;case"404":e<b.consecutiveFailuresForErrorCode&&b.retry();break;case"504":case"502":case"503":case"20":case"0":b.retry();break;case"429":typeof d==="number"&&d>0&&b.retry({waitMs:d});break;default:break}else g===null&&a.getBool("handle_mpd_null_error_codes",!1)&&b.retry()}f["default"]=a}),66);
__d("handleOzStreamErrorEvent",[],(function(a,b,c,d,e,f){"use strict";var g=[0,1,1,2,3,5,8,13,21,34];function a(a,b){var c=b.error.getExtra().code;if(a.getBool("no_retry_on_empty_string_error_code",!1)&&c==="")return;if(a.getBool("retry_null_error_code_in_stream",!1)&&c==null){b.retry();return}var d=JSON.parse(a.getString("network_end_broadcasts_json","[]"));if(d.includes(c)){b.endStream();return}d=JSON.parse(a.getString("network_skip_json","[]"));if(d.includes(c)){b.retry();return}d=a.getBool("back_off_pdash_504_retry",!0)?g[b.retryAttemptCount]:0;var e=JSON.parse(a.getString("network_reload_mpd_json","[]")),f=a.getBool("fix_reload_manifest_retry",!1);if(a.getBool("back_off_pdash_504_retry",!0)&&d==null&&(!f||e.includes(c)))return;if(d!=null&&e.includes(c)){a.getBool("network_reload_mpd_json_retry",!1)?b.retry({behavior:"recover_failed_request",waitMs:d*1e3}):b.retry({waitMs:d*1e3});return}f=JSON.parse(a.getString("network_retry_intervals_json",'{"0": 1000, "404": 2000, "502": 1000, "503": 1000, "504": 1000}'));e=c!=null?f[c]:null;if(e!=null){a.getBool("network_retry_intervals_json_retry",!1)?b.retry({behavior:"retry_failed_request",waitMs:e}):b.retry({waitMs:e});return}}f["default"]=a}),66);
__d("OzOneSemanticHandler",["OzOneSemanticHandlerUtils","handleOzManifestFetchErrorEvent","handleOzStreamErrorEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=b.error;d("OzOneSemanticHandlerUtils").shouldRespondWithOneSemantics(e)?d("OzOneSemanticHandlerUtils").evaluateOneSemanticsResponse(a,b):c("handleOzManifestFetchErrorEvent")(a,b)}function b(a,b){var e=b.error;d("OzOneSemanticHandlerUtils").shouldRespondWithOneSemantics(e)?d("OzOneSemanticHandlerUtils").evaluateOneSemanticsResponse(a,b):c("handleOzStreamErrorEvent")(a,b)}g.handleManifestFetchErrorEvent=a;g.handleStreamErrorEvent=b}),98);
__d("oz-player/shims/www/ozvariantWWW",["invariant"],(function(a,b,c,d,e,f,g,h){a=h;g["default"]=a}),98);
__d("oz-player/shims/ozvariant",["oz-player/shims/www/ozvariantWWW"],(function(a,b,c,d,e,f,g){g["default"]=c("oz-player/shims/www/ozvariantWWW")}),98);
__d("oz-player/utils/OzNumericalHelper",[],(function(a,b,c,d,e,f){"use strict";var g=1e-5;function h(a,b,c){c===void 0&&(c=g);return Math.abs(b-a)<=c}function i(a,b,c){c===void 0&&(c=g);return a>b&&!h(a,b,c)}function j(a,b,c){c===void 0&&(c=g);return a<b&&!h(a,b,c)}function a(a,b,c){c===void 0&&(c=g);return j(a,b,c)||h(a,b,c)}function b(a,b,c){c===void 0&&(c=g);return i(a,b,c)||h(a,b,c)}f.equalTo=h;f.greaterThan=i;f.lessThan=j;f.lessThanOrEqual=a;f.greaterThanOrEqual=b}),66);
__d("oz-player/utils/OzNumericalRangeUtil",["oz-player/utils/OzNumericalHelper"],(function(a,b,c,d,e,f,g){"use strict";var h=.01;function i(a,b){b=b.rangeEnd;return b==null?!1:Math.abs(a.rangeStart-b)>h&&a.rangeStart>b}function j(a,b){a=a.rangeEnd;b=b.rangeEnd;if(a==null)return!0;return b==null?!1:Math.abs(a-b)>h&&a>b}function k(a,b,c,d){a=c.rangeEnd;return a==null?!1:b===a||Math.abs(b-a)>((c=d)!=null?c:h)&&b>a}function a(a,b,c){var d=b.rangeEnd;if(d==null)return!1;c=(c=c)!=null?c:h;return a-b.rangeStart>=c&&d-a>=c}function l(a,b){return a>b-h}function b(a){if(!a.length)return[];var b=[],c=a[0];b.push(c);for(var d=1;d<a.length;d++){var e=a[d];if(!j(e,c))continue;else i(e,c)?(c={rangeStart:e.rangeStart,rangeEnd:e.rangeEnd},b.push(c)):c.rangeEnd=e.rangeEnd}return b}function c(a,b,c){return b.reduceRight(function(b,d){k(a,d.rangeStart,c)||k(a,c.rangeStart,d)?b.push(d):(c.rangeEnd!=null&&(d.rangeEnd==null||k(a,d.rangeEnd,c))&&b.push({rangeStart:c.rangeEnd,rangeEnd:d.rangeEnd}),l(c.rangeStart,d.rangeStart)&&b.push({rangeStart:d.rangeStart,rangeEnd:c.rangeStart}));return b},[]).filter(function(a){return a.rangeEnd==null||a.rangeStart<a.rangeEnd}).reverse()}function e(a,b,c,d){d===void 0&&(d=h);for(var e=0;e<c.length;e++){var f=c[e],g=f.rangeStart;if(l(b,g)&&!k(a,b,f,d))return e}return-1}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d=d.rangeStart;if(!l(a,d))return c}return-1}function m(a,b,c){return a>=b?0:c.reduceRight(function(c,d){var e=d.rangeStart;d=d.rangeEnd;if(b<e||d!=null&&a>d)return c;else if(d==null||b<=d)return Math.min(b-e,b-a)+c;else if(a>=e)return Math.min(d-a,b-a)+c;else return d-e+c},0)}function n(a,b){var c;c=a.length==0?(c=b[b.length-1])!=null?c:null:null;for(var e=0;e<a.length;e++){var f=a[e];for(var g=e;g<b.length;g++){var h=b[g];if(d("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)&&f.rangeEnd!=null&&h.rangeEnd!=null&&d("oz-player/utils/OzNumericalHelper").equalTo(f.rangeEnd,h.rangeEnd))break;else if(h.rangeEnd!=null&&f.rangeEnd!=null&&!d("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)){c={rangeStart:h.rangeStart,rangeEnd:h.rangeEnd};break}else if(h.rangeEnd!=null&&f.rangeEnd!=null&&d("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)&&!d("oz-player/utils/OzNumericalHelper").equalTo(f.rangeEnd,h.rangeEnd)){c={rangeStart:f.rangeEnd,rangeEnd:h.rangeEnd};break}}if(c!==null)break}return c}function o(a){var b=[];for(var c=0;c<a.length;c++)b.push({rangeStart:a[c].startTime,rangeEnd:a[c].endTime});return b}g.isAfter=k;g.isWithin=a;g.isLargerThan=l;g.mergeSortedRanges=b;g.diffSortedRanges=c;g.findCurrentRangeIndex=e;g.findNextRangeIndex=f;g.findDiffCoveredByRanges=m;g.firstAddedInSortedRanges=n;g.convertFromTimeRanges=o}),98);
__d("oz-player/manifests/SegmentTemplateSegmentsContainer",["oz-player/manifests/OzSegmentOptions","oz-player/shims/OzEventEmitter","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzNumericalHelper","oz-player/utils/OzNumericalRangeUtil"],(function(a,b,c,d,e,f,g){"use strict";var h=1e-4;a=function(){function a(a,b,d,e,f,g){g===void 0&&(g=!1),this.$7=new(c("oz-player/shims/OzEventEmitter"))(),this.$10=null,this.$8=a,this.$2=b,this.$3=d,this.$1=f,this.$4=e,this.$5=this.$11(this.$4),this.$6=g,this.$9=this.$8.getNumber("live_numerical_error_epsilon")}var b=a.prototype;b.getSegmentByTime=function(a){a=this.$12(a);a=a*this.$3;var b=null;for(var c=this.$4.length-1;c>=0;c--){var e=this.$4[c];if(d("oz-player/utils/OzNumericalHelper").lessThanOrEqual(e.t+e.d*(e.r+1),a,this.$9))break;b=e}if(b===null)return null;if(d("oz-player/utils/OzNumericalHelper").greaterThan(b.t,a,this.$9))return null;e=Math.max(0,Math.floor((a-b.t+this.$9)/b.d));return this.$13(b,e)};b.getSegment=function(a){var b=0;a=a;while(a>=0&&b<this.$4.length){var c=this.$4[b];c=c.r;c=c+1;if(a>=c){a-=c;b++;continue}break}c=this.$4[b];return!c?null:this.$13(c,a)};b.getSegmentAfter=function(a){a=a.getTimeRange().endTime;return this.getSegmentByTime(a)};b.getPredictedSegmentAfter=function(a){return null};b.canPredict=function(){return!1};b.canApproximateId=function(){return!1};b.isEndingSegment=function(a){if(!this.$4||!this.$4.length||!this.$6)return!1;var b=this.$4[this.$4.length-1],c=b.r;b=this.$13(b,c);return Math.abs(b.getTimeRange().startTime-a.getTimeRange().startTime)+Math.abs(b.getTimeRange().endTime-a.getTimeRange().endTime)<h};b.updateWith=function(b){b instanceof a||c("oz-player/shims/ozvariant")(0,646),this.$6=b.$6,this.$14(b.$4),this.$15(b.$4),this.$7.emit("segment_updated")};b.getTimeRanges=function(){return this.$10?this.$16(this.$5,this.$10):this.$5};b.blockTimeRange=function(a){this.$10=a};b.$16=function(a,b){return d("oz-player/utils/OzNumericalRangeUtil").diffSortedRanges(this.$8,a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}),{rangeStart:b.startTime,rangeEnd:b.endTime}).map(function(a){return{startTime:a.rangeStart,endTime:a.rangeEnd==null?Infinity:a.rangeEnd}})};b.addUpdateListener=function(a){return this.$7.addListener("segment_updated",a)};b.$12=function(a){var b=a,c=d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(this.$8,a,this.getTimeRanges().map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));if(c===-1){c=d("oz-player/utils/OzNumericalRangeUtil").findNextRangeIndex(a,this.getTimeRanges().map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));c!==-1&&(b=this.getTimeRanges()[c].startTime)}return b};b.$14=function(a){var b;(b=this.$4).splice.apply(b,[0,this.$4.length].concat(a));return};b.$15=function(a){a=this.$11(a);a=d("oz-player/utils/OzNumericalRangeUtil").mergeSortedRanges(this.$5.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}).concat(a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}})));this.$5=a.map(function(a){return{startTime:a.rangeStart,endTime:a.rangeEnd==null?Infinity:a.rangeEnd}})};b.$11=function(a){var b=this;a=d("oz-player/utils/OzNumericalRangeUtil").mergeSortedRanges(this.$4.map(function(a){var c=b.$13(a,0).getTimeRange().startTime;a=b.$13(a,a.r).getTimeRange().endTime;return{rangeStart:c,rangeEnd:a}}));return a.map(function(a){var b=a.rangeStart;a=a.rangeEnd;a=a==null?Infinity:a;return{startTime:b,endTime:a}})};b.$13=function(a,b){var d=this;b===void 0&&(b=0);var e=a.t,f=a.d,g=a.r;a=a.id;var h=e+f*b,i=this.$8.getBool("use_scf_timebased_segments"),j=a!=null?a-(g-b):null,k=new(c("oz-player/manifests/OzSegmentOptions"))();return{getData:function(){return null},getURI:function(){var a="";d.$1!=null&&j!=null?a=d.$1.replace("$Number$",j.toString()):j!=null&&d.$2.indexOf("$Number$")!==-1&&d.$8.getBool("parse_number_templated_uri")?a=d.$2.replace("$Number$",j.toString()):a=d.$2.replace("$Time$",h.toString());a=new(c("oz-player/shims/OzURI"))(a);i&&a.addQueryData("_nc_scf",1);return a},getTimeRange:function(){return{startTime:h/d.$3,endTime:(h+f)/d.$3}},getByteRange:function(){return null},getSequenceNumber:function(){return null},getOptions:function(){return k}}};b.getSegmentGroups=function(){return this.$4};b.getEndingSegment=function(){if(this.$4.length==0)return null;var a=this.$4[this.$4.length-1],b=a.r;return this.$13(a,b)};b.forceParseIfNotParsed=function(){};b.getMaxGopSec=function(){return null};return a}();g["default"]=a}),98);
__d("oz-player/utils/OzUrlHelper",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a;var b=a.indexOf("://"),c=a.indexOf("/",b+3);c>b&&(a=a.substring(c));return a}function g(a){a=a;var b=a.lastIndexOf("/"),c=a.lastIndexOf("://");b>c+2&&(a=a.substring(0,b+1));return a}function h(a){a=a;a=g(a);return a.endsWith("/")?g(a.substring(0,a.length-1)):a}function i(a,b){a=g(a);b=b;while(b.length)if(b.startsWith("./"))b=b.substring(2);else if(b.startsWith("../"))b=b.substring(3),a=h(a),a.endsWith("/")&&(a=a.substring(0,a.length-1));else if(b.startsWith(".."))b=b.substring(2),a=h(a);else if(b.startsWith("."))b=b.substring(1);else break;b&&b.length&&(a.endsWith("/")||(a+="/"),a+=b);return a}function j(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];if(!b||!b.length)return"";if(b.length===1)return b[0];var d=b.shift();while(b.length>0)d=i(d,b.shift());return d}function b(a,b){return k(b)?b:j(a,b)}function k(a){var b=/^https?:\/\//i;return b.test(a)}f.stripToPathAndQueryOnly=a;f.joinRelativeUrlPaths=j;f.joinUrlPaths=b}),66);
__d("PredictedSegmentTemplateSegmentsContainer",["oz-player/manifests/OzSegmentOptions","oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzNumericalHelper","oz-player/utils/OzNumericalRangeUtil","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k){k===void 0&&(k=!1);c=a.call(this,b,c,e,f,null,k)||this;c.$PredictedSegmentTemplateSegmentsContainer$p_9=0;c.$PredictedSegmentTemplateSegmentsContainer$p_11=null;c.$PredictedSegmentTemplateSegmentsContainer$p_10=d;c.$PredictedSegmentTemplateSegmentsContainer$p_8=k;c.$PredictedSegmentTemplateSegmentsContainer$p_12=f;c.$PredictedSegmentTemplateSegmentsContainer$p_7=b;c.$PredictedSegmentTemplateSegmentsContainer$p_5=e;c.$PredictedSegmentTemplateSegmentsContainer$p_1=g;c.$PredictedSegmentTemplateSegmentsContainer$p_3=i;c.$PredictedSegmentTemplateSegmentsContainer$p_2=h;c.$PredictedSegmentTemplateSegmentsContainer$p_4=j;c.$PredictedSegmentTemplateSegmentsContainer$p_6=b.getNumber("live_numerical_error_epsilon");for(d=0;d<c.$PredictedSegmentTemplateSegmentsContainer$p_12.length;d++)c.$PredictedSegmentTemplateSegmentsContainer$p_9=Math.max(c.$PredictedSegmentTemplateSegmentsContainer$p_12[d].d,c.$PredictedSegmentTemplateSegmentsContainer$p_9);return c}var e=b.prototype;e.$PredictedSegmentTemplateSegmentsContainer$p_13=function(){if(this.$PredictedSegmentTemplateSegmentsContainer$p_2!=null&&this.$PredictedSegmentTemplateSegmentsContainer$p_4!=null)return{predictedAverageDuration:this.$PredictedSegmentTemplateSegmentsContainer$p_4,predictedMediaStartNumber:this.$PredictedSegmentTemplateSegmentsContainer$p_2};else return null};e.$PredictedSegmentTemplateSegmentsContainer$p_14=function(a,b,e){var f=this;Number.isNaN(e)&&c("oz-player/shims/ozvariant")(0,54238);var g=this.$PredictedSegmentTemplateSegmentsContainer$p_1.replace("$Number$",e.toString()),h=this.$PredictedSegmentTemplateSegmentsContainer$p_7.getLegacyConfig().getString("cdn_experiment_id",""),i=this.$PredictedSegmentTemplateSegmentsContainer$p_7.getLegacyConfig().getNumber("use_dvl_with_timeout_ms",0),j=new(c("oz-player/manifests/OzSegmentOptions"))();return{getByteRange:function(){return null},getData:function(){return null},getOptions:function(){return j},getSequenceNumber:function(){return e},getTimeRange:function(){return{endTime:b,startTime:a}},getURI:function(){var a=new(c("oz-player/shims/OzURI"))(g);h.length!==0&&a.addQueryData("_nc_expid",h);var b=j.isDVLEnabled();b&&i>0&&f.$PredictedSegmentTemplateSegmentsContainer$p_10!=null&&(a.addQueryData("_nc_dinfo-manifest-url",d("oz-player/utils/OzUrlHelper").stripToPathAndQueryOnly(f.$PredictedSegmentTemplateSegmentsContainer$p_10)),a.addQueryData("_nc_dinfo-timeout",i));return a}}};e.updateWith=function(d){d instanceof b||c("oz-player/shims/ozvariant")(0,646);this.$PredictedSegmentTemplateSegmentsContainer$p_3=d.$PredictedSegmentTemplateSegmentsContainer$p_3;this.$PredictedSegmentTemplateSegmentsContainer$p_1=d.$PredictedSegmentTemplateSegmentsContainer$p_1;a.prototype.updateWith.call(this,d);this.$PredictedSegmentTemplateSegmentsContainer$p_12=d.$PredictedSegmentTemplateSegmentsContainer$p_12;this.$PredictedSegmentTemplateSegmentsContainer$p_8=d.$PredictedSegmentTemplateSegmentsContainer$p_8;for(d=0;d<this.$PredictedSegmentTemplateSegmentsContainer$p_12.length;d++)this.$PredictedSegmentTemplateSegmentsContainer$p_9=Math.max(this.$PredictedSegmentTemplateSegmentsContainer$p_12[d].d,this.$PredictedSegmentTemplateSegmentsContainer$p_9)};e.getSegmentByTime=function(a){return this.canApproximateId()?this.$PredictedSegmentTemplateSegmentsContainer$p_15(a):this.$PredictedSegmentTemplateSegmentsContainer$p_16(a)};e.getPredictedSegmentAfter=function(a){a=a!=null?a.getSequenceNumber():null;return a!=null&&this.canPredict()?this.$PredictedSegmentTemplateSegmentsContainer$p_14(0,0,a+1):null};e.blockTimeRange=function(b){this.$PredictedSegmentTemplateSegmentsContainer$p_11=b,a.prototype.blockTimeRange.call(this,b)};e.getTimeRanges=function(){var b=this.$PredictedSegmentTemplateSegmentsContainer$p_13();if(b){b=[{endTime:(this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].t+this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].d)/this.$PredictedSegmentTemplateSegmentsContainer$p_5,startTime:(this.$PredictedSegmentTemplateSegmentsContainer$p_12[0].t-b.predictedAverageDuration-(this.$PredictedSegmentTemplateSegmentsContainer$p_3-this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-Number(this.$PredictedSegmentTemplateSegmentsContainer$p_2))*Number(b.predictedAverageDuration))/this.$PredictedSegmentTemplateSegmentsContainer$p_5}];var c=this.$PredictedSegmentTemplateSegmentsContainer$p_11;return c==null?b:d("oz-player/utils/OzNumericalRangeUtil").diffSortedRanges(this.$PredictedSegmentTemplateSegmentsContainer$p_7,b.map(function(a){return{rangeEnd:a.endTime,rangeStart:a.startTime}}),{rangeEnd:c.endTime,rangeStart:c.startTime}).map(function(a){return{endTime:a.rangeEnd==null?Infinity:a.rangeEnd,startTime:a.rangeStart}})}else return a.prototype.getTimeRanges.call(this)};e.canPredict=function(){return!0};e.canApproximateId=function(){var a=this.$PredictedSegmentTemplateSegmentsContainer$p_13();return a!=null};e.$PredictedSegmentTemplateSegmentsContainer$p_16=function(a){var b=null;a=a*this.$PredictedSegmentTemplateSegmentsContainer$p_5;var e=this.$PredictedSegmentTemplateSegmentsContainer$p_12.length>0?this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].t+this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].d:null,f=this.$PredictedSegmentTemplateSegmentsContainer$p_7.getLegacyConfig().getNumber("pdash_future_edgelatency_gops",0);if(e!=null&&e<=a&&f!==0&&a<e+this.$PredictedSegmentTemplateSegmentsContainer$p_9*f){e=a-(this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].t+this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1].d);e=this.$PredictedSegmentTemplateSegmentsContainer$p_9?0:Math.floor(e/this.$PredictedSegmentTemplateSegmentsContainer$p_9);return this.$PredictedSegmentTemplateSegmentsContainer$p_14(0,0,this.$PredictedSegmentTemplateSegmentsContainer$p_3+1+e)}e=0;for(var g=0;this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1-g>=0;g++){var h=this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1-g];h.r===0||c("oz-player/shims/ozvariant")(0,18769);if(d("oz-player/utils/OzNumericalHelper").lessThanOrEqual(h.t+h.d*(h.r+1),a,this.$PredictedSegmentTemplateSegmentsContainer$p_6))break;b=h;e=g}if(b===null||f>0&&a<b.t)return null;else return this.$PredictedSegmentTemplateSegmentsContainer$p_14(b.t/this.$PredictedSegmentTemplateSegmentsContainer$p_5,(b.t+b.d)/this.$PredictedSegmentTemplateSegmentsContainer$p_5,this.$PredictedSegmentTemplateSegmentsContainer$p_3-e)};e.$PredictedSegmentTemplateSegmentsContainer$p_15=function(a){var b=a*this.$PredictedSegmentTemplateSegmentsContainer$p_5,c=this.getTimeRanges();if(d("oz-player/utils/OzNumericalHelper").greaterThan(c[0].startTime,a))return null;else if(d("oz-player/utils/OzNumericalHelper").lessThanOrEqual(this.$PredictedSegmentTemplateSegmentsContainer$p_12[0].t,b))return this.$PredictedSegmentTemplateSegmentsContainer$p_16(a);else{c=Math.ceil((this.$PredictedSegmentTemplateSegmentsContainer$p_12[0].t-b)/Number(this.$PredictedSegmentTemplateSegmentsContainer$p_4));b=Math.max(Number(this.$PredictedSegmentTemplateSegmentsContainer$p_2),this.$PredictedSegmentTemplateSegmentsContainer$p_3-this.$PredictedSegmentTemplateSegmentsContainer$p_12.length+1-c);return this.$PredictedSegmentTemplateSegmentsContainer$p_14(a,a+Number(this.$PredictedSegmentTemplateSegmentsContainer$p_4)/this.$PredictedSegmentTemplateSegmentsContainer$p_5,b)}};e.isEndingSegment=function(b){if(!this.$PredictedSegmentTemplateSegmentsContainer$p_8)return!1;var c=b.getSequenceNumber();return c!=null?c>=this.$PredictedSegmentTemplateSegmentsContainer$p_3:a.prototype.isEndingSegment.call(this,b)};e.getEndingSegment=function(){if(this.$PredictedSegmentTemplateSegmentsContainer$p_12.length===0)return null;var a=this.$PredictedSegmentTemplateSegmentsContainer$p_12[this.$PredictedSegmentTemplateSegmentsContainer$p_12.length-1];return this.$PredictedSegmentTemplateSegmentsContainer$p_14(a.t/this.$PredictedSegmentTemplateSegmentsContainer$p_5,(a.t+a.d)/this.$PredictedSegmentTemplateSegmentsContainer$p_5,this.$PredictedSegmentTemplateSegmentsContainer$p_3)};e.getMaxGopSec=function(){return this.$PredictedSegmentTemplateSegmentsContainer$p_9/this.$PredictedSegmentTemplateSegmentsContainer$p_5};return b}(c("oz-player/manifests/SegmentTemplateSegmentsContainer"));g["default"]=a}),98);
__d("oz-player/parsers/OzDefaultSegmentTimelineParser",["oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.parseSegments=function(a,b){a=[];b.SegmentTimeline[0].S&&(a=b.SegmentTimeline[0].S.map(function(a){return{t:Number.parseInt(a.$.t,10),d:Number.parseInt(a.$.d,10),r:Number.parseInt(a.$.r||"0",10),id:a.$.id?Number.parseInt(a.$.id,10):void 0}}));return a};var b=a.prototype;b.parseSegmentsContainer=function(b,e,f){return new(c("oz-player/manifests/SegmentTemplateSegmentsContainer"))(b,d("oz-player/utils/OzUrlHelper").joinUrlPaths(e.baseUrl,f.$.media),Number.parseInt(f.$.timescale,10),a.parseSegments(b,f),null,e.isStaticMpd)};return a}();g["default"]=a}),98);
__d("OzPredictedSegmentTimelineParser",["PredictedSegmentTemplateSegmentsContainer","oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/parsers/OzDefaultSegmentTimelineParser","oz-player/shims/OzURI","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.parseSegmentsContainer=function(a,b,e){var f;if(e.SegmentTimeline[0].$.FBPredictedMedia){f=d("oz-player/utils/OzUrlHelper").joinUrlPaths(b.baseUrl,e.SegmentTimeline[0].$.FBPredictedMedia);var g=new(c("oz-player/shims/OzURI"))(f);g.addQueryData("_nc_sc",1);f=g.toString()}var h;e.SegmentTimeline[0].$.FBPredictedMediaStartNumber&&(h=Number.parseInt(e.SegmentTimeline[0].$.FBPredictedMediaStartNumber,0));var i;e.SegmentTimeline[0].$.FBPredictedMediaEndNumber&&(i=Number.parseInt(e.SegmentTimeline[0].$.FBPredictedMediaEndNumber,0));var j;e.SegmentTimeline[0].$.FBAverageDuration&&(j=Number.parseInt(e.SegmentTimeline[0].$.FBAverageDuration,0));g=c("oz-player/parsers/OzDefaultSegmentTimelineParser").parseSegments(a,e);return(b.isTemplatedMpd&&h!=null&&j!=null||!b.isTemplatedMpd)&&f!=null&&i!=null?new(c("PredictedSegmentTemplateSegmentsContainer"))(a,d("oz-player/utils/OzUrlHelper").joinUrlPaths(b.baseUrl,e.$.media),b.mpdUrl,Number.parseInt(e.$.timescale,10),g,f,h,i,j,b.isStaticMpd):new(c("oz-player/manifests/SegmentTemplateSegmentsContainer"))(a,d("oz-player/utils/OzUrlHelper").joinUrlPaths(b.baseUrl,e.$.media),Number.parseInt(e.$.timescale,10),g,f,b.isStaticMpd)};return a}();g["default"]=a}),98);
__d("oz-player/utils/OzAbrUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){if(d.resolutionConstraintFactor===0)return a.slice();var e=a.filter(function(a){var e=a.getWidth()<=b.width*c*d.resolutionConstraintFactor;a=a.getHeight()<=b.height*c*d.resolutionConstraintFactor;return e&&a});return!e.length?[a[0]]:e}function b(a,b,c,d,e,f){b=b?a.getNumber("min_switch_interval"):a.getNumber("initial_switch_interval");d=d>=a.getNumber("abr_min_bandwidth_samples");var g=a.getNumber("abr_eval_buffer_threshold");c=!g||c>=g;g=null;e+a.getNumber("min_eval_interval")>Date.now()?g="min_eval_interval":f+b>Date.now()?g="min_switch_interval":!d?g="min_bandwidth_samples":c||(g="buffer_threshold_not_satisfied");return g}f.excludeLargeRepresentations=a;f.getReasonToPreventEvaluation=b}),66);
__d("oz-player/utils/OzPlaybackRestrictionsUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){if(c.length===0)return[];a=a.reduce(function(a,c){return c.applyRestriction(a,b)},c);return a}f.applyVideoPlaybackRestrictions=a}),66);
__d("OzSystemicRiskABRUtils",["MosUtils","OzSystemicRiskUtils","QualityScoreUtils","gkx","oz-player/utils/OzAbrUtils","oz-player/utils/OzBufferingUtils","oz-player/utils/OzPlaybackRestrictionsUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=c("gkx")("4400"),i=h?30:60,j=h?5e3:2e3;function k(a,b,c){b=b.getQualityScoreCurveString(a);if(h){a=d("QualityScoreUtils").parseQualityScoreCurve(String(b));return a!=null?d("QualityScoreUtils").calculateQualityScore(a,c,!0):null}else{a=d("MosUtils").parsePlaybackMos(String(b));return a!=null?d("MosUtils").getMosValue(a,d("MosUtils").getQualityLabel(c.width,c.height)):null}}function l(a){var b=j;if(a!=null&&a.length>0){var c=a[0].getTimeRange().startTime;a=a[a.length-1].getTimeRange().endTime;a-c>0&&(b=(a-c)*1e3)}return b}function m(a,b,c,e,f){if(!e.shouldApplyRepresentationRestrictions)return f.slice();var g,h=function(){var a;g=d("oz-player/utils/OzAbrUtils").excludeLargeRepresentations((a=g)!=null?a:f,b,c,{resolutionConstraintFactor:e.resolutionConstraintFactor})},i=function(){var c;g=d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(a,b,(c=g)!=null?c:f)};e.excludeLargeRepresentationsAfterRestrictions||(h(),i());e.excludeLargeRepresentationsAfterRestrictions&&(i(),h());return(i=g)!=null?i:f.slice()}var n={BANDWIDTH:"br",BUFFER:"vb",ENCODING:"er",LOW_MOS:"lm",MULTIPLIER:"m",PREVIOUS_MOS:"pm",PREVIOUS_RESOLUTION:"pr"};function o(a,b,c){if(b==null)return a;a=c.isSystemicRiskABREnabled;var d=c.noRepresentationSelected;c=c.representationCount;b=[[n.LOW_MOS,b.lowMos],[n.ENCODING,b.encoding],[n.BANDWIDTH,b.bandwidth],[n.MULTIPLIER,b.multiplier],[n.BUFFER,b.buffer],[n.PREVIOUS_MOS,b.previousMos],[n.PREVIOUS_RESOLUTION,b.previousResolution]].reduce(function(a,b){var c=b[1],d="";switch(typeof c){case"number":d=c.toFixed(1);break;case"boolean":d=c?"1":"0";break;default:d="null"}return a+(b[0]+": "+d+";")},"");a||(b+="disabled;");d&&(b+="none-selected-of-"+c+";");return b}function a(a){var b=a.videoRepresentations;if(b.length===0)return babelHelpers["extends"]({},a.abrState,{lastEvaluationReason:"no available representations"});var c=d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(a.playheadMediaTimeSec,a.sourceBufferBufferedRangesSec),e=a.mediaDurationSec;e=isNaN(e)||!isFinite(e)?i:e;e=a.durationMode==="static"?(e-a.playheadMediaTimeSec)*1e3:i*1e3;var f=a.systemicRiskConfig.segmentFetchRangeDurationEnabled?l(a.segments):j,g=a.bandwidthDiagnostics;if(g==null)return babelHelpers["extends"]({},a.abrState,{lastEvaluationReason:"missing bandwidth diagnostics"});var n=m(a.videoRepresentationRestrictions,a.playerDimensions,a.devicePixelRatio,a.systemicRiskConfig,b).slice().sort(function(a,b){return a.getBandwidth()-b.getBandwidth()});if(h&&n.length===0)return babelHelpers["extends"]({},a.abrState,{lastEvaluationReason:"no representations after applying restrictions"});var p=null,q=null,r=null;for(var s=0;s<n.length;s++){var t,u,v=n[Math.max(s-1,0)],w=n[s];t=(t=k(a.qualityScoreType,w,a.playerDimensions))!=null?t:0;u=(u=k(a.qualityScoreType,v,a.playerDimensions))!=null?u:0;v=Math.min(v.getHeight(),v.getWidth());v=h?v*a.devicePixelRatio:v;q=d("OzSystemicRiskUtils").getRiskFactorsForRepresentation({bandwidthDiagnostics:g,bitrate:w.getBandwidth(),bufferAheadSec:c,defaultRiskFactor:a.systemicRiskConfig.defaultRiskFactor,documentHiddenRiskFactor:a.systemicRiskConfig.documentHiddenRiskFactor,hasMadeInitialDecision:a.abrState.hasMadeInitialDecision,highEstimateConfidence:a.systemicRiskConfig.highEstimateConfidence,initialRiskFactor:a.systemicRiskConfig.initialRiskFactor,isDocumentHidden:a.isDocumentHidden,lowMosResolution:a.systemicRiskConfig.lowMosResolution,lowMosRiskFactor:a.systemicRiskConfig.lowMosRiskFactor,minWatchableMos:a.systemicRiskConfig.minWatchableMos,previousMos:u,previousResolution:v,remainingVideoDurationMs:e,segmentFetchRangeDurationMs:f});v=q;v=v.multiplier;if(isNaN(v)){r=q;p=a.abrState.bestRepresentation;break}v=d("OzSystemicRiskUtils").isEffectiveBitrateBelowBandwidthEstimate(w.getBandwidth(),q.multiplier,f,g);if(h)if(v&&t>=u)r=q,p=w;else continue;else if(v)r=q,p=w;else break}p==null?t=a.systemicRiskConfig.respectPlaybackRestrictionsInABRFallback&&n.length>0?n[0]:b[0]:t=p;v=o(a.abrState.lastEvaluationReason,(u=r)!=null?u:q,{isSystemicRiskABREnabled:a.systemicRiskConfig.isSystemicRiskABREnabled,noRepresentationSelected:p==null,representationCount:n.length});return{bestRepresentation:t,hasMadeInitialDecision:!0,lastEvaluationReason:v}}g.evaluateSystemicRiskABR=a}),98);
__d("VideoPlayerOzWWWConfig",[],(function(a,b,c,d,e,f){"use strict";var g="oz_www_";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getBool=function(a,b){return this.$1.getBool(g+a,b)};b.getNumber=function(a,b){return this.$1.getNumber(g+a,b)};b.getString=function(a,b){return this.$1.getString(g+a,b)};b.setContext=function(a,b){this.$1.setContext(a,b)};b.getAllContexts=function(){return this.$1.getAllContexts()};return a}();f["default"]=a}),66);
__d("OzSystemicRiskABRManager",["OzSystemicRiskABRUtils","OzSystemicRiskUtils","VideoPlayerOzWWWConfig","oz-player/networks/OzBandwidthEstimator"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d,e,f,g,h,i){this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$6=f,this.$7=g,this.$8=h,this.$9={bestRepresentation:b,hasMadeInitialDecision:!1,lastEvaluationReason:void 0},this.$10=i,this.$1.getBool("enable_abr_logging")&&this.$10.getOperationLogger("abr_initialized").setResult("success").setUserInfo({codecs:c.map(function(a){return a.getCodecs()}).join("|"),displayLabels:c.map(function(a){return a.getDisplayLabel()}).join(","),representationIds:c.map(function(a){return a.getID()}).join(",")}).setRepresentationID(b.getID()).setType("video").setInitiator("OzSystemicRiskABRManager").log()}var b=a.prototype;b.setSourceBuffer=function(a){this.$5=a};b.updateRepresentations=function(a){var b=this,c=this.$2;this.$2=a;var d=this.$9.bestRepresentation,e=this.$2.find(function(a){return a.getDisplayLabel()===b.$9.bestRepresentation.getDisplayLabel()});this.$9=babelHelpers["extends"]({},this.$9,{bestRepresentation:(e=e)!=null?e:this.$2[0]});this.$1.getBool("enable_abr_logging")&&this.$10.getOperationLogger("abr_representations_updated").setResult("success").setRepresentationID(this.$9.bestRepresentation.getID()).setPreviousRepresentationID(d.getID()).setUserInfo({newCodecs:a.map(function(a){return a.getCodecs()}).join("|"),newDisplayLabels:a.map(function(a){return a.getDisplayLabel()}).join(","),previousRepresentationIds:c.map(function(a){return a.getID()}).join(",")}).setType("video").setInitiator("OzSystemicRiskABRManager").log()};b.getBestRepresentation=function(a){var b=this.$1.getLegacyConfig(),e="mos";if(b instanceof c("VideoPlayerOzWWWConfig")){var f=b.getAllContexts();f=String(f.quality_score_type);e=f==="csvqm"?"csvqm":"mos"}f=(f=(f=this.$5)==null?void 0:f.getSourceBufferState().getBufferedRanges())!=null?f:null;var g=this.$4.getCurrentTime(),h=this.$4.getDuration(),i=this.$9.bestRepresentation,j=b.getBool("use_bandwidth_estimate_from_headers_in_abr",!1)?c("oz-player/networks/OzBandwidthEstimator").getBandwidthDiagnosticsFromHeaders(b):c("oz-player/networks/OzBandwidthEstimator").getBandwidthDiagnostics(b);this.$9=d("OzSystemicRiskABRUtils").evaluateSystemicRiskABR({abrState:this.$9,bandwidthDiagnostics:j,devicePixelRatio:this.$6,durationMode:this.$8,isDocumentHidden:document.hidden,mediaDurationSec:h,playerDimensions:this.$7(),playheadMediaTimeSec:g,qualityScoreType:e,segments:a,sourceBufferBufferedRangesSec:f,systemicRiskConfig:d("OzSystemicRiskUtils").getSystemicRiskConfigFromOzPlayerConfig(b),videoRepresentationRestrictions:this.$3,videoRepresentations:this.$2});this.$1.getBool("enable_abr_logging")&&this.$9.bestRepresentation!==i&&this.$10.getOperationLogger("abr_best_representation_selected").setResult("success").setReason(this.$9.lastEvaluationReason).setRepresentationID(this.$9.bestRepresentation.getID()).setPreviousRepresentationID(i==null?void 0:i.getID()).setUserInfo({bandwidthEstimate:String(j==null?void 0:j.bandwidthEstimate),qualityScoreType:e}).setType("video").setInitiator("OzSystemicRiskABRManager").log();return this.$9.bestRepresentation};b.getLastEvaluationReason=function(){return this.$9.lastEvaluationReason};return a}();g["default"]=a}),98);
__d("oz-player/shims/www/OzStreamsWWW",["cr:927622","cr:927623"],(function(a,b,c,d,e,f,g){"use strict";c=Boolean(b("cr:927622"));d=Boolean(b("cr:927623"));e=b("cr:927622")?b("cr:927622").ReadableStream:a.ReadableStream;f=b("cr:927623")?b("cr:927623").WritableStream:a.WritableStream;g.OzReadableStream=e;g.OzReadableStreamIsPolyfilled=c;g.OzWritableStream=f;g.OzWritableStreamIsPolyfilled=d}),98);
__d("oz-player/shims/OzStreams",["oz-player/shims/www/OzStreamsWWW"],(function(a,b,c,d,e,f,g){"use strict";g.OzReadableStream=(a=d("oz-player/shims/www/OzStreamsWWW")).OzReadableStream;g.OzReadableStreamIsPolyfilled=a.OzReadableStreamIsPolyfilled;g.OzWritableStream=a.OzWritableStream;g.OzWritableStreamIsPolyfilled=a.OzWritableStreamIsPolyfilled}),98);
__d("oz-player/networks/OzTransformStream",["oz-player/shims/OzEventEmitter","oz-player/shims/OzStreams","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;var e=(b=b==null?void 0:b.errorTransform)!=null?b:function(a){return a},f,g;c.writable=new(d("oz-player/shims/OzStreams").OzWritableStream)({start:function(a){g=a},write:function(a){c.emit("writableWrite",a);try{c.onDataWritten(a)}catch(a){f.error(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_STREAM",description:"Error from write handler: "+c.constructor.name,extra:{code:"OZ_S-0",originalError:a}}))}f.enqueue(a)},close:function(){c.emit("writableClose");try{c.onClose()}catch(a){f.error(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_STREAM",description:"Error from close handler: "+c.constructor.name,extra:{code:"OZ_S-1",originalError:a}}))}f.close()},abort:function(a){a=e(a);f.error(a)}});c.readable=new(d("oz-player/shims/OzStreams").OzReadableStream)({start:function(a){f=a},cancel:function(a){c.emit("readableCancel",a),g.error(a)}});return c}var c=b.prototype;c.onDataWritten=function(a){};c.onClose=function(){};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/shims/www/OzPerformanceWWW",["performance","performanceNow"],(function(a,b,c,d,e,f,g){var h,i;a={now:function(){return(h||(h=c("performanceNow")))()},getEntriesByName:function(a,b){return typeof (i||(i=c("performance"))).getEntriesByName==="function"?(i||(i=c("performance"))).getEntriesByName(a,b):[]}};b=a;g["default"]=b}),98);
__d("oz-player/shims/OzPerformance",["oz-player/shims/www/OzPerformanceWWW"],(function(a,b,c,d,e,f,g){g["default"]=c("oz-player/shims/www/OzPerformanceWWW")}),98);
__d("oz-player/utils/OzResourceTimingUtils",["oz-player/shims/OzPerformance"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){a=c("oz-player/shims/OzPerformance").getEntriesByName(a,"resource");return a.reduce(function(a,b){return a==null?b:b.responseEnd<a.responseEnd?a:b},null)};g.getLatestResourceTimingEntry=a}),98);
__d("OzVideoLiveTraceNetworkRequestStreamHandler",["oz-player/networks/OzTransformStream","oz-player/utils/OzResourceTimingUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){b===void 0&&(b=!1),this.$2=!1,this.$1=a,this.$2=b}var b=a.prototype;b.onResponse=function(a,b){var e=this,f=a.headers,g=null;if(!this.$1)return null;a=new(c("oz-player/networks/OzTransformStream"))();a.addListener("writableClose",function(){var a={},c=d("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(b);c&&(a.lat=Math.round(c.responseStart-c.requestStart).toString());e.$1&&f&&e.$1(f,g,a)});this.$2&&a.addListener("writableWrite",function(a){g===null?g=[a]:g.push(a)});return a};b.onError=function(a,b){return null};return a}();g["default"]=a}),98);
__d("oz-player/drm/OzDrmUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return Uint8Array.from(window.atob(a),function(a){return a.charCodeAt(0)})};b=function(a){return window.btoa(String.fromCharCode.apply(null,new Uint8Array(a)))};f.base64ToUint8Array=a;f.arrayBufferToBase64=b}),66);
__d("OzWidevineDrmProvider",["ConstUriUtils","FBLogger","oz-player/drm/OzDrmUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e,f,g){this.$2=[];this.$4=!0;this.$5=!1;g!=null&&g!==""&&(this.$1=d("oz-player/drm/OzDrmUtils").base64ToUint8Array(g));if(b!=null&&f!=null){b=(g=d("ConstUriUtils").getUri(b))==null?void 0:g.addQueryParam("access_token",f);if(b==null)throw c("FBLogger")("comet_video_player").mustfixThrow("Invalid Graph API license uri for video: %s",a);this.$3=b.toString();this.$5=!0;this.$4=!1}else{g=e["0"];if(g==null){g="/video/drm/getlicense";b=(f=d("ConstUriUtils").getUri(g))==null?void 0:f.addQueryParam("video_id",a);if(b==null)throw c("FBLogger")("comet_video_player").mustfixThrow("Invalid server license uri for video: %s",a);this.$3=b.toString()}else this.$3=g}}var b=a.prototype;b.getKeySystem=function(){return"com.widevine.alpha"};b.getSchemeId=function(){return"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};b.getInitDatas=function(){return this.$2};b.setInitDatas=function(a){this.$2=a};b.getRequireDistinctiveIdentifier=function(){return"optional"};b.getRequirePersistentState=function(){return"optional"};b.getInitDataTypes=function(){return};b.getDrmSessionTypes=function(){return["temporary"]};b.getAudioRobustness=function(){return""};b.getVideoRobustness=function(){return""};b.getServerCertificate=function(){return this.$1};b.getLicenseRequestInfo=function(a){var b={url:this.$3,method:"POST",body:"",headers:{},credentials:void 0};this.$4&&(b.credentials="include");a=d("oz-player/drm/OzDrmUtils").arrayBufferToBase64(a);if(this.$5){var c={request:a};b.body=JSON.stringify(c);b.headers["Content-Type"]="application/json"}else b.body=a,b.headers["Content-Type"]="application/text";return b};b.parseLicenseResponse=function(a){a=String.fromCharCode.apply(null,a);var b;try{b=JSON.parse(a)}catch(a){b=void 0}var c;if(b!==void 0&&b.data!==void 0&&b.data.length===1){b=b.data[0];b.error!=null||(c=b.license)}else c=a;if(c!=null&&c!=="")try{return d("oz-player/drm/OzDrmUtils").base64ToUint8Array(c)}catch(a){if(a.name==="InvalidCharacterError")throw new Error("Endpoint returned error: "+c);else throw a}return null};return a}();g["default"]=a}),98);
__d("PolarisMobileOzConfigDefaults",[],(function(a,b,c,d,e,f){"use strict";a={oz_www_abr_use_download_time:!1,oz_www_allow_queueing_end_of_stream_when_update:!1,oz_www_append_last_segment_if_beyond_end:!1,oz_www_back_off_pdash_504_retry:!1,oz_www_bandwidth_ignore_on_stream_write_samples:!1,oz_www_bandwidth_use_response_time_adjustment:!1,oz_www_buffer_when_waiting:!1,oz_www_call_end_of_stream_in_quick_starter:!1,oz_www_cancel_tracker_on_append_error:!1,oz_www_check_buffer_range_once_for_playhead_update:!1,oz_www_cleanup_video_node_on_destroy:!1,oz_www_clear_buffer_when_switch_representation_initiator_is_user:!1,oz_www_convert_dom_exception_to_oz_error:!1,oz_www_copy_new_manifest:!1,oz_www_delay_stream_end_for_sourceended:!1,oz_www_detach_media_source_manager:!1,oz_www_disable_audio_scheduler:!1,oz_www_emit_stream_error_event:!1,oz_www_enable_abr_for_first_request:!1,oz_www_enable_adaptation:!0,oz_www_enable_appends_on_wait_update_end_failure:!1,oz_www_enable_network_manager_error:!1,oz_www_enable_quickdashv2:!1,oz_www_estimate_video_bandwidth_only:!1,oz_www_exclude_prefetch_bandwidth_samples:!0,oz_www_fallback_on_append_error:!1,oz_www_fix_abr_default_representation:!1,oz_www_fix_buffer_ahead_priority_strategy:!1,oz_www_fix_prefetch_xhr_http_status:!0,oz_www_fix_prepended_segments_tagging:!1,oz_www_fix_quick_starter_overhead:!0,oz_www_fix_reload_manifest_retry:!1,oz_www_fix_seek_performance:!1,oz_www_fix_setup_video_duration_on_representation_switch:!1,oz_www_fix_source_buffer_error_logging:!1,oz_www_fix_stream_deferred_cancel:!1,oz_www_fix_template_duration_artifact_in_manifest:!1,oz_www_generate_mos_segment_buffer_diff:!1,oz_www_handle_mpd_retries_outside_oz_mpd_updater:!1,oz_www_handle_switch_to_unparsed_representation_sidx:!0,oz_www_ignore_time_to_response_start:!1,oz_www_lazy_parse_sidx:!1,oz_www_listen_for_canplay_in_buffering_detector:!1,oz_www_live_audio_ibr:!0,oz_www_live_catch_up_only_when_paused:!1,oz_www_live_disable_mpd_updates_when_paused:!1,oz_www_live_gracefully_handle_410:!1,oz_www_live_gracefully_handle_mpd_errors:!1,oz_www_live_gracefully_handle_no_network:!1,oz_www_live_no_segment_when_playhead_is_before_first_segment:!1,oz_www_live_playhead_catch_up:!1,oz_www_live_query_time_in_range:!1,oz_www_load_video_node_on_unload:!1,oz_www_log_appended_secs:!1,oz_www_maybe_end_stream_if_prepended_segments:!1,oz_www_mpd_update_cancel_current_request_tracker:!1,oz_www_no_new_loop_body_promise_when_stream_ongoing:!1,oz_www_pausable_stream_throws_error_when_aborted:!1,oz_www_pdash_use_pdash_segmentlocator:!1,oz_www_playhead_manager_handle_timerange_update_on_timeupdate:!1,oz_www_prevent_unnecessary_seek_stream_anchor_reset:!1,oz_www_queue_data_with_error_handling:!1,oz_www_reach_end_only_when_video_ended:!1,oz_www_respect_initial_representation_on_setup:!1,oz_www_retry_fetch_on_prefetch_error:!1,oz_www_sbm_abort_on_readable_stream_error:!1,oz_www_sbm_check_source_buffer_ready_state_on_cancel:!1,oz_www_sbm_recursively_waits_for_update_end:!1,oz_www_sbm_waits_for_update_end:!0,oz_www_seek_ahead_use_native_current_time:!1,oz_www_seek_to_start_quick_starter:!1,oz_www_set_source_buffer_append_window_end:!1,oz_www_set_stream_anchor_only_on_done_status:!1,oz_www_skip_videobuffer_gaps:!0,oz_www_skip_videobuffer_gaps_on_buffer_updated:!1,oz_www_stable_buffered_timeranges_in_observedsourcebufferstate:!1,oz_www_stop_manifest_update_when_static:!1,oz_www_suppress_playing_event_while_buffering:!1,oz_www_throw_network_error_during_stream:!1,oz_www_throw_on_non_zero_r_d_mismatch:!1,oz_www_touch_cb_key:!1,oz_www_update_bandwidth_cache_on_sample:!1,oz_www_update_duration_when_init_appended:!1,oz_www_update_live_video_config_on_representation_switch:!1,oz_www_update_media_source_duration:!0,oz_www_use_abr_for_missing_default_representation:!1,oz_www_use_deferred_streaming_task:!1,oz_www_use_loose_manifest_updates:!1,oz_www_use_performance_entry_on_stream_close:!1,oz_www_use_sc_timebased_segments:!1,oz_www_use_scf_timebased_segments:!1,oz_www_use_scheduler:!0,oz_www_use_segment_request_cache:!1,oz_www_use_stream_end_time_in_segment_locator:!1,oz_www_xmlparser_use_domparser:!1};b={oz_www_abr_confidence_threshold:.9,oz_www_abr_eval_buffer_threshold:0,oz_www_abr_min_bandwidth_samples:0,oz_www_abr_prevent_down_switch_buffer_threshold:11,oz_www_abr_restrict_from_index:0,oz_www_abr_restrict_to_index:0,oz_www_append_byte_target_without_range:0,oz_www_appends_per_segment:3,oz_www_auto_seek_playhead_slack:0,oz_www_bandwidth_boundary_standard_deviation_factor:1,oz_www_bandwidth_estimator_half_life:6,oz_www_bandwidth_estimator_outlier_exclusion_factor:50,oz_www_bandwidth_estimator_std_dev_penalty_factor:0,oz_www_bandwidth_estimator_variance_penalty_down_factor:0,oz_www_bandwidth_estimator_variance_penalty_half_life:0,oz_www_bandwidth_estimator_variance_penalty_up_factor:0,oz_www_bandwidth_penalty_additional_video_start:0,oz_www_bandwidth_penalty_per_additional_video:0,oz_www_bandwidth_response_time_handicap:0,oz_www_buffer_ahead_target:19,oz_www_byte_count_per_sample:6e4,oz_www_default_bandwidth_estimate:5e5,oz_www_download_time_buffer_delta_penalty_factor:0,oz_www_in_play_buffer_overflow_target:1,oz_www_in_play_buffer_underflow_target:.1,oz_www_initial_manifest_request_retry_count:0,oz_www_initial_switch_interval:0,oz_www_live_audio_ibr_bandwidth_percentage:.05,oz_www_live_catch_up_fall_behind_threshold:20,oz_www_live_catch_up_live_head_delta:6,oz_www_live_max_try_attempts_on_404:1,oz_www_live_numerical_error_epsilon:0,oz_www_low_buffer_bandwidth_target_increase_factor:0,oz_www_low_buffer_bandwidth_target_threshold:10,oz_www_low_segment_stream_playhead_threshold:0,oz_www_max_bandwidth_sample_count:30,oz_www_max_start_eme_attempts:-1,oz_www_maximum_bandwidth_sample_bandwidth:2e6,oz_www_min_block_time_range_interval_ms:0,oz_www_min_eval_interval:1e3,oz_www_min_switch_interval:5e3,oz_www_minimum_bandwidth_sample_duration:30,oz_www_minimum_bytes_to_sample_on_close:25e3,oz_www_minimum_download_additional_buffer_ms:0,oz_www_network_seg_timeout_ms:0,oz_www_partial_playback_buffer_overflow:0,oz_www_paused_stream_segments_count:2,oz_www_per_stream_duration_target:0,oz_www_pixels_above_viewport_to_observe:0,oz_www_pixels_below_viewport_to_observe:0,oz_www_playhead_manager_timeupdate_throttle_ms:1e3,oz_www_playhead_nudge_slack:0,oz_www_pre_start_buffer_ahead_target:10,oz_www_prioritize_by_viewport_static_penalty:0,oz_www_resolution_constraint_factor:2,oz_www_sbm_read_timeout_ms:0,oz_www_seconds_to_stream:0,oz_www_seconds_to_stream_near_bandwidth_boundary:0,oz_www_seek_ahead_epsilon:0,oz_www_segments_to_stream:5,oz_www_segments_to_stream_near_bandwidth_boundary:5,oz_www_segments_to_stream_under_playhead_threshold:0,oz_www_skip_videobuffer_gaps_max_gap_size_sec:0,oz_www_start_buffer_underflow_target:.1,oz_www_stream_interrupt_check_mpd_stale_count_threshold:0,oz_www_tagged_time_range_per_append_throttle:0,oz_www_time_to_first_byte_estimate_half_life_ms:500,oz_www_timeline_offset_threshold:0};c={oz_www_bandwidth_cache_key:"bandwidthEstimate",oz_www_block_representation_status_codes_json:"[500]",oz_www_network_end_broadcasts_json:"[]",oz_www_network_reload_mpd_json:"[]",oz_www_network_retry_intervals_json:'{"0": 1000, "404": 2000, "502": 1000, "503": 1000, "504": 1000}',oz_www_network_skip_json:"[]",oz_www_stream_types_eligible_for_partial_playback:""};f.defaultBools=a;f.defaultNumbers=b;f.defaultStrings=c}),66);
__d("TimeRanges",["invariant"],(function(a,b,c,d,e,f,g,h){a=function(){function a(a){this.$1=[],this.$1=a}var b=a.prototype;b.start=function(a){this.$1[a]||h(0,2205);return this.$1[a].startTime};b.end=function(a){this.$1[a]||h(0,2205);return this.$1[a].endTime};b.length=function(){return this.$1.length};return a}();g["default"]=a}),98);
__d("XVideoUnifiedCVCControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/video/unified_cvc/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("UnifiedVideoCVCSubscription",["CVCv3DisabledPlayerOrigins","CVCv3DisabledPlayerSubOrigins","CVCv3SubscriptionHelper","DateConsts","XVideoUnifiedCVCControllerRouteBuilder","clearTimeout","cometAsyncFetch","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=Object.values(c("CVCv3DisabledPlayerOrigins")),i=Object.values(c("CVCv3DisabledPlayerSubOrigins")),j=10;a=function(){function a(a,b,d,e,f,g){var j=this;this.$1=new(c("CVCv3SubscriptionHelper"))(a,b,d);this.$5=f;this.$6=null;this.$9=null;this.$10=!this.$1.isValidSubscription();this.$3=null;this.$2=null;a=b!=null?h.includes(b):!1;f=d!=null?i.includes(d):!1;!a&&!f&&(this.$3=e,this.$11=g,this.$4=e.subscribe(function(){if(j.$3==null){j.$1.logDebugInfo("empty_video_controller");return}var a=j.$3.getCurrentState();a.playing?j.$12(a):j.$13()}))}var b=a.prototype;b.$12=function(a){if(this.$3==null){this.$1.logDebugInfo("empty_video_controller");return}if(a.playing){if(this.$2==null){a=this.$3.getPlayheadPosition();a>=0&&(this.$2=a)}}else this.$2=null;this.$14(0)};b.stopUnifiedCVC=function(){this.$13()};b.destroy=function(){this.$13(),this.$4!=null&&this.$4.remove(),this.$4=null,this.$3=null};b.$13=function(){c("clearTimeout")(this.$8),c("clearTimeout")(this.$7),this.$8=null,this.$7=null,this.$2=null,this.$1.clearAnyPreviousContext(),this.$9=null};b.$15=function(){c("clearTimeout")(this.$7),this.$7=null};b.$16=function(){this.$9=null,this.$15(),this.$14(0)};b.$14=function(a){var b=this;if(this.$3==null||this.$8!=null||this.$9!=null||this.$10)return;this.$8=c("setTimeout")(function(){b.$8=null;var a=b.$17();if(a==null){b.$1.logDebugInfo("empty_request");return}b.$9=a;var e=Date.now(),f=!1;c("promiseDone")(a,function(c){if(a!==b.$9)return;b.$9=null;if(c!=null){c=b.$1.processUnifiedResponse(c);b.$18(c,e)}else b.$1.logHttpResponseBad("null payload",Date.now()-e)},function(a){f=!0,b.$1.logHttpRequestFailure(a!=null?JSON.stringify(a):null,Date.now()-e)});b.$7=c("setTimeout")(function(){f||b.$1.logHttpRequestTimeout(Date.now()-e),b.$16()},j*d("DateConsts").MS_PER_SEC)},a)};b.$18=function(a,b){this.$15();b=Date.now()-b;a.d!=null?(this.$1.logHttpRequestSuccess(b),this.$11!=null&&this.$11(a.d)):this.$1.logHttpResponseBad("no data field",b);if(a.a!=null){b=a.a.t;switch(b){case"p":b=a.a.pi;b==null&&(b=j);this.$14(b*d("DateConsts").MS_PER_SEC);break;case"s":this.$10=!0;break}}};b.$17=function(){var a=this.$19();if(a==null)return null;a={d:JSON.stringify(a)};return c("cometAsyncFetch")(c("XVideoUnifiedCVCControllerRouteBuilder").buildURL({}),{data:a,method:"POST"})};b.$19=function(){if(this.$3==null)return null;var a={};this.$6!=null&&(a.lc=this.$6);this.$5&&(a.ls=!0);var b=0,c=0;this.$2!=null&&(b=this.$2,c=this.$3.getPlayheadPosition());var d=this.$3.getCurrentState();b=this.$1.makeUnifiedVideoCVCUpdate(b,c,this.$20(d),d.muted,a);return b};b.$20=function(a){if(a.playing||a.seeking)return"playing";else if(a.ended)return"ended";else if(a.paused)return"paused";else return"unknown"};b.testing_setLastStartPosition=function(a){this.$2=a};b.testing_makeUnifiedStateUpdate=function(){return this.$19()};b.testing_handleUnifiedResponse=function(a){return this.$18(a,Date.now())};return a}();g["default"]=a}),98);
__d("VideoLiveTrace",["DataViewReader","LiveTraceWwwVideoPlayerFalcoEvent","Mp4DASHEventMessageBox","Mp4Demuxer","throttle"],(function(a,b,c,d,e,f,g){var h="x-fb-video-livetrace-ids",i="x-fb-video-livetrace-parentsource",j="x-fb-video-livetrace-streamtype",k="x-fb-origin-hit",l="x-fb-edge-hit",m="PLY:WWW:",n=m+"DL:",o=m+"DIS:",p=1e3,q=/[\r\n]+/;a=function(){function a(a,b,d){var e=this;this.$6=[];this.$1=a;this.$2=null;a=d+":"+b.substring(0,5);this.$3=m+a;this.$4=n+a;this.$5=o+a;this.$7=c("throttle")(function(a){return e.$8(a)},p)}var b=a.prototype;b.setStreamType=function(a){this.$2=a};b.$9=function(a,b,d,e,f,g){var h,i=this,j=Date.now(),k=(h=this.$2)!=null?h:0;c("LiveTraceWwwVideoPlayerFalcoEvent").log(function(){return{stream_id:i.$1,stream_type:k,event_name:b,event_severity:f,event_creation_time:j,source:a,trace_id:d,parent_source:e,metadata:g}})};b.onUpdateStatus=function(a){this.$7(a)};b.$8=function(a){a=a.position*1e3;for(var b=this.$6.length-1;b>=0;b--){var c=this.$6[b];if(c.presentationTimestamp>a)continue;if(c.displayTimestamp==null)c.displayTimestamp=Date.now();else continue;this.$9(this.$5,"FRAME",c.traceId,this.$4,"SUCCESS",null)}};b.getAndFlushTracedFrames=function(){var a,b={currentTimeMs:Date.now(),streamId:this.$1},c={dl:[],dis:[]},d=[];this.$6.forEach(function(a){a.hasBeenFlushedAsDownloaded||(c.dl.push({id:a.traceId,timeMs:a.downloadTimestamp}),a.hasBeenFlushedAsDownloaded=!0),a.displayTimestamp!=null?c.dis.push({id:a.traceId,timeMs:a.displayTimestamp}):d.push(a)});this.$6=d;b[(a=this.$2)!=null?a:0]=c;return c.dl.length>0||c.dis.length>0?b:null};b.handleHeadersString=function(a,b){a=a.trim().split(q);this.$10(a.map(function(a){a=a.split(": ");return[a.shift().toLowerCase(),a.shift()]}),b)};b.handleHeaders=function(a,b){this.$10(this.$11(a),b)};b.handleHeadersAndBody=function(a,b,c){this.$12(this.$11(a),b,c)};b.$11=function(a){var b=[];for(var a=a.entries(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;b.push(e)}return b};b.$13=function(a){var b=Date.now(),d=new Map(),e=a.reduce(function(a,b){return a+b.byteLength},0),f=new Uint8Array(e),g=0;a.forEach(function(a){f.set(a,g),g+=a.byteLength});e=new(c("Mp4Demuxer"))(new DataView(f.buffer,f.byteOffset,f.byteLength));while(!e.atEnd()){a=e.parseBox();if(a.getType()===c("Mp4DASHEventMessageBox").canonicalType){var h=e.parseCanonicalBox(c("Mp4DASHEventMessageBox"),e.parseFullBox(a));if(h instanceof c("Mp4DASHEventMessageBox")){var i;i=(i=h.getEmsgFields())==null?void 0:i.schemeIdUri;if(i==null?void 0:i.startsWith("livedash:trace:")){i=h.getMessageData();h=new(c("DataViewReader"))(i).readZeroTerminatedString(i.byteLength);try{i=JSON.parse(h);Array.isArray(i)&&i.filter(function(a){return Array.isArray(a)&&a.length===2}).forEach(function(a){var c=a[0];a=a[1];d.set(c,{displayTimestamp:null,downloadTimestamp:b,hasBeenFlushedAsDownloaded:!1,presentationTimestamp:a,traceId:c})})}catch(a){}}}}e.skipBox(a)}return d};b.$14=function(a,b){var c=this,d="null",e=Date.now(),f=new Map(),g="";a.forEach(function(a){var b=a[0].toLowerCase();a=a[1];if(b===h&&a){var m=a.split(",");m.forEach(function(a){a=a.split(":");var b=+a[0];a=+a[1];f.set(b,{displayTimestamp:null,downloadTimestamp:e,hasBeenFlushedAsDownloaded:!1,presentationTimestamp:a,traceId:b})})}b===i&&(g=a);c.$2===null&&b===j&&(c.$2=parseInt(a,10));(b===k||b===l)&&parseInt(a,10)&&(d=b===k?"origin":"edge")});a=b||{};a.hit=d;return g!==""?{tracedFrames:f,eventMetaData:a,parentSource:g,streamType:this.$2}:null};b.$12=function(a,b,c){var d=this.$14(a,c);if(d==null||d.parentSource==="")return;if(b==null?void 0:b.length){a=this.$13(b);a.forEach(function(a,b){d.tracedFrames.set(b,a)})}this.$6=this.$6.concat(Array.from(d.tracedFrames.values()));c=d.tracedFrames.keys();for(b=c,a=Array.isArray(b),c=0,b=a?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(a){if(c>=b.length)break;e=b[c++]}else{c=b.next();if(c.done)break;e=c.value}e=e;this.$9(this.$4,"SEGMENT",e,d.parentSource,"SUCCESS",d.eventMetaData)}};b.$10=function(a,b){this.$12(a,null,b)};b.handleXHR=function(a,b){this.handleHeadersString(a.getAllResponseHeaders(),b)};b.getLiveTraceContext=function(){return this.$2!=null?{streamId:this.$1,streamType:this.$2,sourceId:this.$3}:null};return a}();g["default"]=a}),98);
__d("VideoMimeTypes",[],(function(a,b,c,d,e,f){function a(a,b,c){return a+'; codecs="'+b+", "+c+'"'}e="mp4a.40.2";function b(a){return"avc1.42E0"+a.toString(16).toUpperCase()}function c(a){return"avc1.4D40"+a.toString(16).toUpperCase()}function d(a){return"avc1.6400"+a.toString(16).toUpperCase()}var g="video/mp4";b=a(g,b(30),e);var h=a(g,c(30),e);c=a(g,c(31),e);var i=a(g,d(50),e);a=a(g,d(51),e);g={h264baseline:b,h264main30avc:h,h264main31avc:c,h264high50avc:i,h264high51avc:a};f["default"]=g}),66);
__d("VideoPlayerWwwFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1914651");b=d("FalcoLoggerInternal").create("video_player_www",a);e=b;g["default"]=e}),98);
__d("VideoPlayerWwwLogger",["VideoPlayerWwwFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b,c=a.logData.live_trace_stream_id!==null&&a.logData.live_trace_stream_type!==null;return{access_token:a.logData.access_token,ad_client_token:a.logData.ad_client_token,attribution_id:a.logData.attribution_id,attribution_id_v2:a.logData.attribution_id_v2,attribution_id_v2_root:a.logData.attribution_id_v2_root,audio_only:a.logData.audio_only,audio_representation_id:a.logData.audio_representation_id,autoplay_eligible:a.logData.autoplay_eligible,autoplay_failure_reasons:a.logData.autoplay_failure_reasons,autoplay_setting:a.logData.autoplay_setting,available_qualities:a.logData.available_qualities,broadcaster_origin:a.logData.broadcaster_origin,browser_tab_id:a.logData.browser_tab_id,caption_state:a.logData.caption_state,cast_client_app_id:a.logData.cast_client_app_id,client_latency_setting:a.logData.client_latency_setting,current_playback_speed:a.logData.current_playback_speed,current_viewability_percentage:Number(a.logData.current_viewability_percentage),current_volume:a.logData.current_volume,dash_perf_logging_enabled:a.logData.dash_perf_logging_enabled,data_connection_quality:a.logData.data_connection_quality,debug_reason:a.logData.debug_reason,device_id:a.logData.device_id,device_type:a.logData.device_type,downstream_share_origin_uri:a.logData.downstream_share_origin_uri,downstream_share_start_time:a.logData.downstream_share_start_time,downstream_share_visit_uuid:a.logData.downstream_share_visit_uuid,dropped_frame_count:Number(a.logData.dropped_frame_count),error:a.logData.error,error_code:a.logData.error_code,error_description:a.logData.error_description,error_domain:a.logData.error_domain,error_type:a.logData.error_type,error_user_info:a.logData.error_user_info,event_name:a.eventType,event_seq_num:a.logData.event_seq_num,external_log_id:a.logData.external_log_id,external_log_type:a.logData.external_log_id,fb_manifest_identifier:a.logData.fb_manifest_identifier,feed_aggregation_type:a.logData.feed_aggregation_type,feed_position:a.logData.feed_position,frame_events:a.logData.frame_events,ft:a.logData.ft,imf_emsg_id:a.logData.imf_emsg_id,imf_event_type:a.logData.imf_event_type,imf_topic:a.logData.imf_topic,interrupt_count:a.logData.interrupt_count!==null?Number(a.logData.interrupt_count):null,interrupt_time:Number(a.logData.interrupt_time),is_abr_enabled:a.logData.is_abr_enabled,is_fbms:a.logData.is_fbms,is_live_preview:(b=a.logData.is_live_preview)!=null?b:!1,is_live_video_rewound:a.logData.is_live_video_rewound,is_mixed_codec_manifest:a.logData.is_mixed_codec_manifest,is_p2p_playback:a.logData.is_p2p_playback,is_pip:a.logData.is_pip,is_predictive_playback:a.logData.is_predictive_playback,is_sound_on:a.logData.is_sound_on,is_stalling:a.logData.is_stalling,is_templated_manifest:a.logData.is_templated_manifest,last_viewability_percentage:Number(a.logData.last_viewability_percentage),live_trace_source_id:a.logData.live_trace_source_id,live_trace_stream_id:c?a.logData.live_trace_stream_id:null,live_trace_stream_type:c?a.logData.live_trace_stream_type:null,mpd_validation_errors:a.logData.mpd_validation_errors,network_connected:a.logData.network_connected,next_quality_label:a.logData.next_quality_label,next_representation_id:a.logData.next_representation_id,next_video_codecs:a.logData.next_video_codecs,notification_id:a.logData.notification_id,notification_medium:a.logData.notification_medium,offset_ms:a.logData.offset_ms!=null?String(a.logData.offset_ms):null,permalink_share_id:a.logData.permalink_share_id,playback_caption_format:a.logData.playback_caption_format,playback_caption_locale:a.logData.playback_caption_locale,playback_duration:a.logData.playback_duration,playback_is_broadcast:a.logData.playback_is_broadcast,playback_is_drm:a.logData.playback_is_drm,playback_is_live_streaming:a.logData.playback_is_live_streaming,player_format:a.logData.player_format,player_instance_key:a.logData.player_instance_key,player_mode:a.logData.player_mode,player_origin:a.logData.player_origin,player_state:a.logData.player_state,player_suborigin:a.logData.player_suborigin,player_version:a.logData.player_version,projection:a.logData.projection,quality_label:a.logData.quality_label,reaction_video_channel_type:a.logData.reaction_video_channel_type,representation_id:a.logData.representation_id,resource_url:a.logData.resource_url,routeTracePolicy:a.routeTracePolicy,seq_num:a.logData.seq_num,source:a.source_VPL_LOGGING_HACK,source_VPL_LOGGING_HACK:a.logData.source_VPL_LOGGING_HACK,srt_job_id:a.logData.srt_job_id,srt_job_tracking_id:a.logData.srt_job_tracking_id,stall_count:Number(a.logData.stall_count),stall_count_200_ms:Number(a.logData.stall_count_200_ms),stall_time:Number(a.logData.stall_time),state:a.logData.state,streaming_format:a.logData.streaming_format,time_ms:a.logData.time_ms,total_frame_count:Number(a.logData.total_frame_count),tracking_data_encrypted:a.logData.tracking_data_encrypted,tracking_nodes:a.logData.tracking_nodes,tv_session_id:a.logData.tv_session_id,v2_heart_beat:a.logData.v2_heart_beat,video_bandwidth:a.logData.video_bandwidth,video_buffer_end_position:a.logData.video_buffer_end_position,video_chaining_depth_level:a.logData.video_chaining_depth_level,video_chaining_parent_video_id:a.logData.video_chaining_parent_video_id,video_chaining_session_id:a.logData.video_chaining_session_id,video_channel_id:a.logData.video_channel_id,video_codecs:a.logData.video_codecs,video_id:a.logData.video_id,video_last_start_time_position:a.logData.video_last_start_time_position,video_play_reason:a.logData.video_play_reason,video_player_height:Number(a.logData.video_player_height),video_player_width:Number(a.logData.video_player_width),video_time_position:a.logData.video_time_position,vpts:a.logData.vpts,web_client_revision:a.logData.web_client_revision}}a={logComet:function(a){c("VideoPlayerWwwFalcoEvent").log(function(){return h(a)})},logCometImmediately:function(a){c("VideoPlayerWwwFalcoEvent").logImmediately(function(){return h(a)})}};b=a;g["default"]=b}),98);
__d("VideoPlayerBanzaiLogFlusher",["VideoPlayerWwwLogger","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=c("emptyFunction");b=function(){function a(a){this.$1=a}var b=a.prototype;b.flushLogs=function(){var a=this.$1.consumeLoggerEvents();a.forEach(function(a){var b={event:a.eventType,logData:a.logData,routeTracePolicy:a.routeTracePolicy,source:a.source_VPL_LOGGING_HACK};if(a.source_VPL_LOGGING_HACK==="animated_image_share")return;b=(b=a.logData)==null?void 0:b.ad_client_token;b!=null?c("VideoPlayerWwwLogger").logCometImmediately(a):c("VideoPlayerWwwLogger").logComet(a)})};b.discardLogsWithoutFlushing=function(){var a=this.$1.consumeLoggerEvents()};return a}();g["default"]=b}),98);
__d("VideoPlayerCaptionsDisplayConfigContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({liveCaptionsTextAlignment:null,textSizeMapping:null});g["default"]=b}),98);
__d("VideoPlayerCaptionsDisplay.react",["VideoPlayerCaptionsDisplayConfigContext","VideoPlayerControlsBottomRowAddOnContext","VideoPlayerHooks","react","recoverableViolation","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=i||(i=d("react")),l=i.useContext,m={captionsCenterAlign:{justifyContent:"xl56j7k",textAlign:"x2b8uid",$$css:!0},captionsContainer:{bottom:"xfqi8uc",boxSizing:"x9f619",display:"x78zum5",justifyContent:"xl56j7k",position:"x10l6tqk",textAlign:"x2b8uid",transitionDuration:"xu6gjpd",transitionProperty:"x11xpdln",transitionTimingFunction:"x1r7x56h",width:"xh8yej3",$$css:!0},captionsLeftAlign:{justifyContent:"x1nhvcw1",textAlign:"x1yc453h",$$css:!0},captionsRightAlign:{justifyContent:"x13a6bvl",textAlign:"xp4054r",$$css:!0}},n={BIG:"25px",BIGGER:"30px",BIGGEST:"34px",DEFAULT:"17px",MEDIUM:"21px",SMALL:"13px",SMALLEST:"8px"},o={DARK:.75,DEFAULT:.45,LIGHT:.25,OPAQUE:1,TRANSPARENT:0},p={BLACK:"20, 22, 26",BLUE:"0, 0, 255",CYAN:"0, 255, 255",GREEN:"0, 255, 0",MAGENTA:"255, 0, 255",RED:"255, 0, 0",WHITE:"255, 255, 255",YELLOW:"255, 255, 0"};function q(a){switch(a){case"center":return m.captionsCenterAlign;case"left":return m.captionsLeftAlign;case"right":return m.captionsRightAlign;default:c("recoverableViolation")("Unsupported captions text alignment: "+a,"comet_video_player")}}function r(a,b,c){var d={},e=a.captionsBackgroundColor,f=a.captionsBackgroundOpacity,g=a.captionsTextColor;a=a.captionsTextSize;if(e!==null){f=f!==null?o[f]:1;d.backgroundColor="rgba("+p[e]+","+f+")"}g!==null&&(d.color="rgba("+p[g]+")");a!==null&&(d.fontSize=b!=null?babelHelpers["extends"]({},n,b)[a]:n[a]);c&&(d.marginBottom=35);return d}function a(a){var b=a.activeCaptions,e=a.adjustments;a=a.captionDisplayStyle;var f=b==null?void 0:b.rows,g=l(c("VideoPlayerCaptionsDisplayConfigContext")),i=g.liveCaptionsTextAlignment;g=g.textSizeMapping;var n=l(d("VideoPlayerControlsBottomRowAddOnContext").VideoPlayerControlsBottomRowAddOnContext);n=(n==null?void 0:n.getBottomRowAddOn())!=null;var o={};a&&(o=r(a,g,n));a=(j||(j=d("VideoPlayerHooks"))).useIsLive();b=(n=b==null?void 0:(g=b.styles)==null?void 0:g.textAlignment)!=null?n:"center";if(f!=null&&f.length>0){g=f.map(function(a){return a.trim()}).filter(function(a){return!!a});return g.length>0?k.jsx("div",{className:(h||(h=c("stylex")))(m.captionsContainer,q(a?(n=i)!=null?n:b:b)),style:{paddingLeft:e.left,paddingRight:e.right,transform:"translateY("+-e.bottom+"px)"},children:k.jsx("div",{className:"x18l40ae x14ctfv x1lkfr7t xk50ysn x37zpob xdj266r xv81d3b xat24cr x5jn1jc xulzisn x1msn8f2 x1uwfbks x1qobr7z",style:o,children:g.map(function(a,b){return k.jsxs("span",{children:[a,k.jsx("br",{})]},b)})})}):null}return null}a.displayName=a.name+" [from "+f.id+"]";b=k.memo(a);e=b;g["default"]=e}),98);
__d("useVideoPlayerCaptionsDisplayAdjustments",["VideoPlayerHooks","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useMemo;function a(){var a=(i||(i=d("VideoPlayerHooks"))).useVideoPlayerCaptionsReservations();return j(function(){var b={bottom:0,left:0,right:0,top:0};a.length>0&&a.forEach(function(a){b[a.location]+=a.size});return b},[a])}g["default"]=a}),98);
__d("VideoPlayerCaptions.react",["VideoPlayerCaptionsDisplay.react","VideoPlayerHooks","react","useVideoPlayerCaptionsDisplayAdjustments"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");function a(){var a=(i||(i=d("VideoPlayerHooks"))).useActiveCaptions(),b=c("useVideoPlayerCaptionsDisplayAdjustments")(),e=i.useCaptionDisplayStyle();return j.jsx(c("VideoPlayerCaptionsDisplay.react"),{activeCaptions:a,adjustments:b,captionDisplayStyle:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerCaptionsArea.react",["VideoPlayerCaptions.react","VideoPlayerContexts","VideoPlayerHooks","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));b=h;var l=b.useReducer,m=b.useState;function n(a,b){switch(b.type){case"reserve":return a.concat(b.reservation);case"release":return a.filter(function(a){return a!==b.reservation});default:return a}}function a(a){a=a.children;var b=l(n,[]),e=b[0],f=b[1];b=m({release:function(a){f({reservation:a,type:"release"})},reserve:function(a){f({reservation:a,type:"reserve"});return a}});b=b[0];var g=(i||(i=d("VideoPlayerHooks"))).useCaptionsVisible();return k.jsx((j||(j=d("VideoPlayerContexts"))).VideoPlayerCaptionsReservationActionsContext.Provider,{value:b,children:k.jsxs(j.VideoPlayerCaptionsReservationsContext.Provider,{value:e,children:[g?k.jsx(c("VideoPlayerCaptions.react"),{}):null,a]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerCaptionsAreaDeferred.react",["deferredLoadComponent","react","requireDeferredForDisplay"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");a=c("deferredLoadComponent")(c("requireDeferredForDisplay")("VideoPlayerCaptionsArea.react").__setRef("VideoPlayerCaptionsAreaDeferred.react"));g["default"]=a}),98);
__d("VideoPlayerCaptionsController",["JSResourceForInteraction","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("VideoPlayerHTML5ApiCea608State").__setRef("VideoPlayerCaptionsController"),i=c("JSResourceForInteraction")("VideoPlayerHTML5ApiWebVttState").__setRef("VideoPlayerCaptionsController");function a(a){var b=a.captionsUrl,d=a.inbandCaptionsExpected,e=a.onCaptionsLoaded,f=null,g=null,j=null,k=null;function l(a){var b=i.load().then(function(c){if(b!==j)return;f=new c({captionsDisplay:null,onCaptionsLoaded:e,onReady:function(b){b.loadFromUrl(a)}})})["catch"](function(a){if(b!==j)return;c("recoverableViolation")("Failed to load the VideoPlayerHTML5ApiWebVttState module: "+a.message,"comet_video_player")});return b}function m(){var a=h.load().then(function(b){if(a!==k)return;g=new b({captionsDisplay:null,onCaptionsLoaded:e,onReady:function(a){a.processQueue()}})})["catch"](function(b){if(a!==k)return;c("recoverableViolation")("Failed to load the VideoPlayerHTML5ApiCea608State module: "+b.message,"comet_video_player")});return a}b!=null?j=l(b):d===!0&&(k=m());return{destroy:function(){f&&(f.destroy(),f=null),g&&(g.destroy(),g=null),j&&(j=null),k&&(k=null)},getCaptionFormat:function(){return f?"webvtt":g?"cea608":null},handleCea608BytesReceived:function(a){g&&g.enqueueBytes(a)},handleTimeUpdate:function(a){if(f){var b;f.source&&f.source.handleTimeUpdate(a);return(b=(b=f)==null?void 0:b.getCurrentScreenRepresentation())!=null?b:null}else if(g){g.source&&g.source.handleTimeUpdate(a);return(a=(b=g)==null?void 0:b.getCurrentScreenRepresentation())!=null?a:null}return null},updateCaptionsUrl:function(a){f&&(f.destroy(),f=null),a!=null&&(j=l(a))},updateInbandCaptionsExpected:function(a){g&&(g.destroy(),g=null),a&&(k=m())}}}g.createCaptionsController=a}),98);
__d("isSSR",["ExecutionEnvironment","XPlatReactEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;a=d("XPlatReactEnvironment").isWeb()&&!(h||(h=c("ExecutionEnvironment"))).canUseDOM;b=a;g["default"]=b}),98);
__d("VideoPlayerConnectionQuality",["isSSR"],(function(a,b,c,d,e,f,g){"use strict";var h={POOR:"POOR",MODERATE:"MODERATE",GOOD:"GOOD",EXCELLENT:"EXCELLENT"},i=[{bandwidth:5e5,connectionQuality:h.POOR},{bandwidth:2e6,connectionQuality:h.MODERATE},{bandwidth:1e7,connectionQuality:h.GOOD}],j=100,k=null,l=null;a=function(a){if(c("isSSR"))return"MODERATE";if(k!==null&&l!==null&&k>=Date.now()-j)return l;a=a();var b=null;if(a!=null)for(var d=0;d<i.length;d++)if(a<i[d].bandwidth){b=i[d].connectionQuality;break}b===null&&(b=h.EXCELLENT);k=Date.now();l=b;return b};g.evaluate=a}),98);
__d("VideoPlayerEmsgForStateMachine",["deepEquals"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c;return[a.type,a.emsgScheme,(c=a.emsgId)!=null?c:""].concat(b?[(c=a.emsgStartTimeInSec)!=null?c:"",(b=a.emsgDurationInSec)!=null?b:""]:[]).join(":")}function i(a,b){a.set(h(b,!0),b);return a}function a(a,b){return b.reduce(i,new Map(a))}function b(a,b,d){a=b==null?[]:Array.from(a.values()).filter(function(a){var c=a.emsgStartTimeInSec;a=a.emsgDurationInSec||0;return c!=null&&b>=c&&b<c+a}).sort(function(a,b){return(a.emsgStartTimeInSec||0)-(b.emsgStartTimeInSec||0)});a=Array.from(a.reduce(function(a,b){a.set(h(b,!1),b);return a},new Map()).values());return c("deepEquals")(d,a)?d:a}g.makeEmsgBoxDedupKey=h;g.makeUpdatedAllEmsgBoxes=a;g.makeUpdatedActiveEmsgBoxes=b}),98);
__d("VideoPlayerErrorBoundary.react",["FBLogger","getErrorSafe","oz-player/utils/OzErrorUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={error:null},c.suppressReactDefaultErrorLoggingIUnderstandThisWillMakeBugsHarderToFindAndFix=!0,b)||babelHelpers.assertThisInitialized(c)}b.getDerivedStateFromError=function(a){return{error:c("getErrorSafe")(a)}};var e=b.prototype;e.componentDidCatch=function(a,b){b=b.componentStack;var e=c("getErrorSafe")(a);e.componentStack=b;b=this.props;var f=b.description,g=b.onError;b=b.project;a=d("oz-player/utils/OzErrorUtils").isOzError(a)?a.getType():a!=null&&typeof a.name==="string"?a.name:e.name;e.name=a;a="VideoPlayerErrorBoundary caught an "+a;f!=null&&(a=a+" ("+f+")");f=["OZ_NETWORK","BUFFERING_TIMEOUT","MEDIA_ERR_DECODE","OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR"];var h=["Network failure:","Network failure.","HTTP error.","Bad URL timestamp","URL signature expired","No license for com.widevine.alpha","OZ_DRM_MANAGER: Endpoint returned error: DEVICE_CERTIFICATE_REVOKED"];f=f.every(function(a){return e.name!==a})&&h.every(function(a){return!e.message.startsWith(a)});h=c("FBLogger")(b==null?"comet_video_player":b).catching(e);["OZ_DRM_MANAGER","OZ_JAVASCRIPT_NATIVE","OZ_INITIALIZATION"].includes(e.name)&&(h=h.addToCategoryKey(e.message));f?h.fatal(a):h.warn(a);g!=null&&g(e)};e.render=function(){var a=this.props,b=a.children;a=a.fallback;var c=this.state.error;return c?typeof a==="function"?a(c):a:b};return b}(a.PureComponent);g["default"]=b}),98);
__d("VideoPlayerFallbackLearnMoreLink.react",["fbt","CometLink.react","FDSText.react","gkx","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=c("gkx")("20836")?"/help/work/1876956335887765/i-cant-view-or-play-videos-on-workplace":"https://www.facebook.com/help/396404120401278/list";return j.jsx(c("FDSText.react"),{color:"primaryOnMedia",type:"headlineEmphasized3",children:j.jsx(c("CometLink.react"),{href:a,target:"_blank",children:h._("__JHASH__GWeGP0j1NWF__JHASH__")})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("VideoPlayerFallbackCoverImplWithoutRetry.react",["FDSText.react","VideoPlayerFallbackLearnMoreLink.react","cr:1672302","cr:4149","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={banner:{alignItems:"x6s0dn4",display:"x78zum5",flexDirection:"xdt5ytf",width:"x3es6ox",$$css:!0},showOverBackground:{zIndex:"x1vjfegm",$$css:!0}};function a(a){var d=a.background,e=a.debugError,f=a.message,g=a.showDebugWithoutError;g=g===void 0?!0:g;a=a.showLearnMoreLink;a=a===void 0?!0:a;return j.jsxs("div",{className:"x6s0dn4 xatbrnm x9f619 x78zum5 x5yr21d xl56j7k x6ikm8r x10wlt62 x889kno x1iji9kk x1a8lsjc x1sln4lm x1n2onr6 xh8yej3",children:[j.jsxs("div",{className:(h||(h=c("stylex")))([k.banner,d!=null&&k.showOverBackground]),children:[j.jsx("div",{className:"x6s0dn4 x78zum5 xdt5ytf x193iq5w",children:j.jsx(c("FDSText.react"),{align:"center",color:"primaryOnMedia",type:"bodyLink3",children:f})}),a&&j.jsx("div",{className:"x6s0dn4 x78zum5 xdt5ytf xw7yly9 x193iq5w",children:j.jsx(c("VideoPlayerFallbackLearnMoreLink.react"),{})}),(e!=null||g)&&j.jsxs(j.Fragment,{children:[b("cr:4149")?j.jsx(b("cr:4149"),{error:e}):null,b("cr:1672302")?j.jsx(b("cr:1672302"),{error:e}):null]})]}),d!=null&&j.jsx("div",{className:"x1ey2m1c xds687c x17qophe x10l6tqk x13vifvy",children:d})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerFallbackCover.react",["fbt","VideoPlayerFallbackCoverImplWithoutRetry.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=a.background,d=a.debugError,e=a.message,f=a.showDebugWithoutError;a=a.showLearnMoreLink;e=(e=e)!=null?e:h._("__JHASH__dzG08k88Xfs__JHASH__");return j.jsx(c("VideoPlayerFallbackCoverImplWithoutRetry.react"),{background:b,debugError:d,message:e,showDebugWithoutError:f,showLearnMoreLink:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("VideoPlayerIMFMetadataContext",["react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||(h=d("react"));var i=h.useContext,j={imfExpectedFromEmsg:!1,specInlineJson:null},k=b.createContext(j);k.displayName="VideoPlayerIMFMetadataContext";e=k.Provider;function a(){var a=i(k);if(a===j)throw c("unrecoverableViolation")("useVideoPlayerIMFMetadata is not called from a component nested under VideoPlayerRelay/VideoPlayerX.","comet_video_player");return a}g.VideoPlayerIMFMetadataContextProvider=e;g.useVideoPlayerIMFMetadataFromContext=a}),98);
__d("VideoPlayerImplementationReactVideoElement.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.alt,c=a.poster,d=a.seoWebCrawlerVideoTracks,e=a.src,f=a.videoElementCallbacks,g=a.videoElementPreloadDisabled,h=a.videoElementRefCallback;a=a.videoPixelsFit;return i.jsx("video",babelHelpers["extends"]({"aria-label":(b=b)!=null?b:void 0,className:"x1lliihq x5yr21d xh8yej3",controls:!1,muted:!0,playsInline:!0,preload:g===!0?"none":void 0},f,{poster:c,ref:h,src:e,style:a?{objectFit:a.objectFit}:void 0,children:d}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerImplementationErrorNormalization",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.getType(),c=a.getDescription();switch(b){case"OZ_NETWORK":b=(b=(b=a.getExtra())==null?void 0:b.code)!=null?b:"0";b=parseInt(b,10);return b<100||b>599?"NetworkError":"HTTPError";case"OZ_SOURCE_BUFFER_QUOTA_EXCEEDED":a=(b=a.getExtra())==null?void 0:b.mimeType;if(a!=null&&a.indexOf("video")>-1)return"VideoDecodeError";else if(a!=null&&a.indexOf("audio")>-1)return"AudioDecodeError";else return"GenericDecodeError";case"OZ_XML_PARSER":case"OZ_MPD_PARSER":case"OZ_REPRESENTATION_PARSER":return"ManifestParseError";case"OZ_DRM_MANAGER":case"OZ_INITIALIZATION":if(/(OZ_XML_PARSER)|(OZ_MPD_PARSER)|(OZ_REPRESENTATION_PARSER)/.test(c))return"ManifestParseError";else return"RuntimeError";case"OZ_JAVASCRIPT_NATIVE":case"OZ_SOURCE_BUFFER":case"OZ_STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR":case"OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR":return"RuntimeError"}return null}function b(a,b){switch(a){case"OZ_XML_PARSER":case"OZ_MPD_PARSER":case"OZ_REPRESENTATION_PARSER":return"ManifestParseError";case"OZ_DRM_MANAGER":case"OZ_INITIALIZATION":if(/(OZ_XML_PARSER)|(OZ_MPD_PARSER)|(OZ_REPRESENTATION_PARSER)/.test(b))return"ManifestParseError";else return"RuntimeError";case"OZ_JAVASCRIPT_NATIVE":case"OZ_SOURCE_BUFFER":case"OZ_STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR":case"OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR":return"RuntimeError";case"BUFFERING_TIMEOUT":return"RuntimeError";default:b=[[["MEDIA_ERR_NETWORK"],"NetworkError"],[["MEDIA_ERR_ABORTED","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_UNKNOWN"],"GenericDecodeError"]];for(var b=b,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];if(f.some(function(b){return a.includes(b)}))return e}}return null}f.getVideoPlayerNormalizedErrorTypeFromOzError=a;f.getErrorTypeFromErrorName=b}),66);
__d("getErrorMessageFromMediaErrorCode",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case 1:return"The fetching process for the media resource was aborted by the user agent at the users request.";case 2:return"A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";case 3:return"An error of some description occurred while decoding the media resource, after the resource was established to be usable.";case 4:return"The media resource indicated by the src attribute was not suitable."}return null}f["default"]=a}),66);
__d("getErrorNameFromMediaErrorCode",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return"MEDIA_ERR_UNKNOWN_"+((a=a)!=null?a:"UNDEFINED")}}f["default"]=a}),66);
__d("VideoPlayerImplementationErrors",["VideoPlayerImplementationErrorNormalization","getErrorMessageFromMediaErrorCode","getErrorNameFromMediaErrorCode","getErrorSafe","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b;a=/^([A-Z_]+:)|([A-Z_]+\s+\(0x[0-9A-Fa-f]+\))/.exec(a);a=((b=(b=a==null?void 0:a[1])!=null?b:a==null?void 0:a[2])!=null?b:"").replace(/\s+/,"_").replace(/[^A-Za-z0-9_]/g,"");return a!==""?a:null}function a(a){var b=a.errorLocation,d=a.hostCallError,e=a.videoElementError,f=a.videoElementNetworkState;a=a.videoElementReadyState;var g=e==null?void 0:e.code,h=d!=null&&typeof d.message==="string"?d.message:null;h==null&&(h=e==null?void 0:e.message);h==null&&g!=null&&(h=c("getErrorMessageFromMediaErrorCode")(g));e=c("getErrorNameFromMediaErrorCode")(g);return{createdTimestamp:Date.now(),errorLocation:b,errorMessageFormat:((b=h)!=null?b:"Empty error")+("; code: "+((h=g)!=null?h:"undefined"))+("; readyState: "+a)+("; networkState: "+f),errorMessageParams:[],errorName:e,originalError:d}}function b(a,b){var d=c("getErrorSafe")(a);return{createdTimestamp:Date.now(),errorCode:typeof a==="object"&&a!=null?typeof a.code==="string"?a.code:typeof a.code==="number"?String(a.code):void 0:void 0,errorLocation:b,errorMessageFormat:(a=d.messageFormat)!=null?a:d.message,errorMessageParams:d.messageFormat!=null?(b=d.messageParams)!=null?b:[]:[],errorName:"VideoElementPlayPromiseRejectionReason_"+(d.name||"UnknownError")}}function i(a,b,d,e){e===void 0&&(e=null);b=c("getErrorSafe")(b);return{createdTimestamp:Date.now(),errorCode:null,errorLocation:d,errorMessageFormat:(b.name||"UnknownError")+" "+((d=b.messageFormat)!=null?d:b.message),errorMessageParams:b.messageFormat!=null?(d=b.messageParams)!=null?d:[]:[],errorName:a,stack:b.stack,url:(d=e)!=null?d:null}}function e(a,b){if(d("oz-player/utils/OzErrorUtils").isOzError(a)){var c=a,e=c.getExtra();return{createdTimestamp:Date.now(),errorCode:e.code,errorLocation:b,errorMessageFormat:c.getDescription(),errorMessageParams:[],errorName:c.getType(),errorType:d("VideoPlayerImplementationErrorNormalization").getVideoPlayerNormalizedErrorTypeFromOzError(c),stack:c.stack,url:e.url}}else return i("OZ_JAVASCRIPT_NATIVE",a,b)}function f(a,b){var c=h(a.message);c=c!=null?a.name+"_"+c:a.name;a=a.message;var d=[];return{createdTimestamp:Date.now(),errorLocation:b,errorMessageFormat:a,errorMessageParams:d,errorName:c,errorType:"GenericDecodeError"}}g.getMoreGranularErrorNameFromHTMLVideoElementErrorMessage=h;g.createVideoPlayerErrorFromHTMLVideoElementError=a;g.createVideoPlayerErrorFromVideoElementPlayPromiseRejectionReason=b;g.createVideoPlayerErrorFromGenericError=i;g.createVideoPlayerErrorFromOzImplementationError=e;g.createVideoPlayerErrorFromOzImplementationVideoNodeError=f}),98);
__d("VideoPlayerODS",["ODS","Random"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,b,c){d("Random").coinflip(c)&&(h||(h=d("ODS"))).bumpEntityKey(2079,a,b,c)};g.bumpEntityKey=a}),98);
__d("VideoPlayerImplementationStateMachine",["VideoPlayerEmsgForStateMachine","VideoPlayerImplementationErrors","VideoPlayerODS","gkx","recoverableViolation","shallowEqual","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.bufferingDetected,c=a.seeking;a=a.waitingForDomPlaying;return!b&&!c&&!a}function i(a){var b=a.bufferingDetected,d=a.prevPlaybackState,e=a.seeking;a=a.waitingForDomPlaying;b=h({bufferingDetected:b,seeking:e,waitingForDomPlaying:a});e=d;switch(d){case"stalling":e=b?"playing":"stalling";break;case"ended":case"paused":case"playing":break;default:d;c("recoverableViolation")("unexpected playbackState: "+d,"comet_video_player");break}return e}function j(a){return a.loopCount>0&&a.loopCurrent<a.loopCount||a.loopCount===-1}function k(a,b,e){switch(e.type){case"host_call_pause":case"host_call_play":case"host_call_set_current_time":case"host_call_set_volume":case"host_call_set_muted":case"host_call_set_playback_rate":case"host_call_set_video_quality":case"host_call_set_latency_level":return babelHelpers["extends"]({},a,{hostCallQueue:a.hostCallQueue.concat([e])});case"controller_set_latency_level_requested":case"implementation_set_latency_level_requested":return babelHelpers["extends"]({},a,{latencyLevel:e.payload.latencyLevel,ullIneligibilityReason:e.payload.ullIneligibilityReason});case"dom_event_loadedmetadata":return babelHelpers["extends"]({},a,{domEventsLatestPerfMs:babelHelpers["extends"]({},a.domEventsLatestPerfMs,{clockMs:b.clockTimestamp,loadedmetadata:e.payload.domEventPerfTimestamp,perfMs:b.perfTimestamp})});case"dom_event_loadeddata":return babelHelpers["extends"]({},a,{domEventsLatestPerfMs:babelHelpers["extends"]({},a.domEventsLatestPerfMs,{clockMs:b.clockTimestamp,loadeddata:e.payload.domEventPerfTimestamp,perfMs:b.perfTimestamp})});case"dom_event_canplay":return babelHelpers["extends"]({},a,{domEventsLatestPerfMs:babelHelpers["extends"]({},a.domEventsLatestPerfMs,{canplay:e.payload.domEventPerfTimestamp,clockMs:b.clockTimestamp,perfMs:b.perfTimestamp})});case"dom_event_ended":return babelHelpers["extends"]({},a,{playbackState:"ended",waitingForDomPlaying:!1});case"dom_event_pause":if(a.playbackState==="ended")return a;if(b.videoElementEnded===!0)return babelHelpers["extends"]({},a,{playbackState:"ended",waitingForDomPlaying:!1});return a.playbackState==="paused"?a:babelHelpers["extends"]({},a,{playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play":var f=a.playbackState,g=f;switch(f){case"playing":case"stalling":case"ended":case"paused":g="stalling";break;default:f;c("recoverableViolation")("unexpected playbackState: "+f,"comet_video_player");break}f=!0;return babelHelpers["extends"]({},a,{playbackState:g,waitingForDomPlaying:f});case"dom_event_playing":g=a.bufferingDetected;f=a.seeking;var h=!1,k=a.playbackState;return babelHelpers["extends"]({},a,{playbackState:i({bufferingDetected:g,prevPlaybackState:k,seeking:f,waitingForDomPlaying:h}),waitingForDomPlaying:h});case"dom_event_timeupdate":g=d("VideoPlayerEmsgForStateMachine").makeUpdatedActiveEmsgBoxes(a.allEmsgBoxes,b.videoElementPlayheadPosition,a.activeEmsgBoxes);if(a.waitingForDomTimeUpdateAfterSeeked){k=a.bufferingDetected;f=a.seeking;h=!1;var l=a.playbackState;return babelHelpers["extends"]({},a,{activeEmsgBoxes:g,playbackState:i({bufferingDetected:k,prevPlaybackState:l,seeking:f,waitingForDomPlaying:h}),waitingForDomPlaying:h,waitingForDomTimeUpdateAfterSeeked:!1})}return babelHelpers["extends"]({},a,{activeEmsgBoxes:g});case"dom_event_seeking":k=a.playbackState;l=k;switch(k){case"paused":case"ended":break;case"stalling":case"playing":l="stalling";break;default:k,c("recoverableViolation")("unexpected playbackState: "+k,"comet_video_player")}return babelHelpers["extends"]({},a,{playbackState:l,seeking:!0,waitingForDomPlaying:!0});case"dom_event_seeked":f=a.bufferingDetected;h=a.waitingForDomPlaying;g=!1;k=a.playbackState;return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:null,playbackState:i({bufferingDetected:f,prevPlaybackState:k,seeking:g,waitingForDomPlaying:h}),seeking:g,waitingForDomTimeUpdateAfterSeeked:!0});case"dom_event_error":e.payload.videoElementError==null&&d("VideoPlayerODS").bumpEntityKey("comet_video_player","dom_event_error.error_is_nullish",14);return babelHelpers["extends"]({},a,{playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play_promise_created":return babelHelpers["extends"]({},a,{hostCallPlayIDLast:e.payload.hostCallPlayID});case"dom_event_play_promise_resolved":return a.hostCallPlayIDLast!==e.payload.hostCallPlayID?a:babelHelpers["extends"]({},a,{hostCallPlayIDLast:null});case"dom_event_play_promise_rejected":if(a.hostCallPlayIDLast!==e.payload.hostCallPlayID)return a;if(c("gkx")("30214")){l=e.payload.playPromiseRejectionReason;return babelHelpers["extends"]({},a,{hostCallPlayIDLast:null},!(l!=null&&l.name==="AbortError")&&a.playbackState==="stalling"?{playbackState:"paused",waitingForDomPlaying:!1}:{})}return babelHelpers["extends"]({},a,{hostCallPlayIDLast:null,playbackState:a.playbackState==="stalling"?"paused":a.playbackState,waitingForDomPlaying:!1});case"dom_event_durationchange":if(c("gkx")("30214")){f=b.videoElementEnded===!0?"ended":b.videoElementPaused===!0?"paused":a.playbackState;if((a.playbackState==="stalling"||a.playbackState==="playing")&&f!==a.playbackState)return babelHelpers["extends"]({},a,{playbackState:f,waitingForDomPlaying:!1})}return a;case"implementation_host_call_queue_flushed":return babelHelpers["extends"]({},a,{hostCallQueue:[]});case"implementation_host_call_failed":k=d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromHTMLVideoElementError({errorLocation:e.payload.errorLocation,hostCallError:e.payload.hostCallError,videoElementError:e.payload.videoElementError,videoElementNetworkState:e.payload.videoElementNetworkState,videoElementReadyState:e.payload.videoElementReadyState});return babelHelpers["extends"]({},a,{error:k,playbackState:"paused",waitingForDomPlaying:!1});case"implementation_mounted":return babelHelpers["extends"]({},a,{mountState:"mounted_onscreen"});case"implementation_unmounted":return babelHelpers["extends"]({},a,{mountState:"unmounted"});case"implementation_onscreen":return babelHelpers["extends"]({},a,{mountState:"mounted_onscreen"});case"implementation_offscreen":return babelHelpers["extends"]({},a,{mountState:"mounted_offscreen"});case"implementation_video_node_unmounted":return babelHelpers["extends"]({},a,{hostCallPlayIDLast:null});case"implementation_engine_initialized":g=(h=e.payload.streamingFormat)!=null?h:a.streamingFormat;return babelHelpers["extends"]({},a,{selectedVideoQuality:e.payload.selectedVideoQuality,streamingFormat:g});case"implementation_engine_qualities_changed":f=(l=e.payload.streamingFormat)!=null?l:a.streamingFormat;return babelHelpers["extends"]({},a,{selectedVideoQuality:e.payload.selectedVideoQuality,streamingFormat:f});case"implementation_engine_destroyed":return babelHelpers["extends"]({},a,{hostCallPlayIDLast:null});case"implementation_fatal_error":return babelHelpers["extends"]({},a,{error:e.payload.fatalError,hostCallPlayIDLast:null,playbackState:"paused",waitingForDomPlaying:!1});case"implementation_seek_requested":return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:e.payload.seekSourcePosition});case"representation_changed":return babelHelpers["extends"]({},a);case"controller_pause_requested":return a.playbackState==="ended"?a:babelHelpers["extends"]({},a,{lastPausedTimeMs:Date.now(),lastPauseReason:e.payload.reason,lastPlayedTimeMs:0,playbackState:"paused",waitingForDomPlaying:!1,watchTimeMs:a.lastPlayedTimeMs>0?a.watchTimeMs+(Date.now()-a.lastPlayedTimeMs):a.watchTimeMs});case"controller_play_requested":return a.playbackState!=="paused"&&a.playbackState!=="ended"?a:babelHelpers["extends"]({},a,{hasPlayEverBeenRequested:!0,lastPlayedTimeMs:a.lastPlayedTimeMs===0?Date.now():a.lastPlayedTimeMs,lastPlayReason:e.payload.reason,loopCurrent:j(a)?e.payload.reason==="loop_initiated"?a.loopCurrent+1:a.loopCurrent:0,playbackState:"stalling",waitingForDomPlaying:!0});case"controller_seek_requested":return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:(k=b.videoElementPlayheadPosition)!=null?k:a.implementationSeekSourcePosition,seeking:!0,seekTargetPosition:e.payload.seekTargetPosition});case"controller_quality_requested":return babelHelpers["extends"]({},a,{selectedVideoQuality:e.payload.selectedVideoQuality});case"controller_video_variant_requested":return babelHelpers["extends"]({},a,{selectedVideoVariant:e.payload.selectedVideoVariant});case"controller_set_caption_display_style_requested":return babelHelpers["extends"]({},a,{captionDisplayStyle:e.payload.captionDisplayStyle});case"controller_set_picture_in_picture_state_requested":return babelHelpers["extends"]({},a,{isDesktopPictureInPicture:e.payload.isInPictureInPictureMode});case"controller_set_caption_format_requested":return babelHelpers["extends"]({},a,{captionFormat:e.payload.captionFormat});case"controller_set_playback_rate":return babelHelpers["extends"]({},a,{targetPlaybackRate:e.payload.playbackRate});case"controller_muted_requested":return babelHelpers["extends"]({},a,{lastMuteReason:e.payload.reason,muted:e.payload.muted});case"controller_volume_requested":return babelHelpers["extends"]({},a,{volume:e.payload.volume});case"controller_scrub_begin_requested":return a.scrubbing?a:babelHelpers["extends"]({},a,{scrubbing:!0,seekTargetPosition:null});case"controller_scrub_end_requested":return!a.scrubbing?a:babelHelpers["extends"]({},a,{implementationSeekSourcePosition:(h=b.videoElementPlayheadPosition)!=null?h:a.implementationSeekSourcePosition,scrubbing:!1,seeking:e.payload.seekTargetPosition!=null,seekTargetPosition:e.payload.seekTargetPosition});case"buffering_begin_requested":g=a.playbackState;l=g;switch(g){case"paused":case"ended":break;case"playing":case"stalling":l="stalling";break;default:g;c("recoverableViolation")("unexpected playbackState: "+g,"comet_video_player");break}f=e.payload.bufferingType;return babelHelpers["extends"]({},a,{bufferingDetected:!0,lastBufferingType:f,playbackState:l});case"buffering_end_requested":k=a.seeking;h=a.waitingForDomPlaying;g=!1;f=a.playbackState;return babelHelpers["extends"]({},a,{bufferingDetected:g,playbackState:i({bufferingDetected:g,prevPlaybackState:f,seeking:k,waitingForDomPlaying:h})});case"controller_set_captions_visible_requested":l=e.payload.captionsVisible;return a.captionsVisible===l?a:babelHelpers["extends"]({},a,{activeCaptions:l?a.activeCaptions:null,captionsLocale:l?a.captionsLocale:null,captionsVisible:l});case"controller_set_active_captions_requested":g=e.payload.activeCaptions;k=(f=g==null?void 0:g.rows)!=null?f:[];h=e.payload.captionsLocale;l=a.activeCaptions;var m=(f=l==null?void 0:l.rows)!=null?f:[];return m.length===k.length&&k.every(function(a,b){return m[b]===a})?a:babelHelpers["extends"]({},a,{activeCaptions:g,captionsLocale:h});case"captions_loaded":return babelHelpers["extends"]({},a,{activeCaptions:a.activeCaptions,captionsLoaded:!0});case"captions_unloaded":return babelHelpers["extends"]({},a,{activeCaptions:null,captionsLoaded:!1,captionsLocale:null});case"inband_captions_autogenerated_changed":l=e.payload.inbandCaptionsAutogenerated;return a.inbandCaptionsAutogenerated===l?a:babelHelpers["extends"]({},a,{inbandCaptionsAutogenerated:l});case"stream_ended":return babelHelpers["extends"]({},a,{streamEnded:!0});case"stream_gone_before_start":return babelHelpers["extends"]({},a,{playbackState:"ended",streamEnded:!0,waitingForDomPlaying:!1});case"stream_interrupted":return babelHelpers["extends"]({},a,{streamInterrupted:!0});case"stream_resumed":return babelHelpers["extends"]({},a,{streamInterrupted:!1});case"seekable_ranges_changed":f=e.payload.seekableRanges;return babelHelpers["extends"]({},a,{seekableRanges:f});case"controller_set_is_live_rewind_active_requested":k=e.payload.isLiveRewindActive;return babelHelpers["extends"]({},a,{isLiveRewindActive:k});case"loop_count_change_requested":g=e.payload.loopCount;return g===a.loopCount?a:babelHelpers["extends"]({},a,{loopCount:g,loopCurrent:0});case"player_dimensions_changed":h=e.payload.dimensions;l=h.height;f=h.width;return f===a.dimensions.width&&l===a.dimensions.height?a:babelHelpers["extends"]({},a,{dimensions:{height:l,width:f}});case"emsg_boxes_parsed":k=d("VideoPlayerEmsgForStateMachine").makeUpdatedAllEmsgBoxes(a.allEmsgBoxes,e.payload.emsgBoxes);g=d("VideoPlayerEmsgForStateMachine").makeUpdatedActiveEmsgBoxes(k,b.videoElementPlayheadPosition,a.activeEmsgBoxes);return babelHelpers["extends"]({},a,{activeEmsgBoxes:g,allEmsgBoxes:k});case"register_emsg_observer":h=new Set(a.emsgObserverTokens);h.add(e.payload.token);return babelHelpers["extends"]({},a,{emsgObserverTokens:h});case"unregister_emsg_observer":l=new Set(a.emsgObserverTokens);l["delete"](e.payload.token);return babelHelpers["extends"]({},a,{emsgObserverTokens:l});default:return a}}function l(a,b,d){var e=b.type!=="dom_seeking";e=e?d:a.uncontrolledState;d=!c("shallowEqual")(e,a.uncontrolledState);b=k(a.controlledState,e,b);var f=!c("shallowEqual")(b,a.controlledState);return d||f?babelHelpers["extends"]({},a,{controlledState:f?b:a.controlledState,uncontrolledState:d?e:a.uncontrolledState}):a}var m,n;function o(a){var b=a.collectUncontrolledState,d=a.debugLogId;d=a.initialState;var e=a.onDispatched,f=a.onFatalError,g=d,h=g,i=0,j=!1,k=!1,m=!0,n=!0;return{dispatch:function(a){if(!n)return;var d=null,g=null;try{++i;if(i>=10)if(!j){j=!0;throw c("unrecoverableViolation")("Video player state machine loop detected","comet_video_player")}else return;var o=h.uncontrolledState;if(m)try{o=b()}catch(a){m=!1,g=a}var p=h;o=l(p,a,o);h=o;e(p,o,a)}catch(a){n=!1,d=a}finally{if(!k&&(d!=null||g!=null)){k=!0;try{f((p=d)!=null?p:g)}catch(a){}}--i}},getCurrentState:function(){return h},getInitialState:function(){return g}}}var p,q;function a(a){var b=a.collectUncontrolledState,c=a.debugLogId,d=a.initialState,e=a.onFatalError,f=a.stateTransitionHandlers;function g(a,b,c){try{var d=!0,e=0;while(d&&e<f.length){var g=f[e];d=g(a,b,c);++e}}finally{}}return o({collectUncontrolledState:b,debugLogId:c,initialState:d,onDispatched:g,onFatalError:e})}function b(a,b){function c(){}function d(a){return a}function e(c){return function(e){var f=d(e.currentTarget);b(f,["reactEvent("+e.type+")"]);a.dispatch(c)}}function f(c){return function(e){var f=d(e.currentTarget);b(f,["reactEvent("+e.type+")"]);a.dispatch(c(e,f))}}return{onAbort:c,onCanPlay:f(function(a){return{payload:{domEventPerfTimestamp:a.timeStamp},type:"dom_event_canplay"}}),onCanPlayThrough:c,onDurationChange:e({type:"dom_event_durationchange"}),onEmptied:c,onEncrypted:c,onEnded:e({type:"dom_event_ended"}),onError:f(function(a,b){return{payload:{videoElementError:b.error,videoElementNetworkState:b.networkState,videoElementReadyState:b.readyState},type:"dom_event_error"}}),onLoadedData:f(function(a){return{payload:{domEventPerfTimestamp:a.timeStamp},type:"dom_event_loadeddata"}}),onLoadedMetadata:f(function(a){return{payload:{domEventPerfTimestamp:a.timeStamp},type:"dom_event_loadedmetadata"}}),onLoadStart:c,onPause:e({type:"dom_event_pause"}),onPlay:e({type:"dom_event_play"}),onPlaying:f(function(a){return{payload:{domEventPerfTimestamp:a.timeStamp},type:"dom_event_playing"}}),onProgress:e({type:"dom_event_progress"}),onRateChange:e({type:"dom_event_ratechange"}),onSeeked:e({type:"dom_event_seeked"}),onSeeking:e({type:"dom_event_seeking"}),onStalled:c,onSuspend:c,onTimeUpdate:e({type:"dom_event_timeupdate"}),onVolumeChange:e({type:"dom_event_volumechange"}),onWaiting:e({type:"dom_event_waiting"})}}g.createVideoPlayerImplementationStateMachine=o;g.createVideoPlayerImplementationStateMachineWithStateTransitionHandlers=a;g.createReactVideoElementCallbacksForStateMachine=b}),98);
__d("VideoPlayerImplementationStateMachineHostCallQueue",["cometUniqueID","emptyFunction","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";b=c("emptyFunction");function h(){return"id-vpdom-"+c("cometUniqueID")()}function i(a){var b=a.engineExtrasAPI,d=a.hostCall,e=a.machine;a=a.videoElementAPI;switch(d.type){case"host_call_play":var f=a.play();f&&(e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID},type:"dom_event_play_promise_created"}),c("promiseDone")(f.then(function(){e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID},type:"dom_event_play_promise_resolved"})},function(a){e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID,playPromiseRejectionReason:a},type:"dom_event_play_promise_rejected"})})));break;case"host_call_pause":a.pause();break;case"host_call_set_playback_rate":a.setPlaybackRate(d.payload.playbackRate);break;case"host_call_set_muted":a.setMuted(d.payload.muted);break;case"host_call_set_volume":a.setVolume(d.payload.volume);break;case"host_call_set_current_time":a.setPlayheadPosition(d.payload.currentTime);break;case"host_call_set_video_quality":b.setUserSelectedVideoQuality(d.payload.selectedVideoQuality);break;case"host_call_set_video_variant":b.setUserSelectedVideoVariant(d.payload.selectedVideoVariant);break;case"host_call_set_latency_level":b.setLatencyLevel(d.payload.latencyLevel);break;case"host_call_picture_in_picture":a.requestPictureInPicture();break;case"host_call_exit_picture_in_picture":a.exitPictureInPicture();break;default:d.type;return!1}return!0}function j(a){var b=a.engineExtrasAPI,c=a.hostCall,d=a.machine;a=a.videoElementAPI;if(!a||!b)d.dispatch(c);else{var e=!1;try{e=i({engineExtrasAPI:b,hostCall:c,machine:d,videoElementAPI:a})}catch(b){d.dispatch({payload:{errorLocation:"apply_host_call_catch",hostCall:c,hostCallError:b,videoElementError:a.getError(),videoElementNetworkState:a.getNetworkState(),videoElementReadyState:a.getReadyState()},type:"implementation_host_call_failed"})}e&&d.dispatch({payload:{hostCall:c},type:"implementation_host_call_applied"})}}function k(a){var b=[];function c(){b=b.filter(function(a){return a.type!=="host_call_play"&&a.type!=="host_call_pause"})}function d(a){b=b.filter(function(b){return b.type!==a})}a.forEach(function(a){switch(a.type){case"host_call_play":c();break;case"host_call_pause":c();break;case"host_call_set_playback_rate":d(a.type);break;case"host_call_set_muted":d(a.type);break;case"host_call_set_volume":d(a.type);break;case"host_call_set_current_time":d(a.type);break;case"host_call_set_video_quality":d(a.type);break;case"host_call_set_video_variant":d(a.type);break;case"host_call_set_latency_level":d(a.type);break;case"host_call_picture_in_picture":d(a.type);break;case"host_call_exit_picture_in_picture":d(a.type);break;default:a.type}b=b.concat([a])});return b}function a(a){var b=a.engineExtrasAPI,c=a.machine,d=a.reason,e=a.state,f=a.videoElementAPI;a=[{payload:{hostCallID:h(),reason:d,volume:e.controlledState.volume},type:"host_call_set_volume"},{payload:{hostCallID:h(),muted:e.controlledState.muted,reason:d},type:"host_call_set_muted"},{payload:{hostCallID:h(),reason:d,selectedVideoQuality:e.controlledState.selectedVideoQuality},type:"host_call_set_video_quality"},{payload:{hostCallID:h(),reason:d,selectedVideoVariant:e.controlledState.selectedVideoVariant},type:"host_call_set_video_variant"}];d=k(e.controlledState.hostCallQueue.concat(a));d.forEach(function(a){j({engineExtrasAPI:b,hostCall:a,machine:c,videoElementAPI:f})});c.dispatch({payload:{hostCallsFlushed:d},type:"implementation_host_call_queue_flushed"})}g.makeHostCallID=h;g.applyOrQueueHostCall=j;g.flushHostCallQueue=a}),98);
__d("VideoPlayerLoggerPlayerStates",[],(function(a,b,c,d,e,f){a="started";b="unpaused";c={STARTED:a,UNPAUSED:b};f["default"]=c}),66);
__d("VideoPlayerMutedStateChange",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.currMuted,c=a.currVolume,d=a.prevMuted;a=a.prevVolume;b=b||c===0;c=d||a===0;if(c===b)return null;return b?"muted":"unmuted"}f.getVideoPlayerMutedStateChange=a}),66);
__d("getPlayerFormatForLogData",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=a.isFullscreen;return a===!0?"full_screen":b!=null?b:"inline"}f["default"]=a}),66);
__d("getVideoBrowserTabId",["guid"],(function(a,b,c,d,e,f,g){var h=c("guid")().slice(-8);function a(){return h}g["default"]=a}),98);
__d("VideoPlayerImplementationStateMachineLogger",["CometProductAttribution","NetworkStatus","PlaybackSpeedExperiments","SiteData","VideoMimeTypes","VideoPlayerConnectionQuality","VideoPlayerImplementationErrorNormalization","VideoPlayerLoggerPlayerStates","VideoPlayerMutedStateChange","VideoPlayerStateBasedLoggingEvents","emptyFunction","getPlayerFormatForLogData","getVideoBrowserTabId","gkx","justknobx","mapObject","performanceAbsoluteNow","qex","recoverableViolation","removeFromArray"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=6e4,k=(b=c("qex")._("1675"))!=null?b:0,l=1e3,m=null,n=function(a){var b;m=(b=m)!=null?b:document.createElement("video");return!("canPlayType"in m)?"":m.canPlayType(a)};e=c("emptyFunction");f=c("emptyFunction");b=c("emptyFunction");e=c("emptyFunction");var o=(f=d("PlaybackSpeedExperiments").enablePlaybackSpeedLogging())!=null?f:!1;function p(){return{canLogPausedOrFinishedPlaying:!1,canLogPlayingEvent:!0,debugSubscribers:[],dontLogPauseOnUnpausedSeeking:!1,errorRecoveryAttemptState:{currentRecoverableError:null,eventsLogged:0,repeatCount:0},hasLoggedStallData:!1,hasLoggedStartedPlaying:!1,hasPausedOnce:!1,hasPendingRequestedPlaying:!1,initialSuborigin:void 0,inPlayStallCount200ms:0,interruptCount:0,interruptDuration:0,interruptEndTimestamp:0,interruptStartTimestamp:0,isLoggingScrubbingSequence:!1,lastLoggedError:null,lastLoggedFullscreenState:!1,lastLoggedPlaybackSpeed:null,lastLoggedViewabilityPercentage:void 0,lastStartTimePosition:null,lastTrackedAudioRepresentation:null,lastTrackedVideoRepresentation:null,nextHeartbeatTime:null,nextPlayedThreeSecondsPlayheadPosition:null,sequenceNumber:0,shouldIgnoreDomPause:!1,shouldIgnoreDomPlay:!1,shouldLogRequestedPlayingForScrub:!1,stallCount:0,stallCount200ms:0,stallCountTotal:0,stallDuration:0,stallDurationTotal:0,stallStartTimestamp:0,startStallCountTotal:0,startStallDurationTotal:0,vplEventSequenceNumber:0,warningState:{eventsLoggedPerKey:new Map(),eventsLoggedTotal:0,eventsMaxLoggedPerKey:function(){try{return Math.max(0,c("justknobx")._("1831")||0)}catch(a){return 0}}(),eventsMaxLoggedTotal:function(){try{return Math.max(0,c("justknobx")._("1832")||0)}catch(a){return 0}}()}}}function q(a,b){return b==="muted"||b==="unmuted"||b==="started_playing"||b==="caption_change"||b==="unpaused"?a.controlledState.captionsVisible?"on":"off":void 0}function a(a){var b=new Map(),e=a.initialLoggingMetaData,f=e,g=[],m=p(),r=new Set(c("VideoPlayerStateBasedLoggingEvents").StateBasedLoggingEventNames),s=!c("gkx")("646");function t(a){m.debugSubscribers.push(a);return function(){c("removeFromArray")(m.debugSubscribers,a)}}function u(a){m.debugSubscribers.forEach(function(b){return b(a)})}function v(a){var b=m.stallStartTimestamp;if(b>0){m.stallCount+=1;m.stallCountTotal+=1;m.hasPendingRequestedPlaying&&(m.startStallCountTotal+=1);a=a-b;b=a>200;m.stallDurationTotal+=a;m.stallDuration+=a;m.stallCount200ms+=b?1:0;m.inPlayStallCount200ms+=b&&!m.hasPendingRequestedPlaying?1:0;m.hasPendingRequestedPlaying&&(m.startStallDurationTotal+=a)}}function w(a,b){a=a.uncontrolledState.videoElementPlayheadPosition==null?null:a.uncontrolledState.videoElementPlayheadPosition;var c=null;switch(b){case"paused":case"cancelled_requested_playing":case"finished_playing":case"heart_beat":case"playback_speed_changed":case"representation_ended":c=m.lastStartTimePosition;break;case"scrubbed":c=a;break;default:break}switch(b){case"paused":case"cancelled_requested_playing":case"finished_playing":case"scrubbed":m.lastStartTimePosition=null;break;case"started_playing":case"unpaused":case"heart_beat":case"playback_speed_changed":case"representation_ended":m.lastStartTimePosition=a;break;default:break}return{video_last_start_time_position:c}}function x(a,b){var c=b.uncontrolledState.clockTimestamp;a=a.controlledState.streamInterrupted;b=b.controlledState.streamInterrupted;!a&&b?m.interruptStartTimestamp=c:a&&!b&&m.interruptStartTimestamp>0&&(m.interruptEndTimestamp=c,m.interruptCount+=1,m.interruptDuration+=m.interruptEndTimestamp-m.interruptStartTimestamp)}function y(a,b,c){var d=b.uncontrolledState.clockTimestamp;a=a.controlledState.playbackState;var e=b.controlledState.playbackState;a!=="stalling"&&e==="stalling"&&(u("stall_start"),m.stallStartTimestamp=d);if(a==="stalling"&&e!=="stalling"){d=0;(c.type==="dom_event_playing"||c.type==="buffering_end_requested")&&c.payload.domEventPerfTimestamp!=null&&(d=Math.max(b.uncontrolledState.perfTimestamp-c.payload.domEventPerfTimestamp,0));v(b.uncontrolledState.clockTimestamp-d);m.stallStartTimestamp=0;u("stall_end")}}function z(a,b,c){a=b.uncontrolledState;b=a.videoElementPlayheadPosition;switch(c){case"unpaused":case"started_playing":m.nextPlayedThreeSecondsPlayheadPosition=((a=b)!=null?a:0)+3;break;case"paused":case"finished_playing":m.nextPlayedThreeSecondsPlayheadPosition=null;break;default:break}}function A(a,b,c){if(m.interruptCount>0&&m.interruptDuration>0){a={interrupt_count:m.interruptCount,interrupt_time:m.interruptDuration};m.interruptCount=0;m.interruptDuration=0;m.interruptStartTimestamp=0;m.interruptEndTimestamp=0;return a}return{interrupt_count:null,interrupt_time:null}}function B(a,b,c){var d={stall_count:null,stall_count_200_ms:null,stall_time:null},e=b.uncontrolledState.clockTimestamp,f=function(){var a={stall_count:m.stallCount,stall_count_200_ms:m.stallCount200ms,stall_time:m.stallDuration};m.stallCount=0;m.stallCount200ms=0;m.stallDuration=0;m.stallStartTimestamp=0;return a};a=a.controlledState.playbackState;var g=b.controlledState.playbackState;a!=="stalling"&&g==="stalling"&&(m.stallStartTimestamp=e);switch(c){case"started_playing":case"unpaused":case"finished_playing":case"paused":case"cancelled_requested_playing":case"playback_speed_changed":case"representation_ended":v(b.uncontrolledState.clockTimestamp);d=f();break;case"heart_beat":b.controlledState.playbackState!=="stalling"&&(v(b.uncontrolledState.clockTimestamp),d=f());break;default:break}return d}function C(a,b,c){a=b.controlledState.playbackState==="paused"&&a.controlledState.playbackState==="stalling";return c>0&&(b.controlledState.playbackState==="stalling"||a)}function D(a,b){a=a.current;var c=null;switch(b){case"finished_playing":case"paused":case"heart_beat":a&&(c=a.getAndFlushTracedFrames());return c!=null?JSON.stringify(c):null;default:return null}}function E(a){a=a.controlledState.playbackState;switch(a){case"playing":case"stalling":return"playing";case"paused":return"paused";case"ended":return"finished";default:a;return"unknown"}}function F(a){switch(a){case"normal":return"normal";case"low":return"low";case"ultra-low":return"ultra_low";default:return null}}function G(){return{state:m.hasLoggedStartedPlaying?c("VideoPlayerLoggerPlayerStates").UNPAUSED:c("VideoPlayerLoggerPlayerStates").STARTED}}function H(a){if((a==null?void 0:a.v2)&&(a==null?void 0:a.v2.length)>0){var b=a==null?void 0:a.v2;b=b[b.length-1];return[b["class"],b.module].map(d("CometProductAttribution").filterEntryValue).join(":")}return(a=a==null?void 0:(b=a.v2)==null?void 0:b.map(function(a){return[a["class"],a.module].map(d("CometProductAttribution").filterEntryValue).join(":")}).join(";"))!=null?a:""}function I(f){var i,j=f.eventType,k=f.logDataOverrides,l=f.prevState,n=f.state;f=w(n,j);f=f.video_last_start_time_position;var p=B(l,n,j),t=p.stall_count,u=p.stall_count_200_ms;p=p.stall_time;var v=A(l,n,j),x=v.interrupt_count;v=v.interrupt_time;var y=D(a.videoLiveTraceRef,j),G=[],I=a.initialLoggingMetaData.coreVideoPlayerMetaData.autoplayGatingResult;I&&G.push(I);I=j==="entered_fs"?!0:j==="exited_fs"?!1:m.lastLoggedFullscreenState;i=c("getPlayerFormatForLogData")({isDesktopPictureInPicture:(i=n.controlledState.isDesktopPictureInPicture)!=null?i:!1,isFullscreen:I},e.coreVideoPlayerMetaData.playerFormat);var J=n.uncontrolledState.viewabilityPercentage,K=Boolean(n.uncontrolledState.isFBIsLiveTemplated),L=Boolean(n.uncontrolledState.isFBWasLive),M=n.uncontrolledState.videoElementPlaybackRate;M=M==null||M===0?m.lastLoggedPlaybackSpeed:M;var N=a.initialLoggingMetaData.productAttribution;if(i==="watch_scroll"&&N&&N.v2){var O,P={0:babelHelpers["extends"]({},N["0"]),v2:[babelHelpers["extends"]({},N.v2[0])]};O=(O=e.productAttribution)==null?void 0:(O=O.v2)==null?void 0:O[0];if(O){var Q=P.v2[0];Q["class"]=O["class"];Q.scope_id=O.scope_id;Q.ts=O.ts}N=P}Q=null;O=null;Q=N!=null?d("CometProductAttribution").minifyProductAttributionV2(N):null;O=N!=null?H(N):null;P=C(l,n,(P=p)!=null?P:0);Q={access_token:a.initialLoggingMetaData.accessToken,ad_client_token:e.coreVideoPlayerMetaData.adClientToken,attribution_id:N!=null&&Object.prototype.hasOwnProperty.call(N,"0")?JSON.stringify({0:N["0"]}):null,attribution_id_v2:Q,attribution_id_v2_root:O,audio_only:e.coreVideoPlayerMetaData.audioOnly,audio_representation_id:n.uncontrolledState.audioRepresentationID,autoplay_eligible:a.initialLoggingMetaData.coreVideoPlayerMetaData.canAutoplay==="allow",autoplay_failure_reasons:JSON.stringify(G),autoplay_setting:a.initialLoggingMetaData.coreVideoPlayerMetaData.autoplaySetting,available_qualities:n.uncontrolledState.availableQualities.length,broadcaster_origin:a.initialLoggingMetaData.coreVideoPlayerMetaData.broadcasterOrigin,browser_tab_id:c("getVideoBrowserTabId")(),caption_state:q(n,j),client_latency_setting:F(n.controlledState.latencyLevel),current_playback_speed:o?M:null,current_viewability_percentage:J,dash_perf_logging_enabled:e.coreVideoPlayerMetaData.VideoPlayerShakaPerformanceLoggerClass!=null&&e.coreVideoPlayerMetaData.VideoPlayerShakaPerformanceLoggerClass.isEnabled(),data_connection_quality:d("VideoPlayerConnectionQuality").evaluate(function(){return n.uncontrolledState.estimatedBandwidth}),downstream_share_origin_uri:(N=e.downstreamShareSignalTracking)==null?void 0:N.downstream_share_session_origin_uri,downstream_share_start_time:(Q=e.downstreamShareSignalTracking)==null?void 0:Q.downstream_share_session_start_time,downstream_share_visit_uuid:(O=e.downstreamShareSignalTracking)==null?void 0:O.downstream_share_session_id,dropped_frame_count:n.uncontrolledState.videoElementDroppedFrameCount,external_log_id:e.coreVideoPlayerMetaData.externalLogID,external_log_type:e.coreVideoPlayerMetaData.externalLogType,fb_manifest_identifier:n.uncontrolledState.manifestIdentifier,frame_events:y,interrupt_count:x,interrupt_time:v,is_abr_enabled:n.isAbrEnabled,is_fbms:n.uncontrolledState.isFBMS,is_live_video_rewound:n.controlledState.isLiveRewindActive,is_mixed_codec_manifest:n.uncontrolledState.isMixedCodecManifest,is_pip:n.controlledState.isDesktopPictureInPicture,is_predictive_playback:n.uncontrolledState.isPredictiveDash,is_sound_on:!n.controlledState.muted,is_stalling:P,is_templated_manifest:K||L,last_viewability_percentage:m.lastLoggedViewabilityPercentage,mpd_validation_errors:n.uncontrolledState.mpdValidationErrors,network_connected:n.uncontrolledState.networkConnected,playback_caption_format:n.controlledState.captionFormat,playback_caption_locale:n.controlledState.captionsLocale,playback_duration:n.uncontrolledState.videoElementDuration,playback_is_broadcast:a.initialLoggingMetaData.coreVideoPlayerMetaData.isVideoBroadcast,playback_is_drm:Boolean(a.initialLoggingMetaData.coreVideoPlayerMetaData.graphQLVideoDRMInfo),playback_is_live_streaming:a.initialLoggingMetaData.coreVideoPlayerMetaData.isLiveStreaming,player_format:i,player_instance_key:e.instanceKey,player_origin:e.coreVideoPlayerMetaData.playerOriginOverride,player_state:E(n),player_suborigin:e.coreVideoPlayerMetaData.subOrigin,player_version:n.playerVersion,projection:n.uncontrolledState.videoProjection,representation_id:n.uncontrolledState.videoRepresentationID,source_VPL_LOGGING_HACK:e.coreVideoPlayerMetaData.source_VPL_LOGGING_HACK,stall_count:t,stall_count_200_ms:u,stall_time:p,streaming_format:n.controlledState.streamingFormat,total_frame_count:n.uncontrolledState.videoElementTotalFrameCount,tracking_data_encrypted:a.initialLoggingMetaData.trackingDataEncrypted,tracking_nodes:a.initialLoggingMetaData.trackingNodes,v2_heart_beat:c("gkx")("24377")&&j==="heart_beat"?!0:null,video_bandwidth:n.uncontrolledState.estimatedBandwidth,video_buffer_end_position:n.uncontrolledState.videoElementLastBufferEndPosition,video_id:e.coreVideoPlayerMetaData.videoFBID,video_last_start_time_position:f,video_play_reason:n.controlledState.lastPlayReason,video_player_height:(G=e.dimensions)==null?void 0:G.height,video_player_width:(N=e.dimensions)==null?void 0:N.width,video_time_position:n.uncontrolledState.videoElementPlayheadPosition,web_client_revision:c("SiteData").client_revision};O=r.has(j)?++m.sequenceNumber:null;y={event_seq_num:++m.vplEventSequenceNumber,seq_num:O,time_ms:Date.now(),vpts:(h||(h=c("performanceAbsoluteNow")))()};var R={};b.forEach(function(a,b){R[b]=a});x=e.coreVideoPlayerMetaData.additionalLogData;v=babelHelpers["extends"]({},x,R);P=babelHelpers["extends"]({},v,Q,k,y);L=(K=m.initialSuborigin)!=null?K:e.coreVideoPlayerMetaData.subOrigin;t=(i=P.source_VPL_LOGGING_HACK)!=null?i:L;p=(u=e.coreVideoPlayerMetaData.initialTracePolicy)!=null?u:e.coreVideoPlayerMetaData.routeTracePolicy;f={eventType:j,logData:P,routeTracePolicy:p,source_VPL_LOGGING_HACK:t};g.push(f);s&&z(l,n,j);m.initialSuborigin==null&&L!=null&&(m.initialSuborigin=L);m.lastLoggedFullscreenState=I;m.lastLoggedPlaybackSpeed=M;j==="viewability_changed"&&(m.lastLoggedViewabilityPercentage=J)}var J={};function K(a,b,c){I({eventType:"requested_playing",logDataOverrides:babelHelpers["extends"]({},c,G()),prevState:a,state:b});m.hasPendingRequestedPlaying=!0;m.canLogPausedOrFinishedPlaying=!0;return J}function L(a,b,c){if(!m.canLogPausedOrFinishedPlaying)return J;else if(m.hasPendingRequestedPlaying){M(a,b,c);m.canLogPausedOrFinishedPlaying=!1;m.hasPendingRequestedPlaying=!1;return J}else{I({eventType:"paused",logDataOverrides:babelHelpers["extends"]({},c,{error_user_info:JSON.stringify({is_document_hidden:b.uncontrolledState.isDocumentHidden})}),prevState:a,state:b});m.canLogPausedOrFinishedPlaying=!1;m.hasPendingRequestedPlaying=!1;return J}}function M(a,b,c){var d=b.uncontrolledState.liveTraceContext;c=babelHelpers["extends"]({},c,G(),{live_trace_source_id:d?d.sourceId:void 0,live_trace_stream_id:d?d.streamId:void 0,live_trace_stream_type:d?d.streamType:void 0});I({eventType:"cancelled_requested_playing",logDataOverrides:c,prevState:a,state:b});return J}function N(a,b,d){if(d.type==="dom_event_play_promise_rejected"&&d.payload.hostCallPlayID===a.controlledState.hostCallPlayIDLast&&b.controlledState.hostCallPlayIDLast==null&&m.hasPendingRequestedPlaying){d=d.payload.playPromiseRejectionReason;if(d!=null&&d.name==="NotAllowedError"){M(a,b,{debug_reason:"not_allowed"});return J}else if(!c("gkx")("30214")&&d!=null&&d.name==="AbortError"){M(a,b,{debug_reason:"aborted"});return J}else return J}else return J}function O(a,b,c){if((c.type==="controller_play_requested"||c.type==="dom_event_play"&&!m.shouldIgnoreDomPlay)&&a.controlledState.playbackState!==b.controlledState.playbackState){c=b.uncontrolledState.liveTraceContext;c=c?{live_trace_source_id:c.sourceId,live_trace_stream_id:c.streamId,live_trace_stream_type:c.streamType}:null;K(a,b,c);return J}else return J}function P(a,b,c){if(a.controlledState.playbackState==="stalling"&&b.controlledState.playbackState==="playing"&&m.canLogPlayingEvent){c=b.uncontrolledState.liveTraceContext;c=c?{live_trace_source_id:c.sourceId,live_trace_stream_id:c.streamId,live_trace_stream_type:c.streamType}:null;I({eventType:m.hasLoggedStartedPlaying?"unpaused":"started_playing",logDataOverrides:c,prevState:a,state:b});m.hasLoggedStartedPlaying=!0;m.canLogPlayingEvent=!1;m.hasPendingRequestedPlaying=!1;return J}else return J}function Q(a,b,c){var d=b.controlledState.playbackState,e=a.controlledState.playbackState;if(c.type==="controller_scrub_begin_requested"&&!a.controlledState.scrubbing&&d!=="paused"&&d!=="ended"){L(a,b);m.isLoggingScrubbingSequence=!0;return J}else if(!a.controlledState.seeking&&b.controlledState.seeking&&!m.isLoggingScrubbingSequence&&d!=="paused"&&d!=="ended"&&!m.hasPendingRequestedPlaying){L(a,b);m.shouldLogRequestedPlayingForScrub=!0;return J}else if(c.type==="controller_scrub_end_requested"&&a.controlledState.scrubbing&&d!=="paused"&&d!=="ended"){K(a,b,{video_time_position:c.payload.seekTargetPosition});return J}else if(a.controlledState.seeking&&!b.controlledState.seeking){m.shouldLogRequestedPlayingForScrub&&d!=="paused"&&d!=="ended"&&K(a,b);I({eventType:"scrubbed",prevState:a,state:b});m.isLoggingScrubbingSequence=!1;m.shouldLogRequestedPlayingForScrub=!1;e!=="paused"&&e!=="ended"&&(m.canLogPlayingEvent=!0);return J}else return J}function R(a,b,c){if(a.controlledState.playbackState!==b.controlledState.playbackState&&b.controlledState.playbackState==="ended"&&m.canLogPausedOrFinishedPlaying){I({eventType:"finished_playing",prevState:a,state:b});m.canLogPausedOrFinishedPlaying=!1;return J}else return J}function S(a,b,c){if((c.type==="controller_pause_requested"||c.type==="dom_event_pause"&&!m.shouldIgnoreDomPause)&&a.controlledState.playbackState!==b.controlledState.playbackState){L(a,b,{debug_reason:"paused"});return J}else return J}function T(a,b,c){var d=b.controlledState.playbackState;if(d!=="paused"&&d!=="ended"){c.type==="implementation_video_node_unmounted"?L(a,a,{debug_reason:"unloaded"}):(c.type==="implementation_unmounted"||c.type==="implementation_engine_destroy_requested")&&L(a,b,{debug_reason:"unloaded"});return J}else return J}function U(a,b,c){if(c.type==="implementation_engine_representation_blocked"){c=c.payload.blockedRepresentationID;I({eventType:"video_playback_fallback",logDataOverrides:{representation_id:c},prevState:a,state:b})}return J}function V(a,b,e){e=b.controlledState.muted;var f=b.controlledState.volume,g=a.controlledState.muted,h=a.controlledState.volume;e=d("VideoPlayerMutedStateChange").getVideoPlayerMutedStateChange({currMuted:e,currVolume:f,prevMuted:g,prevVolume:h});g={current_volume:Math.round(f*100)};switch(e){case"muted":I({eventType:"muted",logDataOverrides:g,prevState:a,state:b});return J;case"unmuted":I({eventType:"unmuted",logDataOverrides:g,prevState:a,state:b});return J;case null:if(h<f){I({eventType:"volume_increase",logDataOverrides:g,prevState:a,state:b});return J}else if(h>f){I({eventType:"volume_decrease",logDataOverrides:g,prevState:a,state:b});return J}else return J;default:e;c("recoverableViolation")('Unexpected mutedStateChange "'+e+'"',"comet_video_player");return J}}function W(a,b,c){c=b.uncontrolledState.videoRepresentationID;var d=m.lastTrackedVideoRepresentation,e=b.uncontrolledState.audioRepresentationID,f=m.lastTrackedAudioRepresentation,g=b.controlledState.playbackState,h=b.controlledState.seeking;if(!h&&g!=="paused"&&g!=="ended"&&d!=null&&d!==c){var i=b.uncontrolledState.availableVideoTracks.find(function(a){return a.id===b.uncontrolledState.videoRepresentationID}),j=b.uncontrolledState.availableVideoTracks.find(function(a){return a.id===m.lastTrackedVideoRepresentation});I({eventType:"representation_ended",logDataOverrides:{next_quality_label:i==null?void 0:i.qualityLabel,next_representation_id:i==null?void 0:i.id,next_video_codecs:i==null?void 0:i.codec,quality_label:j==null?void 0:j.qualityLabel,representation_id:j==null?void 0:j.id,video_codecs:j==null?void 0:j.codec},prevState:a,state:b});m.lastTrackedVideoRepresentation=c;u("quality_change")}else d==null&&d!==c&&(m.lastTrackedVideoRepresentation=c);!h&&g!=="paused"&&g!=="ended"&&f!=null&&f!==e?(I({eventType:"representation_ended",logDataOverrides:{audio_representation_id:f,next_representation_id:e},prevState:a,state:b}),m.lastTrackedAudioRepresentation=e,u("audio_change")):f==null&&f!==e&&(m.lastTrackedAudioRepresentation=e);return J}function X(a,b,d){var f=a.controlledState.error===d?babelHelpers["extends"]({},a,{controlledState:babelHelpers["extends"]({},a.controlledState,{error:{$ref:"$.player.lastError"}})}):a;a.uncontrolledState.videoElementError!=null&&(f=babelHelpers["extends"]({},f,{uncontrolledState:babelHelpers["extends"]({},f.uncontrolledState,{videoElementError:{code:a.uncontrolledState.videoElementError.code,message:a.uncontrolledState.videoElementError.message}})}));var g=b,h=typeof b.payload==="object"&&b.payload!=null?b.payload:null;if(h!=null){var j={};Object.keys(h).forEach(function(a){var b=h[a];b===d?j[a]={$ref:"$.player.lastError"}:j[a]=b});g=babelHelpers["extends"]({},b,{payload:j})}return{currentVideo:{audioStreamId:a.uncontrolledState.audioRepresentationID,dashAudioFormat:void 0,hasHD:void 0,hasRateLimit:void 0,hasSubtitles:a.controlledState.captionsLoaded,isDrm:Boolean(e.coreVideoPlayerMetaData.graphQLVideoDRMInfo),isHD:void 0,isLiveStream:e.coreVideoPlayerMetaData.isLiveStreaming,isRateLimited:void 0,liveManifestUrl:void 0,projection:a.uncontrolledState.videoProjection,resourceUrl:void 0,streamId:a.uncontrolledState.videoRepresentationID,streamType:a.controlledState.streamingFormat,tagHD:void 0,tagSD:void 0,videoID:e.coreVideoPlayerMetaData.videoFBID},player:{canPlayType:(i||(i=c("mapObject")))(c("VideoMimeTypes"),n),dimensions:e.dimensions?{height:e.dimensions.height,width:e.dimensions.width}:null,droppedFrames:a.uncontrolledState.videoElementDroppedFrameCount,initializationTime:void 0,initializationTimestamp:void 0,inPlayStallCount:void 0,inPlayStallTime:void 0,interruptCount:void 0,interruptTime:void 0,lastError:d,loggedError:m.lastLoggedError===d?{$ref:"$.player.lastError"}:m.lastLoggedError,stallCount:m.stallCount,stallTime:m.stallDuration,state:E(a),totalFrames:a.uncontrolledState.videoElementTotalFrameCount,version:a.playerVersion,videoSource:void 0,viewabilityPercentage:a.uncontrolledState.viewabilityPercentage},playerStateMachine:{action:g,state:f}}}function aa(a){var b=a.errorMessageFormat,c=a.errorName;a=a.errorCode==null||a.errorCode===""?c:a.errorCode;c=c+"#"+a+": "+ba(b);return c}function Y(a,b,c,e){a=X(a,b,c);b=c.errorMessageFormat;var f=c.errorName,g=c.errorType,h=c.url;c=c.errorCode==null||c.errorCode===""?f:c.errorCode;return{error:f,error_code:c,error_description:b,error_domain:f,error_type:(c=g)!=null?c:d("VideoPlayerImplementationErrorNormalization").getErrorTypeFromErrorName(f,b),error_user_info:JSON.stringify(babelHelpers["extends"]({},a,e)),resource_url:h}}var ba=function(a){return a.replace(/([0-9]{2,})/g,function(a){var b="";while(b.length<a.length)b+="#";return b})};function ca(a,b,d){if(!c("gkx")("24360"))return J;if(d.type==="implementation_warning"){var e,f=d.payload.warningError,g=aa(f),h=m.warningState.eventsLoggedTotal;e=(e=m.warningState.eventsLoggedPerKey.get(g))!=null?e:0;if(h<m.warningState.eventsMaxLoggedTotal&&e<m.warningState.eventsMaxLoggedPerKey){m.warningState.eventsLoggedTotal++;m.warningState.eventsLoggedPerKey.set(g,e+1);g=Y(b,d,f,{warning:{loggedPerKey:e+1,loggedTotal:h+1}});I({eventType:"player_warning",logDataOverrides:babelHelpers["extends"]({},G(),g),prevState:a,state:b})}}return J}function da(a,b,c){var d=b.controlledState.error;if(d!=null&&d!==m.lastLoggedError&&d.errorCode!=="410"){c=Y(b,c,d);I({eventType:"error",logDataOverrides:babelHelpers["extends"]({},G(),c),prevState:a,state:b});m.lastLoggedError=d}return J}function Z(a,b,c){var d=m.errorRecoveryAttemptState.currentRecoverableError;if(d!=null){c=Y(b,c,d);m.errorRecoveryAttemptState.eventsLogged++;m.errorRecoveryAttemptState.repeatCount=0;I({eventType:"error_recovery_attempt",logDataOverrides:babelHelpers["extends"]({},c),prevState:a,state:b})}return J}function ea(a,b,d){if(d.type==="error_recovery_attempt"&&m.errorRecoveryAttemptState.eventsLogged<l){var e=m.errorRecoveryAttemptState.currentRecoverableError,f=d.payload.recoverableError;if(f!=null&&f.errorName==="OZ_NETWORK"&&!c("NetworkStatus").isOnline())return J;m.errorRecoveryAttemptState.currentRecoverableError=f;e==null||e.errorName!==f.errorName||e.errorCode!==f.errorCode?Z(a,b,d):(m.errorRecoveryAttemptState.repeatCount++,m.errorRecoveryAttemptState.repeatCount>k&&Z(a,b,d))}return J}function fa(a,b,c){if(!o)return J;var d=b.uncontrolledState.videoElementPlaybackRate;c.type==="dom_event_ratechange"&&m.lastLoggedPlaybackSpeed!=null&&d!==0&&d!==m.lastLoggedPlaybackSpeed&&I({eventType:"playback_speed_changed",prevState:a,state:b});return J}function ga(a,b,c){c=b.controlledState.playbackState;c==="paused"||c==="ended"?m.nextHeartbeatTime=null:c!=="stalling"&&m.nextHeartbeatTime==null&&(m.nextHeartbeatTime=Date.now()+j);var d=m.nextHeartbeatTime;if(d!=null){var e=Date.now();e>=d&&(c!=="stalling"&&I({eventType:"heart_beat",prevState:a,state:b}),m.nextHeartbeatTime=e+j)}return J}function ha(a,b,c){if(c.type==="implementation_mounted"){I({eventType:"player_loaded",prevState:a,state:b});return J}else return J}function $(a,b,c){I({eventType:c?"entered_fs":"exited_fs",prevState:a,state:b})}function ia(a,b,c){e.coreVideoPlayerMetaData.playerFormat!==f.coreVideoPlayerMetaData.playerFormat&&I({eventType:"player_format_changed",prevState:a,state:b});return J}function ja(a,b,c){if(c.type==="dom_event_timeupdate"){c=m.nextPlayedThreeSecondsPlayheadPosition;if(c!=null){var d=b.uncontrolledState;d=d.videoElementPlayheadPosition;d!=null&&c<=d&&(I({eventType:"played_for_three_seconds",prevState:a,state:b}),m.nextPlayedThreeSecondsPlayheadPosition=null)}}return J}function ka(a,b,c){if(c.type!=="notify_fullscreen_changed")return J;c=m.lastLoggedFullscreenState;var d=b.uncontrolledState.isFullscreen;if(c!==!0&&d===!0){$(a,b,d);return J}else if(c===!0&&d===!1){$(a,b,d);return J}else return J}function la(a,b,d){d=e.coreVideoPlayerMetaData.adClientToken;if((d==null||d==="")&&c("gkx")("24380"))return J;d=b.controlledState.playbackState;var f=m.lastLoggedViewabilityPercentage,g=b.uncontrolledState.viewabilityPercentage;if(d!=="paused"&&d!=="ended"&&f!=null&&f!==g){I({eventType:"viewability_changed",prevState:a,state:b});return J}else return J}function ma(a,b,c){if(c.type==="controller_set_captions_visible_requested"){I({eventType:"caption_change",prevState:a,state:b});return J}else return J}function na(a){f=e;if(a.type==="notify_logging_metadata_change"){a=a.payload.loggingMetaData;e=a}}return{addDebugSubscriber:function(a){return t(a)},consumeLoggerEvents:function(){var a=g.splice(0);return a},getLoggerState:function(){return m},handleStateMachine:function(a,b,c){na(c);var d=b.controlledState.playbackState;y(a,b,c);x(a,b);var e=[ia,ka,la,N,O,Q,P,R,S,U,V,T,ha,ma,W,ca,da,ea,ga,fa].concat(s?[ja]:[]);e.forEach(function(d){d(a,b,c)});(d==="paused"||d==="ended")&&(m.canLogPlayingEvent=!0);c.type==="controller_pause_requested"&&(m.hasPausedOnce=!0,m.shouldIgnoreDomPause=!0);c.type==="controller_play_requested"&&(m.hasPausedOnce=!0,m.shouldIgnoreDomPlay=!0);c.type==="dom_event_pause"&&(m.shouldIgnoreDomPause=!1);c.type==="dom_event_play"&&(m.shouldIgnoreDomPlay=!1,m.lastLoggedViewabilityPercentage=b.uncontrolledState.viewabilityPercentage)},logVPLEvent:function(a){var b=a.eventType,c=a.logDataOverrides;a=a.state;I({eventType:b,logDataOverrides:c,prevState:a,state:a})},setAdditionalLogData:function(a,c){b.set(a,c)}}}g.HEARTBEAT_INTERVAL=j;g.createVideoPlayerImplementationStateMachineLogger=a}),98);
__d("VideoPlayerImplementationStateMachineStateUncontrolledState",["NetworkStatus","convertToViewabilityPercentage","gkx","performance"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b,d=a.engineExtrasAPI,e=a.fullscreenControllerRef,f=a.videoElementAPI,g=a.videoLiveTraceRef;a=a.videoPlayerPassiveViewabilityInfoRef;g=g.current;var i=Date.now(),j=typeof (h||(h=c("performance"))).now==="function"?(h||(h=c("performance"))).now():0;if(f==null){var k;return{audioRepresentationID:void 0,availableAudioTracks:[],availableQualities:[],availableVideoTracks:[],clockTimestamp:i,currentPlayingAudioTrackID:void 0,currentPlayingVideoQuality:void 0,estimatedBandwidth:void 0,isDocumentHidden:document.hidden,isDRM:void 0,isFBIsLiveTemplated:void 0,isFBMS:void 0,isFBWasLive:void 0,isFullscreen:e.current?e.current.getIsFullscreen():void 0,isLiveRewindAvailable:void 0,isMixedCodecManifest:null,isPredictiveDash:void 0,liveTraceContext:g?(k=g.getLiveTraceContext())!=null?k:void 0:void 0,manifestIdentifier:void 0,mpdValidationErrors:void 0,networkConnected:void 0,perfTimestamp:j,targetAudioTrack:null,targetVideoQuality:"",videoElementDebugCurrentSrc:void 0,videoElementDebugSrc:void 0,videoElementDroppedFrameCount:void 0,videoElementDuration:void 0,videoElementEnded:void 0,videoElementError:void 0,videoElementLastBufferEndPosition:void 0,videoElementMuted:void 0,videoElementNetworkState:void 0,videoElementPaused:void 0,videoElementPlaybackRate:void 0,videoElementPlayheadPosition:void 0,videoElementReadyState:void 0,videoElementTotalFrameCount:void 0,videoElementVolume:void 0,videoProjection:void 0,videoRepresentationID:void 0,viewabilityPercentage:void 0}}k=f.getPlayheadPosition();a=a&&a.current;a=a&&a.getCurrent();return{audioRepresentationID:d?d.getCurrentPlayingAudioRepresentationID():void 0,availableAudioTracks:(b=d==null?void 0:d.getAvailableAudioTracks())!=null?b:[],availableQualities:(b=d==null?void 0:d.getAvailableVideoQualities())!=null?b:[],availableVideoTracks:(b=d==null?void 0:d.getAvailableVideoTracks())!=null?b:[],clockTimestamp:i,currentPlayingAudioTrackID:d?d.getCurrentPlayingAudioRepresentationID():void 0,currentPlayingVideoQuality:d?d.getCurrentPlayingVideoQuality():void 0,estimatedBandwidth:d?d.getEstimatedBandwidth():void 0,isDocumentHidden:document.hidden,isDRM:d?d.isDrm():void 0,isFBIsLiveTemplated:d?d.isFBIsLiveTemplated():void 0,isFBMS:d?d.isFBMS():void 0,isFBWasLive:d?d.isFBWasLive():void 0,isFullscreen:e.current?e.current.getIsFullscreen():void 0,isLiveRewindAvailable:d?d.isLiveRewindAvailable():void 0,isMixedCodecManifest:d?d.isMixedCodecManifest():null,isPredictiveDash:d?d.isPredictiveDash():void 0,liveTraceContext:g?(b=g.getLiveTraceContext())!=null?b:void 0:void 0,manifestIdentifier:d?d.getManifestIdentifier():void 0,mpdValidationErrors:d?d.getMpdValidationErrors():void 0,networkConnected:c("NetworkStatus").isOnline(),perfTimestamp:j,targetAudioTrack:(i=d==null?void 0:d.getTargetAudioTrack())!=null?i:null,targetVideoQuality:(e=d==null?void 0:d.getCurrentTargetVideoQuality())!=null?e:"",videoElementDebugCurrentSrc:c("gkx")("24351")?(g=f.getUnderlyingVideoElement())==null?void 0:g.currentSrc:void 0,videoElementDebugSrc:c("gkx")("24351")?(b=f.getUnderlyingVideoElement())==null?void 0:b.src:void 0,videoElementDroppedFrameCount:f.getDroppedFrameCount(),videoElementDuration:f.getDuration(),videoElementEnded:f.getEnded(),videoElementError:f.getError(),videoElementLastBufferEndPosition:f.getLastBufferEndPosition(),videoElementMuted:f.getMuted(),videoElementNetworkState:f.getNetworkState(),videoElementPaused:f.getPaused(),videoElementPlaybackRate:f.getPlaybackRate(),videoElementPlayheadPosition:k,videoElementReadyState:f.getReadyState(),videoElementTotalFrameCount:f.getTotalFrameCount(),videoElementVolume:f.getVolume(),videoProjection:d==null?void 0:d.getVideoProjectionType(),videoRepresentationID:d?d.getCurrentPlayingVideoRepresentationID():void 0,viewabilityPercentage:a?c("convertToViewabilityPercentage")(a.visiblePercentage):void 0}}g.createVideoPlayerImplementationStateMachineStateUncontrolledState=a}),98);
__d("VideoPlayerImplementationStateMachineState",["VideoPlayerImplementationStateMachineStateUncontrolledState"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.alwaysShowCaptions,c=a.areCaptionsAutogenerated,e=a.captionDisplayStyle,f=a.dimensions,g=a.isAbrEnabled,h=a.playerVersion;a=a.streamingFormat;var i=!0,j=1,k=d("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:null,fullscreenControllerRef:{current:null},videoElementAPI:null,videoLiveTraceRef:{current:null},videoPlayerPassiveViewabilityInfoRef:{current:null}});return{controlledState:{activeCaptions:null,activeEmsgBoxes:[],allEmsgBoxes:new Map(),bufferingDetected:!1,captionDisplayStyle:e,captionFormat:null,captionsLoaded:!1,captionsLocale:null,captionsVisible:b,dimensions:f,domEventsLatestPerfMs:{},emsgObserverTokens:new Set(),error:null,hasPlayEverBeenRequested:!1,hostCallPlayIDLast:null,hostCallQueue:[],implementationSeekSourcePosition:null,inbandCaptionsAutogenerated:c,isDesktopPictureInPicture:!1,isLiveRewindActive:!1,lastBufferingType:null,lastMuteReason:null,lastPausedTimeMs:0,lastPauseReason:null,lastPlayedTimeMs:0,lastPlayReason:null,latencyLevel:"normal",loopCount:0,loopCurrent:0,mountState:"before_mounted",muted:i,playbackState:"paused",scrubbing:!1,seekableRanges:null,seeking:!1,seekTargetPosition:null,selectedVideoQuality:"notselected",selectedVideoVariant:null,streamEnded:!1,streamingFormat:a,streamInterrupted:!1,targetPlaybackRate:1,ullIneligibilityReason:null,volume:j,waitingForDomPlaying:!1,waitingForDomTimeUpdateAfterSeeked:!1,watchTimeMs:0},isAbrEnabled:g,playerVersion:h,uncontrolledState:k}}g.createVideoPlayerImplementationStateMachineInitialState=a}),98);
__d("useSEOLoggedOutWebCrawler",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("23157")}g["default"]=a}),98);
__d("VideoPlayerImplementationEngineAPI",["CometEventListener","CometVideoPictureInPictureManagerContext","CometVisualCompletion","CurrentUser","ErrorMetadata","FBLogger","MediaPlaybackCompoundEventStateMachineLogger","MediaPlaybackLogFlusher","PlaybackSpeedExperiments","RunComet","SubscriptionsHandler","VideoLiveTrace","VideoPlayerBanzaiLogFlusher","VideoPlayerCaptionsController","VideoPlayerImplementationReactVideoElement.react","VideoPlayerImplementationStateMachine","VideoPlayerImplementationStateMachineHostCallQueue","VideoPlayerImplementationStateMachineLogger","VideoPlayerImplementationStateMachineState","VideoPlayerImplementationStateMachineStateUncontrolledState","VideoPlayerVideoPixelsFitContext","clearTimeout","cr:2336","cr:355","cr:4596","cr:506","deepEquals","err","gkx","qex","react","recoverableViolation","removeFromArray","setTimeout","unrecoverableViolation","useConcurrentAutoplayManagementAPI","useSEOLoggedOutWebCrawler","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));f=h;var j=f.useEffect,k=f.useRef,l=f.useState,m=function(){function a(a){var b=a.pauseRequestCallbacks,c=a.playRequestCallbacks,d=a.scrubBeginRequestCallbacks;a=a.scrubEndRequestCallbacks;this.$1=c;this.$2=b;this.$3=d;this.$4=a}var b=a.prototype;b.playRequest=function(a){var b=this;this.$1.push(a);return function(){c("removeFromArray")(b.$1,a)}};b.pauseRequest=function(a){var b=this;this.$2.push(a);return function(){c("removeFromArray")(b.$2,a)}};b.scrubBeginRequest=function(a){var b=this;this.$3.push(a);return function(){c("removeFromArray")(b.$3,a)}};b.scrubEndRequest=function(a){var b=this;this.$4.push(a);return function(){c("removeFromArray")(b.$4,a)}};return a}();function n(a){var b=a.concurrentAutoplayManagementAPI,d=a.debugAPI,e=a.exitPictureInPictureImpl,f=a.fullscreenControllerRef,g=a.getCurrentExposedState,h=a.getCurrentIsDesktopPictureInPicture,i=a.getCurrentIsFullscreen,j=a.getCurrentLiveRewindPlayheadPosition,k=a.getCurrentPlayheadPosition,l=a.internal_getCurrentStateMachineState,n=a.loggerAPI,o=a.pauseImpl,p=a.playImpl,q=a.registerEmsgObserverImpl,r=a.requestPictureInPictureImpl,s=a.scrubBeginImpl,t=a.scrubEndImpl,u=a.seekImpl,v=a.selectVideoQualityImpl,w=a.selectVideoVariantImpl,x=a.setCaptionsDisplayStyleImpl,y=a.setCaptionsUrlImpl,z=a.setCaptionsVisibleImpl,A=a.setIsLiveRewindActiveImpl,B=a.setLatencyLevelImpl,C=a.setMutedImpl,D=a.setPictureInPictureStateImpl,E=a.setPlaybackRateImpl,F=a.setVolumeImpl,G=a.subscribers,H=a.unregisterEmsgObserverImpl,I=a.videoElementAPIRef,J=new Set(),K=!1,L=null,M=[],N=[],O=[],P=[],Q=new m({pauseRequestCallbacks:N,playRequestCallbacks:M,scrubBeginRequestCallbacks:O,scrubEndRequestCallbacks:P}),R={freeze:function(){if(!g().paused)throw c("unrecoverableViolation")("Video player must be paused before the controller freeze","comet_video_player");var a={};try{var b=!1;J.size===0&&(b=!0,L={exposedState:g(),isFullscreen:i(),liveRewindPlayheadPosition:j(),playheadPosition:k(),stateMachineState:l()});J.add(a);b&&(K=!0,G.forEach(function(a){a()}))}finally{K=!1}return a},isFrozen:function(){return L!=null},unfreeze:function(a){if(!J.has(a))throw c("unrecoverableViolation")("Video player controller unfreeze token not found","comet_video_player");J["delete"](a);J.size===0&&(L=null,G.forEach(function(a){a()}))}},S=babelHelpers["extends"]({},b,R,n,{debugAPI:d,exitPictureInPicture:function(){if(R.isFrozen())return;e()},getCurrentState:function(){return L!=null?L.exposedState:g()},getIsDesktopPictureInPicture:function(){return L!=null?L.isFullscreen:h()},getIsFullscreen:function(){return L!=null?L.isFullscreen:i()},getLiveRewindPlayheadPosition:function(){return L!=null?L.liveRewindPlayheadPosition:j()},getPlayheadPosition:function(){return L!=null?L.playheadPosition:k()},internal_getStateMachineState:function(){return L!=null?L.stateMachineState:l()},internal_getVideoElement:function(){var a=I.current;if(a!=null){a=a.getUnderlyingVideoElement();return a}return null},internal_getVideoPixelsDimensions:function(){var a=I.current;return(a=a==null?void 0:a.getVideoPixelsDimensions())!=null?a:null},observeOn:function(){return Q},pause:function(a){if(R.isFrozen())return;N.forEach(function(b){return b(a)});o(a)},play:function(a){if(R.isFrozen())return;M.forEach(function(b){return b(a)});p(a)},registerEmsgObserver:function(){var a={};q(a);return a},requestPictureInPicture:function(){if(R.isFrozen())return;r()},requestSetIsFullscreen:function(a){if(R.isFrozen())return;var b=f.current;if(b){var c=S.internal_getVideoElement();b.requestSetIsFullscreen(a,c)}},scrollIntoView:function(a){var b=S.internal_getVideoElement();b&&b.scrollIntoView(a)},scrubBegin:function(){if(R.isFrozen())return;O.forEach(function(a){return a()});s()},scrubEnd:function(a){if(R.isFrozen())return;P.forEach(function(b){return b(a)});t(a)},seek:function(a){if(R.isFrozen())return;u(a)},selectVideoQuality:function(a){if(R.isFrozen())return;v(a)},selectVideoVariant:function(a){if(R.isFrozen())return;w(a)},setCaptionsDisplayStyle:function(a){if(R.isFrozen())return;x(a)},setCaptionsUrl:function(a){if(R.isFrozen())return;y(a)},setCaptionsVisible:function(a){if(R.isFrozen())return;z(a)},setIsLiveRewindActive:function(a){if(R.isFrozen())return;A(a)},setLatencyLevel:function(a){if(R.isFrozen())return;B(a)},setMuted:function(a,b){if(R.isFrozen())return;C(a,b)},setPictureInPictureState:function(a){if(R.isFrozen())return;D(a)},setPlaybackRate:function(a){if(R.isFrozen())return;E(a)},setVolume:function(a){if(R.isFrozen())return;F(a)},subscribe:function(a){var b=function(){if(R.isFrozen()&&!K)return;a()},d=f.current,e=d?d.subscribe(b):null;G.push(b);return{remove:function(){e&&e.remove(),c("removeFromArray")(G,b)}}},unregisterEmsgObserver:function(a){H(a)},videoElementAPIRef:I});return S}function o(a){var b=a.concurrentAutoplayManagementAPI,c=a.createExposedState,d=a.debugAPI,e=a.fullscreenControllerRef,f=a.logger,g=a.machine,h=a.mediaLogger,i=a.subscribers,j=a.videoElementAPIRef;a={logVPLEvent_DO_NOT_USE:function(a,b){f.logVPLEvent({eventType:a,logDataOverrides:b,state:g.getCurrentState()})},setAdditionalLogData:function(a,b){f.setAdditionalLogData(a,b)},setSNAPLAdditionalLogData:function(a){h==null?void 0:h.setSNAPLAdditionalLogData(a)}};return n({concurrentAutoplayManagementAPI:b,debugAPI:d,exitPictureInPictureImpl:function(){g.dispatch({type:"controller_picture_in_picture_exit_requested"})},fullscreenControllerRef:e,getCurrentExposedState:function(){return c(g.getCurrentState())},getCurrentIsDesktopPictureInPicture:function(){var a;return(a=g.getCurrentState().controlledState.isDesktopPictureInPicture)!=null?a:!1},getCurrentIsFullscreen:function(){var a=e.current;return a?a.getIsFullscreen():!1},getCurrentLiveRewindPlayheadPosition:function(){var a=g.getCurrentState();a=a.controlledState;var b=a.isLiveRewindActive,c=a.seekableRanges;a=a.seekTargetPosition;if(!b||a==null)return null;c=(b=c==null?void 0:c.end(0))!=null?b:0;return a-c},getCurrentPlayheadPosition:function(){var a,b=0;return(a=(a=(a=j.current)==null?void 0:a.getPlayheadPosition())!=null?a:g.getCurrentState().uncontrolledState.videoElementPlayheadPosition)!=null?a:b},internal_getCurrentStateMachineState:function(){return g.getCurrentState()},loggerAPI:a,pauseImpl:function(a){g.dispatch({payload:{reason:a},type:"controller_pause_requested"})},playImpl:function(a){g.dispatch({payload:{reason:a},type:"controller_play_requested"})},registerEmsgObserverImpl:function(a){g.dispatch({payload:{token:a},type:"register_emsg_observer"})},requestPictureInPictureImpl:function(){g.dispatch({type:"controller_picture_in_picture_requested"})},scrubBeginImpl:function(){g.dispatch({type:"controller_scrub_begin_requested"})},scrubEndImpl:function(a){g.dispatch({payload:{seekTargetPosition:a},type:"controller_scrub_end_requested"})},seekImpl:function(a){g.dispatch({payload:{seekTargetPosition:a},type:"controller_seek_requested"})},selectVideoQualityImpl:function(a){g.dispatch({payload:{selectedVideoQuality:a},type:"controller_quality_requested"})},selectVideoVariantImpl:function(a){g.dispatch({payload:{selectedVideoVariant:a},type:"controller_video_variant_requested"})},setCaptionsDisplayStyleImpl:function(a){g.dispatch({payload:{captionDisplayStyle:a},type:"controller_set_caption_display_style_requested"})},setCaptionsUrlImpl:function(a){g.dispatch({payload:{captionsUrl:a},type:"controller_set_captions_url_requested"})},setCaptionsVisibleImpl:function(a){g.dispatch({payload:{captionsVisible:a},type:"controller_set_captions_visible_requested"})},setIsLiveRewindActiveImpl:function(a){g.dispatch({payload:{isLiveRewindActive:a},type:"controller_set_is_live_rewind_active_requested"})},setLatencyLevelImpl:function(a){g.dispatch({payload:{latencyLevel:a},type:"controller_set_latency_level_requested"})},setMutedImpl:function(a,b){g.dispatch({payload:{muted:a,reason:b},type:"controller_muted_requested"})},setPictureInPictureStateImpl:function(a){g.dispatch({payload:{isInPictureInPictureMode:a},type:"controller_set_picture_in_picture_state_requested"})},setPlaybackRateImpl:function(a){g.dispatch({payload:{playbackRate:a},type:"controller_set_playback_rate"})},setVolumeImpl:function(a){g.dispatch({payload:{volume:a},type:"controller_volume_requested"})},subscribers:i,unregisterEmsgObserverImpl:function(a){g.dispatch({payload:{token:a},type:"unregister_emsg_observer"})},videoElementAPIRef:j})}function p(a){a=a.current;if(a==null)throw c("unrecoverableViolation")("Attempted to access VideoElementAPI while it is not available.","comet_video_player");return a}function q(a){var b=a.alwaysShowCaptions,e=a.areCaptionsAutogenerated,f=a.captionDisplayStyle,g=a.captionsControllerRef,h=a.debugLogId,i=a.dimensions,j=a.engineExtrasAPI,k=a.engineMetadata,l=a.fullscreenControllerRef,m=a.handleFatalError,n=a.handleStateMachine,o=a.videoElementAPIRef,q=a.videoLiveTraceRef,s=a.videoPlayerPassiveViewabilityInfoRef;function t(a){d("VideoPlayerImplementationStateMachineHostCallQueue").applyOrQueueHostCall({engineExtrasAPI:j,hostCall:a,machine:v,videoElementAPI:o.current})}var u=null;a=[function(a,b,d){d.type==="implementation_host_call_applied"&&d.payload.hostCall.type==="host_call_play"&&b.controlledState.lastPlayReason==="autoplay_initiated"?c("CometVisualCompletion").addFirstMarkerPoint("firstVideoAutoplayStalling"):b.controlledState.playbackState!==a.controlledState.playbackState&&b.controlledState.playbackState==="playing"&&b.controlledState.lastPlayReason==="autoplay_initiated"&&c("CometVisualCompletion").addFirstMarkerPoint("firstVideoAutoplayPlaying");return!0},function(a,b,c){n(a,b,c);return!0},function(a,b,c){return!0},function(a,b,c){if(a.controlledState.bufferingDetected===!1&&b.controlledState.bufferingDetected===!0||a.controlledState.bufferingDetected===!0&&b.controlledState.bufferingDetected===!1)if(b.controlledState.bufferingDetected){a=(c=b.controlledState.lastBufferingType)!=null?c:"in_play";c=j.getPerfLoggerProvider();u=c?c.getOperationLogger("buffering").setState("buffering").setType(a).start():null}else!b.controlledState.bufferingDetected&&u!=null&&(u.log(),u=null);return!0},function(a,b,c){return c.type!=="implementation_engine_destroy_requested"?!0:!1},function(a,b,c){if(c.type!=="implementation_engine_initialized")return!0;a=p(o);c=c.type;d("VideoPlayerImplementationStateMachineHostCallQueue").flushHostCallQueue({engineExtrasAPI:j,machine:v,reason:c,state:b,videoElementAPI:a});return!1},function(a,b,c){if(c.type!=="dom_event_ended")return!0;a=b.controlledState;(a.loopCount>0&&a.loopCurrent<a.loopCount||a.loopCount===-1)&&v.dispatch({payload:{reason:"loop_initiated"},type:"controller_play_requested"});return!1},function(a,b,c){if(c.type!=="controller_pause_requested")return!0;a=b.controlledState.playbackState;if(a!=="paused")return!1;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type},type:"host_call_pause"});return!1},function(a,b,c){if(c.type!=="controller_play_requested")return!0;a=b.controlledState.playbackState;if(a!=="stalling")return!1;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type},type:"host_call_play"});return!1},function(a,b,c){if(c.type!=="controller_seek_requested")return!0;a=b.controlledState;b=a.seeking;a=a.seekTargetPosition;b&&a!=null&&t({payload:{currentTime:a,hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type},type:"host_call_set_current_time"});return!1},function(a,b,c){if(c.type!=="controller_muted_requested")return!0;a=b.controlledState.muted;if(a!==c.payload.muted)return!1;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),muted:a,reason:c.type},type:"host_call_set_muted"});return!1},function(a,b,c){if(c.type!=="controller_scrub_begin_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:0,reason:c.type},type:"host_call_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="controller_scrub_end_requested")return!0;a=b.controlledState;b=a.seeking;var e=a.seekTargetPosition;a=a.targetPlaybackRate;b&&e!=null?(t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:a,reason:c.type+":seek"},type:"host_call_set_playback_rate"}),t({payload:{currentTime:e,hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type+":seek"},type:"host_call_set_current_time"})):t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:a,reason:c.type+":cancel"},type:"host_call_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="buffering_begin_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:0,reason:c.type},type:"host_call_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="controller_set_playback_rate")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:c.payload.playbackRate,reason:c.type},type:"host_call_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="buffering_end_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:b.controlledState.targetPlaybackRate,reason:c.type},type:"host_call_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="controller_volume_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type,volume:b.controlledState.volume},type:"host_call_set_volume"});return!1},function(a,b,c){if(c.type!=="controller_video_variant_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type,selectedVideoVariant:b.controlledState.selectedVideoVariant},type:"host_call_set_video_variant"});return!1},function(a,b,c){if(c.type!=="controller_quality_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type,selectedVideoQuality:b.controlledState.selectedVideoQuality},type:"host_call_set_video_quality"});return!1},function(a,b,c){if(!(c.type==="controller_set_latency_level_requested"||c.type==="implementation_set_latency_level_requested"))return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),latencyLevel:c.payload.latencyLevel,reason:c.type},type:"host_call_set_latency_level"});return!1},function(a,b,c){if(!(c.type==="dom_event_timeupdate"||c.type==="captions_loaded"))return!0;c=g.current;var e=b.controlledState.captionsVisible,f=o.current;f=f?f.getPlayheadPosition():0;if(d("PlaybackSpeedExperiments").enableCometPlaybackSpeedControl()&&b.controlledState.isLiveRewindActive){var h=b.controlledState.seekableRanges;h=h!=null?(h=h.end(h.length()-1))!=null?h:0:0;f>=h&&v.dispatch({payload:{isLiveRewindActive:!1},type:"controller_set_is_live_rewind_active_requested"})}if(!j.getRepresentationCaptionsExpectedFromManifest()&&c&&e&&b.controlledState.captionsLoaded){h=c.handleTimeUpdate(f);e=c.getCaptionFormat();b=a.controlledState.activeCaptions;c=a.controlledState.captionFormat;e!==c&&v.dispatch({payload:{captionFormat:e},type:"controller_set_caption_format_requested"});r(b,h)&&v.dispatch({payload:{activeCaptions:h,captionsLocale:null},type:"controller_set_active_captions_requested"})}a=q.current;a!=null&&a.onUpdateStatus({position:f});return!1},function(a,b,c){if(c.type!=="cea608_bytes_received")return!0;a=g.current;if(a){b=c.payload;c=b.timescale;b=b.videoBytes;a.handleCea608BytesReceived({timescale:c,videoBytes:b})}return!1},function(a,b,c){if(c.type!=="controller_set_captions_url_requested")return!0;a=g.current;if(a){b=c.payload.captionsUrl;a.updateCaptionsUrl(b)}return!1},function(a,b,c){if(c.type!=="controller_set_is_live_rewind_active_requested")return!0;j.setEnableLiveheadCatchup(!c.payload.isLiveRewindActive);!!d("PlaybackSpeedExperiments").enableCometPlaybackSpeedControl()&&!c.payload.isLiveRewindActive&&v.dispatch({payload:{playbackRate:1},type:"controller_set_playback_rate"});return!1},function(a,b,c){if(c.type!=="controller_picture_in_picture_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type},type:"host_call_picture_in_picture"});return!1},function(a,b,c){if(c.type!=="controller_picture_in_picture_exit_requested")return!0;t({payload:{hostCallID:d("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:c.type},type:"host_call_exit_picture_in_picture"});return!1}];var v=d("VideoPlayerImplementationStateMachine").createVideoPlayerImplementationStateMachineWithStateTransitionHandlers({collectUncontrolledState:function(){var a=o.current;return d("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:j,fullscreenControllerRef:l,videoElementAPI:a,videoLiveTraceRef:q,videoPlayerPassiveViewabilityInfoRef:s})},debugLogId:h,initialState:d("VideoPlayerImplementationStateMachineState").createVideoPlayerImplementationStateMachineInitialState({alwaysShowCaptions:b,areCaptionsAutogenerated:e,captionDisplayStyle:f,dimensions:i,isAbrEnabled:k.isAbrEnabled,playerVersion:k.playerVersion,streamingFormat:k.streamingFormat}),onFatalError:m,stateTransitionHandlers:a});return v}function r(a,b){if(a===null&&b===null)return!1;if(a===null||b===null)return!0;var c=(b=b.rows)!=null?b:[];a=(b=a.rows)!=null?b:[];return a.length!==c.length||a.some(function(a,b){return a!==c[b]})}function s(a,b,c,d){a!==b.current&&(c.current&&(c.current.remove(),c.current=null),b.current=a),b.current&&!c.current&&(c.current=b.current.subscribe(function(){d.dispatch({type:"notify_fullscreen_changed"})}))}function t(a,b,c,d){a!==b.current&&(c.current&&(c.current.remove(),c.current=null),b.current=a),b.current&&!c.current&&(c.current=b.current.subscribe(function(){d.dispatch({type:"notify_viewability_changed"})}))}function u(a){var b=a.engineMetadata;a=a.state;var c=a.controlledState,d=c.activeCaptions,e=c.activeEmsgBoxes,f=c.captionDisplayStyle,g=c.captionsLoaded,h=c.captionsVisible,i=c.domEventsLatestPerfMs,j=c.error,k=c.hasPlayEverBeenRequested,l=c.implementationSeekSourcePosition,m=c.inbandCaptionsAutogenerated,n=c.isDesktopPictureInPicture,o=c.isLiveRewindActive,p=c.lastMuteReason,q=c.lastPauseReason,r=c.lastPlayedTimeMs,s=c.lastPlayReason,t=c.latencyLevel,u=c.loopCount,v=c.loopCurrent,w=c.muted,x=c.playbackState,y=c.seekableRanges,z=c.seeking,A=c.seekTargetPosition,B=c.selectedVideoQuality,C=c.streamingFormat,D=c.streamInterrupted,E=c.targetPlaybackRate,F=c.ullIneligibilityReason,G=c.volume;c=c.watchTimeMs;var H=a.uncontrolledState,I=H.availableAudioTracks,J=H.availableQualities,K=H.availableVideoTracks,L=H.currentPlayingAudioTrackID,M=H.currentPlayingVideoQuality,N=H.isDRM,O=H.isFullscreen,P=H.isLiveRewindAvailable,Q=H.targetAudioTrack,R=H.targetVideoQuality,S=H.videoElementDuration,T=H.videoElementLastBufferEndPosition,U=H.videoProjection;H=H.videoRepresentationID;var V=x==="ended",W=x==="paused"||V,X=x==="playing",Y=x==="inPlayStalling";x=x==="stalling"||Y;g={activeCaptions:d,activeEmsgBoxes:e,availableAudioTracks:I,availableVideoQualities:J,availableVideoTracks:K,bufferEnd:(d=T)!=null?d:0,captionDisplayStyle:f,captionsLoaded:g,captionsVisible:h,currentAudioTrackID:(e=L)!=null?e:null,currentVideoQuality:(I=M)!=null?I:"",domEventsLatestPerfMs:i,duration:(J=S)!=null?J:0,ended:V,error:j,hasPlayEverBeenRequested:k,inbandCaptionsAutogenerated:m,inPlayStalling:Y,isAbrEnabled:b.isAbrEnabled,isDesktopPictureInPicture:(K=n)!=null?K:!1,isDRM:(T=N)!=null?T:null,isFullscreen:(d=O)!=null?d:!1,isLiveRewindActive:o,isLiveRewindAvailable:(f=P)!=null?f:!1,lastMuteReason:p,lastPauseReason:q,lastPlayedTimeMs:r,lastPlayReason:s,latencyLevel:t,loopCount:u,loopCurrent:v,muted:w,paused:W,playerVersion:a.playerVersion,playing:X,seekableRanges:y,seeking:z,seekSourcePosition:l,seekTargetPosition:A,selectedVideoQuality:B,stalling:x,streamingFormat:C,streamInterrupted:D,targetAudioTrack:Q,targetPlaybackRate:E,targetVideoQuality:R,ullIneligibilityReason:F,videoProjection:U,videoRepresentationID:H,volume:G,watchTimeMs:c};return g}function a(a){var e=a.checkInDOM,f=a.createDebugAPI,g=a.createVideoPlayerError,h=a.debugLog,i=a.debugLogId,j=a.destroyEngineParts,k=a.engineExtrasAPI,l=a.engineMetadata,m=a.handleFatalError,n=a.handleVideoElementChanged,p=a.handleVideoInfoChange,r=a.initialProps,v=a.setExposedStateInReact,w=r.loggingMetaData.instanceKey;h=r.loggingMetaData.coreVideoPlayerMetaData;a=h.broadcastId;var x=h.isLiveStreaming;h=h.isLiveTraceEnabled;var y={current:Boolean(x)&&Boolean(h)&&a!=null?new(c("VideoLiveTrace"))(a,w,c("CurrentUser").getAccountID()):null},z=d("VideoPlayerImplementationStateMachineLogger").createVideoPlayerImplementationStateMachineLogger({debugLogId:i,initialLoggingMetaData:r.loggingMetaData,videoLiveTraceRef:y}),A=new(c("VideoPlayerBanzaiLogFlusher"))(z),B=r.enableSNAPL?d("MediaPlaybackCompoundEventStateMachineLogger").createMediaPlaybackCompoundEventStateMachineLogger({debugLogId:i,initialLoggingMetaData:r.loggingMetaData,metadataProvider:r.createSNAPLMetadataProvider==null?void 0:r.createSNAPLMetadataProvider()}):null,C=B!=null?new(c("MediaPlaybackLogFlusher"))(B):null,D={current:(x=r.videoPlayerPassiveViewabilityInfo)!=null?x:null},E={current:(h=r.fullscreenController)!=null?h:null},F={current:null};a=d("useConcurrentAutoplayManagementAPI").createConcurrentAutoplayManagementAPI();var G=[],H=function(){G.forEach(function(a){a()}),r.disableLogging||r.disableVPLLogging?A.discardLogsWithoutFlushing():A.flushLogs(),!r.enableSNAPL||r.disableLogging?C==null?void 0:C.discardLogsWithoutFlushing():C==null?void 0:C.flushLogs()},I={current:r.onExposedStateChanged},J={current:null},K=null,L={current:{inbandCaptionsAutogeneratedFromManifest:!1,inbandCaptionsExpectedFromManifest:!1,inbandCaptionsExpectedFromProps:r.inbandCaptionsExpected,representationCaptionsExpectedFromManifest:!1,sideLoadCaptionsExpectedFromProps:r.sideLoadCaptionsExpected,sideLoadCaptionsUrlFromProps:(x=r.sideLoadCaptionsUrl)!=null?x:null}},M={current:null},N={current:null},O=new(c("SubscriptionsHandler"))(),P=new(c("SubscriptionsHandler"))(),Q="before_mounted";function R(a){if(c("gkx")("24349"))return a.controlledState.mountState==="mounted_onscreen"||a.controlledState.mountState==="mounted_offscreen";else return Q==="mounted"}var S={current:null},T=function(a){a=u({engineMetadata:l,state:a});return a},U={current:null},V={current:null},W=function(a){if(R(a)){if(a===U.current)return;var b=T(a);if(V.current!=null&&c("deepEquals")(V.current,b))return;U.current=a;V.current=b;v(b);a=I.current;a&&a({implementationController:ma,implementationExposedState:b})}};h=function(a,b,c){z.handleStateMachine(a,b,c),B==null?void 0:B.handleStateMachine(a,b,c),W(b),H()};var X=function(a,b){};x=function(a){X(a,"state_machine_fatal_error")};var Y=q({alwaysShowCaptions:Boolean(r.alwaysShowCaptions),areCaptionsAutogenerated:Boolean(r.areCaptionsAutogenerated),captionDisplayStyle:r.captionDisplayStyle,captionsControllerRef:F,debugLogId:i,dimensions:r.dimensions,engineExtrasAPI:k,engineMetadata:l,fullscreenControllerRef:E,handleFatalError:x,handleStateMachine:h,videoElementAPIRef:S,videoLiveTraceRef:y,videoPlayerPassiveViewabilityInfoRef:D}),aa=!1,Z=function(a){var b=J.current!=null,d=S.current!=null;O.release();Y.dispatch({payload:{reason:a,videoElementAPIExisted:d,videoElementExisted:b},type:"implementation_engine_destroy_requested"});try{aa||(aa=!0,j(["destroyEngine("+a+")"]))}catch(g){try{var e=c("FBLogger")("comet_video_player").catching(g),f=r.videoFBID;f!=null&&(e=e.addMetadata("COMET_VIDEO","VIDEO_ID",f));e=e.addMetadata("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({destroy_reason:a,player_instance_key:w,player_version:l.playerVersion,video_element_api_existed:d,video_element_existed:b}));e.warn("Error thrown by destroyEngineParts: %s",g.message)}catch(a){}}f=F.current;f!=null&&(Y.getCurrentState().controlledState.captionsLoaded&&Y.dispatch({type:"captions_unloaded"}),F.current=null,f.destroy());s(null,E,M,Y);t(null,D,N,Y);Y.dispatch({payload:{reason:a,videoElementAPIExisted:d,videoElementExisted:b},type:"implementation_engine_destroyed"});b&&c("gkx")("5923")&&ia(null,["destroy",a])};X=function(a,b){a=g(a,b);Y.dispatch({payload:{fatalError:a},type:"implementation_fatal_error"});Z("implementation_fatal_error");m(a)};function ba(a){return a.sideLoadCaptionsExpectedFromProps||a.sideLoadCaptionsUrlFromProps!=null}function ca(a){return a.inbandCaptionsExpectedFromProps&&((a=a.inbandCaptionsExpectedFromManifest)!=null?a:!1)}function da(a){return(a=a.inbandCaptionsAutogeneratedFromManifest)!=null?a:!1}var ea=function(a){var b=ba(a),c=ca(a),e=da(a),f=F.current;e!==da(L.current)&&Y.dispatch({payload:{inbandCaptionsAutogenerated:e},type:"inband_captions_autogenerated_changed"});f!=null?c!==ca(L.current)&&(f.updateInbandCaptionsExpected(c),!c&&Y.getCurrentState().controlledState.captionsLoaded&&Y.dispatch({type:"captions_unloaded"})):(b||c)&&f==null&&(F.current=d("VideoPlayerCaptionsController").createCaptionsController({captionsUrl:b?a.sideLoadCaptionsUrlFromProps:null,inbandCaptionsExpected:c,onCaptionsLoaded:function(){Y.dispatch({type:"captions_loaded"})}}));L.current=a},fa=function(a){k!=null&&a&&a.width>0&&a.height>0&&(k.setDimensions(a),Y.dispatch({payload:{dimensions:{height:a.height,width:a.width}},type:"player_dimensions_changed"}))},ga=function(a){a!==Y.getCurrentState().controlledState.loopCount&&Y.dispatch({payload:{loopCount:a},type:"loop_count_change_requested"})},ha=function(a){"srcObject"in a&&(a.srcObject=null),a.removeAttribute("src"),P.release(),P.engage()},ia=function(a,e){if(J.current===a)return;a!=null&&J.current!=null&&J.current!==a&&c("recoverableViolation")("The video element was recreated","comet_video_player");K!=null&&K();var f=J.current;f&&ha(f);J.current=a;b("cr:506")!=null&&a!=null&&(K=b("cr:506")(a,i));a!=null?(P.addSubscriptions(c("CometEventListener").listen(a,"enterpictureinpicture",function(){var a=d("CometVideoPictureInPictureManagerContext").isInPictureInPictureExp();a&&Y.dispatch({payload:{isInPictureInPictureMode:!0},type:"controller_set_picture_in_picture_state_requested"})}),c("CometEventListener").listen(a,"leavepictureinpicture",function(){var a=d("CometVideoPictureInPictureManagerContext").isInPictureInPictureExp();a&&Y.dispatch({payload:{isInPictureInPictureMode:!1},type:"controller_set_picture_in_picture_state_requested"})})),Y.dispatch({type:"implementation_video_node_mounted"}),n(a,[].concat(e,["handleVideoElement(non-null)"]))):(Y.dispatch({type:"implementation_video_node_unmounted"}),n(null,[].concat(e,["handleVideoElement(null)"])))};x=r.loggingMetaData.instanceKey;h=function(a){var b;I.current=a.onExposedStateChanged;if(!R(Y.getCurrentState()))return;s((b=a.fullscreenController)!=null?b:null,E,M,Y);t((b=a.videoPlayerPassiveViewabilityInfo)!=null?b:null,D,N,Y);if(!p(a)){b={inbandCaptionsAutogeneratedFromManifest:L.current.inbandCaptionsAutogeneratedFromManifest,inbandCaptionsExpectedFromManifest:L.current.inbandCaptionsExpectedFromManifest,inbandCaptionsExpectedFromProps:a.inbandCaptionsExpected,representationCaptionsExpectedFromManifest:L.current.representationCaptionsExpectedFromManifest,sideLoadCaptionsExpectedFromProps:a.sideLoadCaptionsExpected,sideLoadCaptionsUrlFromProps:(b=a.sideLoadCaptionsUrl)!=null?b:null};ea(b);fa(a.dimensions);ga((b=a.loopCount)!=null?b:0)}Y.dispatch({payload:{loggingMetaData:a.loggingMetaData},type:"notify_logging_metadata_change"})};var $=null;x=function(){var a=Y.getCurrentState().controlledState.mountState;switch(a){case"before_mounted":O.addSubscriptions(d("RunComet").onUnload(function(){Z("page_unload")}));Y.dispatch({type:"implementation_mounted"});n(J.current,["handleReactEffectInit(before_mounted)"]);break;case"mounted_onscreen":break;case"mounted_offscreen":c("clearTimeout")($);$=null;Y.dispatch({type:"implementation_onscreen"});break;case"unmounted":break;default:a}};var ja=function(){var a=function a(){c("clearTimeout")($);$=null;if(Y.getCurrentState().controlledState.mountState==="unmounted")return;var b=e();!b?(Y.dispatch({payload:{reason:"react_effect_cleanup"},type:"implementation_unmounted"}),Z("implementation_unmounted:react_effect_cleanup")):$=c("setTimeout")(a,1e3)},b=Y.getCurrentState().controlledState.mountState;switch(b){case"before_mounted":break;case"mounted_onscreen":Y.dispatch({type:"implementation_offscreen"});a();break;case"mounted_offscreen":a();break;case"unmounted":break}},ka=function(){R(Y.getCurrentState())||(Q="mounted",O.addSubscriptions(d("RunComet").onUnload(function(){Z("page_unload")})),Y.dispatch({type:"implementation_mounted"}),n(J.current,["handleReactMount"]))},la=function(){R(Y.getCurrentState())&&(Q="unmounted",Y.dispatch({payload:{reason:"react_effect_cleanup"},type:"implementation_unmounted"}),Z("implementation_unmounted:react_effect_cleanup"))},ma=o({concurrentAutoplayManagementAPI:a,createExposedState:T,debugAPI:f({getVideoElementAPI:function(){return S.current},logger:z}),fullscreenControllerRef:E,logger:z,machine:Y,mediaLogger:B,subscribers:G,videoElementAPIRef:S});a=d("VideoPlayerImplementationStateMachine").createReactVideoElementCallbacksForStateMachine(Y,ia);f=T(Y.getInitialState());ja={handleReactEffectCleanup:c("gkx")("24349")?ja:la,handleReactEffectInit:c("gkx")("24349")?x:ka,handleReactPropsChanged:h,implementationController:ma,initialExposedState:f,logFlusher:A,machine:Y,notifySubscribers:H,videoElementCallbacks:a,videoElementRefCallback:function(a){if(a==null&&c("gkx")("5923"))return;ia(a,["videoElementRefCallback"])}};return{engine:ja,getCaptionsInfo:function(){return L.current},getVideoElement:function(){return J.current},getVideoLiveTrace:function(){return y.current},handleCaptionsInfoChange:ea,handleFatalImplementationError:X,logger:z,machine:Y,videoElementAPIRef:S}}function v(a,b){var d,e=c("err").apply(void 0,[a.errorName+": "+a.errorMessageFormat].concat(a.errorMessageParams));e.name=a.errorName;e.errorName=a.errorName;e.type="error";a.stack!=null&&a.stack!==""&&(e.stack=a.stack);var f=new(c("ErrorMetadata"))();f.addEntries(["COMET_VIDEO","ERROR_LOCATION",a.errorLocation],["COMET_VIDEO","ERROR_CODE",(d=a.errorCode)!=null?d:""],["COMET_VIDEO","ERROR_URL",(d=a.url)!=null?d:""]);b!=null&&f.addEntry("COMET_VIDEO","VIDEO_ID",b);d=a.originalError;d!=null&&(typeof d==="string"?f.addEntry("COMET_VIDEO","ORIGINAL_ERROR",d):d instanceof Error&&d.message!=null&&f.addEntry("COMET_VIDEO","ORIGINAL_ERROR",d.message));e.metadata=f;return e}function e(a,d){var e=l(null),f=e[0],g=e[1];e=l(null);var h=e[0],m=e[1];e=a.wrapVideoPixels_EXPERIMENTAL;var n=k(a),o=k(d),p=k(null),q=c("useStable")(function(){return o.current({checkInDOM:function(){var a=document.body,b=p.current;return a!=null&&b!=null&&a.contains(b)},debugLogId:String(n.current.loggingMetaData.instanceKey),handleFatalError:function(a){m(a)},initialProps:n.current,setExposedStateInReact:g})});f=(d=f)!=null?d:q.initialExposedState;d=(d=f.error)!=null?d:h;if(d!=null){h=a.VideoPlayerShakaPerformanceLoggerClass;h&&(c("gkx")("24350")||c("qex")._("1655"))&&h.flushQueuedLogs();throw v(d,n.current.videoFBID)}j(function(){q.handleReactEffectInit();return function(){q.handleReactEffectCleanup()}},[q]);var r=k(null);j(function(){a!==r.current&&q.handleReactPropsChanged(a),r.current=a});h=c("useSEOLoggedOutWebCrawler")();d=a.renderVideoPixelsFit?a.renderVideoPixelsFit(f):null;h=i.jsx(c("VideoPlayerImplementationReactVideoElement.react"),{alt:a.alt,poster:a.poster,seoWebCrawlerVideoTracks:h&&a.seoWebCrawlerVideoTracks!=null?a.seoWebCrawlerVideoTracks:null,src:h?a.seoWebCrawlerLookasideUrl:null,videoElementCallbacks:h?null:q.videoElementCallbacks,videoElementPreloadDisabled:a.preloadForProgressiveDisabled,videoElementRefCallback:h?null:q.videoElementRefCallback,videoPixelsFit:d});var s=a.renderWithExposedState({implementationController:q.implementationController,implementationExposedState:f});e=i.jsxs(i.Fragment,{children:[c("gkx")("24349")?i.jsx("div",{ref:p,style:{display:"none"}}):null,f.isDRM===!0?b("cr:2336")?i.jsx(b("cr:2336"),{controller:q.implementationController}):b("cr:4596")?i.jsx(b("cr:4596"),{controller:q.implementationController}):null:null,e?e(h):h,b("cr:355")!=null&&f.playerVersion==="comet_nextgendash"?i.jsx(b("cr:355"),{}):null,i.jsx(c("VideoPlayerVideoPixelsFitContext").Provider,{value:d,children:s})]});return{engine:q,exposedState:f,reactVideoComponents:s,reactVideoFrame:h,reactVideoFrameAndComponents:e}}g.internal_createVideoPlayerImplementationControllerImpl=n;g.internal_createVideoPlayerImplementationEngineStateMachineWithEffects=q;g.internal_createVideoPlayerImplementationExposedStateFromStateMachineState=u;g.createVideoPlayerImplementationEngine=a;g.internal_makeExpandedErrorFromVideoPlayerError=v;g.useVideoPlayerImplementationEngine=e}),98);
__d("VideoPlayerImplementationEngineVideoElementAPI",["Promise","VideoPlaybackQuality","VideoPlayerOzWWWGlobalConfig"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return isNaN(a)?0:a}function j(a){return i(a.duration)}function k(a){var b=[];try{a=a.buffered;for(var c=0;c<a.length;++c)b.push({endTime:a.end(c),startTime:a.start(c)})}catch(a){}return b}function l(a){try{a=a.buffered;if(a.length>0)return a.end(a.length-1)}catch(a){}return 0}function m(a){return i(a.currentTime)}function n(a){try{a=a.buffered;if(a.length>0)return a.start(0)}catch(a){}return 0}function a(a){return{exitPictureInPicture:function(){window.document.exitPictureInPicture()},getBufferedRanges:function(){return k(a)},getCanPlayPromise:function(){return new(h||(h=b("Promise")))(function(b,c){a.readyState===4?b():a.addEventListener("canplay",function(){return b()})})},getDOMLoadedMetadataPromise:function(){return new(h||(h=b("Promise")))(function(b,c){a.addEventListener("loadedmetadata",function(){return b()})})},getDroppedFrameCount:function(){return d("VideoPlaybackQuality").getDroppedFrames(a)},getDuration:function(){return j(a)},getEnded:function(){return a.ended},getError:function(){return a.error},getLastBufferEndPosition:function(){return l(a)},getMuted:function(){return a.muted},getNetworkState:function(){return a.networkState},getPaused:function(){return a.paused},getPlaybackRate:function(){return a.playbackRate},getPlayheadPosition:function(){return m(a)},getReadyState:function(){return a.readyState},getTotalFrameCount:function(){return d("VideoPlaybackQuality").getTotalFrames(a)},getUnderlyingVideoElement:function(){return a},getVideoPixelsDimensions:function(){if(a.readyState<a.HAVE_CURRENT_DATA)return null;var b=a.videoWidth,c=a.videoHeight;if(b<=0||c<=0)return null;var d=a.offsetWidth,e=a.offsetHeight;if(d<=0||e<=0)return null;b=b/c;c=d/e;c>b?d=e*b:e=d/b;return{height:e,width:d}},getVolume:function(){return a.volume},pause:function(){a.pause()},play:function(){var c=a.play();c=c&&typeof c.then==="function"?(h||(h=b("Promise"))).resolve(c):null;return c},requestPictureInPicture:function(){typeof a.requestPictureInPicture==="function"&&a.requestPictureInPicture()},setDuration:function(b){a.duration=b},setMuted:function(b){a.muted=b},setPlaybackRate:function(b){a.playbackRate=b},setPlayheadPosition:function(b){var d=b;if(b===0){b=c("VideoPlayerOzWWWGlobalConfig").getNumber("clamp_seek_to_first_buffer_range_epsilon",0);if(b>0){var e=n(a);e>0&&e<=b&&(d=e)}}a.currentTime=d},setVolume:function(b){a.volume=b}}}g.getDurationFromVideoElement=j;g.getBufferedRangesFromVideoElement=k;g.getLastBufferEndPositionFromVideoElement=l;g.getPlayheadPositionFromVideoElement=m;g.createVideoPlayerImplementationEngineVideoElementAPI=a}),98);
__d("VideoPlayerImplementationLoadSequenceManager",["setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=[]}var b=a.prototype;b.schedule=function(a,b,d){var e=this,f={load:d,maximumBlockTimeMs:a.getNumber("load_sequence_max_delay_ms",0),sequence:b},g=a.getNumber("load_sequence_only_prioritize_first_count",0);g>0?d=!this.$2.find(function(a){return a.sequence<g}):d=!this.$2.find(function(a){return a.sequence<b});d?this.$3(f):(this.$1.push(f),c("setTimeout")(function(){return e.$4(f)},f.maximumBlockTimeMs));return function(){return e.$5(f)}};b.$4=function(a){var b=this.$1.find(function(b){return b===a});b&&(this.$1=this.$1.filter(function(b){return b!==a}),this.$3(b))};b.$3=function(a){var b=this;this.$2.push(a);a.load().then(function(){return b.$6(a)})["catch"](function(c){b.$6(a);throw c});c("setTimeout")(function(){return b.$6(a)},a.maximumBlockTimeMs)};b.$7=function(){var a=this,b=Math.min.apply(Math,this.$1.map(function(a){return a.sequence})),c=this.$1.filter(function(a){return a.sequence===b});c.forEach(function(b){return a.$4(b)})};b.$5=function(a){this.$1=this.$1.filter(function(b){return b!==a})};b.$6=function(a){if(!this.$2.find(function(b){return b===a}))return;this.$2=this.$2.filter(function(b){return b!==a});var b=!!this.$2.find(function(b){return b.sequence===a.sequence});b&&this.$7()};return a}();b=new a();d=b;g["default"]=d}),98);
__d("getAvailableMimeCodecsFromDashManifest",[],(function(a,b,c,d,e,f){"use strict";function g(a){var b=/^(audio|video)\/.*$/;return b.test(a)}function a(a){var b=[],c=window.MediaSource;if(a!=null){var d=/mimeType=\"([^\"]*)\"[^\>]*codecs=\"([^\"]*)\"/g,e=/codecs=\"([^\"]*)\"[^\>]*mimeType=\"([^\"]*)\"/g,f,h=[];while(f=d.exec(a))h.push([f[1],f[2]]);while(f=e.exec(a))h.push([f[2],f[1]]);for(d=0;d<h.length;d++){f=h[d];a=f[0];e=f[1];f=a+'; codecs="'+e+'"';var i=a.startsWith("audio")?"audio":a.startsWith("video")?"video":"other",j=!0,k=!1;g(f)&&(k=!0,j=c?c.isTypeSupported(f):!1);b.push({codecs:e,isRequiredForPlayback:k,isTypeSupported:j,mimeCodec:f,mimeType:a,representationType:i})}}return b}f["default"]=a}),66);
__d("VideoPlayerOzImplementationData",["err","getAvailableMimeCodecsFromDashManifest"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.canUseOz,d=a.dashManifestUrl,e=a.dashManifestUrlOverride_DO_NOT_USE,f=a.dashManifestXmlString,g=a.experimentationConfig,h=a.initialAudioUserPreferredLanguage;a=a.minQualityPreference;if(b!==!0){b=c("err")("The DASH player is not available for this video");b.name="VideoImplementationsDashPlayerUnavailable";return b}b=e!=null?null:f==null||f===""?null:f;f=e!=null?e:d==null||d===""?null:d;if(b==null&&f==null){e=c("err")("video has no manifest and no manifest URL");e.name="VideoImplementationsNoManifestOrURL";return e}if(!window.MediaSource){d=c("err")("MediaSource is unsupported");d.name="VideoImplementationsMediaSourceUnsupported";return d}if(b!=null){e=c("getAvailableMimeCodecsFromDashManifest")(b).filter(function(a){return a.isRequiredForPlayback});d=e.filter(function(a){return!a.isTypeSupported});if(d.length>0){d=c("err")("%s out of %s codecs in DASH manifest required for playback are unsupported: %s",String(d.length),String(e.length),e.map(function(a){return a.mimeType+"/"+a.codecs+"="+(a.isTypeSupported?"yes":"no")}).join(", "));d.name="VideoImplementationsDashManifestUnsupportedCodecs";return d}}return{experimentationConfig:g,initialAudioUserPreferredLanguage:(e=h)!=null?e:null,initialVideoVariant:{lang:(d=h)!=null?d:null,role:null},manifest:b,manifestUrl:f,minQualityPreference:(g=a)!=null?g:null,seoWebCrawlerLookasideUrl:f}}g.makeOzImplementationData=a}),98);
__d("handleVideoPlayerLatencyLevelChange",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){if(a&&b&&c){var e=a.getAllContexts().latency_level;c=[];try{c=JSON.parse(a.getString("seek_on_latency_level_change_allowed","[]"))}catch(a){}c=c.some(function(a){return a.length===2&&a[0]===e&&a[1]===d});a.setContext("latency_level",d);if(!c)return;c=b.getDuration();c=c!=null?c+a.getNumber("live_initial_playback_position",0):null;c!=null&&b.setPlayheadPosition(c)}}f["default"]=a}),66);
__d("VideoPlayerOzImplementationEngineExtrasAPI",["VideoPlayerOzWWWGlobalConfig","emptyFunction","gkx","handleVideoPlayerLatencyLevelChange","oz-player/networks/OzBandwidthEstimator"],(function(a,b,c,d,e,f,g){"use strict";b=c("emptyFunction");function h(a){return(a=a.getSelectedVideoQuality())!=null?a:""}function i(a){a=a.getCurrentPlayingAudioTrackID();return a==null?null:a}function j(a){a=a.getCurrentVideoRepresentation();return a==null?"":a.getDisplayLabel()}function k(a){a=a.getIsVideoQualityAdaptationEnabled()?"auto":(a=a.getSelectedVideoQuality())!=null?a:"auto";return a}function l(a){return a.getTargetAudioTrack()}function m(a){return(a=(a=a.getMpd())==null?void 0:a.getCustomField("fbProjection"))!=null?a:null}function n(a,b){var c=k(a);if(b==="notselected"||b===c)return!1;else if(b==="auto"){a.enableVideoQualityAdaptation();return!0}else if(b!==a.getSelectedVideoQuality()){c=b;a.switchToVideoQuality(c);return!0}else return!1}function o(a,b){b=b;a.switchToVideoVariant(b)}function a(a){var b=a.getConfig,d=a.getOzPlayer,e=a.getVideoElementAPI;a={getApproximateFBLSToPlayerDisplayLatency:function(){var a;return(a=(a=d())==null?void 0:a.getApproximateFBLSToPlayerDisplayLatency())!=null?a:null},getAvailableAudioTracks:function(){var a;a=(a=d())==null?void 0:a.getAudioTracks();if(!a)return[];a=a.map(function(a){return{displayLabel:a.displayLabel,id:a.id,lang:a.lang,role:a.role}});return a},getAvailableVideoQualities:function(){var a;return(a=(a=d())==null?void 0:a.getVideoQualities())!=null?a:[]},getAvailableVideoTracks:function(){var a;a=(a=d())==null?void 0:a.getVideoTracks();if(!a)return[];a=a.map(function(a){return{codec:a.codec,codecFamily:a.codecFamily,displayLabel:a.displayLabel,height:a.height,id:a.id,qualityLabel:a.qualityLabel,width:a.width}});return a},getCurrentAudioRepresentation:function(){var a;return(a=(a=d())==null?void 0:a.getCurrentAudioRepresentation())!=null?a:null},getCurrentPlayingAudioRepresentationID:function(){var a=d();return a?i(a):null},getCurrentPlayingAudioTrackID:function(){var a=d();return a?i(a):null},getCurrentPlayingVideoQuality:function(){var a=d();return a?j(a):""},getCurrentPlayingVideoRepresentationID:function(){var a;return(a=(a=d())==null?void 0:(a=a.getCurrentVideoRepresentation())==null?void 0:a.getID())!=null?a:null},getCurrentTargetVideoQuality:function(){var a=d();return a?h(a):""},getCurrentVideoRepresentation:function(){var a;return(a=(a=d())==null?void 0:a.getCurrentVideoRepresentation())!=null?a:null},getEstimatedBandwidth:function(){return c("oz-player/networks/OzBandwidthEstimator").getBandwidth(c("VideoPlayerOzWWWGlobalConfig"))},getInbandCaptionsAutogeneratedFromManifest:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromUsingASRCaptions"))},getInbandCaptionsExpectedFromManifest:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromUsingASRCaptions"))||Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromAccessibility"))},getManifestIdentifier:function(){var a;a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getCustomField("fbManifestIdentifier");return a!=null?String(a):null},getMpdValidationErrors:function(){var a;a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getCustomField("validationErrors");return a!=null?String(a):null},getPerfLoggerProvider:function(){var a=d();return a?a.getPerfLoggerProvider():null},getRepresentationCaptionsExpectedFromManifest:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("hasVTTRepresentationCaptions"))},getStreamType:function(){return"dash"},getTargetAudioTrack:function(){var a=d();return a?l(a):null},getUserSelectedVideoQuality:function(){var a=d();return a?k(a):""},getUserSelectedVideoVariant:function(){var a=d();return(a=a==null?void 0:a.getTargetVideoVariant())!=null?a:null},getVideoProjectionType:function(){var a=d();return a!=null?m(a):null},getVideoRepresentations:function(){var a;return(a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getVideoRepresentations())!=null?a:null},isDrm:function(){var a;return Boolean((a=d())==null?void 0:a.isDrm())},isFBIsLiveTemplated:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isLiveTemplated"))},isFBMS:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isFBMS"))},isFBWasLive:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isFBWasLive"))},isLiveRewindAvailable:function(){var a;a=(a=(a=d())==null?void 0:a.getMpdUrl())!=null?a:"";try{return(a=(a=new URL(a).searchParams.get("ms"))==null?void 0:a.includes("m_CT"))!=null?a:!1}catch(a){}return!1},isMixedCodecManifest:function(){var a,b;a=(a=d())==null?void 0:a.getMpd();if(a==null)return null;a=(a=a.getVideoRepresentations())!=null?a:[];a=new Set(a.map(function(a){return/codecs=\"([^\".]+)/i.exec(a.getMimeCodecs())}));b=(b=(b=d())==null?void 0:(b=b.getMpd())==null?void 0:b.getAudioRepresentations())!=null?b:[];b=new Set(b.map(function(a){return/codecs=\"([^\".]+)/i.exec(a.getMimeCodecs())}));return a.size>1||b.size>1},isPredictiveDash:function(){var a;a=(a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getVideoRepresentations()[0])!=null?a:null;return a!==null&&a.canPredict()},setDimensions:function(a){},setEnableLiveheadCatchup:function(a){var b=d();b!=null&&b.setEnableLiveheadCatchup(a)},setLatencyLevel:function(a){c("handleVideoPlayerLatencyLevelChange")(b(),e(),d(),a)},setUserSelectedVideoQuality:function(a){var b=d();b!=null&&n(b,a)},setUserSelectedVideoVariant:function(a){var b=d();b!=null&&a!=null&&o(b,a)}};return a}g.createVideoPlayerOzImplementationEngineExtrasAPI=a}),98);
__d("oz-player/shims/www/OzDOMEventListenerWWW",["OzDOMEventListenerImpl"],(function(a,b,c,d,e,f){"use strict";a=b("OzDOMEventListenerImpl");f["default"]=a}),66);
__d("oz-player/shims/OzDOMEventListener",["oz-player/shims/www/OzDOMEventListenerWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzDOMEventListenerWWW")}),98);
__d("oz-player/shims/www/OzSubscriptionsHandlerWWW",["SubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("SubscriptionsHandler")}),98);
__d("oz-player/shims/OzSubscriptionsHandler",["oz-player/shims/www/OzSubscriptionsHandlerWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzSubscriptionsHandlerWWW")}),98);
__d("oz-player/shims/www/ozThrottleWWW",["throttle"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("throttle")}),98);
__d("oz-player/shims/ozThrottle",["oz-player/shims/www/ozThrottleWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/ozThrottleWWW")}),98);
__d("oz-player/strategies/OzBufferingDetectorStates",["oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=c}var b=a.prototype;b.handleEvent=function(a,b,c){if(a.type==="pause"||b.paused)return new i(this.$1,this.$2);a=this.$3 instanceof j?this.$1.getInPlayBufferOverflowTarget():this.$1.getStartBufferUnderflowTarget();return d("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(b,a,c)?new j(this.$1,this.$2):this};return a}(),i=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.handleEvent=function(a,b,c){return a.type==="play"||a.type==="playing"||!b.paused?d("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(b,this.$1.getStartBufferUnderflowTarget(),c)?new j(this.$1,this.$2):new h(this.$1,this.$2,this):this};return a}(),j=function(){function a(a,b){this.$1=a,this.$2=b,this.$3=b.getString("stream_types_eligible_for_partial_playback","").split(",")}var b=a.prototype;b.handleEvent=function(a,b,c,e){e===void 0&&(e=new Map());if(a.type==="pause"||b.paused)return new i(this.$1,this.$2);return!d("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(b,this.$1.getInPlayBufferUnderflowTarget(),c)&&!this.$4(a,b.currentTime,e)?new h(this.$1,this.$2,this):this};b.$4=function(a,b,c){return a.type==="waiting"?!1:d("oz-player/utils/OzBufferingUtils").hasEnoughPartialBuffer(b,c,this.$3,this.$2.getNumber("partial_playback_buffer_overflow",0))};return a}();g.OzVideoBufferingState=h;g.OzVideoPausedState=i;g.OzVideoPlayingState=j}),98);
__d("oz-player/strategies/OzBufferingStateThresholdManager",["oz-player/shims/OzPerformance","oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$2=!1,this.$3=-Infinity,this.$4=-Infinity,this.$1=a}var b=a.prototype;b.getInPlayBufferUnderflowTarget=function(){return this.$1.getNumber("in_play_buffer_underflow_target",d("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD)};b.getInPlayBufferOverflowTarget=function(){if(this.$5())return this.$1.getNumber("stream_interrupt_in_play_buffer_overflow_target",d("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD);return c("oz-player/shims/OzPerformance").now()-this.$4<this.$1.getNumber("recent_buffer_timeout_ms",0)?this.$1.getNumber("recent_buffer_in_play_buffer_overflow_target",d("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD):this.$1.getNumber("in_play_buffer_overflow_target",d("oz-player/utils/OzBufferingUtils").BUFFER_OVERFLOW_THRESHOLD)};b.getStartBufferUnderflowTarget=function(){return this.$1.getNumber("start_buffer_underflow_target",d("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD)};b.notifyBufferingEnd=function(){this.$4=c("oz-player/shims/OzPerformance").now()};b.notifyStreamInterrupted=function(){this.$2=!0};b.notifyStreamResumed=function(){this.$2=!1,this.$3=c("oz-player/shims/OzPerformance").now()};b.$5=function(){var a=this.$1.getNumber("stream_interrupt_buffer_target_timeout_ms",0);return a===0?!1:this.$2||c("oz-player/shims/OzPerformance").now()-this.$3<a};return a}();g["default"]=a}),98);
__d("oz-player/strategies/OzBufferingDetector",["oz-player/shims/OzDOMEventListener","oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozThrottle","oz-player/strategies/OzBufferingDetectorStates","oz-player/strategies/OzBufferingStateThresholdManager","oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=150;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e,f){var g;g=a.call(this)||this;g.$OzBufferingDetector$p_3=new(c("oz-player/shims/OzSubscriptionsHandler"))();g.$OzBufferingDetector$p_6=new Map();g.$OzBufferingDetector$p_8=null;g.$OzBufferingDetector$p_9=function(a){g.$OzBufferingDetector$p_11(a)};g.$OzBufferingDetector$p_2=b;g.$OzBufferingDetector$p_4=e;g.$OzBufferingDetector$p_5=f;g.$OzBufferingDetector$p_7=new(c("oz-player/strategies/OzBufferingStateThresholdManager"))(e);g.$OzBufferingDetector$p_2.paused?g.$OzBufferingDetector$p_1=new(d("oz-player/strategies/OzBufferingDetectorStates").OzVideoPausedState)(g.$OzBufferingDetector$p_7,g.$OzBufferingDetector$p_4):g.$OzBufferingDetector$p_1=d("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(g.$OzBufferingDetector$p_2,g.$OzBufferingDetector$p_7.getInPlayBufferUnderflowTarget(),g.$OzBufferingDetector$p_5())?new(d("oz-player/strategies/OzBufferingDetectorStates").OzVideoPlayingState)(g.$OzBufferingDetector$p_7,g.$OzBufferingDetector$p_4):new(d("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState)(g.$OzBufferingDetector$p_7,g.$OzBufferingDetector$p_4,null);g.$OzBufferingDetector$p_3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"pause",g.$OzBufferingDetector$p_9),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"play",g.$OzBufferingDetector$p_9),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"progress",c("oz-player/shims/ozThrottle")(g.$OzBufferingDetector$p_9,h)),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"timeupdate",c("oz-player/shims/ozThrottle")(g.$OzBufferingDetector$p_9,h)),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"seeked",g.$OzBufferingDetector$p_9),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"seeking",g.$OzBufferingDetector$p_9),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"waiting",g.$OzBufferingDetector$p_9));g.$OzBufferingDetector$p_3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"canplay",g.$OzBufferingDetector$p_9),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g.$OzBufferingDetector$p_2,"canplaythrough",g.$OzBufferingDetector$p_9));return g}var e=b.prototype;e.$OzBufferingDetector$p_10=function(){var a=this,b="unavailable",c=this.$OzBufferingDetector$p_7.getInPlayBufferUnderflowTarget();this.$OzBufferingDetector$p_6.forEach(function(e,f){var g=a.$OzBufferingDetector$p_2.currentTime;d("oz-player/utils/OzBufferingUtils").hasBuffer(g,c,e)||(b=b==="unavailable"?f:"audio/video")});return b};e.setSourceBufferState=function(a,b){this.$OzBufferingDetector$p_6.set(a,b)};e.$OzBufferingDetector$p_11=function(a){var b=this.$OzBufferingDetector$p_1.handleEvent(a,this.$OzBufferingDetector$p_2,this.$OzBufferingDetector$p_5(),this.$OzBufferingDetector$p_6),c=this.$OzBufferingDetector$p_1;this.$OzBufferingDetector$p_1=b;var e=b instanceof d("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState,f=c instanceof d("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState;if(b===c){e&&this.$OzBufferingDetector$p_8&&this.$OzBufferingDetector$p_8.cloneContext().getOperationLogger("buffering_handle_event").setInitiator(a.type).log();return b}if(e){e=c instanceof d("oz-player/strategies/OzBufferingDetectorStates").OzVideoPlayingState?"in_play":"start/unpause";this.$OzBufferingDetector$p_8&&this.$OzBufferingDetector$p_8.cloneContext().getOperationLogger("enter_buffering").setState("buffering").setType(e).setReason(this.$OzBufferingDetector$p_10()).setInitiator(a.type).log();this.emit("enterBuffering",e)}else f&&(this.$OzBufferingDetector$p_8&&this.$OzBufferingDetector$p_8.cloneContext().getOperationLogger("leave_buffering").setInitiator(a.type).log(),this.$OzBufferingDetector$p_7.notifyBufferingEnd(),this.emit("leaveBuffering",{domEventPerfTimestamp:a.timeStamp}));return b};e.notifyStreamInterrupted=function(){this.$OzBufferingDetector$p_7.notifyStreamInterrupted()};e.notifyStreamResumed=function(){this.$OzBufferingDetector$p_7.notifyStreamResumed()};e.attachPerfLoggerProvider=function(a){this.$OzBufferingDetector$p_8=a};e.destroy=function(){this.$OzBufferingDetector$p_3.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("VideoPlayerOzImplementationEnginePartsImplUtils",["OzSystemicRiskABRManager","OzWidevineDrmProvider","cr:9984","gkx","justknobx","oz-player/networks/OzBandwidthEstimator","oz-player/strategies/OzBufferingDetector"],(function(a,b,c,d,e,f,g){"use strict";var h=/(livestream-)?lookaside\.(facebook|workplace)\.com$/;function a(a){return h.test(a.getDomain())}function d(a,b,d,e,f,g){if(f.current!=null)return;var h=!0,i=function(){if(h)return!1;f.current!==j;return!1},j=new(c("oz-player/strategies/OzBufferingDetector"))(a,d,function(){var a=e.getCurrentState();a=a.controlledState;return a.streamEnded?b.getDuration():Infinity});f.current=j;h=!1;a=function(a){if(i())return;e.dispatch({payload:{bufferingType:a},type:"buffering_begin_requested"});a=d.getNumber("ull_fallback_stall_count",0);if(a>0){var b=g.getLoggerState().stallCountTotal;d.getBool("fix_ull_fallback_stall_count",!1)&&(b=g.getLoggerState().inPlayStallCount200ms);e.getCurrentState().controlledState.latencyLevel==="ultra-low"&&b>a&&e.dispatch({payload:{latencyLevel:"low",ullIneligibilityReason:null},type:"implementation_set_latency_level_requested"})}};var k=function(a){if(i())return;e.dispatch({payload:{domEventPerfTimestamp:a.domEventPerfTimestamp},type:"buffering_end_requested"})};j.addListener("enterBuffering",a);j.addListener("leaveBuffering",k)}function e(a){var b=a.accessToken,d=a.graphQLVideoDRMInfo;a=a.videoFBID;var e=[];if(d&&a!=null){var f=c("justknobx")._("717")?null:d.widevineCert;e.push(new(c("OzWidevineDrmProvider"))(a,d.graphApiVideoLicenseUri,d.videoLicenseUriMap,b,(a=f)!=null?a:null))}return e}function f(a){var b=a.VideoPlayerShakaPerformanceLoggerClass,c=a.accessToken,d=a.disableLogging,e=a.getApproximateFBLSToPlayerDisplayLatency,f=a.getBandwidthEstimate,g=a.getPlayerDimensions,h=a.getPlayerFormat,i=a.playbackIsLiveStreaming,j=a.playerInstanceCount,k=a.playerInstanceKey,l=a.playerSuborigin,m=a.playerVersion,n=a.videoElement,o=a.videoFBID;a=a.videoPlayerShakaPerformanceLoggerBuilder;if(d||!a&&(!b||!b.shouldInitialize()))return[];c={accessToken:c,getApproximateFBLSToPlayerDisplayLatency:e,getBandwidthEstimate:f,getPlayerDimensions:g,getPlayerFormat:h,isLive:i,isServableViaFbms:!1,playerInstanceCount:j,playerOrigin:null,playerSuborigin:l,playerVersion:m,representationId:null,uniqueID:k,video:n,videoID:(d=o)!=null?d:""};return a!=null?[a.build(c)]:b?[new b(c)]:[]}function i(a,b){return b>0?b/1e3*-1:a.getNumber("live_initial_playback_position",0)}function j(a,b,c){return b>0&&c>0?(b+c)/1e3:a.getNumber("livehead_fall_behind_block_threshold",0)}function k(a,b){return b>0?b/2/1e3:a.getNumber("live_time_range_block_margin",0)}function l(a){return function(d,e,f,g,h,i,j,k,l){return!a&&b("cr:9984")!=null?new(b("cr:9984"))(d,e,f,g,h,i,j,k,l):d.getLegacyConfig().getBool("use_systemic_risk_abr",!1)?new(c("OzSystemicRiskABRManager"))(d,e,f,g,h,i,j,k,l):null}}function m(a,b){var d=b.experimentationConfig,e=b.getCurrentVideoRepresentation,f=b.getOzCDNSignedQueryParams,g=b.isClientTriggeredTraceEnabled,h=b.playbackIsLiveStreaming,i=b.playbackSessionId;b=b.shouldRefresh403;var j=a.getQueryData(),k;if(h){k={};if(d.getBool("server_side_abr_send_client_estimates",!1)){var l=c("oz-player/networks/OzBandwidthEstimator").getBandwidthDiagnostics(d);l&&(k=babelHelpers["extends"]({},k,{_nc_bwe:String(l.bandwidthEstimate),_nc_bwe_std:String(l.bandwidthStandardDeviation),_nc_ttfb:String(l.timeToFirstByteMsEstimate),_nc_ttfb_std:String(l.timeToFirstByteMsStandardDeviation)}));l=e();l&&(k=babelHelpers["extends"]({},k,{_nc_abr_bitrate:String(l.getBandwidth()),_nc_abr_qlabel:l.getDisplayLabel()}))}}e=d.getNumber("live_video_chunk_duration",0);l=d.getBool("use_bandwidth_estimate_from_headers_in_abr",!1);d=l?c("oz-player/networks/OzBandwidthEstimator").hasRecentBandwidthEstimateFromHeader():!1;h&&e>0&&d&&(k=babelHelpers["extends"]({},k,{chk_dur:e.toString(10)}));c("gkx")("24354")&&(j.uss!=null&&j.odm!=null&&(k=babelHelpers["extends"]({},k,{manual_redirect:"1"})));g&&(k=babelHelpers["extends"]({},k,{_nc_psid:i}));if(b){l=f();if(l!=null){h=a.getDomain()+a.getPath();d=l.get(h);if(d!=null)for(e in d){k=babelHelpers["extends"]({},k,(j={},j[e]=d[e],j))}}}return k}g.checkShouldIncludeCredentials=a;g.createOzBufferingDetector=d;g.createOzDrmProviders=e;g.createOzPerfLoggerProviders=f;g.calculateInitialPlaybackPositionForDynamicMpd=i;g.calculateLiveheadFallBehindBlockThreshold=j;g.calculateLiveheadFallBehindBlockMargin=k;g.getVideoAbrManagerFactory=l;g.getCustomRequestParametersForURI=m}),98);
__d("getOzPlaybackRestrictions",["OzMinimumSmallestDimensionRestriction","OzMosThresholdRestriction","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=[];switch(a){case"HD":d.push(new(c("OzMinimumSmallestDimensionRestriction"))(720));break;case"UHD":c("gkx")("24263")&&d.push(new(c("OzMinimumSmallestDimensionRestriction"))(1080));break;default:break}a=b.getNumber("mos_upper_threshold",0);var e=b.getNumber("mos_lower_threshold",0);(a>0||e>0)&&d.push(new(c("OzMosThresholdRestriction"))(b));return d}g["default"]=a}),98);
__d("str2rstr",[],(function(a,b,c,d,e,f){function a(a){var b="",c,d;for(var e=0;e<a.length;e++)c=a.charCodeAt(e),d=e+1<a.length?a.charCodeAt(e+1):0,55296<=c&&c<=56319&&56320<=d&&d<=57343&&(c=65536+((c&1023)<<10)+(d&1023),e++),c<=127?b+=String.fromCharCode(c):c<=2047?b+=String.fromCharCode(192|c>>>6&31,128|c&63):c<=65535?b+=String.fromCharCode(224|c>>>12&15,128|c>>>6&63,128|c&63):c<=2097151&&(b+=String.fromCharCode(240|c>>>18&7,128|c>>>12&63,128|c>>>6&63,128|c&63));return b}f["default"]=a}),66);
__d("md5",["str2rstr"],(function(a,b,c,d,e,f,g){function h(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];c=j(c,d,e,f,b[0],7,-680876936);f=j(f,c,d,e,b[1],12,-389564586);e=j(e,f,c,d,b[2],17,606105819);d=j(d,e,f,c,b[3],22,-1044525330);c=j(c,d,e,f,b[4],7,-176418897);f=j(f,c,d,e,b[5],12,1200080426);e=j(e,f,c,d,b[6],17,-1473231341);d=j(d,e,f,c,b[7],22,-45705983);c=j(c,d,e,f,b[8],7,1770035416);f=j(f,c,d,e,b[9],12,-1958414417);e=j(e,f,c,d,b[10],17,-42063);d=j(d,e,f,c,b[11],22,-1990404162);c=j(c,d,e,f,b[12],7,1804603682);f=j(f,c,d,e,b[13],12,-40341101);e=j(e,f,c,d,b[14],17,-1502002290);d=j(d,e,f,c,b[15],22,1236535329);c=k(c,d,e,f,b[1],5,-165796510);f=k(f,c,d,e,b[6],9,-1069501632);e=k(e,f,c,d,b[11],14,643717713);d=k(d,e,f,c,b[0],20,-373897302);c=k(c,d,e,f,b[5],5,-701558691);f=k(f,c,d,e,b[10],9,38016083);e=k(e,f,c,d,b[15],14,-660478335);d=k(d,e,f,c,b[4],20,-405537848);c=k(c,d,e,f,b[9],5,568446438);f=k(f,c,d,e,b[14],9,-1019803690);e=k(e,f,c,d,b[3],14,-187363961);d=k(d,e,f,c,b[8],20,1163531501);c=k(c,d,e,f,b[13],5,-1444681467);f=k(f,c,d,e,b[2],9,-51403784);e=k(e,f,c,d,b[7],14,1735328473);d=k(d,e,f,c,b[12],20,-1926607734);c=l(c,d,e,f,b[5],4,-378558);f=l(f,c,d,e,b[8],11,-2022574463);e=l(e,f,c,d,b[11],16,1839030562);d=l(d,e,f,c,b[14],23,-35309556);c=l(c,d,e,f,b[1],4,-1530992060);f=l(f,c,d,e,b[4],11,1272893353);e=l(e,f,c,d,b[7],16,-155497632);d=l(d,e,f,c,b[10],23,-1094730640);c=l(c,d,e,f,b[13],4,681279174);f=l(f,c,d,e,b[0],11,-358537222);e=l(e,f,c,d,b[3],16,-722521979);d=l(d,e,f,c,b[6],23,76029189);c=l(c,d,e,f,b[9],4,-640364487);f=l(f,c,d,e,b[12],11,-421815835);e=l(e,f,c,d,b[15],16,530742520);d=l(d,e,f,c,b[2],23,-995338651);c=m(c,d,e,f,b[0],6,-198630844);f=m(f,c,d,e,b[7],10,1126891415);e=m(e,f,c,d,b[14],15,-1416354905);d=m(d,e,f,c,b[5],21,-57434055);c=m(c,d,e,f,b[12],6,1700485571);f=m(f,c,d,e,b[3],10,-1894986606);e=m(e,f,c,d,b[10],15,-1051523);d=m(d,e,f,c,b[1],21,-2054922799);c=m(c,d,e,f,b[8],6,1873313359);f=m(f,c,d,e,b[15],10,-30611744);e=m(e,f,c,d,b[6],15,-1560198380);d=m(d,e,f,c,b[13],21,1309151649);c=m(c,d,e,f,b[4],6,-145523070);f=m(f,c,d,e,b[11],10,-1120210379);e=m(e,f,c,d,b[2],15,718787259);d=m(d,e,f,c,b[9],21,-343485551);a[0]=s(c,a[0]);a[1]=s(d,a[1]);a[2]=s(e,a[2]);a[3]=s(f,a[3])}function i(a,b,c,d,e,f){b=s(s(b,a),s(d,f));return s(b<<e|b>>>32-e,c)}function j(a,b,c,d,e,f,g){return i(b&c|~b&d,a,b,e,f,g)}function k(a,b,c,d,e,f,g){return i(b&d|c&~d,a,b,e,f,g)}function l(a,b,c,d,e,f,g){return i(b^c^d,a,b,e,f,g)}function m(a,b,c,d,e,f,g){return i(c^(b|~d),a,b,e,f,g)}function n(a){var b=a.length,c=[1732584193,-271733879,-1732584194,271733878],d;for(d=64;d<=a.length;d+=64)h(c,o(a.substring(d-64,d)));a=a.substring(d-64);var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<a.length;d++)e[d>>2]|=a.charCodeAt(d)<<((d&3)<<3);e[d>>2]|=128<<((d&3)<<3);if(d>55){h(c,e);for(d=0;d<16;d++)e[d]=0}e[14]=b*8;h(c,e);return c}function o(a){var b=[],c=0;while(c<64)b[c>>2]=a.charCodeAt(c++)|a.charCodeAt(c++)<<8|a.charCodeAt(c++)<<16|a.charCodeAt(c++)<<24;return b}var p="0123456789abcdef".split("");function q(a){var b="",c=0;for(;c<4;c++)b+=p[a>>(c<<3)+4&15]+p[a>>(c<<3)&15];return b}function r(a){var b=[];for(var c=0;c<a.length;c++)b[c]=q(a[c]);return b.join("")}var s=function(a,b){return a+b&4294967295};function a(a){if(a==null)return null;a=a;for(var b=0;b<a.length;b++)if(a[b]>"\x7f"){a=c("str2rstr")(a);break}return r(n(a))}a("hello")!="5d41402abc4b2a76b9719d911017c592"&&(s=function(a,b){var c=(a&65535)+(b&65535);a=(a>>16)+(b>>16)+(c>>16);return a<<16|c&65535});g["default"]=a}),98);
__d("oz-player/configs/OzPlayerConfigDefaults",[],(function(a,b,c,d,e,f){a={bandwidth_ignore_on_stream_write_samples:!1,bandwidth_use_response_time_adjustment:!1,catchup_use_timeline_range_end_time_as_end:!1,clear_on_seek:!0,debug_live_replay:!1,do_not_end_stream:!1,emit_caption_parse_errors_as_warning:!0,enable_abr_logging:!1,enable_alternative_audio_tracks:!1,enable_lip_sync_abr_select_quality:!1,fix_live_rewind_user_selected_playback_speed:!0,ignore_reset_after_seek_if_bufferahead:!1,latencymanager_stalled_edgelatency_sec_on:!1,msm_refactor_wait_for_sourceopen:!1,ms_promise_for_null:!1,normalize_mpd_fetch_errors:!0,parse_number_templated_uri:!0,pdash_use_pdash_segmentlocator:!1,playback_speed_latency_adjustment_disabled:!1,player_emit_mpdparsed_early:!1,playhead_manager_buffered_timerange_update_on_timeupdate:!0,playhead_manager_clamp_initial_playback_position:!1,reset_catchup_timeout_after_play_sec_on_overwrite:!0,retry_video_element_error:!0,sidx_parser_memory_optimization:!0,skip_videobuffer_gaps:!0,skip_videobuffer_gaps_on_buffer_updated:!0,use_live_latency_manager:!1,use_scf_timebased_segments:!1,video_cdn_url_refresh:!1,vtt_caption_representation:!0};b={abr_confidence_threshold:.9,abr_eval_buffer_threshold:0,abr_min_bandwidth_samples:0,abr_prevent_down_switch_buffer_threshold:11,abr_restrict_from_index:0,abr_restrict_to_index:0,append_byte_target_without_range:1e5,appends_per_segment:6,auto_seek_playhead_slack:.5,bandwidth_boundary_standard_deviation_factor:1,bandwidth_estimator_half_life:6,bandwidth_estimator_outlier_exclusion_factor:50,bandwidth_estimator_std_dev_penalty_factor:0,bandwidth_header_expire_threshold:0,bandwidth_response_time_handicap:0,bandwidth_ttfb_samples_to_save:5,buffer_ahead_target:22,buffer_target_constraint_append_succeeded_reward:.2,buffer_target_constraint_minimum_sec:2,buffer_target_constraint_quota_exceeded_penalty:.3,byte_count_per_sample:2e5,catchup_timeout_after_buffering_sec:0,catchup_timeout_after_play_sec:0,clear_buffer_around_playhead_boundary_ms:5e3,clear_buffer_on_seek_epsilon_s:0,clear_buffer_on_seek_nudge_s:0,default_bandwidth_estimate:1e6,download_cursor_buffer_ahead_time_max_sec:0,download_cursor_total_buffer_max_sec:0,dvl_initial_segment_ignore_count:1,dvl_update_interval_ms:0,dynamic_mpd_initial_playback_position_offset_modifier:4,initial_manifest_request_retry_count:3,initial_switch_interval:0,in_play_buffer_overflow_target:1,in_play_buffer_underflow_target:.1,latencymanager_stalled_edgelatency_sec:0,live_audio_ibr_bandwidth_percentage:.05,live_numerical_error_epsilon:1e-4,loop_body_handle_error_interval_ms:1,low_buffer_bandwidth_target_increase_factor:0,low_buffer_bandwidth_target_threshold:10,low_segment_stream_playhead_threshold:0,manifest_initial_update_delay_ms:0,manifest_update_frequency_ms:0,max_bandwidth_sample_count:30,maximum_bandwidth_sample_bandwidth:1e8,max_start_eme_attempts:3,min_eval_interval:100,minimum_bandwidth_sample_duration:10,minimum_bytes_to_sample_on_close:25e3,min_switch_interval:100,mpd_updater_network_request_timeout_ms:2e4,ms_promise_for_null_ms:0,network_seg_timeout_ms:0,overwrite_livehead_fall_behind_block_threshold:0,overwrite_live_time_range_block_margin:0,partial_playback_buffer_overflow:.75,paused_stream_segments_count:2,pdash_download_cursor_between_catchups_seg:0,pdash_download_cursor_catchup_threshold_gop_multiplier:0,pdash_download_cursor_catchup_threshold_sec:0,pdash_download_cursor_catchup_tolerance_sec:0,per_stream_duration_target:0,pixels_above_viewport_to_observe:0,pixels_below_viewport_to_observe:0,playback_speed_enabled_delay_sec:4,playback_speed_latency_adjustment_rate:0,playback_speed_latency_slowdown_adjustment_rate:0,playback_speed_latency_speedup_adjustment_rate:0,playback_speed_min_buffer_sec:1,playback_speed_min_duration_sec:2,playback_speed_min_sharpness_factor:3,playback_speed_restore_min_duration_sec:1,playhead_manager_buffered_auto_seek_playhead_slack:.5,playhead_manager_buffered_is_near_gap_threshold:1.5,playhead_manager_buffered_numerical_error:.01,playhead_manager_timeupdate_throttle_ms:1e3,pre_start_buffer_ahead_target:16.924449682236,prioritize_by_viewport_static_penalty:0,recent_buffer_in_play_buffer_overflow_target:3,recent_buffer_timeout_ms:1e4,resolution_constraint_factor:2,seconds_to_stream:10,seconds_to_stream_near_bandwidth_boundary:10,seek_ahead_epsilon:.05,segments_to_stream:5,segments_to_stream_near_bandwidth_boundary:5,segments_to_stream_under_playhead_threshold:0,sidx_segment_retry_attempts:9999,sidx_segment_retry_interval_ms:100,skip_videobuffer_gaps_max_gap_size_sec:0,stale_mpd_buffer_ahead_target:0,start_buffer_underflow_target:.1,steadystate_minbuffer_buckets:0,steadystate_minbuffer_buckets_sec:1,steadystate_minbuffer_sec:0,stream_interrupt_buffer_target_timeout_ms:1e4,stream_interrupt_check_mpd_stale_count_threshold:6,stream_interrupt_in_play_buffer_overflow_target:1,timeline_offset_threshold:10,time_to_first_byte_estimate_half_life_ms:500,time_to_first_byte_ignore_above_threshold_ms:0};c={bandwidth_estimate_header_key:"",bandwidth_estimate_key:"",block_representation_status_codes_json:"[500, 503]",block_representation_status_codes_temporarily_json:"{}",cdn_experiment_id:"",stream_types_eligible_for_partial_playback:""};e.exports={defaultBools:a,defaultNumbers:b,defaultStrings:c}}),null);
__d("oz-player/configs/OzPlayerConfig",["oz-player/configs/OzPlayerConfigDefaults"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){a===void 0&&(a={}),this.$1=a}var b=a.prototype;b.getBool=function(a){return typeof this.$1[a]==="boolean"?this.$1[a]:d("oz-player/configs/OzPlayerConfigDefaults").defaultBools[a]};b.getNumber=function(a){return typeof this.$1[a]==="number"?this.$1[a]:d("oz-player/configs/OzPlayerConfigDefaults").defaultNumbers[a]};b.getString=function(a){return typeof this.$1[a]==="string"?this.$1[a]:d("oz-player/configs/OzPlayerConfigDefaults").defaultStrings[a]};b.getLegacyConfig=function(){var a=this;return{getBool:function(b,c){return typeof a.$1[b]==="boolean"?a.$1[b]:(b=d("oz-player/configs/OzPlayerConfigDefaults").defaultBools[b])!=null?b:c},getNumber:function(b,c){return typeof a.$1[b]==="number"?a.$1[b]:(b=d("oz-player/configs/OzPlayerConfigDefaults").defaultNumbers[b])!=null?b:c},getString:function(b,c){return typeof a.$1[b]==="string"?a.$1[b]:(b=d("oz-player/configs/OzPlayerConfigDefaults").defaultStrings[b])!=null?b:c}}};return a}();g["default"]=a}),98);
__d("oz-player/configs/OzConfigUtils",["oz-player/configs/OzPlayerConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("oz-player/configs/OzPlayerConfig"))();a=function(a){return{getBool:function(b){return a.getBool(b,h.getBool(b))},getNumber:function(b){return a.getNumber(b,h.getNumber(b))},getString:function(b){return a.getString(b,h.getString(b))},getLegacyConfig:function(){return a}}};g.provideConfigWithDefaults=a}),98);
__d("oz-player/networks/OzClientClock",["oz-player/shims/OzPerformance","oz-player/utils/OzResourceTimingUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a!==null){a=parseInt(a,10);if(!isNaN(a))return a}return null}a=function(){function a(){this.$1=null,this.$2=0,this.$2=Date.now()-c("oz-player/shims/OzPerformance").now()}var b=a.prototype;b.updateOffsetFromHeaderResponse=function(a,b){var c=h(b.get("x-fb-dynamic-server-wallclock-ms"));b=h(b.get("x-fb-dynamic-rtt-ms"));a=d("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(a);if(c!==null&&b!==null&&a!=null&&(a.responseStart>0&&a.duration>10)){a=a.requestStart+this.$2;c=c-a-b/2;this.$1=c}};b.now=function(){var a;return c("oz-player/shims/OzPerformance").now()+this.$2+((a=this.$1)!=null?a:0)};b.getClientClockOffsetMs=function(){return this.$1};return a}();b=new a();g["default"]=b}),98);
__d("oz-player/networks/OzClockSyncNetworkRequestStreamHandler",["oz-player/networks/OzClientClock","oz-player/networks/OzTransformStream"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.onResponse=function(a,b){var d=a.headers;if(!d)return null;a=new(c("oz-player/networks/OzTransformStream"))();a.addListener("writableClose",function(){c("oz-player/networks/OzClientClock").updateOffsetFromHeaderResponse(b,d)});return a};b.onError=function(a,b){return null};return a}();g["default"]=a}),98);
__d("VideoPlayerOzImplementationEnginePartsImplFunction",["CometThrottle","ConstUriUtils","Deferred","FBLogger","JSResourceForInteraction","NetworkStatus","OzActiveActiveFailoverNetworkRequestStreamHandler","OzBufferVTTCaptionsVisibleStrategy","OzCDNSignedQueryParams","OzCustomParsers","OzCustomRepresentationParsers","OzOneSemanticHandler","OzOneSemanticHandlerUtils","OzPredictedSegmentTimelineParser","OzVideoLiveTraceNetworkRequestStreamHandler","Promise","QE2Logger","TimeRanges","VideoPlayerConnectionQuality","VideoPlayerImplementationErrors","VideoPlayerODS","VideoPlayerOzImplementationEnginePartsImplUtils","clearTimeout","cr:1836099","cr:1871597","cr:1947728","cr:1993377","getErrorSafe","getOzPlaybackRestrictions","gkx","md5","oz-player/configs/OzConfigUtils","oz-player/networks/OzBandwidthEstimator","oz-player/networks/OzClockSyncNetworkRequestStreamHandler","setTimeout","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("JSResourceForInteraction")("VideoPlayerEmsg").__setRef("VideoPlayerOzImplementationEnginePartsImplFunction"),j=1e4,k=null,l=null;b("cr:1836099")&&(k=b("cr:1836099").getHiveConfig(),l=b("cr:1836099").HiveOz);function a(a){var e,f=a.OzPlayerClass,g=a.callChain,m=a.destroyOzPlayerPartsRef,n=a.engineDebugAPI,o=a.engineExtrasAPI,p=a.getCaptionsInfo,aa=a.getLatencyLevelManager,q=a.getVideoLiveTrace,r=a.handleCaptionsInfoChange,ba=a.handleFatalImplementationError,s=a.hivePluginRef,t=a.initialProps,u=a.logger,v=a.machine,w=a.overrideOzRequestImplementationRef,x=a.ozBufferingDetectorRef,y=a.ozPlayerRef,z=a.p2pSessionLoggerRef,ca=a.playerFormatForDPLRef,A=a.playerVersion,B=a.resolvedVideoInfo,C=a.videoElement,D=a.videoElementAPI,E={current:!1},F={current:null},G={current:null};m.current=function(a){var b=x.current;b&&(x.current=null,b.destroy());b=y.current;if(b){n&&n.handleOzPlayerChanged(null,D);y.current=null;try{b.destroy([].concat(a,["destroyOzPlayerParts"]).join(":"))}catch(a){c("FBLogger")("comet_video_player").catching(a).mustfix("Error in ozPlayer.destroy: %s",String(a))}}b=F.current;b&&(F.current=null,b());G.current&&(G.current=null);Z();s.current&&(s.current=null);z.current&&(z.current=null);w.current&&(w.current=null)};a=B.accessToken;m=B.audioOnly;var H=B.experimentationConfig,I=B.graphQLVideoDRMInfo,J=B.graphQLVideoP2PSettings,K=B.manifestUrl,da=B.manifestXmlStringResolved,ea=B.minQualityPreference,fa=B.ozPrefetchCache,L=B.videoFBID,M=t.disableLogging?null:B.VideoPlayerShakaPerformanceLoggerClass,N=Boolean(t.loggingMetaData.coreVideoPlayerMetaData.isLiveStreaming),O=Boolean((e=t.isClientTriggeredTraceEnabled)!=null?e:!1),P=function(a){return o.getEstimatedBandwidth()};e=function(){return o.getApproximateFBLSToPlayerDisplayLatency()};var ga=function(){H.setContext("connection_quality",d("VideoPlayerConnectionQuality").evaluate(function(){return P(N)}))},Q=function(){var a=H.getNumber("connection_quality_context_throttle_frequency",0);if(a===0)return null;var b=c("CometThrottle")(ga,a),d=c("oz-player/networks/OzBandwidthEstimator").addListener("bandwidth_sampled",b);return function(){d.remove(),b.cancel()}};F.current=Q();Q=d("VideoPlayerOzImplementationEnginePartsImplUtils").createOzDrmProviders({accessToken:a,graphQLVideoDRMInfo:I,videoFBID:L});I=function(){return v.getCurrentState().controlledState.captionsVisible};var R=[];H.getBool("use_vtt_captions_visible_buffer_strategy",!0)&&R.push(new(c("OzBufferVTTCaptionsVisibleStrategy"))(I));I=function(){return v.getCurrentState().controlledState.dimensions};var S=function(){var a;return(a=ca.current)!=null?a:"unknown"};a=d("VideoPlayerOzImplementationEnginePartsImplUtils").createOzPerfLoggerProviders({VideoPlayerShakaPerformanceLoggerClass:M,accessToken:a,disableLogging:t.disableLogging,getApproximateFBLSToPlayerDisplayLatency:e,getBandwidthEstimate:P,getPlayerDimensions:I,getPlayerFormat:S,playbackIsLiveStreaming:N,playerInstanceCount:t.loggingMetaData.playerImplementationInstanceCountRef.current,playerInstanceKey:t.loggingMetaData.instanceKey,playerSuborigin:t.loggingMetaData.coreVideoPlayerMetaData.subOrigin,playerVersion:A,videoElement:C,videoFBID:L,videoPlayerShakaPerformanceLoggerBuilder:B.videoPlayerShakaPerformanceLoggerBuilder});G.current==null&&(G.current=new(c("OzCDNSignedQueryParams"))());if(J&&L!=null){e=J.community_info;S=J.config;A=J.hive_initialization_options;B=z.current=(B=z.current)!=null?B:b("cr:1871597")?new(b("cr:1871597"))(L,e):null;try{if(!s.current){B&&B.logEnableP2P();e=function(a){z.current&&z.current.logHiveError(a)};var T=function(b){var a=y.current;a&&a.injectExternalDebugEvent("P2PTech",b.tech);z.current&&z.current.logSessionActive(b.tech)},U=function(b){var a=y.current;a&&a.injectExternalDebugEvent("P2PStats",b);z.current&&z.current.setCurrentHiveStats(b)},V=function(a){a=a.state;var b=v.getCurrentState();b=b.controlledState;b=b.playbackState;if(s.current&&a==="CLOSED"){Z();a=y.current;a&&b!=="ended"&&(E.current&&K!=null?a.updatePlayerRunTimeConfig({manifestUrl:K}):a.load(K))}};U={HiveJava:{},HiveJS:{maximumTrimming:{dash:void 0,hls:void 0},renderStatsCallback:U},debugLevel:"off",hiveTechOrder:["HiveJS","StatsJS","HiveJava"],onActiveSession:T,onError:e,onSessionStateChange:V,telemetryId:B?B.getSessionID():0};T=H.getNumber("hive_maximum_trimming_seconds",0);T>0&&(U.HiveJS.maximumTrimming={dash:T,hls:T});if(A){e=A.HiveJava;V=A.debugLevel;T=A.hiveTechOrder;U.hiveTechOrder=T.slice();U.HiveJava=e?{minVersion:e.minVersion}:{};U.debugLevel=(A=V)!=null?A:U.debugLevel}if(S.disable_hivejava_for_livevc===!0&&K!=null&&K.startsWith("https://livestream-lookaside")){T=U.hiveTechOrder.indexOf("HiveJava");T>=0&&U.hiveTechOrder.splice(T,1)}if(k)k.SensitiveInfo.restrictedConnectivityInfo=!0;else throw c("unrecoverableViolation")("HiveConfig does not exist","comet_video_player");if(l)s.current=new l(U);else throw c("unrecoverableViolation")("HiveOz does not exist","comet_video_player");if(s.current){if(!b("cr:1947728"))throw c("unrecoverableViolation")("OzConfigurableRequestImplementation does not exist","comet_video_player");w.current=b("cr:1947728")(s.current.getRequestImplementation(),{inferResponseStatusIsOK:!0,inferResponseStatusIsOk2xx:!1})}}}catch(a){B&&B.logError(a),Z()}}e=[new(c("OzVideoLiveTraceNetworkRequestStreamHandler"))(function(a,b,c){var d=q();d!=null&&d.handleHeadersAndBody(a,b,c)},H.getBool("live_trace_parse_emsg",!1)),new(c("oz-player/networks/OzClockSyncNetworkRequestStreamHandler"))()];c("OzActiveActiveFailoverNetworkRequestStreamHandler")&&e.push(new(c("OzActiveActiveFailoverNetworkRequestStreamHandler"))(function(b,c){var a=y.current,e=b.headers;if(a&&e){e=parseInt(e.get("x-fb-video-replica"),10);u.logVPLEvent({eventType:"replica_switch",logDataOverrides:{error_code:b.status.toString(),error_user_info:JSON.stringify({failover_response_code:b.status.toString(),replica:e,url:c})},state:v.getCurrentState()});b=a.getMpdUrl();if(b!=null){c=d("ConstUriUtils").getUri(b);if(c){b=c.addQueryParam("replica",e);b&&(Z(),a.updatePlayerRunTimeConfig({manifestUrl:b.toString(),resetStreamAnchor:!0}))}}}}));var ha=t.expiredVideoUrlRefreshHandler,ia=t.loggingMetaData.instanceKey;V=c("gkx")("24353");A=c("gkx")("24354")||c("gkx")("24355");var ja=N?V:A;S=c("gkx")("4927");H.getBool("log_exposure_on_oz_initialization",!1)&&d("QE2Logger").logExposureForUser("www_videos_html5_mpeg_dash");U={audioOnly:(T=m)!=null?T:!1,bufferEndLimit:t.bufferEndLimit!=null?t.bufferEndLimit:null,bufferingDetector:(U=x.current)!=null?U:void 0,config:d("oz-player/configs/OzConfigUtils").provideConfigWithDefaults(H),configureCustomRequestParametersForSegment:function(a){var b=null;if(N&&O){var d=a.getByteRange();d=d?d.startByte+", "+(d.endByte!=null?d.endByte:"null"):"null";a=c("md5")(a.getURI().toString()+d);b=(d=b)!=null?d:{};a!=null&&(b=babelHelpers["extends"]({},b,{_nc_tsid:a}));b=babelHelpers["extends"]({},b,{_nc_e2e:"live"})}return b},customParsers:d("OzCustomParsers").createOzCustomParser(),customRepresentationParsers:d("OzCustomRepresentationParsers").createOzCustomRepresentationParsers({ozConfig:H}),customSegmentTimelineParser:H.getBool("enable_predictive_dash",!1)?new(c("OzPredictedSegmentTimelineParser"))():void 0,customVTTBufferTargetStrategies:R,debugCreateInitiator:[].concat(g,["proceedWithOzPlayerCreation"]).join(":"),drmProviders:Q,getCustomRequestParametersForURI:function(a){return d("VideoPlayerOzImplementationEnginePartsImplUtils").getCustomRequestParametersForURI(a,{experimentationConfig:H,getCurrentVideoRepresentation:function(){var a=y.current;return a==null?void 0:a.getCurrentVideoRepresentation()},getOzCDNSignedQueryParams:function(){return G.current},isClientTriggeredTraceEnabled:O,playbackIsLiveStreaming:N,playbackSessionId:ia,shouldRefresh403:ja})},getOverrideOzRequestImplementation:function(){return w.current},getShouldIncludeCredentials:H.getBool("use_oz_credentials_provider",!1)?d("VideoPlayerOzImplementationEnginePartsImplUtils").checkShouldIncludeCredentials:null,getUserSelectedPlaybackRate:function(){return v.getCurrentState().controlledState.targetPlaybackRate},getVideoDimensions:I,initialPlaybackPositionForDynamicMpd:d("VideoPlayerOzImplementationEnginePartsImplUtils").calculateInitialPlaybackPositionForDynamicMpd(H,(B=t.initialDesiredLatencyMs)!=null?B:0),initialRepresentationIDs:(V=t.initialRepresentationIds)!=null?V:[],isClientTriggeredTraceEnabled:O,liveheadFallBehindBlockMargin:d("VideoPlayerOzImplementationEnginePartsImplUtils").calculateLiveheadFallBehindBlockMargin(H,(A=t.initialDesiredLatencyMs)!=null?A:0),liveheadFallBehindBlockThreshold:d("VideoPlayerOzImplementationEnginePartsImplUtils").calculateLiveheadFallBehindBlockThreshold(H,(m=t.initialDesiredLatencyMs)!=null?m:0,(T=t.initialLatencyToleranceMs)!=null?T:0),loggerConfig:{isOzDevConsoleEnabled:c("gkx")("24356"),observedOperationLoggers:[],perfLoggerProviders:a},mpdUrl:K,networkRequestStreamHandlers:e,networkRequestStreamRetryHandler:ja?function(a,d,e){var f=a.headers,g=f==null?void 0:f.get("x-fb-url-refresh"),i=G.current;if(a.status===403&&i!=null){u.logVPLEvent({eventType:"video_cdn_url_expired",logDataOverrides:{error_user_info:JSON.stringify({expired_url:e})},state:v.getCurrentState()});var j=g!=null&&b("cr:1993377")!=null?{name:"refreshShortExpiryVideoUrl",promise:b("cr:1993377")(g)}:ha!=null?{name:"expiredVideoUrlRefreshHandler",promise:ha(e)}:null;if(j!=null)return j.promise.then(function(a){var b;b=(b=a.refreshedUrl)!=null?b:null;a=(a=a.reason)!=null?a:null;if(b!=null&&b!==""){u.logVPLEvent({eventType:"video_cdn_url_refreshed",logDataOverrides:{error_user_info:JSON.stringify({refresh_handler:j.name,refreshed_url:b})},state:v.getCurrentState()});i.update(b);return d(b)}else{throw c("unrecoverableViolation")(j.name+" refreshedUrl is "+(b===""?"an empty string":"null")+", reason: "+((b=a)!=null?b:"null"),"comet_video_player")}})["catch"](function(a){a=c("getErrorSafe")(a);u.logVPLEvent({eventType:"video_cdn_url_refresh_error",logDataOverrides:{error_description:a.message,error_user_info:JSON.stringify({expired_url:e,refresh_handler:j.name,refresh_url:g})},state:v.getCurrentState()});throw a})}return(h||(h=b("Promise"))).resolve(a)}:null,networkRequestUrlRefreshHandler:S?t.expiredVideoUrlRefreshHandler:null,prefetchCache:H.getBool("use_prefetch_cache",!1)?fa:null,rawMpdXml:s.current?void 0:da,seekHandler:null,setCustomFetchStreamLoggingAttributes:function(a,b,e){a.setIsOnline(c("NetworkStatus").isOnline());var f=e==null?void 0:e.headers;if(f)try{a.setProxyStatusHeader(f.get("proxy-status")),a.setDynamicStatusHeader(f.get("x-fb-dynamic-status"))}catch(a){}d("OzOneSemanticHandlerUtils").setOneSemanticFetchStreamLoggingAttributes(a,b,e)},startTimeStamp:H.getBool("fix_start_timestamp",!1)?t.startTimestamp:0,userPreferenceLang:t.initialAudioUserPreferredLanguage,videoAbrManagerFactory:d("VideoPlayerOzImplementationEnginePartsImplUtils").getVideoAbrManagerFactory(N),videoNode:C,videoPlaybackRestrictions:c("getOzPlaybackRestrictions")(ea,H)};var W=new f(U);y.current=W;x.current&&x.current.attachPerfLoggerProvider(W.getPerfLoggerProvider());R=t.loggingMetaData.playerImplementationInstanceCountRef;R.current++;W.onError(function(a){M&&M.flushQueuedLogs(),ba(a,"oz_player_error")});c("gkx")("24360")&&W.onWarning(function(a){M&&M.flushQueuedLogs();a=d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromOzImplementationError(a,"oz_player_warning");v.dispatch({payload:{warningError:a},type:"implementation_warning"})});W.addListener("switchVideoRepresentation",function(){v.dispatch({payload:{},type:"representation_changed"})});var ka=function(a){if(H.getBool("enable_error_recovery_attempt_logging",!1)){a=d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromOzImplementationError(a,"oz_player_stream_error_retry");v.dispatch({payload:{recoverableError:a},type:"error_recovery_attempt"})}};W.addListener("manifestFetchError",function(a){d("OzOneSemanticHandler").handleManifestFetchErrorEvent(H,a)});W.addListener("manifestFetchErrorRetry",function(a){ka(a)});W.addListener("streamError",function(a){return d("OzOneSemanticHandler").handleStreamErrorEvent(H,a)});W.addListener("streamErrorRetry",function(a){var b;(((b=a.getExtra())==null?void 0:b.mimeType)!=="application"||H.getBool("enable_era_logging_for_application_stream",!0))&&ka(a)});W.addListener("streamInterruptAt",function(){v.dispatch({type:"stream_interrupted"})});W.addListener("streamResumedAt",function(){v.dispatch({type:"stream_resumed"})});W.addListener("streamGoneBeforeStart",function(){Z(),v.dispatch({type:"stream_gone_before_start"})});W.addListener("streamEnd",function(){Z(),v.dispatch({type:"stream_ended"})});W.addListener("videoNodeErrorRetry",function(a){if(H.getBool("enable_error_recovery_attempt_logging",!1)){a=d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromOzImplementationVideoNodeError(a,"oz_player_stream_error_retry");v.dispatch({payload:{recoverableError:a},type:"error_recovery_attempt"})}});W.addListener("enterBuffering",function(a){v.dispatch({payload:{bufferingType:a},type:"buffering_begin_requested"})});W.addListener("leaveBuffering",function(a){v.dispatch({payload:{domEventPerfTimestamp:a.domEventPerfTimestamp},type:"buffering_end_requested"})});n&&n.handleOzPlayerChanged(W,D);var la=function(){var a=p();a={inbandCaptionsAutogeneratedFromManifest:o.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:o.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:a==null?void 0:a.inbandCaptionsExpectedFromProps,representationCaptionsExpectedFromManifest:o.getRepresentationCaptionsExpectedFromManifest(),sideLoadCaptionsExpectedFromProps:a==null?void 0:a.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:a==null?void 0:a.sideLoadCaptionsUrlFromProps};var b=v.getCurrentState();b=b.controlledState;(a.inbandCaptionsExpectedFromManifest!==b.captionsLoaded||a.inbandCaptionsAutogeneratedFromManifest!==b.inbandCaptionsAutogenerated)&&r(a)},ma=function(a,b){a=a.getCustomField("timescale");a=typeof a==="number"?a:0;v.dispatch({payload:{timescale:a,videoBytes:b},type:"cea608_bytes_received"})},na=function(){var a=o.getVideoRepresentations();if(a!=null&&a.length>0){a=a[0].getTimeRanges();if(a!=null&&a.length>0){var b=a[0].startTime;a=Math.max(a[a.length-1].endTime-H.getNumber("live_rewind_seek_to_live_delta",8),b);v.dispatch({payload:{seekableRanges:new(c("TimeRanges"))([{endTime:a,startTime:b}])},type:"seekable_ranges_changed"})}}},oa=function(){var a=W.getMpd();if(!a)return;a=a.getCustomField("loapStreamType");var b=q();typeof a==="number"&&b!=null&&b.setStreamType(a)},X=function(a){if(a!=null){a=d("ConstUriUtils").getUri(a);if(a){a=a.getQueryParam("lvp");return a==="1"}}return!1},pa=function(a){var b=function(){na(),la(),oa()};a.addListener("updated",b);b();var e=[],f=function(a){u.logVPLEvent({eventType:"imf",logDataOverrides:a,state:v.getCurrentState()})},g=function(a,b,c){a=a.parseEmsgBoxesFromMP4Segment;a=a(c,L,b.getID(),C.currentTime,f);a.length>0&&v.dispatch({payload:{emsgBoxes:a},type:"emsg_boxes_parsed"})},h=function(a){var b=e.shift();while(b)g.apply(void 0,[a].concat(b)),b=e.shift()};W.updatePlayerRunTimeConfig({audioStreamDataHandler:function(){var a=v.getCurrentState();if(a.controlledState.emsgObserverTokens.size>0){var b=i.getModuleIfRequireable();for(var d=arguments.length,f=new Array(d),j=0;j<d;j++)f[j]=arguments[j];b!=null?(h(b),g.apply(void 0,[b].concat(f))):(e.push(f),i.load().then(function(a){h(a)})["catch"](function(a){c("FBLogger")("comet_video_player").catching(c("getErrorSafe")(a)).warn("Failed to load VideoPlayerEmsg"),e.length=0}))}},videoStreamDataHandler:ma});if(o.isPredictiveDash()){H.setContext("streaming_implementation","pdash");a=aa();a&&a.maybeUpdateLatencyLevel()}b="mos";a=H.getBool("is_csvqm_enabled",!1);if(a&&!N){a=o.getVideoRepresentations();a=a==null?void 0:a.every(function(a){return a.getQualityScoreCurveString("csvqm")!=null});a===!0&&(b="csvqm")}H.setContext("quality_score_type",b);d("VideoPlayerODS").bumpEntityKey("comet_video_player",b==="csvqm"?"OzImplementation.quality_score_type_csvqm":"OzImplementation.quality_score_type_mos",14);a=p();r({inbandCaptionsAutogeneratedFromManifest:o.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:o.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:a==null?void 0:a.inbandCaptionsExpectedFromProps,representationCaptionsExpectedFromManifest:o.getRepresentationCaptionsExpectedFromManifest(),sideLoadCaptionsExpectedFromProps:a==null?void 0:a.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:a==null?void 0:a.sideLoadCaptionsUrlFromProps})};W.addListener("vttCaptionsUpdated",function(a,b){var c="webvtt",d=v.getCurrentState().controlledState.captionFormat;c!==d&&v.dispatch({payload:{captionFormat:c},type:"controller_set_caption_format_requested"});v.dispatch({payload:{activeCaptions:a,captionsLocale:b},type:"controller_set_active_captions_requested"})});W.addListener("mpdParsed",function(a){o.isPredictiveDash()&&H.setContext("streaming_implementation","pdash")});c("gkx")("24359")?(W.addListener("mpdReady",function(a){E.current=!0,pa(a)}),W.addListener("initialized",function(){v.dispatch({payload:{selectedVideoQuality:o.getUserSelectedVideoQuality()},type:"implementation_engine_initialized"})})):W.addListener("mpdReady",function(a){E.current=!0,pa(a),v.dispatch({payload:{selectedVideoQuality:o.getUserSelectedVideoQuality()},type:"implementation_engine_initialized"})});W.addListener("representationBlocked",function(a){v.dispatch({payload:{blockedRepresentationID:a},type:"implementation_engine_representation_blocked"})});var Y=null;function Z(){c("clearTimeout")(Y);var a=s.current,b=z.current;if(a!=null){s.current=null;z.current=null;w.current=null;try{a&&a.closeHiveSession(),b&&b.logEndSession()}catch(a){b&&b.logHiveError(a)}}}g=s.current;Q=J==null?void 0:J.ticket;if(K!=null&&J&&g&&Q!=null){I=W.getPerfLoggerProvider();I&&I.setIsP2pPlayback(!0);B=K.substring(K.indexOf("?"));V=g.initSession(Q+B,W,C);var $=new(c("Deferred"))();j>0&&(Y=c("setTimeout")(function(){$.reject(new Error("Hive initialization timed out after "+j+"ms"))},j));V.then(function(a){$.resolve(a)})["catch"](function(a){$.reject(a)});$.getPromise().then(function(a){c("clearTimeout")(Y);var b=a.manifest;a=a.tech;var d=z.current;b!==K&&d&&d.logManifestMismatch(b,K);d&&d.logSessionInit(a,b);u.setAdditionalLogData("is_p2p_playback",!0);u.setAdditionalLogData("is_live_preview",X(b));W.load(b)})["catch"](function(a){c("clearTimeout")(Y);var b=z.current;b&&b.logError(a);Z();u.setAdditionalLogData("is_live_preview",X(K));W.load(K)})}else u.setAdditionalLogData("is_p2p_playback",!1),u.setAdditionalLogData("is_live_preview",X(K)),W.load(K)}g.proceedWithOzPlayerCreation=a}),98);
__d("VideoPlayerOzImplementationLatencyLevelManager",[],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$2="normal",this.$4=null,this.$1=a,this.$3=b,this.$6=c}var b=a.prototype;b.updatePlayerFormat=function(a){this.$4!==a&&(this.$4=a,this.maybeUpdateLatencyLevel())};b.updateBroadcastLatencySensitivity=function(a){this.$5!==a&&(this.$5=a,this.maybeUpdateLatencyLevel())};b.maybeUpdateLatencyLevel=function(){var a=this.$7(this.$5);a!==this.$2&&(this.$2=a,this.$1.getBool("set_latency_context_immediately",!1)&&this.$1.setContext("latency_level",a),this.$3.dispatch({payload:{latencyLevel:a,ullIneligibilityReason:this.$8()},type:"implementation_set_latency_level_requested"}))};b.$8=function(){var a=this.$1.getNumber("ultra_low_latency_bandwidth_threshold",0),b=this.$6.getEstimatedBandwidth();return b!==null&&a>0&&b<a?"low_bandwidth_estimate":null};b.$7=function(a){if(a==null)return"normal";switch(a){case 1:return"low";case 2:return this.$8()!==null?this.$1.getBool("fall_back_to_low_latency_in_ull",!1)?"low":"normal":"ultra-low";case 0:return"normal"}};return a}();g["default"]=a}),98);
__d("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay",["requireDeferredForDisplay"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferredForDisplay")("oz-player").__setRef("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay");function a(){return{getModuleIfRequireable:function(){return h.getModuleIfRequireable()||null},load:function(){return h.load()}}}g["default"]=a}),98);
__d("VideoPlayerOzImplementationEngine",["CometDASHPrefetchCacheManager","ErrorMetadata","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationErrors","VideoPlayerImplementationLoadSequenceManager","VideoPlayerODS","VideoPlayerOzImplementationEngineExtrasAPI","VideoPlayerOzImplementationEnginePartsImplFunction","VideoPlayerOzImplementationEnginePartsImplUtils","VideoPlayerOzImplementationLatencyLevelManager","VideoPlayerOzPlayerModuleLoaderDeferredForDisplay","cr:1473549","emptyFunction","err","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";e=!1;var h=c("emptyFunction");function a(a){var e=a.checkInDOM,f=a.debugLogId,g=a.handleFatalError,i=a.initialProps;a=a.setExposedStateInReact;var j={current:null},k={current:null},l={current:null},m={current:null},n={current:null},o={current:null},p={current:null},q={current:null},r={current:null},s={current:null},t={current:null},u={current:null},v={current:null},w={current:null};function x(){var a;return(a=p.current)!=null?a:null}function y(){var a;return(a=o.current)!=null?a:null}function z(){var a;return(a=(a=k.current)==null?void 0:a.experimentationConfig)!=null?a:null}function A(){var a;return(a=Y.current)!=null?a:null}function B(){var a;return(a=v.current)!=null?a:null}var C;b("cr:1473549")&&(C=new(b("cr:1473549"))());var D="comet_oz",E=function(a,b){return b.manifestXmlStringInitial!==null?a.manifestXmlStringInitial!==b.manifestXmlStringInitial:a.manifestUrl!==b.manifestUrl},F=function(a,b){return a.videoFBID!==b.videoFBID},G=function(a){return a.getBool("use_full_player_if_cached",!1)&&c("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay")?c("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay")().getModuleIfRequireable():null},H=function(a,b,c){b!=null?k.current=babelHelpers["extends"]({},a,{manifestXmlStringResolved:b}):k.current=a,X.dispatch({type:"implementation_engine_oz_manifest_downloading"}),n.current=G(a.experimentationConfig),L(n.current,[].concat(c,["proceedWithOzManifestDownloading"]))},I=function(a){var b,e,f,g=a.manifestUrl,h=a.manifest,i=null;c("CometDASHPrefetchCacheManager")&&(a.videoFBID!=null&&(i=c("CometDASHPrefetchCacheManager").get(a.videoFBID)));b={VideoPlayerShakaPerformanceLoggerClass:a.VideoPlayerShakaPerformanceLoggerClass,accessToken:a.loggingMetaData.accessToken,audioOnly:a.audioOnly,experimentationConfig:a.experimentationConfig,graphQLVideoDRMInfo:a.graphQLVideoDRMInfo,graphQLVideoP2PSettings:a.graphQLVideoP2PSettings,initialAudioUserPreferredLanguage:a.initialAudioUserPreferredLanguage,manifestUrl:(b=g)!=null?b:null,manifestXmlStringInitial:(b=h)!=null?b:null,minQualityPreference:a.minQualityPreference,ozPrefetchCache:i,videoFBID:a.videoFBID,videoPlayerShakaPerformanceLoggerBuilder:a.videoPlayerShakaPerformanceLoggerBuilder};i=j.current;e=(e=v.current)!=null?e:new(c("VideoPlayerOzImplementationLatencyLevelManager"))(a.experimentationConfig,X,Q);v.current=e;w.current=(f=a.loggingMetaData.coreVideoPlayerMetaData.playerFormat)!=null?f:null;e.updatePlayerFormat((f=a.loggingMetaData.coreVideoPlayerMetaData.playerFormat)!=null?f:null);e.updateBroadcastLatencySensitivity(a.broadcastLatencySensitivity);f=!1;if(i==null)f=!0;else if(i!=null&&!F(b,i)&&E(b,i)){e=14;d("VideoPlayerODS").bumpEntityKey("OzImplementation","manifest_reloaded",e);f=!1}else if(i!=null&&F(b,i)){var k;e=c("err")("videoFBID changed after player initialization: %s",JSON.stringify({subOrigin:a.loggingMetaData.coreVideoPlayerMetaData.subOrigin,toVideoFBID:b.videoFBID}));e.name="VideoPlayerOzImplementationVideoFBIDChanged";k=(k=e.metadata)!=null?k:new(c("ErrorMetadata"))();i.videoFBID!=null&&k.addEntry("COMET_VIDEO","VIDEO_ID",i.videoFBID);e.metadata=k;e.project="comet_video_player";throw e}if(!f)return!1;g=b.manifestUrl;h=b.manifestXmlStringInitial;if(h==null&&g==null){i=c("err")("Empty manifestXmlStringInitial and manifestUrl: %s",JSON.stringify({manifestUrl:g,manifestXmlStringInitial:h,subOrigin:a.loggingMetaData.coreVideoPlayerMetaData.subOrigin}));i.name="VideoPlayerOzImplementationManifestEmpty";e=(k=i.metadata)!=null?k:new(c("ErrorMetadata"))();b.videoFBID!=null&&e.addEntry("COMET_VIDEO","VIDEO_ID",b.videoFBID);i.metadata=e;i.project="comet_video_player";throw i}j.current=b;H(b,h,["handleVideoInfoChangeForOzImplementation","downloadManifestInOz"]);return!0},J=function(a,b){var d=function(c){if(m.current!==a)return;n.current=c;L(c,[].concat(b,["handleOzPlayerModuleLoadSuccess"]))},e=function(b){if(m.current!==a)return;V(b,"oz_player_module_load_failed")};m.current=a;c("promiseDone")(a,d,e)},K=function(a){a=d("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(a);Y.current=a;return a},L=function(a,b){var e=S(),f=k.current;if(e==null||f==null)return;var g=K(e),h=f.experimentationConfig;a?M(a,e,g,f,[].concat(b,["proceedWithResolvedVideoInfo","OzPlayerModuleFromRef"])):c("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay")?(h.getBool("instantiate_buffering_detector_before_quick_starter",!1)&&d("VideoPlayerOzImplementationEnginePartsImplUtils").createOzBufferingDetector(e,g,f.experimentationConfig,X,p,W),J(c("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay")().load(),[].concat(b,["proceedWithResolvedVideoInfo","VideoPlayerOzPlayerModuleLoaderAsync"]))):V(new Error("Neither of OzPlayerModuleLoader is available."),"oz_player_module_loaders_missing")},M=function(a,b,e,f,g){try{var h={OzPlayerClass:a,callChain:[].concat(g,["proceedWithResolvedVideoInfoAndOzPlayerModuleSync"]),destroyOzPlayerPartsRef:u,engineDebugAPI:C,engineExtrasAPI:Q,getCaptionsInfo:R,getLatencyLevelManager:B,getVideoLiveTrace:T,handleCaptionsInfoChange:U,handleFatalImplementationError:V,initialProps:i,logger:W,machine:X,ozBufferingDetectorRef:p,playerFormatForDPLRef:w,playerVersion:D,resolvedVideoInfo:f,videoElement:b};a=z();g=i.loadSequence;a&&a.getNumber("load_sequence_max_delay_ms",0)>0&&g!=null?t.current=c("VideoPlayerImplementationLoadSequenceManager").schedule(a,g,function(){d("VideoPlayerOzImplementationEnginePartsImplFunction").proceedWithOzPlayerCreation(babelHelpers["extends"]({},h,{hivePluginRef:q,overrideOzRequestImplementationRef:s,ozPlayerRef:o,p2pSessionLoggerRef:r,videoElementAPI:e}));return e.getCanPlayPromise()}):d("VideoPlayerOzImplementationEnginePartsImplFunction").proceedWithOzPlayerCreation(babelHelpers["extends"]({},h,{hivePluginRef:q,overrideOzRequestImplementationRef:s,ozPlayerRef:o,p2pSessionLoggerRef:r,videoElementAPI:e}));l.current=f}catch(a){V(a,"oz_player_create_exception")}};function N(a){var b=u.current;b!=null&&(u.current=null,b(a));t.current!=null&&(t.current(),t.current=null)}function O(){return}function P(){m.current=null,n.current=null}var Q=d("VideoPlayerOzImplementationEngineExtrasAPI").createVideoPlayerOzImplementationEngineExtrasAPI({getConfig:z,getOzPlayer:y,getVideoElementAPI:A});A=d("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({checkInDOM:e,createDebugAPI:function(b){var a=b.getVideoElementAPI;b=b.logger;return C?C.createDebugAPI({engineExtrasAPI:Q,getConfig:function(){var a;return(a=(a=l.current)==null?void 0:a.experimentationConfig)!=null?a:null},getManifest:function(){var a;return(a=(a=l.current)==null?void 0:a.manifestXmlStringResolved)!=null?a:null},getManifestUrl:function(){var a;return(a=(a=l.current)==null?void 0:a.manifestUrl)!=null?a:null},getOzBufferingDetector:x,getOzPlayer:y,getVideoElementAPI:a,logger:b}):null},createVideoPlayerError:d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromOzImplementationError,debugLog:h,debugLogId:f,destroyEngineParts:function(a){N([].concat(a,["destroyEngineParts"])),O(),P()},engineExtrasAPI:Q,engineMetadata:{isAbrEnabled:!0,playerVersion:D,streamingFormat:"dash"},handleFatalError:g,handleVideoElementChanged:function(a,b){a!=null&&L(n.current,[].concat(b,["handleVideoElementMounted"]))},handleVideoInfoChange:I,initialProps:i,setExposedStateInReact:a});e=A.engine;var R=A.getCaptionsInfo,S=A.getVideoElement,T=A.getVideoLiveTrace,U=A.handleCaptionsInfoChange,V=A.handleFatalImplementationError,W=A.logger,X=A.machine,Y=A.videoElementAPIRef;return e}g.createVideoPlayerOzImplementationEngine=a}),98);
__d("VideoPlayerOzImplementationV2.react",["VideoPlayerImplementationEngineAPI","VideoPlayerOzImplementationEngine"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(a,d("VideoPlayerOzImplementationEngine").createVideoPlayerOzImplementationEngine);a=a.reactVideoFrameAndComponents;return a}g["default"]=a}),98);
__d("VideoPlayerProgressiveImplementationData",["err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return/\.mpd(\?|$)/.test(a)}function a(a){var b=a.hdSrc,d=a.hdSrcPreferred;a=a.sdSrc;if(b==null&&a==null){var e=c("err")("both HD and SD browser-native URLs are not available");e.name="VideoImplementationsNoBrowserNativeURLs";return e}if(a==null){e=c("err")("browser-native SD URL is not available");e.name="VideoImplementationsNoBrowserNativeSDURL";return e}e=h(a);var f=b!=null&&h(b);if(e||f){e=c("err")("HD or SD browser-native URL points to a DASH manifest");e.name="VideoImplementationsBrowserNativeURLsPointToDASH";return e}return{hdSrc:b,hdSrcPreferred:d,sdSrc:a}}g.makeProgressiveImplementationData=a}),98);
__d("VideoPlayerProgressiveImplementationEngineExtrasAPI",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a!==null&&a.indexOf(".m3u8")!==-1}function a(a){var b=a.getPlayingVideoInfo;a=a.setUserSelectedVideoQuality;function d(){var a=b(),c="progressive_SD",d="progressive_HD";return a==null?null:h(a.hdSrc)||h(a.sdSrc)?null:a.hdSrc!=null&&a.playingSrc===a.hdSrc?d:a.sdSrc!=null&&a.playingSrc===a.sdSrc?c:null}return{getApproximateFBLSToPlayerDisplayLatency:function(){return null},getAvailableAudioTracks:function(){var a;return(a=(a=b())==null?void 0:a.availableAudioTracks)!=null?a:[]},getAvailableVideoQualities:function(){var a;return(a=(a=b())==null?void 0:a.availableQualities)!=null?a:[]},getAvailableVideoTracks:function(){var a;return(a=(a=b())==null?void 0:a.availableVideoTracks)!=null?a:[]},getCurrentAudioRepresentation:function(){return null},getCurrentPlayingAudioRepresentationID:function(){if(c("gkx")("440"))return d();else return null},getCurrentPlayingAudioTrackID:function(){var a;return(a=(a=b())==null?void 0:a.playingAudioTrackID)!=null?a:null},getCurrentPlayingVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.targetQuality)!=null?a:""},getCurrentPlayingVideoRepresentationID:function(){if(c("gkx")("440"))return d();else return"oep_hd"},getCurrentTargetVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.targetQuality)!=null?a:""},getCurrentVideoRepresentation:function(){return null},getEstimatedBandwidth:function(){return null},getInbandCaptionsAutogeneratedFromManifest:function(){return!1},getInbandCaptionsExpectedFromManifest:function(){return!1},getManifestIdentifier:function(){return null},getMpdValidationErrors:function(){return null},getPerfLoggerProvider:function(){return null},getRepresentationCaptionsExpectedFromManifest:function(){return!1},getStreamType:function(){var a=b();return a==null?"progressive":h(a.hdSrc)||h(a.sdSrc)?"hls":"progressive"},getTargetAudioTrack:function(){return null},getUserSelectedVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.selectedQuality)!=null?a:"notselected"},getUserSelectedVideoVariant:function(){return null},getVideoProjectionType:function(){return"cubemap"},getVideoRepresentations:function(){return null},isDrm:function(){var a;return((a=b())==null?void 0:a.graphQLVideoDRMInfo)!=null},isFBIsLiveTemplated:function(){return!1},isFBMS:function(){return!1},isFBWasLive:function(){return!1},isLiveRewindAvailable:function(){return!1},isMixedCodecManifest:function(){return!1},isPredictiveDash:function(){return!1},setDimensions:function(a){},setEnableLiveheadCatchup:function(){},setLatencyLevel:function(){},setUserSelectedVideoQuality:a,setUserSelectedVideoVariant:function(a){}}}g.createVideoPlayerProgressiveImplementationEngineExtrasAPI=a}),98);
__d("VideoPlayerProgressiveImplementationEngineUtils",[],(function(a,b,c,d,e,f){"use strict";var g="hd",h="sd";function a(a){var b=[];a.sdSrc!=null&&b.push(h);a.hdSrc!=null&&b.push(g);var c=[],d=[],e=a.hdSrcPreferred&&a.hdSrc!=null?g:h;return babelHelpers["extends"]({},a,{availableAudioTracks:c,availableQualities:b,availableVideoTracks:d,playingAudioTrackID:null,playingQuality:null,playingSrc:null,selectedQuality:e,targetQuality:e,targetSrc:null})}function b(a,b){var c=a.hdSrc,d=a.sdSrc,e,f;b==="notselected"||b==="auto"?(e=d!=null?h:c!=null?g:h,f=d!=null?d:c!=null?c:null):b===g&&c!=null?(e=g,f=c):b===h&&d!=null?(e=h,f=d):(e=h,f=null);f===""&&(f=null);return babelHelpers["extends"]({},a,{selectedQuality:b,targetQuality:e,targetSrc:f})}function c(a,b,c){return babelHelpers["extends"]({},a,{playingQuality:b,playingSrc:c})}f.createResolvedVideoInfoProgressive=a;f.updatePlayingVideoInfoProgressiveWithUserSelectedQuality=b;f.updatePlayingVideoInfoProgressiveWithCurrentPlayingQuality=c}),66);
__d("videoUrlUtils",[],(function(a,b,c,d,e,f){"use strict";b=1<<31;var g=~b,h=b+1;function i(a){a=a|0;return Math.max(h,Math.min(a,g))}function j(a){a=Number.parseInt(a,16);return Number.isFinite(a)?new Date(i(a)*1e3):null}function k(){return i(Date.now()/1e3)}var l={OE:"oe"};function m(a){a=a instanceof URL?a.searchParams:new URL(a).searchParams;a=a.get(l.OE);a=a==null?void 0:j(a);return{expirationDate:a}}function a(a){a=m(a);a=a.expirationDate;return a!=null&&a<=new Date(k()*1e3)}f.DEFAULT_UNIXTIME=b;f.MAX_INT=g;f.parseCdnUrlParams=m;f.isCdnUrlExpired=a}),66);
__d("VideoPlayerProgressiveImplementationEngine",["FBLogger","Promise","UserAgent","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationErrors","VideoPlayerODS","VideoPlayerProgressiveImplementationEngineExtrasAPI","VideoPlayerProgressiveImplementationEngineUtils","cr:1473550","cr:1680308","emptyFunction","err","getErrorNameFromMediaErrorCode","getErrorSafe","gkx","promiseDone","unrecoverableViolation","videoUrlUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("emptyFunction");function j(a,b,c){var e=typeof a==="object"&&a!=null&&typeof a.name==="string"?a.name:null;return d("VideoPlayerImplementationErrors").createVideoPlayerErrorFromGenericError(["PROGRESSIVE_JAVASCRIPT_NATIVE",e].filter(Boolean).join("/"),a,b,c)}function a(a){var e=a.checkInDOM,f=a.debugLogId,g=a.handleFatalError,m=a.initialProps;a=a.setExposedStateInReact;var n={current:null},o={current:null},p={current:null},q={current:null},r=function(){var a=x(),e=o.current;if(a==null||e==null)return;a.addEventListener("error",function(){var e=a.error,f=e==null?void 0:e.code,g=c("getErrorNameFromMediaErrorCode")(f);f=e==null?void 0:e.message;var i=f==null||f===""?"Unknown media error":f,j=[],k=f!=null?d("VideoPlayerImplementationErrors").getMoreGranularErrorNameFromHTMLVideoElementErrorMessage(f):null,l=a.src;if(l!==""){var m=null;(h||(h=b("Promise"))).resolve().then(function(){return window.fetch(l)}).then(function(a){var b,c=a.status;b=(b=a.headers.get("Content-Type"))!=null?b:"unknown";i=i+". Fetched video content with Status:"+c+" Content-Type:"+b;m="URL_RESPONSE_HTTP_"+c;if(c<200||c>=300)return a.text().then(function(a){j.push(a.length.toString()),i+=" Body:%s:"+a.substr(0,200)+(a.length>200?"...":"")},function(){})})["catch"](function(a){if(typeof a==="object"&&a!=null&&typeof a.name==="string"&&typeof a.message==="string"){var b;m=(b=m)!=null?b:"URL_RESPONSE_FETCH_FAILED/"+a.name;i=i+". Failed fetching video content with error: "+a.name+" "+a.message}else{m=(b=m)!=null?b:"URL_RESPONSE_FETCH_FAILED";i=i+". Failed fetching video content with unknown error"}})["finally"](function(){var a=c("err").apply(void 0,[i].concat(j));a.name=[g,k,m].filter(Boolean).join("/");z(a,"progressive_implementation_error_with_more_info")})}else{e=c("err").apply(void 0,[i].concat(j));e.name=[g,k,"VIDEO_ELEMENT_SRC_EMPTY"].filter(Boolean).join("/");z(e,"progressive_implementation_error_with_empty_src")}});try{var f=e.audioOnly,g=e.graphQLVideoDRMInfo,i=e.videoFBID;f===!0&&(a.style.display="none");f=g?(f=g.fairplayCert)!=null?f:null:null;if(b("cr:1680308")&&g&&f!=null&&i!=null){q.current=b("cr:1680308").newIfSupported(f,a,i,g.videoLicenseUriMap);if(q.current==null){f=c("err")("Fairplay not supported");z(f,"progressive_player_fairplay_handler_missing")}else q.current.addListener("error",function(a){a=c("err")(a.error);z(a,"progressive_player_fairplay_handler_error")})}var j=d("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(a);B.current=j;p.current=e;i=w();y({inbandCaptionsAutogeneratedFromManifest:u.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:u.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:i==null?void 0:i.inbandCaptionsExpectedFromProps,representationCaptionsExpectedFromManifest:u.getRepresentationCaptionsExpectedFromManifest(),sideLoadCaptionsExpectedFromProps:i==null?void 0:i.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:i==null?void 0:i.sideLoadCaptionsUrlFromProps});A.dispatch({payload:{selectedVideoQuality:u.getUserSelectedVideoQuality(),streamingFormat:u.getStreamType()},type:"implementation_engine_initialized"});g=function(){j.setPlayheadPosition(m.startTimestamp)};c("UserAgent").isBrowser("IE11")?c("promiseDone")(j.getDOMLoadedMetadataPromise().then(g)):g()}catch(a){z(a,"progressive_player_create_exception")}},s=function(a,b){if(b==null)return!0;else if(a.videoFBID!==b.videoFBID){var c=14;d("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.video_fbid_changed",c);return!1}else if(a.hdSrc!==b.hdSrc||a.sdSrc!==b.sdSrc){c=14;d("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.src_changed",c);return!1}else return!1},t=function(a){var b;b={audioOnly:a.audioOnly,graphQLVideoDRMInfo:(b=a.graphQLVideoDRMInfo)!=null?b:null,hdSrc:a.hdSrc===""?null:(b=a.hdSrc)!=null?b:null,hdSrcPreferred:a.hdSrcPreferred,sdSrc:a.sdSrc===""?null:(b=a.sdSrc)!=null?b:null,videoFBID:a.videoFBID};if(!s(b,n.current))return!1;if(b.hdSrc==null&&b.sdSrc==null)throw c("unrecoverableViolation")("Empty hdSrc and sdSrc","comet_video_player");n.current=b;o.current=d("VideoPlayerProgressiveImplementationEngineUtils").createResolvedVideoInfoProgressive(b);r();return!0},u=d("VideoPlayerProgressiveImplementationEngineExtrasAPI").createVideoPlayerProgressiveImplementationEngineExtrasAPI({getPlayingVideoInfo:function(){if(c("gkx")("440")){var a,b=p.current;if(!b)return null;a=(a=B.current)==null?void 0:a.getUnderlyingVideoElement().currentSrc;return babelHelpers["extends"]({},b,{playingSrc:a!=null&&a!==""?a:null})}else return p.current},setUserSelectedVideoQuality:function(a){var b=p.current;if(!b)throw c("unrecoverableViolation")("Attempt to switch quality when playingVideoInfo does not exist","comet_video_player");var e=B.current;if(!e)throw c("unrecoverableViolation")("Attempt to switch quality when videoElementAPI does not exist","comet_video_player");p.current=d("VideoPlayerProgressiveImplementationEngineUtils").updatePlayingVideoInfoProgressiveWithUserSelectedQuality(b,a);var f=p.current.targetSrc;if(f===null){c("FBLogger")("comet_video_player").addMetadata("COMET_VIDEO","VIDEO_ID",m.videoFBID==null?"":String(m.videoFBID)).warn("Received null targetSrc from setUserSelectedVideoQuality, selectedQuality: %s",String(a));return}k(f,m.expiredVideoUrlRefreshHandler).then(function(a){var b;if(((b=p.current)==null?void 0:b.targetSrc)!==f)return;l(e.getUnderlyingVideoElement(),{enableCrossOriginAnonymous:m.enableCrossOriginAnonymous},a);a=(b=A.getCurrentState().uncontrolledState.videoElementPlayheadPosition)!=null?b:0;a>0&&e.setPlayheadPosition(a);A.getCurrentState().controlledState.playbackState==="playing"&&e.play();A.dispatch({payload:{},type:"representation_changed"})})["catch"](function(a){var b;if(((b=p.current)==null?void 0:b.targetSrc)!==f)return;b=c("getErrorSafe")(a);c("FBLogger")("comet_video_player").addMetadata("COMET_VIDEO","VIDEO_ID",m.videoFBID==null?"":String(m.videoFBID)).catching(b).warn("Failed refreshing video URL with original error: %s",String(b))})}}),v=function(){q.current&&(q.current.destroy(),q.current=null)};e=d("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({checkInDOM:e,createDebugAPI:function(a){var c=a.getVideoElementAPI;a=a.logger;return b("cr:1473550")?b("cr:1473550").createVideoPlayerImplementationDebugAPI({engineExtrasAPI:u,getVideoElementAPI:c,logger:a}):null},createVideoPlayerError:function(a,b){return j(a,b,(a=p.current)==null?void 0:a.targetSrc)},debugLog:i,debugLogId:f,destroyEngineParts:function(){v()},engineExtrasAPI:u,engineMetadata:{isAbrEnabled:!1,playerVersion:"comet_progressive",streamingFormat:"progressive"},handleFatalError:g,handleVideoElementChanged:function(a){a!=null&&r()},handleVideoInfoChange:t,initialProps:m,setExposedStateInReact:a});f=e.engine;var w=e.getCaptionsInfo,x=e.getVideoElement,y=e.handleCaptionsInfoChange,z=e.handleFatalImplementationError,A=e.machine,B=e.videoElementAPIRef;return f}function k(a,e){if(c("gkx")("4621")&&e&&d("videoUrlUtils").isCdnUrlExpired(a))return e(a).then(function(a){var d;return(d=a.refreshedUrl)!=null?d:(h||(h=b("Promise"))).reject(c("err")("Failed refreshing URL"+(a.reason!==null?" with reason: "+a.reason:"")))});else return(h||(h=b("Promise"))).resolve(a)}function l(a,b,c){b=b.enableCrossOriginAnonymous;if(c==null||c==="")a.removeAttribute("src");else{var d=a.playbackRate;a.setAttribute("src",c);var e=null;if(b===!0){try{e=new URL(c).origin}catch(a){}e!=null&&location.origin!==e&&a.setAttribute("crossOrigin","anonymous")}a.playbackRate=d}}g.createVideoPlayerProgressiveImplementationEngine=a;g.internal_setHTMLVideoElementSrc=l}),98);
__d("VideoPlayerProgressiveImplementationV2.react",["VideoPlayerImplementationEngineAPI","VideoPlayerProgressiveImplementationEngine"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(a,d("VideoPlayerProgressiveImplementationEngine").createVideoPlayerProgressiveImplementationEngine);a=a.reactVideoFrameAndComponents;return a}g["default"]=a}),98);
__d("VideoPlayerShakaConfigContextProvider",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var b=a.prototype;b.setContext=function(a,b){if(this.$1[a]!==b){var c;this.$1=babelHelpers["extends"]({},this.$1,(c={},c[a]=b,c))}};b.setAllContexts=function(a){this.$1=a};b.getAllContexts=function(){return this.$1};return a}();f["default"]=a}),66);
__d("VideoPlayerShakaConfig",["VideoPlayerContextSensitiveConfigResolver","VideoPlayerShakaConfigContextProvider"],(function(a,b,c,d,e,f,g){var h={};a=function(){function a(a,b,d){this.$1=new(c("VideoPlayerShakaConfigContextProvider"))(),this.$2=b||null,this.$3=new(c("VideoPlayerContextSensitiveConfigResolver"))(d),this.$3.setContexts(a||{}),a&&this.$1.setAllContexts(a)}a.setGlobalOverrideConfig=function(a){h=a};var b=a.prototype;b.setContext=function(a,b){var c=this.$1.getAllContexts();this.$1.setContext(a,b);a=this.$1.getAllContexts();c!==a&&this.$3.setContexts(a)};b.setOverrideConfig=function(a){this.$2=a};b.getBool=function(a,b){a=this.$4(a,b);return typeof a==="boolean"?a:b};b.getNumber=function(a,b){a=this.$4(a,b);return typeof a==="number"?a:b};b.getString=function(a,b){a=this.$4(a,b);return typeof a==="string"?a:b};b.getAllContexts=function(){return this.$1.getAllContexts()};b.$4=function(a,b){if(!!h&&typeof h[a]===typeof b)return h[a];if(typeof this.$3.getValue(a)===typeof b)return this.$3.getValue(a);return!!this.$2&&typeof this.$2[a]===typeof b?this.$2[a]:null};return a}();g["default"]=a}),98);
__d("useDebouncedValue",["clearTimeout","react","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useState;function a(a,b){var d=j(a),e=d[0],f=d[1];i(function(){var d=c("setTimeout")(function(){return f(a)},b);return function(){return c("clearTimeout")(d)}},[a,b]);return e}g["default"]=a}),98);
__d("VideoPlayerSpinner.react",["CometLoadingAnimation.react","gkx","react","stylex","useDebouncedValue"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k=36,l={spinner:{height:"xc9qbxq",start:"xtzzx4i",opacity:"x1hc1fzr",position:"x10l6tqk",top:"xwa60dl",transform:"x11lhmoz",transitionDelay:"x5w5eug",transitionDuration:"x13dflua",transitionProperty:"x19991ni",transitionTimingFunction:"xl405pv",width:"x14qfxbe",$$css:!0},spinnerHidden:{opacity:"xg01cxk",transitionDelay:"x2p8vrm",transitionDuration:"x13dflua",transitionProperty:"x1jl3cmp",transitionTimingFunction:"xl405pv",visibility:"xlshs6z",$$css:!0},spinnerSnappier:{transitionDelay:"x2p8vrm",$$css:!0},spinnerSnappierHidden:{transitionDelay:"x1ahifba",$$css:!0}};function a(a){a=a.isVisible;var b=c("useDebouncedValue")(a,a?200:500);return j.jsx("div",{className:(h||(h=c("stylex")))(l.spinner,c("gkx")("24333")?[l.spinnerSnappier,!a&&l.spinnerHidden,!a&&l.spinnerSnappierHidden]:[!a&&l.spinnerHidden]),children:j.jsx(c("CometLoadingAnimation.react"),{animationPaused:!b,size:k})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerSurface.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");function a(a){a=a.children;return a!=null?a:null}a.displayName=a.name+" [from "+f.id+"]";c=b.memo(a);g["default"]=c}),98);
__d("WebSessionExtender",["WebSession","clearInterval","cr:913","setInterval"],(function(a,b,c,d,e,f,g){"use strict";var h=2e4,i=new Set(),j=null;function a(a,e){e===void 0&&(e="extender"),i.add(a),j==null&&(d("WebSession").extend(Date.now()+h+2e3),j=c("setInterval")(function(){d("WebSession").extend(Date.now()+h+2e3),b("cr:913")&&new(b("cr:913"))().setClientTime(Date.now()).setWebsessionID(d("WebSession").getId()).setReason(e).log()},h))}function e(a){i["delete"](a);a=i.size;a===0&&j!=null&&(c("clearInterval")(j),j=null)}g.subscribe=a;g.unsubscribe=e}),98);
__d("VideoPlayerWebSessionExtender.react",["VideoPlayerHooks","WebSessionExtender","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useEffect,k=b.useId;function a(){var a=(i||(i=d("VideoPlayerHooks"))).usePlaying(),b=k();j(function(){if(a){d("WebSessionExtender").subscribe(b,"video");return function(){d("WebSessionExtender").unsubscribe(b)}}},[a,b]);return null}g["default"]=a}),98);
__d("useVideoPlayerDefaultLoadingIndicatorsLogic",["VideoPlayerHooks"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=(h||(h=d("VideoPlayerHooks"))).useStalling(),b=h.useStreamInterrupted(),c=h.useIsLiveRewindActive();b=b&&!c;c=a;a=b?"live_video_interrupted_overlay":c?"spinner":"none";return{liveVideoInterruptedOverlayVisible:b,loadingIndicatorType:a,spinnerVisible:c}}g["default"]=a}),98);
__d("useVideoPlayerDefaultLoadingIndicators",["CometPlaceholder.react","deferredLoadComponent","once","react","requireDeferred","requireDeferredForDisplay","useVideoPlayerDefaultLoadingIndicatorsLogic"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=c("deferredLoadComponent")(c("requireDeferredForDisplay")("VideoPlayerSpinner.react").__setRef("useVideoPlayerDefaultLoadingIndicators")),k=c("deferredLoadComponent")(c("requireDeferred")("VideoPlayerWithLiveVideoInterruptedOverlay.react").__setRef("useVideoPlayerDefaultLoadingIndicators")),l=c("once")(function(){return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(k,{})})});function a(){var a=c("useVideoPlayerDefaultLoadingIndicatorsLogic")(),b=a.loadingIndicatorType;a=a.spinnerVisible;a=i.jsx(j,{isVisible:a});var d=null;switch(b){case"spinner":d=a;break;case"live_video_interrupted_overlay":d=l();break;case"none":default:d=a}return{loadingIndicatorElement:d,loadingIndicatorType:b}}g["default"]=a}),98);
__d("useVideoPlayerUnifiedCVCProvider",["CvcV3HttpEventFalcoEvent","UnifiedVideoCVCSubscription","VideoPlayerHooks","createVideoStateHook","getPlayerFormatForLogData","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useEffect;b=d("createVideoStateHook").createVideoStateHook(null);var k=b.setterHook;e=d("createVideoStateHook").createVideoStateHook(null);var l=e.setterHook;f=e.valueHook;function a(a){var b=a.disableSubscription,e=a.playerFormat,f=a.subOrigin,g=a.videoFBID,h=(i||(i=d("VideoPlayerHooks"))).useIsLive(),m=i.useIsFullscreen(),n=i.useIsDesktopPictureInPicture(),o=i.useController(),p=k(),q=l();j(function(){if(b===!0){c("CvcV3HttpEventFalcoEvent").log(function(){return{countable_id:g,name:"disable_subscription"}});return}var a=new(c("UnifiedVideoCVCSubscription"))(g,c("getPlayerFormatForLogData")({isDesktopPictureInPicture:n,isFullscreen:m},e),f,o,h,function(a){q(a)});p(a);return function(){a.destroy()}},[n,m,h,b,e,q,p,f,o,g])}b=f;g.useVideoPlayerUnifiedCVCProvider=a;g.useVideoPlayerUnifiedCVCData=b}),98);
__d("VideoPlayerXImplSurface.react",["CoreVideoPlayerAudioClient.react","CoreVideoPlayerAutoplayClient.react","VideoPlayerCaptionsAreaDeferred.react","VideoPlayerIMFMetadataContext","VideoPlayerInteractionOverlay.react","VideoPlayerWebSessionExtender.react","cr:1954434","cr:99","gkx","react","useVideoPlayerDefaultLoadingIndicators","useVideoPlayerUnifiedCVCProvider"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var e=a.children,f=a.disableCVCSubscription,g=a.disableLoadingIndicator;g=g===void 0?!1:g;var h=a.disableLogging,j=a.instreamVideoAdBreaksPlayer,k=a.playerFormat,l=a.subOrigin,m=a.videoFBID,n=a.videoPlayerIMFFromVideoMetadata;a=a.videoPlayerSpherical;d("useVideoPlayerUnifiedCVCProvider").useVideoPlayerUnifiedCVCProvider({disableSubscription:h===!0||f,playerFormat:k,subOrigin:l,videoFBID:m});h=c("useVideoPlayerDefaultLoadingIndicators")();f=h.loadingIndicatorElement;return i.jsxs(d("VideoPlayerIMFMetadataContext").VideoPlayerIMFMetadataContextProvider,{value:(k=n)!=null?k:null,children:[a,g?null:f,c("gkx")("24328")?i.jsx(d("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{}):null,i.jsxs(c("VideoPlayerCaptionsAreaDeferred.react"),{children:[e,j]}),i.jsx(c("CoreVideoPlayerAutoplayClient.react"),{}),i.jsx(c("CoreVideoPlayerAudioClient.react"),{}),b("cr:1954434")?i.jsx(b("cr:1954434"),{}):null,b("cr:99")?i.jsx(b("cr:99"),{subOrigin:l}):null,i.jsx(c("VideoPlayerWebSessionExtender.react"),{})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("normalizeVideoPlayerLoopCount",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){b===void 0&&(b=null);d===void 0&&(d=null);if(a==null){var e;d=((e=b)!=null?e:!1)?(e=d)!=null?e:0:0;d===-1?e=-1:d<0||!Number.isFinite(d)||Math.floor(d)!==d?e=0:d===0&&b===!0?e=-1:e=d}else if(a===-1||a===Number.POSITIVE_INFINITY)e=-1;else if(a<0||!Number.isFinite(a)||Math.floor(a)!==a)throw c("unrecoverableViolation")("Invalid loopingCount: "+a,"comet_video_player");else e=a;return e}g["default"]=a}),98);
__d("VideoPlayerXImpl.react",["CoreVideoPlayerWithComponents.react","VideoPlayerXImplSurface.react","normalizeVideoPlayerLoopCount","react","usePlayerOriginRouteTracePolicy","useRouteProductAttribution"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.children,d=a.disableCVCSubscription;d=d===void 0?!1:d;var e=a.disableLoadingIndicator,f=a.implementations,g=a.instreamVideoAdBreaksPlayer,h=a.portalingEnabled,j=a.portalingFromVideoID,k=a.portalingPlaceMetaData,l=a.portalingRenderPlaceholder,m=a.videoPlayerIMFFromVideoMetadata,n=a.videoPlayerSpherical,o=a.disableLogging,p=a.disableVPLLogging,q=a.enableSNAPL;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","disableCVCSubscription","disableLoadingIndicator","implementations","instreamVideoAdBreaksPlayer","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","portalingRenderPlaceholder","videoPlayerIMFFromVideoMetadata","videoPlayerSpherical","disableLogging","disableVPLLogging","enableSNAPL"]);var r=c("usePlayerOriginRouteTracePolicy")(),s=c("useRouteProductAttribution")();s||(s=a.productAttribution);var t=a.loopCount,u=a.playerFormat,v=a.subOrigin,w=a.videoFBID;t=c("normalizeVideoPlayerLoopCount")(t);return i.jsx(c("CoreVideoPlayerWithComponents.react"),babelHelpers["extends"]({},a,{disableLogging:o,disableVPLLogging:p,enableSNAPL:q,implementations:f,loopCount:t,portalingEnabled:h,portalingFromVideoID:j,portalingPlaceMetaData:k,portalingRenderPlaceholder:l,productAttribution:s,routeTracePolicy:r,children:i.jsx(c("VideoPlayerXImplSurface.react"),{children:b,disableCVCSubscription:d,disableLoadingIndicator:e,disableLogging:o,instreamVideoAdBreaksPlayer:g,playerFormat:u,subOrigin:v,videoFBID:w,videoPlayerIMFFromVideoMetadata:m,videoPlayerSpherical:n})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("getVideoPlayerUserFacingErrorMessageFromError",["fbt","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return c("gkx")("24345")&&a.message.toLowerCase().indexOf("audio_renderer_error")>=0}function j(a){return a.message.indexOf("DEVICE_CERTIFICATE_REVOKED")>=0}function k(a){return a.name.indexOf("VideoImplementationsDashManifestUnsupportedCodecs")>=0||a.name.indexOf("VideoImplementationsMediaSourceUnsupported")>=0}function l(a){return a.name==="OZ_NETWORK"&&a.message.includes("CDN URL expired")}function a(a){var b=null;i(a)?b=h._("__JHASH__32piJ10frlX__JHASH__"):j(a)?b=h._("__JHASH__6MAWOMXczk1__JHASH__"):k(a)?b=h._("__JHASH__EuR8fzpxUQU__JHASH__"):l(a)&&(b=h._("__JHASH__NrJkVWZ6st1__JHASH__"));return b}g["default"]=a}),226);
__d("defaultErrorBoundaryFallback",["VideoPlayerFallbackCover.react","getVideoPlayerUserFacingErrorMessageFromError","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=c("getVideoPlayerUserFacingErrorMessageFromError")(a);return i.jsx(c("VideoPlayerFallbackCover.react"),{debugError:a,message:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerX.react",["VideoPlayerErrorBoundary.react","VideoPlayerXImpl.react","defaultErrorBoundaryFallback","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn;b=b===void 0?!1:b;var d=a.errorBoundaryFallback;a=babelHelpers.objectWithoutPropertiesLoose(a,["doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn","errorBoundaryFallback"]);a=i.jsx(c("VideoPlayerXImpl.react"),babelHelpers["extends"]({VideoPlayerShakaPerformanceLoggerClass:null},a));return b?a:i.jsx(c("VideoPlayerErrorBoundary.react"),{description:"VideoPlayerX",fallback:(b=d)!=null?b:c("defaultErrorBoundaryFallback"),children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("computeAspectRatio",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a!=null&&b!=null&&a!==0&&b!==0?a/b:null}f["default"]=a}),66);
__d("getPolarisOzConfigValues",["PolarisMobileOzConfigDefaults","PolarisUA"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b={},c;({});c=babelHelpers["extends"]({},d("PolarisMobileOzConfigDefaults").defaultBools,d("PolarisMobileOzConfigDefaults").defaultNumbers,d("PolarisMobileOzConfigDefaults").defaultStrings);return babelHelpers["extends"]({},a,b,c)}function i(a){return babelHelpers["extends"]({},a)}function a(){var a={oz_www_use_src_object_for_media_source:!0,oz_www_use_systemic_risk_abr:!0};return d("PolarisUA").isMobile()?h(a):i(a)}g["default"]=a}),98);
__d("shouldUseOzOnPolaris",["InstagramODS","gkx","memoizeWithArgs","polarisManifestHasUnsupportedCodecs"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b;c("gkx")("25417")||(b="oz_player_browser_version_failed");c("polarisManifestHasUnsupportedCodecs")(a)&&(b="oz_player_manifest_has_unsupported_codecs");window.MediaSource||(b="oz_player_media_source_failed");window.fetch||(b="oz_player_no_fetch_failed");window.ReadableStream||(b="oz_player_no_readable_stream_failed");if(b){c("InstagramODS").incr_CAREFUL_WHEN_USE_DYNAMIC_KEY("web.polaris_video_x."+b);return!1}c("InstagramODS").incr("web.polaris_video_x.oz_compatible");return!0}a=c("memoizeWithArgs")(function(a){return h(a)},function(a){return JSON.stringify((a=a)!=null?a:null)});b=a;g["default"]=b}),98);
__d("usePolarisVideoPlayerShakaConfig",["VideoPlayerConnectionQuality","VideoPlayerOzWWWGlobalConfig","VideoPlayerShakaConfig","getPolarisOzConfigValues","gkx","oz-player/networks/OzBandwidthEstimator","react","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a){var b=i(3),e=a.isAd,f=a.isLive;b[0]!==e||b[1]!==f?(a=function(){return new(c("VideoPlayerShakaConfig"))({connection_quality:d("VideoPlayerConnectionQuality").evaluate(function(){return c("oz-player/networks/OzBandwidthEstimator").getBandwidth(c("VideoPlayerOzWWWGlobalConfig"))}),content_category:"general",fbls_tier:"user",is_ad:e===!0,is_latency_sensitive_broadcast:!1,is_live:f===!0,is_spherical:!1,latency_level:"normal",player_format:"inline",servable_via_fmbs:!1,streaming_implementation:"default"},{oz_www_enable_alternative_audio_tracks:c("gkx")("4483"),oz_www_enable_lip_sync_abr_select_quality:c("gkx")("1983")},{contextSensitiveValues:{},staticValues:c("getPolarisOzConfigValues")()})},b[0]=e,b[1]=f,b[2]=a):a=b[2];return c("useStable")(a)}g["default"]=a}),98);
__d("usePolarisOzImplementation",["FBLogger","PolarisLocales","VideoPlayerOzImplementationData","VideoPlayerOzImplementationV2.react","VideoPlayerOzWWWConfig","err","gkx","react","shouldUseOzOnPolaris","usePolarisVideoPlayerShakaConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo;function a(a){var b=a.dashInfo,e=a.isAd;a=a.isLive;var f=c("usePolarisVideoPlayerShakaConfig")({isAd:e,isLive:a}),g=i(function(){return new(c("VideoPlayerOzWWWConfig"))(f)},[f]);e=c("shouldUseOzOnPolaris")(b==null?void 0:b.videoDashManifest);a=c("PolarisLocales").language_code;var h=/([a-zA-Z]{2})/i.exec(a),j=i(function(){return d("VideoPlayerOzImplementationData").makeOzImplementationData({canUseOz:b==null?void 0:b.isDashEligible,dashManifestUrl:b==null?void 0:b.videoDashUrl,dashManifestXmlString:b==null?void 0:b.videoDashManifest,experimentationConfig:g,initialAudioUserPreferredLanguage:c("gkx")("25416")&&h!=null?h[0]:null,minQualityPreference:null})},[h,b==null?void 0:b.isDashEligible,b==null?void 0:b.videoDashManifest,b==null?void 0:b.videoDashUrl,g]);a=i(function(){return j instanceof Error?null:{Component:c("VideoPlayerOzImplementationV2.react"),data:j,typename:"VideoPlayerOzImplementation"}},[j]);if(j instanceof Error)return[null,j];if(j.manifest==null&&j.manifestUrl==null)throw c("FBLogger")("comet_video_player").mustfixThrow("If ozImplementationData exists, it should have either manifest or manifestUrl");return!e||a==null?[null,c("err")("oz player not supported")]:[a,null]}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("PolarisAPILikePost",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("PolarisInstapi").apiPost("/api/v1/web/likes/{media_id}/like/",{path:{media_id:a}})}g.likePost=a}),98);
__d("PolarisAPIPostNotifyGuardianCall",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e="/api/v1/users/notify_guardian_call/";a={guardian_igid:a,reported_category:c,reported_igid:b};return d("PolarisInstapi").apiPost(e,{body:a}).then(function(a){return a.data})}g.postNotifyGuardianCall=a}),98);
__d("PolarisAPISavePost",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("PolarisInstapi").apiPost("/api/v1/web/save/{media_id}/save/",{path:{media_id:a}})}g.savePost=a}),98);
__d("PolarisAPIUnlikePost",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("PolarisInstapi").apiPost("/api/v1/web/likes/{media_id}/unlike/",{path:{media_id:a}})}g.unlikePost=a}),98);
__d("PolarisAPIUnsavePost",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("PolarisInstapi").apiPost("/api/v1/web/save/{media_id}/unsave/",{path:{media_id:a}})}g.unsavePost=a}),98);
__d("PolarisFRXBlockUserFollowupModal.react",["CometPlaceholder.react","I64","IGDSConfirmDialog.react","IGDSGlimmer.react","JSResourceForInteraction","PolarisBlockDialogContainer.react","PolarisFRXWebReportStrings","PolarisGenericStrings","PolarisLinkBuilder","PolarisNavigationUtils","PolarisReactRedux.react","PolarisReportConstants","isStringNullOrEmpty","lazyLoadComponent","polarisRelationshipSelectors.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.c,l=c("lazyLoadComponent")(c("JSResourceForInteraction")("IGDBlockUserDialog.react").__setRef("PolarisFRXBlockUserFollowupModal.react"));function m(a,b){a=a.userToBlock.id;return d("polarisRelationshipSelectors.react").getRelationship(b.relationships,a)}function n(a){a.onClose&&a.onClose()}function a(a){var b=k(24),e;b[0]!==a?(e=function(b){return m(a,b)},b[0]=a,b[1]=e):e=b[1];e=d("PolarisReactRedux.react").useSelector(e);var f=a.isGroupThread,g=a.onClose,h=a.shouldReportAsInstamadillo,q=a.threadKey,r=a.userToBlock,s=a.useSimpleBlockModalWithoutRefresh,t=r.fbidV2,u=r.id;r=r.username;var v=o(a.frxObjectType),w;b[2]!==g?(w=function(){g()},b[2]=g,b[3]=w):w=b[3];w=w;if(v&&r!=null){b[4]===Symbol["for"]("react.memo_cache_sentinel")?(v=j.jsx(c("IGDSGlimmer.react"),{index:0}),b[4]=v):v=b[4];var x;b[5]!==u?(x=(i||(i=d("I64"))).of_string(u),b[5]=u,b[6]=x):x=b[6];f=(f=f)!=null?f:!1;h=(h=h)!=null?h:!1;b[7]!==x||b[8]!==f||b[9]!==w||b[10]!==h||b[11]!==q||b[12]!==r?(v=j.jsx(c("CometPlaceholder.react"),{fallback:v,children:j.jsx(l,{clickPoint:"report",contactID:x,isAfterReport:!0,isBlocked:!1,isGroup:f,onClose:w,shouldReportAsInstamadillo:h,threadKey:q,userName:r})}),b[7]=x,b[8]=f,b[9]=w,b[10]=h,b[11]=q,b[12]=r,b[13]=v):v=b[13];return v}if(!u)return null;if(s===!0){b[14]!==a?(x=j.jsx(p,babelHelpers["extends"]({},a)),b[14]=a,b[15]=x):x=b[15];return x}b[16]!==a?(f=function(){return n(a)},b[16]=a,b[17]=f):f=b[17];b[18]!==t||b[19]!==f||b[20]!==e||b[21]!==u||b[22]!==r?(w=j.jsx(c("PolarisBlockDialogContainer.react"),{fbidV2:t,onClose:f,relationship:e,userId:u,username:r}),b[18]=t,b[19]=f,b[20]=e,b[21]=u,b[22]=r,b[23]=w):w=b[23];return w}function o(a){switch(a){case d("PolarisReportConstants").FRXObjectType.DIRECT_MESSAGE:case d("PolarisReportConstants").FRXObjectType.DIRECT_MESSAGE_THREAD:case d("PolarisReportConstants").FRXObjectType.ENCRYPTED_DIRECT_MESSAGE:return!0;default:return!1}}function p(a){var b=k(18),e=a.userToBlock;e=e.username;var f,g,h,i;b[0]!==e?(g=c("isStringNullOrEmpty")(e)?null:d("PolarisLinkBuilder").buildUserLink(e),f=c("isStringNullOrEmpty")(g),b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=i):(f=b[1],g=b[2],h=b[3],i=b[4]);if(!f){i=d("PolarisGenericStrings").CANCEL_TEXT;b[5]!==g||b[6]!==a?(f={confirmLabel:d("PolarisFRXWebReportStrings").VIEW_PROFILE_BUTTON_TEXT,onConfirm:function(){d("PolarisNavigationUtils").openURLWithFullPageReload(g),n(a)}},b[5]=g,b[6]=a,b[7]=f):f=b[7];h=f}else{i=d("PolarisGenericStrings").CLOSE_TEXT;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(f={},b[8]=f):f=b[8];h=f}f=h;var l=i,m;b[9]!==a?(m=function(){return n(a)},b[9]=a,b[10]=m):m=b[10];var o;b[11]!==e?(o=d("PolarisFRXWebReportStrings").getBlockUserModalTitle(e),b[11]=e,b[12]=o):o=b[12];b[13]!==h||b[14]!==i||b[15]!==m||b[16]!==o?(e=j.jsx(c("IGDSConfirmDialog.react"),babelHelpers["extends"]({},f,{body:d("PolarisFRXWebReportStrings").BLOCK_USER_THROUGH_PROFILE_MODAL_CONTENT,cancelLabel:l,onClose:m,title:o})),b[13]=h,b[14]=i,b[15]=m,b[16]=o,b[17]=e):e=b[17];return e}g["default"]=a}),98);
__d("PolarisFRXNotifyGuardianFollowupModal.react",["IGDSConfirmDialog.react","PolarisFRXWebReportStrings","nullthrows","react","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){a.onClose&&a.onClose()}function l(a,b,c){a.onNotify&&a.onNotify(b,c)}function a(a){var b=i(16),e=c("usePolarisViewer")();e=e==null?void 0:e.guardianId;var f;b[0]!==e?(f=c("nullthrows")(e),b[0]=e,b[1]=f):f=b[1];var g=f;b[2]!==a||b[3]!==g?(e={confirmLabel:d("PolarisFRXWebReportStrings").SEND_BUTTON_TEXT,onConfirm:function(){l(a,!0,g)}},b[2]=a,b[3]=g,b[4]=e):e=b[4];f=e;b[5]!==a.guardianUsername||b[6]!==a.reportedTagTitle||b[7]!==a.reportedUsername?(e=d("PolarisFRXWebReportStrings").getNotifyGuardianModalText(a.guardianUsername,a.reportedTagTitle,a.reportedUsername),b[5]=a.guardianUsername,b[6]=a.reportedTagTitle,b[7]=a.reportedUsername,b[8]=e):e=b[8];var h;b[9]!==a||b[10]!==g?(h=function(){l(a,!1,g),k(a)},b[9]=a,b[10]=g,b[11]=h):h=b[11];var m;b[12]!==f||b[13]!==e||b[14]!==h?(m=j.jsx(c("IGDSConfirmDialog.react"),babelHelpers["extends"]({},f,{body:e,cancelLabel:d("PolarisFRXWebReportStrings").DONT_SEND_BUTTON_TEXT,onClose:h,title:d("PolarisFRXWebReportStrings").NOTIFY_GUARDIAN_MODAL_TITLE_NO_QUESTION})),b[12]=f,b[13]=e,b[14]=h,b[15]=m):m=b[15];return m}g["default"]=a}),98);
__d("PolarisFRXReportBaseScreenModal.react",["cx","IGDSBox.react","IGDSDialog.react","IGDSDialogHeader.react","PolarisFRXWebReportConstants","PolarisFRXWebReportStrings","PolarisUA","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=4,m=4,n=4,o=!1;function a(a,b,c){a=a||{};var e=a.response;a=a.type;if(a===d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.CONFIRMATION)return{headerEnabled:!1};a=e||{};e=a.title;e=(a=e==null?void 0:e.text)!=null?a:d("PolarisFRXWebReportStrings").DEFAULT_MODAL_HEADER_TEXT;return{headerEnabled:!0,onBackButton:c,titleText:e,withBackButton:b}}function p(a){a.onClose&&a.onClose()}function b(a){var b,e=j(8),f=d("PolarisUA").isMobile()?"large":"default";b=(b=a.headerParams.titleText)!=null?b:void 0;var g;e[0]!==a?(g=function(){return p(a)},e[0]=a,e[1]=g):g=e[1];var h;e[2]!==a?(h=k.jsxs("div",{className:"_acgx"+(f==="large"?" _acqj":""),children:[k.jsx(q,babelHelpers["extends"]({},a)),k.jsx(r,babelHelpers["extends"]({},a))]}),e[2]=a,e[3]=h):h=e[3];e[4]!==b||e[5]!==g||e[6]!==h?(f=k.jsx(c("IGDSDialog.react"),{label:b,onClose:g,size:f,testid:void 0,children:h}),e[4]=b,e[5]=g,e[6]=h,e[7]=f):f=e[7];return f}function q(a){var b=j(11),d=a.headerParams,e=d.headerEnabled,f=d.titleText,g=d.onBackButton;d=d.withBackButton;d=d===void 0?o:d;if(!e)return null;b[0]!==d||b[1]!==g?(e=d&&g?{onBack:function(){return g()}}:void 0,b[0]=d,b[1]=g,b[2]=e):e=b[2];d=e;b[3]!==a?(e=function(){return p(a)},b[3]=a,b[4]=e):e=b[4];var h;b[5]!==f?(h=k.jsx(k.Fragment,{children:f}),b[5]=f,b[6]=h):h=b[6];b[7]!==e||b[8]!==d||b[9]!==h?(f=k.jsx(c("IGDSDialogHeader.react"),babelHelpers["extends"]({onClose:e},d,{children:h})),b[7]=e,b[8]=d,b[9]=h,b[10]=f):f=b[10];return f}function r(a){var b=j(5),d=a.children;a=a.disableDefaultBodyPaddingMargin;a=a===void 0?!1:a;var e,f;a?e=f=a=0:(e=l,a=n,f=m);var g;b[0]!==f||b[1]!==a||b[2]!==e||b[3]!==d?(g=k.jsx("div",{className:"_acgy",children:k.jsx("div",{className:"_acgz",children:k.jsx(c("IGDSBox.react"),{marginBottom:f,marginTop:a,paddingX:e,position:"relative",children:d})})}),b[0]=f,b[1]=a,b[2]=e,b[3]=d,b[4]=g):g=b[4];return g}g.DEFAULT_BODY_PADDING_X=l;g.DEFAULT_BODY_MARGIN_BOTTOM=m;g.DEFAULT_BODY_MARGIN_TOP=n;g.getDefaultScreenModalHeaderParamsFromScreenPayload=a;g.FRXReportBaseScreenModal=b}),98);
__d("PolarisFRXReportModalLinkUtils",["URI","polarisIsInternalURIString"],(function(a,b,c,d,e,f,g){"use strict";var h,i="help.instagram.com";function j(a){return c("polarisIsInternalURIString")(a)&&new(h||(h=c("URI")))(a).getDomain()===i}function a(a){return j(a)||!c("polarisIsInternalURIString")(a)}g.shouldLinkUseBlankTarget=a}),98);
__d("PolarisFRXReportMainButton.react",["PolarisFRXReportModalLinkUtils","PolarisIGCoreButton.react","isStringNullOrEmpty","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(13),e=a["data-testid"],f=a.disabled,g=a.href,h=a.onClick,k=a.primaryButton,l=a.spinner;a=a.text;var m;if(!c("isStringNullOrEmpty")(g)&&f!==!0){var n=d("PolarisFRXReportModalLinkUtils").shouldLinkUseBlankTarget(g)?"_blank":void 0,o;b[0]!==g||b[1]!==n?(o={href:g,target:n},b[0]=g,b[1]=n,b[2]=o):o=b[2];m=o}n=((g=k)!=null?g:!0)?"ig-primary-button":"ig-secondary-button";o=!!f;k=!!l;b[3]!==h?(g=function(){return h&&h()},b[3]=h,b[4]=g):g=b[4];b[5]!==m||b[6]!==n||b[7]!==e||b[8]!==o||b[9]!==k||b[10]!==g||b[11]!==a?(f=j.jsx(c("PolarisIGCoreButton.react"),babelHelpers["extends"]({},m,{color:n,"data-testid":void 0,disabled:o,loading:k,onClick:g,children:a})),b[5]=m,b[6]=n,b[7]=e,b[8]=o,b[9]=k,b[10]=g,b[11]=a,b[12]=f):f=b[12];return f}g["default"]=a}),98);
__d("PolarisFRXReportModalOptionList.react",["cx","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(4),c=a.asRadio;a=a.children;c=c===void 0?!1:c;var d="_ac7r";if(c){b[0]!==a?(c=k.jsx("fieldset",{className:d,children:a}),b[0]=a,b[1]=c):c=b[1];return c}b[2]!==a?(c=k.jsx("div",{className:d,role:"list",children:a}),b[2]=a,b[3]=c):c=b[3];return c}g["default"]=a}),98);
__d("PolarisFRXReportModalRichTextRenderer.react",["IGDSText.react","PolarisFRXReportModalLinkUtils","PolarisFastLink.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k={BOLD:1,CODE:8,ITALIC:2,NONE:0,QUOTE:128,STRIKETHROUGH:16,SUBSCRIPT:32,SUPERSCRIPT:64,UNDERLINE:4},l={"#000000":"web-always-black","#00376B":"ig-link","#0095F6":"ig-primary-button","#262626":"ig-primary-text","#58C322":"DEPRECATED_green","#8E8E8E":"ig-secondary-text","#c7c7c7":"ig-tertiary-text","#ed4956":"ig-error-or-destructive","#ffffff":"web-always-white"};function a(a){var b=i(20),e=a.children,f=a.className,g=a.color,h=a["data-testid"],m=a.href,n=a.onClick;a=a.style;var o=e,p=m!==""&&m!=null,q;!p&&g!=null&&(q=g in l?l[g]:void 0);if(a!=null&&(g!=null||p))bb0:switch(a){case k.BOLD:b[0]!==q||b[1]!==e?(g=j.jsx(c("IGDSText.react").BodyEmphasized,{color:q,children:e}),b[0]=q,b[1]=e,b[2]=g):g=b[2];o=g;break bb0;case k.SUBSCRIPT:b[3]!==q||b[4]!==e?(p=j.jsx(c("IGDSText.react").Body2,{color:q,children:e}),b[3]=q,b[4]=e,b[5]=p):p=b[5];o=p;break bb0;default:b[6]!==q||b[7]!==e?(a=j.jsx(c("IGDSText.react").Body,{color:q,children:e}),b[6]=q,b[7]=e,b[8]=a):a=b[8];o=a}if(m!==""&&m!=null){b[9]!==n?(g=function(){return n&&n()},b[9]=n,b[10]=g):g=b[10];p=d("PolarisFRXReportModalLinkUtils").shouldLinkUseBlankTarget(m)?"_blank":void 0;b[11]!==f||b[12]!==h||b[13]!==m||b[14]!==g||b[15]!==p||b[16]!==o?(e=j.jsx(c("PolarisFastLink.react"),{className:f,"data-testid":void 0,href:m,onClick:g,target:p,children:o}),b[11]=f,b[12]=h,b[13]=m,b[14]=g,b[15]=p,b[16]=o,b[17]=e):e=b[17];return e}b[18]!==o?(a=j.jsx(j.Fragment,{children:o}),b[18]=o,b[19]=a):a=b[19];return a}g["default"]=a}),98);
__d("PolarisFRXReportModalOptionListItem.react",["cx","fbt","IGDSBox.react","IGDSChevronIcon.react","IGDSRadioButton.react","IGDSSpinner.react","PolarisFRXReportModalRichTextRenderer.react","isStringNullOrEmpty","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=(j||(j=d("react"))).c,l=j,m={BUTTON:"button",LINK:"link",RADIO:"radio"},n={DEFAULT:"default",GREY:"grey",RED:"red"},o=4;function p(a){a.onSelect&&a.onSelect()}function q(a){a=a.href;return c("isStringNullOrEmpty")(a)?m.BUTTON:m.LINK}function a(a){var b=k(37),d=a.children,e=a["data-testid"],f=a.href,g=a.variant,h=a.textColor,i=a.disabled;g=g===void 0?q(a):g;h=h===void 0?n.DEFAULT:h;var j=g===m.RADIO;d=d;if(!j){var s;b[0]!==d?(s=l.jsx(c("IGDSBox.react"),{flex:"grow",position:"relative",children:d}),b[0]=d,b[1]=s):s=b[1];var t;b[2]!==i||b[3]!==a?(t=i!==!0&&l.jsx(r,babelHelpers["extends"]({},a)),b[2]=i,b[3]=a,b[4]=t):t=b[4];var u;b[5]!==s||b[6]!==t?(u=l.jsxs(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",direction:"row",padding:o,position:"relative",children:[s,t]}),b[5]=s,b[6]=t,b[7]=u):u=b[7];d=u}s="_abn2"+(h===n.RED?" _abn3":"")+(h===n.GREY?" _abn4":"");if(j){t=a.selected;u=a.value;h=u===void 0?"":u;b[8]!==s||b[9]!==d?(j=l.jsx("div",{className:s,children:d}),b[8]=s,b[9]=d,b[10]=j):j=b[10];b[11]!==a?(u=function(){return p(a)},b[11]=a,b[12]=u):u=b[12];var v;b[13]!==t||b[14]!==j||b[15]!==u||b[16]!==h?(v=l.jsx(c("IGDSRadioButton.react"),{isChecked:t,label:j,onChange:u,value:h}),b[13]=t,b[14]=j,b[15]=u,b[16]=h,b[17]=v):v=b[17];b[18]!==e||b[19]!==v?(t=l.jsx(c("IGDSBox.react"),{"data-testid":void 0,padding:o,children:v}),b[18]=e,b[19]=v,b[20]=t):t=b[20];return t}else if(g===m.LINK&&f!=null&&f!==""){b[21]!==a?(j=function(){return p(a)},b[21]=a,b[22]=j):j=b[22];b[23]!==s||b[24]!==e||b[25]!==f||b[26]!==j||b[27]!==d?(u=l.jsx(c("PolarisFRXReportModalRichTextRenderer.react"),{className:s,"data-testid":void 0,href:f,onClick:j,children:d}),b[23]=s,b[24]=e,b[25]=f,b[26]=j,b[27]=d,b[28]=u):u=b[28];return u}b[29]!==a?(h=function(){return p(a)},b[29]=a,b[30]=h):h=b[30];b[31]!==s||b[32]!==e||b[33]!==i||b[34]!==h||b[35]!==d?(v=l.jsx("button",{className:s,"data-testid":void 0,disabled:i,onClick:h,children:d}),b[31]=s,b[32]=e,b[33]=i,b[34]=h,b[35]=d,b[36]=v):v=b[36];return v}function r(a){var b=k(4);a=a.loading;if(a===!0){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=l.jsx(c("IGDSSpinner.react"),{size:"small"}),b[0]=a):a=b[0];a=a}else{var d;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(d=l.jsx(c("IGDSChevronIcon.react"),{alt:i._("__JHASH__KmLwDGth6wW__JHASH__"),color:"ig-tertiary-text",direction:"next",size:17}),b[1]=d):d=b[1];a=d}b[2]!==a?(d=l.jsx(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",direction:"row",marginStart:2,position:"relative",children:a}),b[2]=a,b[3]=d):d=b[3];return d}g.OPTION_LIST_ITEM_VARIANTS=m;g.OPTION_LIST_ITEM_TEXT_COLORS=n;g.FRXReportModalOptionListItem=a}),226);
__d("polarisGetGuardianInfo",["normalizr"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("normalizr").schema.Entity)("userInfo",{},{idAttribute:function(a){return String(a.pk)},processStrategy:function(a){return{username:a.username}}});function a(a){return d("normalizr").normalize(a,h).entities.userInfo}g["default"]=a}),98);
__d("PolarisFRXWebReportActions",["JSResourceForInteraction","PolarisAPIPostNotifyGuardianCall","PolarisDirectLogger","PolarisFRXWebReportConstants","PolarisInstapi","PolarisReportConstants","polarisGetGuardianInfo","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=1,i=c("JSResourceForInteraction")("PolarisFRXWebSendSecureReportAction").__setRef("PolarisFRXWebReportActions");function a(a){a=babelHelpers["extends"]({},a,{frx_prompt_request_type:d("PolarisFRXWebReportConstants").FRX_SCREEN_INPUT_REQUEST_TYPE_INTS.START});return k(a,!0)}function b(a){var b=a.frxPromptRequestType,c=a.metadata,d=j(a);c=babelHelpers["extends"]({},c,d,{frx_prompt_request_type:b});return k(c,!1,(d=a.optionalParams)==null?void 0:d.thread_id,(b=a.optionalParams)==null?void 0:b.responsible_id)}function j(a){var b=a.context;a=a.optionalParams;var c=a.attachments,d=a.evidenceText,e=a.reportSubtype,f=a.selectedPromptButtonActionType,g=a.selectedTagTypes,h=a.selectedVictimID;a=a.tipNumber;var i={};b!=null&&(i.context=b);g!=null&&(i.selected_tag_types=JSON.stringify(g));f!=null&&(i.action_type=f);h!=null&&(i.victim_user_id=h);a!=null&&(i.tip_number=a);c!=null&&(i.attachments=c);d!=null&&(i.evidence_text=d);e!=null&&(i.report_subtype=e);return babelHelpers["extends"]({},i)}function k(a,b,e,f){return function(g,j){var k=h++;g({frxScreenRequestID:k,isInitScreen:b,type:"FRX_WEB_REPORT_SCREEN_API_REQUESTED"});j=d("PolarisInstapi").apiPost("/api/v1/web/reports/get_frx_prompt/",{body:a}).then(function(a){return a.data});j.then(function(b){var h=b.response;b=b.type;if(h==null||b==null)g({frxScreenRequestID:k,type:"FRX_WEB_REPORT_SCREEN_API_REQUEST_FAILED"});else{var j=h.frx_context;[d("PolarisReportConstants").FRXLocation.ENCRYPTED_DIRECT_MESSAGE,d("PolarisReportConstants").FRXLocation.ENCRYPTED_DIRECT_THREAD].includes(a.location)&&a.frx_prompt_request_type===d("PolarisFRXWebReportConstants").FRX_SCREEN_INPUT_REQUEST_TYPE_INTS.POLICY_EDUCATION&&f!==void 0&&e!==void 0&&j!==void 0&&c("promiseDone")(i.load().then(function(b){g(b(j,f,e,a.victim_user_id,a.location===d("PolarisReportConstants").FRXLocation.ENCRYPTED_DIRECT_MESSAGE?a.object_id:void 0))}));g({frxScreenRequestID:k,screenPayload:{frxScreenRequestID:k,response:h,type:b},type:"FRX_WEB_REPORT_SCREEN_API_REQUEST_SUCCESS"})}})["catch"](function(){g({frxScreenRequestID:k,type:"FRX_WEB_REPORT_SCREEN_API_REQUEST_FAILED"})})}}function e(a,b,c,e){return function(f,g){f({type:"FRX_WEB_NOTIFY_GUARDIAN_FOLLOWUP_MODAL_TO_CONFIMATION_MODAL"}),a&&d("PolarisAPIPostNotifyGuardianCall").postNotifyGuardianCall(b,c,e)["catch"](function(a){var b=new(d("PolarisDirectLogger").DirectLogger)("DirectActions");b.logError("Notify Guardian From Web",a)})}}function f(a){return babelHelpers["extends"]({type:"FRX_WEB_REPORT_REPORTING_MODAL_CLOSED"},a)}function l(){return{type:"FRX_WEB_REPORT_GO_BACK_ONE_SCREEN"}}function m(){return{type:"FRX_WEB_REPORT_START_UNFOLLOW_FOLLOWUP"}}function n(){return{type:"FRX_WEB_REPORT_START_BLOCK_FOLLOWUP"}}function o(){return{type:"FRX_WEB_REPORT_START_NOTIFY_GUARDIAN_FOLLOWUP"}}function p(){return function(a,b){a({type:"FRX_WEB_REPORT_DISABLE_NOTIFY_GUARDIAN_OPTION"})}}function q(a){return function(b,e){d("PolarisInstapi").apiGet("/api/v1/users/{user_id}/info/",{path:{user_id:a}}).then(function(d){d=d.data.user;d&&b({guardian:c("polarisGetGuardianInfo")(d)[a],type:"FRX_WEB_REPORT_STORE_GUARDIAN_INFORMATION"})})}}function r(a){return function(b,c){b({reportedTagTitle:a,type:"FRX_WEB_REPORT_STORE_REPORTED_TAG_TITLE"})}}g.doRequestInitFRXScreenAction=a;g.doRequestNextFRXScreenAction=b;g.doOpenNotifyGuardianFollowupModalToPreviousScreenAction=e;g.doReportingModalClosedAction=f;g.doGoBackOneFRXScreenAction=l;g.doStartUnfollowFollowupAction=m;g.doStartBlockFollowupAction=n;g.doStartNotifyGuardianFollowupAction=o;g.doDisableNotifyGuardianOption=p;g.doStoreGuardianInformation=q;g.doStoreReportedTagTitle=r}),98);
__d("PolarisFRXWebReportStateSelectors",["PolarisFRXWebReportConstants","PolarisFRXWebReportUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.webFRXReport.pendingFRXScreenRequestID!==null}function h(a){return a.webFRXReport.screenHistoryStack}function b(a){return d("PolarisFRXWebReportUtils").getCurrentScreenFromHistoryStack(h(a))}function c(a){return h(a).length}function e(a){a=h(a);return a.findIndex(function(a){return a.type===d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.CONFIRMATION})>=0}function f(a){return a.webFRXReport.currRenderStep}function i(a){return a.webFRXReport.disableNotifyGuardianOption}function j(a){return a.webFRXReport.guardianUsername}function k(a){return a.webFRXReport.reportedTagTitle}g.getIsFRXScreenRequestProcessing=a;g.getCurrScreenPayload=b;g.getScreenHistorySize=c;g.getIsConfirmationScreenInHistoryStack=e;g.getCurrRenderStep=f;g.getDisableNotifyGuardianOption=i;g.getGuardianUsername=j;g.getReportedTagTitle=k}),98);
__d("PolarisFRXReportModalFollowUpActionSection.react",["IGDSBox.react","IGDSText.react","PolarisFRXReportModalOptionList.react","PolarisFRXReportModalOptionListItem.react","PolarisFRXWebReportActions","PolarisFRXWebReportStateSelectors","PolarisFRXWebReportStrings","PolarisReactRedux.react","PolarisReportConstants","gkx","isStringNullOrEmpty","polarisRelationshipSelectors.react","react","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a,b){a=a.reportedOwner.id;return d("polarisRelationshipSelectors.react").getRelationship(b.relationships,a)}function l(a,b){a=a.onSelectFollowupAction;a&&a(b)}var m=c("gkx")("4760");function a(a){var b=i(19),e=a.followUpActions,f;b[0]!==a?(f=function(b){return d("polarisRelationshipSelectors.react").followedByViewer(k(a,b))},b[0]=a,b[1]=f):f=b[1];var g=d("PolarisReactRedux.react").useSelector(f);b[2]!==a?(f=function(b){return d("polarisRelationshipSelectors.react").isBlockedByViewer(k(a,b))},b[2]=a,b[3]=f):f=b[3];var h=d("PolarisReactRedux.react").useSelector(f),r=c("usePolarisViewer")();if(b[4]!==a||b[5]!==g||b[6]!==h||b[7]!==r||b[8]!==e){b[10]!==a||b[11]!==g||b[12]!==h||b[13]!==r?(f=function(b,c){var e=b.action_type,f=b.beta_redirect_uri,i=b.name;if(e==null)return null;i=i==null?void 0:i.text;var k=function(){return l(a,b)};c="followup-"+c;switch(e){case d("PolarisReportConstants").FRXActionType.LEARN_MORE_ADS:case d("PolarisReportConstants").FRXActionType.LEARN_MORE_EDUCATION:case d("PolarisReportConstants").FRXActionType.OPEN_CROWDTANGLE:case d("PolarisReportConstants").FRXActionType.SELF_INJURY_EDUCATION_ACTION:case d("PolarisReportConstants").FRXActionType.EATING_DISORDER_EDUCATION_ACTION:return i==null||i===""||f==null||f===""?null:j.jsx(d("PolarisFRXReportModalOptionListItem.react").FRXReportModalOptionListItem,{href:f,onSelect:k,children:i},c);case d("PolarisReportConstants").FRXActionType.UNFOLLOW:return!g?null:j.jsx(o,{labelText:i,onSelect:k},c);case d("PolarisReportConstants").FRXActionType.BLOCK_ACTOR:return h?null:j.jsx(p,{labelText:i,onSelect:k},c);case d("PolarisReportConstants").FRXActionType.NOTIFY_GUARDIAN:return(r==null?void 0:r.isSupervisedUser)!==!0?null:j.jsx(q,{labelText:i,onSelect:k},c);default:return null}},b[10]=a,b[11]=g,b[12]=h,b[13]=r,b[14]=f):f=b[14];f=e.map(f).filter(n);b[4]=a;b[5]=g;b[6]=h;b[7]=r;b[8]=e;b[9]=f}else f=b[9];e=f;if(e.length===0)return null;var s;b[15]===Symbol["for"]("react.memo_cache_sentinel")?(f=j.jsx(c("IGDSBox.react"),{marginTop:11,position:"relative"}),s=m&&j.jsx(c("IGDSBox.react"),{marginBottom:4,paddingX:4,children:j.jsx(c("IGDSText.react").BodyEmphasized,{children:d("PolarisFRXWebReportStrings").CONFIRMATION_MODAL_OTHER_STEPS_HEADER_TEXT})}),b[15]=f,b[16]=s):(f=b[15],s=b[16]);b[17]!==e?(f=j.jsxs(j.Fragment,{children:[f,s,j.jsx(c("PolarisFRXReportModalOptionList.react"),{children:e})]}),b[17]=e,b[18]=f):f=b[18];return f}function n(a){return a!=null}function o(a){var b=i(6),e=a.labelText,f=a.onSelect;a=c("isStringNullOrEmpty")(e)?d("PolarisFRXWebReportStrings").DEFAULT_UNFOLLOW_BUTTON_TEXT:e;var g=d("PolarisReactRedux.react").useDispatch();b[0]!==f||b[1]!==g?(e=function(){f(),g(d("PolarisFRXWebReportActions").doStartUnfollowFollowupAction())},b[0]=f,b[1]=g,b[2]=e):e=b[2];var h;b[3]!==e||b[4]!==a?(h=j.jsx(d("PolarisFRXReportModalOptionListItem.react").FRXReportModalOptionListItem,{onSelect:e,children:a}),b[3]=e,b[4]=a,b[5]=h):h=b[5];return h}function p(a){var b=i(6),e=a.labelText,f=a.onSelect;a=c("isStringNullOrEmpty")(e)?d("PolarisFRXWebReportStrings").DEFAULT_BLOCK_BUTTON_TEXT:e;var g=d("PolarisReactRedux.react").useDispatch();b[0]!==f||b[1]!==g?(e=function(){f(),g(d("PolarisFRXWebReportActions").doStartBlockFollowupAction())},b[0]=f,b[1]=g,b[2]=e):e=b[2];var h;b[3]!==e||b[4]!==a?(h=j.jsx(d("PolarisFRXReportModalOptionListItem.react").FRXReportModalOptionListItem,{onSelect:e,textColor:m?d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_TEXT_COLORS.DEFAULT:d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_TEXT_COLORS.RED,children:a}),b[3]=e,b[4]=a,b[5]=h):h=b[5];return h}function q(a){var b=i(8),e=a.labelText,f=a.onSelect;a=c("isStringNullOrEmpty")(e)?d("PolarisFRXWebReportStrings").DEFAULT_NOTIFY_GUARDIAN_BUTTON_TEXT:e;var g=d("PolarisReactRedux.react").useDispatch();e=d("PolarisReactRedux.react").useSelector(d("PolarisFRXWebReportStateSelectors").getDisableNotifyGuardianOption);var h=e===!0?d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_TEXT_COLORS.GREY:d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_TEXT_COLORS.DEFAULT,k;b[0]!==f||b[1]!==g?(k=function(){f(),g(d("PolarisFRXWebReportActions").doStartNotifyGuardianFollowupAction())},b[0]=f,b[1]=g,b[2]=k):k=b[2];var l;b[3]!==e||b[4]!==k||b[5]!==h||b[6]!==a?(l=j.jsx(d("PolarisFRXReportModalOptionListItem.react").FRXReportModalOptionListItem,{disabled:e,onSelect:k,textColor:h,children:a}),b[3]=e,b[4]=k,b[5]=h,b[6]=a,b[7]=l):l=b[7];return l}g["default"]=a}),98);
__d("PolarisTextWithEntities.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a,b){return a.offset===b.offset&&(a.length===0||b.length===0)?a.length-b.length:a.offset-b.offset}function l(a){return[].concat(a.ranges).filter(Boolean).sort(k)}function a(a){var b=i(4);if(b[0]!==a){var c=0,d=[],e=a.text,f=l(a),g=[],h=[];for(var k=0;k<f.length;k++)g.push(f[k].offset),h.push(f[k].offset+f[k].length);k=[];var m=0;while(m<f.length){var n=f[m];if(h[m]<c){m=k.length>0?k.pop():m+1;continue}if(n.offset>c){var o=e.substring(c,n.offset);d.push(j.jsx(j.Fragment,{children:o},o+m));c=n.offset}o=0;for(var p=m+1;p<f.length;p++)if(g[p]<h[m]&&g[p]>=c){o=p;break}if(o!==0){p=e.substring(c,g[o]);d.push(j.jsx(j.Fragment,{children:a.rangeRenderer(p,n)},p+m));c=g[o];k.push(m);m=o;continue}p=e.substring(c,h[m]);d.push(j.jsx(j.Fragment,{children:a.rangeRenderer(p,n)},p+m));c=h[m];k.length>0?m=k.pop():m++}if(e.length>c){o=e.substr(c);b[2]!==o?(n=j.jsx(j.Fragment,{children:o},o),b[2]=o,b[3]=n):n=b[3];d.push(n)}p=a.textRenderer(d);b[0]=a;b[1]=p}else p=b[1];return p}g["default"]=a}),98);
__d("PolarisFRXReportModalRichText.react",["PolarisFRXReportModalRichTextRenderer.react","PolarisTextWithEntities.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){a=a.token;if(!a)return null;var b=a.color,c=a.style,d=a.uri;b==null&&(b=a["3"]);c==null&&(c=a["1"]);(d===""||d==null)&&(d=a["2"]);c!=null&&(c=parseInt(c,10));return{color:b,style:c,uri:d}}function l(a){if(!a)return[];var b=[];a.forEach(function(a){var c=a.length,d=a.offset;a=k(a)||{};var e=a.color,f=a.style;a=a.uri;c!=null&&d!=null&&(a!=null||e!=null||f!=null)&&b.push({color:e,length:c,offset:d,override_uri:a,style:f})});return b}function m(a,b){var d=b.color,e=b.override_uri;b=b.style;return j.jsx(c("PolarisFRXReportModalRichTextRenderer.react"),{color:d,href:e,style:b,children:a})}m.displayName=m.name+" [from "+f.id+"]";function a(a){var b=i(5);a=a.richText;if(a==null)return null;var d=a.markup;a=a.text;if(a==null)return null;var e;b[0]!==d?(e=l(d),b[0]=d,b[1]=e):e=b[1];b[2]!==e||b[3]!==a?(d=j.jsx(c("PolarisTextWithEntities.react"),{rangeRenderer:m,ranges:e,text:a,textRenderer:n}),b[2]=e,b[3]=a,b[4]=d):d=b[4];return d}function n(a){return j.jsx(j.Fragment,{children:a})}g["default"]=a}),98);
__d("PolarisFRXWebReportAPIUtils",["PolarisInstapi","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("PolarisInstapi").apiPost("/api/v1/web/reports/log_tag_selected/",{body:a})["catch"](c("emptyFunction"))}function b(a){d("PolarisInstapi").apiPost("/api/v1/web/reports/handle_guided_action/",{body:a})["catch"](c("emptyFunction"))}g.logFRXTagSelected=a;g.handleFRXGuidedAction=b}),98);
__d("PolarisFRXReportConfirmationScreenModalForSupervision.react",["IGDSBox.react","IGDSCircleCheckPanoOutlineIcon.react","IGDSText.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportMainButton.react","PolarisFRXReportModalFollowUpActionSection.react","PolarisFRXReportModalRichText.react","PolarisFRXWebReportAPIUtils","PolarisFRXWebReportStrings","PolarisGenericStrings","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a,b){b=b.action_type;if(b==null)return;a=a.screenPayload.response;d("PolarisFRXWebReportAPIUtils").handleFRXGuidedAction({action_type:b,context:a==null?void 0:a.context})}function a(a){var b=i(13),e=a.headerParams,f=a.onClose,g;b[0]!==f?(g=function(){return f&&f()},b[0]=f,b[1]=g):g=b[1];g=g;var h,k;b[2]!==a?(h=j.jsx(l,babelHelpers["extends"]({},a)),k=j.jsx(m,babelHelpers["extends"]({},a)),b[2]=a,b[3]=h,b[4]=k):(h=b[3],k=b[4]);b[5]!==g?(a=j.jsx(c("IGDSBox.react"),{marginBottom:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_BOTTOM,marginTop:4,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("PolarisFRXReportMainButton.react"),{onClick:g,text:d("PolarisGenericStrings").CLOSE_TEXT})}),b[5]=g,b[6]=a):a=b[6];var n;b[7]!==e||b[8]!==g||b[9]!==h||b[10]!==k||b[11]!==a?(n=j.jsxs(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{disableDefaultBodyPaddingMargin:!0,headerParams:e,onClose:g,children:[h,k,a]}),b[7]=e,b[8]=g,b[9]=h,b[10]=k,b[11]=a,b[12]=n):n=b[12];return n}function l(a){var b=i(14);a=a.screenPayload;var e;b[0]!==a?(e=a||{},b[0]=a,b[1]=e):e=b[1];a=e;e=a.response;b[2]!==e?(a=e||{},b[2]=e,b[3]=a):a=b[3];e=a;a=e.follow_up_actions_title;e=e.subtitle;var f;b[4]!==e?(f=e?j.jsx(c("IGDSBox.react"),{marginTop:6,position:"relative",children:j.jsx(c("IGDSText.react").Section,{textAlign:"center",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:e})})}):null,b[4]=e,b[5]=f):f=b[5];e=f;f=null;if(a){var g;b[6]!==a?(g=j.jsx(c("IGDSText.react").Body,{color:"secondaryText",textAlign:"center",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})}),b[6]=a,b[7]=g):g=b[7];f=g;if(e){b[8]!==f?(a=j.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:f}),b[8]=f,b[9]=a):a=b[9];f=a}}b[10]===Symbol["for"]("react.memo_cache_sentinel")?(g=j.jsx(c("IGDSCircleCheckPanoOutlineIcon.react"),{alt:d("PolarisFRXWebReportStrings").CHECKMARK_ICON_ALT_TEXT,color:"ig-success",size:48}),b[10]=g):g=b[10];b[11]!==e||b[12]!==f?(a=j.jsx(c("IGDSBox.react"),{marginTop:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_TOP,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsxs(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",marginTop:6,position:"relative",children:[g,e,f]})}),b[11]=e,b[12]=f,b[13]=a):a=b[13];return a}function m(a){var b=i(6),d=a.reportedOwner,e=a.screenPayload;e=e.response;e=e==null?void 0:e.follow_up_actions;if(!e||e.length===0)return null;var f;b[0]!==a?(f=function(b){k(a,b)},b[0]=a,b[1]=f):f=b[1];var g;b[2]!==e||b[3]!==f||b[4]!==d?(g=j.jsx(c("PolarisFRXReportModalFollowUpActionSection.react"),{followUpActions:e,onSelectFollowupAction:f,reportedOwner:d}),b[2]=e,b[3]=f,b[4]=d,b[5]=g):g=b[5];return g}g["default"]=a}),98);
__d("PolarisFRXInAppEscalationReportDropdownSelector.react",["cx","fbt","IGDSChevronIcon.react","PolarisIGCoreText","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this)||this;b.state={inputText:"",optionsVisible:!1};return b}var d=b.prototype;d.render=function(){var a=this,b=function(){var b=a.props.tags||null;return k.jsx("div",{className:"_ac4n",id:"dropdownOptions",children:b.map(function(a){return k.jsx("span",{className:"_ac4o",onClick:function(){return e(a)},role:"presentation",children:k.jsxs("div",{className:"_ac4p",children:[k.jsx(c("PolarisIGCoreText").Body,{color:"ig-primary-text",weight:"normal",zeroMargin:!0,children:a.title?a.title.text:""}),k.jsx("div",{className:"_ac4q"}),k.jsx(c("PolarisIGCoreText").Body,{color:"ig-secondary-text",size:"footnote",weight:"light",zeroMargin:!0,children:a.subtitle?a.subtitle.text:""})]})},a.tag_type)})})},d=function(){a.setState(function(a){return{optionsVisible:!a.optionsVisible}})},e=function(b){a.setState(function(a){return{inputText:b.title?b.title.text:"",optionsVisible:!a.optionsVisible}}),a.props.handleSetReportSubtype(b.tag_type)};return k.jsxs("span",{children:[k.jsxs("span",{className:"_ac4f",id:"optionList",onClick:d,role:"presentation",children:[k.jsxs("label",{className:"_ac4g",children:[k.jsx("span",{className:(this.props.showError===!1&&this.state.inputText===""?"_ac4h":"")+(this.state.inputText!==""?" _ac4i":"")+(this.props.showError===!0?" _ac4l":""),children:this.props.showError===!0?this.props.errorMessage:this.props.placeholder}),k.jsx("span",{className:(this.props.showError===!1?"_ac4j":"")+(this.props.showError===!0?" _ac4k":""),children:this.props.showError?this.props.placeholder:this.state.inputText})]}),k.jsx("div",{className:(this.state.optionsVisible?"":"_ac4r")+(this.state.optionsVisible?" _ac4s":""),children:k.jsx(c("IGDSChevronIcon.react"),{alt:i._("__JHASH__KmLwDGth6wW__JHASH__"),color:"ig-tertiary-text",direction:this.state.optionsVisible?"down":"next",size:17})})]}),this.state.optionsVisible?b():null]})};return b}(k.Component);g["default"]=a}),226);
__d("PolarisFRXInAppEscalationReportTextAreaInput.react",["cx","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$1=function(a){var b=a.currentTarget.value;c.setState(function(a){if(b.length>0&&!a.hasContent)return{hasContent:!0};else if(b.length===0)return{hasContent:!1};return{}})};c.state={hasContent:!!b.value,isFocused:!1};return c}var c=b.prototype;c.$2=function(a){this.setState({isFocused:a})};c.render=function(){var a=this;return j.jsxs("div",{className:"_acg-",children:[j.jsx("span",{className:(this.props.showError===!0?"_ach1":"")+(!this.state.isFocused&&!this.state.hasContent&&this.props.showError===!1?" _ach2":"")+((this.state.isFocused||this.state.hasContent)&&this.props.showError===!1?" _ach3":""),children:this.props.showError===!0?this.props.errorMessage:this.props.placeholder}),j.jsx("textarea",{className:(this.props.showError!==!0?"_acg_":"")+(this.props.showError===!0?" _ach0":""),id:this.props.id,name:this.props.name,onBlur:function(){return a.$2(!1)},onChange:this.props.onChange,onClick:function(){return a.$2(!0)},onInput:this.$1,placeholder:this.props.showError?this.props.placeholder:this.state.isFocused||this.state.hasContent?null:this.props.placeholder,value:this.props.value})]})};return b}(j.Component);g["default"]=a}),98);
__d("PolarisFRXReportModalPromptButton.react",["PolarisFRXReportMainButton.react","PolarisFRXWebReportStateSelectors","PolarisReactRedux.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(11),e=d("PolarisReactRedux.react").useSelector(d("PolarisFRXWebReportStateSelectors").getIsFRXScreenRequestProcessing),f=a.actionType,g=a.canSubmitOnClick,h=a.disabled,k=a.href,l=a.label,m=a.onSubmit;a=a.primaryButton;h=h===void 0?!1:h;a=a===void 0?!0:a;h=h||g&&e;var n;b[0]!==g||b[1]!==m||b[2]!==f?(n=function(){g&&m&&m(f)},b[0]=g,b[1]=m,b[2]=f,b[3]=n):n=b[3];e=g&&e;var o;b[4]!==h||b[5]!==k||b[6]!==n||b[7]!==a||b[8]!==e||b[9]!==l?(o=j.jsx(c("PolarisFRXReportMainButton.react"),{disabled:h,href:k,onClick:n,primaryButton:a,spinner:e,text:l}),b[4]=h,b[5]=k,b[6]=n,b[7]=a,b[8]=e,b[9]=l,b[10]=o):o=b[10];return o}g["default"]=a}),98);
__d("PolarisFRXInAppEscalationReportTypeScreenModal.react",["cx","fbt","IGDSBox.react","IGDSDivider.react","IGDSIconButton.react","IGDSVideoChatPanoOutlineIcon.react","IGDSXPanoFilledIcon.react","PolarisFRXInAppEscalationReportDropdownSelector.react","PolarisFRXInAppEscalationReportTextAreaInput.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportModalPromptButton.react","PolarisFRXReportModalRichText.react","PolarisFRXWebReportStrings","PolarisFRXWebReportUtils","PolarisIGCoreText","PolarisImageFileForm.react","Promise","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l=k||(k=d("react"));e=k;var m=e.useCallback,n=e.useState,o=12;function a(a){var e=a.headerParams,f=a.onClose,g=a.onSubmitScreen;a=a.screenPayload;var h=n(""),k=h[0],p=h[1];h=n([]);var q=h[0],r=h[1];h=n("");var s=h[0],t=h[1];h=n(!1);var u=h[0],v=h[1];h=n(!1);var w=h[0],x=h[1];(function(){return f&&f()});h=d("PolarisFRXWebReportUtils").getPromptButtonRenderPropsFromScreenPayload(a);function y(a){a!=null&&a.length>0&&z(a)}var z=m(function(a){(j||(j=b("Promise"))).all([].slice.call(a).map(function(a){return new(j||(j=b("Promise")))(function(b,c){var d=new FileReader();d.addEventListener("load",function(){b({data:d.result,name:a.name,type:a.type})});d.readAsDataURL(a)})})).then(function(a){return q.concat(a)}).then(function(a){r(a)})},[r,q]),A=function(){return q.length===0?null:l.jsx("div",{children:l.jsx("ul",{className:"_abmy",children:q.map(function(a,b){return l.jsxs("div",{className:"_abmz",children:[l.jsx("div",{className:"_abm-"}),l.jsx("div",{className:"_abm_",children:l.jsx("div",{className:"_abn0",children:l.jsx(c("IGDSIconButton.react"),{onClick:function(){return C(b)},children:l.jsx(c("IGDSXPanoFilledIcon.react"),{alt:i._("__JHASH__MUOkOji-l5l__JHASH__"),color:"web-always-white",size:o})})})}),B(a)]},a.name+b)})})})},B=function(a){return a.type.match(/image\//i)?l.jsx("img",{alt:a.name,className:"_abn1",src:a.data}):l.jsxs("div",{children:[l.jsx(c("IGDSVideoChatPanoOutlineIcon.react"),{}),l.jsx("figcaption",{children:a.name})]})},C=function(a){var b=q.slice(0);b.splice(a,1);r(b)};(function(){var a;return l.jsxs("div",{children:[l.jsxs(a=c("IGDSBox.react"),{direction:"row",marginBottom:4,marginTop:4,position:"relative",children:[l.jsxs(a,{alignContent:"start",position:"relative",children:[l.jsx(c("PolarisIGCoreText").Body,{color:"ig-primary-text",weight:"semibold",zeroMargin:!0,children:d("PolarisFRXWebReportStrings").IN_APP_ESCALATIONS_ATTACH_EVIDENCE_TEXT}),l.jsx(c("PolarisIGCoreText").Body2,{color:"ig-secondary-text",zeroMargin:!0,children:d("PolarisFRXWebReportStrings").DEFAULT_OPTIONAL_FIELD_TEXT})]}),l.jsx(a,{marginStart:"auto",position:"relative",children:l.jsx(d("PolarisImageFileForm.react").ImageFileForm,{acceptMimeTypes:["image/*","video/*"],multiple:!0,onFileChange:y,children:l.jsx(c("PolarisIGCoreText").Body,{color:"ig-primary-button",textAlign:"right",weight:"semibold",zeroMargin:!0,children:d("PolarisFRXWebReportStrings").IN_APP_ESCALATIONS_ADD_PHOTOS_TEXT})})})]}),l.jsx(a,{position:"relative",children:A()}),l.jsx(c("IGDSDivider.react"),{})]})});var D=function(){return g({attachments:q.map(function(a){return a.data}),evidenceText:k,reportSubtype:s})},E=function(){var a=!0;(s.trim()===""||s===null)&&(x(!0),a=!1);(k.trim()===""||k===null)&&(v(!0),a=!1);return a};h=h?l.jsx(c("PolarisFRXReportModalPromptButton.react"),babelHelpers["extends"]({},h,{onSubmit:function(){E()&&D()}})):null;var F=a.response.report_subtype_tags||[],G=a.response.subtype_selector_header?a.response.subtype_selector_header.text:"";return l.jsxs(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:e,onClose:f,children:[l.jsx(c("PolarisIGCoreText").Body,{color:"ig-primary-text",zeroMargin:!0,children:l.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a.response.header})}),l.jsx("br",{}),l.jsx(c("IGDSDivider.react"),{}),l.jsx(c("IGDSBox.react"),{direction:"column",marginBottom:4,marginTop:4,position:"relative",children:l.jsx(c("PolarisFRXInAppEscalationReportDropdownSelector.react"),{"aria-label":"select subtype of report",errorMessage:d("PolarisFRXWebReportStrings").IN_APP_ESCALATIONS_ERROR_SELECT_SUBTYPE_ERROR_TEXT,handleSetReportSubtype:function(a){t(a!=null?a:""),x(!1)},placeholder:G,showError:w,tags:F})}),l.jsx(c("IGDSDivider.react"),{}),l.jsx(c("IGDSBox.react"),{flex:"grow",marginBottom:4,marginTop:4,position:"relative",children:l.jsx(c("PolarisFRXInAppEscalationReportTextAreaInput.react"),{"aria-label":"evidence_text",errorMessage:d("PolarisFRXWebReportStrings").IN_APP_ESCALATIONS_PLEASE_EXPLAIN_ERROR_TEXT,id:"evidence_input",name:"evidence_text",onChange:function(a){p(a.target.value),a.target.value.trim()!==""&&v(!1)},placeholder:d("PolarisFRXWebReportStrings").IN_APP_ESCALATIONS_EXPLAIN_PROMPT_TEXT,showError:u,value:k})}),l.jsx(c("IGDSDivider.react"),{}),l.jsx(c("IGDSBox.react"),{marginBottom:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_BOTTOM,marginTop:4,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative"}),h]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("PolarisFRXReportConfirmationScreenModal.react",["IGDSBox.react","IGDSCircleCheckPanoOutlineIcon.react","IGDSText.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportMainButton.react","PolarisFRXReportModalFollowUpActionSection.react","PolarisFRXReportModalRichText.react","PolarisFRXWebReportAPIUtils","PolarisFRXWebReportStrings","PolarisGenericStrings","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a,b){b=b.action_type;if(b==null)return;a=a.screenPayload.response;d("PolarisFRXWebReportAPIUtils").handleFRXGuidedAction({action_type:b,context:a==null?void 0:a.context})}function a(a){var b=i(13),e=a.headerParams,f=a.onClose,g;b[0]!==f?(g=function(){return f&&f()},b[0]=f,b[1]=g):g=b[1];g=g;var h,k;b[2]!==a?(h=j.jsx(l,babelHelpers["extends"]({},a)),k=j.jsx(m,babelHelpers["extends"]({},a)),b[2]=a,b[3]=h,b[4]=k):(h=b[3],k=b[4]);b[5]!==g?(a=j.jsx(c("IGDSBox.react"),{marginBottom:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_BOTTOM,marginTop:4,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("PolarisFRXReportMainButton.react"),{"data-testid":void 0,onClick:g,text:d("PolarisGenericStrings").CLOSE_TEXT})}),b[5]=g,b[6]=a):a=b[6];var n;b[7]!==e||b[8]!==g||b[9]!==h||b[10]!==k||b[11]!==a?(n=j.jsxs(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{disableDefaultBodyPaddingMargin:!0,headerParams:e,onClose:g,children:[h,k,a]}),b[7]=e,b[8]=g,b[9]=h,b[10]=k,b[11]=a,b[12]=n):n=b[12];return n}function l(a){var b=i(16);a=a.screenPayload;var e;b[0]!==a?(e=a||{},b[0]=a,b[1]=e):e=b[1];a=e;e=a.response;b[2]!==e?(a=e||{},b[2]=e,b[3]=a):a=b[3];e=a;a=e.follow_up_actions_title;e=e.subtitle;var f=c("gkx")("4760"),g;b[4]!==e?(g=e?j.jsx(c("IGDSBox.react"),{alignItems:"start",marginTop:6,position:"relative",children:f?j.jsx(c("IGDSText.react").TitleEmphasized,{textAlign:"center",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:e})}):j.jsx(c("IGDSText.react").Section,{textAlign:"center",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:e})})}):null,b[4]=e,b[5]=g):g=b[5];e=g;g=null;if(a){var h;b[6]!==a?(h=f?d("PolarisFRXWebReportStrings").CONFIRMATION_MODAL_HEADER_TEXT:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a}),b[6]=a,b[7]=h):h=b[7];b[8]!==h?(a=j.jsx(c("IGDSText.react").Body,{color:"secondaryText",textAlign:"center",zeroMargin:!0,children:h}),b[8]=h,b[9]=a):a=b[9];g=a;if(e){b[10]!==g?(h=j.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:g}),b[10]=g,b[11]=h):h=b[11];g=h}}b[12]===Symbol["for"]("react.memo_cache_sentinel")?(a=!f&&j.jsx(c("IGDSCircleCheckPanoOutlineIcon.react"),{alt:d("PolarisFRXWebReportStrings").CHECKMARK_ICON_ALT_TEXT,color:"ig-success",size:48}),b[12]=a):a=b[12];b[13]!==e||b[14]!==g?(h=j.jsx(c("IGDSBox.react"),{marginTop:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_TOP,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsxs(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",marginTop:f?2:6,position:"relative",children:[a,e,g]})}),b[13]=e,b[14]=g,b[15]=h):h=b[15];return h}function m(a){var b=i(6),d=a.reportedOwner,e=a.screenPayload;e=e.response;e=e==null?void 0:e.follow_up_actions;if(!e||e.length===0)return null;var f;b[0]!==a?(f=function(b){k(a,b)},b[0]=a,b[1]=f):f=b[1];var g;b[2]!==e||b[3]!==f||b[4]!==d?(g=j.jsx(c("PolarisFRXReportModalFollowUpActionSection.react"),{followUpActions:e,onSelectFollowupAction:f,reportedOwner:d}),b[2]=e,b[3]=f,b[4]=d,b[5]=g):g=b[5];return g}g["default"]=a}),98);
__d("PolarisFRXReportModalScreenContentSectionList.react",["IGDSBox.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k=4;function a(a){var b=i(7),d=a.sections;a=a.marginBetween;var e=a===void 0?k:a;if(b[0]!==d||b[1]!==e){b[3]!==e?(a=function(a,b){var d=b>0&&e!==0?j.jsx(c("IGDSBox.react"),{marginTop:e,position:"relative"}):null;return j.jsxs(j.Fragment,{children:[d,a]},"section-"+b)},b[3]=e,b[4]=a):a=b[4];a=d.filter(l).map(a);b[0]=d;b[1]=e;b[2]=a}else a=b[2];d=a;b[5]!==d?(a=j.jsx(j.Fragment,{children:d}),b[5]=d,b[6]=a):a=b[6];return a}function l(a){return!!a}g["default"]=a}),98);
__d("PolarisFRXReportModalInterstitialScreen.react",["IGDSBox.react","IGDSText.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportModalPromptButton.react","PolarisFRXReportModalRichText.react","PolarisFRXReportModalScreenContentSectionList.react","PolarisFRXWebReportUtils","isStringNullOrEmpty","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k=2,l=100;function a(a){var b=i(24),e=a.headerParams,f=a.onClose,g=a.screenPayload,h=g.response,k;b[0]!==h?(k=h||{},b[0]=h,b[1]=k):k=b[1];h=k;k=h.body;var p=h.image_url,q=h.paragraphs,r=h.subtitle;h=h.tip_number;q=q?q[0]:null;h=k||h===3?l:l*2;var s;b[2]!==p||b[3]!==h?(s=c("isStringNullOrEmpty")(p)?null:j.jsx(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",position:"relative",children:j.jsx("img",{alt:"",height:l,src:p,width:h})}),b[2]=p,b[3]=h,b[4]=s):s=b[4];p=s;b[5]!==r?(h=r?j.jsx(m,{subtitle:r}):null,b[5]=r,b[6]=h):h=b[6];s=h;b[7]!==k||b[8]!==q?(r=k?j.jsx(o,{body:k}):q?j.jsx(o,{body:q}):null,b[7]=k,b[8]=q,b[9]=r):r=b[9];h=r;b[10]!==g?(k=d("PolarisFRXWebReportUtils").getPromptButtonRenderPropsFromScreenPayload(g),b[10]=g,b[11]=k):k=b[11];q=k;b[12]!==q||b[13]!==a?(r=q?j.jsx(n,{parentProps:a,promptButtonProps:q}):null,b[12]=q,b[13]=a,b[14]=r):r=b[14];g=r;b[15]!==p||b[16]!==s||b[17]!==h||b[18]!==g?(k=j.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{sections:[p,s,h,g]}),b[15]=p,b[16]=s,b[17]=h,b[18]=g,b[19]=k):k=b[19];b[20]!==e||b[21]!==f||b[22]!==k?(q=j.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:e,onClose:f,children:k}),b[20]=e,b[21]=f,b[22]=k,b[23]=q):q=b[23];return q}function m(a){var b=i(2);a=a.subtitle;var d;b[0]!==a?(d=j.jsx(c("IGDSBox.react"),{alignItems:"start",marginTop:k,position:"relative",children:j.jsx(c("IGDSText.react").Section,{textAlign:"center",children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})}),b[0]=a,b[1]=d):d=b[1];return d}function n(a){var b=i(6),d=a.parentProps;a=a.promptButtonProps;var e=d.onSubmitScreen;d=d.screenPayload;d=d.response;var f=d.tip_number;b[0]!==e||b[1]!==f?(d=function(a){return e({selectedPromptButtonActionType:a,tipNumber:f})},b[0]=e,b[1]=f,b[2]=d):d=b[2];var g;b[3]!==a||b[4]!==d?(g=j.jsx(c("PolarisFRXReportModalPromptButton.react"),babelHelpers["extends"]({},a,{onSubmit:d})),b[3]=a,b[4]=d,b[5]=g):g=b[5];return g}function o(a){var b=i(4);a=a.body;var d;b[0]!==a?(d=a?j.jsx(c("IGDSBox.react"),{position:"relative",children:j.jsx("div",{role:"listitem",children:j.jsx(c("IGDSBox.react"),{direction:"row",position:"relative",children:j.jsx(c("IGDSBox.react"),{flex:"grow",position:"relative",children:j.jsx(c("IGDSText.react").Body,{color:"secondaryText",textAlign:"center",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})})})})}):null,b[0]=a,b[1]=d):d=b[1];a=d;b[2]!==a?(d=j.jsx(c("IGDSBox.react"),{position:"relative",children:a}),b[2]=a,b[3]=d):d=b[3];return d}g["default"]=a}),98);
__d("PolarisFRXReportModalPolicyEducationSection.react",["IGDSBox.react","IGDSText.react","PolarisFRXReportModalRichText.react","PolarisFRXReportModalScreenContentSectionList.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k=2,l=1,m="\u2022";function n(a,b){a=a.first_paragraph;var d=[];[a].forEach(function(a){if(!a||(a==null?void 0:a.text)==null||(a==null?void 0:a.text)==="")return;d.push(j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"body",weight:b?"semibold":"normal",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})}))});return d}function o(a){a=a.policies;a=a===void 0?[]:a;if(!a||a.length===0)return[];var b=[];a.forEach(function(a){a=a.title;if(!a)return;b.push(j.jsx("div",{role:"listitem",children:j.jsxs(c("IGDSBox.react"),{direction:"row",position:"relative",children:[j.jsx(c("IGDSBox.react"),{marginEnd:2,position:"relative",children:j.jsx("div",{"aria-hidden":"true",children:j.jsx(c("IGDSText.react").Body2,{color:"secondaryText",zeroMargin:!0,children:m})})}),j.jsx(c("IGDSBox.react"),{flex:"grow",position:"relative",children:j.jsx(c("IGDSText.react").Body2,{color:"secondaryText",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})})]})}))});return b}function a(a){var b=i(24);a=a.policyEducation;var d=a.second_paragraph,e=a.title,f;b[0]!==e?(f=e?j.jsx(c("IGDSText.react").Section,{zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:e})}):null,b[0]=e,b[1]=f):f=b[1];e=f;b[2]!==a?(f=o(a),b[2]=a,b[3]=f):f=b[3];f=f;var g=f.length>0,h;b[4]!==a||b[5]!==g?(h=n(a,g),b[4]=a,b[5]=g,b[6]=h):h=b[6];a=h;b[7]!==a||b[8]!==e?(g=a.length>0?j.jsx(c("IGDSBox.react"),{marginTop:e?k:0,position:"relative",children:j.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{marginBetween:k,sections:a})}):null,b[7]=a,b[8]=e,b[9]=g):g=b[9];h=g;b[10]!==f||b[11]!==e||b[12]!==h?(a=f.length>0?j.jsx(c("IGDSBox.react"),{marginTop:e||h?l:0,position:"relative",children:j.jsx("div",{role:"list",children:j.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{marginBetween:l,sections:f})})}):null,b[10]=f,b[11]=e,b[12]=h,b[13]=a):a=b[13];g=a;f=c("gkx")("4760");b[14]!==d||b[15]!==g||b[16]!==e?(a=d?j.jsxs(c("IGDSBox.react"),{marginTop:g?f?3:1:0,position:"relative",children:[j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"body",weight:"normal",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:d})}),j.jsx(c("IGDSBox.react"),{height:e?2:10,position:"relative"})]}):null,b[14]=d,b[15]=g,b[16]=e,b[17]=a):a=b[17];d=a;a=!f&&d;f=f&&d;b[18]!==e||b[19]!==a||b[20]!==h||b[21]!==g||b[22]!==f?(d=j.jsxs(c("IGDSBox.react"),{position:"relative",children:[e,a,h,g,f]}),b[18]=e,b[19]=a,b[20]=h,b[21]=g,b[22]=f,b[23]=d):d=b[23];return d}g["default"]=a}),98);
__d("PolarisFRXReportPolicyEducationScreenModal.react",["IGDSBox.react","IGDSText.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportModalPolicyEducationSection.react","PolarisFRXReportModalPromptButton.react","PolarisFRXReportModalRichText.react","PolarisFRXReportModalScreenContentSectionList.react","PolarisFRXWebReportUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(26),e=a.headerParams,f=a.onClose,g=a.screenPayload,h=g.response,m;b[0]!==h?(m=h||{},b[0]=h,b[1]=m):m=b[1];h=m;m=h.policy_education;h=h.subtitle;var n;b[2]!==h?(n=h?j.jsx(k,{subtitle:h}):null,b[2]=h,b[3]=n):n=b[3];h=n;b[4]!==m?(n=m?j.jsx(c("PolarisFRXReportModalPolicyEducationSection.react"),{policyEducation:m}):null,b[4]=m,b[5]=n):n=b[5];n=n;var o;b[6]!==g?(o=d("PolarisFRXWebReportUtils").getPromptButtonRenderPropsFromScreenPayload(g),b[6]=g,b[7]=o):o=b[7];g=o;b[8]!==g||b[9]!==a?(o=g?j.jsx(l,{parentProps:a,promptButtonProps:g}):null,b[8]=g,b[9]=a,b[10]=o):o=b[10];g=o;a=null;if(m){o=m.education_button;if(o){m=(m=(m=o.title)==null?void 0:m.text)!=null?m:"";var p;b[11]!==o.action_type||b[12]!==o.url||b[13]!==m?(p={actionType:o.action_type,canSubmitOnClick:!1,href:o.url,label:m,primaryButton:!1},b[11]=o.action_type,b[12]=o.url,b[13]=m,b[14]=p):p=b[14];o=p;b[15]!==o?(m=j.jsx(c("PolarisFRXReportModalPromptButton.react"),babelHelpers["extends"]({},o)),b[15]=o,b[16]=m):m=b[16];a=m}}b[17]!==h||b[18]!==n||b[19]!==g||b[20]!==a?(p=j.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{sections:[h,n,g,a]}),b[17]=h,b[18]=n,b[19]=g,b[20]=a,b[21]=p):p=b[21];b[22]!==e||b[23]!==f||b[24]!==p?(o=j.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:e,onClose:f,children:p}),b[22]=e,b[23]=f,b[24]=p,b[25]=o):o=b[25];return o}function k(a){var b=i(2);a=a.subtitle;var d;b[0]!==a?(d=j.jsx(c("IGDSBox.react"),{alignItems:"start",marginTop:2,position:"relative",children:j.jsx(c("IGDSText.react").Section,{children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})}),b[0]=a,b[1]=d):d=b[1];return d}function l(a){var b=i(5),d=a.parentProps;a=a.promptButtonProps;var e=d.onSubmitScreen;b[0]!==e?(d=function(a){return e(a)},b[0]=e,b[1]=d):d=b[1];var f;b[2]!==a||b[3]!==d?(f=j.jsx(c("PolarisFRXReportModalPromptButton.react"),babelHelpers["extends"]({},a,{onSubmit:d})),b[2]=a,b[3]=d,b[4]=f):f=b[4];return f}g["default"]=a}),98);
__d("PolarisFRXReportReviewScreenModalRootQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7566785723427516"}),null);
__d("PolarisFRXReportReviewScreenModalRootQuery$Parameters",["PolarisFRXReportReviewScreenModalRootQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("PolarisFRXReportReviewScreenModalRootQuery_instagramRelayOperation"),metadata:{},name:"PolarisFRXReportReviewScreenModalRootQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("PolarisFRXReportReviewScreenModalRootEntrypoint.entrypoint",["JSResourceForInteraction","PolarisFRXReportReviewScreenModalRootQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{parameters:c("PolarisFRXReportReviewScreenModalRootQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("PolarisFRXReportReviewScreenModalRoot.react").__setRef("PolarisFRXReportReviewScreenModalRootEntrypoint.entrypoint")};g["default"]=a}),98);
__d("PolarisFRXReportReviewScreenModal.react",["CometRelay","PolarisFRXReportReviewScreenModalRootEntrypoint.entrypoint","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.c;function a(a){var b=j(9),e,f;b[0]!==a?(f=a.reportOwnerUsername,e=babelHelpers.objectWithoutPropertiesLoose(a,["reportOwnerUsername"]),b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);var g=d("CometRelay").useRelayEnvironment();b[3]!==g?(a={getEnvironment:function(){return g}},b[3]=g,b[4]=a):a=b[4];a=a;a=a;a=d("CometRelay").useEntryPointLoader(a,c("PolarisFRXReportReviewScreenModalRootEntrypoint.entrypoint"));var h=a[0];a=a[1];h===null&&a({});b[5]!==h||b[6]!==e||b[7]!==f?(a=h?i.jsx(d("CometRelay").EntryPointContainer,{entryPointReference:h,props:{props:e,reportOwnerUsername:f}}):null,b[5]=h,b[6]=e,b[7]=f,b[8]=a):a=b[8];return a}g["default"]=a}),98);
__d("PolarisReportSearchBoxContainer.react",["PolarisMobileSearchBox.react","PolarisReactRedux.react","PolarisSearchActions","polarisSearchSelectors","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");function a(a){var b=a.search;a=d("polarisSearchSelectors").getCurrentSearchContent(a);return{currentTab:b.currentSearchTab,discoverToken:"",loading:a.loading,rankToken:a.rankToken,results:a.results,searchedForQuery:a.searchedForQuery,selectedIndex:a.selectedIndex,suggested:b.suggested}}function b(a){return{onClearSearch:function(){a(d("PolarisSearchActions").clearSearch())},onNavigateToResult:function(b,c,e){a(d("PolarisSearchActions").navigateToResult(b,c,e))},onSearch:function(b,c,e,f,g){a(d("PolarisSearchActions").search(b,c,e))},onSelectResult:function(b,c){a(d("PolarisSearchActions").selectResult(b,c))}}}e=d("PolarisReactRedux.react").connect(a,b)(c("PolarisMobileSearchBox.react"));g["default"]=e}),98);
__d("PolarisReportButton.react",["PolarisIGCoreButton.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(5),d=a.children,e=a.color,f=a.disabled;a=a.onClick;e=e===void 0?"ig-primary-button":e;var g;b[0]!==e||b[1]!==f||b[2]!==a||b[3]!==d?(g=j.jsx(c("PolarisIGCoreButton.react"),{color:e,disabled:f,fullWidth:!0,large:!0,onClick:a,children:d}),b[0]=e,b[1]=f,b[2]=a,b[3]=d,b[4]=g):g=b[4];return g}g["default"]=a}),98);
__d("PolarisReportUserImpersonationListItem.react",["IGDSBox.react","IGDSListItem.react","IGDSText.react","PolarisAssetManagerGlyphMapping","PolarisGenericStrings","PolarisIGCoreIcon.react","PolarisReportButton.react","PolarisReportStrings","PolarisUserAvatar.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=function(){c.props.onReport()},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.render=function(){var a=this.props.result;return i.jsx(c("IGDSListItem.react"),{addOnEnd:i.jsx(c("PolarisReportButton.react"),{onClick:this.$1,children:d("PolarisReportStrings").nextText}),addOnStart:i.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:a.profilePictureUrl,size:44,username:a.username}),subtitle:a.fullName,title:i.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",display:"block",children:[i.jsx(c("IGDSText.react").BodyEmphasized,{breakWord:!0,children:a.username}),a.isVerified?i.jsx(c("IGDSBox.react"),{display:"inlineBlock",marginStart:1,children:i.jsx(c("PolarisIGCoreIcon.react"),{alt:d("PolarisGenericStrings").VERIFIED_TEXT,icon:d("PolarisAssetManagerGlyphMapping").ICONS.VERIFIED_SMALL})}):null]})})};return b}(i.Component);g.ReportUserImpersonationListItem=a}),98);
__d("PolarisReportUserImpersonationSearchBox.react",["cx","IGDSBox.react","PolarisReportSearchBoxContainer.react","PolarisReportUserImpersonationListItem.react","PolarisSearchConstants","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(21),e=a.fromWebview,f=a.onSelectVictim,g=a.reportedUserID,h=a.searchBoxPlaceHolder,i=a.userSearchResults,l=a.verifiedOnly;a=e===void 0?!1:e;b[0]!==h?(e=k.jsx(c("PolarisReportSearchBoxContainer.react"),{analyticsContext:void 0,disableResultKeyboardNav:!0,hideCancelButton:!0,isActive:!0,placeholder:h,searchContext:d("PolarisSearchConstants").SEARCH_CONTEXT.USER,useHistory:!0}),b[0]=h,b[1]=e):e=b[1];h=a?0:2;a=a?"_ac68":"";if(b[2]!==l||b[3]!==g||b[4]!==i||b[5]!==f){var m;b[7]!==l||b[8]!==g?(m=function(a){return l?a.isVerified&&a.pk!==g.toString():a.pk!==g.toString()},b[7]=l,b[8]=g,b[9]=m):m=b[9];var n;b[10]!==f?(n=function(a,b){return k.jsx(d("PolarisReportUserImpersonationListItem.react").ReportUserImpersonationListItem,{onReport:function(){return f(a)},result:a},b)},b[10]=f,b[11]=n):n=b[11];m=i.filter(m).map(n);b[2]=l;b[3]=g;b[4]=i;b[5]=f;b[6]=m}else m=b[6];b[12]!==a||b[13]!==m?(n=k.jsx("div",{className:a,children:m}),b[12]=a,b[13]=m,b[14]=n):n=b[14];b[15]!==h||b[16]!==n?(i=k.jsx(c("IGDSBox.react"),{color:"primaryBackground",marginTop:h,position:"relative",children:n}),b[15]=h,b[16]=n,b[17]=i):i=b[17];b[18]!==e||b[19]!==i?(a=k.jsxs("div",{children:[e,i]}),b[18]=e,b[19]=i,b[20]=a):a=b[20];return a}g["default"]=a}),98);
__d("PolarisFRXReportSelectVictimScreenModal.react",["IGDSBox.react","IGDSText.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportModalRichText.react","PolarisFRXReportModalScreenContentSectionList.react","PolarisReactRedux.react","PolarisReportConstants","PolarisReportUserImpersonationSearchBox.react","PolarisSearchActions","PolarisSearchConstants","polarisSearchSelectors","react","useJSON"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useEffect,k=e.c;function l(a){a=a.allSearchResults;var b=[];for(var c=0;c<a.length;c++){var d=a[c];d.type==="USER_RESULT"&&b.push(d)}return b}function m(a){var b=k(3),c=a.onClearSearch,d;b[0]!==c?(a=function(){return function(){c()}},d=[c],b[0]=c,b[1]=a,b[2]=d):(a=b[1],d=b[2]);j(a,d)}function a(a){m(a);var b=a.headerParams,e=a.onClose,f=a.onSelectVictim,g=a.reportedOwner,h=a.screenPayload;h=h.response;var j=h||{};j=j.subtitle;h=h.context;g=g.id;j=j?i.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:i.jsx(c("IGDSText.react").BodyEmphasized,{children:i.jsx(c("PolarisFRXReportModalRichText.react"),{richText:j})})}):null;try{h=c("useJSON")((h=h)!=null?h:null);h=h==null?void 0:h.tags;h=(h==null?void 0:h.includes(d("PolarisReportConstants").IGUserImpersonationSomeoneIFollowTag.tag_type))===!0}catch(a){h=!1}h=!h;g=i.jsx(c("PolarisReportUserImpersonationSearchBox.react"),{onSelectVictim:function(a){return f(a)},reportedUserID:g,searchBoxPlaceHolder:d("PolarisSearchConstants").IMPERSONATION_SEARCH_TEXT,userSearchResults:l(a),verifiedOnly:h});return i.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:b,onClose:function(){return e&&e()},children:i.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{sections:[j,g]})})}a.displayName=a.name+" [from "+f.id+"]";function b(a){a=d("polarisSearchSelectors").getCurrentSearchContent(a);a=a.results;return{allSearchResults:a}}e={onClearSearch:d("PolarisSearchActions").clearSearch};f=d("PolarisReactRedux.react").connect(b,e)(a);g["default"]=f}),98);
__d("PolarisFRXReportTagSelectionScreenModal.react",["IGDSBox.react","IGDSText.react","InstagramAdHideResponseFalcoEvent","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportModalOptionList.react","PolarisFRXReportModalOptionListItem.react","PolarisFRXReportModalPolicyEducationSection.react","PolarisFRXReportModalPromptButton.react","PolarisFRXReportModalRichText.react","PolarisFRXReportModalScreenContentSectionList.react","PolarisFRXWebReportAPIUtils","PolarisFRXWebReportConstants","PolarisFRXWebReportStateSelectors","PolarisFRXWebReportStrings","PolarisFRXWebReportUtils","PolarisReactRedux.react","PolarisReportConstants","gkx","goUriOnNewWindow","isEmpty","isStringNullOrEmpty","polarisAdsSelectors.react","react","useJSON"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));e=i;var k=e.useEffect,l=e.useRef,m=e.useState,n=e.c,o=null,p="",q=c("gkx")("4760");function r(a,b,e,f){var g=a.isFRXScreenRequestProcessing,h=a.onSubmitScreen;a=a.screenPayload.response;var i=b.setStateSelectedTagTitle;b=b.setStateSelectedTagType;var j=e.tag_type,k=e.title;k=(k=k==null?void 0:k.text)!=null?k:"";if(c("gkx")("25382")&&e.tag_click_override_url!=null){c("goUriOnNewWindow")(e.tag_click_override_url);return}if(g||j==null||j==="")return;b(j);i(k);d("PolarisFRXWebReportAPIUtils").logFRXTagSelected({context:a==null?void 0:a.context,selected_tag_type:j});h&&!f&&h({selectedPromptButtonActionType:null,selectedTagTitles:[k],selectedTagTypes:[j]})}function s(a,b,d){a=a.onSubmitScreen;var e=b.selectedTagTitle;b=b.selectedTagType;a&&!c("isStringNullOrEmpty")(b)&&a({selectedPromptButtonActionType:d,selectedTagTitles:[e],selectedTagTypes:[b]})}function t(){var a=n(3),b=m(o),c=b[0];b=b[1];var d=m(p),e=d[0];d=d[1];a[0]!==e||a[1]!==c?(d={selectedTagTitle:e,selectedTagType:c,setStateSelectedTagTitle:d,setStateSelectedTagType:b},a[0]=e,a[1]=c,a[2]=d):d=a[2];return d}function u(a,b){var c=b.setStateSelectedTagTitle,d=b.setStateSelectedTagType,e=a.screenPayload.frxScreenRequestID,f=l(),g=f.current;k(function(){f.current=e,e!==g&&(d(o),c(p))},[e,g,d,c])}function a(a){var b=n(7),c=t();u(a,c);var e=a.headerParams,f=a.onClose,g;b[0]!==a||b[1]!==c?(g=j.jsx(v,{parentProps:a,parentState:c}),b[0]=a,b[1]=c,b[2]=g):g=b[2];b[3]!==e||b[4]!==f||b[5]!==g?(a=j.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{disableDefaultBodyPaddingMargin:!0,headerParams:e,onClose:f,children:g}),b[3]=e,b[4]=f,b[5]=g,b[6]=a):a=b[6];return a}function v(a){var b=n(34),e=a.parentProps;a=a.parentState;var f=e.screenPayload,g=f.response,i;b[0]!==g?(i=g||{},b[0]=g,b[1]=i):i=b[1];g=i;i=g.context;var k=g.policy_education,l=g.report_tags,m=g.second_subtitle;g=g.subtitle;i=c("useJSON")((i=i)!=null?i:null);i=i==null?void 0:i.tags;if(b[2]!==g){var o;o=g&&!(h||(h=c("isEmpty")))((o=g.text)==null?void 0:o.trim())?j.jsx(x,{subtitle:g}):null;b[2]=g;b[3]=o}else o=b[3];g=o;if(b[4]!==m){o=m&&!(h||(h=c("isEmpty")))((o=m.text)==null?void 0:o.trim())?j.jsx(y,{secondSubtitle:m}):null;b[4]=m;b[5]=o}else o=b[5];m=o;b[6]!==l||b[7]!==e||b[8]!==a?(o=l&&l.length>0?j.jsx(z,{parentProps:e,parentState:a,reportTags:l}):null,b[6]=l,b[7]=e,b[8]=a,b[9]=o):o=b[9];l=o;o=!q||!l;var p;b[10]!==k||b[11]!==o?(p=k&&o?j.jsx(A,{policyEducation:k}):null,b[10]=k,b[11]=o,b[12]=p):p=b[12];k=p;var r=w;b[13]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(a){a=r(a);return a!==null&&j.jsx(c("IGDSBox.react"),{paddingX:4,children:j.jsx(c("IGDSText.react"),{color:"secondaryText",children:a})})},b[13]=p):p=b[13];p=p;var s;b[14]!==f?(s=d("PolarisFRXWebReportUtils").getPromptButtonRenderPropsFromScreenPayload(f),b[14]=f,b[15]=s):s=b[15];f=s;b[16]!==f||b[17]!==o||b[18]!==e||b[19]!==a?(s=f&&o?j.jsx(B,{parentProps:e,parentState:a,promptButtonProps:f}):null,b[16]=f,b[17]=o,b[18]=e,b[19]=a,b[20]=s):s=b[20];f=s;o=g!=null?d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_TOP:0;e=k||f?d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_MARGIN_BOTTOM:0;b[21]!==i?(a=q&&i&&p(i[0]),b[21]=i,b[22]=a):a=b[22];b[23]!==g||b[24]!==a||b[25]!==m||b[26]!==l||b[27]!==k||b[28]!==f?(s=j.jsx(c("PolarisFRXReportModalScreenContentSectionList.react"),{sections:[g,a,m,l,k,f]}),b[23]=g,b[24]=a,b[25]=m,b[26]=l,b[27]=k,b[28]=f,b[29]=s):s=b[29];b[30]!==e||b[31]!==o||b[32]!==s?(p=j.jsx(c("IGDSBox.react"),{marginBottom:e,marginTop:o,position:"relative",children:s}),b[30]=e,b[31]=o,b[32]=s,b[33]=p):p=b[33];return p}function w(a){if(a==null||a==="ig_bullying_or_harassment_comment_v3")return d("PolarisFRXWebReportStrings").DEFUALT_HEADER_DESCRIPTION_TEXT;else if(a==="drugs")return d("PolarisFRXWebReportStrings").DRUGS_TAG_DESCRIPTION_TEXT;else return null}function x(a){var b=n(2);a=a.subtitle;var e;b[0]!==a?(e=j.jsx(c("IGDSBox.react"),{alignItems:"start",marginTop:2,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("IGDSText.react").Section,{children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})}),b[0]=a,b[1]=e):e=b[1];return e}function y(a){var b=n(2);a=a.secondSubtitle;var e;b[0]!==a?(e=j.jsx(c("IGDSBox.react"),{marginTop:0,paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"body",weight:"normal",zeroMargin:!0,children:j.jsx(c("PolarisFRXReportModalRichText.react"),{richText:a})})}),b[0]=a,b[1]=e):e=b[1];return e}function z(a){var b=n(24),e=a.parentProps,f=a.parentState;a=a.reportTags;var g=e.frxMetadata,h=e.isFRXScreenRequestProcessing,i=e.onSelectReportAd,k=e.screenPayload;k=k.response;k=k||{};k=k.style;var l=f.selectedTagType,m=q?!1:k===d("PolarisFRXWebReportConstants").FRX_TAG_SELECTION_STYLE_INTS.RADIO_BUTTONS,o=d("polarisAdsSelectors.react").useFRXReportAdLoggingParams(g.object_id,g.location);if(b[0]!==l||b[1]!==h||b[2]!==m||b[3]!==g.object_type||b[4]!==g.object_id||b[5]!==i||b[6]!==o||b[7]!==e||b[8]!==f||b[9]!==a){b[11]!==l||b[12]!==h||b[13]!==m||b[14]!==g.object_type||b[15]!==g.object_id||b[16]!==i||b[17]!==o||b[18]!==e||b[19]!==f?(k=function(a,b){var k=a.tag_type,n=a.title,p=l===k,q=h&&p&&!m,s=m?d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_VARIANTS.RADIO:d("PolarisFRXReportModalOptionListItem.react").OPTION_LIST_ITEM_VARIANTS.BUTTON;b="tag-"+b;return j.jsx(d("PolarisFRXReportModalOptionListItem.react").FRXReportModalOptionListItem,{"data-testid":void 0,loading:q,onSelect:function(){g.object_type===d("PolarisReportConstants").FRXObjectType.AD&&(i!=null?i(k):c("InstagramAdHideResponseFalcoEvent").log(function(){return babelHelpers["extends"]({ad_id:g.object_id,response:k},o)})),r(e,f,a,m)},selected:p,value:b,variant:s,children:n==null?void 0:n.text},b)},b[11]=l,b[12]=h,b[13]=m,b[14]=g.object_type,b[15]=g.object_id,b[16]=i,b[17]=o,b[18]=e,b[19]=f,b[20]=k):k=b[20];k=a.map(k);b[0]=l;b[1]=h;b[2]=m;b[3]=g.object_type;b[4]=g.object_id;b[5]=i;b[6]=o;b[7]=e;b[8]=f;b[9]=a;b[10]=k}else k=b[10];a=k;b[21]!==m||b[22]!==a?(k=j.jsx(c("PolarisFRXReportModalOptionList.react"),{asRadio:m,children:a}),b[21]=m,b[22]=a,b[23]=k):k=b[23];return k}function A(a){var b=n(2);a=a.policyEducation;var e;b[0]!==a?(e=j.jsx(c("IGDSBox.react"),{paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("PolarisFRXReportModalPolicyEducationSection.react"),{policyEducation:a})}),b[0]=a,b[1]=e):e=b[1];return e}function B(a){var b=n(7),e=a.parentProps,f=a.parentState;a=a.promptButtonProps;var g=f.selectedTagType;g=!g;var h;b[0]!==e||b[1]!==f?(h=function(a){return s(e,f,a)},b[0]=e,b[1]=f,b[2]=h):h=b[2];var i;b[3]!==a||b[4]!==g||b[5]!==h?(i=j.jsx(c("IGDSBox.react"),{paddingX:d("PolarisFRXReportBaseScreenModal.react").DEFAULT_BODY_PADDING_X,position:"relative",children:j.jsx(c("PolarisFRXReportModalPromptButton.react"),babelHelpers["extends"]({},a,{disabled:g,onSubmit:h}))}),b[3]=a,b[4]=g,b[5]=h,b[6]=i):i=b[6];return i}function b(a){return{isFRXScreenRequestProcessing:d("PolarisFRXWebReportStateSelectors").getIsFRXScreenRequestProcessing(a)}}f=d("PolarisReactRedux.react").connect(b,null)(a);g["default"]=f}),98);
__d("PolarisFRXReportUtils",[],(function(a,b,c,d,e,f){"use strict";var g=["ig_ad_ip_violation","ig_ad_ip_violation","ig_intellectual_property_v1","ig_ar_effect_ip_violation","ig_intellectual_property_direct_message","ig_hashtag_intellectual_property","ig_ad_spam","ig_spam_v3","ig_spam_direct_message","ig_spam","ig_bullying_or_harassment_comment_v3","ig_bullying_or_harassment_direct_message","ig_hashtag_bullying_or_harassment","ig_ar_effect_harassment_or_bullying","ig_harassment_or_bullying","ig_nudity_v2","ig_nudity_direct_message","ig_clips_audio_page_nudity","ig_clips_effect_page_nudity","ig_clips_prompt_page_nudity","ig_hashtag_nudity","ig_ar_effect_nudity_or_pornography","ig_nudity","ig_ad_sexually_inappropriate","ig_iab_sexually_inappropriate","product_sexualized_content_or_adult_products","bi_commerce_sexualized_or_adult_content","inappropriate_content","ig_commerce_ugc_graphic_content","bi_commerce_abusive_or_harmful","ig_violence_parent","ig_ad_violent_prohibited","ig_ar_effect_violence","ig_violence_direct_message","ig_hashtag_violence","ig_violence_v3","ig_violence","ig_dangerous_org_or_individual","ig_hate_speech_v3","ig_ar_effect_hate_speech","ig_hate_speech_direct_message","ig_hashtag_hate_speech","ig_hate_speech","ig_i_dont_like_it_v3","ig_ar_effect_i_dont_like_it","ig_i_dont_like_it_direct_message","ig_ad_offensive","ig_self_injury_v3","ig_ar_effect_self_injury","ig_hashtag_self_injury","ig_self_injury","ig_self_injury_direct_message","ig_ad_scam_misleading","ig_product_scam_fraud_v2","ig_product_scam_fraud_reportable","ig_iab_scam_misleading","bi_commerce_misleading_or_possible_scam","ig_sale_of_illegal_or_regulated_goods_v3","ig_sale_of_illegal_or_regulated_goods_direct_message","ig_sale_of_illegal_or_regulated_goods_v2","ig_ar_effect_drugs","ig_ar_effect_firearms","bi_commerce_alcohol_tobacco_and_weapons","bi_commerce_animal_products_or_sales","ig_false_news","ig_ar_effect_false_information","ig_report_report_as_unlawful","bi_commerce_discriminatory_listing","discrimination","ig_something_else","something_else","ig_ad_political","ig_escalations_create_detailed_report","ig_eating_disorder","ig_nft_metadata_mismatch","bi_commerce_buying_or_selling","ig_commerce_ugc_manipulation","ig_commerce_ugc_irrelevance","ig_commerce_review_irrelevant","ig_commerce_fake_review","ig_commerce_product_answer_irrelevant","ig_commerce_product_question_irrelevant","ig_user_impersonation","ig_unwanted_joiner","ig_iab_excessive_ads","ig_iab_other","page_place_inaccurate_info","bi_commerce_service_or_job","product_no_intent_to_sale","bi_commerce_appears_to_be_counterfeit","bi_commerce_health_or_wellness","bi_commerce_other_prohibited","bi_commerce_no_service_offered","bi_commerce_health_or_medical","information_misuse","dont_recognize_activity"];function a(a){return g.includes(a)}f.shouldUseTagType=a}),66);
__d("PolarisFRXReportScreenModal.react",["IGDSBox.react","IGDSSpinner.react","PolarisFRXInAppEscalationReportTypeScreenModal.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportConfirmationScreenModal.react","PolarisFRXReportModalInterstitialScreen.react","PolarisFRXReportPolicyEducationScreenModal.react","PolarisFRXReportReviewScreenModal.react","PolarisFRXReportSelectVictimScreenModal.react","PolarisFRXReportTagSelectionScreenModal.react","PolarisFRXReportUtils","PolarisFRXWebReportActions","PolarisFRXWebReportConstants","PolarisFRXWebReportStateSelectors","PolarisFRXWebReportStrings","PolarisFRXWebReportUtils","PolarisReactRedux.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useState,k=e.c;function l(a){a.onClose&&a.onClose()}function m(a){var b=a.isFRXScreenRequestProcessing;a=a.onGoBackOneFRXScreen;a&&!b&&a()}function n(a,b){var c=a.frxMetadata,e=a.isFRXScreenRequestProcessing,f=a.onRequestNextFRXScreen,g=a.onStoreReportedTagTitle,h=a.reportedTagTitle;a=a.screenPayload;if(e)return;e=a||{};a=e.response;e=e.type;a=a||{};a=a.context;var i=b==null?void 0:b.selectedTagTypes;i=i!=null&&i.length>0?i[0]:null;var j=b==null?void 0:b.selectedTagTitles;j=j!=null&&j.length>0?j[0]:"";h===""&&i!=null&&d("PolarisFRXReportUtils").shouldUseTagType(i)&&j!==""&&g(j);h=d("PolarisFRXWebReportUtils").getNextFRXScreenInputRequestTypeFromScreenPayloadType(e);if(!h)return;f({context:a,frxPromptRequestType:h,metadata:c,optionalParams:b})}function a(a){var b=k(71),e=a.frxMetadata,f=a.hasMountedScreenFlow,g=a.hasPreviousScreens,h=a.isFRXScreenRequestProcessing,q=a.onSelectReportAd,r=a.reportedOwner,s=a.screenPayload,t=a.showFRXDropOffSurveyModal,u=a.threadId,v;b[0]!==a?(v=function(){return m(a)},b[0]=a,b[1]=v):v=b[1];var w;b[2]!==s||b[3]!==g||b[4]!==v?(w=d("PolarisFRXReportBaseScreenModal.react").getDefaultScreenModalHeaderParamsFromScreenPayload(s,g,v),b[2]=s,b[3]=g,b[4]=v,b[5]=w):w=b[5];g=w;v=j(!1);w=v[0];var x=v[1];b[6]!==a?(v=function(){x(!0),l(a)},b[6]=a,b[7]=v):v=b[7];var y=v;b[8]!==g||b[9]!==y?(v=i.jsx(p,{headerParams:g,onClose:y}),b[8]=g,b[9]=y,b[10]=v):v=b[10];v=v;if(!s){if(h||!f||w){b[11]!==g||b[12]!==y?(h=i.jsx(o,{headerParams:g,onClose:y}),b[11]=g,b[12]=y,b[13]=h):h=b[13];return h}return v}f=s.type;switch(f){case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.TAG_SELECTION:b[14]!==y||b[15]!==t?(w=function(){y(),t!=null&&t()},b[14]=y,b[15]=t,b[16]=w):w=b[16];b[17]!==a?(h=function(b){n(a,babelHelpers["extends"]({},b))},b[17]=a,b[18]=h):h=b[18];b[19]!==e||b[20]!==g||b[21]!==w||b[22]!==q||b[23]!==h||b[24]!==s?(f=i.jsx(c("PolarisFRXReportTagSelectionScreenModal.react"),{frxMetadata:e,headerParams:g,onClose:w,onSelectReportAd:q,onSubmitScreen:h,screenPayload:s}),b[19]=e,b[20]=g,b[21]=w,b[22]=q,b[23]=h,b[24]=s,b[25]=f):f=b[25];return f;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.POLICY_EDUCATION:b[26]!==y||b[27]!==t||b[28]!==a||b[29]!==r||b[30]!==u||b[31]!==g||b[32]!==s?(e=c("gkx")("4760")?i.jsx(c("PolarisFRXReportReviewScreenModal.react"),{headerParams:g,onClose:function(){y(),t!=null&&t()},onSubmitScreen:function(b){n(a,{responsible_id:r.id,selectedPromptButtonActionType:b,thread_id:u})},reportOwnerUsername:r.username,screenPayload:s}):i.jsx(c("PolarisFRXReportPolicyEducationScreenModal.react"),{headerParams:g,onClose:function(){y(),t!=null&&t()},onSubmitScreen:function(b){n(a,{responsible_id:r.id,selectedPromptButtonActionType:b,thread_id:u})},screenPayload:s}),b[26]=y,b[27]=t,b[28]=a,b[29]=r,b[30]=u,b[31]=g,b[32]=s,b[33]=e):e=b[33];return e;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.PROCESS_EDUCATION:b[34]!==a?(w=function(b){n(a,babelHelpers["extends"]({},b))},b[34]=a,b[35]=w):w=b[35];b[36]!==g||b[37]!==y||b[38]!==w||b[39]!==s?(q=i.jsx(c("PolarisFRXReportModalInterstitialScreen.react"),{headerParams:g,onClose:y,onSubmitScreen:w,screenPayload:s}),b[36]=g,b[37]=y,b[38]=w,b[39]=s,b[40]=q):q=b[40];return q;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.ESCALATION:b[41]!==a?(h=function(b){n(a,{selectedPromptButtonActionType:b})},b[41]=a,b[42]=h):h=b[42];b[43]!==g||b[44]!==y||b[45]!==h||b[46]!==s?(f=i.jsx(c("PolarisFRXReportModalInterstitialScreen.react"),{headerParams:g,onClose:y,onSubmitScreen:h,screenPayload:s}),b[43]=g,b[44]=y,b[45]=h,b[46]=s,b[47]=f):f=b[47];return f;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.CONFIRMATION:b[48]!==g||b[49]!==y||b[50]!==r||b[51]!==s?(e=i.jsx(c("PolarisFRXReportConfirmationScreenModal.react"),{headerParams:g,onClose:y,reportedOwner:r,screenPayload:s}),b[48]=g,b[49]=y,b[50]=r,b[51]=s,b[52]=e):e=b[52];return e;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.SELECT_VICTIM:b[53]!==y||b[54]!==t?(w=function(){y(),t!=null&&t()},b[53]=y,b[54]=t,b[55]=w):w=b[55];b[56]!==a?(q=function(b){n(a,{selectedVictimID:b.pk})},b[56]=a,b[57]=q):q=b[57];b[58]!==g||b[59]!==w||b[60]!==q||b[61]!==r||b[62]!==s?(h=i.jsx(c("PolarisFRXReportSelectVictimScreenModal.react"),{headerParams:g,onClose:w,onSelectVictim:q,reportedOwner:r,screenPayload:s}),b[58]=g,b[59]=w,b[60]=q,b[61]=r,b[62]=s,b[63]=h):h=b[63];return h;case d("PolarisFRXWebReportConstants").FRX_SCREEN_PAYLOAD_TYPE_INTS.IN_APP_ESCALATION_REPORT_TYPE:b[64]!==a?(f=function(b){n(a,babelHelpers["extends"]({},b))},b[64]=a,b[65]=f):f=b[65];b[66]!==g||b[67]!==y||b[68]!==f||b[69]!==s?(e=i.jsx(c("PolarisFRXInAppEscalationReportTypeScreenModal.react"),{headerParams:g,onClose:y,onSubmitScreen:f,screenPayload:s}),b[66]=g,b[67]=y,b[68]=f,b[69]=s,b[70]=e):e=b[70];return e;default:return v}}function o(a){var b=k(4),e=a.headerParams;a=a.onClose;var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=i.jsx(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",justifyContent:"center",minHeight:122,position:"relative",children:i.jsx(c("IGDSSpinner.react"),{})}),b[0]=f):f=b[0];b[1]!==e||b[2]!==a?(f=i.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:e,onClose:a,children:f}),b[1]=e,b[2]=a,b[3]=f):f=b[3];return f}function p(a){var b=k(3),c=a.headerParams;a=a.onClose;var e;b[0]!==c||b[1]!==a?(e=i.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:c,onClose:a,children:d("PolarisFRXWebReportStrings").DEFAULT_ERROR_MESSAGE_TEXT}),b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}function b(a){return{isFRXScreenRequestProcessing:d("PolarisFRXWebReportStateSelectors").getIsFRXScreenRequestProcessing(a),reportedTagTitle:d("PolarisFRXWebReportStateSelectors").getReportedTagTitle(a)}}f={onRequestNextFRXScreen:d("PolarisFRXWebReportActions").doRequestNextFRXScreenAction,onStoreReportedTagTitle:d("PolarisFRXWebReportActions").doStoreReportedTagTitle};e=d("PolarisReactRedux.react").connect(b,f)(a);g["default"]=e}),98);
__d("PolarisFRXUnfollowUserFollowupModal.react",["PolarisConnectionsLogger","PolarisUnfollowDialog.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(6),e=a.onClose;a=a.userToUnfollow;a=a.id;if(!a)return null;var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={},b[0]=f):f=b[0];var g;b[1]!==e?(g=function(){return e&&e()},b[1]=e,b[2]=g):g=b[2];b[3]!==g||b[4]!==a?(f=j.jsx(c("PolarisUnfollowDialog.react"),{analyticsContext:d("PolarisConnectionsLogger").CONNECTIONS_CONTAINER_MODULES.frx_web_reporting,analyticsExtra:f,onClose:g,userId:a}),b[3]=g,b[4]=a,b[5]=f):f=b[5];return f}g["default"]=a}),98);
__d("PolarisFRXReportModal.react",["IGDSBox.react","IGDSSpinner.react","PolarisFRXBlockUserFollowupModal.react","PolarisFRXNotifyGuardianFollowupModal.react","PolarisFRXReportBaseScreenModal.react","PolarisFRXReportConfirmationScreenModalForSupervision.react","PolarisFRXReportScreenModal.react","PolarisFRXUnfollowUserFollowupModal.react","PolarisFRXWebReportActions","PolarisFRXWebReportState","PolarisFRXWebReportStateSelectors","PolarisFRXWebReportStrings","PolarisReactRedux.react","PolarisReportConstants","nullthrows","react","usePolarisAnalyticsContext","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useEffect;e.useMemo;var k=e.useState,l=e.c;function m(a){var b=a.frxObjectType,c=a.isAfterConfirmationScreen,d=a.onClose,e=a.onConfirm,f=a.onDoReportingModalClosedAction;a=a.reportedObjectID;c&&e!=null&&e();f({isAfterConfirmationScreen:c,reportedObjectID:a,reportedObjectType:b});d&&d()}function n(a){a=a.onGoBackOneFRXScreen;a()}function o(a,b,c){if(b===!0){var d=a.onDoDisableNotifyGuardianOption;d()}d=a.onDoOpenNotifyGuardianFollowupModalToPreviousScreen;var e=a.reportedOwner.id;d(b,c,e,a.reportedTagTitle)}function p(a,b,c,d){var e=l(6),f=a.onRequestInitFRXScreen,g;e[0]!==b||e[1]!==f||e[2]!==d||e[3]!==c?(a=function(){b||(f(d),c(!0))},g=[c,b,d,f],e[0]=b,e[1]=f,e[2]=d,e[3]=c,e[4]=a,e[5]=g):(a=e[4],g=e[5]);j(a,g)}function a(a){var b=l(58),e=k(!1),f=e[0];e=e[1];var g=a.containerModule,h=a.currScreenPayload,j=a.currRenderStep,q=a.screenHistorySize,r=a.reportedObjectID,s=a.frxEntryPoint,t=a.frxLocation,u=a.frxObjectType,v=a.reportedOwner,w=a.showFRXDropOffSurveyModal,x=a.useSimpleBlockModalWithoutRefresh,y=a.threadId,z=a.threadKey,A=a.onSelectReportAd,B=a.isGroupThread,C=a.shouldReportAsInstamadillo;s=s===void 0?d("PolarisReportConstants").FRXEntryPoint.CHEVRON_BUTTON:s;var D=c("usePolarisAnalyticsContext")(),E=d("PolarisReactRedux.react").useDispatch();g=(g=g)!=null?g:D;b[0]!==g||b[1]!==s||b[2]!==t||b[3]!==r||b[4]!==u?(D={container_module:g,entry_point:s,location:t,object_id:r,object_type:u},b[0]=g,b[1]=s,b[2]=t,b[3]=r,b[4]=u,b[5]=D):D=b[5];g=D;s=g;p(a,f,e,s);b[6]!==a?(t=function(){return m(a)},b[6]=a,b[7]=t):t=b[7];r=t;D=q>1;b[8]!==a?(g=function(){return n(a)},b[8]=a,b[9]=g):g=b[9];b[10]!==h||b[11]!==D||b[12]!==g?(e=d("PolarisFRXReportBaseScreenModal.react").getDefaultScreenModalHeaderParamsFromScreenPayload(h,D,g),b[10]=h,b[11]=D,b[12]=g,b[13]=e):e=b[13];t=e;b[14]!==t||b[15]!==r?(D=i.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:t,onClose:r,children:d("PolarisFRXWebReportStrings").DEFAULT_ERROR_MESSAGE_TEXT}),b[14]=t,b[15]=r,b[16]=D):D=b[16];g=D;b[17]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx(c("IGDSBox.react"),{alignContent:"center",alignItems:"center",justifyContent:"center",minHeight:122,position:"relative",children:i.jsx(c("IGDSSpinner.react"),{})}),b[17]=e):e=b[17];b[18]!==t||b[19]!==r?(D=i.jsx(d("PolarisFRXReportBaseScreenModal.react").FRXReportBaseScreenModal,{headerParams:t,onClose:r,children:e}),b[18]=t,b[19]=r,b[20]=D):D=b[20];e=D;D=c("usePolarisViewer")();D!==null&&(D==null?void 0:D.guardianId)!==null&&(D==null?void 0:D.guardianId)!==""&&E(d("PolarisFRXWebReportActions").doStoreGuardianInformation(c("nullthrows")(D==null?void 0:D.guardianId)));E=d("PolarisReactRedux.react").useSelector(d("PolarisFRXWebReportStateSelectors").getGuardianUsername);switch(j){case d("PolarisFRXWebReportState").FRX_WEB_REPORT_RENDER_STEP_STRS.UNFOLLOW:b[21]!==r||b[22]!==v?(D=i.jsx(c("PolarisFRXUnfollowUserFollowupModal.react"),{onClose:r,userToUnfollow:v}),b[21]=r,b[22]=v,b[23]=D):D=b[23];return D;case d("PolarisFRXWebReportState").FRX_WEB_REPORT_RENDER_STEP_STRS.BLOCK:b[24]!==u||b[25]!==B||b[26]!==r||b[27]!==C||b[28]!==z||b[29]!==v||b[30]!==x?(j=i.jsx(c("PolarisFRXBlockUserFollowupModal.react"),{frxObjectType:u,isGroupThread:B,onClose:r,shouldReportAsInstamadillo:C,threadKey:z,userToBlock:v,useSimpleBlockModalWithoutRefresh:x}),b[24]=u,b[25]=B,b[26]=r,b[27]=C,b[28]=z,b[29]=v,b[30]=x,b[31]=j):j=b[31];return j;case d("PolarisFRXWebReportState").FRX_WEB_REPORT_RENDER_STEP_STRS.NOTIFY_GUARDIAN:b[32]!==a?(D=function(b,c){return o(a,b,c)},b[32]=a,b[33]=D):D=b[33];u=v==null?void 0:v.username;b[34]!==E||b[35]!==r||b[36]!==D||b[37]!==a.reportedTagTitle||b[38]!==u?(B=i.jsx(c("PolarisFRXNotifyGuardianFollowupModal.react"),{guardianUsername:E,onClose:r,onNotify:D,reportedTagTitle:a.reportedTagTitle,reportedUsername:u}),b[34]=E,b[35]=r,b[36]=D,b[37]=a.reportedTagTitle,b[38]=u,b[39]=B):B=b[39];return B;case d("PolarisFRXWebReportState").FRX_WEB_REPORT_RENDER_STEP_STRS.NOTIFY_GUARDIAN_FOLLOWUP:if(!h)return!f?e:g;b[40]!==t||b[41]!==r||b[42]!==v||b[43]!==h?(C=i.jsx(c("PolarisFRXReportConfirmationScreenModalForSupervision.react"),{headerParams:t,onClose:r,reportedOwner:v,screenPayload:h}),b[40]=t,b[41]=r,b[42]=v,b[43]=h,b[44]=C):C=b[44];return C;case d("PolarisFRXWebReportState").FRX_WEB_REPORT_RENDER_STEP_STRS.DEFAULT:default:z=q>1;b[45]!==a?(x=function(){return n(a)},b[45]=a,b[46]=x):x=b[46];b[47]!==s||b[48]!==f||b[49]!==z||b[50]!==r||b[51]!==x||b[52]!==A||b[53]!==v||b[54]!==h||b[55]!==w||b[56]!==y?(j=i.jsx(c("PolarisFRXReportScreenModal.react"),{frxMetadata:s,hasMountedScreenFlow:f,hasPreviousScreens:z,onClose:r,onGoBackOneFRXScreen:x,onSelectReportAd:A,reportedOwner:v,screenPayload:h,showFRXDropOffSurveyModal:w,threadId:y}),b[47]=s,b[48]=f,b[49]=z,b[50]=r,b[51]=x,b[52]=A,b[53]=v,b[54]=h,b[55]=w,b[56]=y,b[57]=j):j=b[57];return j}}function b(a){var b;return{currRenderStep:(b=d("PolarisFRXWebReportStateSelectors")).getCurrRenderStep(a),currScreenPayload:b.getCurrScreenPayload(a),isAfterConfirmationScreen:b.getIsConfirmationScreenInHistoryStack(a),reportedTagTitle:b.getReportedTagTitle(a),screenHistorySize:b.getScreenHistorySize(a)}}f={onDoDisableNotifyGuardianOption:d("PolarisFRXWebReportActions").doDisableNotifyGuardianOption,onDoOpenNotifyGuardianFollowupModalToPreviousScreen:d("PolarisFRXWebReportActions").doOpenNotifyGuardianFollowupModalToPreviousScreenAction,onDoReportingModalClosedAction:d("PolarisFRXWebReportActions").doReportingModalClosedAction,onGoBackOneFRXScreen:d("PolarisFRXWebReportActions").doGoBackOneFRXScreenAction,onRequestInitFRXScreen:d("PolarisFRXWebReportActions").doRequestInitFRXScreenAction};e=d("PolarisReactRedux.react").connect(b,f)(a);g["default"]=e}),98);
__d("polarisCommentSelectors.react",["PolarisPaginationUtils","PolarisReactRedux.react","nullthrows","polarisCreateSelectorWithArg","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;e=c("polarisCreateSelectorWithArg")(function(a){return a.comments.byId},function(a){return a.comments.byPostId},function(a,b){return function(e){e=b.get(e);if(e==null)return null;var f=e.commentIds;return f.toSeq().map(function(b){return c("nullthrows")(a.get(b))}).slice(f.count()-d("PolarisPaginationUtils").getVisibleCount(e.pagination),f.count()).filter(function(a){return!a.deleted&&!a.didReportAsSpam})}});f=c("polarisCreateSelectorWithArg")(function(a){return a.posts.byId},function(a){return a.comments.byId},function(a,b){return function(d){d=c("nullthrows")(a.get(d));d=d.previewCommentIds;return d==null?[]:d.map(function(a){return b.get(a)}).filter(Boolean)}});function a(a,b){return c("nullthrows")(a.comments.byId.get(b))}function b(a){var b=i(2),c;b[0]!==a?(c=function(b){return a==null?null:b.comments.translationById.get(a)},b[0]=a,b[1]=c):c=b[1];return d("PolarisReactRedux.react").useSelector(c)}g.selectVisibleCommentsForPostId=e;g.getPreviewCommentsForPostId=f;g.getCommentById=a;g.useCommentTranslation=b}),98);
__d("usePolarisComment",["PolarisReactRedux.react","polarisCommentSelectors.react","polarisUserSelectors","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a,b){var c=i(3),e;c[0]!==a||c[1]!==b?(e=function(c){c=d("polarisCommentSelectors.react").getCommentById(c,a);return b(c)},c[0]=a,c[1]=b,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}function b(a,b){var c=i(3),e;c[0]!==a||c[1]!==b?(e=function(c){var e=d("polarisCommentSelectors.react").getCommentById(c,a);c=d("polarisUserSelectors").getUserByIdOrThrows(c,e.userId);return b(e,c)},c[0]=a,c[1]=b,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}function c(a){var b=i(2),c;b[0]!==a?(c=function(b){return a==null?null:(b=b.comments.byId.get(a))!=null?b:null},b[0]=a,b[1]=c):c=b[1];return d("PolarisReactRedux.react").useSelector(c)}g.useComment=a;g.useCommentAndOwner=b;g.useCommentOrNull=c}),98);
__d("PolarisCommentTranslationPrompt.react",["fbt","CometPressable.react","IGDSText.react","PolarisCommentActions","PolarisReactRedux.react","polarisCommentSelectors.react","react","usePolarisComment"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.c;function a(a){var b,e=k(22),f=a.commentId,g=a.inFeed,i=a.isCaptionWithTranslation;a=a.isOverMedia;a=a===void 0?!1:a;var l=d("PolarisReactRedux.react").useDispatch();b=((b=d("usePolarisComment").useCommentOrNull(f))==null?void 0:b.hasTranslation)===!0;i=i===!0||b;b=d("polarisCommentSelectors.react").useCommentTranslation(f);var m=b==null?void 0:b.translatedText,n;e[0]!==f||e[1]!==m||e[2]!==l?(n=function(){if(f==null)return;m!=null?l(d("PolarisCommentActions").showCommentTranslatedText(f)):l(d("PolarisCommentActions").translateComment(f))},e[0]=f,e[1]=m,e[2]=l,e[3]=n):n=e[3];n=n;if(i!==!0)return null;i=g===!0?"primaryText":"secondaryText";if((b==null?void 0:b.loading)===!0){g=a?"webAlwaysWhite":i;var o;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._("__JHASH__ptT8MaSFAMY__JHASH__"),e[4]=o):o=e[4];e[5]!==g?(o=j.jsx(c("IGDSText.react").Body2Emphasized,{color:g,children:o}),e[5]=g,e[6]=o):o=e[6];return o}if((b==null?void 0:b.showTranslatedText)===!0){e[7]!==f||e[8]!==l?(g=function(){f!=null&&l(d("PolarisCommentActions").showCommentOriginalText(f))},e[7]=f,e[8]=l,e[9]=g):g=e[9];o=a?"webAlwaysWhite":i;e[10]===Symbol["for"]("react.memo_cache_sentinel")?(b=h._("__JHASH__S6WOgu9Fr2q__JHASH__"),e[10]=b):b=e[10];e[11]!==o?(b=j.jsx(c("IGDSText.react").Body2Emphasized,{color:o,children:b}),e[11]=o,e[12]=b):b=e[12];e[13]!==g||e[14]!==b?(o=j.jsx(c("CometPressable.react"),{onPress:g,overlayDisabled:!0,children:b}),e[13]=g,e[14]=b,e[15]=o):o=e[15];return o}g=a?"webAlwaysWhite":i;e[16]===Symbol["for"]("react.memo_cache_sentinel")?(b=h._("__JHASH__Q7Q4mAm1c2E__JHASH__"),e[16]=b):b=e[16];e[17]!==g?(o=j.jsx(c("IGDSText.react").Body2Emphasized,{color:g,children:b}),e[17]=g,e[18]=o):o=e[18];e[19]!==n||e[20]!==o?(a=j.jsx(c("CometPressable.react"),{onPress:n,overlayDisabled:!0,children:o}),e[19]=n,e[20]=o,e[21]=a):a=e[21];return a}g["default"]=a}),226);
__d("PolarisPostCaptionTranslationPrompt.react",["IGDSBox.react","PolarisCommentTranslationPrompt.react","react","usePolarisPost"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(6),e=a.inFeed,f=a.marginBottom;a=a.postId;f=f===void 0?0:f;var g=d("usePolarisPost").usePost(a,l);a=d("usePolarisPost").usePost(a,k);if(g!==!0||a==null)return null;b[0]!==a||b[1]!==e?(g=j.jsx(c("PolarisCommentTranslationPrompt.react"),{commentId:a,inFeed:e,isCaptionWithTranslation:!0}),b[0]=a,b[1]=e,b[2]=g):g=b[2];b[3]!==f||b[4]!==g?(a=j.jsx(c("IGDSBox.react"),{marginBottom:f,children:g}),b[3]=f,b[4]=g,b[5]=a):a=b[5];return a}function k(a){return a.captionCommentId}function l(a){return a.captionHasTranslation}g["default"]=a}),98);
__d("PolarisPostComment.react",["cx","fbt","IGDSBox.react","IGDSButton.react","IGDSIconButton.react","IGDSMoreHorizontalPanoOutlineIcon.react","IGDSText.react","IGDSVerifiedBadge.react","Locale","PolarisApproveCommentDialog.react","PolarisCommentActions","PolarisCommentLikeListsActions","PolarisCommentOptionsDialog.react","PolarisCommentTranslationPrompt.react","PolarisConfig","PolarisDoubleTappable","PolarisEngagementLogger","PolarisFastLink.react","PolarisIGCoreConstants","PolarisIgWellbeingRestrictManageCommentFalcoEvent","PolarisLikeButton.react","PolarisLinkBuilder","PolarisNavigationActions","PolarisPendingCommentActions","PolarisPostCaptionTranslationPrompt.react","PolarisPostGifComment.react","PolarisPostStrings","PolarisPostVariants","PolarisReactRedux.react","PolarisTimestamp.react","PolarisTruncatedText.react","PolarisUA","PolarisUserAvatarWithStories.react","PolarisUserHoverCard.react","PolarisUserText.react","PolarisViewpointReact.react","joinClasses","nullthrows","polarisPostSelectors","polarisUserSelectors","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=(j||(j=d("react"))).c,l=j,m=750;function n(a){var b=k(20),e=a.parentProps,f=e.commentOwnerId,g=e.commentOwnerUsername,h=e.isAuthorVerified,i=e.isCaption,j=e.isRestrictedPending,m=e.postOwnerIsUnpublished;e=e.showRichComment;h=h===void 0?!1:h;i=i===void 0?!1:i;m=m===void 0?!1:m;e=e===void 0?!1:e;a=j&&!a.parentState.showRestrictedContent;var n=i?"h2":"h3";if(a){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=l.jsx(c("IGDSBox.react"),{marginBottom:1,position:"relative",children:l.jsx(c("IGDSText.react"),{color:"tertiaryText",size:"body",weight:"semibold",children:d("PolarisPostStrings").RESTRICTED_ACCOUNT_HEADER_TEXT})}),b[0]=a):a=b[0];return a}else if(!i||m!==!0){a="_a9zc"+(j===!0?" _a9zd":"");b[1]!==g?(i=d("PolarisLinkBuilder").buildUserLink(c("nullthrows")(g)),b[1]=g,b[2]=i):i=b[2];b[3]!==g?(m=c("nullthrows")(g),b[3]=g,b[4]=m):m=b[4];b[5]!==i||b[6]!==m?(j=l.jsx(c("IGDSButton.react"),{display:"block",href:i,label:m,variant:"secondary_link"}),b[5]=i,b[6]=m,b[7]=j):j=b[7];b[8]!==f||b[9]!==g||b[10]!==j?(i=l.jsx(c("IGDSBox.react"),{marginEnd:1,position:"relative",children:l.jsx(c("PolarisUserHoverCard.react"),{display:"inline",userId:f,username:g,children:j})}),b[8]=f,b[9]=g,b[10]=j,b[11]=i):i=b[11];b[12]!==e||b[13]!==h?(m=e&&h&&l.jsx(c("IGDSBox.react"),{marginEnd:1,position:"relative",children:l.jsx(c("IGDSVerifiedBadge.react"),{size:"small"})}),b[12]=e,b[13]=h,b[14]=m):m=b[14];b[15]!==n||b[16]!==a||b[17]!==i||b[18]!==m?(f=l.jsxs(n,{className:a,children:[i,m]}),b[15]=n,b[16]=a,b[17]=i,b[18]=m,b[19]=f):f=b[19];return f}return null}function o(a){var b=k(10);a=a.parentProps;var e=a.captionCreatedAt,f=a.commentThreadId,g=a.disableTimestampNav,h=a.id,i=a.isCaption,j=a.isEdited,m=a.postedAt;a=a.postShortcode;i=i===void 0?!1:i;j=j===void 0?!1:j;i=i&&j&&e!=null?e:m;b[0]!==i?(j=l.jsx(c("PolarisTimestamp.react"),{className:"_a9ze _a9zf",value:i}),b[0]=i,b[1]=j):j=b[1];e=j;if(a!=null&&h!=null){b[2]!==f||b[3]!==h||b[4]!==a?(m=f!=null&&f!==h?d("PolarisLinkBuilder").buildReplyPermalink(a,f,h,d("PolarisUA").isMobile()):d("PolarisLinkBuilder").buildCommentPermalink(a,h,d("PolarisUA").isMobile()),b[2]=f,b[3]=h,b[4]=a,b[5]=m):m=b[5];i=m;j=g===!0?p:void 0;b[6]!==i||b[7]!==j||b[8]!==e?(f=l.jsx(c("PolarisFastLink.react"),{className:"_a9zg",href:i,onClick:j,children:e}),b[6]=i,b[7]=j,b[8]=e,b[9]=f):f=b[9];e=f}return e}function p(a){return a.preventDefault()}f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,e;for(var f=arguments.length,g=new Array(f),h=0;h<f;h++)g[h]=arguments[h];return(b=e=a.call.apply(a,[this].concat(g))||this,e.state={showApproveCommentDialog:!1,showCommentOptionsDialog:!1,showRestrictedContent:!1},e.$3=function(){e.setState({showCommentOptionsDialog:!0})},e.$4=function(){if(!d("PolarisUA").isMobile()||e.props.showRichComment!==!0||e.props.isCaption===!0)return;e.$1=window.setTimeout(e.$3,m)},e.$2=function(){window.clearTimeout(e.$1)},e.$5=function(){e.setState({showCommentOptionsDialog:!1})},e.$6=function(){e.setState({showCommentOptionsDialog:!1}),e.props.onDeleteComment()},e.$7=function(){var a=e.props,b=a.id;a=a.onDeleteCommentClick;a&&a(c("nullthrows")(b))},e.$8=function(a){var b=e.props,c=b.onLikeComment;b=b.onUnlikeComment;a?c():b()},e.$9=function(){var a=e.props,b=a.isRestrictedPending;b=b===void 0?!1:b;var c=a.likedByViewer;c=c===void 0?!1:c;var d=a.loggedIn;a=a.onLikeComment;!c&&!b&&d&&a()},e.$10=function(){var a=e.props,b=a.code,f=a.fetchCommentLikes,g=a.id,h=a.loggedIn,i=a.onLikeCountClick,j=a.onLoggedOutIntentClick;a=a.onLoggedOutIntentClickLoginModal;if(h)i&&(f(),i(c("nullthrows")(g)));else{h="post_comment_like_count";d("PolarisUA").isDesktop()?a(d("PolarisLinkBuilder").buildMediaLink(c("nullthrows")(b)),h):j(h)}},e.$11=function(a){var b=e.props,f=b.analyticsContext,g=b.commentOwnerId,h=b.commentThreadId,i=b.id,j=b.isRestrictedPending,k=b.mediaType,l=b.postId,m=b.postOwnerId;b=b.viewerId;switch(a.state){case"entered":if(i!=null&&b!=null){d("PolarisEngagementLogger").logCommentImpression({commentAuthorId:g,commentId:i,commentThreadId:h,containerModule:f,mediaAuthorId:m,mediaId:l,mediaType:k});j&&c("PolarisIgWellbeingRestrictManageCommentFalcoEvent").log({action:"impression",actorIgUserid:g,commentId:i,commentThreadId:h,parentMediaId:l,step:"pending_comment"});return}}},e.$12=function(){var a=e.props,b=a.code,f=a.loggedIn,g=a.onLoggedOutIntentClick,h=a.onLoggedOutIntentClickLoginModal;a=a.onReplyClick;if(f)a();else{f="post_comment_reply";d("PolarisUA").isDesktop()?h(d("PolarisLinkBuilder").buildMediaLink(c("nullthrows")(b)),f):g(f)}},e.$13=function(){var a=e.props,b=a.commentOwnerId,d=a.commentThreadId,f=a.id;a=a.postId;c("PolarisIgWellbeingRestrictManageCommentFalcoEvent").log({action:"click",actorIgUserid:b,commentId:f,commentThreadId:d,parentMediaId:a,step:"pending_comment_see_hidden"});e.setState({showRestrictedContent:!0})},e.$14=function(){var a=e.props,b=a.commentOwnerId,d=a.commentThreadId,f=a.id;a=a.postId;c("PolarisIgWellbeingRestrictManageCommentFalcoEvent").log({action:"click",actorIgUserid:b,commentId:f,commentThreadId:d,parentMediaId:a,step:"pending_comment_approve"});e.setState({showApproveCommentDialog:!0})},e.$15=function(){e.setState({showApproveCommentDialog:!1})},e.$16=function(){var a=e.props,b=a.commentOwnerId,d=a.commentThreadId,f=a.id;a=a.postId;c("PolarisIgWellbeingRestrictManageCommentFalcoEvent").log({action:"click",actorIgUserid:b,commentId:f,commentThreadId:d,parentMediaId:a,step:e.state.showRestrictedContent?"pending_comment_delete":"pending_comment_delete_hidden"});e.$7()},b)||babelHelpers.assertThisInitialized(e)}var e=b.prototype;e.componentWillUnmount=function(){this.$2()};e.$17=function(){var a=this.props,b=a.code,e=a.id,f=a.likeCount;a=a.loggedIn;if(f==null||f===0)return null;var g=f.toLocaleString(),h=i._("__JHASH__7PgeOKK7Hd0__JHASH__",[i._param("like count",g)]);g=i._("__JHASH__-wTB86PYRly__JHASH__",[i._param("like count",g)]);h=f===1?h:g;return f>0&&(d("PolarisUA").isDesktop()||!a?l.jsx("button",{className:"_a9ze",onClick:this.$10,children:l.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:h})}):l.jsx(c("PolarisFastLink.react"),{className:"_a9ze _amp7",href:"/p/"+c("nullthrows")(b)+"/c/"+c("nullthrows")(e)+"/liked_by/",children:h}))};e.render=function(){var a=this,b=this.props,e=b.className,f=b.commentingDisabledForViewer,g=b.commentOwnerAvatar,h=b.commentOwnerId,i=b.commentOwnerUsername,j=b.commentThreadId,k=b.customPaddingStyle,m=b.giphyMediaInfo,p=b.hideUserAvatar,q=p===void 0?!1:p,r=b.id;p=b.isCaption;var s=p===void 0?!1:p;p=b.isEdited;var t=p===void 0?!1:p;p=b.isPermalinkedComment;p=p===void 0?!1:p;var u=b.isRestrictedPending,v=b.likedByViewer,w=b.postId,x=b.postOwnerId,y=b.postOwnerIsUnpublished,z=b.reducedAvatarMargin,A=b.showCommentOptionsInline,B=A===void 0?!1:A;A=b.showRemoveIcon;var C=b.showRichComment,D=C===void 0?!1:C;C=b.translation;var E=b.variant;b=b.viewerId;var F=this.props.text.toString();(C==null?void 0:C.showTranslatedText)===!0&&C.translatedText!=null&&(F=C.translatedText);var G=!s&&b!=null&&(b===h||x===b),H=G&&A&&!D,I=!s&&b!=null&&!H&&!u;C=d("PolarisConfig").isLoggedOutFRXEligible()&&p;var J=C||D&&!d("PolarisUA").isMobile()&&!s&&b!=null,K=E===d("PolarisPostVariants").VARIANTS.feed?c("PolarisTruncatedText.react"):c("PolarisUserText.react"),L=!!s||!I&&!G,M=u&&!this.state.showRestrictedContent,N=u&&this.state.showRestrictedContent;A=m!=null;var O=A?(b=m==null?void 0:(p=m.first_party_cdn_proxied_images)==null?void 0:(C=p.fixed_height)==null?void 0:C.url)!=null?b:m==null?void 0:(E=m.images)==null?void 0:(A=E.fixed_height)==null?void 0:A.url:void 0,P=l.jsx("div",{className:B===!0?"_a9ze":"",children:l.jsx("div",{className:(B!==!0?"_a9zh":"")+(B===!0?" _a9zi":""),children:l.jsx(c("IGDSIconButton.react"),{"data-testid":void 0,onClick:this.$3,children:l.jsx(c("IGDSBox.react"),{alignItems:"center",height:24,justifyContent:"center",position:"relative",width:24,children:l.jsx(c("IGDSMoreHorizontalPanoOutlineIcon.react"),{alt:d("PolarisPostStrings").COMMENT_OPTIONS_ALT_TEXT,color:"ig-secondary-text"})})})})});return l.jsx(d("PolarisViewpointReact.react").Viewpoint,{action:this.$11,id:F.replace(" ","-"),children:function(b){return l.jsxs(d("PolarisDoubleTappable").DoubleTappable,{onDoubleClick:a.$9,role:"button",children:[l.jsx("li",{className:c("joinClasses")((D?"_a9zj":"")+(k==="compact"?" _a9zk":"")+" _a9zl",e),onMouseDown:a.$4,onMouseUp:a.$2,onTouchEnd:a.$2,onTouchMove:a.$2,onTouchStart:a.$4,ref:b,children:l.jsxs("div",{className:"_a9zm","data-testid":void 0,children:[l.jsxs("div",{className:(L?"_a9zn":"")+" _a9zo",children:[D&&!q&&l.jsx(c("PolarisUserHoverCard.react"),{display:"block",userId:h,username:i,children:l.jsx(c("PolarisUserAvatarWithStories.react"),{className:"_a9zp"+(z===!0?" _a9zq":"")+(u===!0?" _a9zd":""),isLink:!y,profilePictureUrl:(b=g)!=null?b:"",size:c("PolarisIGCoreConstants").AVATAR_SIZES.small,storyEntrypoint:"post_comment",username:i})}),l.jsxs("div",{className:"_a9zr",children:[l.jsx(n,{parentProps:a.props,parentState:a.state}),!M&&(O!=null?l.jsx(c("PolarisPostGifComment.react"),{gifSrc:O}):l.jsx("div",{className:"_a9zs"+(u===!0?" _a9zd":""),"data-testid":void 0,children:l.jsx(K,{display:"inline",headlineTag:s===!0?"h1":void 0,size:"body",value:F})})),D&&l.jsx(c("IGDSBox.react"),{marginBottom:1,marginTop:2,position:"relative",children:l.jsxs(c("IGDSText.react").Body2,{color:"secondaryText",dir:c("Locale").isRTL()?"rtl":"ltr",children:[s&&t&&l.jsxs(l.Fragment,{children:[d("PolarisPostStrings").CAPTION_EDITED_TEXT,"\xa0\xb7\xa0"]}),l.jsx(o,{parentProps:a.props}),s&&l.jsx(c("IGDSBox.react"),{display:"inlineBlock",position:"relative",children:l.jsx(c("PolarisPostCaptionTranslationPrompt.react"),{postId:w})}),!s&&!u&&l.jsxs(l.Fragment,{children:[a.$17(),f!==!0&&l.jsx("button",{className:"_a9ze",onClick:a.$12,children:l.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:d("PolarisPostStrings").REPLY_TEXT})}),r!=null&&l.jsx(c("IGDSBox.react"),{display:"inlineBlock",marginEnd:2,position:"relative",children:l.jsx(c("PolarisCommentTranslationPrompt.react"),{commentId:r})}),J&&B===!0&&P]}),M&&l.jsx("button",{className:"_a9ze",onClick:a.$13,children:l.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:d("PolarisPostStrings").RESTRICT_SEE_COMMENT_TEXT})}),N&&l.jsx("button",{className:"_a9ze",onClick:a.$14,children:l.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:d("PolarisApproveCommentDialog.react").APPROVE_COMMENT_CTA})}),u&&l.jsx("button",{className:"_a9ze",onClick:a.$16,children:l.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:d("PolarisPostStrings").RESTRICT_DELETE_COMMENT_TEXT})})]})})]})]}),H&&l.jsx("button",{className:"_a9zt",onClick:a.$7,title:d("PolarisPostStrings").DELETE_COMMENT_TEXT,children:l.jsx(c("IGDSText.react"),{color:"tertiaryText",size:"footnote",weight:"semibold",zeroMargin:!0,children:d("PolarisPostStrings").DELETE_COMMENT_TEXT})}),J&&!B&&P,I&&l.jsx(c("PolarisLikeButton.react"),{className:"_a9zu",isLiked:!!v,onChange:a.$8,padding:0,size:12})]})}),a.state.showCommentOptionsDialog&&r!=null&&l.jsx(c("PolarisCommentOptionsDialog.react"),{canDeleteComment:!!G,commentId:r,commentOwnerAvatar:(b=g)!=null?b:"",commentOwnerId:h,commentOwnerUsername:i,mediaOwnerId:x,onClose:a.$5,onDelete:a.$6}),a.state.showApproveCommentDialog&&r!=null&&l.jsx(d("PolarisApproveCommentDialog.react").ApproveCommentDialog,{commentId:r,commentOwnerId:h,commentOwnerUsername:i,commentThreadId:j,onClose:a.$15,postId:w})]})}})};return b}(l.PureComponent);f.defaultProps={showRichComment:!1};function a(a,b){var e=b.commentOwnerId,f=b.postId,g=b.postOwnerId;e=d("polarisUserSelectors").getUserByIdOrThrows(a,e);f=d("polarisPostSelectors").getPostOrNullById(a,f);b=b.id;b==null&&(b=f==null?void 0:f.captionCommentId);return{commentOwnerAvatar:e.profilePictureUrl,commentOwnerId:c("nullthrows")(e.id),commentOwnerUsername:c("nullthrows")(e.username),postOwnerIsUnpublished:d("polarisUserSelectors").getUserByIdOrThrows(a,g).isUnpublished,postShortcode:f&&f.code,translation:b!=null?a.comments.translationById.get(b):null,viewerId:a.users.viewerId}}function b(a,b){var e={commentAuthorId:b.commentOwnerId,commentId:b.id||"",containerModule:b.analyticsContext,mediaAuthorId:b.postOwnerId,mediaId:b.id||"",mediaType:b.mediaType||0};return{fetchCommentLikes:function(){return a(d("PolarisCommentLikeListsActions").requestCommentLikes(c("nullthrows")(b.id)))},onDeleteComment:function(){return a(d("PolarisCommentActions").deleteComment(b.postId,b.id||"",b.analyticsContext))},onLikeComment:function(b){return a(d("PolarisCommentActions").likeComment(babelHelpers["extends"]({},e,{userId:b||""})))},onLoggedOutIntentClick:function(b){a(d("PolarisNavigationActions").openLoggedOutIntentDialog(b))},onLoggedOutIntentClickLoginModal:function(b,c,e){var f=d("PolarisUA").isDesktop()||d("PolarisConfig").isLoggedOutFRXEligible()?"feature_wall":"content_wall";a(d("PolarisNavigationActions").openLoginModal(f,b,c,e,b))},onReplyClick:function(e){return a(d("PolarisPendingCommentActions").changePendingComment(b.postId,"@"+(e||"")+" ",c("nullthrows")(b.commentThreadId),b.commentOwnerId,e))},onUnlikeComment:function(b){return a(d("PolarisCommentActions").unlikeComment(babelHelpers["extends"]({},e,{userId:b||""})))}}}function e(a,b,c){return babelHelpers["extends"]({},a,b,c,{onLikeComment:function(){return b.onLikeComment(a.viewerId)},onReplyClick:function(){return b.onReplyClick(a.commentOwnerUsername)},onUnlikeComment:function(){return b.onUnlikeComment(a.viewerId)}})}h=d("PolarisReactRedux.react").connect(a,b,e)(f);g["default"]=h}),226);
__d("PolarisThreadedCommentSelectors",["PolarisPaginationUtils","immutable-4.0.0-rc.9","nullthrows","polarisCreateSelectorWithArg"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return!a.deleted&&!a.didReportAsSpam}b=c("polarisCreateSelectorWithArg")(function(a){return a.posts.byId},function(a){return a.comments.byId},function(a){return a.threadedComments.parentByPostId},function(a,b,e){return function(f){var g=e[f];f=a.get(f);if(!g||!f)return d("immutable-4.0.0-rc.9").List();var i=g.commentIds;g=d("PolarisPaginationUtils").getVisibleCount(g.pagination);f=f.hasRankedComments===!0?0:i.count()-g;return i.map(function(a){return c("nullthrows")(b.get(a))}).slice(f,f+g).filter(function(a){return h(a)})}});e=c("polarisCreateSelectorWithArg")(function(a){return a.comments.byId},function(a){return a.threadedComments.childByParentId},function(a,b){return function(e){e=c("nullthrows")(b[e]);var f=e.commentIds;e=e.pagination;f=f.map(function(b){return c("nullthrows")(a.get(b))});e=f.count()-d("PolarisPaginationUtils").getVisibleCount(e);var g=f.slice(e,f.count()).filter(function(a){return h(a)});f=f.slice(0,e).filter(function(a){return h(a)});e=f.map(function(a){return a.id});return{remainingCachedShowableChildCommentIds:e,visibleChildComments:g}}});f=c("polarisCreateSelectorWithArg")(function(a){return a.comments.byId},function(a){return a.threadedComments.childByParentId},function(a,b){return function(a){a=c("nullthrows")(b[a]);return a.count||0}});function a(a,b){return!!a.threadedComments.initialCommentsLoading[b]}g.selectVisibleParentCommentsForPostId=b;g.selectChildCommentsForParentIdSplitByVisibility=e;g.getTotalChildCommentCountForParentId=f;g.getThreadedCommentsLoading=a}),98);
__d("PolarisCommentThread.react",["cx","fbt","IGDSBox.react","IGDSSpinner.react","PolarisConfig","PolarisIGCoreButton.react","PolarisInteractionsLogger","PolarisPaginationUtils","PolarisPostComment.react","PolarisPostVariants","PolarisReactRedux.react","PolarisThreadedCommentActions","PolarisThreadedCommentSelectors","isStringNullOrEmpty","nullthrows","polarisCommentReducer","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=(j||(j=d("react"))).c,l=j;function m(a){var b=k(24),e=a.childComment,f=a.disableTimestampNav;a=a.parentProps;var g=a.analyticsContext,h=a.code,i=a.commentingDisabledForViewer,j=a.hideUserAvatar,m=a.loggedIn,n=a.onDeleteCommentClick,o=a.onLikeCountClick,p=a.parentComment,q=a.postId,r=a.postOwnerId,s=a.reducedAvatarMargin,t=a.showCommentOptionsInline;a=a.showRemoveIcon;j=!!j;var u;b[0]!==g||b[1]!==h||b[2]!==i||b[3]!==e.userId||b[4]!==e.giphyMediaInfo||b[5]!==e.id||b[6]!==e.isAuthorVerified||b[7]!==e.isRestrictedPending||b[8]!==e.likeCount||b[9]!==e.likedByViewer||b[10]!==e.postedAt||b[11]!==e.text||b[12]!==p.id||b[13]!==f||b[14]!==j||b[15]!==m||b[16]!==n||b[17]!==o||b[18]!==q||b[19]!==r||b[20]!==s||b[21]!==t||b[22]!==a?(u=l.jsx(c("PolarisPostComment.react"),{analyticsContext:g,className:"_a9ye",code:h,commentingDisabledForViewer:i,commentOwnerId:e.userId,commentThreadId:p.id,disableTimestampNav:f,giphyMediaInfo:e.giphyMediaInfo,hideUserAvatar:j,id:e.id,isAuthorVerified:e.isAuthorVerified,isRestrictedPending:e.isRestrictedPending,likeCount:e.likeCount,likedByViewer:e.likedByViewer,loggedIn:m,onDeleteCommentClick:n,onLikeCountClick:o,postedAt:e.postedAt,postId:q,postOwnerId:r,reducedAvatarMargin:s,showCommentOptionsInline:t,showRemoveIcon:a,showRichComment:!0,text:e.text,variant:d("PolarisPostVariants").VARIANTS.flexible},e.id),b[0]=g,b[1]=h,b[2]=i,b[3]=e.userId,b[4]=e.giphyMediaInfo,b[5]=e.id,b[6]=e.isAuthorVerified,b[7]=e.isRestrictedPending,b[8]=e.likeCount,b[9]=e.likedByViewer,b[10]=e.postedAt,b[11]=e.text,b[12]=p.id,b[13]=f,b[14]=j,b[15]=m,b[16]=n,b[17]=o,b[18]=q,b[19]=r,b[20]=s,b[21]=t,b[22]=a,b[23]=u):u=b[23];return u}b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={hasPermalinkedReplyBeenHidden:!1},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.componentDidUpdate=function(a,b){(a.parentComment.id!==this.props.parentComment.id||a.permalinkedReplyId!==this.props.permalinkedReplyId)&&this.setState({hasPermalinkedReplyBeenHidden:!1})};e.$1=function(){var a=this.props,b=a.childCommentsCacheCanShowMoreWithoutFetch,c=a.childCommentsCanFetchMorePagination,d=a.childCommentsHasNextPage,e=a.permalinkedReply;a=a.remainingCachedShowableChildCommentIds;return e!=null&&d===!0&&b===!0&&c!==!0&&a.count()===1&&a.get(0)===e.id};e.$2=function(a){var b=this.props.childCommentsHasNextPage;return b!==!0||a&&this.$1()};e.$3=function(a){var b=this.props,c=b.analyticsContext,e=b.childCommentsCacheCanShowMoreWithoutFetch,f=b.childCommentsIsFetching,g=b.hideReplies,h=b.loadChildComments,i=b.loadChildCommentsV2,j=b.onHidePermalinkReply,k=b.parentComment,l=k.id;k=k.userId;var m=b.permalinkedReply,n=b.postId,o=b.postOwnerId;b=b.showReplies;if(f)return;else a?(g(l),d("PolarisInteractionsLogger").logInteractionAction({commentAuthorId:k,commentId:l,containerModule:c,eventName:"instagram_child_comments_collapse",mediaAuthorId:o,mediaId:n}),m!=null&&(j!=null&&j(),this.setState({hasPermalinkedReplyBeenHidden:!0}))):e?b(l):d("PolarisConfig").isLoggedIn()?i(n,l):h(l)};e.$4=function(a,b){var d=this,e=this.props,f=e.childCommentsIsFetching,g=e.replyPagerNodeRef;e=e.totalChildCommentCount;var h=this.$2(b),j=b?1:0;j=a+j;e=e-j;h&&!f?j=i._("__JHASH__l0QlXOkD0E9__JHASH__"):e<=0?j=i._("__JHASH__obWV52hm5rV__JHASH__"):j=i._("__JHASH__vGrwkOmYrh5__JHASH__",[i._param("hidden replies",e)]);return l.jsx("li",{className:"_a9yg",ref:g,children:l.jsxs(c("IGDSBox.react"),{direction:"row",marginBottom:a>0?4:0,marginTop:b?2:0,position:"relative",children:[l.jsxs(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:function(){return d.$3(h)},children:[l.jsx("div",{className:"_a9yh"}),l.jsx("span",{className:"_a9yi",children:j})]}),f&&l.jsx("div",{className:"_a9yj",children:l.jsx(c("IGDSSpinner.react"),{size:"small"})})]})})};e.render=function(){var a=this,b=this.props,e=b.analyticsContext,f=b.code,g=b.commentingDisabledForViewer,h=b.customIndentationPadding,i=b.hideUserAvatar,j=b.innerRef,k=b.isPermalinkedComment,n=b.loggedIn,o=b.onDeleteCommentClick,p=b.onLikeCountClick,q=b.parentComment,r=b.permalinkedReply,s=b.permalinkedReplyAnimating,t=b.permalinkedReplyId,u=b.permalinkedReplyNodeRef,v=b.postId,w=b.postOwnerId,x=b.reducedAvatarMargin,y=b.showCommentOptionsInline,z=b.showRemoveIcon,A=b.totalChildCommentCount;b=b.visibleChildComments;var B=this.state.hasPermalinkedReplyBeenHidden,C=null;r&&!(B&&b.count()===0)&&(C=l.jsx("div",{className:"_a9yk"+(s===!0&&!B?" _a9yl":""),ref:u,children:l.jsx(m,{childComment:r,disableTimestampNav:!0,parentProps:this.props})}));s=b.map(function(b,d){return C&&c("nullthrows")(r).id===b.id?null:l.jsx(m,{childComment:b,parentProps:a.props},d)}).filter(function(a){return a!=null});B=this.$4(s.count(),C!=null);u=h!=null?{margin:"12px 0 0 "+h+"px",width:"calc(100% - "+h+"px)"}:void 0;return l.jsxs("ul",{className:"_a9ym",ref:j,children:[l.jsx(c("PolarisPostComment.react"),{analyticsContext:e,code:f,commentingDisabledForViewer:g,commentOwnerId:q.userId,commentThreadId:q.id,disableTimestampNav:k===!0&&t==null,giphyMediaInfo:q.giphyMediaInfo,hideUserAvatar:!!i,id:q.id,isAuthorVerified:q.isAuthorVerified,isPermalinkedComment:k,isRestrictedPending:q.isRestrictedPending,likeCount:q.likeCount,likedByViewer:q.likedByViewer,loggedIn:n,onDeleteCommentClick:o,onLikeCountClick:p,postedAt:q.postedAt,postId:v,postOwnerId:w,reducedAvatarMargin:x,showCommentOptionsInline:y,showRemoveIcon:z,showRichComment:!0,text:q.text,variant:d("PolarisPostVariants").VARIANTS.flexible}),A!==0&&l.jsx("li",{children:l.jsxs("ul",{className:"_a9yo",style:u,children:[C,B,s]})})]})};return b}(l.Component);function a(a,b){var e=b.parentComment;b=b.permalinkedReplyId;var f=d("PolarisThreadedCommentSelectors").selectChildCommentsForParentIdSplitByVisibility(a,e.id),g=f.remainingCachedShowableChildCommentIds;f=f.visibleChildComments;var h=d("PolarisThreadedCommentSelectors").getTotalChildCommentCountForParentId(a,e.id);e=(e=a.threadedComments.childByParentId[e.id])!=null?e:d("polarisCommentReducer").EMPTY_POST_COMMENTS_STATE;e=e.pagination;var i=null;c("isStringNullOrEmpty")(b)||(i=a.comments.byId.get(b));return{childCommentsCacheCanShowMoreWithoutFetch:d("PolarisPaginationUtils").getVisibleCount(e)<d("PolarisPaginationUtils").getLoadedCount(e),childCommentsCanFetchMorePagination:d("PolarisPaginationUtils").canFetchMorePagination(e),childCommentsHasNextPage:d("PolarisPaginationUtils").hasNextPage(e),childCommentsIsFetching:d("PolarisPaginationUtils").isFetching(e),permalinkedReply:i,remainingCachedShowableChildCommentIds:g,totalChildCommentCount:h||0,visibleChildComments:f}}e={hideReplies:d("PolarisThreadedCommentActions").hideChildComments,loadChildComments:d("PolarisThreadedCommentActions").requestNextChildCommentPage,loadChildCommentsV2:d("PolarisThreadedCommentActions").requestNextChildCommentPageV2,showReplies:d("PolarisThreadedCommentActions").showChildComments};f=d("PolarisReactRedux.react").connect(a,e)(b);g["default"]=f}),226);
__d("PolarisDeleteCommentModal.react",["fbt","IGCoreDialog.react","PolarisCommentActions","PolarisGenericStrings","PolarisReactRedux.react","polarisLogAction","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(15),e=a.analyticsContext,f=a.commentId,g=a.onClose,i=a.postId,l=d("PolarisReactRedux.react").useDispatch();b[0]!==e||b[1]!==l||b[2]!==i||b[3]!==f||b[4]!==g?(a=function(a){c("polarisLogAction")("commentDelete",{source:e}),l(d("PolarisCommentActions").deleteComment(i,f,e)),g(a)},b[0]=e,b[1]=l,b[2]=i,b[3]=f,b[4]=g,b[5]=a):a=b[5];a=a;var m;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._("__JHASH__-8Hu0_GPJrv__JHASH__"),b[6]=m):m=b[6];b[7]!==a?(m=k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{color:"ig-error-or-destructive",onClick:a,children:m}),b[7]=a,b[8]=m):m=b[8];b[9]!==g?(a=k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{onClick:g,children:d("PolarisGenericStrings").CANCEL_TEXT}),b[9]=g,b[10]=a):a=b[10];var n;b[11]!==g||b[12]!==m||b[13]!==a?(n=k.jsxs(d("IGCoreDialog.react").IGCoreDialog,{onModalClose:g,children:[m,a]}),b[11]=g,b[12]=m,b[13]=a,b[14]=n):n=b[14];return n}g["default"]=a}),226);
__d("PolarisEmbedHashHelpers",["memoize"],(function(a,b,c,d,e,f,g){"use strict";a=c("memoize")(function(){var a=window.location.hash;a=decodeURIComponent(a.substring(a.indexOf("#")+1));try{a=JSON.parse(a)}catch(b){a={}}return{clientId:a.ci,offset:a.os,sdkLoadEnd:a.le,sdkLoadStart:a.ls}});g.getHashPayload=a}),98);
__d("polarisGetEmbedRequestID",["nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("nullthrows")(document.querySelector(".Embed"));return a.getAttribute("data-request-id")}g["default"]=a}),98);
__d("PolarisEmbedLogger",["InstagramQueryParamsHelper","PolarisEmbedHashHelpers","PolarisLogger","PolarisLoggerUtils","PolarisPigeonLogger","gkx","polarisGetEmbedRequestID"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=d("PolarisLoggerUtils").trimAndSanitizeUrl(a||window.location.href);var b=c("polarisGetEmbedRequestID")();return b!=null?d("InstagramQueryParamsHelper").appendQueryParams(a,{ig_rid:b}):a}function a(a,b,e){if(!c("gkx")("25394"))return;var f=d("PolarisLogger").getExtra(),g=f.url;f=babelHelpers.objectWithoutPropertiesLoose(f,["url"]);a=babelHelpers["extends"]({client_id:d("PolarisEmbedHashHelpers").getHashPayload().clientId,event_name:a.actionName,is_copyright_blocked:a.isCopyrightBlocked,media_id:a.mediaId,media_type:a.mediaType,owner_id:a.ownerId===""?null:a.ownerId},f);f=babelHelpers["extends"]({obj_id:h(g),obj_type:"url"},e);d("PolarisLogger").logPigeonEvent(d("PolarisPigeonLogger").createEvent("instagram_web_embeds",a,f),b)}function i(a,b,c){var e=d("PolarisLogger").getAnonymousExtra(),f=e.url;e=babelHelpers.objectWithoutPropertiesLoose(e,["url"]);a=babelHelpers["extends"]({client_id:d("PolarisEmbedHashHelpers").getHashPayload().clientId,event_name:a.actionName,is_copyright_blocked:a.isCopyrightBlocked,media_id:a.mediaId,media_type:a.mediaType,owner_id:a.ownerId===""?null:a.ownerId},e);e=babelHelpers["extends"]({obj_id:h(f),obj_type:"url"},c);d("PolarisLogger").logPigeonEvent(d("PolarisPigeonLogger").createEvent("instagram_web_embeds_anonymous",a,e),b)}function b(a){var b=a.isCopyrightBlocked,c=a.mediaId,d=a.mediaType;a=a.ownerId;i({actionName:"view",isCopyrightBlocked:b,mediaId:c,mediaType:d,ownerId:a})}function e(a,b,e){if(!c("gkx")("25394"))return;a=d("PolarisLogger").getExtra(a);var f=a.url;a=babelHelpers.objectWithoutPropertiesLoose(a,["url"]);a=babelHelpers["extends"]({client_id:d("PolarisEmbedHashHelpers").getHashPayload().clientId,parent_url:window.document.referrer},a);f=babelHelpers["extends"]({obj_id:h(f),obj_type:"url"},e);d("PolarisLogger").logPigeonEvent(d("PolarisPigeonLogger").createEvent("instagram_web_embed_perf_events",a,f),b)}g.logEmbedAction=a;g.logEmbedPageView=b;g.logEmbedTimings=e}),98);
__d("PolarisEmbedVideoWatchAgain.react",["cx","fbt","PolarisEmbedLogger","PolarisFastLink.react","PolarisLinkBuilder","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=(j||(j=d("react"))).c,l=j,m=i._("__JHASH__WT4Q1op-CT7__JHASH__"),n=i._("__JHASH__IQuGN-11QOS__JHASH__"),o="https://www.instagram.com";function p(a){var b=k(4),d=a.className,e=a.href;a=a.onClick;var f;b[0]!==d||b[1]!==e||b[2]!==a?(f=l.jsx(c("PolarisFastLink.react"),{"aria-label":m,className:d,href:e,onClick:a,target:"_blank"}),b[0]=d,b[1]=e,b[2]=a,b[3]=f):f=b[3];return f}function a(a){var b=k(18),e=a.post;a=e.code;a=a!=null&&a.length>0?d("PolarisLinkBuilder").buildMediaLink(a):"";a=""+o+a+"?utm_source=ig_embed&utm_campaign=embed_video_watch_again";var f;b[0]!==e.id||b[1]!==e.owner?(f=function(){var a;d("PolarisEmbedLogger").logEmbedAction({actionName:"videoWatchAgainClick",mediaId:e.id,mediaType:"video",ownerId:((a=e.owner)==null?void 0:a.id)||""})},b[0]=e.id,b[1]=e.owner,b[2]=f):f=b[2];f=f;var g;b[3]!==a||b[4]!==f?(g=l.jsx(c("PolarisFastLink.react"),{"aria-label":n,className:"_aarb _9zwu",href:a,onClick:f,target:"_blank"}),b[3]=a,b[4]=f,b[5]=g):g=b[5];var h;b[6]!==a||b[7]!==f?(h=l.jsx(c("PolarisFastLink.react"),{"aria-label":n,className:"_aarc",href:a,onClick:f,target:"_blank",children:n}),b[6]=a,b[7]=f,b[8]=h):h=b[8];var i;b[9]!==g||b[10]!==h?(i=l.jsx("div",{className:"_aar9",children:l.jsxs("div",{className:"_aara",children:[g,h]})}),b[9]=g,b[10]=h,b[11]=i):i=b[11];b[12]!==a||b[13]!==f?(g=l.jsx(p,{className:"_aard",href:a,onClick:f}),b[12]=a,b[13]=f,b[14]=g):g=b[14];b[15]!==i||b[16]!==g?(h=l.jsxs(l.Fragment,{children:[i,g]}),b[15]=i,b[16]=g,b[17]=h):h=b[17];return h}g["default"]=a}),226);
__d("PolarisEmbedVideo.react",["cx","PolarisEmbedLogger","PolarisEmbedVideoWatchAgain.react","PolarisUserTagIndicatorWithSheet.react","PolarisVideoHeight","PolarisVideoPlayButton.react","Run","joinClasses","keyMirror","nullthrows","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k="video/mp4",l=c("keyMirror")({finished:null,paused:null,playing:null}),m="embedVideo";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.$1=j.createRef();c.$2=!1;c.$3=null;c.handleVisiblityChange=function(){c.state.playerState!=null&&document.visibilityState&&document.visibilityState==="hidden"&&c.stop()};c.handleBeforeUnload=function(){c.state.playerState===l.playing&&c.stop()};c.handlePlayerPlayEvent=function(){c.setState({playerState:l.playing})};c.handlePlayerPauseEvent=function(){c.pause()};c.handlePlayerEndedEvent=function(){c.stop()};c.handleContainerClick=function(a){c.state.playerState!==l.playing?c.play():c.pause()};b={playerState:null};c.state=b;return c}var e=b.prototype;e.componentDidMount=function(){document.addEventListener("visibilitychange",this.handleVisiblityChange);this.$3=d("Run").onBeforeUnload(this.handleBeforeUnload);var a=c("nullthrows")(this.$1.current);a.addEventListener("play",this.handlePlayerPlayEvent);a.addEventListener("pause",this.handlePlayerPauseEvent);a.addEventListener("ended",this.handlePlayerEndedEvent)};e.componentDidUpdate=function(a){this.props.isVisible===!1&&a.isVisible===!0&&this.pause()};e.componentWillUnmount=function(){this.handleBeforeUnload();document.removeEventListener("visibilitychange",this.handleVisiblityChange);this.$3!=null&&(this.$3.remove(),this.$3=null);var a=c("nullthrows")(this.$1.current);a.removeEventListener("play",this.handlePlayerPlayEvent);a.removeEventListener("pause",this.handlePlayerPauseEvent);a.removeEventListener("ended",this.handlePlayerEndedEvent)};e.play=function(){if(this.state.playerState===l.playing)return;if(this.$2===!1){var a;d("PolarisEmbedLogger").logEmbedAction({actionName:"videoFirstPlayClick",mediaId:this.props.post.id,mediaType:"video",ownerId:((a=this.props.post.owner)==null?void 0:a.id)||""});this.$2=!0}c("nullthrows")(this.$1.current).play()};e.pause=function(){if(this.state.playerState!==l.playing)return;c("nullthrows")(this.$1.current).pause();this.setState({playerState:l.paused})};e.stop=function(){if(this.state.playerState===l.finished)return;var a=c("nullthrows")(this.$1.current);a.pause();a.currentTime=0;this.setState({playerState:l.finished})};e.render=function(){var a=this.props,b=a.className;a=a.post;var e=this.state.playerState,f={},g={};d("PolarisVideoHeight").setVideoHeightCompensation(a,!0,f,g);var h=e===l.finished;e=!e||e===l.paused;return j.jsxs("div",{className:c("joinClasses")(b,"_aand"),style:f,children:[j.jsx("div",{style:g,children:j.jsx("video",{className:"_aane",controls:!1,controlsList:void 0,"data-testid":void 0,loop:!1,playsInline:!0,poster:a.src,preload:"none",ref:this.$1,src:a.videoUrl,type:k})}),h?j.jsx(c("PolarisEmbedVideoWatchAgain.react"),{post:a}):j.jsx(c("PolarisVideoPlayButton.react"),{onClick:this.handleContainerClick,showPlayButton:e}),a.usertags&&a.usertags.length>=1&&j.jsx(c("PolarisUserTagIndicatorWithSheet.react"),{analyticsContext:m,mediaId:a.id,post:a,usertags:a.usertags})]})};return b}(j.Component);g["default"]=a}),98);
__d("PolarisHotKeys.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.c;c={keyMap:{}};var l=i.createContext(c);function a(a){var b=k(13),c=a.children,d=a.className,e=a.isButton,f=a.keyMap;a=e===void 0?!1:e;e=j(l).keyMap;var g=n,h=m;b[0]!==f?(e=function(a){if(f[a.key]!=null&&h()&&g(a)){var b=f[a.key];b();a.stopPropagation()}},b[0]=f,b[1]=e):e=b[1];e=e;var o=a?"button":"presentation";a=a?"0":"-1";var p;b[2]!==f?(p={keyMap:f},b[2]=f,b[3]=p):p=b[3];var q;b[4]!==c||b[5]!==e||b[6]!==o||b[7]!==a||b[8]!==d?(q=typeof c==="function"?c(e,o,a):i.jsx("div",{className:d,onKeyUp:e,role:o,tabIndex:a,children:c}),b[4]=c,b[5]=e,b[6]=o,b[7]=a,b[8]=d,b[9]=q):q=b[9];b[10]!==p||b[11]!==q?(c=i.jsx(l.Provider,{value:p,children:q}),b[10]=p,b[11]=q,b[12]=c):c=b[12];return c}function m(){var a;return((a=document.activeElement)==null?void 0:a.tagName.toLowerCase())!=="textarea"&&((a=document.activeElement)==null?void 0:a.tagName.toLowerCase())!=="input"}function n(a){return!(a.ctrlKey||a.altKey||a.metaKey)}g["default"]=a}),98);
__d("PolarisInFeedPostModalContext",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=(h||d("react")).createContext;b=a(c("emptyFunction"));g.InFeedPostModalContext=b}),98);
__d("PolarisKeywordSearchExploreHooks.react",["PolarisDynamicExploreActions","PolarisDynamicExploreTypes","PolarisReactRedux.react","polarisDynamicExploreSelectors","react","usePolarisSelector"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a,b){var e=i(10),f=d("PolarisReactRedux.react").useDispatch(),g;e[0]!==a?(g=function(b){return d("polarisDynamicExploreSelectors").getSupportedSectionalItems(b,d("PolarisDynamicExploreTypes").DYNAMIC_EXPLORE_GRID_TYPES.keyword_grid,a)},e[0]=a,e[1]=g):g=e[1];var h=c("usePolarisSelector")(g),j=b===!0?d("PolarisDynamicExploreActions").requestKeywordExploreGridWithHashtagSerp:d("PolarisDynamicExploreActions").requestKeywordExploreGrid,k;e[2]!==h.length||e[3]!==f||e[4]!==j||e[5]!==a?(k=function(){h.length===0&&f(j({keyword:a,retryHandler:k}))},e[2]=h.length,e[3]=f,e[4]=j,e[5]=a,e[6]=k):k=e[6];g=k;e[7]!==h||e[8]!==g?(b=[h,g],e[7]=h,e[8]=g,e[9]=b):b=e[9];return b}function b(a,b){var e=i(10),f=d("PolarisReactRedux.react").useDispatch(),g;e[0]!==a?(g=function(b){return(b=b.dynamicExplore.keywordExploreGrid[a])==null?void 0:b.pagination},e[0]=a,e[1]=g):g=e[1];var h=c("usePolarisSelector")(g),j=b===!0?d("PolarisDynamicExploreActions").requestKeywordExploreGridWithHashtagSerp:d("PolarisDynamicExploreActions").requestKeywordExploreGrid,k;e[2]!==f||e[3]!==j||e[4]!==h||e[5]!==a?(k=function(){f(j({cursor:h==null?void 0:h.cursor,keyword:a,rankToken:h==null?void 0:h.rankToken,retryHandler:k}))},e[2]=f,e[3]=j,e[4]=h,e[5]=a,e[6]=k):k=e[6];g=k;e[7]!==h||e[8]!==g?(b=[h,g],e[7]=h,e[8]=g,e[9]=b):b=e[9];return b}function e(a){var b=i(2),e;b[0]!==a?(e=function(b){return d("polarisDynamicExploreSelectors").getGridItems(b,d("PolarisDynamicExploreTypes").DYNAMIC_EXPLORE_GRID_TYPES.keyword_grid,a)},b[0]=a,b[1]=e):e=b[1];return c("usePolarisSelector")(e)}g.useKeywordExploreSectionalItems=a;g.useKeywordExplorePagination=b;g.useKeywordExploreGridItems=e}),98);
__d("PolarisLikedByListContainerLazy.react",["CometPlaceholder.react","JSResourceForInteraction","lazyLoadComponent","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisLikedByListContainer.react").__setRef("PolarisLikedByListContainerLazy.react"));function a(a){var b=i(2),d;b[0]!==a?(d=j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx(k,babelHelpers["extends"]({},a))}),b[0]=a,b[1]=d):d=b[1];return d}g["default"]=a}),98);
__d("PolarisPhotoWrapper.react",["InstagramODS","PolarisClickEventLoggerProvider.react","PolarisExternalLink.react","PolarisSponsoredPostContext.react","PolarisTrackingNodeProvider.react","PolarisUA","polarisAdsSelectors.react","react","react-forget-runtime","usePolarisOffsiteTrackingDataURLParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useContext;var j=b.c;function k(a){var b=j(7),d=a.children,e=a.externalURL;a=a.wrappedRef;var f=l,g=c("usePolarisOffsiteTrackingDataURLParams")(e),h;b[0]!==e||b[1]!==g||b[2]!==d?(h=function(a){return i.jsx("div",{ref:a,children:i.jsx(c("PolarisExternalLink.react"),{className:"x4gyw5p",href:e,ignoreDoubleClick:!0,onClick:f,queryParams:g,children:d})})},b[0]=e,b[1]=g,b[2]=d,b[3]=h):h=b[3];var k;b[4]!==a||b[5]!==h?(k=i.jsx(c("PolarisClickEventLoggerProvider.react"),{ignoreDoubleClick:!0,children:i.jsx(c("PolarisTrackingNodeProvider.react"),{ref:a,trackingNode:86,children:h})}),b[4]=a,b[5]=h,b[6]=k):k=b[6];return k}function l(){c("InstagramODS").incr("web.ads.feed.link_click")}e=i.forwardRef(a);function a(a,b){var e=j(10),f=a.children;a=a.postId;var g=d("polarisAdsSelectors.react").useFeedAdInfo(a,n),h=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,m);h=h.singleImageAdAsCta;if(e[0]!==(g==null?void 0:g.ctaItems)||e[1]!==a){var l;l=g==null?void 0:(l=g.ctaItems)==null?void 0:(l=l.get(a))==null?void 0:l.ctaLinkUrl;e[0]=g==null?void 0:g.ctaItems;e[1]=a;e[2]=l}else l=e[2];var o=l;if(o!=null&&h&&d("PolarisUA").isDesktop()){e[3]!==o||e[4]!==b||e[5]!==f?(g=i.jsx(c("PolarisTrackingNodeProvider.react"),{trackingNode:12,children:function(a){return i.jsx("div",{ref:a,children:i.jsx(k,{externalURL:o,wrappedRef:b,children:f})})}}),e[3]=o,e[4]=b,e[5]=f,e[6]=g):g=e[6];return g}e[7]!==b||e[8]!==f?(a=i.jsx("div",{ref:b,children:f}),e[7]=b,e[8]=f,e[9]=a):a=e[9];return a}function m(a){return[a.singleImageAdAsCta]}function n(a){return a}f=e;g["default"]=f}),98);
__d("PolarisVideoViewedTimeAction",["convertToViewabilityPercentage","gkx","memoizeStringOnly","polarisVideoEventLogger","polarisVideoUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=c("memoizeStringOnly")(function(a){return new Map()}),i=c("memoizeStringOnly")(function(a){return new Map()}),j=c("memoizeStringOnly")(function(){return new Map()});function k(a){a=a.video;var b=a.getDeclarativeVideoRef();return{lastStartPosition:(b=b==null?void 0:b.getCurrentTime())!=null?b:0,loopCount:a.getLoopCount()}}function l(a){var b=a.adTrackingToken,c=a.context,e=a.initialData,f=a.post;a=a.video;var g=a.getDeclarativeVideoRef();return{adTrackingToken:b,analyticsContext:c,carouselParentId:f.carouselParentId,currentVideoTime:d("polarisVideoUtils").getCurrentVideoTime(g),dashInfo:d("polarisVideoUtils").getDashInfo(f),duration:g==null?void 0:g.getDuration(),id:f.id,isAd:!0,lastStartPosition:e.lastStartPosition,loopCount:a.getLoopCount()-e.loopCount,ownerId:(b=f.owner)==null?void 0:b.id,postedAt:f.postedAt,sequenceNumber:a.getNextSequenceNumber(),timeAtVideoPause:d("polarisVideoUtils").getTimeAtVideoPause(g),trackingToken:f.trackingToken,videoWidth:g==null?void 0:(c=g.getVideo())==null?void 0:c.videoWidth}}function a(a,b,e,f){return function(g){if(b.current==null)return;var m=b.current,n=h(e),o=i(e),p=a.id;g.percentVisible>=.5&&!n.has(p)&&n.set(p,k({video:m}));g.percentVisible>=1&&!o.has(p)&&o.set(p,k({video:m}));var q=n.get(p);q!=null&&g.percentVisible<.5&&(n["delete"](p),d("polarisVideoEventLogger").logVideoViewedTime(l({adTrackingToken:f,context:e,initialData:q,post:a,video:m})));n=o.get(p);n&&g.percentVisible<1&&(o["delete"](p),d("polarisVideoEventLogger").logVideoFullViewedTime(l({adTrackingToken:f,context:e,initialData:n,post:a,video:m})));if(!c("gkx")("25360"))return;q=j(e);o=q.get(p);n=c("convertToViewabilityPercentage")(g.percentVisible);g=m.getDeclarativeVideoRef();if(n!==o){q.set(p,n);d("polarisVideoEventLogger").logVideoViewabilityChanged({adTrackingToken:f,analyticsContext:e,carouselParentId:a.carouselParentId,currentVideoTime:d("polarisVideoUtils").getCurrentVideoTime(g),currentViewabilityPercentage:n,dashInfo:d("polarisVideoUtils").getDashInfo(a),duration:g==null?void 0:g.getDuration(),id:a.id,isAd:!0,ownerId:(o=a.owner)==null?void 0:o.id,sequenceNumber:m.getNextSequenceNumber(),trackingToken:a.trackingToken})}}}g.makeVideoViewTimeAction=a}),98);
__d("PolarisMedia_DEPRECATED.react",["PolarisDoubleTappable","PolarisEmbedVideo.react","PolarisFeedSeenStateManagerSingleton","PolarisIGCoreToast.react","PolarisIsLoggedInDesktop","PolarisLikeAnimation.react","PolarisMediaVideo.react","PolarisPhoto.react","PolarisPhotoWithIndicator.react","PolarisPhotoWrapper.react","PolarisSensitivityOverlay.react","PolarisSidecarMedia.react","PolarisVideoViewedTimeAction","PolarisViewpointReact.react","nullthrows","polarisVideoUtils","polarisWithRemountOnChange","react","usePolarisMediaSensitivityOverlay"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useState;function a(a){var b=j(!1),e=b[0],f=b[1];b=j(!1);var g=b[0],h=b[1];b=j(0);var k=b[0],l=b[1],m=c("PolarisFeedSeenStateManagerSingleton").get();b=function(){a.onLike&&(a.onLike(),l(k+1))};var n=function(){f(!0)},o=function(){f(!1)},p=function(c,d){var e=a.onMediaRendered,b=a.post;if(b.isVideo===!0)return;e&&e({mediaType:"Photo",resourceName:c,timeTaken:d})},q=function(a){switch(a.state){case"entered":case"updated":a=a.percentVisible>.2;g!==a&&h(a);break;case"exited":h(!1)}},r=function(b,c){if(b===!0&&a.autoplay===!0){if(d("polarisVideoUtils").isFeed(a.analyticsContext))return!1;if(c===0&&d("PolarisIsLoggedInDesktop").isLoggedInDesktop())return!0}return!1},s=a.adInfo,t=a.analyticsContext,u=a.asSidecarChild,v=a.autoplay;a.checkIsSensitivityOverlayDisabledCallback;var w=a.commentsAreStacked,x=a.firstSidecarChildSrc;a.hasViewInsights;var y=a.id;a.initialCarouselIndex;var z=a.isEmbed,A=a.isVisible,B=a.mediaFooter;a.onLike;a.onMediaRendered;var C=a.onSensitivityOverlayCleared;a.onSetModal;var D=a.onSidecarChildIndexChange,E=a.onToastClose,F=a.onVideoFinished,G=a.onVideoLoop,H=a.post,aa=a.relationship,I=a.sensitivityOverlayMediaOverlayInfoLoggingProps,ba=a.showToast,J=a.toastString,ca=a.viewer,da=a.visiblePosition,K=babelHelpers.objectWithoutPropertiesLoose(a,["adInfo","analyticsContext","asSidecarChild","autoplay","checkIsSensitivityOverlayDisabledCallback","commentsAreStacked","firstSidecarChildSrc","hasViewInsights","id","initialCarouselIndex","isEmbed","isVisible","mediaFooter","onLike","onMediaRendered","onSensitivityOverlayCleared","onSetModal","onSidecarChildIndexChange","onToastClose","onVideoFinished","onVideoLoop","post","relationship","sensitivityOverlayMediaOverlayInfoLoggingProps","showToast","toastString","viewer","visiblePosition"]),L=H||{},M=L.dimensions,ea=L.displayResources,N=L.upcomingEvent,O=L.id,P=L.isVideo;P=P===void 0?!1:P;var Q=L.mediaPreview,R=L.owner,S=L.sidecarChildren;S=S===void 0?[]:S;var T=L.src;L=L.usertags;var U=S&&S.length>0,V=[];!U&&d("polarisVideoUtils").isFeed(t)&&V.push(function(a){m.addImpressionFromPost(H,a)});var W=!1;C=c("usePolarisMediaSensitivityOverlay")(H,t,C,a.checkIsSensitivityOverlayDisabledCallback);var fa=C.handleHideSensitivityOverlay,X=C.mediaOverlayCoverInfo;C=C.shouldShowSensitivityOverlay;if(R&&C){I=I||{};var Y=I.checkIfMediaOverlayInfoImpressionLoggingDisabled;I=I.onLoggedMediaOverlayInfoImpression;Y=i.jsx(c("PolarisSensitivityOverlay.react"),{analyticsContext:t,asSidecarChild:u,dimensions:M,disableMediaOverlayInfoImpressionLogging:Y!=null?Y(O):!1,isPhoto:!P&&!U,isVisible:A,mediaId:O,mediaOverlayCoverInfo:X,onLoggedMediaOverlayInfoImpression:I,onShowPostClicked:function(){return fa(H)},ownerId:R.id,previewData:Q})}else if(U){if(w===!0)W=!0,X=a;else{a.mediaFooter;I=babelHelpers.objectWithoutPropertiesLoose(a,["mediaFooter"]);X=I}Y=i.jsx(c("PolarisSidecarMedia.react"),babelHelpers["extends"]({},X,{onChildIndexChange:D,sidecarChildren:S}))}else if(P){var Z=g;R=[q];Q=i.createRef();s!=null&&s.tracking_token!=null&&R.push(d("PolarisVideoViewedTimeAction").makeVideoViewTimeAction(a.post,Q,t,s.tracking_token));Y=i.jsx(d("PolarisViewpointReact.react").Viewpoint,{action:[].concat(R,V),id:H.id,children:function(b){return i.jsxs("div",{ref:b,children:[z===!0?i.jsx(c("PolarisEmbedVideo.react"),{className:a.className,isVisible:Z,post:H}):i.jsx(c("PolarisMediaVideo.react"),{adInfo:s,analyticsContext:t,asSidecarChild:u,autoplay:v,className:a.className,firstSidecarChildSrc:x,isVisible:Z,onFinished:F,onLoop:G,post:H,relationship:aa,shouldAutoPlay:r(Z,da),upcomingEventMediaId:y}),ba===!0&&J!=null&&i.jsx(c("PolarisIGCoreToast.react"),{absolutePosition:!0,duration:3e3,onClose:E,wide:!0,children:J})]})}})}else{U={dimensions:M,likeEventCount:k,onPhotoRendered:p,postId:O,src:c("nullthrows")(T),srcSet:ea};var $;L&&L.length>0||N?$=i.jsx(d("PolarisPhotoWithIndicator.react").PhotoWithIndicator,babelHelpers["extends"]({},K,U,{analyticsContext:t,isFocused:e,isVisible:A,upcomingEvent:N,upcomingEventMediaId:y,upcomingEventThumbnailSrc:c("nullthrows")(u===!0?x:T),usertags:L,viewer:ca})):$=i.jsx(c("PolarisPhoto.react"),babelHelpers["extends"]({},K,U,{analyticsContext:t}));w=[].concat(V);I=i.jsx(d("PolarisViewpointReact.react").Viewpoint,{action:w,id:H.id,children:function(a){return i.jsx(c("PolarisPhotoWrapper.react"),{postId:H.id,ref:a,children:$})}});Y=i.jsxs(d("PolarisDoubleTappable").DoubleTappable,{onBlur:o,onDoubleClick:b,onFocus:n,role:"button",children:[I,i.jsx(c("PolarisLikeAnimation.react"),{likeEventCount:k},k)]})}B!=null&&!W&&!C&&(Y=i.jsxs(i.Fragment,{children:[Y,B]}));return Y}a.displayName=a.name+" [from "+f.id+"]";function b(a,b){return a.id!==b.id}e=c("polarisWithRemountOnChange")(b)(a);g["default"]=e}),98);
__d("PolarisSidecarChild.react",["IGDSBox.react","PolarisMedia_DEPRECATED.react","PolarisOrganicImpressionAction","PolarisViewpointReact.react","PolarisVpvdImpressionAction","cr:5000","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var e=i(43),f;if(e[0]!==a){var g=a.index,h=a.media,k=a.mediaWidth;a.onChildIndexChange;var l=a.sidecarChildIndex,m=a.sidecarChildren,n=a.analyticsContext,o=a.isVisible;a.mediaFooter;var p=a.onMediaRendered,q=a.post,r=babelHelpers.objectWithoutPropertiesLoose(a,["index","media","mediaWidth","onChildIndexChange","sidecarChildIndex","sidecarChildren","analyticsContext","isVisible","mediaFooter","onMediaRendered","post"]);g=g;h=h;f=k;k=l;l=m;m=n;n=o;o=p;p=q;q=r;e[0]=a;e[1]=h;e[2]=l;e[3]=k;e[4]=g;e[5]=n;e[6]=q;e[7]=m;e[8]=o;e[9]=f;e[10]=p}else h=e[1],l=e[2],k=e[3],g=e[4],n=e[5],q=e[6],m=e[7],o=e[8],f=e[9],p=e[10];e[11]!==h||e[12]!==l||e[13]!==k||e[14]!==g||e[15]!==n||e[16]!==q||e[17]!==m||e[18]!==o?(r=h.isUpsell===!0&&b("cr:5000")!=null?j.jsx(b("cr:5000"),{upsellSidecarChild:h}):j.jsx(c("PolarisMedia_DEPRECATED.react"),babelHelpers["extends"]({},q,{accessibilityCaption:h.accessibilityCaption,analyticsContext:m,asSidecarChild:!0,firstSidecarChildSrc:l[0].src,isVisible:k===g?n:!1,onMediaRendered:o,post:h})),e[11]=h,e[12]=l,e[13]=k,e[14]=g,e[15]=n,e[16]=q,e[17]=m,e[18]=o,e[19]=r):r=e[19];var s=r;if(g===0){e[20]!==h.id||e[21]!==f||e[22]!==s?(a=j.jsx(c("IGDSBox.react"),{position:"relative",width:f,children:s},h.id),e[20]=h.id,e[21]=f,e[22]=s,e[23]=a):a=e[23];return a}e[24]!==h||e[25]!==m?(k=d("PolarisOrganicImpressionAction").makeCarouselImpressionAction(h,m),e[24]=h,e[25]=m,e[26]=k):k=e[26];n=l[0];e[27]!==h||e[28]!==n||e[29]!==g||e[30]!==p.id||e[31]!==m?(q=d("PolarisVpvdImpressionAction").makeCarouselVpvdImpressionAction(h,n,g,p.id,m),e[27]=h,e[28]=n,e[29]=g,e[30]=p.id,e[31]=m,e[32]=q):q=e[32];e[33]!==k||e[34]!==q?(o=[k,q],e[33]=k,e[34]=q,e[35]=o):o=e[35];e[36]!==f||e[37]!==s?(r=function(a){return j.jsx(c("IGDSBox.react"),{containerRef:a,position:"relative",width:f,children:s})},e[36]=f,e[37]=s,e[38]=r):r=e[38];e[39]!==o||e[40]!==h.id||e[41]!==r?(a=j.jsx(d("PolarisViewpointReact.react").Viewpoint,{action:o,id:h.id,children:r},h.id),e[39]=o,e[40]=h.id,e[41]=r,e[42]=a):a=e[42];return a}g["default"]=a}),98);
__d("usePolarisSidecarMediaOrUpsell",["PolarisConfig","PolarisUA","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c,j=4,k=2;function a(a){var b=i(3),c=a.post;a=a.sidecarChildren;if(d("PolarisConfig").isLoggedIn()||d("PolarisUA").isDesktop()||a.some(l)||c.dimensions===null||c.owner===null)return a;var e;if(b[0]!==a||b[1]!==c){e=[].concat(a);var f=e.length>=j?k:null;if(f!=null&&e[f-1].mediaPreview!=null){var g={dimensions:c.dimensions,id:"",isUpsell:!0,isVideo:!1,mediaPreview:e[f-1].mediaPreview,owner:c.owner,src:""};e.splice(f,0,g)}b[0]=a;b[1]=c;b[2]=e}else e=b[2];return e}function l(a){return a.mediaOverlayInfo!=null}g["default"]=a}),98);
__d("PolarisSidecarMedia.react",["PolarisSidecarChild.react","PolarisSidecar_DEPRECATED.react","qex","react","usePolarisSidecarMediaOrUpsell"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.c;function a(a){var b=j(23),e,f,g,h;b[0]!==a?(g=a.sidecarChildren,h=a.initialCarouselIndex,f=a.post,e=babelHelpers.objectWithoutPropertiesLoose(a,["sidecarChildren","initialCarouselIndex","post"]),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=h):(e=b[1],f=b[2],g=b[3],h=b[4]);b[5]!==e.onChildIndexChange?(a=function(a,b,c){return[e.onChildIndexChange].filter(Boolean).forEach(function(d){return d(a,b,c)})},b[5]=e.onChildIndexChange,b[6]=a):a=b[6];a=a;var l;b[7]!==f||b[8]!==g?(l={post:f,sidecarChildren:g},b[7]=f,b[8]=g,b[9]=l):l=b[9];var m=c("usePolarisSidecarMediaOrUpsell")(l);b[10]!==m||b[11]!==f||b[12]!==e?(g=function(a,b){return m.map(function(d,g){return i.jsx(c("PolarisSidecarChild.react"),babelHelpers["extends"]({index:g,media:d,mediaWidth:a,post:f,sidecarChildIndex:b,sidecarChildren:m},e),g)})},b[10]=m,b[11]=f,b[12]=e,b[13]=g):g=b[13];l=g;b[14]!==m?(g=m.map(k).filter(Boolean),b[14]=m,b[15]=g):g=b[15];g=g;var n;b[16]!==g||b[17]!==h||b[18]!==e.mediaFooter||b[19]!==m.length||b[20]!==a||b[21]!==l?(n=i.jsx(d("PolarisSidecar_DEPRECATED.react").Sidecar,{dimensions:g,hoverTriggeredPager:c("qex")._("6")===!0,initialCarouselIndex:h,mediaFooter:e.mediaFooter,numSidecarChildren:m.length,onChildIndexChange:a,renderSidecarChildren:l}),b[16]=g,b[17]=h,b[18]=e.mediaFooter,b[19]=m.length,b[20]=a,b[21]=l,b[22]=n):n=b[22];g=n;return g}function k(a){a=a.dimensions;return a}g["default"]=a}),98);
__d("PolarisMediaContainer.react",["PolarisMedia_DEPRECATED.react","PolarisReactRedux.react","polarisPostSelectors","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");function a(a,b){return{onMediaRendered:d("polarisPostSelectors").getOnMediaRendered(a,b.onPostMediaRendered)}}function b(a,b){return{onSidecarChildIndexChange:function(a,c,d){a=b.onPostSidecarChildIndexChange;a&&a(c)}}}function e(a,b,c){c.onPostMediaRendered;c.onPostSidecarChildIndexChange;c=babelHelpers.objectWithoutPropertiesLoose(c,["onPostMediaRendered","onPostSidecarChildIndexChange"]);return babelHelpers["extends"]({},c,a,b)}f=d("PolarisReactRedux.react").connect(a,b,e)(c("PolarisMedia_DEPRECATED.react"));g["default"]=f}),98);
__d("PolarisPostActionLikePost",["PolarisAPILikePost","PolarisAdsEngagementLogger","PolarisEngagementLogger","PolarisGenericStrings","PolarisSentryFeedbackActions","PolarisToastActions","QPLUserFlow","polarisLogAction","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){return function(f){c("polarisLogAction")("likeAttempt",b);c("QPLUserFlow").start(c("qpl")._(379204822,"720"),{annotations:{string:{source:b==null?void 0:b.source}}});f({postId:a,type:"LIKE_POST_REQUESTED"});return d("PolarisAPILikePost").likePost(a).then(function(){e!=null?d("PolarisAdsEngagementLogger").logAdLike(b,e):d("PolarisEngagementLogger").logOrganicLike(b),c("QPLUserFlow").endSuccess(c("qpl")._(379204822,"720")),f({postId:a,type:"LIKE_POST_SUCCEEDED"})},function(e){var g;c("polarisLogAction")("likeFailure",b);c("QPLUserFlow").endFailure(c("qpl")._(379204822,"720"),"request_failed");g=((g=e.responseObject)==null?void 0:g.spam)||!1;if(g){var i,j,k,l;g=(g=e.responseObject)==null?void 0:g.feedback_title;i=(i=e.responseObject)==null?void 0:i.feedback_message;j=(j=e.responseObject)==null?void 0:j.feedback_url;k=(k=e.responseObject)==null?void 0:k.feedback_action;l=(l=e.responseObject)==null?void 0:l.feedback_appeal_label;e=(e=e.responseObject)==null?void 0:e.restriction_enrollment_data;f(d("PolarisSentryFeedbackActions").showSentryFeedback({action:k,feedback_appeal_label:l,message:i,restriction_enrollment_data:e,source:b.source,sourceOfAction:"like_post",title:g,url:j}))}f({postId:a,type:"LIKE_POST_FAILED"});f(d("PolarisToastActions").showToast({actionHandler:function(){return f(h(a,b))},actionText:d("PolarisGenericStrings").RETRY_TEXT,text:d("PolarisGenericStrings").GENERIC_ERROR_MESSAGE}))})}}g.likePost=h}),98);
__d("PolarisPostActionRemovePostFromCollection",["InstagramODS","PolarisAPIEditCollection"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.collectionId,e=a.postId;return function(a){a({collectionId:b,postId:e,type:"REMOVE_POST_FROM_COLLECTION_REQUESTED"});c("InstagramODS").incr("web.unsaveFromCollection.attempt");return d("PolarisAPIEditCollection").editCollection({collectionId:b,postIdsToRemove:[e]}).then(function(){a({collectionId:b,postId:e,type:"REMOVE_POST_FROM_COLLECTION_SUCCEEDED"}),c("InstagramODS").incr("web.unsaveFromCollection.success")})["catch"](function(){a({collectionId:b,postId:e,type:"REMOVE_POST_FROM_COLLECTION_FAILED"}),c("InstagramODS").incr("web.unsaveFromCollection.failure")})}}g.removePostFromCollection=a}),98);
__d("PolarisPostActionSavePost",["PolarisAPISavePost","PolarisAdsEngagementLogger","polarisLogAction"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){return function(f){c("polarisLogAction")("saveAttempt",b);f({postId:a,type:"SAVE_POST_REQUESTED"});return d("PolarisAPISavePost").savePost(a).then(function(){c("polarisLogAction")("saveSuccess",b),f({postId:a,type:"SAVE_POST_SUCCEEDED"}),e!=null&&d("PolarisAdsEngagementLogger").logAdSave(e)},function(){c("polarisLogAction")("saveFailure",b),f({postId:a,type:"SAVE_POST_FAILED"})})}}g.savePost=a}),98);
__d("PolarisPostActionUnlikePost",["PolarisAPIUnlikePost","PolarisAdsEngagementLogger","PolarisEngagementLogger","PolarisGenericStrings","PolarisSentryFeedbackActions","PolarisToastActions","QPLUserFlow","polarisLogAction","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){return function(f){c("polarisLogAction")("unlikeAttempt",b);c("QPLUserFlow").start(c("qpl")._(379198902,"749"),{annotations:{string:{source:b==null?void 0:b.source}}});f({postId:a,type:"UNLIKE_POST_REQUESTED"});return d("PolarisAPIUnlikePost").unlikePost(a).then(function(){e!=null?d("PolarisAdsEngagementLogger").logAdUnlike(b,e):d("PolarisEngagementLogger").logOrganicUnlike(b),c("QPLUserFlow").endSuccess(c("qpl")._(379198902,"749")),f({postId:a,type:"UNLIKE_POST_SUCCEEDED"})},function(e){var g;g=((g=e.responseObject)==null?void 0:g.spam)||!1;if(g){var i,j,k,l;g=(g=e.responseObject)==null?void 0:g.feedback_title;i=(i=e.responseObject)==null?void 0:i.feedback_message;j=(j=e.responseObject)==null?void 0:j.feedback_url;k=(k=e.responseObject)==null?void 0:k.feedback_action;l=(l=e.responseObject)==null?void 0:l.feedback_appeal_label;e=(e=e.responseObject)==null?void 0:e.restriction_enrollment_data;f(d("PolarisSentryFeedbackActions").showSentryFeedback({action:k,feedback_appeal_label:l,message:i,restriction_enrollment_data:e,source:b.source,sourceOfAction:"unlike_post",title:g,url:j}))}c("polarisLogAction")("unlikeFailure",b);c("QPLUserFlow").endFailure(c("qpl")._(379198902,"749"),"request_failed");f({postId:a,type:"UNLIKE_POST_FAILED"});f(d("PolarisToastActions").showToast({actionHandler:function(){return f(h(a,b))},actionText:d("PolarisGenericStrings").RETRY_TEXT,text:d("PolarisGenericStrings").GENERIC_ERROR_MESSAGE}))})}}g.unlikePost=h}),98);
__d("PolarisPostActionUnsavePost",["PolarisAPIUnsavePost","PolarisAdsEngagementLogger","polarisLogAction"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){return function(f){c("polarisLogAction")("unsaveAttempt",b);f({postId:a,type:"UNSAVE_POST_REQUESTED"});return d("PolarisAPIUnsavePost").unsavePost(a).then(function(){c("polarisLogAction")("unsaveSuccess",b),f({postId:a,type:"UNSAVE_POST_SUCCEEDED"}),e!=null&&d("PolarisAdsEngagementLogger").logAdUnsave(e)},function(){c("polarisLogAction")("unsaveFailure",b),f({postId:a,type:"UNSAVE_POST_FAILED"})})}}g.unsavePost=a}),98);
__d("PolarisPostCoauthorReviewOverlayFooterCTA.react",["fbt","FBLogger","IGDSBox.react","IGDSButton.react","IGDSText.react","JSResourceForInteraction","PolarisCoauthorUtils.react","PolarisConfig","PolarisUserHoverCard.react","PolarisUserLink.react","err","gkx","polarisGetPostFromGraphMediaInterface","react","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.c,l=c("JSResourceForInteraction")("PolarisCoauthorReviewDialog.react").__setRef("PolarisPostCoauthorReviewOverlayFooterCTA.react");function a(a){var b,e=k(22),f=a.invitedCoauthorProducers,g=a.mediaId,i=a.mediaShortcode,m=a.productType,n=a.user;a=c("useIGDSLazyDialog")(l);var o=a[0];e[0]!==o||e[1]!==g||e[2]!==i||e[3]!==m||e[4]!==n?(a=function(){var a;o({mediaId:(a=g)!=null?a:"",mediaShortcode:(a=i)!=null?a:"",productType:m,username:(a=n==null?void 0:n.username)!=null?a:""})},e[0]=o,e[1]=g,e[2]=i,e[3]=m,e[4]=n,e[5]=a):a=e[5];a=a;if(n==null||n.username==null||g==null){var p=c("err")("PolarisPostCoauthorReviewOverlayFooterCTA requires a post user");c("FBLogger")("ig_web").catching(p);return null}var q=d("PolarisConfig").getViewerIdOrZero();p=f!=null&&f.some(function(a){return(a==null?void 0:a.id)===q});if(!p)return null;f=!n.isUnpublished;p=(p=n==null?void 0:n.username)!=null?p:"";b=(b=n==null?void 0:n.username)!=null?b:"";var r;e[6]!==b?(r=j.jsx(c("PolarisUserLink.react"),{username:b}),e[6]=b,e[7]=r):r=e[7];e[8]!==f||e[9]!==n.id||e[10]!==p||e[11]!==r?(b=j.jsx(c("PolarisUserHoverCard.react"),{display:"inline-block",isUserAvailable:f,userId:n.id,username:p,children:r}),e[8]=f,e[9]=n.id,e[10]=p,e[11]=r,e[12]=b):b=e[12];f=b;e[13]!==f?(p=h._("__JHASH__zobFUCqiyEo__JHASH__",[h._param("media_owner_username",f)]),e[13]=f,e[14]=p):p=e[14];r=p;e[15]!==f?(b=h._("__JHASH__8prry3BHUcp__JHASH__",[h._param("media_owner_username",f)]),e[15]=f,e[16]=b):b=e[16];p=b;e[17]!==m||e[18]!==p||e[19]!==r||e[20]!==a?(f=d("PolarisCoauthorUtils.react").isCoauthorAcceptanceEnabled()&&c("gkx")("4757")?j.jsxs(c("IGDSBox.react"),{alignItems:"center",color:"primaryBackground",direction:"row",justifyContent:"between",paddingX:3,paddingY:2,position:"relative",children:[j.jsx(c("IGDSBox.react"),{flex:"shrink",marginEnd:5,marginStart:1,maxWidth:350,overflow:"auto",wrap:!0,children:j.jsx(c("IGDSText.react").Body,{color:"primaryText",maxLines:3,zeroMargin:!0,children:m===d("polarisGetPostFromGraphMediaInterface").PRODUCT_TYPE_CLIPS?p:r})}),j.jsx(c("IGDSBox.react"),{flex:"shrink",marginEnd:1,children:j.jsx(c("IGDSButton.react"),{display:"inline",label:h._("__JHASH__NhLz7AVpjs2__JHASH__"),onClick:a,variant:"tertiary"})})]}):null,e[17]=m,e[18]=p,e[19]=r,e[20]=a,e[21]=f):f=e[21];return f}g["default"]=a}),226);
__d("PolarisPostCommentInputPicker.react",["CometPlaceholder.react","PolarisUA","deferredLoadComponent","react","requireDeferredForDisplay","stylex","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l=c("deferredLoadComponent")(c("requireDeferredForDisplay")("PolarisPostCommentInput.react").__setRef("PolarisPostCommentInputPicker.react")),m={familiarFeedPlaceholder:{alignItems:"x1qjc9v5",boxSizing:"x9f619",display:"x78zum5",flexDirection:"xdt5ytf",flexShrink:"x2lah0s",height:"x1d6elog",$$css:!0},placeholder:{alignItems:"x1qjc9v5",borderTopColor:"x5ur3kl",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",boxSizing:"x9f619",display:"x78zum5",flexDirection:"xdt5ytf",flexShrink:"x2lah0s",height:"xnnlda6",marginTop:"x1gslohp",position:"x1n2onr6",$$css:!0}};b=k.forwardRef(a);function a(a,b){var e=j(12),f;e[0]!==a?(f=babelHelpers["extends"]({},a),e[0]=a,e[1]=f):f=e[1];a=c("usePolarisIsOnFeedPage")();var g=c("usePolarisIsOnAdsActivityPage")();a=(a||g)&&f.inModal!==!0&&d("PolarisUA").isDesktop();g=a?m.familiarFeedPlaceholder:m.placeholder;e[2]!==g?(a=(h||(h=c("stylex")))(g),e[2]=g,e[3]=a):a=e[3];e[4]!==a?(g=k.jsx("div",{className:a}),e[4]=a,e[5]=g):g=e[5];e[6]!==f||e[7]!==b?(a=k.jsx(l,babelHelpers["extends"]({},f,{ref:b})),e[6]=f,e[7]=b,e[8]=a):a=e[8];e[9]!==g||e[10]!==a?(f=k.jsx(c("CometPlaceholder.react"),{fallback:g,name:"PostCommentInputPicker",children:a}),e[9]=g,e[10]=a,e[11]=f):f=e[11];return f}e=b;g["default"]=e}),98);
__d("PolarisPostModalRenderingContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||(h=d("react"));var i=h.useContext,j=b.createContext({isInModal:!1});function a(){return i(j)}g.PolarisPostModalRenderingContext=j;g.usePolarisPostModalRenderingContext=a}),98);
__d("PolarisPostFeatures.react",["FBLogger","PolarisPostConstants","PolarisPostModalRenderingContext.react","PolarisPostVariants","PolarisReactRedux.react","PolarisRelationshipTypes","PolarisUA","polarisRelationshipSelectors.react","react","usePolarisDisplayProperties","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c,j=[{overrides:{threeLineHeaderEnabled:!0},predicate:"isThreeLineHeaderEnabled"},{overrides:{avatarSize:d("PolarisPostConstants").AVATAR_SIZE_SMALL,commentsAreStacked:!0},predicate:"isFeed"},{overrides:{avatarSize:d("PolarisPostConstants").AVATAR_SIZE_SMALL,commentsAreStacked:!0},predicate:"isWidePhotoOnMediumScreen"},{overrides:{avatarSize:d("PolarisPostConstants").AVATAR_SIZE_SMALL,hasThreadedSidebarComments:!0,showPostButton:!0},predicate:"isRichCommentsEnabled"},{overrides:{avatarSize:d("PolarisPostConstants").AVATAR_SIZE_SMALL,commentsAreStacked:!0,hasThreadedSidebarComments:!1,showPostButton:!0},predicate:"isStackedScreenSize"},{overrides:{hasPhotosOfYouOption:!0},predicate:"isViewerInUserTags"},{overrides:{showFollowButton:!1},predicate:"isFeedAndOwnerFollowedByViewer"},{overrides:{showFollowButton:!1},predicate:"isModalAndOwnerFollowedByViewer"},{overrides:{canViewerProvideFeedback:!1},predicate:"isOwnerPrivate"},{overrides:{canViewerProvideFeedback:!0},predicate:"isOwnerFollowedByViewer"},{overrides:{canViewerProvideFeedback:!0,showFollowButton:!1},predicate:"isOwnerTheViewer"},{overrides:{showFollowButton:!1},predicate:"isOwnerUnpublished"},{overrides:{showFollowButton:!1},predicate:"isBlocked"},{overrides:{showFollowButton:!1},predicate:"hasFollowHashtagInfo"},{overrides:{canViewerProvideFeedback:!1},predicate:"isLoggedOut"}],k={avatarSize:d("PolarisPostConstants").AVATAR_SIZE_LARGE,canViewerProvideFeedback:!0,commentsAreStacked:!1,hasPhotosOfYouOption:!1,hasThreadedSidebarComments:!1,showFollowButton:!0,showPostButton:!1,threeLineHeaderEnabled:!1};function l(a){var b=a.isInModal,c=a.owner,e=a.post,f=a.relationship,g=a.variant,h=a.viewer;a=a.viewportWidth;g=g===d("PolarisPostVariants").VARIANTS.feed;var i=Boolean(h),j=!h,k=(h==null?void 0:h.id)===c.id,l=f.followedByViewer.state===d("PolarisRelationshipTypes").FOLLOW_STATUS_FOLLOWING,m=Boolean(e.followHashtagInfo),n=Boolean(e.location)&&(e.sponsors||[]).length>0;return{hasFollowHashtagInfo:m,isBlocked:f.hasBlockedViewer.state===d("PolarisRelationshipTypes").BLOCK_STATUS_BLOCKED,isFavorited:((m=f.favoritedByViewer)==null?void 0:m.state)===d("PolarisRelationshipTypes").FAVORITE_STATUS_FAVORITED,isFeed:g,isFeedAndOwnerFollowedByViewer:g&&l,isLoggedIn:i,isLoggedOut:j,isModalAndOwnerFollowedByViewer:b&&l,isOwnerFollowedByViewer:l,isOwnerPrivate:Boolean(c.isPrivate),isOwnerTheViewer:k,isOwnerUnpublished:Boolean(c.isUnpublished),isRichCommentsEnabled:!0,isSidecar:(e.sidecarChildren||[]).length>0,isStackedScreenSize:a<d("PolarisPostConstants").SIDEBAR_VARIANT_CUTOFF,isThreeLineHeaderEnabled:n,isViewerInUserTags:i&&(e.usertags||[]).some(function(a){return a.user.id===(h==null?void 0:h.id)}),isWidePhotoOnMediumScreen:Boolean(e.dimensions&&e.dimensions.width/e.dimensions.height>1.5&&a>d("PolarisPostConstants").SIDEBAR_VARIANT_CUTOFF&&a<=d("PolarisPostConstants").MEDIUM_SCREEN_MAX)}}function m(a){var b=l(a);a=b.isBlocked;var d=b.isFavorited,e=b.isLoggedIn,f=b.isSidecar,g=b.isStackedScreenSize;return babelHelpers["extends"]({isBlocked:a,isFavorited:d,isLoggedIn:e,isSidecar:f,isStackedScreenSize:g},j.filter(function(a){a=a.predicate;var d=b[a];if(typeof d!=="boolean")throw c("FBLogger")("instagram_web").mustfixThrow("Could not find predicate %s",a);return d}).reduce(function(a,b){b=b.overrides;return babelHelpers["extends"]({},a,b)},k))}function a(a){var b=i(12),e=a.owner,f=a.path,g=a.post;a=a.variant;var h;b[0]!==e.id?(h=function(a){return d("polarisRelationshipSelectors.react").getRelationship(a.relationships,e.id)},b[0]=e.id,b[1]=h):h=b[1];h=d("PolarisReactRedux.react").useSelector(h);var j=c("usePolarisViewer")(),k=c("usePolarisDisplayProperties")(),l=k.viewportHeight;k=k.viewportWidth;var n=d("PolarisPostModalRenderingContext.react").usePolarisPostModalRenderingContext();n=n.isInModal;if(b[2]!==n||b[3]!==e||b[4]!==f||b[5]!==g||b[6]!==h||b[7]!==a||b[8]!==j||b[9]!==l||b[10]!==k){var o={isInModal:n,isMobile:d("PolarisUA").isMobile(),owner:e,path:f,post:g,relationship:h,variant:a,viewer:j,viewportHeight:l,viewportWidth:k};o=m(o);b[2]=n;b[3]=e;b[4]=f;b[5]=g;b[6]=h;b[7]=a;b[8]=j;b[9]=l;b[10]=k;b[11]=o}else o=b[11];return o}g.getPostFeatures=m;g.usePolarisPostFeatures=a}),98);
__d("PolarisPostFastShareButton.react",["CometPlaceholder.react","IGDContactSearchDialogType.flow","IGDSDirectPanoOutlineIcon.react","IGDSecureShareSheetDialogPlaceholder.react","JSResourceForInteraction","PolarisConfig","PolarisIGCoreSVGIconButton.react","PolarisPostModalContext.react","PolarisPostStrings","PolarisPostTypeUtils","QPLUserFlow","lazyLoadComponent","polarisLogAction","qpl","react","useIGDSLazyDialog","useIGDSecureShareSheetInteractionLogger","useIGDShareSheetOnSubmitPost","usePolarisPost","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;b.useMemo;var j=b.useState,k=b.c,l=c("JSResourceForInteraction")("IGDSecureShareSheetDialog.react").__setRef("PolarisPostFastShareButton.react"),m=c("lazyLoadComponent")(c("JSResourceForInteraction")("IGWebBloksApp").__setRef("PolarisPostFastShareButton.react"));function a(a){var b=k(37),e=a.analyticsContext,f=a["data-testid"],g=a.mediaId,h=a.mediaOverlayInfo,p=a.postId,q=a.sharingFrictionInfo,r=d("usePolarisPost").usePost(p,o),s=d("PolarisPostModalContext.react").useSetPostModal();a=c("useIGDSLazyDialog")(l,n);var t=a[0];p=a[1];a=j(!1);var u=a[0],v=a[1],w=(q==null?void 0:q.bloksAppUrl)!=null&&(q==null?void 0:q.shouldHaveSharingFriction)===!0;a=h!=null?h:r.mediaOverlayInfo;b[0]!==r||b[1]!==a?(h=babelHelpers["extends"]({},r,{mediaOverlayInfo:a}),b[0]=r,b[1]=a,b[2]=h):h=b[2];a=h;var x=a,y=c("useIGDShareSheetOnSubmitPost")(x),z=d("useIGDSecureShareSheetInteractionLogger").useLogShareSheetInteraction();b[3]!==e||b[4]!==r||b[5]!==w||b[6]!==s||b[7]!==z||b[8]!==t||b[9]!==y||b[10]!==x?(h=function(){c("polarisLogAction")("shareClick",{source:e,type:d("PolarisPostTypeUtils").getPostType(r)});c("QPLUserFlow").start(c("qpl")._(379205139,"1723"),{annotations:{string:{source:e}}});if(!w)if(!d("PolarisConfig").isLoggedIn())s("share");else{var a=c("uuidv4")();z("igd_sharesheet_open",{flowInstanceId:a,shareType:d("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.SHARESHEET,source:e});t({flowInstanceId:a,onSubmit:y,post:x})}else v(!0)},b[3]=e,b[4]=r,b[5]=w,b[6]=s,b[7]=z,b[8]=t,b[9]=y,b[10]=x,b[11]=h):h=b[11];a=h;b[12]!==g||b[13]!==e?(h={media_id:g,module:e},b[12]=g,b[13]=e,b[14]=h):h=b[14];h=h;var A=h;b[15]!==w||b[16]!==u||b[17]!==q||b[18]!==z||b[19]!==e||b[20]!==t||b[21]!==y||b[22]!==x||b[23]!==g||b[24]!==A?(h=function(){return!w?null:u&&(q==null?void 0:q.bloksAppUrl)!=null&&i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(m,{appId:q==null?void 0:q.bloksAppUrl,bridgeOverrides_DEPRECATED:{onOpenShareSheetClick:function(){v(!1);var a=c("uuidv4")();z("igd_sharesheet_open",{flowInstanceId:a,shareType:d("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.SHARESHEET,source:e});t({flowInstanceId:a,onSubmit:y,post:x})},onResumeStoryPlayback:function(){v(!1)}},params:A},g)})},b[15]=w,b[16]=u,b[17]=q,b[18]=z,b[19]=e,b[20]=t,b[21]=y,b[22]=x,b[23]=g,b[24]=A,b[25]=h):h=b[25];h=h;var B;b[26]===Symbol["for"]("react.memo_cache_sentinel")?(B=i.jsx(c("IGDSDirectPanoOutlineIcon.react"),{alt:d("PolarisPostStrings").SHARE_TEXT,color:"ig-secondary-text",size:24}),b[26]=B):B=b[26];var C;b[27]===Symbol["for"]("react.memo_cache_sentinel")?(C=i.jsx(c("IGDSDirectPanoOutlineIcon.react"),{alt:d("PolarisPostStrings").SHARE_TEXT,color:"ig-primary-text",size:24}),b[27]=C):C=b[27];b[28]!==f||b[29]!==a||b[30]!==p?(B=i.jsx(c("PolarisIGCoreSVGIconButton.react"),{"data-testid":void 0,hover:B,onClick:a,ref:p,children:C}),b[28]=f,b[29]=a,b[30]=p,b[31]=B):B=b[31];b[32]!==h?(C=h(),b[32]=h,b[33]=C):C=b[33];b[34]!==B||b[35]!==C?(f=i.jsxs(i.Fragment,{children:[B,C]}),b[34]=B,b[35]=C,b[36]=f):f=b[36];return f}function n(a){return i.jsx(c("IGDSecureShareSheetDialogPlaceholder.react"),{onClose:a})}n.displayName=n.name+" [from "+f.id+"]";function o(a){return a}g["default"]=a}),98);
__d("PolarisSaveButton.react",["IGDSIconButton.react","IGDSSavePanoFilledIcon.react","IGDSSavePanoOutlineIcon.react","JSResourceForInteraction","PolarisIGCoreAnchoredPopover.react","PolarisIGCorePressable.react","PolarisPostStrings","PolarisReactRedux.react","PolarisSavedCollectionPicker.react","PolarisSavedPostsActionRequestNextSavedCollections","PolarisUA","nullthrows","polarisSavedPostsSelectors","react","useIGDSLazyDialog","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useState,k=b.c,l=24,m=-16,n=5;function a(a){var b=k(40),e=a.analyticsContext,f=a.collectionsPostSavedTo,g=a["data-testid"],h=a.isSaved,p=a.onSaveMedia,q=a.onSaveMediaToCollection,r=a.onShowToast,s=a.postId,t=a.thumbnailSrcSet,u=d("PolarisReactRedux.react").useDispatch(),v=c("usePolarisViewer")(),w=!v;b[0]!==w||b[1]!==v?(a=function(a){if(w)return null;var b=c("nullthrows")(v);return d("polarisSavedPostsSelectors").getAllSavedCollectionsForUser(a,c("nullthrows")(b.id))},b[0]=w,b[1]=v,b[2]=a):a=b[2];var x=d("PolarisReactRedux.react").useSelector(a);b[3]!==w||b[4]!==v?(a=function(a){if(w)return null;var b=c("nullthrows")(v);return d("polarisSavedPostsSelectors").getSavedCollectionsPaginationForUser(a,c("nullthrows")(b.id))},b[3]=w,b[4]=v,b[5]=a):a=b[5];var y=d("PolarisReactRedux.react").useSelector(a);b[6]!==x||b[7]!==y?(a=function(){if(x==null||y==null)return!1;return x.length>=n?!0:!y.moreAvailable&&x.length>1},b[6]=x,b[7]=y,b[8]=a):a=b[8];var z=a;b[9]!==w?(a=!w&&d("PolarisUA").isDesktop(),b[9]=w,b[10]=a):a=b[10];a=a;var A=z()&&a,B=function(a){a.preventDefault(),p(!h),!h===!0&&A&&(r!=null&&r(),F(!0))},C=function(){if(!w&&!z()&&!c("nullthrows")(y).isFetching){var a=c("nullthrows")(v);u(d("PolarisSavedPostsActionRequestNextSavedCollections").requestInitialSavedCollections(c("nullthrows")(a.id)))}F(!1)},D=j(!1),E=D[0];D=D[1];var F=D;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(D=c("JSResourceForInteraction")("PolarisCreateCollectionWithPostModal.react").__setRef("PolarisSaveButton.react"),b[11]=D):D=b[11];D=c("useIGDSLazyDialog")(D);var G=D[0];b[12]!==A||b[13]!==F||b[14]!==G||b[15]!==p||b[16]!==s||b[17]!==e||b[18]!==t||b[19]!==f||b[20]!==E||b[21]!==q||b[22]!==h?(D=A?i.jsx(c("PolarisSavedCollectionPicker.react"),{collectionsPostSavedTo:f,hidePopover:E,onSaveMedia:p,onSaveMediaToCollection:q,postId:s,postIsSaved:h,setHidePopover:F,setShowCreateCollectionModal:function(){return G({onSaveChange:p,postId:s,source:e,srcSet:t})}}):null,b[12]=A,b[13]=F,b[14]=G,b[15]=p,b[16]=s,b[17]=e,b[18]=t,b[19]=f,b[20]=E,b[21]=q,b[22]=h,b[23]=D):D=b[23];b[24]!==h||b[25]!==a?(f=h||!a?null:i.jsx(c("IGDSSavePanoOutlineIcon.react"),{alt:d("PolarisPostStrings").SAVE_TEXT,color:"ig-secondary-text",size:l}),b[24]=h,b[25]=a,b[26]=f):f=b[26];b[27]!==h?(E=h?i.jsx(c("IGDSSavePanoFilledIcon.react"),{alt:d("PolarisPostStrings").UNSAVE_TEXT,color:"ig-primary-text",size:l}):i.jsx(c("IGDSSavePanoOutlineIcon.react"),{alt:d("PolarisPostStrings").SAVE_TEXT,color:"ig-primary-text",size:l}),b[27]=h,b[28]=E):E=b[28];b[29]!==g||b[30]!==f||b[31]!==B||b[32]!==E?(q=i.jsx(c("IGDSIconButton.react"),{"data-testid":void 0,hover:f,onClick:B,padding:8,children:E}),b[29]=g,b[30]=f,b[31]=B,b[32]=E,b[33]=q):q=b[33];b[34]!==C||b[35]!==q?(a=i.jsx(c("PolarisIGCorePressable.react"),{onMouseEnter:C,onPress:o,children:q}),b[34]=C,b[35]=q,b[36]=a):a=b[36];b[37]!==D||b[38]!==a?(g=i.jsx(c("PolarisIGCoreAnchoredPopover.react"),{content:D,offsetTop:m,preferredPositionX:"center",preferredPositionY:"top",showOnHover:!0,children:a}),b[37]=D,b[38]=a,b[39]=g):g=b[39];return g}function o(){}g["default"]=a}),98);
__d("usePolarisMediaSaveToCollectionReduxHandler",["PolarisPostActionAddPostToCollection","PolarisPostActionRemovePostFromCollection","PolarisReactRedux.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c;function a(a){var b=i(3),c=d("PolarisReactRedux.react").useDispatch(),e;b[0]!==c||b[1]!==a?(e=function(b,e){b?c(d("PolarisPostActionRemovePostFromCollection").removePostFromCollection({collectionId:e,postId:a})):c(d("PolarisPostActionAddPostToCollection").addPostToCollection({collectionId:e,postIds:[a]}))},b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("PolarisPostFeedbackControls_DEPRECATED.react",["IGRouter_DO_NOT_USE.react","PolarisCommentButton.react","PolarisConfig","PolarisFeedActionOpenPostModalForId","PolarisInFeedPostModalContext","PolarisInteractionsLogger","PolarisLikeButton.react","PolarisPostFastShareButton.react","PolarisPostVariants","PolarisReactRedux.react","PolarisSaveButton.react","PolarisSponsoredPostContext.react","PolarisTrackingConstants","PolarisUA","XPolarisMobileAllCommentsControllerRouteBuilder","logPolarisPostModalOpen","polarisLogAction","polarisPostSelectors","react","react-forget-runtime","stylex","usePolarisMediaSaveToCollectionReduxHandler","usePolarisNavigateToLogin","usePolarisPostShowSavedToastHandler","usePolarisSelector"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useContext,l=b.c,m={commentButton:{display:"x1rg5ohu",$$css:!0},commentButtonLeftAligned:{marginEnd:"x1emribx",order:"x182iqb8",$$css:!0},likeButton:{display:"x1rg5ohu",marginStart:"xp7jhwk",$$css:!0},likeButtonLeftAligned:{marginEnd:"x1emribx",order:"x9ek82g",$$css:!0},root:{display:"x78zum5",flexDirection:"x1q0g3np",marginTop:"x1gslohp",$$css:!0},saveButton:{borderTopWidth:"x972fbf",borderEndWidth:"xcfux6l",borderBottomWidth:"x1qhh985",borderStartWidth:"xm0m39n",display:"x1rg5ohu",font:"xln7xf2",fontSize:"xk390pu",marginTop:"xdj266r",marginEnd:"x1sre0sj",marginBottom:"xat24cr",marginStart:"x1gryazu",paddingTop:"xexx8yu",paddingEnd:"x4uap5",paddingBottom:"x18d9i69",paddingStart:"xkhd6sd",verticalAlign:"x11njtxf",$$css:!0},saveButtonLeftAligned:{marginEnd:"x1emribx",marginStart:"x1mh8g0r",order:"xo1ph6p",$$css:!0},shareButton:{display:"x1rg5ohu",$$css:!0},shareButtonLeftAligned:{marginEnd:"x1emribx",order:"x14yy4lh",$$css:!0}};function a(a){var b=l(70),e=a.analyticsContext,f=a.canViewerProvideFeedback,g=a.canViewerReshare,i=a.code,o=a.commentsDisabled,p=a.containerRef,q=a.customAlignment,r=a.hideShareButton,s=a.isBlocked,t=a.isSidecar,u=a.isVideo,v=a.likedByViewer,w=a.mediaId,x=a.onCommentClick,y=a.onLikeChange,z=a.onSaveChange,A=a.ownerIsPrivate,B=a.ownerUsername,C=a.postId,D=a.savedByViewer,E=a.sharingFrictionInfo,F=a.variant,G=a.xstyle,H=a.history,I=d("PolarisReactRedux.react").useDispatch();b[0]!==C?(a=function(a){return d("polarisPostSelectors").getPostById(a,C)},b[0]=C,b[1]=a):a=b[1];a=c("usePolarisSelector")(a);var J;b[2]!==C?(J=function(a){return d("polarisPostSelectors").getSavedCollectionsForPost(a,C)},b[2]=C,b[3]=J):J=b[3];J=c("usePolarisSelector")(J);var K=c("usePolarisPostShowSavedToastHandler")(),L=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,n),M=L.canUserSeePersistentCta,N=k(d("PolarisInFeedPostModalContext").InFeedPostModalContext),O=c("usePolarisNavigateToLogin")(i,B);b[4]!==y||b[5]!==e||b[6]!==O?(L=function(a){d("PolarisConfig").isLoggedIn()?y(a,"button"):(c("polarisLogAction")("likeAttempt",{source:e}),O("like"))},b[4]=y,b[5]=e,b[6]=O,b[7]=L):L=b[7];B=L;b[8]!==z||b[9]!==e||b[10]!==O?(L=function(a){d("PolarisConfig").isLoggedIn()?z(a):(c("polarisLogAction")("saveAttempt",{source:e}),O("save"))},b[8]=z,b[9]=e,b[10]=O,b[11]=L):L=b[11];L=L;var P=c("usePolarisMediaSaveToCollectionReduxHandler")(C),Q;b[12]!==e||b[13]!==u||b[14]!==F||b[15]!==I||b[16]!==C||b[17]!==N||b[18]!==t||b[19]!==M||b[20]!==i||b[21]!==H||b[22]!==x||b[23]!==O?(Q=function(){var a=d("PolarisUA").isMobile();c("polarisLogAction")("commentButtonClicked",{isLoggedIn:d("PolarisConfig").isLoggedIn(),source:e,type:u?"video":"photo"});if(d("PolarisConfig").isLoggedIn())if(d("PolarisUA").isDesktop()&&F===d("PolarisPostVariants").VARIANTS.feed)I(d("PolarisFeedActionOpenPostModalForId").openPostModalForId(C)),N(C),c("logPolarisPostModalOpen")(e,d("PolarisInteractionsLogger").getMediaTypeFromPost({isSidecar:t,isVideo:u}),"feed_comment");else if(F===d("PolarisPostVariants").VARIANTS.feed||a){a=c("XPolarisMobileAllCommentsControllerRouteBuilder").buildURL((a={},a[d("PolarisTrackingConstants").ENABLE_PERSISTENT_CTA]=M||void 0,a.shortcode=i,a));H.push(a)}else x();else O("comment")},b[12]=e,b[13]=u,b[14]=F,b[15]=I,b[16]=C,b[17]=N,b[18]=t,b[19]=M,b[20]=i,b[21]=H,b[22]=x,b[23]=O,b[24]=Q):Q=b[24];Q=Q;f=!d("PolarisConfig").isLoggedIn()||f;if(s||!f)return null;s=A!==!0&&Boolean(g);f=q==="left";A=f&&m.likeButtonLeftAligned;b[25]!==A?(g=(h||(h=c("stylex")))(m.likeButton,A),b[25]=A,b[26]=g):g=b[26];b[27]!==g||b[28]!==v||b[29]!==B?(q=j.jsx(c("PolarisLikeButton.react"),{className:g,"data-testid":void 0,isLiked:v,onChange:B}),b[27]=g,b[28]=v,b[29]=B,b[30]=q):q=b[30];b[31]!==o||b[32]!==f||b[33]!==Q?(A=!o&&j.jsx(c("PolarisCommentButton.react"),{className:(h||(h=c("stylex")))(m.commentButton,f&&m.commentButtonLeftAligned),"data-testid":void 0,onClick:Q}),b[31]=o,b[32]=f,b[33]=Q,b[34]=A):A=b[34];b[35]!==s||b[36]!==r||b[37]!==f||b[38]!==e||b[39]!==w||b[40]!==C||b[41]!==E?(g=s&&r!==!0&&j.jsx("span",{className:(h||(h=c("stylex")))(m.shareButton,f&&m.shareButtonLeftAligned),children:j.jsx(c("PolarisPostFastShareButton.react"),{analyticsContext:e,"data-testid":void 0,mediaId:w,mediaOverlayInfo:null,postId:C,sharingFrictionInfo:E})}),b[35]=s,b[36]=r,b[37]=f,b[38]=e,b[39]=w,b[40]=C,b[41]=E,b[42]=g):g=b[42];b[43]!==q||b[44]!==A||b[45]!==g?(v=j.jsxs(j.Fragment,{children:[q,A,g]}),b[43]=q,b[44]=A,b[45]=g,b[46]=v):v=b[46];B=v;b[47]!==G?(o=(h||(h=c("stylex")))(m.root,G),b[47]=G,b[48]=o):o=b[48];Q=f&&m.saveButtonLeftAligned;b[49]!==Q?(s=(h||(h=c("stylex")))(m.saveButton,Q),b[49]=Q,b[50]=s):s=b[50];if(b[51]!==J){w=(r=J)!=null?r:[];b[51]=J;b[52]=w}else w=b[52];b[53]!==e||b[54]!==w||b[55]!==D||b[56]!==L||b[57]!==P||b[58]!==K||b[59]!==C||b[60]!==a.displayResources?(E=j.jsx(c("PolarisSaveButton.react"),{analyticsContext:e,collectionsPostSavedTo:w,"data-testid":void 0,isSaved:D,onSaveMedia:L,onSaveMediaToCollection:P,onShowToast:K,postId:C,thumbnailSrcSet:a.displayResources}),b[53]=e,b[54]=w,b[55]=D,b[56]=L,b[57]=P,b[58]=K,b[59]=C,b[60]=a.displayResources,b[61]=E):E=b[61];b[62]!==s||b[63]!==E?(q=j.jsx("span",{className:s,children:E}),b[62]=s,b[63]=E,b[64]=q):q=b[64];b[65]!==o||b[66]!==p||b[67]!==B||b[68]!==q?(A=j.jsxs("section",{className:o,ref:p,children:[B,q]}),b[65]=o,b[66]=p,b[67]=B,b[68]=q,b[69]=A):A=b[69];return A}function n(a){return[a.canUserSeePersistentCta]}e=d("IGRouter_DO_NOT_USE.react").withIGRouter(a);g["default"]=e}),98);
__d("PolarisPostFooter.react",["IGDSBox.react","PolarisBoostUtils.react","PolarisPostBoostButton.react","PolarisPostViewInsights.react","nullthrows","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k={marginTop0:{marginTop:"xdj266r",$$css:!0},marginTop16:{marginTop:"xw7yly9",$$css:!0}};function a(a){var b=i(20),e=a.analyticsContext,f=a.bloksAppId,g=a.boostedStatus,h=a.boostUnavailableIdentifier,l=a.boostUnavailableReason,m=a.className,n=a.hasViewInsights,o=a.mediaId,p=a.productType;a=a.viewerId;a=d("PolarisBoostUtils.react").useIsEligibleForBoost(g!=null&&a!=null);if(!n&&!a)return null;var q=n?"between":"end",r=n?k.marginTop0:k.marginTop16,s;b[0]!==n||b[1]!==f||b[2]!==o?(s=n&&j.jsx(c("PolarisPostViewInsights.react"),{bloksAppId:f,mediaId:o}),b[0]=n,b[1]=f,b[2]=o,b[3]=s):s=b[3];b[4]!==a||b[5]!==p||b[6]!==g||b[7]!==e||b[8]!==h||b[9]!==l||b[10]!==o?(n=a&&p!=="ad"&&j.jsx(c("PolarisPostBoostButton.react"),{analyticsContext:e,boostedStatus:c("nullthrows")(g),boostUnavailableIdentifier:h,boostUnavailableReason:l,mediaId:o,productType:c("nullthrows")(p)}),b[4]=a,b[5]=p,b[6]=g,b[7]=e,b[8]=h,b[9]=l,b[10]=o,b[11]=n):n=b[11];b[12]!==q||b[13]!==r||b[14]!==s||b[15]!==n?(f=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",justifyContent:q,paddingX:4,paddingY:3,position:"relative",xstyle:r,children:[s,n]}),b[12]=q,b[13]=r,b[14]=s,b[15]=n,b[16]=f):f=b[16];b[17]!==m||b[18]!==f?(a=j.jsx("section",{className:m,children:f}),b[17]=m,b[18]=f,b[19]=a):a=b[19];return a}g["default"]=a}),98);
__d("PolarisPostRemoveCommentsSelectors",["reselect"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.postRemoveComments}b=d("reselect").createSelector(a,function(a){a=a.isVisible;return a});g.getPostRemoveCommentsIsVisible=b}),98);
__d("PolarisPreviewComments.react",["cx","fbt","IGDSSpinner.react","PolarisBatchDOM","PolarisBigNumber.react","PolarisCommentActionConstants","PolarisCommentActions","PolarisIGCoreButton.react","PolarisInteractionsLogger","PolarisLinkBuilder","PolarisNavigationActions","PolarisPostComment.react","PolarisPostVariants","PolarisReactRedux.react","PolarisUA","browserHistory_DO_NOT_USE","isStringNullOrEmpty","joinClasses","polarisCommentSelectors.react","polarisPostSelectors","react","usePolarisDisplayProperties"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));e=j;e.useMemo;var l=e.c;f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.$2=function(a){var b=c.props,e=b.analyticsContext,f=b.code,g=b.id,h=b.loadMore,i=b.loggedIn,j=b.mediaType,k=b.onLoggedOutIntentClick,l=b.ownerId;b=b.variant;var m=d("PolarisUA").isMobile();a.preventDefault();if(b===d("PolarisPostVariants").VARIANTS.feed||m){a=d("PolarisLinkBuilder").buildMediaCommentsLink(f,m);i?(d("browserHistory_DO_NOT_USE").browserHistory.push(a),d("PolarisInteractionsLogger").logInteractionAction({containerModule:e,eventName:"instagram_organic_comment_view_all",mediaAuthorId:l,mediaId:g,mediaType:j})):k("post_comment_view_all")}else h(g,f),d("PolarisInteractionsLogger").logInteractionAction({containerModule:e,eventName:"instagram_organic_comment_view_more",mediaAuthorId:l,mediaId:g,mediaType:j})},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.componentDidUpdate=function(a,b,c){var e=this,f=a.commentSaveIsInFlight&&!this.props.commentSaveIsInFlight,g=this.$1;if(!g)return;d("PolarisBatchDOM").measure(function(){var b=g.scrollTop;f?b=g.scrollHeight:c!=null?b=g.scrollHeight-c:e.props.id!==a.id&&(b=0);d("PolarisBatchDOM").mutate(function(){g.scrollTop=b})})};e.getSnapshotBeforeUpdate=function(a){var b=a.comments,c=this.props.comments;if(a.id===this.props.id&&c&&b&&c.count()>b.count()){a=this.$1;if(a)return a.scrollHeight-a.scrollTop}return null};e.render=function(){var a=this,b=this.props,e=b.analyticsContext,f=b.captionAndTitle,g=b.captionIsEdited,h=b.className,i=b.commentsAreStacked,j=b.commentsDisabled,l=b.commentsHasNextPage,m=b.commentsTotalCount,n=b.handleDeleteCommentClick,o=b.id,p=b.loggedIn,q=b.mediaType,r=b.ownerId,s=b.postedAt,t=b.previewComments,u=b.showRemoveCommentIcons,v=b.variant;b=j!==!0&&(l===!0||t!=null&&t.length<m);if((f==null||f==="")&&m===0&&!b)return null;l=t;return k.jsx("div",{className:c("joinClasses")("_acri"+(!d("PolarisUA").isMobile()&&v===d("PolarisPostVariants").VARIANTS.flexible&&!i?" _acrj":""),h),ref:function(b){return a.$1=b},children:k.jsxs("ul",{className:"_acrk",children:[!c("isStringNullOrEmpty")(f)&&k.jsx(c("PolarisPostComment.react"),{analyticsContext:e,commentOwnerId:r,isCaption:!0,isEdited:!!g,isRestrictedPending:!1,loggedIn:p,mediaType:q,postedAt:s,postId:o,postOwnerId:r,showRemoveIcon:!1,text:f,variant:v},"captionAndTitle"),b&&this.renderLoadMoreCommentsLink(),j!==!0&&l&&l.map(function(a){return k.jsx(c("PolarisPostComment.react"),{analyticsContext:e,commentOwnerId:a.userId,id:a.id,isAuthorVerified:a.isAuthorVerified,isRestrictedPending:a.isRestrictedPending,likedByViewer:a.likedByViewer,loggedIn:p,mediaType:q,onDeleteCommentClick:n,postedAt:a.postedAt,postId:o,postOwnerId:r,showRemoveIcon:u,text:a.text,variant:v},a.id)})]})})};e.renderLoadMoreCommentsLink=function(){var a=this.props,b=a.comments,e=a.commentsIsFetching,f=a.commentsTotalCount;a=a.variant;var g=i._("__JHASH__EzDl3Q5qBhq__JHASH__");b&&b.count()+d("PolarisCommentActionConstants").PAGE_SIZE>=f||a===d("PolarisPostVariants").VARIANTS.feed||d("PolarisUA").isMobile()?b=i._("__JHASH__goQVaKpz6ee__JHASH__",[i._param("count",k.jsx(c("PolarisBigNumber.react"),{value:f}))]):b=g;return k.jsxs("li",{className:"_acrl",children:[k.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,dangerouslySetClassName:{__className:"_acrm"},disabled:e,onClick:this.$2,children:b}),e&&k.jsx("div",{className:"_acrn",children:k.jsx(c("IGDSSpinner.react"),{position:"static",size:"small"})})]})};return b}(k.PureComponent);function a(a,b){var c=d("polarisCommentSelectors.react").getPreviewCommentsForPostId(a,b.id);b=d("polarisPostSelectors").getNumCommentsForPostId(a,b.id);a=a.navigation.pageIdentifier||"";return{analyticsContext:a,commentSaveIsInFlight:!1,commentsHasNextPage:!1,commentsIsFetching:!1,commentsTotalCount:b,previewComments:c}}function b(){var a=l(2),b=c("usePolarisDisplayProperties")();b=b.viewportWidth;var d;a[0]!==b?(d={viewportWidth:b},a[0]=b,a[1]=d):d=a[1];b=d;return b}h={loadMore:d("PolarisCommentActions").requestNextCommentPage,onLoggedOutIntentClick:d("PolarisNavigationActions").openLoggedOutIntentDialog};e=d("PolarisReactRedux.react").connect(a,h)(f);a=d("PolarisReactRedux.react").connectHooks(b)(e);g["default"]=a}),226);
__d("PolarisThreadedComments.react",["cx","IGDSBox.react","IGDSDivider.react","PolarisBatchDOM","PolarisCommentCover.react","PolarisCommentThread.react","PolarisCommentsContainerPlaceholder.react","PolarisCommentsSectionText.react","PolarisCommentsSortContext.react","PolarisCommentsStrings","PolarisConfig","PolarisInteractionsLogger","PolarisLinkBuilder","PolarisNoCommentsPlaceholder.react","PolarisPaginationUtils","PolarisPendingCommentState","PolarisPostComment.react","PolarisPostVariants","PolarisReactRedux.react","PolarisSortCommentsUtil","PolarisThreadedCommentActions","PolarisThreadedCommentSelectors","PolarisThreadedCommentsLoadMoreButton.react","PolarisUA","cr:1342","isStringNullOrEmpty","nullthrows","polarisCommentReducer","polarisUserSelectors","react","requestIdleCallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l={commentsCover:{marginStart:"x16n37ib",$$css:!0}};function m(a,b){var c=b.getBoundingClientRect().top;c=c-b.scrollTop;b=a.getBoundingClientRect().top;return b-c}function n(a){var b=j(22),d=a.innerRef,e=a.isPermalinkedComment,f=a.onHidePermalinkReply,g=a.parentComment,h=a.parentProps,i=a.parentState,l=a.permalinkedReplyId,m=a.permalinkedReplyNodeRef;a=a.replyPagerNodeRef;var n=h.analyticsContext,o=h.code,p=h.commentingDisabledForViewer,q=h.customIndentationPadding,r=h.handleDeleteCommentClick,s=h.hideUserAvatar,t=h.id,u=h.isDeletingComments,v=h.loggedIn,w=h.onLikeCountClick,x=h.ownerId,y=h.reducedAvatarMargin;h=h.showCommentOptionsInline;i=i.commentPermalinkAnimEnabled;var z;b[0]!==n||b[1]!==o||b[2]!==p||b[3]!==q||b[4]!==s||b[5]!==d||b[6]!==e||b[7]!==v||b[8]!==r||b[9]!==f||b[10]!==w||b[11]!==g||b[12]!==i||b[13]!==l||b[14]!==m||b[15]!==t||b[16]!==x||b[17]!==y||b[18]!==a||b[19]!==h||b[20]!==u?(z=k.jsx(c("PolarisCommentThread.react"),{analyticsContext:n,code:o,commentingDisabledForViewer:p,customIndentationPadding:q,hideUserAvatar:s,innerRef:d,isPermalinkedComment:e,loggedIn:v,onDeleteCommentClick:r,onHidePermalinkReply:f,onLikeCountClick:w,parentComment:g,permalinkedReplyAnimating:i,permalinkedReplyId:l,permalinkedReplyNodeRef:m,postId:t,postOwnerId:x,reducedAvatarMargin:y,replyPagerNodeRef:a,showCommentOptionsInline:h,showRemoveIcon:u}),b[0]=n,b[1]=o,b[2]=p,b[3]=q,b[4]=s,b[5]=d,b[6]=e,b[7]=v,b[8]=r,b[9]=f,b[10]=w,b[11]=g,b[12]=i,b[13]=l,b[14]=m,b[15]=t,b[16]=x,b[17]=y,b[18]=a,b[19]=h,b[20]=u,b[21]=z):z=b[21];return z}f=function(a){babelHelpers.inheritsLoose(e,a);function e(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.$2=k.createRef(),c.$3=k.createRef(),c.$4=k.createRef(),c.$5=[],c.state={commentPermalinkAnimEnabled:!1,commentsSortOrder:c.props.sortOrder,isAutoscrollingCommentPermalink:!1,replyPermalinkLastHideTime:null,showHiddenComments:!1},c.$13=function(a){a=c.props;var b=a.analyticsContext,e=a.code,f=a.hasRankedComments,g=a.id,h=a.loadMore,i=a.mediaType;a=a.ownerId;h(g,f,e);d("PolarisInteractionsLogger").logInteractionAction({containerModule:b,eventName:"instagram_child_comments_load_more",mediaAuthorId:a,mediaId:g,mediaType:i})},c.$14=function(){c.setState({showHiddenComments:!0})},c.$15=function(a){c.setState({commentsSortOrder:a})},b)||babelHelpers.assertThisInitialized(c)}var f=e.prototype;f.$6=function(){return this.$2.current||null};f.$7=function(){return this.$3.current||null};f.$8=function(){return this.$4.current||null};f.$9=function(a,b,e,f){var g=this;this.setState({commentPermalinkAnimEnabled:!1,isAutoscrollingCommentPermalink:!0});d("PolarisBatchDOM").measure(function(){var h,i=m(b,a);if(e){var j=m(e,a),k=e.getBoundingClientRect().height,l=a.getBoundingClientRect().height;l=Math.max(l-k,0);h=Math.max(i,j-l)}else h=i;d("PolarisBatchDOM").mutate(function(){a.scrollTop=h;var b=function(){g.setState({commentPermalinkAnimEnabled:!0,isAutoscrollingCommentPermalink:!1})};f?c("requestIdleCallback")(function(){b()}):b()})})};f.componentDidMount=function(){var a=this.$1;if(!a)return;var b=this.$6();if(b)this.$9(a,b,this.$7(),!0);else if(!this.props.hasRankedComments){if(d("PolarisUA").isDesktop())return;a.scrollTop=a.scrollHeight}};f.componentDidUpdate=function(a,b,c){var d=this.$1;if(!d)return;var e=this.$6();if(e)if(this.state.isAutoscrollingCommentPermalink)return;else if(this.props.permalinkedCommentId!==a.permalinkedCommentId||this.props.permalinkedReplyId!==a.permalinkedReplyId||this.props.permalinkedComment!==a.permalinkedComment){this.$9(d,e,this.$7(),!1);return}this.$10(a,b,c,d,e)};f.$10=function(a,b,c,e,f){var g=this,h=a.commentSaveIsInFlight&&!this.props.commentSaveIsInFlight;c=c||{};var i=c.newCommentCachedOffset,j=a.id===this.props.id&&a.permalinkedCommentId===this.props.permalinkedCommentId&&a.permalinkedReplyId===this.props.permalinkedReplyId&&b.replyPermalinkLastHideTime!==this.state.replyPermalinkLastHideTime,k=this.$8();h&&!a.commentWasReply&&(this.$5[0]&&this.$5[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}));d("PolarisBatchDOM").measure(function(){var b=null;h&&!a.commentWasReply&&!g.props.hasRankedComments?b=e.scrollHeight:i!=null?b=e.scrollHeight-i:j&&f&&k&&(b=g.$11(e,f,k));d("PolarisBatchDOM").mutate(function(){b!=null&&(e.scrollTop=b)})})};f.$11=function(a,b,c){c=m(c,a);b=m(b,a);var d=6;c=Math.max(c-d,b);return a.scrollTop>c?c:null};f.getSnapshotBeforeUpdate=function(a,b){b=a.comments;var c=this.props.comments,d=this.$1;return d&&a.id===this.props.id&&c.count()>b.count()&&!this.props.hasRankedComments?{newCommentCachedOffset:d.scrollHeight-d.scrollTop}:null};f.$12=function(){this.setState({replyPermalinkLastHideTime:new Date().valueOf()})};f.render=function(){var a=this,e=this.props,f=e.analyticsContext,g=e.captionAndTitle,h=e.captionCreatedAt,i=e.captionIsEdited,j=e.className,m=e.comments,o=e.commentsDisabled,p=e.commentsHasNextPage,q=e.disableScroll,r=e.hasCoveredComments,s=e.hasRankedComments,t=e.hideUserAvatar,u=e.id,v=e.initialCommentsLoading,w=e.isOwnerVerified,x=e.loggedIn,y=e.mediaType,z=e.ownerId,A=e.permalinkedComment,B=e.permalinkedReplyId,C=e.postedAt,D=e.reducedAvatarMargin,E=e.requestComments,F=e.showCommentOptionsInline;e=e.showPagerBelowComments;p=o!==!0&&Boolean(p);var G=v&&m.size===0;if((g==null||g==="")&&m.count()===0&&!p&&!G)return d("PolarisUA").isDesktop()?k.jsx("div",{className:j,children:k.jsx(c("PolarisNoCommentsPlaceholder.react"),{})}):k.jsx("div",{className:j});var H=null,I=null,J=null;if(!G&&o!=null){H=A?k.jsx("div",{className:"_a9z3"+(this.state.commentPermalinkAnimEnabled&&!B?" _a9yl":""),ref:this.$2,children:k.jsx(n,{isPermalinkedComment:!0,onHidePermalinkReply:function(){return a.$12()},parentComment:A,parentProps:this.props,parentState:this.state,permalinkedReplyId:B,permalinkedReplyNodeRef:this.$3,replyPagerNodeRef:this.$4})}):null;var K=function(){var b;return(b=a.props.comments.findIndex(function(a){return a.isAuthorVerified===!1}))!=null?b:-1};I=m.map(function(b,e){if(A&&b.id===A.id)return null;return b.isCovered===!0?null:k.jsxs(c("IGDSBox.react"),{marginBottom:4,children:[k.jsx(n,{innerRef:function(b){return a.$5[e]=b},parentComment:b,parentProps:a.props,parentState:a.state},e),a.props.sortOrder===d("PolarisSortCommentsUtil").CommentsOptionValues.META_VERIFIED&&K()===e+1&&k.jsx(c("IGDSDivider.react"),{})]},e)}).filter(function(a){return!!a});J=m.filter(function(a){return a.isCovered===!0}).map(function(b,c){return k.jsx(n,{innerRef:function(b){return a.$5[c]=b},parentComment:b,parentProps:a.props,parentState:a.state},c)})}o=null;c("isStringNullOrEmpty")(g)||(o=k.jsx(c("PolarisPostComment.react"),{analyticsContext:f,captionCreatedAt:h,className:(d("PolarisUA").isMobile()?"_a9z4":"")+" _a9z5",commentOwnerId:z,hideUserAvatar:!!t,isAuthorVerified:!!w,isCaption:!0,isEdited:!!i,isRestrictedPending:!1,loggedIn:x,mediaType:y,postedAt:c("nullthrows")(C),postId:u,postOwnerId:z,reducedAvatarMargin:D,showCommentOptionsInline:F,showRemoveIcon:!1,showRichComment:!0,text:g,variant:d("PolarisPostVariants").VARIANTS.flexible},"captionAndTitle"));B=p&&this.renderLoadMoreCommentsLink(H!=null);f=s||e===!0;h=function(a){return E(u,void 0,a)};t=d("PolarisSortCommentsUtil").showCommentsSortOptions(this.props.sortOrder,m.size);w=function(){return m.some(function(a){return a.isAuthorVerified===!0})};i=this.props.sortOrder===d("PolarisSortCommentsUtil").CommentsOptionValues.META_VERIFIED&&!w();x=k.jsx(c("IGDSBox.react"),{marginEnd:d("PolarisUA").isMobile()?4:0,marginStart:d("PolarisUA").isMobile()?4:0,children:k.jsx(c("IGDSDivider.react"),{})});return k.jsx(d("PolarisCommentsSortContext.react").PolarisCommentsSortContextProvider,{commentsSortOrder:this.state.commentsSortOrder,setCommentsSortOrder:this.$15,children:k.jsx("div",{className:j,children:k.jsxs("ul",{className:"_a9z6"+(q?" _a9z7":"")+(H!==null?" _a9z8":"")+(o===null?" _a9z9":"")+(!B||f?" _a9za":""),ref:function(b){return a.$1=b},children:[o,k.jsxs(c("IGDSBox.react"),{direction:"column",display:"flex",children:[t&&b("cr:1342")!=null&&k.jsx(c("IGDSBox.react"),{marginStart:12,marginTop:2,children:k.jsx(b("cr:1342"),{commentsCount:m.size,fetchComments:h})}),H]}),G?k.jsx(c("PolarisCommentsContainerPlaceholder.react"),{}):null,!f&&B,k.jsx(c("IGDSBox.react"),{children:v?k.jsx(c("PolarisCommentsContainerPlaceholder.react"),{}):k.jsxs(c("IGDSBox.react"),{children:[i&&k.jsx(c("PolarisCommentsSectionText.react"),{commentsDivider:x,marginStart:12,text:d("PolarisSortCommentsUtil").NO_META_VERIFIED_COMMENTS}),k.jsxs(c("IGDSBox.react"),{children:[!d("PolarisConfig").isLoggedOutFRXEligible()&&I,f&&B,!B&&r&&!this.state.showHiddenComments&&k.jsx(c("PolarisCommentCover.react"),{onClick:this.$14,postId:u,postOwnerId:z,xstyle:l.commentsCover}),this.state.showHiddenComments&&k.jsxs(k.Fragment,{children:[k.jsx(c("PolarisCommentsSectionText.react"),{commentsDivider:x,marginStart:12,text:d("PolarisCommentsStrings").COVERED_COMMENTS}),J]})]})]})})]})})})};f.renderLoadMoreCommentsLink=function(a){var b=this.props,e=b.code,f=b.commentsIsFetching;b=b.hasRankedComments;e=d("PolarisLinkBuilder").buildMediaCommentsLink(c("nullthrows")(e),d("PolarisUA").isMobile());var g;b?(b=0,g=0):a?(b=2,g=2):(b=0,g=4);return k.jsx("li",{children:k.jsx(c("PolarisThreadedCommentsLoadMoreButton.react"),{commentsIsFetching:f,handleLoadMoreCommentsClick:this.$13,marginBottom:g,marginTop:b,url:e})})};return e}(k.PureComponent);function a(a,b){var c,e,f=b.id,g=b.ownerId;b=b.permalinkedCommentId;var h=d("PolarisThreadedCommentSelectors").getThreadedCommentsLoading(a,f),i=d("PolarisThreadedCommentSelectors").selectVisibleParentCommentsForPostId(a,f);c=(c=a.threadedComments.parentByPostId[f])!=null?c:d("polarisCommentReducer").EMPTY_POST_COMMENTS_STATE;var j=c.count;c=c.pagination;e=(e=a.pendingComments[f])!=null?e:d("PolarisPendingCommentState").EMPTY_PENDING_COMMENT;var k=null;!h&&b!=null&&b!==""&&(k=a.comments.byId.get(b));b=(f=(b=a.threadedComments.parentByPostId[f])==null?void 0:b.sortOrder)!=null?f:d("PolarisSortCommentsUtil").CommentsOptionValues.TOP;return{comments:i,commentSaveIsInFlight:e.committing,commentsHasNextPage:d("PolarisPaginationUtils").hasNextPage(c),commentsIsFetching:d("PolarisPaginationUtils").isFetching(c),commentsTotalCount:j!=null?j:0,commentWasReply:e.repliedToCommentId!=null,hasCoveredComments:i.some(function(a){return a.isCovered===!0}),initialCommentsLoading:h,isOwnerVerified:d("polarisUserSelectors").getUserByIdOrThrows(a,g).isVerified,permalinkedComment:k,sortOrder:b}}function e(a){return{loadMore:function(b,c,e){d("PolarisConfig").isLoggedIn()?a(d("PolarisThreadedCommentActions").requestNextParentCommentPageV2(b,c)):a(d("PolarisThreadedCommentActions").requestNextParentCommentPage(b,c,e))},requestComments:function(b,c,e){a(d("PolarisThreadedCommentActions").requestInitialComments(b,c,e))}}}h=d("PolarisReactRedux.react").connect(a,e)(f);g["default"]=h}),98);
__d("PolarisThreadedCommentsLoader.react",["CometErrorBoundary.react","CometPlaceholder.react","FBLogger","IGDSBox.react","IGDSSpinner.react","PolarisReactRedux.react","PolarisThreadedCommentActions","react","usePolarisGetQuerySetup"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){var b=i(2),e=a.children,f=a.initialCommentsQuery;a=a.postId;var g;b[0]!==a?(g=d("PolarisThreadedCommentActions").setupPostComments(a),b[0]=a,b[1]=g):g=b[1];c("usePolarisGetQuerySetup")(f,g);return e}function a(a){var b=i(11),e=a.children,f=a.initialCommentsQuery,g=a.postId,h=d("PolarisReactRedux.react").useDispatch();b[0]!==h||b[1]!==g?(a=function(a){h(d("PolarisThreadedCommentActions").initialCommentsError(g)),c("FBLogger")("ig_web").catching(a)},b[0]=h,b[1]=g,b[2]=a):a=b[2];a=a;var m;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(m=j.jsx(c("IGDSBox.react"),{direction:"row",justifyContent:"center",position:"relative",children:j.jsx(c("IGDSSpinner.react"),{})}),b[3]=m):m=b[3];b[4]!==f||b[5]!==g||b[6]!==e?(m=j.jsx(c("CometPlaceholder.react"),{fallback:m,children:j.jsx(k,{initialCommentsQuery:f,postId:g,children:e})}),b[4]=f,b[5]=g,b[6]=e,b[7]=m):m=b[7];b[8]!==a||b[9]!==m?(f=j.jsx(c("CometErrorBoundary.react"),{fallback:l,onError:a,children:m}),b[8]=a,b[9]=m,b[10]=f):f=b[10];return f}function l(){return null}g["default"]=a}),98);
__d("PolarisPostComments.react",["PolarisDeleteCommentModal.react","PolarisPostRemoveCommentsSelectors","PolarisPostVariants","PolarisPreviewComments.react","PolarisReactRedux.react","PolarisThreadedComments.react","PolarisThreadedCommentsLoader.react","PolarisUA","nullthrows","polarisUserSelectors","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={commentToDeleteId:null,showDeleteCommentModal:!1},c.$1=function(a){c.setState({commentToDeleteId:a,showDeleteCommentModal:!0})},c.$2=function(){c.setState({commentToDeleteId:null,showDeleteCommentModal:!1})},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.$3=function(){return this.props.variant!==d("PolarisPostVariants").VARIANTS.feed&&!d("PolarisUA").isMobile()};e.render=function(){var a=this.props,b=a.analyticsContext,d=a.caption,e=a.captionCreatedAt,f=a.captionIsEdited,g=a.className,h=a.code,j=a.commentingDisabledForViewer,k=a.commentsAreStacked,l=a.commentsDisabled,m=a.customIndentationPadding,n=a.hasRankedComments,o=a.hideUserAvatar,p=a.id,q=a.initialCommentsQuery,r=a.mediaType,s=a.onLikeCountClick,t=a.ownerId,u=a.permalinkedCommentId,v=a.permalinkedReplyId,w=a.postedAt,x=a.reducedAvatarMargin,y=a.showCommentOptionsInline,z=a.showRemoveCommentIcons,A=a.variant;a=a.viewerId;a=a!=null;this.$3()?(e=i.jsx(c("PolarisThreadedComments.react"),{analyticsContext:b,captionAndTitle:d,captionCreatedAt:e,captionIsEdited:f,className:g,code:h,commentingDisabledForViewer:j,commentsDisabled:l,customIndentationPadding:m,handleDeleteCommentClick:this.$1,hasRankedComments:n,hideUserAvatar:!!o,id:p,isDeletingComments:z,loggedIn:a,mediaType:r,onLikeCountClick:s,ownerId:t,permalinkedCommentId:u,permalinkedReplyId:v,postedAt:w,reducedAvatarMargin:x,showCommentOptionsInline:y}),q!=null&&(e=i.jsx(c("PolarisThreadedCommentsLoader.react"),{initialCommentsQuery:q,postId:p,children:e}))):e=i.jsx(c("PolarisPreviewComments.react"),{captionAndTitle:d,captionIsEdited:f,className:g,code:h,commentsAreStacked:k,commentsDisabled:l,handleDeleteCommentClick:this.$1,id:p,loggedIn:a,mediaType:r,ownerId:t,postedAt:w,showRemoveCommentIcons:z,variant:A});return i.jsxs(i.Fragment,{children:[e,this.state.showDeleteCommentModal&&i.jsx(c("PolarisDeleteCommentModal.react"),{analyticsContext:b,commentId:c("nullthrows")(this.state.commentToDeleteId),onClose:this.$2,postId:p})]})};return b}(i.PureComponent);b.defaultProps={variant:d("PolarisPostVariants").VARIANTS.flexible};function a(a){return{showRemoveCommentIcons:d("PolarisPostRemoveCommentsSelectors").getPostRemoveCommentsIsVisible(a),viewerId:(a=d("polarisUserSelectors").getViewer__DEPRECATED(a))==null?void 0:a.id}}e=d("PolarisReactRedux.react").connect(a)(b);g["default"]=e}),98);
__d("PolarisPostFastPreviewCaption.react",["IGDSBox.react","PolarisPostFastCommentPrimitive.react","PolarisPostFastCrawlerComment.react","PolarisUA","nullthrows","polarisCommentSelectors.react","react","usePolarisIsOnFeedPage","usePolarisPost"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(10),e=a.enableTruncation,f=a.inModal;a=a.postId;var g=c("usePolarisIsOnFeedPage")();g=g&&f!==!0&&d("PolarisUA").isDesktop();f=d("usePolarisPost").usePostAndOwner(a,p);var h=d("usePolarisPost").usePostAndOwner(a,o),q=d("usePolarisPost").usePostAndOwner(a,n),r=d("usePolarisPost").usePostAndOwner(a,m),s=d("usePolarisPost").usePost(a,l);a=d("usePolarisPost").usePost(a,k);a=d("polarisCommentSelectors.react").useCommentTranslation(a);if(s==null||s==="")return null;(a==null?void 0:a.showTranslatedText)===!0&&a.translatedText!=null&&(s=a.translatedText);a=g?2:1;b[0]!==e||b[1]!==r||b[2]!==q||b[3]!==s||b[4]!==f||b[5]!==h?(g=e===!0?j.jsx(c("PolarisPostFastCrawlerComment.react"),{isAuthorUnpublished:r,isAuthorVerified:q,text:s,userId:f,username:h}):j.jsx(c("PolarisPostFastCommentPrimitive.react"),{isAuthorUnpublished:r,isAuthorVerified:q,isCaption:!0,text:s,userId:f,username:h}),b[0]=e,b[1]=r,b[2]=q,b[3]=s,b[4]=f,b[5]=h,b[6]=g):g=b[6];b[7]!==a||b[8]!==g?(e=j.jsx(c("IGDSBox.react"),{marginBottom:a,position:"relative",children:g}),b[7]=a,b[8]=g,b[9]=e):e=b[9];return e}function k(a){return a.captionCommentId}function l(a){return a.caption}function m(a,b){return b.isUnpublished}function n(a,b){return b.isVerified}function o(a,b){return c("nullthrows")(b.username)}function p(a,b){return c("nullthrows")(b.id)}g["default"]=a}),98);
__d("PolarisPostFastCommentLikeButton.react",["PolarisCommentActions","PolarisConfig","PolarisInteractionsLogger","PolarisLikeButton.react","PolarisReactRedux.react","react","usePolarisAnalyticsContext","usePolarisComment","usePolarisPost"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a,b){var e=i(8),f=d("usePolarisComment").useComment(a,m),g=d("usePolarisPost").usePost(b,d("PolarisInteractionsLogger").getMediaTypeFromPost),h=d("usePolarisPost").usePostAndOwner(b,l),j=c("usePolarisAnalyticsContext")();if(e[0]===Symbol["for"]("react.memo_cache_sentinel")){var k;k=(k=d("PolarisConfig").getViewerId())!=null?k:"";e[0]=k}else k=e[0];e[1]!==f||e[2]!==a||e[3]!==j||e[4]!==h||e[5]!==b||e[6]!==g?(k={commentAuthorId:f,commentId:a,containerModule:j,mediaAuthorId:h,mediaId:b,mediaType:g,userId:k},e[1]=f,e[2]=a,e[3]=j,e[4]=h,e[5]=b,e[6]=g,e[7]=k):k=e[7];return k}function l(a,b){return b.id}function m(a){return a.id}function a(a){var b=i(7),e=a.color,f=a.commentId;a=a.postId;var g=d("PolarisReactRedux.react").useDispatch(),h=k(f,a);a=d("usePolarisComment").useComment(f,n);b[0]!==g||b[1]!==h?(f=function(a){a?g(d("PolarisCommentActions").likeComment(h)):g(d("PolarisCommentActions").unlikeComment(h))},b[0]=g,b[1]=h,b[2]=f):f=b[2];f=f;var l;b[3]!==e||b[4]!==a||b[5]!==f?(l=j.jsx(c("PolarisLikeButton.react"),{color:e,isLiked:a,onChange:f,padding:0,size:12}),b[3]=e,b[4]=a,b[5]=f,b[6]=l):l=b[6];return l}function n(a){return a.likedByViewer}b=j.memo(a);g["default"]=b}),98);
__d("PolarisPostFastPreviewComment.react",["PolarisPostFastCommentPrimitive.react","nullthrows","react","usePolarisComment"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b,e=i(5);a=a.commentId;var f=(b=d("usePolarisComment")).useCommentAndOwner(a,n),g=b.useCommentAndOwner(a,m),h=b.useComment(a,l);b=b.useComment(a,k);e[0]!==b||e[1]!==h||e[2]!==f||e[3]!==g?(a=j.jsx(c("PolarisPostFastCommentPrimitive.react"),{isAuthorVerified:b,text:h,userId:f,username:g}),e[0]=b,e[1]=h,e[2]=f,e[3]=g,e[4]=a):a=e[4];return a}function k(a){return a.isAuthorVerified}function l(a){return a.text}function m(a,b){return c("nullthrows")(b.username)}function n(a,b){return c("nullthrows")(b.id)}g["default"]=a}),98);
__d("PolarisPostFastViewAllComments.react",["fbt","IGDSText.react","PolarisBigNumber.react","PolarisConfig","PolarisFastLink.react","PolarisFeedActionOpenPostModalForId","PolarisInFeedPostModalContext","PolarisInteractionsLogger","PolarisLoggedOutCtaLogger","PolarisNavigationActions","PolarisReactRedux.react","PolarisSponsoredPostContext.react","PolarisTrackingConstants","PolarisUA","XPolarisMobileAllCommentsControllerRouteBuilder","logPolarisPostModalOpen","nullthrows","react","react-forget-runtime","usePolarisAnalyticsContext","usePolarisPost"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));e=i;e.useCallback;var k=e.useContext,l=e.c;function a(a){var b=l(21),e=a.onLoggedOutIntentClickLoginModal,f=a.postId;a=d("usePolarisPost").usePost(f,o);var g=d("usePolarisPost").usePost(f,n),i=d("usePolarisPost").usePost(f,d("PolarisInteractionsLogger").getMediaTypeFromPost),p=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,m),q=p.canUserSeePersistentCta;b[0]!==q?(p=function(a){var b;return c("XPolarisMobileAllCommentsControllerRouteBuilder").buildURL((b={},b[d("PolarisTrackingConstants").ENABLE_PERSISTENT_CTA]=q||void 0,b.shortcode=c("nullthrows")(a.code),b))},b[0]=q,b[1]=p):p=b[1];var r=d("usePolarisPost").usePost(f,p),s=d("PolarisReactRedux.react").useDispatch(),t=c("usePolarisAnalyticsContext")(),u=k(d("PolarisInFeedPostModalContext").InFeedPostModalContext);b[2]===Symbol["for"]("react.memo_cache_sentinel")?(p=!d("PolarisConfig").isLoggedIn()&&d("PolarisUA").isMobile(),b[2]=p):p=b[2];var v=p;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(p=v||d("PolarisConfig").isLoggedIn()&&d("PolarisUA").isDesktop(),b[3]=p):p=b[3];p=p;var w;b[4]!==t||b[5]!==g||b[6]!==f||b[7]!==i||b[8]!==s||b[9]!==u||b[10]!==e?(w=function(a,b){d("PolarisConfig").isLoggedIn()?(d("PolarisInteractionsLogger").logInteractionAction({containerModule:t,eventName:"instagram_organic_comment_view_all",mediaAuthorId:g,mediaId:f,mediaType:i}),d("PolarisUA").isDesktop()&&(a.preventDefault(),s(d("PolarisFeedActionOpenPostModalForId").openPostModalForId(f)),c("logPolarisPostModalOpen")(t,i,"feed_view_all_comments"),u(f))):v&&(a.preventDefault(),d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"user_action",ctaVersion:"",eventName:"post_comment_view_all_click",module:t||""}),e(b,"post_comment_view_all",f))},b[4]=t,b[5]=g,b[6]=f,b[7]=i,b[8]=s,b[9]=u,b[10]=e,b[11]=w):w=b[11];var x=w;b[12]!==x||b[13]!==r?(w=function(a){return x(a,r)},b[12]=x,b[13]=r,b[14]=w):w=b[14];var y;b[15]!==a?(y=j.jsx(c("IGDSText.react"),{color:"secondaryText",zeroMargin:!0,children:a===1?h._("__JHASH__72aa16zdD4E__JHASH__"):h._("__JHASH__goQVaKpz6ee__JHASH__",[h._param("count",j.jsx(c("PolarisBigNumber.react"),{value:a}))])}),b[15]=a,b[16]=y):y=b[16];b[17]!==r||b[18]!==w||b[19]!==y?(a=j.jsx(c("PolarisFastLink.react"),{"data-testid":void 0,href:r,onClick:w,shouldOpenModal:p,children:y}),b[17]=r,b[18]=w,b[19]=y,b[20]=a):a=b[20];return a}function m(a){return[a.canUserSeePersistentCta]}function n(a){return c("nullthrows")((a=a.owner)==null?void 0:a.id)}function o(a){return a.numComments||0}function b(a){return{onLoggedOutIntentClickLoginModal:function(b,c,e){var f=d("PolarisUA").isDesktop()||d("PolarisConfig").isLoggedOutFRXEligible()?"feature_wall":"content_wall";a(d("PolarisNavigationActions").openLoginModal(f,b,c,null,e))}}}f=d("PolarisReactRedux.react").connect(null,b)(a);g["default"]=f}),226);
__d("PolarisPostFastPreviewCommentsList.react",["IGDSBox.react","PolarisConfig","PolarisPostFastCommentLikeButton.react","PolarisPostFastPreviewComment.react","PolarisPostFastViewAllComments.react","PolarisReactRedux.react","PolarisThreadedCommentSelectors","PolarisUA","isTruthy","polarisCommentSelectors.react","react","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage","usePolarisPost"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useMemo,k=b.c;function l(a){var b=k(13),e=a.postId;a=a.previewCommentIds;var f=c("usePolarisIsOnFeedPage")(),g=c("usePolarisIsOnAdsActivityPage")(),h;b[0]!==f||b[1]!==g?(h=(f||g)&&d("PolarisUA").isDesktop(),b[0]=f,b[1]=g,b[2]=h):h=b[2];f=h;var j=f;if(d("PolarisConfig").isLoggedOutFRXEligible())return null;if(a.length>0){g=f?1:0;if(b[3]!==j||b[4]!==e||b[5]!==a){b[7]!==j||b[8]!==e?(h=function(a){return i.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",marginBottom:1,position:"relative",children:[i.jsx(c("PolarisPostFastPreviewComment.react"),{commentId:a}),d("PolarisConfig").isLoggedIn()&&i.jsx(c("IGDSBox.react"),{marginStart:j?2:0,position:"relative",children:i.jsx(c("PolarisPostFastCommentLikeButton.react"),{color:j?"ig-secondary-icon":void 0,commentId:a,postId:e})})]},a)},b[7]=j,b[8]=e,b[9]=h):h=b[9];f=a.map(h);b[3]=j;b[4]=e;b[5]=a;b[6]=f}else f=b[6];b[10]!==g||b[11]!==f?(h=i.jsx(c("IGDSBox.react"),{marginBottom:g,position:"relative",children:f}),b[10]=g,b[11]=f,b[12]=h):h=b[12];return h}return null}function a(a){var b=a.inModal,e=a.postId;a=a.shouldIncreaseCommentPreviews;a=a===void 0?!1:a;var f=c("usePolarisIsOnFeedPage")();f=f&&b!==!0&&d("PolarisUA").isDesktop();var g=c("isTruthy")(a);b=d("usePolarisPost").usePost(e,function(a){return!a.commentsDisabled});var h=d("PolarisReactRedux.react").useSelector(function(a){return g?d("PolarisThreadedCommentSelectors").selectVisibleParentCommentsForPostId(a,e).toArray():d("polarisCommentSelectors.react").getPreviewCommentsForPostId(a,e)});a=j(function(){return h.map(function(a){return a.id})},[h]);var k=d("usePolarisPost").usePost(e,function(a){return(a=a.numComments)!=null?a:0}),m=k>a.length;if(!b||k<=0)return null;b=!d("PolarisConfig").isLoggedIn()&&a.length>0&&!g;return i.jsxs(i.Fragment,{children:[m&&i.jsx(c("IGDSBox.react"),{alignItems:"start",marginBottom:f?2:1,position:"relative",children:i.jsx(c("PolarisPostFastViewAllComments.react"),{postId:e})}),i.jsx(l,{postId:e,previewCommentIds:b?a.slice(-1):a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PolarisPostPreviewCommentsPicker.react",["CometPlaceholder.react","IGDSBox.react","IGDSSpinner.react","PolarisPostCaptionTranslationPrompt.react","PolarisPostComments.react","PolarisPostFastPreviewCaption.react","PolarisPostFastPreviewCommentsList.react","PolarisPostVariants","PolarisUA","react","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage","xigRequireInterop"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var e=i(33),f=c("usePolarisIsOnFeedPage")(),g=c("usePolarisIsOnAdsActivityPage")(),h;e[0]!==f||e[1]!==g?(h=(f||g)&&d("PolarisUA").isDesktop(),e[0]=f,e[1]=g,e[2]=h):h=e[2];f=h;g=a.variant!==d("PolarisPostVariants").VARIANTS.feed&&!d("PolarisUA").isMobile();if(g){e[3]===Symbol["for"]("react.memo_cache_sentinel")?(h=j.jsx(c("IGDSSpinner.react"),{position:"absolute"}),e[3]=h):h=e[3];e[4]!==a.className?(g=j.jsx("div",{className:a.className,children:h}),e[4]=a.className,e[5]=g):g=e[5];e[6]!==a?(h=j.jsx(c("PolarisPostComments.react"),babelHelpers["extends"]({},a)),e[6]=a,e[7]=h):h=e[7];var k;e[8]!==g||e[9]!==h?(k=j.jsx(c("CometPlaceholder.react"),{fallback:g,children:h}),e[8]=g,e[9]=h,e[10]=k):k=e[10];return k}e[11]===Symbol["for"]("react.memo_cache_sentinel")?(g=c("xigRequireInterop")(b("PolarisPostFastPreviewCommentsList.react")),e[11]=g):g=e[11];h=g["default"];e[12]===Symbol["for"]("react.memo_cache_sentinel")?(k=c("xigRequireInterop")(b("PolarisPostFastPreviewCaption.react")),e[12]=k):k=e[12];g=k["default"];e[13]!==g||e[14]!==a.enableTruncation||e[15]!==a.inModal||e[16]!==a.id?(k=j.jsx(g,{enableTruncation:a.enableTruncation,inModal:a.inModal,postId:a.id}),e[13]=g,e[14]=a.enableTruncation,e[15]=a.inModal,e[16]=a.id,e[17]=k):k=e[17];e[18]!==f||e[19]!==a?(g=f&&j.jsx(c("PolarisPostCaptionTranslationPrompt.react"),{inFeed:!0,marginBottom:2,postId:a.id}),e[18]=f,e[19]=a,e[20]=g):g=e[20];e[21]!==h||e[22]!==a.inModal||e[23]!==a.id||e[24]!==a.shouldIncreaseCommentPreviews?(f=j.jsx(h,{inModal:a.inModal,postId:a.id,shouldIncreaseCommentPreviews:a.shouldIncreaseCommentPreviews}),e[21]=h,e[22]=a.inModal,e[23]=a.id,e[24]=a.shouldIncreaseCommentPreviews,e[25]=f):f=e[25];e[26]!==k||e[27]!==g||e[28]!==f?(h=j.jsxs(c("IGDSBox.react"),{position:"relative",children:[k,g,f]}),e[26]=k,e[27]=g,e[28]=f,e[29]=h):h=e[29];e[30]!==a.className||e[31]!==h?(k=j.jsx("div",{className:a.className,children:h}),e[30]=a.className,e[31]=h,e[32]=k):k=e[32];return k}g["default"]=a}),98);
__d("PolarisPostLikers.react",["IGDSBox.react","IGDSText.react","IGRouter_DO_NOT_USE.react","PolarisConfig","PolarisFacepile.next.react","PolarisLikedByListActions","PolarisLikedByListButton.react","PolarisLikedByText.react","PolarisLinkBuilder","PolarisNavigationActions","PolarisPostUtils","PolarisReactRedux.react","PolarisUA","polarisLogAction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");b=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.$2=function(){c.props.onLike()};c.$3=function(a){c.$1(),!c.props.viewer&&c.props.inModal!==!0?(a.preventDefault(),c.props.onGoToLoginModal(c.props.code)):d("PolarisUA").isDesktop()&&(a.preventDefault(),c.props.onViewLikedByList(c.props.mediaId),c.props.onLikeCountClick(a))};return c}var e=b.prototype;e.$1=function(){c("polarisLogAction")("likeCountClick")};e.render=function(){var a=d("PolarisPostUtils").getOrderedUsersForLikedByList(this.props.users,this.props.viewer).map(function(a){return a.profilePictureUrl}).filter(Boolean),b=i.jsx(c("PolarisFacepile.next.react"),{avatarSize:this.props.avatarSize,border:"transparent",userProfilePicUrls:a}),e=!!this.props.viewer;return i.jsxs(c("IGDSBox.react"),{direction:"row",flex:"grow",position:"relative",children:[a.length>0&&e===!0&&i.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"column",justifyContent:"start",marginEnd:1,position:"relative",children:i.jsx(c("PolarisLikedByListButton.react"),{code:this.props.code,inModal:this.props.inModal,onClick:this.$3,children:b})}),i.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"column",flex:"grow",margin:"auto",position:"relative",wrap:!0,children:i.jsx(c("IGDSText.react"),{zeroMargin:!0,children:i.jsx(c("PolarisLikedByText.react"),{code:this.props.code,hideCounts:this.props.hideCounts,inModal:!!this.props.inModal,onClick:this.$3,onLike:this.$2,topLikers:this.props.topLikers,totalCount:this.props.totalCount,users:this.props.users})})})]})};return b}(i.Component);function a(a){return{onGoToLoginModal:function(b){b=d("PolarisLinkBuilder").buildMediaLink(b);a(d("PolarisNavigationActions").openLoginModal("content_wall",b,null,null,b));return},onLoggedOutIntentClickLoginModal:function(b,c){var e=d("PolarisUA").isDesktop()||d("PolarisConfig").isLoggedOutFRXEligible()?"feature_wall":"content_wall";a(d("PolarisNavigationActions").openLoginModal(e,b,c,null,b))},onViewLikedByList:function(b){return a(d("PolarisLikedByListActions").requestNativeLikedByList(b))}}}e=d("IGRouter_DO_NOT_USE.react").withIGRouter(d("PolarisReactRedux.react").connect(null,a)(b));g["default"]=e}),98);
__d("PolarisPostSocialProof.react",["PolarisPostLikers.react","PolarisPostVariants","PolarisPostViews.react","PolarisShouldHideLikeCountsWithControls","PolarisUA","nullthrows","polarisGetPostFromGraphMediaInterface","react","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(28),e=a.analyticsContext,f=a.canLike,g=a.className,h=a.code,k=a.containerRef,l=a.inModal,m=a.likeAndViewCountsDisabled,n=a.likedByViewer,o=a.likers,p=a.mediaId,q=a.numPreviewLikes,r=a.onLikeChange,s=a.onLikeCountClick,t=a.productType,u=a.topLikers,v=a.variant,w=a.videoViews,x=a.viewer;a=a.viewerIsOwner;var y=w!=null&&w>0,z=q!==0,A=c("usePolarisIsOnFeedPage")(),B=c("usePolarisIsOnAdsActivityPage")();v===d("PolarisPostVariants").VARIANTS.feed?v=z||y:v=z||y||f;z=x==null?void 0:x.hideLikeAndViewCounts;b[0]!==z||b[1]!==m||b[2]!==a?(f=d("PolarisShouldHideLikeCountsWithControls").shouldHideLikeCountsWithControls(z,m,a),b[0]=z,b[1]=m,b[2]=a,b[3]=f):f=b[3];z=f;m=y&&!z&&!d("polarisGetPostFromGraphMediaInterface").isClipsProductType(t);if(!v)return null;b[4]!==A||b[5]!==B||b[6]!==l?(a=(A||B)&&l!==!0&&d("PolarisUA").isDesktop(),b[4]=A,b[5]=B,b[6]=l,b[7]=a):a=b[7];f=a;b[8]!==m||b[9]!==w||b[10]!==e||b[11]!==q||b[12]!==f||b[13]!==l||b[14]!==r||b[15]!==h||b[16]!==z||b[17]!==n||b[18]!==p||b[19]!==s||b[20]!==u||b[21]!==o||b[22]!==x?(y=m?j.jsx(c("PolarisPostViews.react"),{analyticsContext:e,likeCount:q,viewCount:c("nullthrows")(w)}):j.jsx(c("PolarisPostLikers.react"),{avatarSize:f?"micro":void 0,code:h,hideCounts:z,inModal:!!l,likedByViewer:n,mediaId:p,onLike:function(){r(!0,"beTheFirstPrompt")},onLikeCountClick:s,topLikers:u,totalCount:q,users:o,viewer:x}),b[8]=m,b[9]=w,b[10]=e,b[11]=q,b[12]=f,b[13]=l,b[14]=r,b[15]=h,b[16]=z,b[17]=n,b[18]=p,b[19]=s,b[20]=u,b[21]=o,b[22]=x,b[23]=y):y=b[23];b[24]!==g||b[25]!==k||b[26]!==y?(t=j.jsx("section",{className:g,ref:k,children:y}),b[24]=g,b[25]=k,b[26]=y,b[27]=t):t=b[27];return t}g["default"]=a}),98);
__d("PolarisPostDetailsSection.react",["IGDSBox.react","IGDSText.react","PolarisCommentLikedByListContainerLazy.react","PolarisConfig","PolarisFeedPageConstants","PolarisGenericStrings","PolarisHotKeys.react","PolarisInteractionsLogger","PolarisLikedByListContainerLazy.react","PolarisLikedByListVariant","PolarisLinkBuilder","PolarisPendingCommentState","PolarisPoliticalContextButton.react","PolarisPostCaptionTranslationPrompt.react","PolarisPostCommentInputPicker.react","PolarisPostConstants","PolarisPostFeatures.react","PolarisPostFeedbackControls_DEPRECATED.react","PolarisPostFooter.react","PolarisPostModalRenderingContext.react","PolarisPostPreviewCommentsPicker.react","PolarisPostSocialProof.react","PolarisPostTimestamp.react","PolarisPostVariants","PolarisReactRedux.react","PolarisUA","isStringNullOrEmpty","nullthrows","polarisAdsSelectors.react","react","stylex","usePolarisDisplayProperties","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,aa=b.useRef,l=b.useState,ba=b.c,m={commentingDisabledForViewerBox:{alignItems:"x6s0dn4",borderTopColor:"x1xp8e9x",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",display:"x78zum5",height:"x1dnml7z",justifyContent:"xl56j7k",marginTop:"x1gslohp",order:"x1hrcb2b",$$css:!0},commentingDisabledForViewerBoxFamiliarFeed:{borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",height:"xxeg0ib",$$css:!0},commentingDisabledForViewerBoxV2:{marginTop:"xdj266r",$$css:!0},commentInput:{paddingBottom:"x10b6aqq",paddingTop:"x1yrsyyn",$$css:!0},commentInputAsSidebar:{order:"x1hrcb2b",$$css:!0},commentInputHidden:{display:"x1s85apg",minHeight:"x1wxaq2x",$$css:!0},commentInputStatic:{paddingEnd:"x1pi30zi",$$css:!0},commentInputV2:{paddingBottom:"xjkvuk6",paddingTop:"x1iorvi4",$$css:!0},commentInputV2WithRichComments:{paddingEnd:"xn6708d",paddingStart:"x1ye3gou",$$css:!0},comments:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",minHeight:"x2lwn1j",overflowX:"xw2csxc",overflowY:"x1odjw0f",position:"x1n2onr6",$$css:!0},commentsAsSidebar:{marginTop:"xdj266r",marginEnd:"x1kncehz",marginBottom:"xat24cr",marginStart:"x10ndw75",order:"x9ek82g",overflowX:"x6ikm8r",$$css:!0},commentsMarginBottom:{marginBottom:"x12nagc",$$css:!0},commentsMarginBottomDense:{marginBottom:"xat24cr",$$css:!0},commentsV2:{marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"x4ii5y1",marginStart:"x1mh8g0r",paddingTop:"xexx8yu",paddingEnd:"xn6708d",paddingBottom:"x18d9i69",paddingStart:"x1ye3gou",$$css:!0},commentsWithRichComments:{marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"x4ii5y1",marginStart:"x1mh8g0r",paddingTop:"xexx8yu",paddingEnd:"x1pi30zi",paddingBottom:"x18d9i69",paddingStart:"x1swvt13",$$css:!0},expandedSidebarContainerResponsive:{borderTopStartRadius:"x168nmei",borderTopEndRadius:"x1yr5g0i",borderBottomEndRadius:"xrt01vj",borderBottomStartRadius:"xo71vjh",$$css:!0},feedback:{marginTop:"x1gslohp",paddingBottom:"xwib8y2",paddingTop:"x1yrsyyn",$$css:!0},feedbackAsSidebar:{borderTopColor:"x1xp8e9x",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"xat24cr",marginStart:"x1mh8g0r",order:"xo1ph6p",$$css:!0},feedbackV2:{paddingBottom:"x10b6aqq",paddingTop:"xexx8yu",$$css:!0},feedbackV2WithRichComments:{paddingEnd:"xn6708d",paddingStart:"x1ye3gou",$$css:!0},feedbackWithRichComments:{paddingEnd:"x1pi30zi",paddingStart:"x1swvt13",$$css:!0},mediaInfo:{boxSizing:"x9f619",display:"x78zum5",flexDirection:"xdt5ytf",minWidth:"x1q2y9iw",paddingTop:"xexx8yu",paddingEnd:"x1pi30zi",paddingBottom:"x18d9i69",paddingStart:"x1swvt13",position:"x1n2onr6",width:"xh8yej3",$$css:!0},mediaInfoAsSidebar:{boxSizing:"x9f619",flexGrow:"x1iyjqo2",paddingEnd:"xxbr6pl",paddingStart:"xbbxn1n",$$css:!0},mediaInfoFamiliarFeed:{borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",$$css:!0},mediaInfoWithRichComments:{borderStartColor:"x18l3tf1",borderStartStyle:"x26u7qi",borderStartWidth:"xy80clv",paddingTop:"xexx8yu",paddingEnd:"x4uap5",paddingBottom:"x18d9i69",paddingStart:"xkhd6sd",$$css:!0},msite:{borderBottomColor:"xh05dso",borderBottomStyle:"x1q0q8m5",borderBottomWidth:"xso031l",$$css:!0},politicalContext:{marginBottom:"x1e56ztr",$$css:!0},politicalContextV2:{paddingEnd:"xn6708d",paddingStart:"x1ye3gou",$$css:!0},politicalContextWithRichComments:{paddingEnd:"x1pi30zi",paddingStart:"x1swvt13",$$css:!0},responsiveViewInsights:{marginStart:"x169t7cy",width:"x1j7kr1c",$$css:!0},roundedSidebarContainer:{borderTopStartRadius:"x168nmei",borderTopEndRadius:"x13lgxp2",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",$$css:!0},sectionWithNoPadding:{overflowX:"x1plvlek",overflowY:"xryxfnj",paddingEnd:"x4uap5",paddingStart:"xkhd6sd",$$css:!0},sidebarContainer:{display:"x78zum5",flexDirection:"xdt5ytf",pointerEvents:"x67bb7w",position:"x1n2onr6",$$css:!0},sidebarContainerAsSidebar:{backgroundColor:"xvbhtw8",height:"x5yr21d",width:"x4h1yfo",$$css:!0},sidebarContainerFeedRoot:{backgroundColor:"xvbhtw8",$$css:!0},sidebarContainerInModal:{backgroundColor:"xvbhtw8",height:"x5yr21d",$$css:!0},sidebarContainerV2:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",$$css:!0},socialProof:{marginBottom:"x1e56ztr",$$css:!0},socialProofAsSidebar:{marginBottom:"x12nagc",order:"x182iqb8",$$css:!0},socialProofV2:{paddingEnd:"xn6708d",paddingStart:"x1ye3gou",$$css:!0},socialProofWithRichComments:{paddingEnd:"x1pi30zi",paddingStart:"x1swvt13",$$css:!0},timestamp:{marginBottom:"x1yztbdb",$$css:!0},timestampAsSidebar:{order:"x1h3rv7z",$$css:!0},timestampDense:{marginBottom:"x1e56ztr",$$css:!0},timestampV2:{paddingStart:"x1ye3gou",$$css:!0},timestampWithRichComments:{paddingStart:"x1swvt13",$$css:!0},viewInsights:{borderBottomStyle:"x1sy0etr",borderTopColor:"x1xp8e9x",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",order:"x14yy4lh",$$css:!0},viewInsightsWithStackedCommentsSidecar:{marginBottom:"x1hyhr7",marginTop:"x1gde2r1",$$css:!0}};function a(a){var b=ba(81),e=a.analyticsContext,f=a.bloksAppId,g=a.currSidecarIndex,i=a.currSidecarItem,n=a.enableTruncation,o=a.handleLikeChange,p=a.handleSaveChange,q=a.hasDenserFeedRedesign,r=a.hasSidebarInRedesign,s=a.hasViewInsights,t=a.initialCommentsQuery,u=a.owner,v=a.permalinkedCommentId,w=a.permalinkedReplyId,x=a.post,y=a.postAuthorId,z=a.postAuthorUsername,A=a.postFeedbackControlsRef,B=a.postHeader,C=a.redesignWithoutSidebar,D=a.redesignWithSidebar,E=a.shouldIncreaseCommentPreviews,F=a.showDetailsAsSidebar,G=a.variant,H=a.viewer,I=!d("PolarisUA").isDesktop();a=l(null);var J=a[0],K=a[1];a=l(!1);var da=a[0],ea=a[1];a=l(!1);var fa=a[0],ga=a[1];a=c("usePolarisDisplayProperties")();var ha=a.viewportWidth,ia=aa(null);b[0]!==x.commentsDisabled||b[1]!==x.commentingDisabledForViewer||b[2]!==fa||b[3]!==ha?(a=function(){return x.commentsDisabled!==!0&&x.commentingDisabledForViewer!==!0&&(fa||ha>=d("PolarisPostConstants").SIDEBAR_VARIANT_CUTOFF)},b[0]=x.commentsDisabled,b[1]=x.commentingDisabledForViewer,b[2]=fa,b[3]=ha,b[4]=a):a=b[4];var L=a;b[5]!==x.id?(a=function(a){return(a=a.pendingComments[x.id])!=null?a:d("PolarisPendingCommentState").EMPTY_PENDING_COMMENT},b[5]=x.id,b[6]=a):a=b[6];a=d("PolarisReactRedux.react").useSelector(a);var M=a.committing,N=c("usePrevious")(M);a=d("PolarisPostModalRenderingContext.react").usePolarisPostModalRenderingContext();var O=a.isInModal;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){ga(!0),ia.current&&ia.current.focusAndScroll()},b[7]=a):a=b[7];var ja=a;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){ea(!1)},b[8]=a):a=b[8];var ka=a;b[9]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(a){ea(!0)},b[9]=a):a=b[9];var la=a;b[10]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){K(null)},b[10]=a):a=b[10];var ma=a;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(a){K(a)},b[11]=a):a=b[11];var na=a;b[12]!==H||b[13]!==x?(a=H?{c:function(){x.commentsDisabled!==!0&&ja()}}:{},b[12]=H,b[13]=x,b[14]=a):a=b[14];a=a;var P=c("usePrevious")(x),Q,R;b[15]!==P||b[16]!==x?(Q=function(){P!=null&&x!=null&&P!==x&&(K(null),ea(!1))},R=[x,P],b[15]=P,b[16]=x,b[17]=Q,b[18]=R):(Q=b[17],R=b[18]);k(Q,R);b[19]!==N||b[20]!==M?(Q=function(){N===!0&&M===!1&&ga(!1)},R=[M,N],b[19]=N,b[20]=M,b[21]=Q,b[22]=R):(Q=b[21],R=b[22]);k(Q,R);b[23]!==u||b[24]!==x||b[25]!==G?(Q={owner:u,post:x,variant:G},b[23]=u,b[24]=x,b[25]=G,b[26]=Q):Q=b[26];R=d("PolarisPostFeatures.react").usePolarisPostFeatures(Q);var S=R.canViewerProvideFeedback,T=R.commentsAreStacked,U=R.hasThreadedSidebarComments,V=R.isBlocked,oa=R.isLoggedIn,W=R.isSidecar,pa=R.isStackedScreenSize,qa=R.showPostButton,X=d("polarisAdsSelectors.react").useFeedAdInfo(x==null?void 0:x.id,ca),Y=X==null?void 0:(Q=X.political_context)==null?void 0:Q.byline_text;R=c("usePolarisIsOnFeedPage")();Q=c("usePolarisIsOnAdsActivityPage")();var Z;b[27]!==R||b[28]!==Q||b[29]!==O?(Z=(R||Q)&&O!==!0&&d("PolarisUA").isDesktop(),b[27]=R,b[28]=Q,b[29]=O,b[30]=Z):Z=b[30];R=Z;var $=R;Q=D?"grow":"none";b[31]!==G||b[32]!==F||b[33]!==O||b[34]!==q||b[35]!==C||b[36]!==D||b[37]!==r||b[38]!==T||b[39]!==B||b[40]!==U||b[41]!==$||b[42]!==e||b[43]!==f||b[44]!==x||b[45]!==W||b[46]!==s||b[47]!==H||b[48]!==S||b[49]!==A||b[50]!==g||b[51]!==V||b[52]!==i||b[53]!==o||b[54]!==p||b[55]!==u||b[56]!==Y||b[57]!==y||b[58]!==n||b[59]!==t||b[60]!==v||b[61]!==w||b[62]!==E||b[63]!==oa||b[64]!==L||b[65]!==X||b[66]!==qa||b[67]!==pa||b[68]!==da||b[69]!==z||b[70]!==J?(Z=function(a,b,k){return j.jsxs("div",{className:(h||(h=c("stylex")))(m.sidebarContainer,G===d("PolarisPostVariants").VARIANTS.feed&&m.sidebarContainerFeedRoot,F&&!O===!0&&m.sidebarContainerAsSidebar,O&&m.sidebarContainerInModal,!O===!0&&q&&m.sidebarContainerV2,C&&m.roundedSidebarContainer,D&&m.expandedSidebarContainerResponsive),onKeyUp:a,role:b,tabIndex:k,children:[(O===!0?r:!T)?B:null,j.jsxs("div",{className:h(m.mediaInfo,F&&m.mediaInfoAsSidebar,U&&m.mediaInfoWithRichComments,$&&m.mediaInfoFamiliarFeed),children:[j.jsx(c("PolarisPostFooter.react"),{analyticsContext:e,bloksAppId:f,boostedStatus:x.boostedStatus,boostUnavailableIdentifier:x.boostUnavailableIdentifier,boostUnavailableReason:x.boostUnavailableReason,className:h(d("PolarisUA").isMobile()?m.msite:m.viewInsights,!r&&m.responsiveViewInsights,T&&W&&m.viewInsightsWithStackedCommentsSidecar),hasViewInsights:s,mediaId:x.id,productType:x.productType,viewerId:H==null?void 0:H.id}),j.jsx(c("PolarisPostFeedbackControls_DEPRECATED.react"),{analyticsContext:e,canViewerProvideFeedback:S,canViewerReshare:x.viewerCanReshare,code:c("nullthrows")(x.code),commentsDisabled:!!x.commentsDisabled,containerRef:A,currSidecarIndex:g,hideShareButton:x.igMediaSharingDisabled===!0,isBlocked:V,isSidecar:W,isVideo:!!x.isVideo,likedByViewer:!!x.likedByViewer,mediaId:i!=null?i.id:x.id,numSteps:(a=x.sidecarChildren)==null?void 0:a.length,onCommentClick:ja,onLikeChange:o,onSaveChange:p,ownerIsPrivate:u.isPrivate,ownerUsername:u.username,postId:x.id,savedByViewer:!!x.savedByViewer,sharingFrictionInfo:i!=null?i.sharingFrictionInfo:x.sharingFrictionInfo,variant:G,xstyle:[m.feedback,q&&m.feedbackV2,q&&U&&m.feedbackV2WithRichComments,F&&m.feedbackAsSidebar,U&&m.feedbackWithRichComments,$&&m.sectionWithNoPadding]}),Y!=null&&j.jsx(c("PolarisPoliticalContextButton.react"),{className:(h||(h=c("stylex")))(m.politicalContext,U&&m.politicalContextWithRichComments,q&&U&&m.politicalContextV2),text:Y}),x.code!=null&&j.jsx(c("PolarisPostSocialProof.react"),{analyticsContext:e,canLike:!V&&S,className:(h||(h=c("stylex")))(m.socialProof,F&&m.socialProofAsSidebar,U&&m.socialProofWithRichComments,q&&U&&m.socialProofV2,$&&m.sectionWithNoPadding),code:c("nullthrows")(x.code),inModal:O,likeAndViewCountsDisabled:x.likeAndViewCountsDisabled,likedByViewer:!!x.likedByViewer,likers:x.likers||[],mediaId:x.id,numPreviewLikes:x.numPreviewLikes||0,onLikeChange:o,onLikeCountClick:la,productType:x.productType,topLikers:x.topLikers,variant:G,videoViews:x.videoViews,viewer:H,viewerIsOwner:y===(H==null?void 0:H.id)}),j.jsx(c("PolarisPostPreviewCommentsPicker.react"),{analyticsContext:e,caption:x.caption,captionCreatedAt:x.captionCreatedAt,captionHasTranslation:x.captionHasTranslation,captionId:x.captionCommentId,captionIsEdited:x.captionIsEdited,className:h(m.comments,!I&&m.commentsMarginBottom,I&&m.commentsMarginBottomDense,F&&m.commentsAsSidebar,U&&m.commentsWithRichComments,q&&U&&m.commentsV2,$&&m.sectionWithNoPadding),code:x.code,commentingDisabledForViewer:(b=x.commentingDisabledForViewer)!=null?b:!1,commentsAreStacked:T,commentsDisabled:x.commentsDisabled,commentsQuery:null,enableTruncation:n,hasRankedComments:x.hasRankedComments===!0,id:x.id,initialCommentsQuery:t,inModal:O,mediaType:d("PolarisInteractionsLogger").getMediaTypeFromPost(x),onLikeCountClick:na,owner:u,ownerId:y,permalinkedCommentId:v,permalinkedReplyId:w,postedAt:c("nullthrows")(x.postedAt),postId:x.id,shouldIncreaseCommentPreviews:E,showCommentOptionsInline:!0,title:x.title,variant:G}),!$&&j.jsx("div",{className:(h||(h=c("stylex")))(!I&&m.timestamp,I&&m.timestampDense,F&&m.timestampAsSidebar,U&&m.timestampWithRichComments,q&&U&&m.timestampV2),children:x.isSponsored===!0?null:j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",position:"relative",children:[j.jsx(c("PolarisPostTimestamp.react"),{code:c("nullthrows")(x.code),isVideo:x.isVideo,mediaLinkBuilder:oa?void 0:d("PolarisLinkBuilder").buildDynamicUsernameMediaLink(u.username),postedAt:c("nullthrows")(x.postedAt)}),e===d("PolarisFeedPageConstants").FEED_PAGE_ANALYTICS_CONTEXT&&j.jsx(c("IGDSBox.react"),{marginStart:2,position:"relative",children:j.jsx(c("PolarisPostCaptionTranslationPrompt.react"),{inFeed:!0,postId:x.id})})]})}),(d("PolarisConfig").isIOS()||L())&&j.jsx(c("PolarisPostCommentInputPicker.react"),{adInfo:X,analyticsContext:e,canViewerProvideFeedback:S,hasPostButton:qa,id:x.id,inModal:O,isRevampVersion:!1,isVideo:x.isVideo,ownerId:u.id,ref:ia,xstyle:[m.commentInput,F&&m.commentInputAsSidebar,q&&m.commentInputV2,q&&U&&m.commentInputV2WithRichComments,!L()&&m.commentInputHidden,!pa&&m.commentInputStatic]},x.id),!L()&&d("PolarisUA").isDesktop()&&x.commentsDisabled!==!0&&x.commentingDisabledForViewer===!0&&j.jsx("div",{className:(h||(h=c("stylex")))(m.commentingDisabledForViewerBox,q&&m.commentingDisabledForViewerBoxV2,$&&m.commentingDisabledForViewerBoxFamiliarFeed),children:j.jsx(c("IGDSText.react"),{color:"tertiaryText",textAlign:"center",children:d("PolarisGenericStrings").COMMENTING_LIMITED})})]}),da&&j.jsx(c("PolarisLikedByListContainerLazy.react"),{display:c("PolarisLikedByListVariant").Modal,isOwnerTheViewer:(H==null?void 0:H.id)===y,likeAndViewCountsDisabled:x.likeAndViewCountsDisabled,likeCount:x.numLikes||0,mediaId:x.id,onClose:ka,ownerUsername:z,productType:(k=x.productType)!=null?k:"",shortcode:c("nullthrows")(x.code),viewCount:x.videoViews}),!c("isStringNullOrEmpty")(J)&&j.jsx(c("PolarisCommentLikedByListContainerLazy.react"),{commentId:J,display:c("PolarisLikedByListVariant").Modal,onClose:ma})]})},b[31]=G,b[32]=F,b[33]=O,b[34]=q,b[35]=C,b[36]=D,b[37]=r,b[38]=T,b[39]=B,b[40]=U,b[41]=$,b[42]=e,b[43]=f,b[44]=x,b[45]=W,b[46]=s,b[47]=H,b[48]=S,b[49]=A,b[50]=g,b[51]=V,b[52]=i,b[53]=o,b[54]=p,b[55]=u,b[56]=Y,b[57]=y,b[58]=n,b[59]=t,b[60]=v,b[61]=w,b[62]=E,b[63]=oa,b[64]=L,b[65]=X,b[66]=qa,b[67]=pa,b[68]=da,b[69]=z,b[70]=J,b[71]=Z):Z=b[71];b[72]!==a||b[73]!==Z?(R=j.jsx(c("PolarisHotKeys.react"),{keyMap:a,children:Z}),b[72]=a,b[73]=Z,b[74]=R):R=b[74];b[75]!==Q||b[76]!==R?(a=j.jsx(c("IGDSBox.react"),{flex:Q,position:"relative",children:R}),b[75]=Q,b[76]=R,b[77]=a):a=b[77];Z=a;if(D){b[78]===Symbol["for"]("react.memo_cache_sentinel")?(Q="x1qjc9v5 x972fbf xcfux6l x1qhh985 xm0m39n x9f619 x78zum5 xdt5ytf x1iyjqo2 x5wqa0o xln7xf2 xk390pu xdj266r x11i5rnm xat24cr x1mh8g0r x65f84u x1vq45kp xexx8yu x4uap5 x18d9i69 xkhd6sd x1n2onr6 x11njtxf",b[78]=Q):Q=b[78];b[79]!==Z?(R=j.jsx("div",{className:Q,children:Z}),b[79]=Z,b[80]=R):R=b[80];return R}return Z}function ca(a){return a}g["default"]=a}),98);
__d("PolarisPostHeaderFavoritedIconButton.react",["IGDSBox.react","IGDSIconButton.react","IGDSStarPanoFilledGradientIcon.react","PolarisFavoritesStrings","PolarisPostModalContext.react","polarisLogAction","react","usePolarisAnalyticsContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(5);a=a.isFavorited;var e=d("PolarisPostModalContext.react").useSetPostModal(),f=c("usePolarisAnalyticsContext")();if(a&&(f==="feedPage"||f==="postPage")){b[0]!==e?(a=function(){c("polarisLogAction")("favoriteIconInPostHeaderClick"),e("favorites")},b[0]=e,b[1]=a):a=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(f=j.jsx(c("IGDSBox.react"),{marginEnd:2,position:"relative",children:j.jsx(c("IGDSStarPanoFilledGradientIcon.react"),{alt:d("PolarisFavoritesStrings").FAVORITED_ICON_ALT,size:16})}),b[2]=f):f=b[2];b[3]!==a?(f=j.jsx(c("IGDSIconButton.react"),{onClick:a,children:f}),b[3]=a,b[4]=f):f=b[4];return f}return null}g["default"]=a}),98);
__d("PolarisPostInvitedCoauthorsOverlayFooterCTA.react",["fbt","IGDSBox.react","IGDSText.react","PolarisConfig","PolarisInvitedCoauthorsCountWithSheet.react","PolarisUserHoverCard.react","PolarisUserLink.react","gkx","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(19),e=a.invitedCoauthorProducers,f=a.mediaId;a=a.user;var g=d("PolarisConfig").getViewerIdOrZero(),i=e!=null;if(!i||(a==null?void 0:a.id)!==g||a==null||(a==null?void 0:a.username)==null)return null;b[0]!==e?(i=e==null?void 0:e.map(m),b[0]=e,b[1]=i):i=b[1];g=i;if(b[2]!==e){i=(a=e)!=null?a:[];b[2]=e;b[3]=i}else i=b[3];b[4]!==i?(a=i.map(l),b[4]=i,b[5]=a):a=b[5];i=a;b[6]!==g?(a=h._("__JHASH__3rTLclQQrhx__JHASH__",[h._param("invited_coauthor_username",g!=null&&g[0])]),b[6]=g,b[7]=a):a=b[7];a=a;var n;b[8]!==g?(n=h._("__JHASH__rDBE8Eo_1-o__JHASH__",[h._param("invited_coauthor_username_1",g!=null&&g[0]),h._param("invited_coauthor_username_2",g!=null&&g[1])]),b[8]=g,b[9]=n):n=b[9];n=n;var o;b[10]!==g||b[11]!==i||b[12]!==f?(o=h._("__JHASH__KlWz6CNCQZP__JHASH__",[h._param("invited_coauthor_username_1",g!=null&&g[0]),h._implicitParam("=m2",k.jsx(c("PolarisInvitedCoauthorsCountWithSheet.react"),{analyticsContext:"post_invited_coauthors_overlay_footer_cta",coauthors:i,mediaId:f,children:h._("__JHASH__H-6onCvv7IF__JHASH__")}))]),b[10]=g,b[11]=i,b[12]=f,b[13]=o):o=b[13];g=o;b[14]!==e||b[15]!==a||b[16]!==n||b[17]!==g?(i=e!=null&&e.length>0&&c("gkx")("4757")?k.jsx(c("IGDSBox.react"),{alignItems:"center",color:"primaryBackground",direction:"row",justifyContent:"between",paddingX:3,paddingY:2,position:"relative",children:k.jsx(c("IGDSBox.react"),{flex:"shrink",marginEnd:5,marginStart:1,maxWidth:350,overflow:"auto",wrap:!0,children:k.jsx(c("IGDSText.react").Body,{color:"primaryText",maxLines:3,zeroMargin:!0,children:e.length===1?a:e.length===2?n:e.length>2?g:null})})}):null,b[14]=e,b[15]=a,b[16]=n,b[17]=g,b[18]=i):i=b[18];return i}function l(a){var b;return{user:{fullName:(b=a.fullName)!=null?b:"",id:a.id,isVerified:(b=a.isVerified)!=null?b:!1,profilePictureUrl:(b=a.profilePictureUrl)!=null?b:"",username:(b=a.username)!=null?b:""}}}function m(a,b){var d;return k.jsx(c("PolarisUserHoverCard.react"),{display:"inline-block",isUserAvailable:!(a==null?void 0:a.isUnpublished),userId:(d=a==null?void 0:a.id)!=null?d:"",username:(d=a==null?void 0:a.username)!=null?d:"",children:k.jsx(c("PolarisUserLink.react"),{username:(d=a==null?void 0:a.username)!=null?d:""})},b)}m.displayName=m.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("PolarisPostFastOptionsButton.react",["fbt","IGDSBox.react","IGDSIconButton.react","IGDSMoreHorizontalPanoOutlineIcon.react","IGDSMoreVerticalPanoOutline24Icon.react","InstagramAdActionMenuFalcoEvent","PolarisContainerModuleUtils","PolarisPostModalContext.react","PolarisViewpointActionUtils","identityFunction","polarisAdsSelectors.react","polarisLogAction","react","usePolarisAnalyticsContext","usePolarisPost","usePolarisViewer"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=h._("__JHASH__cFipUAiTKQi__JHASH__");function m(a){var b=j(3),d=a.color;a=a.orientation;a=a==="horizontal"?c("IGDSMoreHorizontalPanoOutlineIcon.react"):c("IGDSMoreVerticalPanoOutline24Icon.react");var e;b[0]!==a||b[1]!==d?(e=k.jsx(c("IGDSBox.react"),{alignItems:"center",height:24,justifyContent:"center",position:"relative",width:24,children:k.jsx(a,{alt:l,color:d})}),b[0]=a,b[1]=d,b[2]=e):e=b[2];return e}function a(a){var b=j(27),e=a.className,f=a.orientation,g=a.padding,h=a.postId;a=f===void 0?"horizontal":f;var i=d("PolarisPostModalContext.react").useSetPostModal(),l=c("usePolarisAnalyticsContext")();b[0]!==l?(f=d("PolarisContainerModuleUtils").getContainerModule(l),b[0]=l,b[1]=f):f=b[1];var p=f,q=d("usePolarisPost").usePost(h,c("identityFunction")),r=!!q.isVideo;f=c("usePolarisViewer")();var s=f==null?void 0:f.id,t=d("polarisAdsSelectors.react").useFeedAdInfo(h,o),u=d("polarisAdsSelectors.react").useFeedAdInfo(h,n);b[2]!==q?(f=d("PolarisViewpointActionUtils").getMPKForFeedMedia(q),b[2]=q,b[3]=f):f=b[3];var v=f;b[4]!==h||b[5]!==l||b[6]!==r||b[7]!==q.isSponsored||b[8]!==s||b[9]!==t||b[10]!==v||b[11]!==p||b[12]!==u||b[13]!==i?(f=function(){c("polarisLogAction")("postOptionsClick",{mediaId:h,source:l,type:r?"video":"photo"}),q.isSponsored===!0&&s!=null&&c("InstagramAdActionMenuFalcoEvent").log(function(){return{ad_id:t,m_pk:v,pigeon_reserved_keyword_module:p,pk:s,source_of_action:p,tracking_token:u}}),i("options")},b[4]=h,b[5]=l,b[6]=r,b[7]=q.isSponsored,b[8]=s,b[9]=t,b[10]=v,b[11]=p,b[12]=u,b[13]=i,b[14]=f):f=b[14];f=f;var w;b[15]!==a?(w=k.jsx(m,{color:"ig-secondary-text",orientation:a}),b[15]=a,b[16]=w):w=b[16];var x;b[17]!==a?(x=k.jsx(m,{color:"ig-primary-text",orientation:a}),b[17]=a,b[18]=x):x=b[18];b[19]!==w||b[20]!==f||b[21]!==g||b[22]!==x?(a=k.jsx(c("IGDSIconButton.react"),{"data-testid":void 0,hover:w,onClick:f,padding:g,children:x}),b[19]=w,b[20]=f,b[21]=g,b[22]=x,b[23]=a):a=b[23];b[24]!==e||b[25]!==a?(w=k.jsx("div",{className:e,children:a}),b[24]=e,b[25]=a,b[26]=w):w=b[26];return w}function n(a){return a==null?void 0:a.tracking_token}function o(a){return a==null?void 0:a.ad_id}b=k.memo(a);g["default"]=b}),226);
__d("PolarisPostOptionsButtonPicker.react",["PolarisPostFastOptionsButton.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(5),d=a.buttonClassName;a=a.mediaPK;var e;b[0]!==a?(e=j.jsx(c("PolarisPostFastOptionsButton.react"),{postId:a}),b[0]=a,b[1]=e):e=b[1];b[2]!==d||b[3]!==e?(a=j.jsx("div",{className:d,children:e}),b[2]=d,b[3]=e,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("PolarisPostPageRouteReferrerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({referrerTracePolicy:null});g["default"]=b}),98);
__d("PolarisSponsoredPostCTAFooter.react",["InstagramODS","PolarisClickEventLoggerProvider.react","PolarisPostFooterCTA.react","PolarisPostUtils","PolarisTrackingNodeProvider.react","polarisAdsSelectors.react","react","usePolarisSponsoredPostCTAFooterDominantColor"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(17),e=a.isMediaRendered,f=a.post;a=a.sidecarIndex;var g=d("polarisAdsSelectors.react").useFeedAdInfo(f.id,l),h=f.isSidecar;a=h===!0?(h=d("PolarisPostUtils").getCurrentSidecarItemFromPost(f,a))==null?void 0:h.id:f.id;b[0]!==e||b[1]!==a||b[2]!==f?(h={isMediaRendered:e,mediaId:a,post:f},b[0]=e,b[1]=a,b[2]=f,b[3]=h):h=b[3];e=c("usePolarisSponsoredPostCTAFooterDominantColor")(h);var m=e.ctaDominantColor;f=e.ctaFooterViewpointRef;if(a==null)return null;if(b[4]!==(g==null?void 0:g.ctaItems)||b[5]!==a){h=g==null?void 0:(h=g.ctaItems)==null?void 0:(e=h.get(a))==null?void 0:e.ctaLinkUrl;b[4]=g==null?void 0:g.ctaItems;b[5]=a;b[6]=h}else h=b[6];var n=h;if(b[7]!==(g==null?void 0:g.ctaItems)||b[8]!==a){e=g==null?void 0:(e=g.ctaItems)==null?void 0:(h=e.get(a))==null?void 0:h.ctaLinkText;b[7]=g==null?void 0:g.ctaItems;b[8]=a;b[9]=e}else e=b[9];var o=e,p=k;if(n!=null&&o!=null){b[10]!==m||b[11]!==n||b[12]!==o?(h=function(a){return j.jsx("div",{ref:a,children:j.jsx(c("PolarisPostFooterCTA.react"),{ctaDominantColor:m,"data-testid":void 0,disableAnimation:!1,externalURL:n,forceBottomBorder:!0,isActive:!0,isForAd:!0,onClick:p,showChevron:!0,text:o})})},b[10]=m,b[11]=n,b[12]=o,b[13]=h):h=b[13];b[14]!==f||b[15]!==h?(g=j.jsx(c("PolarisClickEventLoggerProvider.react"),{children:j.jsx(c("PolarisTrackingNodeProvider.react"),{ref:f,trackingNode:86,children:h})}),b[14]=f,b[15]=h,b[16]=g):g=b[16];return g}return null}function k(){c("InstagramODS").incr("web.ads.feed.link_click")}function l(a){return a}g["default"]=a}),98);
__d("PolarisUnsaveFromCollectionDialog.react",["fbt","IGCoreDialog.react","PolarisGenericStrings","PolarisUA","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(16),c=a.onClose,e=a.onUnsaveFromAll;a=a.onUnsaveFromCollection;var f;b[0]!==a?(f=a?h._("__JHASH__HVkWD3QgXEe__JHASH__"):h._("__JHASH__Gl54JxLo7Pe__JHASH__"),b[0]=a,b[1]=f):f=b[1];var g;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=h._("__JHASH__CSnwTDU3-Jd__JHASH__"),b[2]=g):g=b[2];var i;b[3]!==a?(i=a&&k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{color:"ig-error-or-destructive",onClick:a,children:h._("__JHASH__x0m8qdE4Y2N__JHASH__")}),b[3]=a,b[4]=i):i=b[4];b[5]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._("__JHASH__e0klumbklCI__JHASH__"),b[5]=a):a=b[5];b[6]!==e?(a=k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{color:d("PolarisUA").isDesktop()?"ig-error-or-destructive":"ig-primary-button",onClick:e,children:a}),b[6]=e,b[7]=a):a=b[7];b[8]!==c?(e=k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{onClick:c,children:d("PolarisGenericStrings").CANCEL_TEXT}),b[8]=c,b[9]=e):e=b[9];b[10]!==f||b[11]!==c||b[12]!==i||b[13]!==a||b[14]!==e?(g=k.jsxs(d("IGCoreDialog.react").IGCoreDialog,{body:f,onModalClose:c,title:g,children:[i,a,e]}),b[10]=f,b[11]=c,b[12]=i,b[13]=a,b[14]=e,b[15]=g):g=b[15];return g}g["default"]=a}),226);
__d("polarisPostModalHelpers",["fbt","FBLogger","justknobx"],(function(a,b,c,d,e,f,g,h){"use strict";var i=1032,j=55,k=500,l=250,m=h._("__JHASH__l_M0CG6unzO__JHASH__");h=h._("__JHASH__wVnrOsb2lsR__JHASH__");var n=-1,o=1;function a(a){var b="";switch(a){case"profilePage":case"selfProfilePage":b="profilePageModal";break;case"locationPage":b="locationPageModal";break;case"tagPage":b="tagPageModal";break;case"exploreLandingPage":b="discoverMediaPageModal";break;case"DirectThreadPage":b="directThreadPageModal";break;case"ClipsAudioPage":b="clipsAudioPageModal";break;case"feedPage":b="feedPageModal";break;case"KeywordSearchExplorePage":b="keywordSearchExplorePageModal";break;case"adsActivityFeed":b="adActivityFeedModal";break;case"ExploreSERPPage":b="ExploreSERPPageModal";break;default:c("FBLogger")("ig_web").mustfix("Unexpected analytics context: "+a)}return b}function b(a){a=a.match(new RegExp("^(.+/)(saved)/(.+)/(.+)/"));return a!=null?a[4]:null}function d(a){return!!a.match(new RegExp("/p/"))}function e(a){a=a.match(new RegExp("/([^/]+)/[^/]*$"));return a?a[1]:null}function p(a,b,c,d){if(a.height>a.width){var e=c/a.height;d.style.maxHeight=c;d.style.maxWidth=a.width*e;d.style.aspectRatio=a.width+" / "+a.height}else b&&(d.style.aspectRatio="1"),d.style.maxHeight=c,d.style.maxWidth=c;return d}function q(a,b,c,d){c.style.maxWidth=b;b=b/a.width;c.style.maxHeight=a.height*b+d;c.style.aspectRatio=a.width*b+" / "+(a.height*b+d);return c}function f(a){var b=a.dimensions,d=a.footerHeight;d=d===void 0?j:d;var e=a.viewportHeight,f=a.viewportWidth,g=a.hasSidebarInRedesign;a=a.hasFooter;a=a===void 0?!1:a;if(b==null||e===0||f===0)return null;var h={style:{maxHeight:0,maxWidth:0}},m=f-64*2-(g?k:0);if(b){var n=e>f&&a===!0?m:g?e-24*2:e-24*2-l;n>i&&c("justknobx")._("64")&&(n=i);if(a===!1)h=p(b,g,n,h);else{a=b.height;a=(n-d)/a;h.style.maxHeight=n;!g?h=q(b,n,h,d):b.height>=b.width?e>f?h=q(b,n,h,d):b.width*a>m?h=q(b,m,h,d):(h.style.maxHeight=n,h.style.aspectRatio=b.width*a+" / "+(b.height*a+d),h.style.maxWidth=b.width*a):(h.style.aspectRatio=b.width*a>b.height*a+d?"1":b.width*a+" / "+(b.height*a+d),h.style.maxWidth=e>f?n:b.width*a>b.height*a+d?n:b.width*a)}g&&(h.style.flexBasis=h.style.maxWidth)}return h}g.PREVIOUS_ARROW_TITLE=m;g.NEXT_ARROW_TITLE=h;g.LEFT_DELTA=n;g.RIGHT_DELTA=o;g.getModalPageIdFromAnalyticsContext=a;g.getCollectionIdFromPath=b;g.isPostUrl=d;g.getPostCodeFromPath=e;g.getMediaContainerProps=f}),226);
__d("PolarisPost.react",["cx","CometErrorBoundary.react","IGDSBox.react","PolarisFollowButtonContainer.react","PolarisHeroPageletLogger","PolarisHotKeys.react","PolarisIGCoreConstants","PolarisInsightsUtils","PolarisInteractionsLogger","PolarisMediaContainer.react","PolarisOrganicImpressionAction","PolarisPanavisionQEHelpers","PolarisPostActionLikePost","PolarisPostActionRemovePostFromCollection","PolarisPostActionSavePost","PolarisPostActionUnlikePost","PolarisPostActionUnsavePost","PolarisPostCoauthorReviewOverlayFooterCTA.react","PolarisPostConstants","PolarisPostDetailsSection.react","PolarisPostFeatures.react","PolarisPostHeader.react","PolarisPostHeaderFavoritedIconButton.react","PolarisPostInvitedCoauthorsOverlayFooterCTA.react","PolarisPostModalContext.react","PolarisPostModalRenderingContext.react","PolarisPostOptionsButtonPicker.react","PolarisPostOverlayInfoFooterCTA.react","PolarisPostPageRouteReferrerContext.react","PolarisPostSuggestedHeader.react","PolarisPostToast.react","PolarisPostToastProvider.react","PolarisPostUtils","PolarisPostVariants","PolarisReactRedux.react","PolarisRoutePropUtils","PolarisSavedPostsActionEditCollection","PolarisSavedPostsTypes","PolarisSponsoredPostCTAFooter.react","PolarisTrackingNodeProvider.react","PolarisUA","PolarisUnsaveFromCollectionDialog.react","PolarisViewpointActionUtils","PolarisViewpointReact.react","PolarisVpvdImpressionAction","browserHistory_DO_NOT_USE","hero-tracing","joinClasses","nullthrows","polarisAdsSelectors.react","polarisDeveloperSettings","polarisLogAction","polarisPostModalHelpers","polarisPostSelectors","polarisRelationshipSelectors.react","polarisUserSelectors","polarisWithPPRLogging","react","useMergeRefs","usePolarisDisplayProperties","usePolarisIsOnFeedPage","usePolarisPostSetURLSidecarIndex","usePolarisShowFooterCTA","usePolarisViewer","usePrevious"],(function(a,b,c,d,e,f,g,aa){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useContext,k=e.useEffect,l=e.useRef,m=e.useState,n=e.c;function a(a){var b=a.adImpressionRefs,e=a.analyticsContext,f=a.autoplay,g=a.className,aa=a.enableTruncation,h=a.id;a.imageMediaActsAsCta;var n=a.initialCarouselIndex,o=a.initialCommentsQuery,p=a.isSponsored;p=p===void 0?!1:p;var q=a.isVisible,ba=a.lightLetterbox,ca=a.onMediaRendered,da=a.permalinkedCommentId,ea=a.permalinkedReplyId,r=a.position,fa=a.shortcode,ga=a.shouldIncreaseCommentPreviews,s=a.testid;s=s===void 0?"post":s;s=a.variant;var t=s===void 0?d("PolarisPostVariants").VARIANTS.flexible:s;s=a.viewpointActionsForSponsoredPost;var ha=a.visiblePosition,ia=a.willScrollTo,u=d("PolarisReactRedux.react").useDispatch(),v=d("PolarisReactRedux.react").useSelector(function(a){return d("polarisPostSelectors").getPostById(a,h)}),w=c("nullthrows")(v.owner).id;a=(a=v.group)==null?void 0:a.id;var ja=(a=a)!=null?a:w;a=j(c("PolarisPostPageRouteReferrerContext.react"));a=a.referrerTracePolicy;var x=j(d("PolarisRoutePropUtils").PolarisRoutePropContext);x=x==null?void 0:x.routePropQE.getBool("isElevatedFollowButton");var y=v.invitedCoauthorProducers,ka=d("PolarisReactRedux.react").useSelector(function(a){return d("polarisUserSelectors").getUserByIdOrThrows(a,w)}),z=d("PolarisReactRedux.react").useSelector(function(a){return d("polarisUserSelectors").getUserByIdOrThrows(a,ja)}),la=d("PolarisReactRedux.react").useSelector(function(a){return d("polarisRelationshipSelectors.react").getRelationship(a.relationships,ja)}),A=c("usePolarisViewer")(),B=!!(A==null?void 0:A.canSeeOrganicInsights),C=!!v.canSeeInsightsAsBrand,D=d("polarisAdsSelectors.react").useFeedAdInfo(v==null?void 0:v.id,function(a){return a}),E=c("usePolarisDisplayProperties")(),ma=E.viewportHeight;E=E.viewportWidth;var F=d("PolarisPostModalRenderingContext.react").usePolarisPostModalRenderingContext(),G=F.isInModal,H=(n=(F=n)!=null?F:d("PolarisPostUtils").getInitialSidecarIndexFromPost(v))!=null?n:0;v.isSidecar===!0&&(H<0||v.sidecarChildren!=null&&H>=v.sidecarChildren.length)&&(H=0);F=m(H);var I=F[0],na=F[1];n=m({});var J=n[0],oa=n[1];F=m(!1);n=F[0];var pa=F[1];F=m({});var K=F[0],qa=F[1];F=m(!1);var ra=F[0],L=F[1];F=m(!1);var sa=F[0],ta=F[1];F=m(null);var ua=F[0],va=F[1];F=l(null);var wa=c("usePolarisPostSetURLSidecarIndex")();k(function(){ia==="top"&&window.setTimeout(function(){window.scrollTo(0,0)})},[ia]);var M=c("usePrevious")(v);k(function(){M!=null&&v.id!==M.id&&(oa({}),qa({}))},[v,M]);k(function(){fa!=null&&v.isSidecar===!0&&wa(I+1)},[I,v.isSidecar,wa,fa]);var xa=function(a){pa(!0),ca!=null&&ca(v.id,a)},ya=function(a){na(a)},N=function(a,b){var c;c={mediaAuthorId:(c=v.owner)==null?void 0:c.id,mediaId:v.id,source:e,sourceOfLike:b,trackingToken:v.trackingToken};b=null;(D==null?void 0:D.ad_id)!=null&&(D==null?void 0:D.tracking_token)!=null&&Y!=null&&(b={adId:D==null?void 0:D.ad_id,adTrackingToken:D==null?void 0:D.tracking_token,viewerId:Y});a?v.likedByViewer!==!0&&u(d("PolarisPostActionLikePost").likePost(v.id,c,b)):u(d("PolarisPostActionUnlikePost").unlikePost(v.id,c,b))},za=function(){N(!0,"double_tap_media")},Aa=function(a){var b={source:e},f=null;if((D==null?void 0:D.ad_id)!=null&&(D==null?void 0:D.tracking_token)!=null&&Y!=null){var g;f={adId:D==null?void 0:D.ad_id,adTrackingToken:D==null?void 0:D.tracking_token,analyticsContext:e,followStatus:d("PolarisViewpointActionUtils").getFollowStatus(la),mediaPk:d("PolarisViewpointActionUtils").getMPKForFeedMedia(v),mediaType:d("PolarisInteractionsLogger").getMediaTypeFromPost(v),ownerId:(g=v.owner)==null?void 0:g.id,viewerId:Y}}a?v.savedByViewer!==!0&&u(d("PolarisPostActionSavePost").savePost(v.id,b,f)):v.savedByViewer===!0&&(v.savedByViewerToCollection===!0?(c("polarisLogAction")("removeSavedItemFromCollectionDialogShown"),L(!0)):u(d("PolarisPostActionUnsavePost").unsavePost(v.id,b,f)))},Ba=function(){c("polarisLogAction")("removeSavedItemFromCollectionDialogCancelled"),L(!1)},Ca=function(){L(!1),u(d("PolarisPostActionUnsavePost").unsavePost(v.id,{source:e})),c("polarisLogAction")("removeSavedItemFromCollectionDialogAccepted")},Da=function(){var b={source:e};L(!1);var a=d("browserHistory_DO_NOT_USE").browserHistory.location.pathname;a=d("polarisPostModalHelpers").getCollectionIdFromPath(a);a!=null&&A!=null&&(u(d("PolarisPostActionRemovePostFromCollection").removePostFromCollection({collectionId:a,postId:v.id})),u(d("PolarisSavedPostsActionEditCollection").editCollection({collectionId:a,postIdsToRemove:[v.id],source:b.source,userId:c("nullthrows")(A==null?void 0:A.id)})))},Ea=function(a){Ga(a)&&Ia(a.id)},Fa=function(a){Ja(a)},Ga=function(a){return J[a.id]===!0},Ha=function(a){return K[a]===!0},Ia=function(a){var b=babelHelpers["extends"]({},J);b[a]=!0;oa(b)},Ja=function(a){var b=babelHelpers["extends"]({},K);b[a]=!0;qa(b)},O=function(a){ta(!0),va(a)},Ka=function(){ta(!1)},P=d("browserHistory_DO_NOT_USE").browserHistory.location.pathname,Q=d("PolarisPostFeatures.react").usePolarisPostFeatures({owner:z,path:P,post:v,variant:t}),R=Q.commentsAreStacked,La=Q.hasPhotosOfYouOption,Ma=Q.hasThreadedSidebarComments,S=Q.isFavorited,Na=Q.isSidecar,Oa=Q.isStackedScreenSize;Q=Q.showFollowButton;P=d("polarisPostModalHelpers").getCollectionIdFromPath(P);var Pa=P!=null&&P!==d("PolarisSavedPostsTypes").SAVED_COLLECTION_TYPE.ALL_MEDIA_AUTO_COLLECTION;P=!!Q&&(!v.coauthorProducers||v.coauthorProducers.length===0)&&!p;var T=E>=d("PolarisPostConstants").SIDEBAR_VARIANT_CUTOFF,Qa=T&&G===!0,U=!T&&G===!0,Ra=G===!0?T:!R;Q=c("usePolarisIsOnFeedPage")();var V=e==="adsActivityFeed",W=(Q||V)&&G!==!0&&d("PolarisUA").isDesktop(),X=(Q||V)&&G!==!0&&d("PolarisUA").isDesktop(),Sa=d("PolarisPostUtils").getCurrentSidecarItemFromPost(v,I),Ta=i.jsxs("div",{className:"_aasi"+(W?" _aasj":"")+(U?" _aask":"")+(X?" _ai9a":""),children:[v.inventorySource==="mixed_unconnected"&&Q&&!G&&i.jsx(c("PolarisPostSuggestedHeader.react"),{postId:v.id,title:(V=v.explore)==null?void 0:V.title}),i.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",position:"relative",children:[i.jsx(c("PolarisPostHeader.react"),{adTitle:D==null?void 0:D.ad_title,analyticsContext:e,clipsAttributionInfo:v.clipsAttributionInfo,clipsAudioAttributionInfo:v.clipsMusicAttributionInfo,coauthorProducers:v.coauthorProducers,displayFBPageName:D==null?void 0:D.display_fb_page_name,followHashtagInfo:v.followHashtagInfo,headerAvatarSize:c("PolarisIGCoreConstants").AVATAR_SIZES.small,inModal:G,isAffiliate:v.isAffiliate===!0,isPaidPartnership:v.isPaidPartnership===!0,isSharedToCloseFriends:v.audience==="MediaAudience.BESTIES",isSponsored:v.isSponsored===!0,isVideo:!!v.isVideo,location:v.location,mediaId:v.id,onDisabledClipsAudioAttributionClick:O,owner:z,postedAt:v.postedAt,shouldShowFollowButton:P&&!x,showVerifiedBadge:!0,sidebarVariantOptionsButton:Ma,sponsoredLabel:D==null?void 0:D.label,sponsors:v.sponsors,transparencyLabelOwner:v.owner},v.id),i.jsx(c("PolarisPostHeaderFavoritedIconButton.react"),{isFavorited:S}),x?i.jsx(c("PolarisFollowButtonContainer.react"),{analyticsContext:e,borderless:!1,"data-testid":void 0,isInline:!1,primaryCTAColor:"ig-lox-dynamic-black",userId:z.id,username:(Q=z.username)!=null?Q:""}):null,i.jsx(c("PolarisPostOptionsButtonPicker.react"),{buttonClassName:"_aasm"+(W||d("PolarisPanavisionQEHelpers").hasDenserMobileWebFeed()?" _aasn":"")+(X?" _agh1":""),mediaPK:v.id})]})]});V=d("PolarisInsightsUtils").getViewInsightsInfo(A,w,v,C,B);var Ua=V.bloksAppId,Va=V.hasViewInsights,Y=A==null?void 0:A.id;O=p&&s!=null?s:[d("PolarisOrganicImpressionAction").makePostImpressionAction(v,e,a,r),d("PolarisVpvdImpressionAction").makePostVpvdImpressionAction(v,e)];P=d("PolarisViewpointReact.react").useViewpoint({action:O,id:"viewpoint"+v.id});x=[P].concat((S=b)!=null?S:[]);var Wa=c("useMergeRefs").apply(void 0,x),Xa=A?{l:function(){N(!v.likedByViewer,"button")},s:function(){Aa(!v.savedByViewer)}}:{};Q=c("usePolarisShowFooterCTA")(v,I,J,p);var Z=null;p?Z=i.jsx(c("PolarisSponsoredPostCTAFooter.react"),{isMediaRendered:n,post:v,sidecarIndex:I}):Q||!G?Z=i.jsx(d("PolarisPostOverlayInfoFooterCTA.react").PolarisPostOverlayInfoFooterCTA,{analyticsContext:e,currentSidecarIndex:I,dynamicFooterRef:F,idsWithClearedBlurOverlays:J,idsWithDisabledMediaOverlayInfoImpressionLogging:K,onLogOverlayImpression:function(a){return Fa(a)},rootPost:v}):y!=null&&y.length>0&&(Z=i.jsxs("div",{children:[i.jsx(c("PolarisPostCoauthorReviewOverlayFooterCTA.react"),{invitedCoauthorProducers:y,mediaId:v.id,mediaShortcode:v.code,productType:v.productType,user:v.owner}),i.jsx(c("PolarisPostInvitedCoauthorsOverlayFooterCTA.react"),{invitedCoauthorProducers:y,mediaId:v.id,user:v.owner})]}));C=Z!=null;var $=d("polarisPostModalHelpers").getMediaContainerProps({dimensions:v.dimensions,footerHeight:C?(B=F.current)==null?void 0:B.offsetHeight:void 0,hasFooter:C,hasSidebarInRedesign:T,viewportHeight:ma,viewportWidth:E}),Ya=!1,Za={border:v.isSeen===!0?"2px solid green":"2px solid red"};return i.jsx(d("PolarisPostToastProvider.react").PostToastProvider,{children:function(a){return i.jsx(d("PolarisPostModalContext.react").PostModalContext,{post:v,children:i.jsx(d("hero-tracing").HeroPagelet,{name:d("PolarisHeroPageletLogger").getHeroPageletLogName(d("PolarisHeroPageletLogger").PageletLogName.POST,r),ref:Wa,children:function(b,h){return i.jsx(c("PolarisHotKeys.react"),{keyMap:Xa,children:function(j,k,l){return i.jsx(c("PolarisTrackingNodeProvider.react"),{ref:b,trackingNode:301,children:function(b){return i.jsxs("article",{className:c("joinClasses")(g,"_aatb"+(t===d("PolarisPostVariants").VARIANTS.feed?" _aatc":"")+(Oa?" _aatd":"")+(Oa?"":" _aate")+(R?" _aatf":"")+(Ra?" _aatg":"")+(Na?" _aath":"")+(Ma?" _aati":"")+(Va?" _aatj":"")),"data-testid":void 0,onKeyUp:j,ref:b,role:k,style:Ya?Za:{},tabIndex:l,children:[i.jsxs(c("IGDSBox.react"),{alignSelf:U?"center":void 0,direction:(G===!0?T:!R)?"row":"column",display:"flex",justifyContent:"center",maxHeight:"inherit",maxWidth:U&&($==null?void 0:$.style)!=null?$.style.maxWidth:"inherit",position:"relative",children:[(G===!0?!T:R)?Ta:null,i.jsx("div",babelHelpers["extends"]({},G===!0?$:{},{className:"_aatk"+(G===!0?" _aatl":"")+(Qa&&v.dimensions!=null&&v.dimensions.width>=v.dimensions.height?" _aatm":"")+(ba===!0?" _aatn":"")+(X?" _aiao":""),children:i.jsx(c("PolarisMediaContainer.react"),{accessibilityCaption:v.accessibilityCaption,adInfo:D,analyticsContext:e,autoplay:f,checkIsSensitivityOverlayDisabledCallback:function(a){return Ga(a)},className:"_aato",commentsAreStacked:R,hasPhotosOfYouOption:La,hasViewInsights:Va,id:v.id,initialCarouselIndex:H,inModal:G,isVisible:q,mediaFooter:Z,onLike:A?za:null,onPostMediaRendered:xa,onPostSidecarChildIndexChange:ya,onSensitivityOverlayCleared:Ea,onToastClose:Ka,position:r,post:v,relationship:la,sensitivityOverlayMediaOverlayInfoLoggingProps:{checkIfMediaOverlayInfoImpressionLoggingDisabled:function(a){return Ha(a)},onLoggedMediaOverlayInfoImpression:function(a){return Fa(a)}},showToast:sa,toastString:ua,viewer:A,visiblePosition:ha})})),i.jsx(c("PolarisPostDetailsSection.react"),{analyticsContext:e,bloksAppId:Ua,currSidecarIndex:I,currSidecarItem:Sa,enableTruncation:aa,handleLikeChange:N,handleSaveChange:Aa,hasDenserFeedRedesign:W,hasSidebarInRedesign:T,hasViewInsights:Va,initialCommentsQuery:o,owner:z,permalinkedCommentId:da,permalinkedReplyId:ea,post:v,postAuthorId:w,postAuthorUsername:ka==null?void 0:ka.username,postFeedbackControlsRef:a,postHeader:Ta,redesignWithoutSidebar:U,redesignWithSidebar:Qa,shouldIncreaseCommentPreviews:ga,showDetailsAsSidebar:Ra,variant:t,viewer:A}),ra&&i.jsx(c("PolarisUnsaveFromCollectionDialog.react"),{onClose:Ba,onUnsaveFromAll:Ca,onUnsaveFromCollection:Pa&&d("PolarisUA").isDesktop()?Da:null}),i.jsx(c("PolarisPostToast.react"),{isFeedVariant:t===d("PolarisPostVariants").VARIANTS.feed,isModal:(b=G)!=null?b:!1})]}),i.jsx(h,{})]})}})}})}})},v.id)}})}a.displayName=a.name+" [from "+f.id+"]";var o=c("polarisWithPPRLogging")(a);function p(){c("polarisLogAction")("feedUnitFailure",{source:"PolarisPost"})}function b(a){var b=n(2),d;b[0]!==a?(d=i.jsx(c("CometErrorBoundary.react"),{fallback:q,onError:p,children:i.jsx(o,babelHelpers["extends"]({},a))}),b[0]=a,b[1]=d):d=b[1];return d}function q(a){return null}g["default"]=b}),98);
__d("PolarisPostActionLoadPostQueryInlineFragment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"PolarisPostActionLoadPostQueryInlineFragment"};e.exports=a}),null);
__d("PolarisPostActionLoadPostQueryInlineFragmentWithoutRelatedProfiles.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"PolarisPostActionLoadPostQueryInlineFragmentWithoutRelatedProfiles"};e.exports=a}),null);
__d("PolarisPostActionLoadPostQueryInlineMediaFragment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"PolarisPostActionLoadPostQueryInlineMediaFragment"};e.exports=a}),null);
__d("PolarisPostActionLoadPostQueryInlineSharerFragment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"PolarisPostActionLoadPostQueryInlineSharerFragment"};e.exports=a}),null);
__d("PolarisPostActionLoadPostQueryLegacyQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8136398069788847"}),null);
__d("PolarisPostActionLoadPostQueryLegacyQuery.graphql",["PolarisPostActionLoadPostQueryLegacyQuery_instagramRelayOperation"],(function(a,aa,b,c,d,e){"use strict";a=function(){var a={defaultValue:3,kind:"LocalArgument",name:"fetch_related_profile_media_count"},b={defaultValue:null,kind:"LocalArgument",name:"fetch_tagged_user_count"},c={defaultValue:null,kind:"LocalArgument",name:"hoisted_comment_id"},d={defaultValue:null,kind:"LocalArgument",name:"hoisted_reply_id"},e={defaultValue:null,kind:"LocalArgument",name:"shortcode"},f=[{kind:"Variable",name:"shortcode",variableName:"shortcode"}],g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"shortcode",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"thumbnail_src",storageKey:null},k={alias:null,args:null,concreteType:"XDTGraphMediaDimensions",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"buttons",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"gating_type",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"center_button",storageKey:null},ba={alias:null,args:null,kind:"ScalarField",name:"post_reveal_cta",storageKey:null},ca={alias:null,args:null,kind:"ScalarField",name:"time_gated",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"misinformation_type",storageKey:null},r={alias:null,args:null,concreteType:"XDTGraphMediaGatingInfo",kind:"LinkedField",name:"gating_info",plural:!1,selections:[l,m,n,o,p,ba,ca,q],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"fact_check_overall_rating",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"profile_pic_url",storageKey:null},v={alias:null,args:null,concreteType:"XDTGraphMediaFactCheck",kind:"LinkedField",name:"fact_check_information",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},{alias:null,args:null,concreteType:"XDTGraphMediaFactCheckProvider",kind:"LinkedField",name:"provider",plural:!1,selections:[t,u,{alias:null,args:null,kind:"ScalarField",name:"appeal_email",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_directly_rated",storageKey:null}],storageKey:null},w={alias:null,args:null,concreteType:"XDTGraphMediaSensitivityFrictionInfo",kind:"LinkedField",name:"sensitivity_friction_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"sensitivity_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_subtitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_primary_button",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_secondary_button",storageKey:null}],storageKey:null},x={alias:null,args:null,concreteType:"XDTGraphMediaSharingFrictionInfo",kind:"LinkedField",name:"sharing_friction_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"should_have_sharing_friction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"bloks_app_url",storageKey:null}],storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},A={alias:null,args:null,concreteType:"XDTGraphMediaOverlayIconSpec",kind:"LinkedField",name:"icon",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"icon_glyph",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icon_type",storageKey:null},t,z],storageKey:null},B=[{alias:null,args:null,kind:"ScalarField",name:"button_type",storageKey:null},y,{alias:null,args:null,kind:"ScalarField",name:"secondary_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action_url",storageKey:null},A,{alias:null,args:null,concreteType:"XDTGraphMediaOverlayTextColorSpec",kind:"LinkedField",name:"text_color",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"light",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dark",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_text_centered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_chevron",storageKey:null}];B={alias:null,args:null,concreteType:"XDTGraphMediaOverlayInfo",kind:"LinkedField",name:"media_overlay_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaOverlayButtonSpec",kind:"LinkedField",name:"banner",plural:!1,selections:B,storageKey:null},{alias:null,args:null,concreteType:"XDTGraphMediaOverlayButtonSpec",kind:"LinkedField",name:"buttons",plural:!0,selections:B,storageKey:null},m,A,q,{alias:null,args:null,kind:"ScalarField",name:"overlay_layout",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"overlay_type",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"bloks_data",storageKey:null}],storageKey:null};A={alias:null,args:null,kind:"ScalarField",name:"media_preview",storageKey:null};q={alias:null,args:null,kind:"ScalarField",name:"display_url",storageKey:null};z={alias:null,args:null,concreteType:"XDTGraphImageResource",kind:"LinkedField",name:"display_resources",plural:!0,selections:[z,{alias:null,args:null,kind:"ScalarField",name:"config_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"config_height",storageKey:null}],storageKey:null};var C={alias:null,args:null,kind:"ScalarField",name:"is_video",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"tracking_token",storageKey:null},E={alias:null,args:null,concreteType:"XDTGraphUpcomingEventDict",kind:"LinkedField",name:"upcoming_event",plural:!1,selections:[h,o,{alias:null,args:null,kind:"ScalarField",name:"start_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reminder_enabled",storageKey:null}],storageKey:null},da=[{kind:"Variable",name:"first",variableName:"fetch_tagged_user_count"}],F={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},G={alias:null,args:null,kind:"ScalarField",name:"followed_by_viewer",storageKey:null},H={alias:null,args:null,kind:"ScalarField",name:"is_verified",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},ea={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"user",plural:!1,selections:[F,G,h,H,u,I],storageKey:null},fa={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},ga={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},ha={alias:null,args:da,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user_connection",kind:"LinkedField",name:"edge_media_to_tagged_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphTaggedUser",kind:"LinkedField",name:"node",plural:!1,selections:[ea,fa,ga],storageKey:null}],storageKey:null}],storageKey:null},J={alias:null,args:null,kind:"ScalarField",name:"is_private",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},L=[K],M={alias:null,args:null,concreteType:"XDTgraphuser_edge_followed_by_connection",kind:"LinkedField",name:"edge_followed_by",plural:!1,selections:L,storageKey:null};G={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"owner",plural:!1,selections:[h,I,{alias:null,args:null,kind:"ScalarField",name:"has_onboarded_to_text_post_app",storageKey:null},H,u,{alias:null,args:null,kind:"ScalarField",name:"blocked_by_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"restricted_by_viewer",storageKey:null},G,F,{alias:null,args:null,kind:"ScalarField",name:"has_blocked_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_embeds_disabled",storageKey:null},J,{alias:null,args:null,kind:"ScalarField",name:"is_unpublished",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"requested_by_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pass_tiering_recommendation",storageKey:null},{alias:null,args:null,concreteType:"XDTgraphuser_edge_owner_to_timeline_media_connection",kind:"LinkedField",name:"edge_owner_to_timeline_media",plural:!1,selections:L,storageKey:null},M],storageKey:null};var ia=[{kind:"Literal",name:"first",value:1}],N={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},ja={alias:null,args:null,kind:"ScalarField",name:"can_see_insights_as_brand",storageKey:null},ka={alias:null,args:null,kind:"ScalarField",name:"caption_is_edited",storageKey:null},la={alias:null,args:null,kind:"ScalarField",name:"has_ranked_comments",storageKey:null},ma={alias:null,args:null,kind:"ScalarField",name:"like_and_view_counts_disabled",storageKey:null},O={alias:null,args:null,concreteType:"XDTPageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_cursor",storageKey:null}],storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"did_report_as_spam",storageKey:null},Q=[h,H,u,I],R={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"owner",plural:!1,selections:Q,storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"viewer_has_liked",storageKey:null},T={alias:null,args:null,concreteType:"XDTgraphcomment_edge_liked_by_connection",kind:"LinkedField",name:"edge_liked_by",plural:!1,selections:L,storageKey:null},U={alias:null,args:null,kind:"ScalarField",name:"is_restricted_pending",storageKey:null},V=[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[h,y,N,P,R,S,T,U],storageKey:null}],W={alias:null,args:[{kind:"Literal",name:"first",value:3}],concreteType:"XDTgraphcomment_edge_threaded_comments_connection",kind:"LinkedField",name:"edge_threaded_comments",plural:!1,selections:[K,O,{alias:null,args:null,concreteType:"XDTgraphcomment_edge_threaded_comments",kind:"LinkedField",name:"edges",plural:!0,selections:V,storageKey:null}],storageKey:"edge_threaded_comments(first:3)"};O={alias:null,args:[{kind:"Literal",name:"first",value:24}],concreteType:"XDTgraphmediainterface_edge_media_to_parent_comment_connection",kind:"LinkedField",name:"edge_media_to_parent_comment",plural:!1,selections:[K,O,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_parent_comment",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[h,y,N,P,R,S,T,U,W],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_parent_comment(first:24)"};P={alias:null,args:[{kind:"Variable",name:"hoisted_comment_id",variableName:"hoisted_comment_id"}],concreteType:"XDTgraphmediainterface_edge_media_to_hoisted_comment_connection",kind:"LinkedField",name:"edge_media_to_hoisted_comment",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_hoisted_comment",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[h,y,N,P,R,S,T,U,{alias:null,args:[{kind:"Variable",name:"hoisted_reply_id",variableName:"hoisted_reply_id"}],concreteType:"XDTgraphcomment_edge_comment_to_hoisted_reply_connection",kind:"LinkedField",name:"edge_comment_to_hoisted_reply",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphcomment_edge_comment_to_hoisted_reply",kind:"LinkedField",name:"edges",plural:!0,selections:V,storageKey:null}],storageKey:null},W],storageKey:null}],storageKey:null}],storageKey:null};R={alias:null,args:[{kind:"Literal",name:"first",value:2}],concreteType:"XDTgraphmediainterface_edge_media_preview_comment_connection",kind:"LinkedField",name:"edge_media_preview_comment",plural:!1,selections:[K,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_comment",kind:"LinkedField",name:"edges",plural:!0,selections:V,storageKey:null}],storageKey:"edge_media_preview_comment(first:2)"};T={alias:null,args:null,kind:"ScalarField",name:"comments_disabled",storageKey:null};U={alias:null,args:null,kind:"ScalarField",name:"commenting_disabled_for_viewer",storageKey:null};W={alias:null,args:null,kind:"ScalarField",name:"taken_at_timestamp",storageKey:null};V={alias:null,args:[{kind:"Literal",name:"first",value:10}],concreteType:"XDTgraphmediainterface_edge_media_preview_like_connection",kind:"LinkedField",name:"edge_media_preview_like",plural:!1,selections:[K,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_like",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"node",plural:!1,selections:Q,storageKey:null}],storageKey:null}],storageKey:"edge_media_preview_like(first:10)"};var X=[h,I],na={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"sponsor",plural:!1,selections:X,storageKey:null},oa={alias:null,args:null,kind:"ScalarField",name:"is_affiliate",storageKey:null},pa={alias:null,args:null,kind:"ScalarField",name:"is_paid_partnership",storageKey:null};t={alias:null,args:null,concreteType:"XDTGraphLocation",kind:"LinkedField",name:"location",plural:!1,selections:[h,{alias:null,args:null,kind:"ScalarField",name:"has_public_page",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"slug",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"address_json",storageKey:null}],storageKey:null};var qa={alias:null,args:null,concreteType:"XDTGraphNftAssetInfoType",kind:"LinkedField",name:"nft_asset_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"asset_id",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"shimmer_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator_username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator_igid",storageKey:null}],storageKey:null},ra={alias:null,args:null,kind:"ScalarField",name:"viewer_has_saved",storageKey:null},sa={alias:null,args:null,kind:"ScalarField",name:"viewer_has_saved_to_collection",storageKey:null},ta={alias:null,args:null,kind:"ScalarField",name:"viewer_in_photo_of_you",storageKey:null},ua={alias:null,args:null,kind:"ScalarField",name:"viewer_can_reshare",storageKey:null},va={alias:null,args:null,kind:"ScalarField",name:"is_ad",storageKey:null},wa={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"coauthor_producers",plural:!0,selections:Q,storageKey:null};Q={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"pinned_for_users",plural:!0,selections:Q,storageKey:null};var Y={alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},Z=[Y],$={kind:"InlineFragment",selections:Z,type:"XDTGraphImage",abstractKey:null};F={alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_related_profiles_connection",kind:"LinkedField",name:"edge_related_profiles",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_related_profiles",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"node",plural:!1,selections:[h,F,J,H,u,I,M,{alias:null,args:[{kind:"Variable",name:"first",variableName:"fetch_related_profile_media_count"}],concreteType:"XDTgraphuser_edge_owner_to_timeline_media_connection",kind:"LinkedField",name:"edge_owner_to_timeline_media",plural:!1,selections:[K,{alias:null,args:null,concreteType:"XDTgraphuser_edge_owner_to_timeline_media",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,h,i,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_like_connection",kind:"LinkedField",name:"edge_media_preview_like",plural:!1,selections:L,storageKey:null},{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_comment_connection",kind:"LinkedField",name:"edge_media_preview_comment",plural:!1,selections:L,storageKey:null},j,{alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"owner",plural:!1,selections:X,storageKey:null},{alias:null,args:null,concreteType:"XDTGraphMediaGatingInfo",kind:"LinkedField",name:"gating_info",plural:!1,selections:[l,m,n,o,p,ba,ca],storageKey:null},x,B,C,$,{kind:"InlineFragment",selections:Z,type:"XDTGraphSidecar",abstractKey:null},{kind:"InlineFragment",selections:Z,type:"XDTGraphVideo",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null};J={alias:null,args:null,concreteType:"XDTGraphDashInfo",kind:"LinkedField",name:"dash_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_dash_eligible",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"video_dash_manifest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"number_of_qualities",storageKey:null}],storageKey:null};H={alias:null,args:null,kind:"ScalarField",name:"has_audio",storageKey:null};u={alias:null,args:null,kind:"ScalarField",name:"video_url",storageKey:null};I={alias:null,args:null,kind:"ScalarField",name:"video_view_count",storageKey:null};M={alias:null,args:null,kind:"ScalarField",name:"video_play_count",storageKey:null};K={kind:"InlineFragment",selections:[Y,J,H,u,I,M,{alias:null,args:null,kind:"ScalarField",name:"encoding_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_published",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_type",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"video_duration",storageKey:null},{alias:null,args:null,concreteType:"XDTGraphClipsMusicAttributionInfo",kind:"LinkedField",name:"clips_music_attribution_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"artist_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"song_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uses_original_audio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_mute_audio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_mute_audio_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_id",storageKey:null}],storageKey:null}],type:"XDTGraphVideo",abstractKey:null};L={kind:"InlineFragment",selections:[Y,J,H,u,I,M],type:"XDTGraphVideo",abstractKey:null};X={alias:null,args:da,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user_connection",kind:"LinkedField",name:"edge_media_to_tagged_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphTaggedUser",kind:"LinkedField",name:"node",plural:!1,selections:[ea,fa,ga,h],storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[a,b,c,d,e],kind:"Fragment",metadata:null,name:"PolarisPostActionLoadPostQueryLegacyQuery",selections:[{alias:null,args:f,concreteType:null,kind:"LinkedField",name:"xdt_shortcode_media",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"PolarisPostActionLoadPostQueryInlineFragment",selections:[g,h,i,j,k,r,s,v,w,x,B,A,q,z,C,D,E,ha,G,{alias:null,args:ia,concreteType:"XDTgraphmediainterface_edge_media_to_caption_connection",kind:"LinkedField",name:"edge_media_to_caption",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_caption",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaCaption",kind:"LinkedField",name:"node",plural:!1,selections:[N,y],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_caption(first:1)"},ja,ka,la,ma,O,P,R,T,U,W,V,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user_connection",kind:"LinkedField",name:"edge_media_to_sponsor_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphSponsorTag",kind:"LinkedField",name:"node",plural:!1,selections:[na],storageKey:null}],storageKey:null}],storageKey:null},oa,pa,t,qa,S,ra,sa,ta,ua,va,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media_connection",kind:"LinkedField",name:"edge_web_media_to_related_media",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,j],storageKey:null}],storageKey:null}],storageKey:null},wa,Q,F,K,$,{kind:"InlineFragment",selections:[Y,{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children_connection",kind:"LinkedField",name:"edge_sidecar_to_children",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,h,i,k,r,s,v,w,x,B,A,q,z,L,$,C,D,E,ha],storageKey:null}],storageKey:null}],storageKey:null}],type:"XDTGraphSidecar",abstractKey:null}],args:null,argumentDefinitions:[{kind:"RootArgument",name:"fetch_related_profile_media_count"},{kind:"RootArgument",name:"fetch_tagged_user_count"},{kind:"RootArgument",name:"hoisted_comment_id"},{kind:"RootArgument",name:"hoisted_reply_id"}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,a,b,c,d],kind:"Operation",name:"PolarisPostActionLoadPostQueryLegacyQuery",selections:[{alias:null,args:f,concreteType:null,kind:"LinkedField",name:"xdt_shortcode_media",plural:!1,selections:[g,{kind:"TypeDiscriminator",abstractKey:"__isXDTGraphMediaInterface"},h,i,j,k,r,s,v,w,x,B,A,q,z,C,D,E,X,G,{alias:null,args:ia,concreteType:"XDTgraphmediainterface_edge_media_to_caption_connection",kind:"LinkedField",name:"edge_media_to_caption",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_caption",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaCaption",kind:"LinkedField",name:"node",plural:!1,selections:[N,y,h],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_caption(first:1)"},ja,ka,la,ma,O,P,R,T,U,W,V,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user_connection",kind:"LinkedField",name:"edge_media_to_sponsor_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphSponsorTag",kind:"LinkedField",name:"node",plural:!1,selections:[na,h],storageKey:null}],storageKey:null}],storageKey:null},oa,pa,t,qa,S,ra,sa,ta,ua,va,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media_connection",kind:"LinkedField",name:"edge_web_media_to_related_media",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,i,j,h],storageKey:null}],storageKey:null}],storageKey:null},wa,Q,F,K,$,{kind:"InlineFragment",selections:[Y,{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children_connection",kind:"LinkedField",name:"edge_sidecar_to_children",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,h,i,k,r,s,v,w,x,B,A,q,z,L,$,C,D,E,X],storageKey:null}],storageKey:null}],storageKey:null}],type:"XDTGraphSidecar",abstractKey:null}],storageKey:null}]},params:{id:aa("PolarisPostActionLoadPostQueryLegacyQuery_instagramRelayOperation"),metadata:{is_distillery:!0},name:"PolarisPostActionLoadPostQueryLegacyQuery",operationKind:"query",text:null}}}();d.exports=a}),null);
__d("PolarisPostActionLoadPostQueryMediaIdQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8560989810597985"}),null);
__d("PolarisPostActionLoadPostQueryMediaIdQuery.graphql",["PolarisPostActionLoadPostQueryMediaIdQuery_instagramRelayOperation"],(function(a,aa,b,c,d,e){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"mediaId"}],b=[{kind:"Variable",name:"media_id",variableName:"mediaId"}],c={alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"pk",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"ad_id",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"taken_at",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"inventory_source",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},l={alias:null,args:null,concreteType:"XDTVideoVersion",kind:"LinkedField",name:"video_versions",plural:!0,selections:[i,j,k,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"profile_pic_url",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"is_dash_eligible",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"number_of_qualities",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"video_dash_manifest",storageKey:null};k={alias:null,args:null,concreteType:"XDTImageVersion2",kind:"LinkedField",name:"image_versions2",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTImageCandidate",kind:"LinkedField",name:"candidates",plural:!0,selections:[k,j,i],storageKey:null}],storageKey:null};j={alias:null,args:null,kind:"ScalarField",name:"is_paid_partnership",storageKey:null};i={alias:null,args:null,kind:"ScalarField",name:"is_pending",storageKey:null};var r={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"is_unpublished",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"original_height",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"original_width",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"organic_tracking_token",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"is_private",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"is_embeds_disabled",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"is_verified",storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"following",storageKey:null},A={alias:null,args:null,concreteType:"XDTRelationshipInfoDict",kind:"LinkedField",name:"friendship_status",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"blocking",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followed_by",storageKey:null},z,{alias:null,args:null,kind:"ScalarField",name:"incoming_request",storageKey:null},w,{alias:null,args:null,kind:"ScalarField",name:"is_restricted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_viewer_unconnected",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muting",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"outgoing_request",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscribed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_feed_favorite",storageKey:null}],storageKey:null},B={alias:null,args:null,kind:"ScalarField",name:"latest_reel_media",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"comments_disabled",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"like_and_view_counts_disabled",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"can_viewer_reshare",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"product_type",storageKey:null},G={alias:null,args:null,kind:"ScalarField",name:"media_type",storageKey:null},H={alias:null,args:null,concreteType:"XDTUserTagInfosDict",kind:"LinkedField",name:"usertags",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTUserTagInfoDict",kind:"LinkedField",name:"in",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"user",plural:!1,selections:[d,r,n,m,y],storageKey:null}],storageKey:null}],storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},J={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},K={alias:null,args:null,concreteType:"XDTMediaOverlayPayloadSchema",kind:"LinkedField",name:"media_overlay_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTButtonSpec",kind:"LinkedField",name:"banner",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"action",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"button_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_chevron",storageKey:null},{alias:null,args:null,concreteType:"XDTIconSpec",kind:"LinkedField",name:"icon",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"icon_glyph",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icon_type",storageKey:null},I,{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_text_centered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"secondary_text",storageKey:null},J,{alias:null,args:null,concreteType:"XDTTextColorSpec",kind:"LinkedField",name:"text_color",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"dark",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"light",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"carousel_parent_id",storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"bloks_app_url",storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"should_have_sharing_friction",storageKey:null},P={alias:null,args:null,concreteType:"XDTSharingFrictionInfo",kind:"LinkedField",name:"sharing_friction_info",plural:!1,selections:[N,O],storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"preview",storageKey:null};I={alias:null,args:null,concreteType:"XDTLocationDict",kind:"LinkedField",name:"location",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"lat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lng",storageKey:null},I,m],storageKey:null};var R={alias:null,args:null,kind:"ScalarField",name:"has_audio",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"audio_type",storageKey:null},T={alias:null,args:null,concreteType:"XDTClipsAchievementsInfo",kind:"LinkedField",name:"achievements_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"show_achievements",storageKey:null}],storageKey:null},U={alias:null,args:null,kind:"ScalarField",name:"should_mute_audio",storageKey:null},V={alias:null,args:null,kind:"ScalarField",name:"should_mute_audio_reason",storageKey:null},W={alias:null,args:null,concreteType:"XDTMusicInfo",kind:"LinkedField",name:"music_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTMusicConsumptionInfoDict",kind:"LinkedField",name:"music_consumption_info",plural:!1,selections:[U,V],storageKey:null},{alias:null,args:null,concreteType:"XDTTrackData",kind:"LinkedField",name:"music_asset_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"display_artist",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_cluster_id",storageKey:null}],storageKey:null}],storageKey:null},X={alias:null,args:null,kind:"ScalarField",name:"original_audio_title",storageKey:null},Y={alias:null,args:null,kind:"ScalarField",name:"audio_asset_id",storageKey:null};V={alias:null,args:null,concreteType:"XDTOriginalSoundConsumptionInfo",kind:"LinkedField",name:"consumption_info",plural:!1,selections:[V,{alias:null,args:null,kind:"ScalarField",name:"should_mute_audio_reason_type",storageKey:null}],storageKey:null};var Z={alias:null,args:null,concreteType:"XDTClipsAppAttribution",kind:"LinkedField",name:"clips_attribution_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attribution_app_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attribution_app_name",storageKey:null},{alias:null,args:null,concreteType:"XDTClipsPivotPageHeader",kind:"LinkedField",name:"pivot_page_header",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"developer_app_logo_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"media_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content_url",storageKey:null}],storageKey:null}],storageKey:null};J={alias:null,args:null,concreteType:"XDTCommentDict",kind:"LinkedField",name:"caption",plural:!1,selections:[J],storageKey:null};z={alias:null,args:null,concreteType:"XDTRelationshipInfoDict",kind:"LinkedField",name:"friendship_status",plural:!1,selections:[z],storageKey:null};var $={alias:null,args:null,kind:"ScalarField",name:"main_feed_carousel_starting_media_id",storageKey:null},ba={alias:null,args:null,kind:"ScalarField",name:"has_liked",storageKey:null},ca={alias:null,args:null,kind:"ScalarField",name:"commenting_disabled_for_viewer",storageKey:null},da={alias:null,args:null,kind:"ScalarField",name:"comment_count",storageKey:null},ea={alias:null,args:null,kind:"ScalarField",name:"media_level_comment_controls",storageKey:null},fa={alias:null,args:null,kind:"ScalarField",name:"ig_media_sharing_disabled",storageKey:null},ga={alias:null,args:null,kind:"ScalarField",name:"audience",storageKey:null},ha={alias:null,args:null,kind:"ScalarField",name:"visibility",storageKey:null},ia={alias:null,args:null,kind:"ScalarField",name:"photo_of_you",storageKey:null},ja={alias:null,args:null,kind:"ScalarField",name:"carousel_media_count",storageKey:null},ka={alias:null,args:null,kind:"ScalarField",name:"view_count",storageKey:null},la={alias:null,args:null,kind:"ScalarField",name:"like_count",storageKey:null},ma={alias:null,args:null,kind:"ScalarField",name:"logging_info_token",storageKey:null};O={alias:null,args:null,concreteType:"XDTSharingFrictionInfo",kind:"LinkedField",name:"sharing_friction_info",plural:!1,selections:[O,N],storageKey:null};N={alias:null,args:null,concreteType:"XDTUserTagInfosDict",kind:"LinkedField",name:"usertags",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTUserTagInfoDict",kind:"LinkedField",name:"in",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"user",plural:!1,selections:[d,r,n,m,y,e],storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PolarisPostActionLoadPostQueryMediaIdQuery",selections:[{alias:null,args:b,concreteType:"XDTMediaInfoListResponse",kind:"LinkedField",name:"xdt_api__v1__media__media_id_web_info",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"PolarisPostActionLoadPostQueryInlineMediaFragment",selections:[{alias:null,args:null,concreteType:"XDTMediaDict",kind:"LinkedField",name:"items",plural:!0,selections:[c,d,e,f,g,h,l,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"facepile_top_likers",plural:!0,selections:[m,d,n],storageKey:null},o,p,q,k,j,{alias:null,args:null,concreteType:"XDTSponsorTag",kind:"LinkedField",name:"sponsor_tags",plural:!0,selections:[i,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"sponsor",plural:!1,selections:[d,n,m,r,s],storageKey:null}],storageKey:null},t,u,v,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"user",plural:!1,selections:[d,n,m,w,x,s,y,A,B],storageKey:null},C,D,E,F,G,H,K,{alias:null,args:null,concreteType:"XDTMediaDict",kind:"LinkedField",name:"carousel_media",plural:!0,selections:[e,d,L,o,q,t,u,k,M,P,Q,v,l,K,H],storageKey:null},I,R,{alias:null,args:null,concreteType:"XDTClipsMetadataDict",kind:"LinkedField",name:"clips_metadata",plural:!1,selections:[S,T,W,{alias:null,args:null,concreteType:"XDTOriginalSoundData",kind:"LinkedField",name:"original_sound_info",plural:!1,selections:[X,U,Y,V,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"ig_artist",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null},Z,J,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"owner",plural:!1,selections:[d,n,r,m,w,s,z],storageKey:null},$,ba,ca,da,ea,fa,ga,ha,ia,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"invited_coauthor_producers",plural:!0,selections:[d],storageKey:null},ja,ka,la,ma,O],storageKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PolarisPostActionLoadPostQueryMediaIdQuery",selections:[{alias:null,args:b,concreteType:"XDTMediaInfoListResponse",kind:"LinkedField",name:"xdt_api__v1__media__media_id_web_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTMediaDict",kind:"LinkedField",name:"items",plural:!0,selections:[c,d,e,f,g,h,l,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"facepile_top_likers",plural:!0,selections:[m,d,n,e],storageKey:null},o,p,q,k,j,{alias:null,args:null,concreteType:"XDTSponsorTag",kind:"LinkedField",name:"sponsor_tags",plural:!0,selections:[i,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"sponsor",plural:!1,selections:[d,n,m,r,s,e],storageKey:null}],storageKey:null},t,u,v,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"user",plural:!1,selections:[d,n,m,w,x,s,y,A,B,e],storageKey:null},C,D,E,F,G,N,K,{alias:null,args:null,concreteType:"XDTMediaDict",kind:"LinkedField",name:"carousel_media",plural:!0,selections:[e,d,L,o,q,t,u,k,M,P,Q,v,l,K,N],storageKey:null},I,R,{alias:null,args:null,concreteType:"XDTClipsMetadataDict",kind:"LinkedField",name:"clips_metadata",plural:!1,selections:[S,T,W,{alias:null,args:null,concreteType:"XDTOriginalSoundData",kind:"LinkedField",name:"original_sound_info",plural:!1,selections:[X,U,Y,V,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"ig_artist",plural:!1,selections:[n,e],storageKey:null}],storageKey:null}],storageKey:null},Z,J,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"owner",plural:!1,selections:[d,n,r,m,w,s,z,e],storageKey:null},$,ba,ca,da,ea,fa,ga,ha,ia,{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"invited_coauthor_producers",plural:!0,selections:[d,e],storageKey:null},ja,ka,la,ma,O],storageKey:null}],storageKey:null}]},params:{id:aa("PolarisPostActionLoadPostQueryMediaIdQuery_instagramRelayOperation"),metadata:{is_distillery:!0},name:"PolarisPostActionLoadPostQueryMediaIdQuery",operationKind:"query",text:null}}}();d.exports=a}),null);
__d("PolarisPostActionLoadPostQueryQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8845758582119845"}),null);
__d("PolarisPostActionLoadPostQueryQuery.graphql",["PolarisPostActionLoadPostQueryQuery_instagramRelayOperation"],(function(a,aa,b,c,d,e){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"fetch_tagged_user_count"},b={defaultValue:null,kind:"LocalArgument",name:"hoisted_comment_id"},c={defaultValue:null,kind:"LocalArgument",name:"hoisted_reply_id"},d={defaultValue:null,kind:"LocalArgument",name:"shortcode"},e=[{kind:"Variable",name:"shortcode",variableName:"shortcode"}],f={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"shortcode",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"thumbnail_src",storageKey:null},j={alias:null,args:null,concreteType:"XDTGraphMediaDimensions",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"misinformation_type",storageKey:null},n={alias:null,args:null,concreteType:"XDTGraphMediaGatingInfo",kind:"LinkedField",name:"gating_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"buttons",storageKey:null},k,{alias:null,args:null,kind:"ScalarField",name:"gating_type",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"center_button",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"post_reveal_cta",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"time_gated",storageKey:null},m],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"fact_check_overall_rating",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"profile_pic_url",storageKey:null},r={alias:null,args:null,concreteType:"XDTGraphMediaFactCheck",kind:"LinkedField",name:"fact_check_information",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},{alias:null,args:null,concreteType:"XDTGraphMediaFactCheckProvider",kind:"LinkedField",name:"provider",plural:!1,selections:[p,q,{alias:null,args:null,kind:"ScalarField",name:"appeal_email",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_directly_rated",storageKey:null}],storageKey:null},s={alias:null,args:null,concreteType:"XDTGraphMediaSensitivityFrictionInfo",kind:"LinkedField",name:"sensitivity_friction_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"sensitivity_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_subtitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_primary_button",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"share_friction_secondary_button",storageKey:null}],storageKey:null},t={alias:null,args:null,concreteType:"XDTGraphMediaSharingFrictionInfo",kind:"LinkedField",name:"sharing_friction_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"should_have_sharing_friction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"bloks_app_url",storageKey:null}],storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},w={alias:null,args:null,concreteType:"XDTGraphMediaOverlayIconSpec",kind:"LinkedField",name:"icon",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"icon_glyph",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icon_type",storageKey:null},p,v],storageKey:null},x=[{alias:null,args:null,kind:"ScalarField",name:"button_type",storageKey:null},u,{alias:null,args:null,kind:"ScalarField",name:"secondary_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action_url",storageKey:null},w,{alias:null,args:null,concreteType:"XDTGraphMediaOverlayTextColorSpec",kind:"LinkedField",name:"text_color",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"light",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dark",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_text_centered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_chevron",storageKey:null}];x={alias:null,args:null,concreteType:"XDTGraphMediaOverlayInfo",kind:"LinkedField",name:"media_overlay_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaOverlayButtonSpec",kind:"LinkedField",name:"banner",plural:!1,selections:x,storageKey:null},{alias:null,args:null,concreteType:"XDTGraphMediaOverlayButtonSpec",kind:"LinkedField",name:"buttons",plural:!0,selections:x,storageKey:null},k,w,m,{alias:null,args:null,kind:"ScalarField",name:"overlay_layout",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"overlay_type",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"bloks_data",storageKey:null}],storageKey:null};k={alias:null,args:null,kind:"ScalarField",name:"media_preview",storageKey:null};w={alias:null,args:null,kind:"ScalarField",name:"display_url",storageKey:null};m={alias:null,args:null,concreteType:"XDTGraphImageResource",kind:"LinkedField",name:"display_resources",plural:!0,selections:[v,{alias:null,args:null,kind:"ScalarField",name:"config_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"config_height",storageKey:null}],storageKey:null};v={alias:null,args:null,kind:"ScalarField",name:"is_video",storageKey:null};var y={alias:null,args:null,kind:"ScalarField",name:"tracking_token",storageKey:null},z={alias:null,args:null,concreteType:"XDTGraphUpcomingEventDict",kind:"LinkedField",name:"upcoming_event",plural:!1,selections:[g,l,{alias:null,args:null,kind:"ScalarField",name:"start_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reminder_enabled",storageKey:null}],storageKey:null},A=[{kind:"Variable",name:"first",variableName:"fetch_tagged_user_count"}],B={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"followed_by_viewer",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"is_verified",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},F={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"user",plural:!1,selections:[B,C,g,D,q,E],storageKey:null},G={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},H={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},I={alias:null,args:A,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user_connection",kind:"LinkedField",name:"edge_media_to_tagged_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphTaggedUser",kind:"LinkedField",name:"node",plural:!1,selections:[F,G,H],storageKey:null}],storageKey:null}],storageKey:null},J={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},K=[J];C={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"owner",plural:!1,selections:[g,E,D,q,{alias:null,args:null,kind:"ScalarField",name:"blocked_by_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"restricted_by_viewer",storageKey:null},C,B,{alias:null,args:null,kind:"ScalarField",name:"has_blocked_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_embeds_disabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_private",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_unpublished",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"requested_by_viewer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pass_tiering_recommendation",storageKey:null},{alias:null,args:null,concreteType:"XDTgraphuser_edge_owner_to_timeline_media_connection",kind:"LinkedField",name:"edge_owner_to_timeline_media",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"XDTgraphuser_edge_followed_by_connection",kind:"LinkedField",name:"edge_followed_by",plural:!1,selections:K,storageKey:null}],storageKey:null};B=[{kind:"Literal",name:"first",value:1}];var L={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"can_see_insights_as_brand",storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"caption_is_edited",storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"has_ranked_comments",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"like_and_view_counts_disabled",storageKey:null},Q={alias:null,args:null,concreteType:"XDTPageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_cursor",storageKey:null}],storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"did_report_as_spam",storageKey:null};D=[g,D,q,E];q={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"owner",plural:!1,selections:D,storageKey:null};var S={alias:null,args:null,kind:"ScalarField",name:"viewer_has_liked",storageKey:null};K={alias:null,args:null,concreteType:"XDTgraphcomment_edge_liked_by_connection",kind:"LinkedField",name:"edge_liked_by",plural:!1,selections:K,storageKey:null};var T={alias:null,args:null,kind:"ScalarField",name:"is_restricted_pending",storageKey:null},U=[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[g,u,L,R,q,S,K,T],storageKey:null}],V={alias:null,args:[{kind:"Literal",name:"first",value:3}],concreteType:"XDTgraphcomment_edge_threaded_comments_connection",kind:"LinkedField",name:"edge_threaded_comments",plural:!1,selections:[J,Q,{alias:null,args:null,concreteType:"XDTgraphcomment_edge_threaded_comments",kind:"LinkedField",name:"edges",plural:!0,selections:U,storageKey:null}],storageKey:"edge_threaded_comments(first:3)"};Q={alias:null,args:[{kind:"Literal",name:"first",value:24}],concreteType:"XDTgraphmediainterface_edge_media_to_parent_comment_connection",kind:"LinkedField",name:"edge_media_to_parent_comment",plural:!1,selections:[J,Q,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_parent_comment",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[g,u,L,R,q,S,K,T,V],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_parent_comment(first:24)"};R={alias:null,args:[{kind:"Variable",name:"hoisted_comment_id",variableName:"hoisted_comment_id"}],concreteType:"XDTgraphmediainterface_edge_media_to_hoisted_comment_connection",kind:"LinkedField",name:"edge_media_to_hoisted_comment",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_hoisted_comment",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphComment",kind:"LinkedField",name:"node",plural:!1,selections:[g,u,L,R,q,S,K,T,{alias:null,args:[{kind:"Variable",name:"hoisted_reply_id",variableName:"hoisted_reply_id"}],concreteType:"XDTgraphcomment_edge_comment_to_hoisted_reply_connection",kind:"LinkedField",name:"edge_comment_to_hoisted_reply",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphcomment_edge_comment_to_hoisted_reply",kind:"LinkedField",name:"edges",plural:!0,selections:U,storageKey:null}],storageKey:null},V],storageKey:null}],storageKey:null}],storageKey:null};q={alias:null,args:[{kind:"Literal",name:"first",value:2}],concreteType:"XDTgraphmediainterface_edge_media_preview_comment_connection",kind:"LinkedField",name:"edge_media_preview_comment",plural:!1,selections:[J,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_comment",kind:"LinkedField",name:"edges",plural:!0,selections:U,storageKey:null}],storageKey:"edge_media_preview_comment(first:2)"};K={alias:null,args:null,kind:"ScalarField",name:"comments_disabled",storageKey:null};T={alias:null,args:null,kind:"ScalarField",name:"commenting_disabled_for_viewer",storageKey:null};V={alias:null,args:null,kind:"ScalarField",name:"taken_at_timestamp",storageKey:null};U={alias:null,args:[{kind:"Literal",name:"first",value:10}],concreteType:"XDTgraphmediainterface_edge_media_preview_like_connection",kind:"LinkedField",name:"edge_media_preview_like",plural:!1,selections:[J,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_preview_like",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"node",plural:!1,selections:D,storageKey:null}],storageKey:null}],storageKey:"edge_media_preview_like(first:10)"};J={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"sponsor",plural:!1,selections:[g,E],storageKey:null};E={alias:null,args:null,kind:"ScalarField",name:"is_affiliate",storageKey:null};var W={alias:null,args:null,kind:"ScalarField",name:"is_paid_partnership",storageKey:null};p={alias:null,args:null,concreteType:"XDTGraphLocation",kind:"LinkedField",name:"location",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"has_public_page",storageKey:null},p,{alias:null,args:null,kind:"ScalarField",name:"slug",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"address_json",storageKey:null}],storageKey:null};var ba={alias:null,args:null,concreteType:"XDTGraphNftAssetInfoType",kind:"LinkedField",name:"nft_asset_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"asset_id",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"shimmer_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator_username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator_igid",storageKey:null}],storageKey:null},ca={alias:null,args:null,kind:"ScalarField",name:"viewer_has_saved",storageKey:null},da={alias:null,args:null,kind:"ScalarField",name:"viewer_has_saved_to_collection",storageKey:null},ea={alias:null,args:null,kind:"ScalarField",name:"viewer_in_photo_of_you",storageKey:null},fa={alias:null,args:null,kind:"ScalarField",name:"viewer_can_reshare",storageKey:null},ga={alias:null,args:null,kind:"ScalarField",name:"is_ad",storageKey:null},ha={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"coauthor_producers",plural:!0,selections:D,storageKey:null};D={alias:null,args:null,concreteType:"XDTGraphUser",kind:"LinkedField",name:"pinned_for_users",plural:!0,selections:D,storageKey:null};var X={alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},Y={alias:null,args:null,concreteType:"XDTGraphDashInfo",kind:"LinkedField",name:"dash_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_dash_eligible",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"video_dash_manifest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"number_of_qualities",storageKey:null}],storageKey:null},Z={alias:null,args:null,kind:"ScalarField",name:"has_audio",storageKey:null},ia={alias:null,args:null,kind:"ScalarField",name:"video_url",storageKey:null},ja={alias:null,args:null,kind:"ScalarField",name:"video_view_count",storageKey:null},ka={alias:null,args:null,kind:"ScalarField",name:"video_play_count",storageKey:null};l={kind:"InlineFragment",selections:[X,Y,Z,ia,ja,ka,{alias:null,args:null,kind:"ScalarField",name:"encoding_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_published",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_type",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"video_duration",storageKey:null},{alias:null,args:null,concreteType:"XDTGraphClipsMusicAttributionInfo",kind:"LinkedField",name:"clips_music_attribution_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"artist_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"song_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uses_original_audio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_mute_audio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_mute_audio_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_id",storageKey:null}],storageKey:null}],type:"XDTGraphVideo",abstractKey:null};var $={kind:"InlineFragment",selections:[X],type:"XDTGraphImage",abstractKey:null};Y={kind:"InlineFragment",selections:[X,Y,Z,ia,ja,ka],type:"XDTGraphVideo",abstractKey:null};Z={alias:null,args:A,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user_connection",kind:"LinkedField",name:"edge_media_to_tagged_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_tagged_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphTaggedUser",kind:"LinkedField",name:"node",plural:!1,selections:[F,G,H,g],storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[a,b,c,d],kind:"Fragment",metadata:null,name:"PolarisPostActionLoadPostQueryQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"xdt_shortcode_media",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"PolarisPostActionLoadPostQueryInlineFragmentWithoutRelatedProfiles",selections:[f,g,h,i,j,n,o,r,s,t,x,k,w,m,v,y,z,I,C,{alias:null,args:B,concreteType:"XDTgraphmediainterface_edge_media_to_caption_connection",kind:"LinkedField",name:"edge_media_to_caption",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_caption",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaCaption",kind:"LinkedField",name:"node",plural:!1,selections:[L,u],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_caption(first:1)"},M,N,O,P,Q,R,q,K,T,V,U,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user_connection",kind:"LinkedField",name:"edge_media_to_sponsor_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphSponsorTag",kind:"LinkedField",name:"node",plural:!1,selections:[J],storageKey:null}],storageKey:null}],storageKey:null},E,W,p,ba,S,ca,da,ea,fa,ga,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media_connection",kind:"LinkedField",name:"edge_web_media_to_related_media",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,i],storageKey:null}],storageKey:null}],storageKey:null},ha,D,l,$,{kind:"InlineFragment",selections:[X,{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children_connection",kind:"LinkedField",name:"edge_sidecar_to_children",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,g,h,j,n,o,r,s,t,x,k,w,m,Y,$,v,y,z,I],storageKey:null}],storageKey:null}],storageKey:null}],type:"XDTGraphSidecar",abstractKey:null}],args:null,argumentDefinitions:[{kind:"RootArgument",name:"fetch_tagged_user_count"},{kind:"RootArgument",name:"hoisted_comment_id"},{kind:"RootArgument",name:"hoisted_reply_id"}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[d,a,b,c],kind:"Operation",name:"PolarisPostActionLoadPostQueryQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"xdt_shortcode_media",plural:!1,selections:[f,{kind:"TypeDiscriminator",abstractKey:"__isXDTGraphMediaInterface"},g,h,i,j,n,o,r,s,t,x,k,w,m,v,y,z,Z,C,{alias:null,args:B,concreteType:"XDTgraphmediainterface_edge_media_to_caption_connection",kind:"LinkedField",name:"edge_media_to_caption",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_caption",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphMediaCaption",kind:"LinkedField",name:"node",plural:!1,selections:[L,u,g],storageKey:null}],storageKey:null}],storageKey:"edge_media_to_caption(first:1)"},M,N,O,P,Q,R,q,K,T,V,U,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user_connection",kind:"LinkedField",name:"edge_media_to_sponsor_user",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_media_to_sponsor_user",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XDTGraphSponsorTag",kind:"LinkedField",name:"node",plural:!1,selections:[J,g],storageKey:null}],storageKey:null}],storageKey:null},E,W,p,ba,S,ca,da,ea,fa,ga,{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media_connection",kind:"LinkedField",name:"edge_web_media_to_related_media",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphmediainterface_edge_web_media_to_related_media",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,h,i,g],storageKey:null}],storageKey:null}],storageKey:null},ha,D,l,$,{kind:"InlineFragment",selections:[X,{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children_connection",kind:"LinkedField",name:"edge_sidecar_to_children",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTgraphsidecar_edge_sidecar_to_children",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,g,h,j,n,o,r,s,t,x,k,w,m,Y,$,v,y,z,Z],storageKey:null}],storageKey:null}],storageKey:null}],type:"XDTGraphSidecar",abstractKey:null}],storageKey:null}]},params:{id:aa("PolarisPostActionLoadPostQueryQuery_instagramRelayOperation"),metadata:{is_distillery:!0},name:"PolarisPostActionLoadPostQueryQuery",operationKind:"query",text:null}}}();d.exports=a}),null);
__d("PolarisPostActionLoadPostQuerySharerQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="25621259580853638"}),null);
__d("PolarisPostActionLoadPostQuerySharerQuery.graphql",["PolarisPostActionLoadPostQuerySharerQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"shid"}],c=[{kind:"Variable",name:"shid",variableName:"shid"}],d={alias:null,args:null,kind:"ScalarField",name:"profile_pic_url",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PolarisPostActionLoadPostQuerySharerQuery",selections:[{alias:null,args:c,concreteType:"XDTShidUserResponse",kind:"LinkedField",name:"xdt_get_relationship_for_shid_logged_out",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"PolarisPostActionLoadPostQueryInlineSharerFragment",selections:[{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"sender",plural:!1,selections:[d,e,f],storageKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PolarisPostActionLoadPostQuerySharerQuery",selections:[{alias:null,args:c,concreteType:"XDTShidUserResponse",kind:"LinkedField",name:"xdt_get_relationship_for_shid_logged_out",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTUserDict",kind:"LinkedField",name:"sender",plural:!1,selections:[d,e,f,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("PolarisPostActionLoadPostQuerySharerQuery_instagramRelayOperation"),metadata:{is_distillery:!0},name:"PolarisPostActionLoadPostQuerySharerQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PolarisPostActionLoadPostQuery",["PolarisPostActionLoadPostQueryInlineFragment.graphql","PolarisPostActionLoadPostQueryInlineFragmentWithoutRelatedProfiles.graphql","PolarisPostActionLoadPostQueryInlineMediaFragment.graphql","PolarisPostActionLoadPostQueryInlineSharerFragment.graphql","PolarisPostActionLoadPostQueryLegacyQuery.graphql","PolarisPostActionLoadPostQueryMediaIdQuery.graphql","PolarisPostActionLoadPostQueryQuery.graphql","PolarisPostActionLoadPostQuerySharerQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o;a=h!==void 0?h:h=b("PolarisPostActionLoadPostQueryInlineMediaFragment.graphql");c=i!==void 0?i:i=b("PolarisPostActionLoadPostQueryInlineFragment.graphql");d=j!==void 0?j:j=b("PolarisPostActionLoadPostQueryInlineFragmentWithoutRelatedProfiles.graphql");e=k!==void 0?k:k=b("PolarisPostActionLoadPostQueryInlineSharerFragment.graphql");f=l!==void 0?l:l=b("PolarisPostActionLoadPostQueryQuery.graphql");var p=m!==void 0?m:m=b("PolarisPostActionLoadPostQueryLegacyQuery.graphql"),q=n!==void 0?n:n=b("PolarisPostActionLoadPostQueryMediaIdQuery.graphql");b=o!==void 0?o:o=b("PolarisPostActionLoadPostQuerySharerQuery.graphql");g.MEDIA_INLINE_FRAGMENT=a;g.INLINE_FRAGMENT=c;g.INLINE_FRAGMENT_WITHOUT_RELATED_PROFILES=d;g.SHARER_INLINE_FRAGMENT=e;g.POST_QUERY=f;g.POST_QUERY_LEGACY=p;g.POST_QUERY_MEDIA_ID=q;g.POST_SHARER_INFORMATION=b}),98);
__d("PolarisPostActionPostPageLoaded",["nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{postData:c("nullthrows")(a.shortcode_media),type:"POST_PAGE_LOADED"}}g.postPageLoaded=a}),98);
__d("PolarisPostActionLoadPost",["CometRelay","FBLogger","PolarisAdsActions","PolarisConfig","PolarisInstapi","PolarisPostActionLoadPostQuery","PolarisPostActionPostLoadedV2","PolarisPostActionPostPageLoaded","PolarisRelayEnvironment","PolarisSenderNameOnReelsQEHelpers","PolarisThreadedCommentActions","asyncToGeneratorRuntime","err","getPolarisPostIdFromNativeId","isTruthy","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("CometRelay").fetchQuery(c("PolarisRelayEnvironment"),d("PolarisPostActionLoadPostQuery").POST_SHARER_INFORMATION,{shid:a}).toPromise());if(a==null||a.xdt_get_relationship_for_shid_logged_out==null)return null;a=d("CometRelay").readInlineData(d("PolarisPostActionLoadPostQuery").SHARER_INLINE_FRAGMENT,a.xdt_get_relationship_for_shid_logged_out);return a});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("CometRelay").fetchQuery(c("PolarisRelayEnvironment"),d("PolarisPostActionLoadPostQuery").POST_QUERY_MEDIA_ID,{mediaId:a}).toPromise());if(a==null)throw c("err")("Post modal response is unexpectedly null");a=d("CometRelay").readInlineData(d("PolarisPostActionLoadPostQuery").MEDIA_INLINE_FRAGMENT,a==null?void 0:a.xdt_api__v1__media__media_id_web_info);return a.items!=null?[].concat(a.items):null});return k.apply(this,arguments)}function l(a){return a.split("_").length>1}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("PolarisInstapi").apiGet("/api/v1/media/{media_id}/info/",{path:{media_id:a},query:{}}));a=a.data;return a.items!=null?[].concat(a.items):null});return n.apply(this,arguments)}function a(a,e,f,g,i){f===void 0&&(f=!1);return function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,k){b({shortcode:a,type:"POST_PAGE_LOADING"});if(e!=null&&d("PolarisConfig").isLoggedIn())try{b(d("PolarisThreadedCommentActions").requestInitialComments(c("getPolarisPostIdFromNativeId")(e)));var n=l(e)?yield j(e):yield m(e);if(n!=null){var o=n[0];k=new Set(k().ads.feed.keys());o!=null&&o.ad_id!=null?b(d("PolarisAdsActions").adMediaInfoLoaded(n[0],a)):b(d("PolarisPostActionPostLoadedV2").postLoadedV2(n,a,k))}}catch(a){c("FBLogger")("ig_web").catching(a)}else{o=f?d("PolarisPostActionLoadPostQuery").POST_QUERY:d("PolarisPostActionLoadPostQuery").POST_QUERY_LEGACY;try{if(i!=null&&d("PolarisSenderNameOnReelsQEHelpers").shouldShowSenderNameOnReels()){n=(yield h(i));n!=null&&b({fullName:n.sender.full_name,profilePicUrl:n.sender.profile_pic_url,sharedPostId:e,type:"UPDATE_SHARER_INFORMATION",username:n.sender.username})}k=(yield d("CometRelay").fetchQuery(c("PolarisRelayEnvironment"),o,{shortcode:a}).toPromise());f?n=d("CometRelay").readInlineData(d("PolarisPostActionLoadPostQuery").INLINE_FRAGMENT_WITHOUT_RELATED_PROFILES,k==null?void 0:k.xdt_shortcode_media):n=d("CometRelay").readInlineData(d("PolarisPostActionLoadPostQuery").INLINE_FRAGMENT,k==null?void 0:k.xdt_shortcode_media);o=n.accessibility_caption==null&&c("isTruthy")(g);o&&(n=babelHelpers["extends"]({},n,{accessibility_caption:g}));b(d("PolarisPostActionPostPageLoaded").postPageLoaded({shortcode_media:c("nullthrows")(n)}))}catch(a){c("FBLogger")("ig_web").catching(a).mustfix("unexpected")}}});return function(a,b){return k.apply(this,arguments)}}()}g.loadPost=a}),98);/*FB_PKG_DELIM*/
__d("IGDAWBundleResource",["IGDAWMainWebWorkerResource"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("IGDAWMainWebWorkerResource")}),98);
__d("LSSetIGE2EEEligibility",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.filter(c.db.table(176).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.contactId,a[0])&&c.i64.eq(b.e2eeEligibility,a[1])}).next().then(function(e,f){f=e.done;e=e.value;return f?(d[1]=new c.Map(),d[1].set("contact_id",a[0]),d[1].set("new_eligibility",a[1]),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"ig_set_e2ee_eligibility",c.i64.cast([0,60001]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):(e.item,0)})},function(a){return c.resolve(e)}])}a.__sproc_name__="LSContactSetIGE2EEEligibilityStoredProcedure";e.exports=a}),null);
__d("LSSetIGE2EEEligibilityStoredProcedure",["LSSetIGE2EEEligibility","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.id;d[1]=b.e2eeEligibility;return c("LSSetIGE2EEEligibility").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("IGDSetIGE2EEEligibility",["I64","LSDatabaseSingleton","LSFactory","LSInstagramE2EEEligibility","LSIntEnum","LSSetIGE2EEEligibilityStoredProcedure","MAWCurrentUser","asyncToGeneratorRuntime","justknobx","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;e=h||d("react");var l=e.useEffect,m=e.c;function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return e.runInTransaction(function(e){return c("LSSetIGE2EEEligibilityStoredProcedure")(c("LSFactory")(e),{e2eeEligibility:(j||(j=d("LSIntEnum"))).ofNumber(b),id:(k||(k=d("I64"))).of_string(a)})},"readwrite",void 0,void 0,f.id+":31")});return o.apply(this,arguments)}function a(){var a=m(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=[],a[0]=b):b=a[0];l(p,b)}function p(){if(c("justknobx")._("2058"))return;var a=d("MAWCurrentUser").getID();c("promiseDone")(n(a,c("LSInstagramE2EEEligibility").ELIGIBLE))}g.useUpsertSetIGE2EEEligibilityOnMount=a}),98);
__d("LSPlatformGraphQLLightspeedRequestQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"deviceId"},{defaultValue:null,kind:"LocalArgument",name:"requestId"},{defaultValue:null,kind:"LocalArgument",name:"requestPayload"},{defaultValue:null,kind:"LocalArgument",name:"requestType"}],b=[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"device_id",variableName:"deviceId"},{kind:"Variable",name:"request_id",variableName:"requestId"},{kind:"Variable",name:"request_payload",variableName:"requestPayload"},{kind:"Variable",name:"request_type",variableName:"requestType"}],concreteType:"LightspeedWebResponse",kind:"LinkedField",name:"lightspeed_web_request",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"payload",storageKey:null},{alias:null,args:null,concreteType:"LightspeedWebRequestDependency",kind:"LinkedField",name:"dependencies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experiments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"target",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LSPlatformGraphQLLightspeedRequestQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LSPlatformGraphQLLightspeedRequestQuery",selections:b},params:{id:"9944623912245126",metadata:{},name:"LSPlatformGraphQLLightspeedRequestQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("LSPlatformGraphQLLightspeedRequestQuery",["LSPlatformGraphQLLightspeedRequestQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("LSPlatformGraphQLLightspeedRequestQuery.graphql");g.query=a}),98);
__d("LSPlatformGraphQLLightspeedRequest",["CometRelay","LSPlatformGraphQLLightspeedRequestQuery","XPlatRelayEnvironment"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){return d("CometRelay").fetchQuery(d("XPlatRelayEnvironment").getRelayEnvironment(),d("LSPlatformGraphQLLightspeedRequestQuery").query,{deviceId:a,requestId:b,requestPayload:c,requestType:e}).toPromise().then(function(a){a=a==null?void 0:(a=a.viewer)==null?void 0:a.lightspeed_web_request;if(a!=null)return babelHelpers["extends"]({dependencies:void 0},a)})}g["default"]=a}),98);
__d("MAWAbPropsClient",["WAAbPropsToUI"],(function(a,b,c,d,e,f,g){"use strict";var h={contents:d("WAAbPropsToUI").prepareAbPropsForUI()};function a(a){h.contents=a}function b(){return h.contents}g.rewrite=a;g.getAbProps=b}),98);
__d("WAChatState",[],(function(a,b,c,d,e,f){"use strict";a="typing";b="recording_audio";c="idle";d={TYPING:a,RECORDING_AUDIO:b};e={IDLE:c};f.TYPING=a;f.RECORDING_AUDIO=b;f.IDLE=c;f.ACTIVE_CHAT_STATE_TYPE=d;f.IDLE_CHAT_STATE_TYPE=e}),66);
__d("MAWBridgeReceivedChatStateHandler",["I64","MAWMiActOnMiThreadReadyForJid","Promise","ServerTime","WAChatState","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeReceivedChatStateHandler",function(a,f){var g=(i||(i=d("I64"))).of_string(e.senderId),j=i.of_float(3e3+d("ServerTime").getMillis());if(e.state===d("WAChatState").TYPING)return a.typing_indicator.upsert([f,g],{expirationTimestampMs:j,senderId:g,threadKey:f}).then(c("emptyFunction"));else if(e.state===d("WAChatState").IDLE)return a.typing_indicator["delete"](f,g).then(c("emptyFunction"));else return(h||(h=b("Promise"))).resolve()})}g.call=a}),98);
__d("MAWFTSRawStringMatcher",["JSResourceForInteraction","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("WAFtsMultiLangTokenizer").__setRef("MAWFTSRawStringMatcher"),i=null;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i=(yield h.load());return l});return j.apply(this,arguments)}function k(a){return new(c("nullthrows")(i))().tokenize(a)}function l(a,b){a=Array.from(k(a)).filter(function(a){return a.length>1});if(a.length===0)return!1;var c=Array.from(k(b));return a.every(function(a){return c.some(function(b){return b.startsWith(a)})})}g.load=a}),98);
__d("LSThreadPointQueryAndRestoreMessagesWithGroupJID",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[1]=d[0].get("wa_jid"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,1021]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxThreadPointQueryAndRestoreMessagesWithGroupJIDStoredProcedure";e.exports=a}),null);
__d("LSThreadPointQueryAndRestoreMessagesWithGroupJIDStoredProcedure",["LSThreadPointQueryAndRestoreMessagesWithGroupJID","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.waJid;return c("LSThreadPointQueryAndRestoreMessagesWithGroupJID").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSThreadPointQueryAndRestoreMessagesWithJID",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[1]=d[0].get("wa_jid"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,556]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure";e.exports=a}),null);
__d("LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure",["LSThreadPointQueryAndRestoreMessagesWithJID","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.waJid;return c("LSThreadPointQueryAndRestoreMessagesWithJID").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("waitForMiActMappingForUniversalSearch",["FBLogger","I64","LSAuthorityLevel","LSFactory","LSThreadPointQueryAndRestoreMessagesWithGroupJIDStoredProcedure","LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure","MAWCurrentUser","Promise","ReQL","WAJids","asyncToGeneratorRuntime","emptyFunction","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=3e4,k=3e4;function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("ReQL").toArrayAsync(a));return a.some(function(a){return a==null||(i||(i=d("I64"))).lt(a.authorityLevel,(i||(i=d("I64"))).of_int32(c("LSAuthorityLevel").AUTHORITATIVE))})===!1});return m.apply(this,arguments)}function n(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){f===void 0&&(f=c("emptyFunction"));g===void 0&&(g=c("emptyFunction"));var h=(i||(i=d("I64"))).of_string(d("MAWCurrentUser").getID()),j=d("ReQL").leftJoin(d("ReQL").fromTableAscending(a.tables.participants,["contactId"]).getKeyRange(e.serverThreadKey).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,h)}),d("ReQL").fromTableAscending(a.tables.contacts)).map(function(a){a[0];a=a[1];return a}),m=null,n={contents:function(){}};function o(){f(e),n.contents()}if(yield l(j))return o();n.contents=j.subscribe(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.operation==="delete")return;m!=null&&window.clearTimeout(m);if(yield l(j))return o()});return function(b,c){return a.apply(this,arguments)}}());m=window.setTimeout(function(){n.contents(),g(c("err")("Contacts timed out"))},k)});return o.apply(this,arguments)}function a(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var g=(i||(i=d("I64"))).of_string(d("WAJids").threadIdForChatJid(e)),k=d("WAJids").interpretAsGroupJid(e)!=null,l=d("ReQL").fromTableAscending(a.tables.mi_act_mapping_table.index("jid")).getKeyRange(g);e=(yield d("ReQL").firstAsync(l));if(e!=null){yield n(a,e);return(h||(h=b("Promise"))).resolve(e)}var m=null,o=new(h||(h=b("Promise")))(function(d,e){var f={contents:function(){}};function g(a){f.contents(),d(a)}function h(a){f.contents(),e(a)}f.contents=l.subscribe(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){if(c.operation==="delete")return;m!=null&&window.clearTimeout(m);yield n(a,c.value,g,h)});return function(a,b){return c.apply(this,arguments)}}());m=window.setTimeout(function(){h(c("err")("MiActMapping timed out"))},j)});c("promiseDone")(a.runInTransaction(function(a){return k?c("LSThreadPointQueryAndRestoreMessagesWithGroupJIDStoredProcedure")(c("LSFactory")(a),{waJid:g}):c("LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure")(c("LSFactory")(a),{waJid:g})},"readwrite",void 0,void 0,f.id+":148"));try{e=(yield o)}catch(a){c("FBLogger")("mw_message_search").warn("Issue waiting for mi_act_mapping to be ready",a)}return e});return p.apply(this,arguments)}g["default"]=a}),98);
__d("MAWBridgeAddMessageSearchResultHandler",["I64","JSResourceForInteraction","LSIntEnum","LSMessageSearchType","MAWCurrentUser","MAWFTSRawStringMatcher","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime","emptyFunction","isMAWUniversalSearchWithEBEnabled","waitForMiActMappingForUniversalSearch"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("JSResourceForInteraction")("MWInboxSecureContentSearch").__setRef("MAWBridgeAddMessageSearchResultHandler"),l=c("JSResourceForInteraction")("addMAWBridgeSearchMessagesToUniversalSearch").__setRef("MAWBridgeAddMessageSearchResultHandler"),m=(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageSearchType").MESSAGE),n=j.ofNumber(c("LSMessageSearchType").THREAD);function a(a,d,e){return e.length===0?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).all([q(a,d,e),s(a,d,e)]).then(c("emptyFunction"))}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("MAWFTSRawStringMatcher").load());return b.filter(function(b){b=(b=b.msg)==null?void 0:b.content;return b==null?!1:c(a,b)})});return p.apply(this,arguments)}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(e.message_search_queries).getKeyRange(m)));if(g.length===0)return;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(e,f[0].chatJid,"MAWBridgeAddMessageSearchResultHandler",function(e,h){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=g.filter(function(a){return(i||(i=d("I64"))).equal(a.threadKeyV2,h)})[0];if(b==null)return;var c=b.query;if(c==null||c.length<2)return;var j=(i||(i=d("I64"))).to_int32(b.resultCount);c=(yield o(c,f));if(c.length===0)return;var l=(yield k.load());l=l.addBridgeSearchMsgsToSearchResult;yield l(a,e,b.query,c,j+c.length,i.of_string(d("MAWCurrentUser").getID()))})().then(c("emptyFunction"))})});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!c("isMAWUniversalSearchWithEBEnabled")())return;var f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.message_search_queries).getKeyRange(n).filter(function(a){return(i||(i=d("I64"))).equal(a.threadKeyV2,i.one)})));if(f==null)return;var g=f.query;if(g==null||g.length<2)return;var h=(yield o(g,e));if(h.length===0)return;var j=(yield l.load());yield c("waitForMiActMappingForUniversalSearch")(a,e[0].chatJid);return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(b,e[0].chatJid,"MAWBridgeAddMessageSearchResultHandler",function(b,c){return j(a,b,c,g,h,f)})});return t.apply(this,arguments)}g.call=a}),98);
__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[0].set("wa_jid",void 0),d[0].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[0].set("message_product_type",void 0),d[0].set("is_message_deletion",!1),d[0].set("is_unbump",a[3]),d[1]=d[0].get("thread_key"),d[0],c.storedProcedure(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),c.i64.cast([0,389]))},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[2].set("tam_thread_subtype",c.i64.cast([0,0])),d[2].set("wa_jid",void 0),d[2].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[2].set("message_product_type",void 0),d[2].set("is_message_deletion",!1),d[2].set("is_unbump",a[3]),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[3]),c.i64.cast([0,389]),d[4],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxBumpE2EEMetadataThreadStoredProcedure";e.exports=a}),null);
__d("LSBumpE2EEMetadataThreadStoredProcedure",["LSBumpE2EEMetadataThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.serverAuthoritativeTimestampMs;d[2]=b.bumpedByLocalDeviceSend;d[3]=b.isUnbump;return c("LSBumpE2EEMetadataThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("getMAWLastMessageCtaType",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL:return"xma_rtc_missed_audio";case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL:return"xma_rtc_missed_group_audio";case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL:return"xma_rtc_missed_video";case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL:return"xma_rtc_missed_group_video"}}g["default"]=a}),98);
__d("MAWBridgeCentralizedThreadUpdateHandler",["FBLogger","I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","LSOptimisticMarkThreadReadV2StoredProcedure","MAWBridgeBuildThreadSnippet","MAWMiActOnMiThreadReadyForJid","MAWODSProxy","MAWThreadBumpType","MAWThreadUpdateType","ReQL","WALoggerDeferred","WAOdsEnums","asyncToGeneratorRuntime","getMAWLastMessageCtaType","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo][Middleware] Updated thread via middleware. threadKey: ",", bumpTimestampMs: ",",\n    original lastActivityTimestampMs: ","\n    , isAuthorMe: ",", bumpType: ",", threadUpdateType: ",",  from ",""]);i=function(){return a};return a}function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.jid,"CentralizedThreadUpdate",function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f){var g=e.bumpTimestampMs,i=e.isAuthorMe,k=e.threadBumpType,m=e.threadUpdateType,q=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.threads).getKeyRange(f)));if(q==null){c("FBLogger")("CentralizedThreadUpdate").mustfix("[Occamadillo][Middleware] missing thread for bumping threadKey: %s",(h||(h=d("I64"))).to_string(f));return}var r=q.lastActivityTimestampMs;if(m===d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD||m===d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD||e.isUnbump){q=(yield l(e,q));m!==d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD&&(q=(yield n(g,q,e.isUnbump)));if(k===d("MAWThreadBumpType").THREAD_BUMP_TYPE.LOCAL_AND_SERVER){k={readWatermarkTimestampMs:g,threadKey:f};i={bumpedByLocalDeviceSend:i,isUnbump:e.isUnbump,serverAuthoritativeTimestampMs:g,threadKey:f};yield j(c("LSFactory")(b),k,i,m)}}var s=o(e.centralizedThreadSnippetData,q);return a.threads.put(s).then(function(){q!=null&&p(e,r,s)})});return function(a,b){return f.apply(this,arguments)}}())}function j(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){f!==d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD&&(d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_UPDATE_MIDDLEWARE,key:"$MarkThreadReadOnOccam"}),yield c("LSOptimisticMarkThreadReadV2StoredProcedure")(a,b));return c("LSBumpE2EEMetadataThreadStoredProcedure")(a,e)});return k.apply(this,arguments)}function l(a,b){return!m(a,b)?b:babelHelpers["extends"]({},b,{lastActivityTimestampMs:a.bumpTimestampMs})}function m(a,b){return a.isUnbump?(h||(h=d("I64"))).lt(a.bumpTimestampMs,b.lastActivityTimestampMs):(h||(h=d("I64"))).gt(a.bumpTimestampMs,b.lastActivityTimestampMs)}function n(a,b,c){return!c&&(h||(h=d("I64"))).lt(a,b.lastReadWatermarkTimestampMs)?b:babelHelpers["extends"]({},b,{lastReadWatermarkTimestampMs:a})}function o(a,b){if(c("gkx")("6478"))return b;var e=a.snippetSenderContactId!=null?(h||(h=d("I64"))).of_string(a.snippetSenderContactId):(h||(h=d("I64"))).zero,f=c("getMAWLastMessageCtaType")(a.snippetType);a=d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b.snippet);return babelHelpers["extends"]({},b,{lastMessageCtaType:f,snippet:a,snippetSenderContactId:e})}function p(a,b,e){c("promiseDone")(d("WALoggerDeferred").LOG(i(),(h||(h=d("I64"))).to_string(e.threadKey),h.to_string(e.lastActivityTimestampMs),h.to_string(b),a.isAuthorMe,a.threadBumpType,a.threadUpdateType,a.description))}g.call=a}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["LSThreadBitOffset","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeDeleteGroupInviteHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,f){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(e.group_invites).getKeyRange(f)));return(h||(h=b("Promise"))).all(g.map(function(a){return e.group_invites["delete"](a.threadKey,a.inviterId,a.inviteeId)})).then(function(){if(!c("justknobx")._("1162"))return;c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)),function(b){if(b==null)return;var c=d("LSThreadBitOffset").clear([105],b.capabilities,b.capabilities2,b.capabilities3,b.capabilities4),e=c[0],f=c[1],g=c[2];c=c[3];return a.threads.put(babelHelpers["extends"]({},b,{capabilities:e,capabilities2:f,capabilities3:g,capabilities4:c,snippet:void 0}))})})});return function(a,b){return e.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeDeleteMessageRangesV2Handler",["I64","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeDeleteMessageRangesV2Handler",function(a,c){return a.messages_ranges_v2__generated["delete"](c,(h||(h=d("I64"))).of_float(b.minTimestampMs),b.minMsgId)})}g.call=a}),98);
__d("MAWBridgeDeleteMessagesHandler",["MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c.threadJid,"MAWBridgeDeleteMessagesHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var e of c.messages)yield a.messages["delete"](b,d("MAWTimeUtils").toTimestamp(e.ts),e.msgId)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeDeleteReactionHandler",["I64","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.chatJid,"MAWBridgeDeleteReactionHandler",function(a,c){return a.reactions["delete"](c,b.messageId,(h||(h=d("I64"))).of_string(b.actorId))})}g.call=a}),98);
__d("MAWBridgeEditMsgHistoryAddedHandler",["I64","LSMessageSendStatus","MAWChatJid","Promise","asyncToGeneratorRuntime","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){return{messageContent:a.msgContent.content,originalMessagePk:a.originalMsgId,pk:a.editMsgHistoryId,sendStatus:a.sendStatus!=null?(i||(i=d("I64"))).of_int32(a.sendStatus):(i||(i=d("I64"))).of_int32(c("LSMessageSendStatus").SERVER_RECEIVED),serverAdjustedEditTsMs:(i||(i=d("I64"))).of_int32(a.editTs),threadKey:b}}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("MAWChatJid").toThreadKey(a.tables,c.threadJid,"MAWBridgeEditMsgHistoryAddedHandler"));c=j(c,a);return b.edit_message_history.put(c)});return l.apply(this,arguments)}function a(a,d,e){return(h||(h=b("Promise"))).all(e.map(function(b){return k(a,d,b)})).then(c("emptyFunction"))}g.composeEditHistoryMsg=j;g.call=a}),98);
__d("MAWBridgeFulfillRestorePromisePayloadHandler",["MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","Promise","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a.success?(d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(a.value.traceId),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a.value.traceId)):(d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(a.error.traceId,c("err")(a.error.message)),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(a.error.traceId));return(h||(h=b("Promise"))).resolve()}g.call=a}),98);
__d("MAWBridgeGroupInfoUpdatedHandler",["MAWMiActOnMiThreadReadyForJid","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c.chatJid,"MAWBridgeGroupInfoUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;e=(e=c.threadName)!=null?e:void 0;a=a.threads;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b)));if(b==null)return;var f=c.memberAddMode!=="all_member_add";yield a.put(babelHelpers["extends"]({},b,{needsAdminApprovalForNewParticipant:f,threadName:e}))});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeGroupInviteLoadedHandler",["fbt","I64","LSMessagingThreadTypeUtil","MAWMiActOnMiThreadReadyForJid","ReQL","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=a.threads,g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(f).getKeyRange(e)));if(g==null)return;var j=d("LSMessagingThreadTypeUtil").isGroup(g.threadType);if(!j)return;j=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(e)));if(j==null){c("justknobx")._("1162")&&(yield f.put(babelHelpers["extends"]({},g,{additionalThreadContext:void 0})));return}e=(i||(i=d("I64"))).equal((i||(i=d("I64"))).of_string(b.actorId),j.inviterId)?null:yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts,["name"]).getKeyRange(j.inviterId));if(e==null)return;b=h._("__JHASH__UJFQkCMRFkv__JHASH__",[h._param("Inviter Name",e.name)]).toString();a=g.folderName==="inbox"?h._("__JHASH__4F6x7gUU1-S__JHASH__").toString():g.additionalThreadContext;yield f.put(babelHelpers["extends"]({},g,{additionalThreadContext:a,snippet:b}))});return k.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeGroupInviteLoadedHandler",function(a,c){return j(a,b,c)})}g.callWithoutWaitingForAnything=j;g.call=a}),226);
__d("LSContactUserBlockAction",[],(function(a,b,c,d,e,f){a=Object.freeze({MN_UNBLOCK:0,MN_BLOCK:1,FB_UNBLOCK:2,FB_BLOCK:3});f["default"]=a}),66);
__d("MAWBlockUtils",["I64","LSContactUserBlockAction","LSIntEnum","LSThreadBitOffset","ReQL","asyncToGeneratorRuntime","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(k||d("react")).useCallback,m=[0,31,35,55,56,58,24,25,19,85],n=[0,31,35,55,56,58,24,25,19,85,8,22],o=[35,19,85,56,24,25];function a(){var a=(h||(h=c("useReStore")))();return l(function(e,g){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.participants).getKeyRange(e)));if(b==null)return;var h=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.threads).getKeyRange(b.threadKey).filter(function(a){return(i||(i=d("I64"))).equal(a.threadType,(j||(j=d("LSIntEnum"))).ofNumber(15))})));if(h==null)return;b=(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactUserBlockAction").MN_BLOCK))?d("LSThreadBitOffset").clear(m,h.capabilities,h.capabilities2,h.capabilities3,h.capabilities4):(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactUserBlockAction").FB_BLOCK))?d("LSThreadBitOffset").clear(n,h.capabilities,h.capabilities2,h.capabilities3,h.capabilities4):d("LSThreadBitOffset").set(o,h.capabilities,h.capabilities2,h.capabilities3,h.capabilities4);var k=b[0],l=b[1];yield a.runInTransaction(function(a){var b=babelHelpers["extends"]({},h,{capabilities:k,capabilities2:l});return a.threads.put(b)},"readwrite",void 0,void 0,f.id+":134")})())},[a])}g.clearedMnBlockCapabilities=m;g.clearedFbBlockCapabilities=n;g.useChangeThreadBlockCapabilities=a}),98);
__d("MAWMessageRequestUtil",["I64","LSContactBitOffset","LSContactViewerRelationship","LSIntEnum","LSMessagingThreadTypeUtil"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e){if(a==="pending"||a==="other")return!0;var f=d("LSContactBitOffset").hasWithDefault(64,e,!0);return a==="inbox"&&(h||(h=d("I64"))).equal(e.contactViewerRelationship,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactViewerRelationship").NOT_CONTACT))&&!f?b:!1}function k(a){return a==="pending"||a==="other"}function a(a){return d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType)?k(a.folderName):!1}function l(a,b){return b!=null?j(a.folderName,!(h||(h=d("I64"))).equal(a.lastActivityTimestampMs,h.zero),b[1]):!1}function b(a,b){return d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType)?l(a,b):!1}e=[8,18,19,34,24,25,122];f=[21,48];g.isMessageRequestV2=j;g.isOneOnOneMessageRequest=a;g.isOneOnOneMessageRequestV2=b;g.disabledThreadCapabilitiesForIncomingRequest=e;g.enabledThreadCapabilitiesForIncomingRequest=f}),98);
__d("clearedMAWMnRestrictCapabilities",[],(function(a,b,c,d,e,f){"use strict";a=[0,31,35,55,56,58,24,25,35,19];b=a;f["default"]=b}),66);
__d("MAWUpdateLSThreadCapabilities",["fbt","I64","LSBitOffset","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWBlockUtils","MAWCurrentUser","MAWMessageRequestUtil","Promise","ReQL","asyncToGeneratorRuntime","clearedMAWMnRestrictCapabilities","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,e){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(27),c.capabilities);c=babelHelpers["extends"]({},c,{capabilities:e});return a.threads.put(c)}).then(c("emptyFunction"))}function e(a,e){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSBitOffset").clear((j||(j=d("LSIntEnum"))).ofNumber(27),c.capabilities);c=babelHelpers["extends"]({},c,{capabilities:e});return a.threads.put(c)}).then(c("emptyFunction"))}function f(a,e){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve([void 0,void 0]);var f=d("ReQL").firstAsync(d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType)?d("ReQL").mergeJoin(d("ReQL").fromTableAscending(a.participants).getKeyRange(e),d("ReQL").fromTableAscending(a.contacts)).filter(function(a){a=a[1];return!(k||(k=d("I64"))).equal(a.id,m)}).map(function(a){a=a[1];return a}):d("ReQL").empty());return(i||(i=b("Promise"))).all([i.resolve(c),f])}).then(function(e){var f=e[0];if(f==null)return(i||(i=b("Promise"))).resolve();e=e[1];if(e==null)return(i||(i=b("Promise"))).resolve();var g=(k||(k=d("I64"))).equal(e.blockedByViewerStatus,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").MESSAGE_BLOCKED)),h=k.equal(e.blockedByViewerStatus,j.ofNumber(c("LSContactBlockedByViewerStatus").FULLY_BLOCKED));e=d("LSContactBitOffset").has(66,e);h=h?d("LSThreadBitOffset").clear(d("MAWBlockUtils").clearedFbBlockCapabilities,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):g?d("LSThreadBitOffset").clear(d("MAWBlockUtils").clearedMnBlockCapabilities,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):e?d("LSThreadBitOffset").clear(c("clearedMAWMnRestrictCapabilities"),f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):[f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4];g=h[0];e=h[1];var l=h[2];h=h[3];return a.threads.put(babelHelpers["extends"]({},f,{capabilities:g,capabilities2:e,capabilities3:l,capabilities4:h})).then(c("emptyFunction"))})}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=a.threads;c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(c)));if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSThreadBitOffset").set.apply(d("LSThreadBitOffset"),[d("MAWMessageRequestUtil").disabledThreadCapabilitiesForIncomingRequest].concat(d("LSThreadBitOffset").clear(d("MAWMessageRequestUtil").enabledThreadCapabilitiesForIncomingRequest,c.capabilities,c.capabilities2,c.capabilities3,c.capabilities4))),f=e[0],g=e[1],h=e[2];e=e[3];yield a.put(babelHelpers["extends"]({},c,{additionalThreadContext:void 0,capabilities:f,capabilities2:g,capabilities3:h,capabilities4:e}))});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(b==null)return;c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts,["name"]).getKeyRange(c)));if(c==null)return;c=h._("__JHASH__uQTwTbCP0iW__JHASH__",[h._param("Inviter Name",c.name)]).toString();var e=d("LSThreadBitOffset").set([105],b.capabilities,b.capabilities2,b.capabilities3,b.capabilities4),f=e[0],g=e[1],i=e[2];e=e[3];yield a.threads.put(babelHelpers["extends"]({},b,{capabilities:f,capabilities2:g,capabilities3:i,capabilities4:e,snippet:c}))});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(c)));if(e==null)return;c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(c)));var f=d("LSThreadBitOffset").clear([105],e.capabilities,e.capabilities2,e.capabilities3,e.capabilities4),g=f[0],h=f[1],i=f[2];f=f[3];yield a.threads.put(babelHelpers["extends"]({},e,{capabilities:g,capabilities2:h,capabilities3:i,capabilities4:f,snippet:void 0}));yield c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield a.group_invites["delete"](b.threadKey,b.inviterId,b.inviteeId)});return function(a){return c.apply(this,arguments)}}())});return s.apply(this,arguments)}g.enableAddMembersTxn=a;g.disableAddMembersTxn=e;g.disableBlockerCapabilitiesTxn=f;g.updateNonMessageRequestThreadTxn=n;g.setGroupInviteTxn=p;g.clearGroupInviteTxn=r}),226);
__d("MAWBridgeGroupInviteUpdateHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWUpdateLSThreadCapabilities","Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeGroupInviteUpdateHandler",function(a,f){var g=(i||(i=d("I64"))).of_string(e.inviterId);return(h||(h=b("Promise"))).all([d("MAWUpdateLSThreadCapabilities").setGroupInviteTxn(a,f,g)]).then(c("emptyFunction"))})}g.call=a}),98);
__d("MAWBridgeHandleCOPDigest",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("MAWBridgeMediaExpiredHandler",["MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeMediaExpiredHandler.bs",function(a,c){return a.attachments["delete"](c,b.msgId,String(b.plaintextHash))})}g.call=a}),98);
__d("LSInsertNewMessageRangeStoredProcedure",["LSInsertNewMessageRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.newMinTs;d[2]=b.newMaxTs;d[3]=b.newMinMid;d[4]=b.newMaxMid;d[5]=b.lowerOverlap;d[6]=b.upperOverlap;d[7]=b.hasMoreBefore;d[8]=b.hasMoreAfter;d[9]=b.requestedMessageId;return c("LSInsertNewMessageRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeMsgRangeLoadedHandler",["I64","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","Promise","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["No messages found for thread "," with message id ",""]);j=function(){return a};return a}function a(a,e){if(e.rangeExtensionType==null){d("WALogger").ERROR(j(),e.threadJid,e.offsetMsgId);return(i||(i=b("Promise"))).resolve()}return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeMsgRangeLoadedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g,i,j,k,l;f=((f=e.rangeExtensionType)==null?void 0:f.minMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((g=e.rangeExtensionType)==null?void 0:g.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(i=(i=e.rangeExtensionType)==null?void 0:i.minMsgId)!=null?i:"";j=(j=(j=e.rangeExtensionType)==null?void 0:j.maxMsgId)!=null?j:"";k=(k=(k=e.rangeExtensionType)==null?void 0:k.hasMoreBefore)!=null?k:!1;l=(l=(l=e.rangeExtensionType)==null?void 0:l.hasMoreAfter)!=null?l:!1;var m=e.offsetMsgId;yield c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:l,hasMoreBefore:k,lowerOverlap:f,newMaxMid:j,newMaxTs:g,newMinMid:i,newMinTs:f,requestedMessageId:m,threadKey:b,upperOverlap:g})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWLocalizationEphemeralSettingSetAdminMsg",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET}g.isEphemeralSettingSetAdminMsg=a}),98);
__d("MAWAdminMsgCTA",["fbt","I64","MAWLocalizationEphemeralSettingSetAdminMsg","MAWLocalizationType","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=h._("__JHASH__iw7A0LnsmaW__JHASH__").toString(),l=h._("__JHASH__e7VrrtGFXYH__JHASH__").toString(),m=h._("__JHASH__jODYJ2eW1Pa__JHASH__").toString(),n=h._("__JHASH__xAOSvpC7vLN__JHASH__").toString(),o=h._("__JHASH__P5k2go6lj2P__JHASH__").toString();function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.admin_message_ctas.index("ctaId"))));return a!=null?(j||(j=d("I64"))).add(a.ctaId,(j||(j=d("I64"))).one):(j||(j=d("I64"))).zero});return q.apply(this,arguments)}function r(a,b,c){b=[b,c];return d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.admin_message_ctas).bounds({gte:b,lte:b}))}function s(a){if(a==null)return{showAdChoiceIcon:!1};if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:k};switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:m};case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:n};case d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:o};case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:l};default:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0}}}function t(a){if(a==null)return;if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return"admin_msg_armadillo_ephemeral_change_duration";switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE:return"admin_msg_thread_level_cutover";case d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION:return"admin_msg_e2ee_thread";case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE:return"admin_msg_cutover_rollback";case d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return"admin_msg_dual_thread_cutover";case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE:return"admin_msg_view_pin_msgs_v2";case d("MAWLocalizationType").LOCALIZATION_TYPE.YOUR_DEVICE_ICDC_ALERT_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE:return"admin_msg_icdc"}}function u(a,b,c,d,e){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){yield a.admin_message_ctas.add({actionUrl:f.actionUrl,adClientToken:f.adClientToken,adHelpUrl:f.adHelpUrl,adminMessageNicknameParticipantId:f.adminMessageNicknameParticipantId,adPreferenceUrl:f.adPreferenceUrl,ctaId:b,messageId:e.msgId,showAdChoiceIcon:f.showAdChoiceIcon,targetId:f.targetId,targetTitle:f.targetTitle,threadKey:c,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts),title:f.title})});return v.apply(this,arguments)}function w(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){var e=(yield (i||(i=b("Promise"))).all([r(a,c,d.msgId),p(a)])),f=e[0];e=e[1];if(f!=null)return{ctaId:f.ctaId,ctaType:t(d.adminType),title:f.title};else{f=s(d.adminType);yield u(a,e,c,d,f);return{ctaId:e,ctaType:t(d.adminType),title:f.title}}});return x.apply(this,arguments)}function a(a,c,e){var f=e.adminType;return f!=null&&(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(f)||f===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION||f===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE||f===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE)?w(a,c,e):(i||(i=b("Promise"))).resolve()}g.getAdminMsgCTAContentByAdminType=s;g.getCtaTypeByAdminType=t;g.getAdminMsgCtaStep=a}),226);
__d("MAWBumpMessageMsgReplySnippet",["getMAWLocalizedBumpMsgReplySnippet"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.isAuthorMe,d=a.recipientName,e=a.replySenderIsMe,f=a.replySenderIsRecipient;a=a.senderName;var g="participantBumpedParticipantMessage";b&&e?g="currentUserBumpedOwnMessage":b?g="currentUserBumpedMessage":e?g="participantBumpedCurrentUserMessage":f&&(g="participantBumpedOwnMessage");return c("getMAWLocalizedBumpMsgReplySnippet")(g,a,d)}g.buildBumpMessageReplySnippet=a}),98);
__d("MAWMsgReplyStatus",["LSIntEnum","LSReplyMessageStatus","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){switch(a){case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case d("MAWMsgType").MSG_TYPE.REVOKED:return c("LSReplyMessageStatus").DELETED;case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return c("LSReplyMessageStatus").VALID;case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:return c("LSReplyMessageStatus").TEMPORARY_UNAVAILABLE;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return c("LSReplyMessageStatus").UNKNOWN;case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return c("LSReplyMessageStatus").EXPIRED;default:return void 0}}function a(a){a=i(a.replyStatusType);if(a!=null)return(h||(h=d("LSIntEnum"))).ofNumber(a)}g.getReplyMessageStatus=i;g.getLSReplyMessageStatus=a}),98);
__d("MAWMsgReplySnippet",["fbt","I64","LSIntEnum","LSReplyMessageAttachmentType","LSReplyMessageStatus","MAWBumpMessageMsgReplySnippet","MAWMsgReplyStatus","MAWMsgType","ODS","err","gkx","justknobx"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;function l(a){var b=a.isAuthorMe,e=a.isBumpMsg;e=e===void 0?!1:e;var f=a.isDeletedMsg,g=a.isFBStoryMention;g=g===void 0?!1:g;var k=a.isIGStoryMention;k=k===void 0?!1:k;var l=a.isIGXMAStoryShare;l=l===void 0?!1:l;var m=a.isMsgHighlightsTabFriendUpdatesReply;m=m===void 0?!1:m;var n=a.isNoteReply;n=n===void 0?!1:n;var o=a.isPostPrivateReply;o=o===void 0?!1:o;var p=a.isStoryHighlightShare;p=p===void 0?!1:p;var q=a.isStoryReaction;q=q===void 0?!1:q;var r=a.isStoryReply;r=r===void 0?!1:r;var s=a.isStoryShare;s=s===void 0?!1:s;var t=a.recipientName,u=a.replyAttachmentType,v=a.replySenderIsMe;v=v===void 0?!1:v;var w=a.replySenderIsRecipient;w=w===void 0?!1:w;var x=a.senderName;a=a.storyShareAuthor;switch(!0){case e:return d("MAWBumpMessageMsgReplySnippet").buildBumpMessageReplySnippet({isAuthorMe:b,recipientName:t,replySenderIsMe:v,replySenderIsRecipient:w,senderName:x});case p:return a!=null?h._("__JHASH__3A-F80NGMR1__JHASH__",[h._param("username",a)]):h._("__JHASH__btyC9aNJMDF__JHASH__");case l&&u!=null&&(i||(i=d("I64"))).equal(u,(j||(j=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").FEED_POST)):return a!=null?h._("__JHASH__xnZ-ffIPZnP__JHASH__",[h._param("username",a)]):h._("__JHASH__nEqZlivBoJj__JHASH__");case b&&f:return h._("__JHASH__FzueDOoURT8__JHASH__");case b&&s:return h._("__JHASH__d4DLCdwDC03__JHASH__");case b&&q:return h._("__JHASH__yaEVWahdF8q__JHASH__");case b&&k:return t!=null?h._("__JHASH__ZcIFbzn42DR__JHASH__",[h._param("name",t)]):h._("__JHASH__M3uJqhYYEHf__JHASH__");case b&&g:return t!=null?h._("__JHASH__djIYCFIYkhI__JHASH__",[h._param("name",t)]):h._("__JHASH__M3uJqhYYEHf__JHASH__");case k:case g:return h._("__JHASH__dgpS1OhnF7B__JHASH__");case!b&&m:return h._("__JHASH__9HVcKyuMcEa__JHASH__",[h._param("name",x)]);case b&&m:return h._("__JHASH__tQ_baoPXjLg__JHASH__");case b&&o:return t!=null?h._("__JHASH__VKBGNzy_Yqs__JHASH__",[h._param("name",t)]):h._("__JHASH__n0YtGhrNuCJ__JHASH__");case o:return h._("__JHASH__i08IJ6pj_jc__JHASH__",[h._param("name",x)]);case!b&&n:return h._("__JHASH__6yn4tcYSSq3__JHASH__",[h._param("name",x)]);case b&&n:return h._("__JHASH__XYG_9W-CuAE__JHASH__");case b&&v:return h._("__JHASH__GiGYAtipVIl__JHASH__");case b&&r:return t!=null?h._("__JHASH__ZkkDtvZx-as__JHASH__",[h._param("name",t)]):h._("__JHASH__GEUovmERkjj__JHASH__");case b:return t!=null?h._("__JHASH__eQLjVyXwwuH__JHASH__",[h._param("other_name",t)]):h._("__JHASH__NYU_gsfRGpq__JHASH__");case f:return h._("__JHASH__30kvLEU_B_p__JHASH__",[h._param("name",x)]);case s:return h._("__JHASH__JQwHPEO2e9j__JHASH__",[h._param("user",x)]);case q:return h._("__JHASH__BS0JbOB2Hdc__JHASH__");case w:return h._("__JHASH__RWi7lW394uo__JHASH__",[h._param("other",x)]);case v&&r:return h._("__JHASH__zc6GoZLyKDZ__JHASH__",[h._param("name",x)]);case v:return h._("__JHASH__uU6-xunUPnp__JHASH__",[h._param("other_name",x)]);default:return t!=null?h._("__JHASH__iOHMd6RP1E7__JHASH__",[h._param("other",x),h._param("other_name",t)]):h._("__JHASH__JL2f9yie2zt__JHASH__",[h._param("other",x)])}}function a(a){var b=a.isAuthorMe,e=a.isFBStoryMention;e=e===void 0?!1:e;var f=a.isIGStoryMention;f=f===void 0?!1:f;var g=a.isIGXMAStoryShare,h=a.isMsgHighlightsTabFriendUpdatesReply;h=h===void 0?!1:h;var i=a.isNoteReply;i=i===void 0?!1:i;var j=a.isPostPrivateReply;j=j===void 0?!1:j;var m=a.isStoryHighlightShare;m=m===void 0?!1:m;var n=a.isStoryReaction,o=a.isStoryReply,p=a.isStoryShare;p=p===void 0?!1:p;var q=a.replySenderIsMe,r=a.replySourceId,s=a.replyStatusType,t=a.replyToUserId,u=a.sender,v=a.storyShareAuthor;a=a.type_;a=a===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE;var w=s===d("MAWMsgType").MSG_TYPE.XMA&&c("gkx")("458");if(r==null&&!(c("justknobx")._("2998")&&Boolean(o))&&!p&&!f&&!e&&!m&&!i&&!w)return;if(t==null||u==null)throw c("err")("Error getting reply snippet without replyToUserId or sender");(k||(k=d("ODS"))).bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");return(r=l({isAuthorMe:b,isBumpMsg:a,isDeletedMsg:d("MAWMsgReplyStatus").getReplyMessageStatus(s)===c("LSReplyMessageStatus").DELETED,isFBStoryMention:e,isIGStoryMention:f,isIGXMAStoryShare:g,isMsgHighlightsTabFriendUpdatesReply:h,isNoteReply:i,isPostPrivateReply:j,isStoryHighlightShare:m,isStoryReaction:n,isStoryReply:o,isStoryShare:p,recipientName:"$PARTICIPANT_FIRST_NAME("+t+")",replySenderIsMe:q,replySenderIsRecipient:u===t,senderName:"$PARTICIPANT_FIRST_NAME("+u+")",storyShareAuthor:v}))==null?void 0:r.toString()}g.buildLocalizedReplySnippet=l;g.getReplySnippet=a}),226);
__d("MAWBridgeBuildAdminMsg",["MAWAdminMsg","MAWAdminMsgNormalized","MAWLocalizationType","MAWSubscribeToContactNames","MAWThreadCustomizationUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null?void 0:a.replace(/\$/g,"$$$$")}function a(a,b,c){c===void 0&&(c=0);a=d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(b,a);var e=a.contactIds;a=a.contents;var f=d("MAWThreadCustomizationUtils").nicknameOnlyForFirstParticipantChecking(b),g=d("MAWThreadCustomizationUtils").skipNicknameCheck(b);if(c===1){var i=b===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP?d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME;return d("MAWAdminMsg").buildLocalizedString(a.map(h),e.map(function(a,b){return f&&b>0||g?i===d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME?"$CONTACT_FIRST_NAME("+a+")":"$CONTACT_FULL_NAME("+a+")":i===d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME?"$PARTICIPANT_FIRST_NAME("+a+")":"$PARTICIPANT_FULL_NAME("+a+")"}),b)}return d("MAWAdminMsg").buildLocalizedString(a,e,b)}g.buildAdminMsgText=a}),98);
__d("MAWMsgReply",["EntMessageReplyType","I64","LSIntEnum","LSMessageReplySourceTypeV2","LSReplyMessageAttachmentType","MAWMsg","MAWMsgType","cr:2472"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){return a.replySourceId!=null}function a(a){a=a.replyToUserId;return a==null?void 0:(h||(h=d("I64"))).of_string(a)}function e(a){var b=a.isFBStoryMention,e=a.isForwarded,f=a.isMsgHighlightsTabFriendUpdatesReply,g=a.isStoryReply,h=a.isStoryShare;a=j(a);if(e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FORWARD);if(h!=null&&h)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FB_STORY_SHARE);if(b!=null&&b)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FB_STORY_MENTION);if(f!=null&&f)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").HIGHLIGHTS_TAB_POST_REPLY);if(a)if(g!=null&&g)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").STORY);else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE)}function f(a){var b=j(a),e=a.isMsgHighlightsTabFriendUpdatesReply,f=a.isStoryReply;a=a.isStoryShare;if(a!=null&&a)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FB_STORY_SHARE);if(e!=null&&e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").HIGHLIGHTS_TAB_POST_REPLY);if(b)if(f!=null&&f)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").STORY);else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE)}function k(a){if(a.replySourceId!=null)return a.replySourceId}function l(a){if(a.replySourceTimestampMs!=null)return(h||(h=d("I64"))).of_float(a.replySourceTimestampMs)}function m(a){if(a.replySourceId!=null)return a.replyMessageText}function n(a){if(a.replySourceId!=null)return a.replyMentionedJids}function o(a){return a.type_===d("MAWMsg").bumpExistingMessage?(i||(i=d("LSIntEnum"))).ofNumber(c("EntMessageReplyType").BUMP):j(a)?(i||(i=d("LSIntEnum"))).ofNumber(c("EntMessageReplyType").REGULAR):void 0}function p(a){return a.replySourceId==null?!1:q(a.replyStatusType)}function q(a){switch(a){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!0;default:return!1}}function r(a){return a.replyStatusType==="XMA"&&a.replyMessageText!=null}function s(a){if(p(a)&&!r(a))return a.replyMediaUrlMimeType}function t(a){if(p(a))return a.replyMediaPreviewHeight!=null?(h||(h=d("I64"))).of_int32(a.replyMediaPreviewHeight):void 0}function u(a){if(p(a))return a.replyMediaPreviewWidth!=null?(h||(h=d("I64"))).of_int32(a.replyMediaPreviewWidth):void 0}function v(a){var e=a.replyMessageText;e=e!=null?b("cr:2472")==null?e:b("cr:2472").unvault(e):"";e=e==="\ud83d\udc4d"&&a.replyStatusType==="Sticker";var f=a.replyStatusType==="Raven";f=p(a)||f;var g=a.replyStatusType;if(f){if(g==null)return;switch(g){case"Gif":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").GIF);case"Ptt":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").OTHER);case"Sticker":if(!e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER);break;case"Video":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").VIDEO);case"Image":case"XMA":if(e)return;if(a.isIGXMAPostShare===!0||a.isIGXMAStoryShare===!0||a.isStoryHighlightShare===!0||a.isPostPrivateReply===!0||a.isMsgHighlightsTabFriendUpdatesReply===!0)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").FEED_POST);if(r(a))return;return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").PHOTO);case"DocumentFile":if(e)return;return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").OTHER);case"ReceiverFetch":if(e)return;return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER);case"Raven":return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").EPHEMERAL_RAVEN_MESSAGE);default:}}if(g!=null&&g==="Sticker"&&e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER)}function w(a){var b=a.replyMediaId,c=a.replyXMAId;if(p(a)&&b!=null)return c!=null?void 0:(h||(h=d("I64"))).of_float(b);if(b!=null||c==null)return;if(c!=null&&r(a))return;return(h||(h=d("I64"))).of_int32(c)}function x(a){var b=a.replyPlaintextHash;if(p(a)&&b!=null)return""+b}function y(a){var b=a.isStoryReply,c=a.replyMessageText,e=a.replyStatusType,f=v(a);a=w(a);if(e!=null&&e==="XMA"&&f==null){if(a!=null)return;if(c==null)return(h||(h=d("I64"))).zero}if(a!=null||!(b!=null&&b))return;return(h||(h=d("I64"))).zero}g.getReplyUserId=a;g.getReplySourceTypeV2=e;g.getReplySourceType=f;g.getReplySourceId=k;g.getReplyTimestampMs=l;g.getReplyMessageText=m;g.getReplyMentionedJids=n;g.getReplyType=o;g.getReplyMediaMimeType=s;g.getReplyMediaHeight=t;g.getReplyMediaWidth=u;g.getReplyAttachmentType=v;g.getReplyAttachmentId=w;g.getReplyAttachmentPlaintextHash=x;g.getReplyMediaExpirationTimestampMs=y}),98);
__d("MAWBridgeBuildMsg",["fbt","I64","MAWBridgeBuildAdminMsg","MAWBridgeBuildMsgMentions","MAWJids","MAWMsgReply","MAWMsgType","MAWVault","isMWBumpMessage"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.filter(Boolean).reduce(function(a,b){return[].concat(a,b)},[])}function k(a){return a!=null?d("MAWVault").unvault(a):void 0}function l(a){return a!=null?d("MAWVault").vault(a):void 0}function m(a){return babelHelpers["extends"]({},a,{replyMessageText:l(a.replyMessageText),text:l(a.text)})}function a(a){a=a.ephemeralDurationInSec;return a!=null?(i||(i=d("I64"))).of_int32(a):void 0}function b(a,b){var c=d("MAWMsgReply").getReplyMessageText(a),e=a.adminContent,f=a.adminType,g=a.adminVersion,i=a.content,l=a.isAdminMessage;i=i;l&&e!=null&&f!=null&&(i=d("MAWBridgeBuildAdminMsg").buildAdminMsgText(e,f,g));if(a.type_===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE)if(a.replySourceId==null)i="";else{i=(l=b)!=null?l:h._("__JHASH__W6kPEK81i0G__JHASH__").toString()}e=j(a.mentionedJids,d("MAWMsgReply").getReplyMentionedJids(a));return e.length>0?m(d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(k(i),e,k(c))):{replyMessageText:c,text:i}}function e(a,b,e){var f=c("isMWBumpMessage")(b)?b==null?void 0:b.replyMessageText:b==null?void 0:b.text;b=j(e,b==null?void 0:(e=b.mentionIds)==null?void 0:e.split(",").map(d("MAWJids").toUserJid));return b.length>0?m(d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(k(a),b,k(f))):{replyMessageText:f,text:a}}g.getEphemeralDurationInSec=a;g.buildMessage=b;g.buildOptimisticMessage=e}),226);
__d("LSTransportKey",[],(function(a,b,c,d,e,f){a=Object.freeze({ADVANCED_CRYPTO:"AdvancedCrypto",CARRIER_MESSAGING:"CarrierMessaging",FB_BROKER:"FBBroker",FB_LEGACY_BROKER:"FBLegacyBroker",TAM:"TAM",WHATS_APP:"WhatsApp",INSTAMADILLO:"Instamadillo",ENCRYPTED_BACKUPS:"EncryptedBackups",CLIENT_CONTACTS_PLACEHOLDER:""});f["default"]=a}),66);
__d("MAWBridgeMsgUtils",["LSTransportKey"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=Object.keys(c("LSTransportKey")).find(function(b){return c("LSTransportKey")[b]===a});return b?c("LSTransportKey")[b]:"WhatsApp"}g.convertStringToLSTransportKeyType=a}),98);
__d("MAWUpdateMsg",["I64","LSAuthorityLevel","LSIntEnum","LSMessageUnsendabilityStatus","MAWAckLevel","MAWBridgeBuildMsg","MAWBridgeMsg","MAWBridgeMsgUtils","MAWMiActOnMiThreadReadyForJid","MAWMsg","MAWMsgReply","MAWMsgReplyStatus","MAWTimeUtils","MWPBumpEntityKey","ReQL","asyncToGeneratorRuntime","gkx","justknobx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c,e,g,h){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c,"MAWUpdateMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.messages;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b,e,g)));b!=null&&(yield a.put(babelHelpers["extends"]({},b,h)))});return function(b,c){return a.apply(this,arguments)}}())});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":50")}function e(a,b,c,d,e){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var j,k;j=d("MAWTimeUtils").toTimestamp(b.type_===d("MAWMsg").unsent?(j=b.originalTs)!=null?j:b.ts:b.ts);var l=b.type_===d("MAWMsg").unsent?d("MAWTimeUtils").toTimestamp(b.ts):void 0,m=b.type_===d("MAWMsg").unsent,n=(yield d("MAWBridgeBuildMsg").buildMessage(b,g));k=(k=d("MAWBridgeMsgUtils").convertStringToLSTransportKeyType(b.transportKey))!=null?k:"WhatsApp";var o=(h||(h=d("I64"))).to_float(e.primarySortKey),p=!1;if(c("qex")._("371")===!0){var q=(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(2))||(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(4))||(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(64))||(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(16384));p=q&&o>0&&Math.abs(b.sortOrderMs-o)<((q=c("qex")._("474"))!=null?q:0)}o=p?e.primarySortKey:(h||(h=d("I64"))).of_float(b.sortOrderMs);if(c("justknobx")._("2418")){q=b.sortOrderMs-(h||(h=d("I64"))).to_float(e.primarySortKey);Math.abs(q)<1e3?p="less_then_one_second":Math.abs(q)<3e3?p="less_then_three_seconds":Math.abs(q)<5e3?p="less_then_five_seconds":Math.abs(q)<1e4?p="less_then_ten_seconds":Math.abs(q)<6e4?p="less_then_one_minute":Math.abs(q)<6e5?p="less_then_ten_minutes":Math.abs(q)<36e5?p="less_then_one_hour":p="more_then_one_hour";q<0&&(p="negative_"+p);c("qex")._("244")===!0?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.update_msg","optimistic_timestamp_diff_waserver_"+p):d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.update_msg","optimistic_timestamp_diff_"+p);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.update_msg","optimistic_timestamp_diff_"+p)}if(d("MAWMsgReply").getReplyAttachmentId(b)!=null&&d("MAWMsgReply").getReplyAttachmentPlaintextHash(b)==null){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.reply_attachment_media_missing_plaintext_hash","update_message_handler_for_reply_type_"+(h||(h=d("I64"))).to_float((q=d("MAWMsgReply").getReplyAttachmentType(b))!=null?q:(h||(h=d("I64"))).zero))}q=babelHelpers["extends"]({},e,n,{adminMsgCtaId:f==null?void 0:f.ctaId,adminMsgCtaTitle:f==null?void 0:f.title,adminMsgCtaType:f==null?void 0:f.ctaType,authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),cannotUnsendReason:m||!b.isAuthorMe?(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageUnsendabilityStatus").DENY_FOR_NON_SENDER):void 0,displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(b.type_,b.isForwarded,b.isExpiredXmaMsg,b.replySourceId!=null,b.unsupportedType),editCount:b.editCount!=null?(h||(h=d("I64"))).of_int32(b.editCount):(h||(h=d("I64"))).zero,ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(b),groupId:(p=b.groupId)!=null?p:void 0,groupIndex:b.groupIndex!=null?(h||(h=d("I64"))).of_float(b.groupIndex):void 0,groupSize:b.groupSize!=null?(h||(h=d("I64"))).of_float(b.groupSize):void 0,hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(b),isUnsent:b.type_===d("MAWMsg").unsent,messageId:b.msgId,primarySortKey:o,replyAttachmentId:d("MAWMsgReply").getReplyAttachmentId(b),replyAttachmentPlaintextHash:d("MAWMsgReply").getReplyAttachmentPlaintextHash(b),replyAttachmentType:d("MAWMsgReply").getReplyAttachmentType(b),replyMediaExpirationTimestampMs:d("MAWMsgReply").getReplyMediaExpirationTimestampMs(b),replyMediaPreviewHeight:d("MAWMsgReply").getReplyMediaHeight(b),replyMediaPreviewWidth:d("MAWMsgReply").getReplyMediaWidth(b),replyMediaUrlMimeType:d("MAWMsgReply").getReplyMediaMimeType(b),replySnippet:g,replySourceId:d("MAWMsgReply").getReplySourceId(b),replySourceType:d("MAWMsgReply").getReplySourceType(b),replySourceTypeV2:d("MAWMsgReply").getReplySourceTypeV2(b),replyStatus:d("MAWMsgReplyStatus").getLSReplyMessageStatus(b),replyToUserId:d("MAWMsgReply").getReplyUserId(b),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(b.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack),timestampMs:j,transportKey:k,unsentTimestampMs:l},c("gkx")("4889")?{replySourceTimestampMs:d("MAWMsgReply").getReplyTimestampMs(b)}:{});e!=null?yield a.messages.upsert([e.threadKey,e.timestampMs,e.messageId],q):yield a.messages.put(q)});return j.apply(this,arguments)}g.mutateThreadText=a;g.call=e}),98);
__d("MAWBridgeMsgUpdatedHandler",["FBLogger","I64","LSIntEnum","MAWAckLevel","MAWAdminMsgCTA","MAWMiActOnMiThreadReadyForJid","MAWMsgReplySnippet","MAWUpdateMsg","MWChatInteraction","QPLUserFlow","ReQL","asyncToGeneratorRuntime","gkx","qpl","sendToSentQPLUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){var e=d("MWChatInteraction").get(d("MWChatInteraction").s2sKey(a)),f=c("gkx")("4851");a=(a=d("sendToSentQPLUtils").getS2sKeyFromOfflineMessageId(a))!=null?a:f?b.instanceKey:null;if(e!=null){f=d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack);(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(2))?d("MWChatInteraction").addMarkerPoint(e,"received_successful_server_ack"):(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(4))&&d("MWChatInteraction").addMarkerPoint(e,"received_failure_server_ack")}if(a!=null){f=d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack);(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(2))?c("QPLUserFlow").endSuccess(c("qpl")._(25313175,"1551"),{instanceKey:a}):(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(4))?c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),"error_from_server",{instanceKey:a}):(c("QPLUserFlow").addAnnotations(c("qpl")._(25313175,"1551"),{"int":{messageAckResponse:b.ack}},{instanceKey:a}),c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"unexpected_ack_response",{instanceKey:a}))}else c("FBLogger")("messenger_e2ee_web").warn("s2sInstanceKey is null for type %s",b.type_)}function k(a){a=d("sendToSentQPLUtils").getS2sKeyFromOfflineMessageId(a);a!=null&&c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),"message_not_found",{instanceKey:a})}function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.chatJid,"MAWBridgeMsgUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g=(yield (f=d("ReQL")).firstAsync(f.fromTableAscending(a.messages.index("messageId")).getKeyRange(e.msgId)));f=(yield f.firstAsync(f.fromTableAscending(a.attachments).getKeyRange(b,e.msgId)));if(g==null){c("FBLogger")("messenger_e2ee_web").info("existing message is null for type %s, and attachment is null: %s",e.type_,f==null);f&&f.offlineAttachmentId!=null&&k(f==null?void 0:f.offlineAttachmentId);return}f=[g.offlineThreadingId,f==null?void 0:f.offlineAttachmentId];f.forEach(function(a){a!=null&&j(a,e)});f=(yield d("MAWAdminMsgCTA").getAdminMsgCtaStep(a,b,e));b=(yield d("MAWMsgReplySnippet").getReplySnippet(e));return d("MAWUpdateMsg").call(a,e,g,f,b)});return function(b,c){return a.apply(this,arguments)}}())}g.logServerAckToS2S=j;g.call=a}),98);
__d("LSClearMessagePlaceholderRangeStoredProcedure",["LSClearMessagePlaceholderRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.messageId;d[2]=b.maxTimestampMs;return c("LSClearMessagePlaceholderRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeMsgsLoadedHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.chatJid,"MAWBridgeMsgsLoadedHandler",function(a,e){return c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:e}).then(function(){if(c("gkx")("23927")){var f,g,i,j,k,l,m,n;f=(f=(f=b.rangeExtensionType)==null?void 0:f.hasMoreBefore)!=null?f:!1;g=(g=(g=b.rangeExtensionType)==null?void 0:g.hasMoreAfter)!=null?g:!1;i=f&&((i=b.rangeExtensionType)==null?void 0:i.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;j=g&&((j=b.rangeExtensionType)==null?void 0:j.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;k=(k=(k=b.rangeExtensionType)==null?void 0:k.minMsgId)!=null?k:"";l=(l=(l=b.rangeExtensionType)==null?void 0:l.maxMsgId)!=null?l:"";m=((m=b.rangeExtensionType)==null?void 0:m.rangeKind)==="before"?i:d("MAWTimeUtils").MIN_TIMESTAMP_MS;n=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="after"?j:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:g,hasMoreBefore:f,lowerOverlap:m,newMaxMid:l,newMaxTs:j,newMinMid:k,newMinTs:i,threadKey:e,upperOverlap:n})}else{f=((g=b.rangeExtensionType)==null?void 0:g.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;l=((m=b.rangeExtensionType)==null?void 0:m.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(k=(j=b.rangeExtensionType)==null?void 0:j.minMsgId)!=null?k:"";m=(g=(n=b.rangeExtensionType)==null?void 0:n.maxMsgId)!=null?g:"";k=((j=b.rangeExtensionType)==null?void 0:j.rangeKind)==="extensionBefore"?f:d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="extensionAfter"?l:d("MAWTimeUtils").MAX_TIMESTAMP_MS;j=(n=(j=b.rangeExtensionType)==null?void 0:j.hasMoreBefore)!=null?n:!1;n=(n=(n=b.rangeExtensionType)==null?void 0:n.hasMoreAfter)!=null?n:!1;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:n,hasMoreBefore:j,lowerOverlap:k,newMaxMid:m,newMaxTs:l,newMinMid:i,newMinTs:f,threadKey:e,upperOverlap:g})}})})}g.call=a}),98);
__d("MAWEphemeralMessageExpirationStorage",["LSDatabaseSingleton","MAWBridgeDeleteMessagesHandler","Promise","asyncToGeneratorRuntime","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Map();function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){yield (i||(i=b("Promise"))).all(c.map(function(b){var c=b.ts,e=b.msgId;e={msgId:e,ts:c};c=b.threadJid;b=[e];e={messages:b,threadJid:c};return d("MAWBridgeDeleteMessagesHandler").call(a,e)})),j["delete"](e)});return l.apply(this,arguments)}function m(a,e,g){return c("setTimeout")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var g=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);c("promiseDone")(g.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield k(b,a,e)});return function(a){return c.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":66"))}),g)}function a(a,b,d,e){a=j.get(d);var f;if(a==null)f=[b];else{c("clearTimeout")(a.timeoutId);var g=a.msgs.map(function(a){return a.msgId}).indexOf(b.msgId)===-1;g&&a.msgs.push(b);f=a.msgs}g=m(f,d,e);j.set(d,{expirationTs:d,msgs:f,timeoutId:g})}function e(a){var b=a.msgId;a=j.get(a.countdownTs);if(a==null)return;b=a.msgs.map(function(a){return a.msgId}).indexOf(b);if(b>-1){a.msgs.splice(b,1);return}}g.setMessageForExpiration=a;g.clearMessageFromExpiration=e}),98);
__d("MAWBridgeMsgsStartCountdownHandler",["I64","MAWEphemeralMessageExpirationStorage","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return c.msgs.reduce(function(c,e){return c.then(function(){d("MAWEphemeralMessageExpirationStorage").setMessageForExpiration(a,e,e.countdownTs,e.millisecondsUntilCountdownTs);(i||(i=d("I64"))).of_int32(e.millisecondsUntilCountdownTs);return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeMsgsStartCountdownHandler",function(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages).getKeyRange(c,d("MAWTimeUtils").toTimestamp(e.ts),e.msgId)).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){if(c==null)return(h||(h=b("Promise"))).resolve();c=babelHelpers["extends"]({},c,{ephemeralExpirationTs:(i||(i=d("I64"))).of_float(e.countdownTs)});yield a.messages.put(c)});return function(a){return c.apply(this,arguments)}}())})})},(h||(h=b("Promise"))).resolve())}g.call=a}),98);
__d("MAWMedia",["LSIntEnum","MAWDbMedia","MessagingAttachmentType"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(a===d("MAWDbMedia").IMAGE)return b!=null?(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE):(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE);else if(a===d("MAWDbMedia").VIDEO)return b!=null?(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO):(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO);else if(a===d("MAWDbMedia").PTT)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO);else if(a===d("MAWDbMedia").GIF)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE);else if(a===d("MAWDbMedia").STICKER)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER);else if(a===d("MAWDbMedia").DOCUMENT_FILE)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE);return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").NONE)}g.mediaTypeToMessageAttachmentType=a}),98);
__d("MAWBridgeNewMediaHandler",["I64","LSAuthorityLevel","LSIntEnum","LSThreadMediaGalleryGroup","MAWDbMedia","MAWMedia","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,e,f,g,h){var k=b.messagesSortOrderMs?(i||(i=d("I64"))).of_float(b.messagesSortOrderMs[e]):b.sortOrderMs!=null?(i||(i=d("I64"))).of_float(b.sortOrderMs):(i||(i=d("I64"))).of_float(b.ts*1e3);return{attachmentFbid:f,attachmentIndex:(f=a==null?void 0:a.attachmentIndex)!=null?f:(i||(i=d("I64"))).zero,attachmentType:(f=a==null?void 0:a.attachmentType)!=null?f:d("MAWMedia").mediaTypeToMessageAttachmentType(b.mediaType,b.ephemeralMediaViewMode),authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),ephemeralMediaState:b.ephemeralMediaState!=null?(i||(i=d("I64"))).of_int32(b.ephemeralMediaState):a==null?void 0:a.ephemeralMediaState,ephemeralMediaViewMode:b.ephemeralMediaViewMode!=null?(i||(i=d("I64"))).of_int32(b.ephemeralMediaViewMode):a==null?void 0:a.ephemeralMediaViewMode,filename:(f=(f=b.filenames!=null?b.filenames[e]:null)!=null?f:b.defaultFilename)!=null?f:a==null?void 0:a.filename,filesize:b.filesize==null?a==null?void 0:a.filesize:(i||(i=d("I64"))).of_int32(b.filesize),hasMedia:b.hasMedia,hasXma:!1,isSharable:!1,messageId:e,offlineAttachmentId:g,playableDurationMs:b.duration==null?a==null?void 0:a.playableDurationMs:(i||(i=d("I64"))).of_int32(b.duration),previewHeight:b.previewHeight==null?a==null?void 0:a.previewHeight:(i||(i=d("I64"))).of_int32(b.previewHeight),previewHeightLarge:b.previewHeightLarge==null?a==null?void 0:a.previewHeightLarge:(i||(i=d("I64"))).of_int32(b.previewHeightLarge),previewWidth:b.previewWidth==null?a==null?void 0:a.previewWidth:(i||(i=d("I64"))).of_int32(b.previewWidth),previewWidthLarge:b.previewWidthLarge==null?a==null?void 0:a.previewWidthLarge:(i||(i=d("I64"))).of_int32(b.previewWidthLarge),threadKey:h,timestampMs:k,transportKey:(f=b.transportKey)!=null?f:"WhatsApp"}}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=e.mediaId,j=e.msgIds,l=e.offlineAttachmentId,m=e.plaintextHash,p=n(g,m),q=(g=l)!=null?g:p;m=!1;var r=o(e),s=null;c("qex")._("1483")===!0&&(s=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments_ranges_v2__generated).getKeyRange(f).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,r)}))));yield (h||(h=b("Promise"))).all(j.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=a.attachments,g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(c).getKeyRange(f,b)));b=k(g,e,b,p,q,f);if(g!=null){return c.upsert([g.threadKey,g.messageId,g.attachmentFbid],babelHelpers["extends"]({},b,{transportKey:(g=g.transportKey)!=null?g:b.transportKey}))}e.skipShouldUpdateHasMore!==!0&&s!=null&&(i||(i=d("I64"))).le(b.timestampMs,s.minTimestampMs)&&(m=!0);return c.add(b)});return function(a){return c.apply(this,arguments)}}()));if(s!=null&&m&&c("qex")._("1483")===!0){l=babelHelpers["extends"]({},s,{hasMoreBefore:!0});yield a.attachments_ranges_v2__generated.upsert([f,r,l.minTimestampMs],l)}});return m.apply(this,arguments)}function n(a,b){return""+((b=b)!=null?b:a.toString())}function o(a){switch(a.mediaType){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS);case d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY);default:return(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS)}}function a(a,b){var c=b.threadJid;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c,"MAWBridgeNewMediaHandler",function(a,c){return l(a,b,c)})}g.getAttachmentFromBridgeMedia=k;g.callWithoutWaitingForAnything=l;g.getAttachmentID=n;g.call=a}),98);
__d("LSUpsertAttachmentRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.db.table(17).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(c){return b.db.table(17).add({threadKey:a[0],mediaGroup:a[1],minTimestampMs:a[2],maxTimestampMs:b.i64.cast([2328,1316134911]),hasMoreBefore:a[3],hasMoreAfter:!1,isLoadingBefore:!1,isLoadingAfter:!1,lastLoadedMessageId:a[4]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpsertAttachmentRangeStoredProcedure";e.exports=a}),null);
__d("LSUpsertAttachmentRangeStoredProcedure",["LSUpsertAttachmentRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.mediaGroup;d[2]=b.newMinTs;d[3]=b.hasMoreBefore;d[4]=b.newLastLoadedMessageId;return c("LSUpsertAttachmentRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeNewMediaRangeHandler",["I64","LSFactory","LSIntEnum","LSThreadMediaGalleryGroup","LSUpsertAttachmentRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeNewMediaRangeHandler",function(a,e){var f=c("gkx")("2616")===!0?(h||(h=d("I64"))).of_float(b.earliestLoadedMediaTs):(h||(h=d("I64"))).of_int32(b.earliestLoadedMediaTs),g=b.hasMoreBefore,j=b.mediaGalleryGroup;return c("LSUpsertAttachmentRangeStoredProcedure")(c("LSFactory")(a),{hasMoreBefore:g,mediaGroup:j!=null&&c("gkx")("1338")===!0?(i||(i=d("LSIntEnum"))).ofNumber(j):(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),newLastLoadedMessageId:b.lastLoadedMessageId,newMinTs:f,threadKey:e})})}function a(a,b){return j(a,b).then(c("emptyFunction"))}g.call=a}),98);
__d("MAWBridgeNewMsgHandler",["I64","LSAuthorityLevel","LSIntEnum","LSMessageRenderingType","LSMessageUnsendabilityStatus","LSQuickReplyType","MAWAckLevel","MAWAdminMsgCTA","MAWBridgeBuildMsg","MAWBridgeMsg","MAWBridgeMsgUtils","MAWMiActOnMiThreadReadyForJid","MAWMsg","MAWMsgReply","MAWMsgReplySnippet","MAWMsgReplyStatus","MAWTimeUtils","MAWUpdateMsg","MAWXMAUtils","MWPBumpEntityKey","Promise","QPLUserFlow","ReQL","asyncToGeneratorRuntime","gkx","qpl","sendToSentQPLUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,e,f){var g;g=d("MAWTimeUtils").toTimestamp(b.type_===d("MAWMsg").unsent?(g=b.originalTs)!=null?g:b.ts:b.ts);var h=d("MAWBridgeBuildMsg").buildMessage(b,f),k=d("MAWBridgeMsgUtils").convertStringToLSTransportKeyType(b.transportKey);if(d("MAWMsgReply").getReplyAttachmentId(b)!=null&&d("MAWMsgReply").getReplyAttachmentPlaintextHash(b)==null){var l;d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.reply_attachment_media_missing_plaintext_hash","new_message_handler_for_reply_type_"+(i||(i=d("I64"))).to_float((l=d("MAWMsgReply").getReplyAttachmentType(b))!=null?l:(i||(i=d("I64"))).zero))}return babelHelpers["extends"]({},h,{adminMsgCtaId:e==null?void 0:e.ctaId,adminMsgCtaTitle:e==null?void 0:e.title,adminMsgCtaType:e==null?void 0:e.ctaType,authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),cannotUnsendReason:b.type_===d("MAWMsg").unsent||!b.isAuthorMe?(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageUnsendabilityStatus").DENY_FOR_NON_SENDER):void 0,displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(b.type_,b.isForwarded,b.isExpiredXmaMsg,b.replySourceId!=null,b.unsupportedType),editCount:(i||(i=d("I64"))).of_int32((l=b.editCount)!=null?l:0),ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(b),ephemeralExpirationTs:void 0,forwardScore:i.of_float(b.forwardingScore),groupId:(h=b.groupId)!=null?h:void 0,groupIndex:b.groupIndex!=null?(i||(i=d("I64"))).of_float(b.groupIndex):void 0,groupSize:b.groupSize!=null?(i||(i=d("I64"))).of_float(b.groupSize):void 0,hasQuickReplies:!1,hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(b),isAdminMessage:b.isAdminMessage,isCollapsed:!1,isExpired:!1,isForwarded:b.isForwarded,isUnsent:b.type_===d("MAWMsg").unsent,localDataId:void 0,messageId:b.msgId,messageRenderingType:j.ofNumber(c("LSMessageRenderingType").DEFAULT),msUntilExpirationTs:void 0,offlineThreadingId:b.externalId,primarySortKey:i.of_float(b.sortOrderMs),quickReplyType:j.ofNumber(c("LSQuickReplyType").NONE),replyAttachmentExtra:void 0,replyAttachmentId:d("MAWMsgReply").getReplyAttachmentId(b),replyAttachmentPlaintextHash:d("MAWMsgReply").getReplyAttachmentPlaintextHash(b),replyAttachmentType:d("MAWMsgReply").getReplyAttachmentType(b),replyCtaId:void 0,replyCtaTitle:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply").getReplyMediaExpirationTimestampMs(b),replyMediaPreviewHeight:d("MAWMsgReply").getReplyMediaHeight(b),replyMediaPreviewWidth:d("MAWMsgReply").getReplyMediaWidth(b),replyMediaUrl:void 0,replyMediaUrlFallback:void 0,replyMediaUrlMimeType:d("MAWMsgReply").getReplyMediaMimeType(b),replySnippet:f,replySourceId:d("MAWMsgReply").getReplySourceId(b),replySourceTimestampMs:c("gkx")("4889")?d("MAWMsgReply").getReplyTimestampMs(b):void 0,replySourceType:d("MAWMsgReply").getReplySourceType(b),replySourceTypeV2:d("MAWMsgReply").getReplySourceTypeV2(b),replyStatus:d("MAWMsgReplyStatus").getLSReplyMessageStatus(b),replyToUserId:d("MAWMsgReply").getReplyUserId(b),replyType:d("MAWMsgReply").getReplyType(b),secondarySortKey:void 0,senderId:i.of_string(b.sender),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(b.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack),stickerId:void 0,subscriptErrorMessage:void 0,takedownState:void 0,textHasLinks:!1,threadKey:a,timestampMs:g,transportKey:k,unsentTimestampMs:d("MAWTimeUtils").toTimestamp(b.ts),viewedPluginContext:void 0,viewedPluginKey:void 0,viewFlags:j.ofNumber(0)})}function l(a,b,c,d,e){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){c.unsupportedType==="stickerReceiverFetchMessage"&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.new_msg_handler","sticker_receiver_fetch_fallback");b=k(b,c,e,f);yield a.messages.add(b)});return m.apply(this,arguments)}function n(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.chatJid,"BridgeNewMsgHandler",function(a,c){return o(a,b,c)})}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){if(d("MAWXMAUtils").isXMAStoryReply(e.xmaMessageType))return;var g=(yield d("MAWAdminMsgCTA").getAdminMsgCtaStep(a,f,e)),j=(yield d("MAWMsgReplySnippet").getReplySnippet(e)),k=e.offlineMsg,m=c("gkx")("23961");if(k==null&&!m)return l(a,f,e,g,j);var n;k!=null&&(n=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages).getKeyRange(f,(i||(i=d("I64"))).of_float(k.ts),k.msgId))));if(n==null){k=!1;if(m&&e.externalId!=null){m=e.externalId;n=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages.index("optimistic")).getKeyRange(m)));if(n!=null){(i||(i=d("I64"))).to_int32(n.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC&&(k=!0,yield d("MAWUpdateMsg").call(a,e,n,g,j));m=(yield s(a,f,m));yield u(a,m,e.msgId,c("LSAuthorityLevel").AUTHORITATIVE);return(h||(h=b("Promise"))).resolve()}}if(!k)return l(a,f,e,g,j)}else{yield d("MAWUpdateMsg").call(a,e,n,g,j);m=[n.offlineThreadingId];m.forEach(function(a){a!=null&&q(a,e.instanceKey)})}});return p.apply(this,arguments)}function q(a,b){a=(a=d("sendToSentQPLUtils").getS2sKeyFromOfflineMessageId(a))!=null?a:b;a!=null&&c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"update_optimistic_message",{instanceKey:a})}function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){yield (h||(h=b("Promise"))).all(c.map(function(b){return n(a,b)}))});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(b,e)));return a.filter(function(a){return(i||(i=d("I64"))).to_int32(a.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC})});return t.apply(this,arguments)}function u(a,b,c,d){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){yield (h||(h=b("Promise"))).all(c.map(function(b){var c=babelHelpers["extends"]({},b,{messageId:e});f!=null&&(c.authorityLevel=(j||(j=d("LSIntEnum"))).ofNumber(f));return a.attachments.upsert([b.threadKey,b.messageId,b.attachmentFbid],c)}))});return v.apply(this,arguments)}g.composeMessage=k;g.call=n;g.callWithoutWaitingForAnything=o;g.bulkCall=a}),98);
__d("MAWBridgeNewReceiverFetchInfoHandler",["FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMediaUrlUtils","MAWImageUtils","MAWMiActOnMiThreadReadyForJid","MessagingAttachmentType","Promise","ReQL","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.msgId,f=b.receiverFetchId,g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(c,e)));b=m(b,c,g);yield a.attachments.upsert([c,e,f],b)});return l.apply(this,arguments)}function a(a,e){return!c("gkx")("5624")?(j||(j=b("Promise"))).resolve():d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"BridgeNewReceiverFetchInfoHandler",function(a,b){return k(a,e,b)})}function m(a,b,e){var f,g=a.mimetype,j=a.msgId,k=a.previewHeight,l=a.previewUrl,m=a.previewUrlExpirationTimestampMs,o=a.previewWidth,p=a.ravenSettings,q=a.receiverFetchId,r=a.sortOrderMs,s=a.transportKey;a=a.type;a=n(a);k=d("MAWImageUtils").boundHeightWidth(k,o,d("MAWImageUtils").STICKER_THUMBNAIL_MAX_SIZE);o=k.height;k=k.width;f=(f=l)!=null?f:e==null?void 0:e.previewUrl;var t=m!=null?(h||(h=d("I64"))).of_float(m):e==null?void 0:e.previewUrlExpirationTimestampMs;f=d("LSMediaUrlUtils").hasValidReceiverFetchPreviewUrl(f,t);return{attachmentFbid:q,attachmentIndex:(h||(h=d("I64"))).zero,attachmentType:a,authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),ephemeralMediaState:(p==null?void 0:p.ephemeralMediaState)!=null?(h||(h=d("I64"))).of_int32(p.ephemeralMediaState):void 0,ephemeralMediaViewMode:(p==null?void 0:p.ephemeralMediaViewMode)!=null?(h||(h=d("I64"))).of_int32(p.ephemeralMediaViewMode):void 0,hasMedia:f,hasXma:!1,isSharable:!1,messageId:j,previewHeight:h.of_int32(o),previewUrl:(t=l)!=null?t:e==null?void 0:e.previewUrl,previewUrlExpirationTimestampMs:m!=null?(h||(h=d("I64"))).of_float(m):e==null?void 0:e.previewUrlExpirationTimestampMs,previewUrlMimeType:g,previewWidth:h.of_int32(k),receiverFetchId:q,threadKey:b,timestampMs:h.of_float(r),transportKey:(a=s)!=null?a:"WhatsApp"}}function n(a){switch(a){case"sticker":return(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER);default:throw c("FBLogger")("messenger_web_media").mustfixThrow("Unsupported type for MAWBridgeNewReceiverFetchInfoHandler")}}g.call=a;g.composeAttachment=m}),98);
__d("MAWBridgeHandleReceiverFetchXMA",["FBLogger","I64","LSIntEnum","LSXmaContentType","MAWDbMsg","MessagingAttachmentType","ReQL","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=b.contentRef,g=b.defaultPreviewMediaId,j=b.msgId,k=b.subtitleText,l=b.titleText;b=b.xmaId;if(j==null)return;var m=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(e,j)));if(m!=null)return;m=String(b);b=(h||(h=d("I64"))).of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(j));if(f==null){var n="contentRef is empty for a MSG_RECEIVER_FETCH XMA";c("FBLogger")("messenger_web_sharing").mustfix(n);return}var o;try{n=JSON.parse(f);f=n.fetch_params;f!=null&&(o=JSON.stringify(f))}catch(a){n="Failed to parse msg.contentRef as XmsgMsgrXmaContentRefDataclass";c("FBLogger")("messenger_web_sharing").mustfix(n);return}f=c("justknobx")._("2796");if(!f){n=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages.index("messageId")).getKeyRange(j)));if(n==null){var p="message does not exist to handle receiver fetch XMA";c("FBLogger")("messenger_web_sharing").mustfix(p);return}yield a.messages.put(babelHelpers["extends"]({},n,{xmaReceiverFetchParams:o}))}yield a.attachments.add(babelHelpers["extends"]({attachmentFbid:m,attachmentIndex:h.zero,attachmentType:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA),authorityLevel:h.zero,hasMedia:!1,hasXma:!0,hasXmaPreview:g!=null,isSharable:!0,messageId:j,subtitleText:k,threadKey:e,timestampMs:b,titleText:l,transportKey:"WhatsApp",xmaContentType:i.ofNumber(c("LSXmaContentType").MSG_RECEIVER_FETCH)},f&&{receiverFetchId:o}));return});return j.apply(this,arguments)}g.call=a}),98);
__d("MAWConvertExtendedContentTypeToLSXmaContentType",["LSXmaContentType","WAArmadilloXMA.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:return c("LSXmaContentType").FB_FEED_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:return c("LSXmaContentType").FB_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:return c("LSXmaContentType").FB_STORY_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return c("LSXmaContentType").FB_STORY_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:return c("LSXmaContentType").FB_FEED_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:return c("LSXmaContentType").FB_GAMING_CUSTOM_UPDATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return c("LSXmaContentType").FB_PRODUCER_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:return c("LSXmaContentType").FB_EVENT;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:return c("LSXmaContentType").FB_FEED_POST_PRIVATE_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:return c("LSXmaContentType").MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:return c("LSXmaContentType").FB_SHORT;default:return null}}g.convertExtendedContentTypeToLSXmaContentType=a}),98);
__d("getTargetUrlFromContentRefXmaDataclass",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){try{a=JSON.parse(a);return a.target_url}catch(a){c("FBLogger")("messenger_web_sharing").mustfix("Error parsing contentRef for target url");return""}}g["default"]=a}),98);
__d("MAWHandleXMAPreviewOptOut",["FBLogger","I64","LSIntEnum","MAWMsg","MAWMsgType","ReQL","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getTargetUrlFromContentRefXmaDataclass","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){return c("isStringNullOrEmpty")(a)?b:a+" "+b}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.msgId;if(e==null){c("FBLogger")("messenger_web_sharing").mustfix("BridgeXMA msgId is null to handle the opt-out experience for XMAs");return}e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages.index("messageId")).getKeyRange(e)));if(e==null||(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(1)))return;var f;if(b.targetType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH&&b.contentRef!=null)f=c("getTargetUrlFromContentRefXmaDataclass")(b.contentRef);else{var g;f=(g=b==null?void 0:(g=b.defaultCTA)==null?void 0:g.actionUrl)!=null?g:b==null?void 0:(g=b.defaultCTA)==null?void 0:g.nativeUrl}if(f!=null){yield a.messages.put(babelHelpers["extends"]({},e,{displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(d("MAWMsgType").MSG_TYPE.TEXT,(g=e.isForwarded)!=null?g:!1,!1,!1),text:(g=j(e.text,f))!=null?g:""}))}else c("FBLogger")("messenger_e2ee_web").mustfix("Failed to get a target URL for XMA, where user opted out of previews. XMA target type=%s",b.targetType),yield a.messages.put(babelHelpers["extends"]({},e,{displayedContentTypes:(i||(i=d("LSIntEnum"))).ofNumber(262144)}))});return k.apply(this,arguments)}g.call=a}),98);
__d("getXMAPreviewsDisabledSettings",["MessengerWebPrivacySettings","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messaging_privacy_settings)));return a==null?c("MessengerWebPrivacySettings").e2ee_xma_previews_disabled:(a=a==null?void 0:a.e2eeXmaPreviewsDisabled)!=null?a:!1});return h.apply(this,arguments)}g.getXMAPreviewsDisabledSettings=a}),98);
__d("MAWBridgeNewXMAHandler",["I64","LSIntEnum","MAWBridgeHandleReceiverFetchXMA","MAWBridgeUIEventDataValidation","MAWConvertExtendedContentTypeToLSXmaContentType","MAWDbMsg","MAWHandleXMAPreviewOptOut","MAWMiActOnMiThreadReadyForJid","MNLSXMALayoutType","MNXMAPreviewImageDecorationType","MessagingAttachmentType","Promise","Random","ReQL","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getXMAPreviewsDisabledSettings","gkx","isReceiverFetchDualSendReceivingEnabled","isReceiverFetchReceivingEnabled"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){if(a==null)return;a=a[b-1];if(a==null)return;return a.buttonType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE?"xma_open_native":void 0}function l(a,b){if(a==null)return;a=a[b-1];if(a!=null)return a.title}function m(a){return a===0||a!==3?(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").SINGLE):(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").PORTRAIT)}function n(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").COLLAGE);case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").REEL);case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").INSTAGRAM_ICON);default:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").DEFAULT)}}function o(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:return!0;default:return!1}}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=String(b.xmaId),g=b.msgId;if(g==null)return;var h=(j||(j=d("I64"))).of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(g)),p=b.targetType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH,q=(yield d("getXMAPreviewsDisabledSettings").getXMAPreviewsDisabledSettings(a));if(q&&o(b.targetType))return d("MAWHandleXMAPreviewOptOut").call(a,b);if(p){q=b.defaultPreviewMediaId!=null;p=q?c("isReceiverFetchDualSendReceivingEnabled")(!0):c("isReceiverFetchReceivingEnabled")(!0);if(p)return d("MAWBridgeHandleReceiverFetchXMA").call(a,b,e)}q=(yield w(a,e,g));p=q[0];q=q[1];q=(yield s(a,b,e,g,f,q));var r=q.attachmentCta1Id,t=q.attachmentCta2Id,u=q.attachmentCta3Id;q=q.defaultCtaId;var v;switch(b.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:v={height:(j||(j=d("I64"))).of_int32(108),width:(j||(j=d("I64"))).of_int32(72),xmaContentType:"xma_montage_share"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:v={xmaContentType:"xma_rtc_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:v={xmaContentType:"xma_rtc_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:v={xmaContentType:"xma_rtc_missed_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:v={xmaContentType:"xma_rtc_missed_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:v={xmaContentType:"xma_rtc_missed_group_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:v={xmaContentType:"xma_rtc_missed_group_video"};break;default:v={height:b.previewHeight!=null?(j||(j=d("I64"))).of_int32(b.previewHeight):void 0,width:b.previewWidth!=null?(j||(j=d("I64"))).of_int32(b.previewWidth):void 0,xmaContentType:"xma_web_url"};break}var x=d("MAWConvertExtendedContentTypeToLSXmaContentType").convertExtendedContentTypeToLSXmaContentType(b.targetType);x=x?(j||(j=d("I64"))).of_int32(x):void 0;u={accessibilitySummaryText:void 0,actionUrl:void 0,attachmentCta1Id:r,attachmentCta2Id:t,attachmentCta3Id:u,attachmentFbid:f,attachmentIndex:j.zero,attachmentLoggingType:void 0,attachmentType:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA),attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,attributionAppId:void 0,attributionAppName:void 0,authorityLevel:j.zero,avatarCount:void 0,avatarViewAccessibilityLabel:void 0,avatarViewSize:void 0,avatarViewTitleList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewUrlList:void 0,captionBodyText:void 0,cta1Title:l(b.ctas,1),cta1Type:k(b.ctas,1),cta2Title:l(b.ctas,2),cta2Type:k(b.ctas,2),cta3Title:l(b.ctas,3),cta3Type:k(b.ctas,3),dashManifest:void 0,decryptionKey:void 0,defaultCtaId:q,defaultCtaTitle:(r=b.defaultCTA)==null?void 0:r.title,defaultCtaType:v.xmaContentType,descriptionText:void 0,ephemeralMediaState:void 0,faviconUrl:void 0,faviconUrlExpirationTimestampMs:void 0,faviconUrlFallback:void 0,filename:void 0,filesize:b.filesize!=null?(j||(j=d("I64"))).of_int32(b.filesize):void 0,gatingTitle:b.overlayTitle,gatingType:b.overlayIconGlyph!=null?String(b.overlayIconGlyph):void 0,hasMedia:c("gkx")("821")&&b.hasMedia!=null?b.hasMedia:!1,hasXma:!0,hasXmaFavicon:b.faviconMediaId!=null,hasXmaHeaderImage:b.headerMediaId!=null,hasXmaPreview:b.defaultPreviewMediaId!=null,headerImageUrl:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlFallback:void 0,headerImageUrlMimeType:void 0,headerTitle:b.headerTitle,imageUrl:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlFallback:void 0,imageUrlMimeType:void 0,isBorderless:void 0,isPreviewImage:void 0,isSharable:!0,listItemAccessibilityText1:void 0,listItemAccessibilityText2:void 0,listItemAccessibilityText3:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList1:void 0,listItemContactUrlFallbackList2:void 0,listItemContactUrlFallbackList3:void 0,listItemContactUrlList1:void 0,listItemContactUrlList2:void 0,listItemContactUrlList3:void 0,listItemId1:void 0,listItemId2:void 0,listItemId3:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrlFallback3:void 0,listItemProgressBarFilledPercentage1:void 0,listItemProgressBarFilledPercentage2:void 0,listItemProgressBarFilledPercentage3:void 0,listItemsDescriptionSubtitleText:void 0,listItemsDescriptionText:void 0,listItemsId:void 0,listItemsSecondaryDescriptionText:void 0,listItemTitleText1:void 0,listItemTitleText2:void 0,listItemTitleText3:void 0,localPlayableUrl:void 0,maxSubtitleNumOfLines:b.maxSubtitleNumOfLines!=null?(j||(j=d("I64"))).of_int32(b.maxSubtitleNumOfLines):void 0,maxTitleNumOfLines:b.maxTitleNumOfLines!=null?(j||(j=d("I64"))).of_int32(b.maxTitleNumOfLines):void 0,messageId:g,miniPreview:void 0,offlineAttachmentId:(t=b.offlineAttachmentId)!=null?t:f,originalFileHash:void 0,originalPageSenderId:void 0,playableDurationMs:void 0,playableUrl:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlFallback:void 0,playableUrlMimeType:void 0,preheaderText:void 0,previewHeight:v.height,previewHeightLarge:b.previewHeightLarge!=null?(j||(j=d("I64"))).of_int32(b.previewHeightLarge):void 0,previewImageDecorationType:n(b.targetType),previewUrl:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlFallback:void 0,previewUrlLarge:void 0,previewUrlMimeType:void 0,previewWidth:v.width,previewWidthLarge:b.previewWidthLarge!=null?(j||(j=d("I64"))).of_int32(b.previewWidthLarge):void 0,samplingFrequencyHz:void 0,shouldAutoplayVideo:void 0,shouldHighlightHeaderTitleInTitle:void 0,shouldRespectServerPreviewSize:void 0,sourceText:void 0,subtitleIconUrl:void 0,subtitleText:b.subtitleText,targetId:void 0,threadKey:e,timestampMs:h,titleText:b.titleText,transportKey:"WhatsApp",viewerSeenTimestampMs:void 0,waveformData:void 0,xmaContentType:x,xmaLayoutType:b.xmaLayoutType!=null?m(b.xmaLayoutType):void 0,xmasTemplateType:b.xmaLayoutType!=null?m(b.xmaLayoutType):void 0};p!=null?yield a.attachments.upsert([p.threadKey,p.messageId,p.attachmentFbid],u):yield a.attachments.add(u)});return q.apply(this,arguments)}function r(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeNewXMAHandler",function(a,c){return p(a,b,c)})}function a(a,b){return r(a,b)}function s(a,b,c,d,e,f){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,i){var k=(j||(j=d("I64"))).of_int32(d("Random").uint32()),l=c.defaultCTA;if(l!=null){var m="xma_web_url";switch(c.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:m="xma_rtc_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:m="xma_rtc_video";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:m="xma_rtc_missed_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:m="xma_rtc_missed_video";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:m="igd_web_post_share";break}var n=c.targetId!=null?d("MAWBridgeUIEventDataValidation").stringToI64Opt(c.targetId):void 0;yield u(a,l,k,f,e,g,n,m,i.defaultCta)}n=l==null?void 0:k;var o=k;m=[];l=c.ctas;l!=null&&(m=(yield (h||(h=b("Promise"))).all(l.map(function(b,c){var h=(j||(j=d("I64"))).add(o,j.of_int32(c+1));c=c===0?i.attachmentCta1:c===1?i.attachmentCta2:c===2?i.attachmentCta3:void 0;return u(a,b,h,f,e,g,void 0,void 0,c)}))));return{attachmentCta1Id:m.length>0?m[0]:void 0,attachmentCta2Id:m.length>1?m[1]:void 0,attachmentCta3Id:m.length>2?m[2]:void 0,defaultCtaId:n}});return t.apply(this,arguments)}function u(a,b,c,d,e,f,g,h,i){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h,i,k,l){k===void 0&&(k="xma_web_url");var m=b.actionUrl,n=b.nativeUrl;m={actionContentBlob:void 0,actionUrl:m!=null?m:n,attachmentFbid:h,attachmentIndex:(j||(j=d("I64"))).zero,ctaId:e,enableExtensions:!1,extensionHeightType:void 0,messageId:f,nativeUrl:n!=null?n:m,platformToken:void 0,targetId:(h=i)!=null?h:void 0,threadKey:g,title:(f=b.title)!=null?f:"Tap to view status update",type_:(n=k)!=null?n:"xma_web_url",urlWebviewType:void 0};l!=null&&c("gkx")("821")?yield a.attachment_ctas.upsert([l.ctaId],m):yield a.attachment_ctas.add(m);return e});return v.apply(this,arguments)}function w(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=null,f={attachmentCta1:void 0,attachmentCta2:void 0,attachmentCta3:void 0,defaultCta:void 0};e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(b,c)));e!=null&&(f.defaultCta=(yield y(a,e.defaultCtaId)),f.attachmentCta1=(yield y(a,e.attachmentCta1Id)),f.attachmentCta2=(yield y(a,e.attachmentCta2Id)),f.attachmentCta3=(yield y(a,e.attachmentCta3Id)));return[e,f]});return x.apply(this,arguments)}function y(a,c){return c==null?(h||(h=b("Promise"))).resolve(void 0):(a=d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachment_ctas).getKeyRange(c)))!=null?a:void 0}g.callWithoutWaitingForAnything=p;g.call=a}),98);
__d("LSCoreClientFolderType",[],(function(a,b,c,d,e,f){a=Object.freeze({INBOX:0,PENDING:1,OTHER:2,SPAM:3,ARCHIVED:4,HIDDEN:5,MARKETPLACE:12,RESTRICTED:15,INTEROP:19});f["default"]=a}),66);
__d("LSCreateE2EEMetadataThread",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("offline_thread_key",a[1]),d[0].set("thread_type",a[2]),d[0].set("folder_type",a[3]),d[0].set("bump_timestamp_ms",a[4]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[0].set("created_by_local_device",a[5]),d[1]=d[0].get("offline_thread_key"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,388]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxCreateE2EEMetadataThreadStoredProcedure";e.exports=a}),null);
__d("LSCreateE2EEMetadataThreadStoredProcedure",["LSCreateE2EEMetadataThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.waJid;d[1]=b.offlineThreadKey;d[2]=b.threadType;d[3]=b.folderType;d[4]=b.bumpTimestampMs;d[5]=b.createdByLocalDevice;return c("LSCreateE2EEMetadataThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSCreateOfflineThreadingIDStoredProcedure",["LSCreateOfflineThreadingID","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.timestampMs;return c("LSCreateOfflineThreadingID").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWCreateOptimisticThread",["I64","LSAuthorityLevel","LSCreateOfflineThreadingIDStoredProcedure","LSFactory","LSIntEnum","LSMailboxType","LSRtcCallState","ReQL","WAJids","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("LSCreateOfflineThreadingIDStoredProcedure")(c("LSFactory")(a),{timestampMs:(h||(h=d("I64"))).of_float(Date.now())}));b=b[0];var e={authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),folderName:"inbox",lastReadWatermarkTimestampMs:h.of_float(0),mailboxType:i.ofNumber(c("LSMailboxType").MESSENGER),ongoingCallState:i.ofNumber(c("LSRtcCallState").NO_ONGOING_CALL),parentThreadKey:h.zero,threadKey:b,threadType:i.ofNumber(15)};yield a.threads.put(e);return b});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(h||(h=d("I64"))).of_string(d("WAJids").threadIdForChatJid(b));return(a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table.index("jid")).getKeyRange(b))))==null?void 0:a.serverThreadKey});return m.apply(this,arguments)}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(h||(h=d("I64"))).of_string(d("WAJids").threadIdForChatJid(b));b=(yield l(a,b));if(b!=null)return b;b=(yield j(a));yield a.mi_act_mapping_table.add({clientThreadPk:c,jid:c,serverThreadKey:b});return b});return n.apply(this,arguments)}g.createOptimisticThread=j;g.getThreadKey=l;g.getOrCreateOptimisticThreadKey=a}),98);
__d("MAWFolderUtils",["LSCoreClientFolderType","LSIntEnum","MAWFolderTypes","MessagingFolderTag"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case d("MAWFolderTypes").PENDING:return c("MessagingFolderTag").PENDING;case d("MAWFolderTypes").OTHER:return c("MessagingFolderTag").OTHER;case d("MAWFolderTypes").SPAM:return c("MessagingFolderTag").SPAM;case d("MAWFolderTypes").ARCHIVED:return c("MessagingFolderTag").UNKNOWN;default:return c("MessagingFolderTag").INBOX}}function b(a){switch(a){case d("MAWFolderTypes").PENDING:return(h||(h=d("LSIntEnum"))).ofNumber(-101);case d("MAWFolderTypes").OTHER:return(h||(h=d("LSIntEnum"))).ofNumber(-102);case d("MAWFolderTypes").SPAM:return(h||(h=d("LSIntEnum"))).ofNumber(-103);case d("MAWFolderTypes").ARCHIVED:return(h||(h=d("LSIntEnum"))).ofNumber(-110);default:return(h||(h=d("LSIntEnum"))).ofNumber(-100)}}function e(a){switch(a){case d("MAWFolderTypes").INBOX:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").INBOX);case d("MAWFolderTypes").PENDING:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").PENDING);case d("MAWFolderTypes").OTHER:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").OTHER);case d("MAWFolderTypes").SPAM:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").SPAM);case d("MAWFolderTypes").ARCHIVED:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").ARCHIVED)}}function f(a){switch(a){case(h||(h=d("LSIntEnum"))).ofNumber(-1):return(h||(h=d("LSIntEnum"))).ofNumber(-101);case(h||(h=d("LSIntEnum"))).ofNumber(-2):return(h||(h=d("LSIntEnum"))).ofNumber(-102);case(h||(h=d("LSIntEnum"))).ofNumber(-3):return(h||(h=d("LSIntEnum"))).ofNumber(-103);case(h||(h=d("LSIntEnum"))).ofNumber(-10):return(h||(h=d("LSIntEnum"))).ofNumber(-110);default:return(h||(h=d("LSIntEnum"))).ofNumber(-100)}}g.getMessagingFolderTag=a;g.getClientSystemFolder=b;g.systemFolderToLSCoreClientFolder=e;g.systemFolderToClientSystemFolder=f}),98);
__d("MAWThreadDefaults",["fbt","I64","LSBitOffset","LSIntEnum","qex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function k(){if(c("qex")._("327")===!0)return!0;else return c("qex")._("121")===!0}function a(a){if(k())return d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(42),a);else return a}function b(a){return d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(4),a)}e=d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(18),d("LSBitOffset").set(j.ofNumber(56),d("LSBitOffset").set(j.ofNumber(14),d("LSBitOffset").set(j.ofNumber(23),d("LSBitOffset").set(j.ofNumber(8),d("LSBitOffset").set(j.ofNumber(15),d("LSBitOffset").set(j.ofNumber(2),d("LSBitOffset").empty)))))));f=a(b(d("LSBitOffset").set(j.ofNumber(7),d("LSBitOffset").set(j.ofNumber(6),d("LSBitOffset").set(j.ofNumber(9),d("LSBitOffset").set(j.ofNumber(10),d("LSBitOffset").set(j.ofNumber(19),d("LSBitOffset").set(j.ofNumber(35),d("LSBitOffset").set(j.ofNumber(3),d("LSBitOffset").set(j.ofNumber(43),e))))))))));a=d("LSBitOffset").set(j.ofNumber(17),d("LSBitOffset").set(j.ofNumber(60),d("LSBitOffset").set(j.ofNumber(16),d("LSBitOffset").set(j.ofNumber(26),d("LSBitOffset").set(j.ofNumber(28),d("LSBitOffset").clear(j.ofNumber(27),f))))));b=d("LSBitOffset").set((i||(i=d("I64"))).sub(j.ofNumber(103),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(85),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(109),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(74),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(65),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(64),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(106),i.of_string("64")),d("LSBitOffset").empty)))))));e=h._("__JHASH__9ZFn8zMzjpf__JHASH__").toString();h=d("LSBitOffset").set(i.sub(j.ofNumber(172),i.of_string("64")),d("LSBitOffset").empty);g.defaultThreadCapabilities=f;g.defaultGroupThreadCapabilities=a;g.defaultThreadCapabilities_2=b;g.nullstateDescriptionText1=e;g.defaultThreadCapabilities_3=h;g.defaultThreadCapabilities_4=d("LSBitOffset").empty}),226);
__d("MAWBridgeOccamadilloVerifyThreadExistsHandler",["DateConsts","FBLogger","I64","LSAuthorityLevel","LSCoreClientFolderType","LSCreateE2EEMetadataThreadStoredProcedure","LSFactory","LSIntEnum","LSThreadBitOffset","MAWBridgeFireAndForget","MAWCreateOptimisticThread","MAWFolderUtils","MAWMiActGetThreadLifecycleState","MAWMiActOnActThreadReadyQueue","MAWMiActThreadLifecycleState","MAWThreadDefaults","MAWTimeUtils","Promise","WAJids","WALoggerDeferred","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Thread loading complete: jid ",", threadKey ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] New authoritative thread: jid ",", threadKey: ","), state: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Notifying MI server about thread: jid ",", state: ",". "]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Authoritative thread not found for clientThreadPk: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Thread is missing in Occamadillo verify thread exists"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Duplicated thread creation for ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Duplicated thread creation.\n      threadKey: ","\n      bumpTimestampMs: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Creating e2ee metadata optimistic thread.\n  threadKey: ","\n  bumpTimestampMs: ",",\n  description: ",",\n  createdByLocalDevice: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] Last activity timestamp = 0 from MI for thread: ",", using local state timestamp: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occam] no folder type was supplied to Occamadillo verify thread exists handler"]);t=function(){return a};return a}var u=new Set();function v(a){return(i||(i=d("I64"))).of_string(d("WAJids").threadIdForChatJid(a))}function w(a){a=d("MAWFolderUtils").systemFolderToLSCoreClientFolder(a);a==null&&(c("promiseDone")(d("WALoggerDeferred").WARN(t())),a=(i||(i=d("I64"))).of_int32(c("LSCoreClientFolderType").INBOX));return a}function x(a,b){return b==null?d("MAWCreateOptimisticThread").createOptimisticThread(a):(i||(i=d("I64"))).of_string(b)}function y(a){a=d("MAWTimeUtils").millisTimeToTimestamp(a);return(i||(i=d("I64"))).equal(a,(i||(i=d("I64"))).zero)?d("MAWTimeUtils").millisTimeToTimestamp(d("WATimeUtils").millisTime()):a}var z=new Set();function A(a,b,c){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=c("LSFactory")(a),g=y(b.lastActivityTs),h=(yield x(a,b.clientThreadKey)),k=w(b.folder),l=v(b.jid),m=b.isGroup?(j||(j=d("LSIntEnum"))).ofNumber(16):(j||(j=d("LSIntEnum"))).ofNumber(15);yield a.mi_act_mapping_table.put({clientThreadPk:l,jid:l,serverThreadKey:h});a=(i||(i=d("I64"))).to_string(h);var n=b.description;e=c("gkx")("4764")?e.type===d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_WITH_ACT:null;c("promiseDone")(d("WALoggerDeferred").LOG(r(),a,i.to_string(g),n,e));u.has(a)?c("promiseDone")(d("WALoggerDeferred").WARN(q(),a,(i||(i=d("I64"))).to_string(g))):u.add(a);z.has(b.jid)&&d("WATagsLogger").TAGS(["occamadillo","call_create_sproc"]).LOG(p(),b.jid);z.add(b.jid);a=d("WATimeUtils").millisTime();var o=i.to_float(g);Math.abs(o-a)<d("DateConsts").MS_PER_SEC&&c("FBLogger")("messenger_e2ee_web").warn("[GetOrCreateThread] bumpTimestampMs is too close to now. bumpTimestampMs: %s, lastActivityTs: %s, now: %s, description: %s",o,b.lastActivityTs,a,n);return c("LSCreateE2EEMetadataThreadStoredProcedure")(f,{bumpTimestampMs:g,createdByLocalDevice:e,folderType:k,offlineThreadKey:h,threadType:m,waJid:l})});return B.apply(this,arguments)}function C(a,b,e){a=a;(i||(i=d("I64"))).equal(a,(i||(i=d("I64"))).zero)&&(c("promiseDone")(d("WALoggerDeferred").WARN(s(),(i||(i=d("I64"))).to_string(e),i.to_string(b))),a=b);return a}var D=[105,17,25,24];function E(a,b){var c=D.filter(function(b){return d("LSThreadBitOffset").has(b,a)}),e=61,f=d("LSThreadBitOffset").has(e,a);f&&c.push(e);return d("LSThreadBitOffset").set(c,b?d("MAWThreadDefaults").defaultGroupThreadCapabilities:d("MAWThreadDefaults").defaultThreadCapabilities,d("MAWThreadDefaults").defaultThreadCapabilities_2,d("MAWThreadDefaults").defaultThreadCapabilities_3,d("MAWThreadDefaults").defaultThreadCapabilities_4)}function F(a,b,c){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield a.threads.get(e));if(g==null){c("promiseDone")(d("WALoggerDeferred").ERROR(o()));return(h||(h=b("Promise"))).resolve()}var j=f.clientThreadKey!=null?(i||(i=d("I64"))).of_string(f.clientThreadKey):g.clientThreadKey,k=C(g.lastActivityTimestampMs,d("MAWTimeUtils").millisTimeToTimestamp(f.lastActivityTs),e);f=E(g,f.isGroup);return a.threads.upsert([e],babelHelpers["extends"]({},g,{capabilities:f[0],capabilities2:f[1],capabilities3:f[2],capabilities4:f[3],clientThreadKey:j,lastActivityTimestampMs:k}))});return G.apply(this,arguments)}function H(a,b,c){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){yield a.mi_act_mapping_table.put({clientThreadPk:v(d.jid),jid:v(d.jid),serverThreadKey:c}),yield (h||(h=b("Promise"))).all([F(a,c,d),J(a,c,d)])});return I.apply(this,arguments)}function J(a,b,c){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(c.clientThreadKey!=null){c=(i||(i=d("I64"))).of_string(c.clientThreadKey);(i||(i=d("I64"))).equal(b,c)||(yield a.threads["delete"](c))}});return K.apply(this,arguments)}function L(a,b,c){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield a.threads.get(e));g!=null&&(i||(i=d("I64"))).to_int32(g.authorityLevel)===c("LSAuthorityLevel").AUTHORITATIVE&&(yield (h||(h=b("Promise"))).all([F(a,e,f),J(a,e,f)]));g==null&&c("promiseDone")(d("WALoggerDeferred").LOG(n(),v(f.jid)))});return M.apply(this,arguments)}function N(a,b){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f=(i||(i=d("I64"))).of_string(d("WAJids").threadIdForChatJid(b.jid));f=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByJidOrThreadKey(a,f,b.authoritativeThreadKey,"MAWBridgeOccamadilloVerifyThreadExistsHandler"));e=(e=b.description)!=null?e:"unknown";switch(f.type){case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MAPPING_ROW:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_WITH_ACT:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD_WITH_ACT:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.SERVER_PARTIAL_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.THREAD_KEY_ONLY:c("promiseDone")(d("WALoggerDeferred").LOG(m(),b.jid,f.type));return A(a,b,f);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_ONLY:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW:var g=(i||(i=d("I64"))).to_string(f.serverThreadKey);c("promiseDone")(d("WALoggerDeferred").LOG(l(),b.jid,g,f.type));return H(a,f.serverThreadKey,b);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.MI_AND_ACT_THREAD_COMPLETE:g=(i||(i=d("I64"))).to_string(f.serverThreadKey);c("promiseDone")(d("WALoggerDeferred").LOG(k(),b.jid,g));return L(a,f.serverThreadKey,b);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_NO_ACT:throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[Occam] Unimplemented VerifyThreadExists state: %s for JID: %s, from %s",f.type,b.jid,e);default:f.type;throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[Occam] Unhandled VerifyThreadExists state: %s for JID: %s, from %s",f.type,b.jid,e)}});return O.apply(this,arguments)}function P(a,b,c){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield a.threads.get(b));if(a!=null){a={ephemeralExpirationInSec:(i||(i=d("I64"))).to_int32((b=a.disappearingSettingTtl)!=null?b:(i||(i=d("I64"))).zero),ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castMilliSecondsToUnixTime(i.to_float((b=a.disappearingSettingUpdatedTs)!=null?b:(i||(i=d("I64"))).zero))};d("MAWBridgeFireAndForget").fireAndForget("backend","setEphemeralSettingCache",{jid:c,settings:a})}});return Q.apply(this,arguments)}function a(a,b){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield N(a,b);if(b.clientThreadKey!=null){var e=(i||(i=d("I64"))).of_string(b==null?void 0:b.clientThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.jid))}if(b.authoritativeThreadKey!=null){e=(i||(i=d("I64"))).of_string(b.authoritativeThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.jid))}e=(e=b.authoritativeThreadKey)!=null?e:b.clientThreadKey;if(e!=null){e=(i||(i=d("I64"))).of_string(e);yield P(a,e,b.jid)}return});return R.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler",["fbt","FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWContactRelationshipType","MAWMessageRequestUtil","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","WADbContact","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeOneToOneMessageRequestLoadedHandler",function(a,f){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)).then(function(c){if(c==null)return(k||(k=b("Promise"))).resolve([void 0,void 0,void 0,!1]);var f=d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).getKeyRange((i||(i=d("I64"))).of_string(e.fbid)));return(k||(k=b("Promise"))).all([k.resolve(c),f,k.resolve(d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType))])}).then(function(e){var f=e[0];if(f==null)return(k||(k=b("Promise"))).resolve();var g=e[1];if(g==null)return(k||(k=b("Promise"))).resolve();e=e[2];if(e===!1||e==null)return(k||(k=b("Promise"))).resolve();e=d("MAWContactRelationshipType").getContactRelationshipType(g);e=f.folderName==="inbox"&&e===d("WADbContact").REVERSED_ONE_WAY_CONTACT&&!(i||(i=d("I64"))).equal(f.lastActivityTimestampMs,(i||(i=d("I64"))).zero);e&&(i||(i=d("I64"))).lt(g.authorityLevel,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))&&(c("FBLogger")("messenger_web_product").mustfix("[MAW] Message Request loaded before contact is fully loaded"),e=!1);if(f.folderName==="pending"||f.folderName==="other"||f.folderName==="spam"||e){g=d("LSThreadBitOffset").clear(d("MAWMessageRequestUtil").disabledThreadCapabilitiesForIncomingRequest,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4);e=g[0];var l=g[1],m=g[2];g=g[3];var n=void 0;f.folderName==="inbox"&&(n=h._("__JHASH__4F6x7gUU1-S__JHASH__").toString());e=[d("LSThreadBitOffset").set(d("MAWMessageRequestUtil").enabledThreadCapabilitiesForIncomingRequest,e,l,m,g),n]}else e=[[f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4],void 0];l=e[0];m=e[1];g=babelHelpers["extends"]({},f,{additionalThreadContext:m,capabilities:l[0],capabilities2:l[1],capabilities3:l[2],capabilities4:l[3]});return a.threads.put(g).then(c("emptyFunction"))})})}g.call=a}),226);
__d("MAWBridgeParticipantRemovedHandler",["I64","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeParticipantRemovedHandler",function(a,c){return a.participants["delete"](c,(h||(h=d("I64"))).of_string(b.userId))})}g.call=a}),98);
__d("TemporaryLoggingUtilsForS406998Only",["FBLogger","I64","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to parse stanza id ",": ",""]);i=function(){return a};return a}function j(a){var b=6917529027641082e3,c=!1;try{c=(h||(h=d("I64"))).equal(h.and_(h.of_string(a),h.of_float(b)),h.of_float(b))}catch(b){d("WALogger").ERROR(i(),a,b)}return c}function a(a,b){var e=a.contactId!=null?(h||(h=d("I64"))).to_string(a.contactId):null;e!=null&&j(e)&&c("FBLogger")("messenger_e2ee_web","invalid_participant_added").mustfix("[S406998] invalid participant added to participants. contactId: %s at loc: %s",e,b);return a}g.isStanzaIdForS406998Only=j;g.logIfInvalidParticipantAndReturnForS406998Only=a}),98);
__d("MAWBridgeParticipantUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(j||(j=d("I64"))).of_string(l);function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(j||(j=d("I64"))).of_string(b.fbid),g=d("MAWTimeUtils").toTimestamp(b.readWatermarkTs),i=d("MAWTimeUtils").toTimestamp(b.deliveredWatermarkTs),n=d("MAWTimeUtils").toTimestamp(b.lastReadActionTs),o=b.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,p=(yield a.participants.get(e,f));p!=null?yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:p.authorityLevel,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:b.isInvited?(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:b.isAdmin,isModerator:!1,isSuperAdmin:p.isSuperAdmin,nickname:p.nickname,normalizedSearchTerms:p.normalizedSearchTerms,participantCapabilities:p.participantCapabilities,readActionTimestampMs:n,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:e},"MAWBridgeParticipantUpdatedHandler.put")):yield a.participants.add(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:(j||(j=d("I64"))).zero,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:b.isInvited?(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:b.isAdmin,isModerator:!1,isSuperAdmin:b.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:j.zero,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:e},"MAWBridgeParticipantUpdatedHandler.add"));yield d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,e);n=b.isAdmin;(j||(j=d("I64"))).equal(m,f)&&(n?yield d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,e):yield d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,e));p==null&&(yield c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(k||(k=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:k.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:k.ofNumber(c("LSContactIdType").FBID),contactType:k.ofNumber(c("LSContactType").USER),contactViewerRelationship:k.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:k.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:l===b.fbid,workForeignEntityType:k.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)}))});return o.apply(this,arguments)}function a(a,c){return c.fbid.startsWith("shadow_")?(i||(i=b("Promise"))).resolve():d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c.threadJid,"MAWBridgeParticipantUpdatedHandler",function(a,b){return n(a,c,b)})}g.callWithoutWaitingForAnything=n;g.call=a}),226);
__d("MAWBridgeParticipantsUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","ReQLTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.participants.filter(function(a){return!a.fbid.startsWith("shadow_")});yield (i||(i=b("Promise"))).all(e.map(function(e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeParticipantsUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f=(k||(k=d("I64"))).of_string(e.fbid),g=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),i=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),n=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),o=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,p=!1,q=!1;yield d("ReQLTable").update(a.participants,[b,f],function(a){if(a!=null){q=!0;return{authorityLevel:a.authorityLevel,contactId:f,deliveredWatermarkTimestampMs:(k||(k=d("I64"))).equal(i,(k||(k=d("I64"))).zero)?a.deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:(k||(k=d("I64"))).equal(n,(k||(k=d("I64"))).zero)?a.readActionTimestampMs:n,readWatermarkTimestampMs:(k||(k=d("I64"))).equal(g,(k||(k=d("I64"))).zero)?a.readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}else{q=!0;p=!0;return{authorityLevel:(k||(k=d("I64"))).zero,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:k.zero,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}});q&&(yield d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,b),(k||(k=d("I64"))).equal(m,f)&&(e.isAdmin?yield d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,b):yield d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,b)));p&&(yield c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:l===e.fbid,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)}))});return function(b,c){return a.apply(this,arguments)}}())}))});return n.apply(this,arguments)}g.call=a}),226);
__d("MAWBridgeRavenActionMsgForUIHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWMsg","MAWRavenUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c.threadJid,"MAWBridgeRavenActionMsgForUIHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=a.attachments;e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(e,c.ravenMsgId)));if(e==null)return(i||(i=b("Promise"))).resolve();if(e.ephemeralMediaState==null)return(i||(i=b("Promise"))).resolve();var f=(h||(h=d("I64"))).to_int32(e.ephemeralMediaState);if(e.ephemeralMediaViewMode==null)return(i||(i=b("Promise"))).resolve();var g=h.to_int32(e.ephemeralMediaViewMode);f=d("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(f);g=d("MAWMsg").MAWRavenMsgEphemeralType.cast(g);if(f==null||g==null)return(i||(i=b("Promise"))).resolve();f=d("MAWRavenUtils").getNextRavenMessageEphemeralState(f,g);if(f==null)return(i||(i=b("Promise"))).resolve();e.ephemeralMediaState;g=babelHelpers.objectWithoutPropertiesLoose(e,["ephemeralMediaState"]);e=babelHelpers["extends"]({ephemeralMediaState:h.of_int32(f)},g,{transportKey:"WhatsApp"});f=[g.threadKey,g.messageId,g.attachmentFbid];return a.upsert(f,e)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeReactionUpsertHandler",["I64","LSAuthorityLevel","LSIntEnum","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e,f,g){return{actorId:(h||(h=d("I64"))).of_string(a),authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),messageId:e,reaction:g,reactionCreationTimestampMs:d("MAWTimeUtils").toTimestamp(f),threadKey:b,timestampMs:d("MAWTimeUtils").toTimestamp(f),transportKey:"WhatsApp"}}function k(a,b,c,e,f,g){return a.reactions.upsert([c,e,(h||(h=d("I64"))).of_string(b)],j(b,c,e,f,g))}function a(a,b,c,d,e,f){return k(a,b,c,d,e,f)}function b(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.chatJid,"MAWBridgeReactionUpsertHandler",function(a,c){return k(a,b.actorId,c,b.messageId,b.ts,b.reaction)})}g.composeReaction=j;g.attachmentMutationsOptimisticHandler=a;g.call=b}),98);
__d("MAWBridgeReceivedReceiptHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(h||(h=d("I64"))).of_string(b.fbid),f=d("MAWTimeUtils").toTimestamp(b.lastReadWatermarkTs),g=d("MAWTimeUtils").toTimestamp(b.deliveredWatermarkTs);b=d("MAWTimeUtils").toTimestamp(b.lastReadActionTs);c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(c,e)));c!=null&&(yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:(h||(h=d("I64"))).equal(g,(h||(h=d("I64"))).zero)?c.deliveredWatermarkTimestampMs:g,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:(h||(h=d("I64"))).equal(b,(h||(h=d("I64"))).zero)?c.readActionTimestampMs:b,readWatermarkTimestampMs:(h||(h=d("I64"))).equal(f,(h||(h=d("I64"))).zero)?c.readWatermarkTimestampMs:f,subscribeSource:c.subscribeSource,threadKey:c.threadKey,threadRoles:(h||(h=d("I64"))).zero},"MAWBridgeReceivedReceiptHandler")))});return j.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.chatJid,"MAWBridgeReceivedReceiptHandler",function(a,c){return i(a,b,c)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeRefreshContactHandler",["LSFactory","LSRefetchContactRowIfExistsStoredProcedure"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return c("LSRefetchContactRowIfExistsStoredProcedure")(c("LSFactory")(a),{id:b})}g.call=a}),98);
__d("MAWBridgeRemoveMessageSearchResultHandler",["Promise","ReQL","asyncToGeneratorRuntime","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.message_search_results).filter(function(a){return e.includes(a.messageOtid)})));yield (h||(h=b("Promise"))).all(c.map(function(b){return a.message_search_results["delete"](b.type_,b.query,b.threadKey,b.globalIndex)}))})().then(c("emptyFunction"))}g.call=a}),98);
__d("MAWBridgeSyncContacts",["CurrentMessengerUser","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("CurrentMessengerUser").getID();function a(a,e){return e.reduce(function(b,e){var f=(i||(i=d("I64"))).of_string(e);return b.then(function(){return c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:k===e,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)})}).then(c("emptyFunction"))},(h||(h=b("Promise"))).resolve())}g.call=a}),98);
__d("MAWBridgeThreadBumpedServerHandler",["I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","MAWCalculateBumpTimestampMs","MAWMiActOnMiThreadReadyForJid","WALoggerDeferred","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on server. threadKey: ",", bumpTimestampMs: ",", isLocalDeviceSend: ",", from ",""]);i=function(){return a};return a}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeThreadBumpedServerHandle",function(a,e){var f=b.lastActivityTs;f=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(f,b.lastMsgExternalId);c("promiseDone")(d("WALoggerDeferred").LOG(i(),(h||(h=d("I64"))).to_string(e),h.to_string(f),b.isCurrentDeviceSendingMsg,b.description));return c("LSBumpE2EEMetadataThreadStoredProcedure")(c("LSFactory")(a),{bumpedByLocalDeviceSend:b.isCurrentDeviceSendingMsg,isUnbump:!1,serverAuthoritativeTimestampMs:f,threadKey:e})})}g.call=a}),98);
__d("MAWThreadBumpedV2LoggingUtils",["DateConsts","I64","LSAuthorityLevel","ODS","Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,f){var g=(j||(j=d("I64"))).of_int32(c("LSAuthorityLevel").AUTHORITATIVE),k=function(a){a=a.authorityLevel;return(j||(j=d("I64"))).equal(g,a)},l=d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages).getKeyRange(f.threadKey).filter(k)).then(function(a){return(j||(j=d("I64"))).to_float((a=a==null?void 0:a.timestampMs)!=null?a:(j||(j=d("I64"))).zero)});a=d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.reactions).getKeyRange(f.threadKey).filter(k).take(20)).then(function(a){return a.reduce(function(a,b){return Math.max(a,(j||(j=d("I64"))).to_float((a=b.reactionCreationTimestampMs)!=null?a:(j||(j=d("I64"))).zero))},0)});return(h||(h=b("Promise"))).all([l,a]).then(function(a){var b=a[0];a=a[1];b=Math.max(b,a);a=Math.floor((j||(j=d("I64"))).to_float(e.bumpTimestampMs)/d("DateConsts").MS_PER_SEC)*1e3;if(a!==b)return(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","thread_bump_call_unexpected");else return(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","thread_bump_call_expected")})}g.logIfBumpIsUnexpected=a}),98);
__d("MAWBridgeThreadBumpedV2Handler",["FBLogger","I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","LSOptimisticMarkThreadReadV2StoredProcedure","MAWBridgeBuildThreadSnippet","MAWLocalizationType","MAWMiActOnMiThreadReadyForJid","MAWThreadBumpedV2LoggingUtils","ODS","Promise","ReQL","WALoggerDeferred","asyncToGeneratorRuntime","getMAWLastMessageCtaType","gkx","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Skipping local bump for thread: ",", bumpTimestampMs: ",", DB lastActivityTimestampMs: ",", from ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on local (v2). threadKey: ",", bumpTimestampMs: ",", originalActivityTimestampMs: ",", originalReadTimestampMs : ",", isMessageAuthorMe: ","\n          from ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] missing thread for bumping threadKey: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread v2. threadKey: ",", bumpTimestampMs: ",", isMessageAuthorMe: ",", skipServerThreadBump: ",", from ",""]);n=function(){return a};return a}function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeThreadBumpedV2Handler",function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f,g){var p,q=e.bumpTimestampMs;p=(p=e.skipServerThreadBump)!=null?p:!1;var s=e.isMessageAuthorMe;c("promiseDone")(d("WALoggerDeferred").LOG(n(),(i||(i=d("I64"))).to_string(g),i.to_string(q),s,p,e.description));var t=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(f.threads).getKeyRange(g)));if(t==null){c("promiseDone")(d("WALoggerDeferred").WARN(m(),(i||(i=d("I64"))).to_string(g)));return(j||(j=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","missing_thread")}c("justknobx")._("2374")&&c("promiseDone")(d("MAWThreadBumpedV2LoggingUtils").logIfBumpIsUnexpected(a,e,t));var u=r(e,t);if(u){c("promiseDone")(d("WALoggerDeferred").LOG(l(),(i||(i=d("I64"))).to_string(g),i.to_string(q),i.to_string(t.lastActivityTimestampMs),i.to_string(t.lastReadWatermarkTimestampMs),s,e.description));u=babelHelpers["extends"]({},t,{lastActivityTimestampMs:q});if(!c("gkx")("6478")){var v=e.snippetSenderContactId!=null?(i||(i=d("I64"))).of_string(e.snippetSenderContactId):void 0;v=(v=v)!=null?v:t.snippetSenderContactId;var w=d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(e,t.snippet),x=c("getMAWLastMessageCtaType")(e.snippetType);u=babelHelpers["extends"]({},u,{lastMessageCtaType:x,snippet:w,snippetSenderContactId:v})}s&&(u=babelHelpers["extends"]({},u,{lastReadWatermarkTimestampMs:q}));yield f.threads.put(u)}else{c("promiseDone")(d("WALoggerDeferred").LOG(k(),(i||(i=d("I64"))).to_string(g),i.to_string(q),i.to_string(t.lastActivityTimestampMs),e.description));p||c("FBLogger")("MAWBridgeThreadBumpedV2Handler").mustfix("[Occamadillo] Bumping thread on server when thread should not be bumped: %s, bumpTimestampMs: %s, DB lastActivityTimestampMs: %s, snippetType: %s, from %s",(i||(i=d("I64"))).to_string(g),i.to_string(q),i.to_string(t.lastActivityTimestampMs),e.snippetType,e.description);return(h||(h=b("Promise"))).resolve()}if(!p){x={readWatermarkTimestampMs:q,threadKey:g};v={bumpedByLocalDeviceSend:s,isUnbump:(w=e==null?void 0:e.isUnbump)!=null?w:!1,serverAuthoritativeTimestampMs:q,threadKey:g};return o(c("LSFactory")(f),s,x,v)}return(h||(h=b("Promise"))).resolve()});return function(a,b){return f.apply(this,arguments)}}())}function o(a,b,c,d){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){b&&((j||(j=d("ODS"))).bumpEntityKey(3185,"thread_bumped_v2","mark_thread_as_read_on_server"),yield c("LSOptimisticMarkThreadReadV2StoredProcedure")(a,e));return c("LSBumpE2EEMetadataThreadStoredProcedure")(a,f)});return p.apply(this,arguments)}var q=[(e=d("MAWLocalizationType")).LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION,e.LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE,e.LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE,e.LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE,e.LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE];function r(a,b){if(a.skipBumpTimestampValidation===!0)return!0;var e;c("justknobx")._("2773")?e=q.includes(a.snippetType):e=!1;if(e){(j||(j=d("ODS"))).bumpEntityKey(3185,"thread_bumped_v2","attempted_to_bump_with_prohibited_snippet_type");return!1}e=(i||(i=d("I64"))).ge(a.bumpTimestampMs,b.lastActivityTimestampMs);return e}g.call=a;g.prohibitedLocalizationsForThreadBumps=q}),98);
__d("MAWBridgeThreadHiddenV2Handler",["LSFactory","LSIntEnum","LSOptimisticRemoveThreadStoredProcedure","LSThreadRemoveType","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b,"MAWBridgeThreadHiddenV2Handler",function(a,b){a=c("LSFactory")(a);return c("LSOptimisticRemoveThreadStoredProcedure")(a,{removeType:(h||(h=d("LSIntEnum"))).ofNumber(c("LSThreadRemoveType").DELETE_THREAD),threadKey:b})})}g.call=a}),98);
__d("MAWBridgeThreadTimestampsHandler",["CurrentMessengerUser","I64","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs),f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(f==null||c.markUnread!==null&&c.markUnread===!1&&(h||(h=d("I64"))).ge(f.lastReadWatermarkTimestampMs,e))return;e=babelHelpers["extends"]({},f,{lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)});yield a.threads.put(e);f=(h||(h=d("I64"))).of_string(d("CurrentMessengerUser").getID());e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(b,f)));e!=null&&(yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only(babelHelpers["extends"]({},e,{readActionTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastActivityTimestampMs),readWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)}),"MAWBridgeThreadTimestampsHandler")))});return j.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeThreadTimestampsHandler",function(a,c){return i(a,c,b)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeThreadUpdatedHandler",["I64","MAWBridgeBuildThreadSnippet","MAWBridgeUIEventDataValidation","MAWFolderUtils","MAWMiActOnMiThreadReadyForJid","ReQL","asyncToGeneratorRuntime","getMAWLastMessageCtaType","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){var c=b.folder!=null?d("MAWFolderUtils").getMessagingFolderTag(b.folder):a.folderName;return(b=b.cannotReplyReason)!=null?b:c==="inbox"?void 0:a.cannotReplyReason}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)));if(e==null)return;var f=i(e,b);f=babelHelpers["extends"]({},e,{cannotReplyReason:f,folderName:e.folderName,muteExpireTimeMs:b.muteExpireTimeMs==null?e.muteExpireTimeMs:(h||(h=d("I64"))).of_float(b.muteExpireTimeMs),parentThreadKey:e.parentThreadKey});if(!c("gkx")("6478")){var g=d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(b,e.snippet),j=c("getMAWLastMessageCtaType")(b.snippetType);f=babelHelpers["extends"]({},f,{lastMessageCtaType:j,snippet:g,snippetSenderContactId:b.snippetSenderContactId==null?e.snippetSenderContactId:d("MAWBridgeUIEventDataValidation").stringToI64Opt(b.snippetSenderContactId)})}yield a.threads.put(f)});return k.apply(this,arguments)}function a(a,b){var c=b.threadJid;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c,"MAWBridgeThreadUpdatedHandler",function(a,c){return j(a,b,c)})}g.callWithoutWaitingForAnything=j;g.call=a}),98);
__d("MAWBridgeUIEventQueueQPLLogger",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("QPLUserFlow").start(c("qpl")._(1056849266,"1765"),{annotations:{string_array:{events:b}},instanceKey:a})}function b(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056849266,"1765"),{instanceKey:a})}function d(a,b){c("QPLUserFlow").endFailure(c("qpl")._(1056849266,"1765"),"MAWBridgeUIEventHandlerFailure",{annotations:{string:{failedEventTag:b}},instanceKey:a})}g.start=a;g.endSuccess=b;g.endFailure=d}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("MAWBridgeUpdateContactAsConnectedHandler",["FBLogger","I64","LSAddMessengerContactStoredProcedure","LSContactViewerRelationship","LSFactory","LSIntEnum","LSOptimisticAcceptMessageRequestStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWUpdateLSThreadCapabilities","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=e.contactUserId;e=e.threadJid;var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).getKeyRange((i||(i=d("I64"))).of_string(f))));if(g==null){c("FBLogger")("maw_bridge").warn("Missing contact in MAWBridgeUpdateContactAsConnectedHandler");return}var k=babelHelpers["extends"]({},g,{contactViewerRelationship:(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactViewerRelationship").CONTACT_OF_VIEWER)});return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e,"MAWBridgeUpdateContactAsConnectedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){yield (h||(h=b("Promise"))).allSettled([a.contacts.upsert([g.id],k),c("LSAddMessengerContactStoredProcedure")(c("LSFactory")(a),{contactId:g.id}),d("MAWUpdateLSThreadCapabilities").updateNonMessageRequestThreadTxn(a,e),c("LSOptimisticAcceptMessageRequestStoredProcedure")(c("LSFactory")(a),{threadKey:e})])});return function(b,c){return a.apply(this,arguments)}}())});return k.apply(this,arguments)}g.call=a}),98);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("user_self_remove",!1),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,394]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxUpdateE2EEMetadataParticipantsStoredProcedure";e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipantsStoredProcedure",["LSUpdateE2EEMetadataParticipants","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;return c("LSUpdateE2EEMetadataParticipants").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler",["LSFactory","LSUpdateE2EEMetadataParticipantsStoredProcedure","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeThreadsLoadedHandler",function(a,b){return c("LSUpdateE2EEMetadataParticipantsStoredProcedure")(c("LSFactory")(a),{threadKey:b})})}g.call=a}),98);
__d("MAWBridgeUpdateMessageRangeHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeUpdateMessageRangeHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g;yield c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:b});var i=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages_ranges_v2__generated).getKeyRange(b)));i!=null&&(yield a.messages_ranges_v2__generated["delete"](i.threadKey,i.minTimestampMs,i.minMessageId));var j=e.hasMoreAfter,k=e.hasMoreBefore,l=e.maxMsgId,m=e.minMsgId;f=k&&e.minMsgTs!=null?(h||(h=d("I64"))).of_float(e.minMsgTs):(f=i==null?void 0:i.minTimestampMs)!=null?f:d("MAWTimeUtils").MIN_TIMESTAMP_MS;var n=(i==null?void 0:i.minTimestampMs)!=null&&(h||(h=d("I64"))).lt(i==null?void 0:i.minTimestampMs,f),o=j&&e.maxMsgTs!=null?(h||(h=d("I64"))).of_float(e.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS,p=d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=(g=o)!=null?g:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:j,hasMoreBefore:n?(a=i==null?void 0:i.hasMoreBefore)!=null?a:!0:k,lowerOverlap:p,newMaxMid:(j=l)!=null?j:"",newMaxTs:o,newMinMid:n?(a=i==null?void 0:i.minMessageId)!=null?a:"":(k=m)!=null?k:"",newMinTs:n?(p=i==null?void 0:i.minTimestampMs)!=null?p:d("MAWTimeUtils").MIN_TIMESTAMP_MS:f,threadKey:b,upperOverlap:g})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeUpdateMinMessageHandler",["I64","MAWMiActOnMiThreadReadyForJid","ReQL","ReQLTable","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=(h||(h=d("I64"))).of_float(b.minTimestampMs),f=b.minMessageId;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeUpdateMinMessageHandler",function(a,g){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(g)).then(function(h){if(h==null)return;var i=b.hasMoreBefore,j=i!=null?i:h.hasMoreBefore;return d("ReQLTable").update(a.messages_ranges_v2__generated,[g,h.minTimestampMs,h.minMessageId],function(a){if(a!=null)return{hasMoreAfter:a.hasMoreAfter,hasMoreBefore:j,isLoadingAfter:a.isLoadingAfter,isLoadingBefore:a.isLoadingBefore,maxMessageId:a.maxMessageId,maxTimestampMs:a.maxTimestampMs,minMessageId:f,minTimestampMs:e,threadKey:a.threadKey};throw c("unrecoverableViolation")("Thread is missing in updating the min message in message range","maw_threads")})})})}g.call=a}),98);
__d("MAWBridgeXMAShareExpiredHandler",["MAWMiActOnMiThreadReadyForJid","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,c,d){var e=String(d.xmaId);return a.attachments.get(c,d.msgId,e).then(function(f){if(f==null)return(h||(h=b("Promise"))).resolve();f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(Boolean);f=f.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(f).then(function(){return a.attachments["delete"](c,d.msgId,e)})})}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,b.threadJid,"MAWBridgeXMAShareExpiredHandler",function(a,c){return i(a,c,b)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeXMAShareTombstonedHandler",["FBLogger","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=String(e.xmaId);return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,e.threadJid,"MAWBridgeXMAShareTombstonedHandler",function(a,g){return a.attachments.get(g,e.msgId,f).then(function(i){if(i==null)return(h||(h=b("Promise"))).resolve();i=[i.defaultCtaId,i.attachmentCta1Id,i.attachmentCta2Id,i.attachmentCta3Id].filter(Boolean);i=i.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(i).then(function(){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(g,e.msgId,f)).then(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d){if(d!=null){d=babelHelpers["extends"]({},d,{attachmentCta1Id:void 0,attachmentCta2Id:void 0,attachmentCta3Id:void 0,cta1Title:void 0,cta1Type:void 0,cta2Title:void 0,cta2Type:void 0,cta3Title:void 0,cta3Type:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,previewHeight:void 0,previewHeightLarge:void 0,previewWidth:void 0,previewWidthLarge:void 0,subtitleText:void 0,titleText:void 0});yield a.attachments.put(d)}c("FBLogger")("messenger_web_sharing").blameToPreviousFrame().mustfix("Trying to tombstone a secure xma attachment but no existing attachment");return(h||(h=b("Promise"))).resolve()});return function(a){return d.apply(this,arguments)}}())})})})}g.call=a}),98);
__d("MAWBridgeUIEventHandler",["FBLogger","JSResourceForInteraction","MAWAbPropsClient","MAWBridgeAddMessageSearchResultHandler","MAWBridgeCentralizedThreadUpdateHandler","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessageRangesV2Handler","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteReactionHandler","MAWBridgeDropAllSecureThreadsHandler","MAWBridgeEditMsgHistoryAddedHandler","MAWBridgeFulfillRestorePromisePayloadHandler","MAWBridgeGroupInfoUpdatedHandler","MAWBridgeGroupInviteLoadedHandler","MAWBridgeGroupInviteUpdateHandler","MAWBridgeHandleCOPDigest","MAWBridgeMediaExpiredHandler","MAWBridgeMsgRangeLoadedHandler","MAWBridgeMsgUpdatedHandler","MAWBridgeMsgsLoadedHandler","MAWBridgeMsgsStartCountdownHandler","MAWBridgeNewMediaHandler","MAWBridgeNewMediaRangeHandler","MAWBridgeNewMsgHandler","MAWBridgeNewReceiverFetchInfoHandler","MAWBridgeNewXMAHandler","MAWBridgeOccamadilloVerifyThreadExistsHandler","MAWBridgeOneToOneMessageRequestLoadedHandler","MAWBridgeParticipantRemovedHandler","MAWBridgeParticipantUpdatedHandler","MAWBridgeParticipantsUpdatedHandler","MAWBridgeRavenActionMsgForUIHandler","MAWBridgeReactionUpsertHandler","MAWBridgeReceivedChatStateHandler","MAWBridgeReceivedReceiptHandler","MAWBridgeRefreshContactHandler","MAWBridgeRemoveMessageSearchResultHandler","MAWBridgeSyncContacts","MAWBridgeThreadBumpedServerHandler","MAWBridgeThreadBumpedV2Handler","MAWBridgeThreadHiddenV2Handler","MAWBridgeThreadTimestampsHandler","MAWBridgeThreadUpdatedHandler","MAWBridgeUIEventQueueQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUpdateClientRestoreStatus","MAWBridgeUpdateContactAsConnectedHandler","MAWBridgeUpdateE2EEMetadataParticipantsHandler","MAWBridgeUpdateMessageRangeHandler","MAWBridgeUpdateMinMessageHandler","MAWBridgeXMAShareExpiredHandler","MAWBridgeXMAShareTombstonedHandler","MAWEphemeralMessageExpirationStorage","MAWLoggerUtils","Promise","WAResultOrError","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","emptyFunction","getErrorSafe","isArmadillo","isInstamadilloDYI","promiseDone","recoverableViolation","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Handle UI Events: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]);l=function(){return a};return a}var m=(i=c("requireDeferred"))("MAWBridgeDeleteMessagesOfThreadHandler").__setRef("MAWBridgeUIEventHandler"),n=i("MAWBridgeIssuePointQueryHandler").__setRef("MAWBridgeUIEventHandler"),o=i("MAWBridgeStartTraceHandler").__setRef("MAWBridgeUIEventHandler"),p=i("MAWBridgeStartTraceWithTraceIdHandler").__setRef("MAWBridgeUIEventHandler"),q=i("MAWBridgeTraceRecordCheckpointHandler").__setRef("MAWBridgeUIEventHandler"),r=i("MAWBridgeUpdateTraceHandler").__setRef("MAWBridgeUIEventHandler"),s=i("MAWBridgeUploadMessageByBatchHandler").__setRef("MAWBridgeUIEventHandler"),t=i("MAWBridgeUploadMessageHandler").__setRef("MAWBridgeUIEventHandler");function u(a,e,f){switch(f.tag){case"NewMsg":return d("MAWBridgeNewMsgHandler").call(e,f.value);case"MsgsStartCountdown":return d("MAWBridgeMsgsStartCountdownHandler").call(e,f.value);case"MsgClearCountdown":return(h||(h=b("Promise"))).resolve(d("MAWEphemeralMessageExpirationStorage").clearMessageFromExpiration(f.value));case"DropAllSecureThreads":return d("MAWBridgeDropAllSecureThreadsHandler").call(e);case"VerifyThreadExists":var g=f.value;return d("MAWBridgeOccamadilloVerifyThreadExistsHandler").call(e,g);case"EditMsgHistoryAdded":return d("MAWBridgeEditMsgHistoryAddedHandler").call(a,e,f.value);case"MsgUpdated":return d("MAWBridgeMsgUpdatedHandler").call(e,f.value);case"NewMedia":return d("MAWBridgeNewMediaHandler").call(e,f.value);case"NewMediaRange":return d("MAWBridgeNewMediaRangeHandler").call(e,f.value);case"MediaExpired":return d("MAWBridgeMediaExpiredHandler").call(e,f.value);case"XMAShareExpired":return d("MAWBridgeXMAShareExpiredHandler").call(e,f.value);case"NewXMA":return d("MAWBridgeNewXMAHandler").call(e,f.value);case"XMAShareTombstoned":return d("MAWBridgeXMAShareTombstonedHandler").call(e,f.value);case"ParticipantUpdated":return d("MAWBridgeParticipantUpdatedHandler").call(e,f.value);case"ParticipantRemoved":return d("MAWBridgeParticipantRemovedHandler").call(e,f.value);case"UpdateE2EEMetadataParticipants":return d("MAWBridgeUpdateE2EEMetadataParticipantsHandler").call(e,f.value);case"ReceivedReceipt":return d("MAWBridgeReceivedReceiptHandler").call(e,f.value);case"ThreadUpdated":return d("MAWBridgeThreadUpdatedHandler").call(e,f.value);case"GroupInfoUpdated":return d("MAWBridgeGroupInfoUpdatedHandler").call(e,f.value);case"ThreadBumpedV2":return d("MAWBridgeThreadBumpedV2Handler").call(e,f.value);case"CentralizedThreadUpdate":return d("MAWBridgeCentralizedThreadUpdateHandler").call(e,f.value);case"ThreadTimestampsUpdated":return d("MAWBridgeThreadTimestampsHandler").call(e,f.value);case"MsgsLoaded":return d("MAWBridgeMsgsLoadedHandler").call(e,f.value);case"MsgRangeLoaded":return d("MAWBridgeMsgRangeLoadedHandler").call(e,f.value);case"StartTrace":return o.load().then(function(a){return a.call(e,f.value)});case"UpdateTrace":return r.load().then(function(a){return a.call(e,f.value)});case"ThreadHiddenV2":return d("MAWBridgeThreadHiddenV2Handler").call(e,f.value);case"SyncContacts":return d("MAWBridgeSyncContacts").call(e,f.value);case"ReceivedChatState":return d("MAWBridgeReceivedChatStateHandler").call(e,f.value);case"ClockSkewUpdated":return(h||(h=b("Promise"))).resolve(d("WATimeUtils").setClockSkew(f.value));case"ABPropsUpdated":c("FBLogger")("messenger_e2ee_web").warn("[messenger_e2ee_web] ABPropsUpdated has been deprecated. Please use the bridge with ABPropsUpdated");return(h||(h=b("Promise"))).resolve(d("MAWAbPropsClient").rewrite(f.value));case"COPDigestReceived":return d("MAWBridgeHandleCOPDigest").call(e,f.value);case"UpsertReaction":return d("MAWBridgeReactionUpsertHandler").call(e,f.value);case"DeleteReaction":return d("MAWBridgeDeleteReactionHandler").call(e,f.value);case"UploadMessage":return t.load().then(function(a){return a.call(e,f.value)});case"UploadMessageByBatch":return s.load().then(function(a){return a.call(e,f.value)});case"DeleteMessagesOfThread":return m.load().then(function(a){return a.call(e,f.value)});case"UploadAttachment":return c("JSResourceForInteraction")("MAWBridgeUploadAttachmentHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"ResignAttachmentCDNUrl":return c("JSResourceForInteraction")("MAWBridgeResignAttachmentCDNUrlHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"DeleteMessages":return d("MAWBridgeDeleteMessagesHandler").call(e,f.value);case"RestoreMessageBatch":d("WATagsLogger").TAGS(["labyrinth_web","labyrinth_dyi"]).WARN(l());return(h||(h=b("Promise"))).resolve();case"OneToOneMessageRequestLoaded":return d("MAWBridgeOneToOneMessageRequestLoadedHandler").call(e,f.value);case"GroupInviteUpdate":return d("MAWBridgeGroupInviteUpdateHandler").call(e,f.value);case"UpdateDyiStatus":d("WATagsLogger").TAGS(["labyrinth_web","labyrinth_dyi"]).WARN(k());return(h||(h=b("Promise"))).resolve();case"DeleteGroupInvite":return d("MAWBridgeDeleteGroupInviteHandler").call(e,f.value);case"TraceRecordCheckpoint":return q.load().then(function(a){return a.call(e,f.value)});case"DeleteMessageRangesV2":return d("MAWBridgeDeleteMessageRangesV2Handler").call(e,f.value);case"UpdateMinMessage":return d("MAWBridgeUpdateMinMessageHandler").call(e,f.value);case"IssuePointQuery":return n.load().then(function(a){return a.call(e,f.value)});case"ThreadBumpedServer":return d("MAWBridgeThreadBumpedServerHandler").call(e,f.value);case"ParticipantsUpdated":return d("MAWBridgeParticipantsUpdatedHandler").call(e,f.value);case"StartTraceWithTraceId":return p.load().then(function(a){return a.call(e,f.value)});case"UpdateClientRestoreStatus":return d("MAWBridgeUpdateClientRestoreStatus").call(e,f.value);case"NewMsgs":return d("MAWBridgeNewMsgHandler").bulkCall(e,f.value.msgs);case"UnArchivedSelfDeviceChangeAlerts":return d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(e,f.value);case"EphemeralSettingsUpdatedForUI":return c("JSResourceForInteraction")("MAWBridgeEphemeralSettingsUpdatedForUIHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"RavenActionUpdate":return d("MAWBridgeRavenActionMsgForUIHandler").call(e,f.value);case"GroupInviteLoaded":return d("MAWBridgeGroupInviteLoadedHandler").call(e,f.value);case"UpdateMessageRange":return d("MAWBridgeUpdateMessageRangeHandler").call(e,f.value);case"RemoveMessageSearchResult":return d("MAWBridgeRemoveMessageSearchResultHandler").call(e,f.value);case"AddMessageSearchResult":return d("MAWBridgeAddMessageSearchResultHandler").call(a,e,f.value);case"FulfillRestorePromise":return d("MAWBridgeFulfillRestorePromisePayloadHandler").call(f.value);case"UpdateContactAsConnected":return d("MAWBridgeUpdateContactAsConnectedHandler").call(e,f.value);case"RefreshContact":return d("MAWBridgeRefreshContactHandler").call(e,f.value);case"NewReceiverFetchInfo":return d("MAWBridgeNewReceiverFetchInfoHandler").call(e,f.value);default:return(h||(h=b("Promise"))).resolve()}}function a(a,b){if(!c("isArmadillo")()&&!c("isInstamadilloDYI")()){c("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","maw_worker");return}if(!(b.length===1&&b[0].tag==="TraceRecordCheckpoint")){var e={};e=b.reduce(function(a,b){a[b.tag]=((b=a[b.tag])!=null?b:0)+1;return a},e);d("WATagsLogger").TAGS(["MAWBridgeUIEvent"]).LOG(j(),e)}c("promiseDone")(v(a,b),c("emptyFunction"),function(a){c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[MAWBridgeUIEventHandler] Failed to handle UI events: %s",b.map(function(a){return a.tag}).join(", "))})}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var g=(yield a);a=d("MAWLoggerUtils").getInstanceKey();var h=e.map(function(a){return a.tag}),i="";d("MAWBridgeUIEventQueueQPLLogger").start(a,h);var j;try{j=(yield g.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){for(var b=0;b<e.length;b++){var f=e[b];try{yield u(g,a,f)}catch(a){i=f.tag;return d("WAResultOrError").makeError(c("getErrorSafe")(a))}}return d("WAResultOrError").makeResult(!0)});return function(b){return a.apply(this,arguments)}}(),"readwrite","background",{events:e,type:"maw_ui_bridge"},f.id+":352"))}catch(a){j=d("WAResultOrError").makeError(c("getErrorSafe")(a))}!j.success?(d("MAWBridgeUIEventQueueQPLLogger").endFailure(a,i),c("FBLogger")("messenger_e2ee_web").catching(j.error).mustfix("MAWBridgeUIEventHandler] Did not commit UI events to DB: %s",h.toString())):d("MAWBridgeUIEventQueueQPLLogger").endSuccess(a)});return w.apply(this,arguments)}function e(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){try{yield u(a,b,d)}catch(b){a=c("getErrorSafe")(b);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[handleShimEvent] Failed to handle UI event: %s",d.tag);throw b}});return x.apply(this,arguments)}g.handleEvents=a;g.handleShimEvent=e}),98);
__d("MAWCrossWorkerPortal",["FBLogger","WACrossWorkerPortal","pageID"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f){if(h!=null)return h;h=d("WACrossWorkerPortal").attachPortal(a,b,e,c("pageID"),f);return h}function b(){if(h==null){c("FBLogger")("messenger_e2ee_web").warn("Trying to kill portal before its setup");return}d("WACrossWorkerPortal").killPortalAndSendPendingToBridge(h)}g.getOrCreateCrossWorkerPortal=a;g.killPortalWhenWorkerTerminating=b}),98);
__d("WADevToolMessageChannel",[],(function(a,b,c,d,e,f){"use strict";var g=new MessageChannel(),h;a=function(){g=new MessageChannel();h(g);return g};b=function(){return g};c=function(a){h=a,h(g)};f.createNewChannel=a;f.getMostRecentChannel=b;f.onCreateNewChannel=c}),66);
__d("MAWEARDecryptionError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="MawEARError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("MAWClientConsistencyRefresh",["ClientConsistencyEventEmitter","CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(c("CurrentUser").getAppID()){case 772021112871879:c("ClientConsistencyEventEmitter").emit("hardRefresh",a);break;default:c("ClientConsistencyEventEmitter").emit("softRefresh",a)}}g["default"]=a}),98);
__d("MAWInit",["FBLogger","MAWCurrentUser","MAWEBSwitch","MAWInitError","MAWMIC","MWQPLJoinId","MultipleTabsLogger","QPLUserFlow","QuickPerformanceLogger","WAGetStorageQplAnnotations","asyncToGeneratorRuntime","gkx","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(25310776,"6155"),j=!1,k=[],l=[],m=!1;function n(){if(m)return;m=!0;c("QPLUserFlow").addAnnotations(i,{bool:{armadillo_init_sync_api_improvements:c("gkx")("24025"),is_eb_enabled:c("MAWEBSwitch").isEnabled(),isArmadilloPublicLaunchUser:c("gkx")("23405"),isTlcPublicUser:d("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()}})}var o=!1,p=function(){return document.visibilityState!==void 0?document.visibilityState==="hidden":document.hidden},q=function(){r("visibility_change_"+(p()?"hidden":"visible"))};function a(){if(o)return;d("MAWMIC").markEvent("maw_init_start");o=!0;c("QPLUserFlow").start(i,babelHelpers["extends"]({annotations:{bool:{initiallyHidden:p()},string:{hostname:window.location.hostname}},cancelOnUnload:!0},d("MWQPLJoinId").allowJoinId?{joinOptions:{joinId:d("MWQPLJoinId").MWQPLJoinId}}:{}));c("QPLUserFlow").addAlignmentPointForJoin(i,0,{requestId:d("MWQPLJoinId").MWQPLJoinId});d("MultipleTabsLogger").addAnnotationToQPLEvent(i);void d("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(i,a)});n();document.addEventListener("visibilitychange",q);k.forEach(function(a){return a()});l.forEach(function(a){return a()});k.splice(0,k.length);l.splice(0,l.length)}function r(a,b){if(!o||j){if(!o&&(b==null?void 0:b.allowEarlyLogPoints)){c("FBLogger")("messenger_e2ee_web").warn("Logging point %s before MAWInit.start() was called",a);var d=(h||(h=c("QuickPerformanceLogger"))).currentTimestamp();l.push(function(){c("QPLUserFlow").addPoint(i,a,{timestamp:d})})}return}n();c("QPLUserFlow").addPoint(i,a)}function e(a,b,d){if(!o||j){!o&&(d==null?void 0:d.allowEarlyAnnotations)&&k.push(function(){var d;c("QPLUserFlow").addAnnotations(i,{bool:(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(i,{bool:(d={},d[a]=b,d)})}function f(a,b,d){if(!o||j){!o&&(d==null?void 0:d.allowEarlyAnnotations)&&k.push(function(){var d;c("QPLUserFlow").addAnnotations(i,{string:(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(i,{string:(d={},d[a]=b,d)})}function s(a,b,d){if(!o||j){!o&&(d==null?void 0:d.allowEarlyAnnotations)&&k.push(function(){var d;c("QPLUserFlow").addAnnotations(i,{"int":(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(i,{"int":(d={},d[a]=b,d)})}function t(){n(),j=!0,m=!1,document.removeEventListener("visibilitychange",q)}function u(a,b){t();b=b instanceof d("MAWInitError").MAWInitError&&b.error?b.error:b;c("QPLUserFlow").addAnnotations(i,{string:{errorDescription:b==null?void 0:b.message}});c("QPLUserFlow").endFailure(i,a,{error:b});d("MAWMIC").fail(a,b)}function v(a,b){t(),c("QPLUserFlow").addAnnotations(i,{string:{cancelReason:a}}),b&&c("QPLUserFlow").markError(i,"maw_init_cancel_with_error",{error:b}),c("QPLUserFlow").endCancel(i),d("MAWMIC").addStringAnnotation("mawInitCancelReason",a),d("MAWMIC").cancel("maw_init_cancel",b),c("QPLUserFlow").addAnnotations(c("qpl")._(29818881,"6702"),{string:{maw_cancel_reason:a,maw_error_message:b==null?void 0:b.message}})}function w(a){if(j)return;t();d("MAWMIC").addStringAnnotation("mawInitDropReason",a);(h||(h=c("QuickPerformanceLogger"))).markerDrop(i)}function x(){t(),c("QPLUserFlow").endSuccess(i),d("MAWMIC").markEvent("maw_init_end")}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a+"_start";a=a+"_end";r(c);c=(yield b());r(a);return c});return z.apply(this,arguments)}e={addBoolAnnotation:e,addIntAnnotation:s,addStringAnnotation:f,cancel:v,drop:w,endSuccess:x,fail:u,logPoint:r,measurePerformance:y,start:a};g.MAWInit=e}),98);
__d("MAWStartupLoggingUtils",["FBLogger","MAWInit","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f;f=(f=b==null?void 0:b.message)!=null?f:"";f.indexOf("Failed to execute 'importScripts'")>=0?d("MAWInit").MAWInit.fail("import_scripts_failure",c("getErrorSafe")(b)):d("MAWInit").MAWInit.fail("worker_error",c("getErrorSafe")(b));c("FBLogger")("messenger_e2ee_web").mustfix("[MAWWebWorkerSingletonAsync: "+a+"]: %s:%s:%s:%s:%s:%s:%s",JSON.stringify(b==null?void 0:b.message),b==null?void 0:b.lineno,b==null?void 0:b.colno,b==null?void 0:b.filename,JSON.stringify(b,window.Object.getOwnPropertyNames(b)),b==null?void 0:b.name,e)}function b(a){var b=function b(d){d=d==null?void 0:d.data;if(typeof d==="object")if((d==null?void 0:d.type)==="importScripts_error"){var e,f;a.removeEventListener("message",b);var g=c("FBLogger")("messenger_e2ee_web");g=g.addMetadata("FBLOGGER","ERROR_STACK",(e=typeof (d==null?void 0:d.stack)==="string"?d==null?void 0:d.stack:JSON.stringify(d==null?void 0:d.stack))!=null?e:"no_stack");e=(e=d)!=null?e:{};var h=e.error_code,i=e.error_msg,j=e.error_name;e=e.source;f=(f=d==null?void 0:d.perfEntry)!=null?f:{};var k=f.duration,l=f.encodedBodySize,m=f.responseStatus;f=f.transferSize;g.mustfix("[MAWWebWorkerSingletonAsync Script Import Error Details]: %s:%s:%s || errCode:%s || respStatus:%s || encBodySize:%s || duration:%s || transferSize:%s",e!=null&&JSON.stringify(e)||"no_source",j!=null&&JSON.stringify(j)||"no_name",i!=null&&JSON.stringify(i)||"no_msg",h!=null&&JSON.stringify(h)||"none",(g=JSON.stringify(m))!=null?g:"none",(e=JSON.stringify(l))!=null?e:"none",(j=JSON.stringify(k))!=null?j:"none",(i=JSON.stringify(f))!=null?i:"none")}else(d==null?void 0:d.type)==="importScripts_success"&&a.removeEventListener("message",b)};a.addEventListener("message",b)}function e(a){var b=a.data.annotations;if(b!=null){var c={allowEarlyAnnotations:!0};Object.keys(b).forEach(function(a){var e;e=(e=b[a])!=null?e:{};Object.entries(e).forEach(function(b){var e=b[0];b=b[1];e="workerInit"+e.charAt(0).toUpperCase()+e.substring(1);a==="int"&&typeof b==="number"?d("MAWInit").MAWInit.addIntAnnotation(e,b,c):a==="string"&&typeof b==="string"?d("MAWInit").MAWInit.addStringAnnotation(e,b,c):a==="bool"&&typeof b==="boolean"&&d("MAWInit").MAWInit.addBoolAnnotation(e,b,c)})})}var e={allowEarlyLogPoints:!0};if(a.type==="point"){a="worker_"+a.data.event;d("MAWInit").MAWInit.logPoint(a,e)}}g.logWorkerError=a;g.setImportScriptsErrorListener=b;g.logSharedWorkerQPLEvents=e}),98);
__d("SharedWorkerDevChangeManager",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=!1,i=new Set();function a(a,b){var c=b.storageWorkerResource;b=b.tabResource;if(!h)return!0;if(i.has(a))return!0;if(new URLSearchParams(window.location.search).has("force_shared_worker_updates"))return!1;if(c.version===2&&b.version===2&&c.sandboxOnlyChecksum!=null)return c.sandboxOnlyChecksum===b.sandboxOnlyChecksum;return c.version===2&&c.rsrcBundleUrl==null||b.version===2&&b.getJSModuleBundleResource().url==null?!1:c.rsrcBundleUrl===b.getJSModuleBundleResource().url}function b(a){h&&i.add(a)}g.shouldUseStorageWorkerForDev=a;g.trackCreatedWorker=b}),98);
__d("SharedWorkerEventManager",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){a.port.addEventListener("message",function(a){var d;if(typeof a.data==="object"&&((d=a.data)==null?void 0:d.type)==="console"&&typeof ((d=a.data)==null?void 0:d.response)==="object"&&((d=a.data)==null?void 0:d.response)!=null){d=a.data.response;a=d.method;d=d.args;if(typeof a!=="string"||!["log","error","info","debug","warn"].includes(a)){c("FBLogger")("worker").mustfix("Unexpected console method: %s",String(a));return}if(!Array.isArray(d)){c("FBLogger")("worker").mustfix('Expected console args "%s" to be an array',JSON.stringify(d));return}b({method:a,args:d})}})}function i(a,b){a.port.addEventListener("message",function(a){var c;if(typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="sw-uncaught-error"){a=typeof ((c=a.data)==null?void 0:c.e)==="object"?(c=a.data.e)!=null?c:{}:{};c=a.error;var d=a.lineno,e=a.colno,f=a.filename;a=a.message;b({error:c instanceof Error?c:null,errorObject:{lineno:typeof d==="number"?d:null,colno:typeof e==="number"?e:null,filename:typeof f==="string"?f:null,message:typeof a==="string"?a:null}})}})}function a(a,b,d){a.port.addEventListener("message",function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="sw-get-rev"&&typeof a.data.response==="object"){b==null?void 0:b.markPoint("get_worker_rev_ack_received");a=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(e=a.data)==null?void 0:e.response:{};e=a==null?void 0:a.workerRevision;a=a==null?void 0:a.spinTime;if(e==null||typeof e!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"rev is non-number"}});c("FBLogger")("worker").mustfix("Expected worker rev to be non-null number, but instead received: %s",String(e));return}if(a==null||typeof a!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"spin_time is non-number"}});c("FBLogger")("worker").mustfix("Expected worker spin time to be non-null number, but instead received: %s",String(a));return}d({rev:e,spinTime:a})}})}function b(a,b,c){var d=function d(e){var f;if(typeof e.data==="object"&&((f=e.data)==null?void 0:f.type)==="sw-shutdown"&&typeof e.data.response==="object"){var g,h;f=typeof ((f=e.data.response)==null?void 0:f.reason)==="string"?(f=e.data.response)==null?void 0:f.reason:null;g=typeof ((g=e.data.response)==null?void 0:g.workerID)==="string"?(g=e.data.response)==null?void 0:g.workerID:null;e=typeof ((h=e.data.response)==null?void 0:h.isInitialized)==="boolean"?(h=e.data.response)==null?void 0:h.isInitialized:null;b({reason:f,workerID:g,isInitialized:e});(c==null?void 0:c.once)===!0&&a.port.removeEventListener("message",d)}};a.port.addEventListener("message",d);return function(){return a.port.removeEventListener("message",d)}}function d(a,b){a.port.addEventListener("message",function(a){var c;typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="sw-uptime-tracking"&&typeof ((c=a.data)==null?void 0:c.response)==="object"&&typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.trackerID)==="number"&&b({trackerID:a.data.response.trackerID})})}function e(a,b,d){var e=function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="execute-worker-ack"&&typeof ((e=a.data)==null?void 0:e.response)==="object"){b==null?void 0:b.markPoint("execute_worker_ack_received");e=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(a=(e=a.data)==null?void 0:e.response)!=null?a:{}:{};a=e.workerRevision;var f=e.spinMode,g=e.spinTime,h=e.firstInit,i=e.errorGettingSiteData;e=e.error;if(typeof h!=="boolean"){b==null?void 0:b.addAnnotations({string:{malformedData:"firstInit is non-boolean"}});c("FBLogger")("worker").mustfix("Expected firstInit to be a boolean, but instead received: %s",String(h));return}i=(i=i)!=null?i:e;if(typeof i==="string")return d({err:i,isFirstInit:h});if(typeof a==="number"&&typeof f==="number"&&typeof g==="number")return d({workerRev:a,workerSpinTime:g,workerSpinMode:f,isFirstInit:h});else b==null?void 0:b.addAnnotations({string:{malformedData:"workerRevision, spinMode, and/or spinTime are non-numbers"}}),c("FBLogger")("worker").mustfix("Expected workerRevision, spinMode, and spinTime to be non-null number, but instead received: %s %s %s",String(a),String(f),String(g))}};a.port.addEventListener("message",e);return function(){return a.port.removeEventListener("message",e)}}function f(a,b,d,e){var f=function f(g){var h;if(typeof g.data==="object"&&((h=g.data)==null?void 0:h.type)==="execute-worker-imports"&&typeof ((h=g.data)==null?void 0:h.response)==="object"){(e==null?void 0:e.once)===!0&&a.port.removeEventListener("message",f);b==null?void 0:b.markPoint("bundle_imports_ack");h=typeof g.data==="object"&&typeof ((h=g.data)==null?void 0:h.response)==="object"?(g=(h=g.data)==null?void 0:h.response)!=null?g:{}:{};g=h.err;h=h.attempts;if(g!=null&&typeof g!=="string"){b==null?void 0:b.addAnnotations({string:{malformedData:"err is neither null or a string"}});c("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(g));return}if(h!=null&&typeof h!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"attempts is neither null or a number"}});c("FBLogger")("worker").mustfix("Expected attempts to be a number or null, but instead receieved: %s",String(h));return}d({err:g,attempts:h})}};a.port.addEventListener("message",f);return function(){return a.port.removeEventListener("message",f)}}function j(a,b,d){a.port.addEventListener("message",function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="ww-hrp-init"){b==null?void 0:b.markEventEnd("hrp_init");e=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(a=(e=a.data)==null?void 0:e.response)!=null?a:{}:{};a=e.err;if(a!=null&&typeof a!=="string"){b==null?void 0:b.addAnnotations({string:{malformedData:"err is neither null or a string"}});c("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(a));return}d({err:a})}})}function k(a,b){a.port.addEventListener("message",function(a){var c;if(typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="worker-init-mark"&&typeof ((c=a.data)==null?void 0:c.response)==="object"&&typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.point)==="string"){b((c=a.data)==null?void 0:(a=c.response)==null?void 0:a.point)}})}function l(a,b,c){var d=function d(e){var f;if(typeof e.data==="object"&&((f=e.data)==null?void 0:f.type)==="self-terminate"&&typeof ((f=e.data)==null?void 0:f.response)==="object"&&typeof ((f=e.data)==null?void 0:(f=f.response)==null?void 0:f.from)==="string"){var g,h,i;f=(f=e.data)==null?void 0:(f=f.response)==null?void 0:f.from;g=typeof ((g=e.data)==null?void 0:(g=g.response)==null?void 0:g.reason)==="string"?(g=e.data)==null?void 0:(g=g.response)==null?void 0:g.reason:"unknown";h=typeof ((h=e.data)==null?void 0:(h=h.response)==null?void 0:h.workerID)==="string"?(h=e.data)==null?void 0:(h=h.response)==null?void 0:h.workerID:"unknown";i=typeof ((i=e.data)==null?void 0:(i=i.response)==null?void 0:i.error)==="string"?(i=e.data)==null?void 0:(e=i.response)==null?void 0:e.error:void 0;(c==null?void 0:c.once)===!0&&a.port.removeEventListener("message",d);b(f,g,h,i)}};a.port.addEventListener("message",d);return function(){return a.port.removeEventListener("message",d)}}function m(a,b){b=(b=b)!=null?b:{};var c=b.reason;b=b.upgrade;a.port.postMessage({type:"sw-shutdown",args:[{reason:c,upgrade:b}]})}function n(a){a.port.postMessage({type:"sw-get-rev",args:[]})}function o(a,b){b=(b=b)!=null?b:{};var c=b.jsModuleResource;b=b.isDev;a.port.postMessage({type:"execute-worker",args:[(a=c)!=null?a:{},b]})}function p(a,b,c){var d=function d(e){var f;if(typeof e.data==="object"&&((f=e.data)==null?void 0:f.type)==="connection-ack"&&typeof ((f=e.data)==null?void 0:f.response)==="object"&&typeof ((f=e.data)==null?void 0:(f=f.response)==null?void 0:f.from)==="string"){f=typeof ((f=e.data)==null?void 0:(f=f.response)==null?void 0:f.workerID)==="string"?(f=e.data)==null?void 0:(f=f.response)==null?void 0:f.workerID:void 0;b((e=e.data)==null?void 0:(e=e.response)==null?void 0:e.from,f);(c==null?void 0:c.once)===!0&&a.port.removeEventListener("message",d)}};a.port.addEventListener("message",d);return function(){return a.port.removeEventListener("message",d)}}function q(a,b){var c=function(a){b(a.data)};a.port.addEventListener("message",c);return function(){return a.port.removeEventListener("message",c)}}function r(a,b){a.port.postMessage({type:"ww-connection-ack"}),b==null?void 0:b.markPoint("worker_connection_ack_requested")}function s(a,b,c){c=b.isDev;var d=b.hrp;b=b.js_env;a.port.postMessage({type:"ww-hrp-init",hrp:d,is_dev:c,js_env:b,tiered:!0})}function t(a,b){b=b.trackerID;a.port.postMessage({type:"sw-uptime-tracking",args:{trackerID:b}})}function u(a){h(a,function(a){var b,c=a.args;a=a.method;(b=console)[a].apply(b,c)}),i(a,function(a){var b=a.error;a=a.errorObject;b!=null?c("FBLogger")("worker").catching(b).mustfix("Shared Worker uncaught error."):c("FBLogger")("worker").mustfix("Shared Worker uncaught error with no Error object. %s:%d:%d:%s",a.message,a.lineno,a.colno,a.filename)})}g.registerLogFowardingListener=h;g.registerUncaughtErrorForwardingListener=i;g.registerGetWorkerRevListener=a;g.registerWorkerShutdownListener=b;g.registerUptimeTrackerListener=d;g.registerExecuteWorkerAckListener=e;g.registerExecuteWorkerImportsListener=f;g.registerHrpInitListener=j;g.registerWorkerInitPointsListener=k;g.registerWorkerSelfTerminationListener=l;g.emitWorkerShutdown=m;g.emitGetRev=n;g.emitExecuteWorker=o;g.registerConnectionAckListener=p;g.registerAnyMessageListener=q;g.emitConnectionAckRequest=r;g.emitHrpInit=s;g.emitUptimeTracking=t;g.registerForwardListeners=u}),98);
__d("supportsNativeWebLock",[],(function(a,b,c,d,e,f){"use strict";function a(){return self.LockManager!=null&&self.navigator.locks instanceof self.LockManager}f["default"]=a}),66);
__d("SharedWorkerLockManager",["Deferred","FBLogger","WebStorageLockManager","emptyFunction","pageID","promiseDone","setTimeout","supportsNativeWebLock"],(function(a,b,c,d,e,f,g){"use strict";var h="shared_worker_mutex",i=6e5;function j(a){var b;b=(b=window)==null?void 0:(b=b.navigator)==null?void 0:b.locks;if(b!=null)return b;var e=d("WebStorageLockManager").make(c("pageID"));if(e!=null){a==null?void 0:a.addAnnotations({bool:{fallback_lock_manager:!0}});return{request:function(a,b){return e.request(a,b)}}}return null}function k(a,b,d){c("setTimeout")(function(){a.isSettled()||(b==null?void 0:b.endFailure("lock_timeout"),c("FBLogger")("worker").warn("[SharedWorkerLockManager]: lock timed out in %s ms",i),a.resolve(),d==null?void 0:d())},i)}function a(a,b){var d=b.workerQPLLogger,e=b.onLockTimeout;b=b.onLockFail;var f=j(d);d==null?void 0:d.addAnnotations({bool:{native_locks:f!=null?c("supportsNativeWebLock")():null}});if(f==null){c("FBLogger")("worker").warn("Unable to initialize lock manager");a(c("emptyFunction"));return}var g=new(c("Deferred"))();c("promiseDone")(f.request(h,function(){d==null?void 0:d.markPoint("lock_obtained");k(g,d,e);a(function(){d==null?void 0:d.markPoint("lock_released"),g.resolve()});return g.getPromise()}),void 0,b)}g.withWorkerLock=a}),98);
__d("checkForIndexedDbSupported",[],(function(a,b,c,d,e,f){"use strict";function a(){return!window.indexedDB?!1:!0}f["default"]=a}),66);
__d("SharedWorkerLoggingUtils",["ErrorSerializer","FBLogger","ODS","QPLUserFlow","WebStorage","checkForIndexedDbSupported","getErrorSafe","gkx","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,c,e){(i||(i=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","worker_self_termination."+b+"."+a),j(a,b,c,e,!0)}function j(a,b,d,e,f){f===void 0&&(f=!1);var g=c("qpl")._(931600201,"1438");c("QPLUserFlow").start(g);c("QPLUserFlow").endSuccess(g,{annotations:{string:{workerName:a,workerID:e,reason:d,location:b,pageID:c("pageID")},bool:{isSelfTermination:f}}})}function b(a,b,c,d,e,f){a==null?void 0:a.markEventEnd("execute_worker"),a==null?void 0:a.addAnnotations({"int":{runningWorkerRev:e,runningWorkerSpinTime:b,runningWorkerSpinMode:f},string:{executeWorkerErr:c},bool:{isFirstInit:d}})}function e(a,b,d){var e;e=c("getErrorSafe")((e=b instanceof ErrorEvent&&(b==null?void 0:b.error))!=null?e:b);c("FBLogger")("worker").catching(e).warn("Worker %s onerror: %s type, %s message",d,String(b.type),c("ErrorSerializer").toReadableMessage(e));a==null?void 0:a.addAnnotations({string_array:{onErrorHandler:[(a=JSON.stringify((d=e==null?void 0:e.message)!=null?d:b==null?void 0:b.message))!=null?a:"undefined",String((d=b==null?void 0:b.lineno)!=null?d:e==null?void 0:e.lineno),String((a=b==null?void 0:b.colno)!=null?a:e==null?void 0:e.colno),String((d=b==null?void 0:b.filename)!=null?d:e==null?void 0:e.filename)]}})}function f(){if(c("gkx")("21113")&&!c("checkForIndexedDbSupported")()){var a=(h||(h=c("WebStorage"))).getLocalStorage();if(a!=null){var b="afab0ea5-8ede-41bd-9933-dca4eea1e9b4009b1647-9c95-448c-b5f5-bcc6653853c49a83be9e-1e94-40be-a23b-c8ac74114c1e9fad1a9b-d2b3-4cf8-8751-22cc16cd96fde876fbf6-b739-4871-8586-55b51c4332a97606adc6-f4dc-4935-bb80-07e2b12a77533ae5ef90-dbc4-4003-ba54-2450fff94bbce0542942-228e-4f14-a41e-b3eef321a126eb8a6b22-a915-487f-aae7-b1a042f80274116403b4-8cdf-466a-afc7-1fc481fe95bac9585547-5693-4c3a-aba6-c8b5eec23e2cd3c74809-ef4d-4157-bf02-e0693e105906559a86c2-66a4-407c-8c45-126ff24dab57bba15e7d-da70-4d46-bff1-b4deaa9e328788a7ae98-7313-4158-97ee-5f1349d5f3b8b3a889b2-7c53-4443-8be3-9ff617a09503b13d6954-e863-40d6-b831-a24c81eae3a0099c6236-d6af-4c99-a104-61a7afe99d22";a=(h||(h=c("WebStorage"))).setItemGuarded(a,"shw_t",b);a!=null?(i||(i=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","local_storage_write_fail"):(i||(i=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","local_storage_write_success")}}}g.logSelfTermination=a;g.logShutdown=j;g.logExecuteAck=b;g.logSharedWorkerError=e;g.logLocalStorageWriteAttempt=f}),98);
__d("validateSharedWorkerReference",["ConstUriUtils","isRelativeURL","isSameOrigin","memoize"],(function(a,b,c,d,e,f,g){"use strict";var h=c("memoize")(function(){return d("ConstUriUtils").getUri(window.location.href)});function i(a){var b=h(),e=d("ConstUriUtils").getUri(a);e=b!=null&&e!=null?c("isSameOrigin")(e,b):!1;return e||c("isRelativeURL")(a)}function a(a){if(a==null||typeof a!=="object")return null;var b=a.rev,c=a.spin_time,d=a.url,e=a.version,f=a.rsrcBundleUrl;a=a.sandboxOnlyChecksum;return typeof b!=="number"||typeof c!=="number"||e!=null&&e!==1&&e!==2||!Number.isInteger(b)||!Number.isInteger(c)||typeof d!=="string"||!i(d)||f!=null&&typeof f!=="string"||a!=null&&typeof a!=="string"?null:{rev:b,spin_time:c,url:d,version:(b=e)!=null?b:1,rsrcBundleUrl:f,sandboxOnlyChecksum:a}}g["default"]=a}),98);
__d("SharedWorkerStorageManager",["Deferred","FBLogger","Promise","WebAsyncStorage","validateSharedWorkerReference"],(function(a,b,c,d,e,f,g){"use strict";var h,i="__swbundle__",j={};function k(a){return""+i+a}function l(a){var b=new(c("Deferred"))();c("WebAsyncStorage").removeItem(k(a),function(c){if(c)return b.reject(c);j[a]=null;b.resolve()});return b.getPromise()}function m(a,b){var d=new(c("Deferred"))();c("WebAsyncStorage").setItem(k(a),b,function(c){if(c!=null)return d.reject(c);j[a]=b;d.resolve()});return d.getPromise()}function n(a){var b=new(c("Deferred"))();c("WebAsyncStorage").getItem(k(a),function(c,d){if(c)return b.reject(c);j[a]=d;b.resolve(d)});return b.getPromise()}function a(){return j}function d(a){return n(a).then(function(a){a=c("validateSharedWorkerReference")(a);return a==null?null:a})}function e(a){return l(a)}function f(a,d){var e=c("validateSharedWorkerReference")(d);if(e==null){c("FBLogger")("worker").mustfix('Failed to save worker reference for bundle "%s". Invalid reference: %s',a,JSON.stringify(d));return(h||(h=b("Promise"))).resolve()}return m(a,e)}g.SHARED_WORKER_STORAGE_KEY_BASE=i;g.getDebugState=a;g.getSharedWorkerReference=d;g.removeSharedWorkerReference=e;g.saveSharedWorkerReference=f}),98);
__d("SharedWorkerUptimeTracker",["FBLogger","ODS","SharedWorkerEventManager","clearInterval","performanceNow","setInterval","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=1e4,k=45e3,l=new Map();function m(a){return Math.floor(((i||(i=c("performanceNow")))()-a)/1e3)}function n(a,b){var e=0,f={};d("SharedWorkerEventManager").registerUptimeTrackerListener(a,function(a){a=a.trackerID;var c=f[a];if(c==null)return;(h||(h=d("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+b,1,0);h.bumpEntityKey(6653,"shared_worker_infra","worker_uptime_elapsed_time_to_response_sec."+m(c.createdMs)+"."+b);delete f[a]});return c("setInterval")(function(){var g=e++;c("setTimeout")(function(){var a=f[g];if(a==null)return;delete f[g]},k);f[g]={createdMs:(i||(i=c("performanceNow")))()};(h||(h=d("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+b,0,1);d("SharedWorkerEventManager").emitUptimeTracking(a,{trackerID:g})},j)}function a(a,b){if(l.has(b)){c("FBLogger")("worker").mustfix('Uptime tracking for worker "%s" already started.',b);return}l.set(b,{intervalID:n(a,b)})}function b(a){var b=l.get(a);b!=null&&(c("clearInterval")(b.intervalID),l["delete"](a))}g.startUptimeTracking=a;g.stopUptimeTracking=b}),98);
__d("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/webworker/rsrc/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("WebWorkerV2DynamicData",["Promise","XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder","cometAsyncFetchShared","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function a(a){var b=a.name,c=i.get(b);c==null&&(c=j(a),i.set(b,c));return c}function j(a){var d=a.name,e=a.v2HasteResponsePreloader;if(e==null)return k(d);var f=null;a=new(h||(h=b("Promise")))(function(a,b){e.onLoaded(function(b){b=b.data;f=b;a(b)}).onError(b)});return h.race([a,new h(function(a,b){window.setTimeout(function(){f==null?c("promiseDone")(k(d),a,b):a(f)},1e4)})])}function k(a){return c("cometAsyncFetchShared")(c("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder").buildUri({worker_module:a}).toString(),{data:{},getFullPayload:!0,method:"POST",skipSRState:!0}).then(function(b){if(b!=null&&typeof b==="object"&&Object.prototype.hasOwnProperty.call(b,"hrp")&&typeof b.hrp==="object")return b;throw c("err")("Unexpected data from WorkerInitResourceDeliveryController for worker %s",a)})}g.readDynamicDataForWorker=a}),98);
__d("buildSharedWorkerInitQPLLogger",["QPLUserFlow","SiteData","checkForIndexedDbSupported","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(931595918,"2062"),i=0;function a(a){var b=!1,d=!1,e=i++;function f(f){var g=f.version,i=f.workerName,j=f.callReason;f=f.experimental_init;if(b||d)return;b=!0;f={"int":{version:g,clientRev:c("SiteData").client_revision},bool:{isDev:!1,supportsIDB:c("checkForIndexedDbSupported")(),experimental_init:(g=f)!=null?g:!1},string:{workerName:i,hostname:window.location.hostname,callReason:j,pageID:c("pageID")}};c("QPLUserFlow").start(h,{onFlowTimeout:function(){c("QPLUserFlow").addAnnotations(h,{bool:{setupTimeout:!0}},{instanceKey:e}),d=!0},cancelOnUnload:!0,annotations:f,timeoutInMs:66e4,instanceKey:e});a==null?void 0:a({type:"start",data:{annotations:f}})}function g(f,g){if(!b||d)return;f=f+"_start";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function j(f,g){if(!b||d)return;f=f+"_end";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function k(f,g){if(!b||d)return;c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function l(f){if(!b||d)return;c("QPLUserFlow").endSuccess(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f}});d=!0}function m(f,g){if(!b||d)return;c("QPLUserFlow").endFailure(h,f,{annotations:g,instanceKey:e});a==null?void 0:a({type:"end",data:{errorName:f,annotations:g}});d=!0}function n(f){if(!b||d)return;c("QPLUserFlow").endCancel(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f,cancel:!0}});d=!0}function o(f){if(!b||d)return;c("QPLUserFlow").addAnnotations(h,f,{instanceKey:e});a==null?void 0:a({type:"annotate",data:{annotations:f}})}return{start:f,endFailure:m,addAnnotations:o,endSuccess:l,endCancel:n,markEventStart:g,markEventEnd:j,markPoint:k}}g["default"]=a}),98);
__d("buildSharedWorkerTerminateQPLLogger",["QPLUserFlow","SiteData","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(931600201,"1438"),i=0;function a(a){var b=!1,d=!1,e=i++;function f(f){var g=f.workerName;f=f.callReason;if(b||d)return;b=!0;g={"int":{clientRev:c("SiteData").client_revision},bool:{isDev:!1},string:{workerName:g,hostname:window.location.hostname,callReason:f,pageID:c("pageID")}};c("QPLUserFlow").start(h,{onFlowTimeout:function(){c("QPLUserFlow").addAnnotations(h,{bool:{setupTimeout:!0}},{instanceKey:e}),d=!0},cancelOnUnload:!0,annotations:g,timeoutInMs:3e4,instanceKey:e});a==null?void 0:a({type:"start",data:{annotations:g}})}function g(f,g){if(!b||d)return;f=f+"_start";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function j(f,g){if(!b||d)return;f=f+"_end";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function k(f,g){if(!b||d)return;c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function l(f){if(!b||d)return;c("QPLUserFlow").endSuccess(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f}});d=!0}function m(f,g){if(!b||d)return;c("QPLUserFlow").endFailure(h,f,{annotations:g,instanceKey:e});a==null?void 0:a({type:"end",data:{errorName:f,annotations:g}});d=!0}function n(f){if(!b||d)return;c("QPLUserFlow").endCancel(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f,cancel:!0}});d=!0}function o(f){if(!b||d)return;c("QPLUserFlow").addAnnotations(h,f,{instanceKey:e});a==null?void 0:a({type:"annotate",data:{annotations:f}})}return{start:f,endFailure:m,addAnnotations:o,endSuccess:l,endCancel:n,markEventStart:g,markEventEnd:j,markPoint:k}}g["default"]=a}),98);
__d("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/sharedworker/init_script/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("getSharedWorkerHash",["uuidv4"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("uuidv4")()}g["default"]=a}),98);
__d("createSharedWorkerBundleUrl",["XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a;return c("nullthrows")((a=c("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder").buildUri({hash:c("getSharedWorkerHash")()}).addQueryParams(c("getWorkerInitScriptSPINParams")()))==null?void 0:a.toString())}g["default"]=a}),98);
__d("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/webworker/init_script/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("supportsModuleWorker",["UserAgent"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){if(h!=null)return h;if(h!=null)return h;if(c("UserAgent").isEngine("Blink")){h=a?c("UserAgent").isEngine("Blink > 83"):c("UserAgent").isEngine("Blink > 80.1");return h}if(c("UserAgent").isBrowser("Safari")){h=c("UserAgent").isBrowser("Safari > 14.9");return h}if(c("UserAgent").isBrowser("Firefox")){h=c("UserAgent").isBrowser("Firefox > 113");return h}if(c("UserAgent").isEngine("WebKit")){h=c("UserAgent").isEngine("WebKit > 606");return h}if(c("UserAgent").isBrowser("IE")){h=!1;return h}var b={get type(){h=!0}};try{a?new SharedWorker("blob://",b):new Worker("blob://",b)}finally{h=(a=h)!=null?a:!1;return h}}g["default"]=a}),98);
__d("createSharedWorkerV2BundleUrl",["XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","nullthrows","supportsModuleWorker"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("supportsModuleWorker")(!0),b=c("getWorkerInitScriptSPINParams")();b.set("hash",c("getSharedWorkerHash")());return c("nullthrows")((a=c("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:a?"MODULE":"CLASSIC"}))==null?void 0:(a=a.addQueryParams(b))==null?void 0:a.toString())}g["default"]=a}),98);
__d("handleWorkerWriteError",["FBLogger","WebStorageCleanupReason"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a instanceof Error){c("FBLogger")("worker").catching(a).mustfix("Error occured checking in shared worker reference");return}if(a==="writes disabled"){var b;c("FBLogger")("worker").warn("Writes to WebAsyncStorage is disabled. Unable to save shared worker reference. Reason: %s",(b=d("WebStorageCleanupReason").getLastCleanupReason())!=null?b:"n/a");return}c("FBLogger")("worker").mustfix("Error occured checking in shared worker reference: %s",JSON.stringify(a))}g["default"]=a}),98);
__d("SharedWorkerInitFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4266");b=d("FalcoLoggerInternal").create("shared_worker_init",a);e=b;g["default"]=e}),98);
__d("logSharedWorkerInitStep",["SharedWorkerInitFalcoEvent","SiteData","gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h=c("uuidv4")();function a(a,b,d,e){if(!c("gkx")("21115"))return;c("SharedWorkerInitFalcoEvent").log(function(){return{client_id:h,bundle_name:a,client_rev:String(c("SiteData").client_revision),local_shared_worker_ref:b!=null?{bundle_url:b.url,rev:String(b.rev),spin_time:String(b.spin_time)}:null,new_shared_worker_ref:d!=null?{bundle_url:d}:null,init_step:e}})}g["default"]=a}),98);
__d("SharedWorkerBundleResource",["BootloaderPreloader","Deferred","FBLogger","Promise","SharedWorkerDevChangeManager","SharedWorkerEventManager","SharedWorkerLockManager","SharedWorkerLoggingUtils","SharedWorkerStatusLock","SharedWorkerStorageManager","SharedWorkerUptimeTracker","SiteData","StaticSiteData","TrustedTypesWebWorkerScriptURLPolicy","WebWorkerV2DynamicData","buildSharedWorkerInitQPLLogger","buildSharedWorkerTerminateQPLLogger","clearTimeout","createSharedWorkerBundleUrl","createSharedWorkerV2BundleUrl","err","getErrorSafe","gkx","handleWorkerWriteError","justknobx","logSharedWorkerInitStep","promiseDone","regeneratorRuntime","setTimeout","supportsModuleWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=5e3,j=12e3,k="no-post-message-from-worker",l=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this)||this;c.name="SelfTerminationError";c.message="Worker self terminated with the reason: "+a;c.reason=a;return c}return a}(babelHelpers.wrapNativeSuper(Error));function m(a,b,e,f){f==null?void 0:f.markEventStart("shared_worker_construct");var g=new SharedWorker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a),b);f==null?void 0:f.markEventEnd("shared_worker_construct");g.addEventListener("error",function(a){d("SharedWorkerLoggingUtils").logSharedWorkerError(f,a,b)});var h=new Set();d("SharedWorkerEventManager").registerWorkerSelfTerminationListener(g,function(a,c,e){d("SharedWorkerLoggingUtils").logSelfTermination(b,a,c,e)},{once:!0});var i=0;d("SharedWorkerEventManager").registerConnectionAckListener(g,function(a,b){i++;if(h.has("worker_connection_established")){f==null?void 0:f.addAnnotations({"int":{connectionAckNum:i}});return}h.add("worker_connection_established");f==null?void 0:f.addAnnotations({string:{connectedFrom:a,workerID:b}});f==null?void 0:f.markPoint("worker_connection_established")});d("SharedWorkerEventManager").registerWorkerInitPointsListener(g,function(a){if(h.has(a))return;h.add(a);f==null?void 0:f.markPoint("worker_init_point_"+a)});g.port.start();d("SharedWorkerEventManager").registerExecuteWorkerImportsListener(g,f,function(a){var b=a.err;a=a.attempts;f==null?void 0:f.addAnnotations({string:{importsError:b},"int":{importAttempts:a}});f==null?void 0:f.markPoint(b==null?"bundle_imports_success":"bundle_imports_failure")});var j=new(c("Deferred"))();d("SharedWorkerEventManager").registerExecuteWorkerAckListener(g,f,function(a){var b=a.workerSpinTime,e=a.err,g=a.isFirstInit,h=a.workerRev;a=a.workerSpinMode;d("SharedWorkerLoggingUtils").logExecuteAck(f,b,e,g,h,a);if(e!=null||b==null||h==null){j.reject(c("err")((g=e)!=null?g:"no worker rev or spin time"))}else j.resolve({rev:h,spinTime:b})});f==null?void 0:f.markEventStart("execute_worker");d("SharedWorkerEventManager").emitExecuteWorker(g,{jsModuleResource:e,isDev:!1});return j.getPromise().then(function(a){var b=a.rev;a=a.spinTime;return{worker:g,rev:b,spinTime:a}})}function n(a,e,f,g,h){var i,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:i=c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a);if(!c("gkx")("4129")){r.next=13;break}g==null?void 0:g.markEventStart("url_fetch");r.prev=3;r.next=6;return b("regeneratorRuntime").awrap(window.fetch(i.toString()));case 6:g==null?void 0:g.markEventEnd("url_fetch");r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](3),m=c("getErrorSafe")(r.t0),g==null?void 0:g.markPoint("url_fetch_fail",{string:{urlFetchError:m.toString()}});case 13:g==null?void 0:g.markEventStart("shared_worker_construct");n=c("supportsModuleWorker")(!0)?new SharedWorker(i,{name:e,type:"module"}):new SharedWorker(i,e);g==null?void 0:g.markEventEnd("shared_worker_construct");g==null?void 0:g.addAnnotations({string:{workerUrl:i.toString()}});d("SharedWorkerEventManager").registerConnectionAckListener(n,function(a,b){g==null?void 0:g.addAnnotations({string:{connectedFrom:a,workerID:b}}),g==null?void 0:g.markPoint("worker_connection_established")});n.addEventListener("error",function(a){d("SharedWorkerLoggingUtils").logSharedWorkerError(g,a,e)});o=new(c("Deferred"))();c("gkx")("3995")&&h&&(p=c("setTimeout")(function(){d("SharedWorkerEventManager").emitWorkerShutdown(n,{reason:k}),o.reject(new l(k))},j),d("SharedWorkerEventManager").registerAnyMessageListener(n,function(){c("clearTimeout")(p)}));d("SharedWorkerEventManager").registerWorkerSelfTerminationListener(n,function(b,c,f,a){g==null?void 0:g.addAnnotations({string:{selfTerminationError:a}}),d("SharedWorkerLoggingUtils").logSelfTermination(e,b,c,f),o.reject(new l(c))},{once:!0});q=new Set();d("SharedWorkerEventManager").registerWorkerInitPointsListener(n,function(a){if(q.has(a))return;q.add(a);g==null?void 0:g.markPoint("worker_init_point_"+a)});n.port.start();d("SharedWorkerEventManager").emitConnectionAckRequest(n,g);d("SharedWorkerEventManager").registerHrpInitListener(n,g,function(){});g==null?void 0:g.markPoint("read_dynamic_data");c("promiseDone")(d("WebWorkerV2DynamicData").readDynamicDataForWorker(f).then(function(a){g==null?void 0:g.markEventStart("hrp_init");try{var b=c("justknobx")._("1979");b&&d("BootloaderPreloader").preloadWorkerJSFromHRP(a.hrp);g==null?void 0:g.addAnnotations({bool:{prefetchWorkerScripts:b}})}catch(a){b=c("getErrorSafe")(a);g==null?void 0:g.addAnnotations({string:{hrpInitErr:b.toString()}});c("FBLogger")("worker").catching(a).warn("Failed to preload worker %s JS from HRP",e)}d("SharedWorkerEventManager").emitHrpInit(n,{hrp:a.hrp,js_env:a.js_env,isDev:!1},g)},function(a){a=c("getErrorSafe")(a);g==null?void 0:g.addAnnotations({string:{hrpInitErr:a.toString()}})}));d("SharedWorkerEventManager").registerExecuteWorkerAckListener(n,g,function(b){var e=b.workerSpinTime,a=b.err,f=b.isFirstInit,h=b.workerRev;b=b.workerSpinMode;d("SharedWorkerLoggingUtils").logExecuteAck(g,e,a,f,h,b);if(a!=null||h==null||e==null){o.reject(c("err")((f=a)!=null?f:"no worker rev or spin time"))}else o.resolve({rev:h,spinTime:e})});g==null?void 0:g.markEventStart("execute_worker");d("SharedWorkerEventManager").emitExecuteWorker(n);return r.abrupt("return",o.getPromise().then(function(a){var b=a.rev;a=a.spinTime;return{worker:n,rev:b,spinTime:a}}));case 33:case"end":return r.stop()}},null,this,[[3,9]])}function o(a,b,e,f,g,h){var i=new(c("Deferred"))();d("SharedWorkerEventManager").registerGetWorkerRevListener(a,h,function(a){var j=a.rev;a=a.spinTime;c("promiseDone")(d("SharedWorkerStorageManager").saveSharedWorkerReference(e,{url:b,rev:j,spin_time:a,version:g.version,rsrcBundleUrl:g.getJSModuleBundleResource().url,sandboxOnlyChecksum:g.sandboxOnlyChecksum}).then(function(){return d("SharedWorkerStorageManager").getSharedWorkerReference(e)}).then(function(a){c("logSharedWorkerInitStep")(e,a,g.resourceUrlForLogging,"after_worker_reference_save")}),function(){h.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!0}}),i.resolve(),f()},function(a){h.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!1}}),i.reject(a),c("handleWorkerWriteError")(a),f()})});h.markEventStart("get_worker_rev");d("SharedWorkerEventManager").emitGetRev(a);return i.getPromise()}function p(a,b,e){d("SharedWorkerEventManager").registerForwardListeners(a),d("SharedWorkerEventManager").registerWorkerShutdownListener(a,function(a){var c=a.reason;a=a.workerID;d("SharedWorkerLoggingUtils").logShutdown(e,null,c,a);c==="requested-upgrade"&&(b==null?void 0:b());d("SharedWorkerUptimeTracker").stopUptimeTracking(e)}),d("SharedWorkerDevChangeManager").trackCreatedWorker(e),d("SharedWorkerUptimeTracker").startUptimeTracking(a,e),c("logSharedWorkerInitStep")(e,null,null,"create_worker_end")}function q(a,d,e,f,g,h){var i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:h.addAnnotations({string:{initFlow:"use_existing_ref"}});c("logSharedWorkerInitStep")(a,null,null,"using_existing_worker_ref");k.next=4;return b("regeneratorRuntime").awrap(d.version===2?n(d.url,a,e.getJSModuleBundleResource(),h,e.version===2?e.withPostMessageTimeout:!1):m(d.url,a,e.getJSModuleBundleResource(),h));case 4:i=k.sent;j=i.worker;f();p(j,g,a);return k.abrupt("return",j);case 9:case"end":return k.stop()}},null,this)}function r(){return self.LockManager!=null&&self.navigator.locks instanceof self.LockManager}function s(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(r()){e.next=2;break}return e.abrupt("return",!0);case 2:e.next=4;return b("regeneratorRuntime").awrap(self.navigator.locks.query());case 4:c=e.sent;return e.abrupt("return",c.held.some(function(b){return b.name===d("SharedWorkerStatusLock").getStatusLockName(a)}));case 6:case"end":return e.stop()}},null,this)}function t(a,e,f,g,h,j){var k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:j.addAnnotations({string:{initFlow:"upgrade_worker_ref"}});k=new(c("Deferred"))();n.next=4;return b("regeneratorRuntime").awrap(s(a));case 4:if(!n.sent){n.next=12;break}e.version===2&&c("supportsModuleWorker")(!0)?l=new SharedWorker(e.url,{name:a,type:"module"}):l=new SharedWorker(e.url,a);d("SharedWorkerEventManager").registerWorkerShutdownListener(l,function(a){var b=a.workerID;a=a.isInitialized;k.resolve();j.markEventEnd("old_worker_shutdown",{string:{oldWorkerID:b},bool:{oldWorkerWasInitialized:a}});j.addAnnotations({string:{oldWorkerShutdown:"success"}})},{once:!0});j.markEventStart("old_worker_shutdown");d("SharedWorkerEventManager").emitWorkerShutdown(l,{upgrade:!0});l.port.start();n.next=14;break;case 12:k.resolve(),j.addAnnotations({string:{oldWorkerShutdown:"not_needed"}});case 14:if(!c("gkx")("4471")){n.next=21;break}m=c("setTimeout")(function(){j.addAnnotations({string:{oldWorkerShutdown:"timeout"}}),k.reject(c("err")("Worker shutdown timeout on upgrade"))},i);n.next=18;return b("regeneratorRuntime").awrap(k.getPromise());case 18:c("clearTimeout")(m);n.next=22;break;case 21:k.resolve();case 22:return n.abrupt("return",v(a,f,g,h,j,"upgrading_worker_ref"));case 23:case"end":return n.stop()}},null,this)}function u(a,b,c,d,e){e.addAnnotations({string:{initFlow:"new_worker_ref"}});return v(a,b,c,d,e,"new_worker_ref")}function v(a,e,f,g,h,i){var j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:c("logSharedWorkerInitStep")(a,null,null,i);m.next=3;return b("regeneratorRuntime").awrap(s(a));case 3:if(!m.sent){m.next=5;break}c("FBLogger")("worker").info("Trying to create a worker %s while old one is still running",a);case 5:m.next=7;return b("regeneratorRuntime").awrap(e.createSharedWorker());case 7:j=m.sent;k=j[0];l=j[1].worker;if(!(i==="upgrading_worker_ref")){m.next=13;break}m.next=13;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").removeSharedWorkerReference(a));case 13:m.next=15;return b("regeneratorRuntime").awrap(o(l,k,a,f,e,h));case 15:p(l,g,a);return m.abrupt("return",l);case 17:case"end":return m.stop()}},null,this)}function w(a,e,f,g){var h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:g.markEventStart("create_worker");h=a.name;d("SharedWorkerUptimeTracker").stopUptimeTracking(h);n.t0=g;if(!r()){n.next=10;break}n.next=7;return b("regeneratorRuntime").awrap(s(h));case 7:n.t1=n.sent;n.next=11;break;case 10:n.t1=null;case 11:n.t2=n.t1;n.t3={workerAlreadyRunning:n.t2};n.t4={bool:n.t3};n.t0.addAnnotations.call(n.t0,n.t4);n.next=17;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").getSharedWorkerReference(h));case 17:i=n.sent;c("logSharedWorkerInitStep")(h,i,a.resourceUrlForLogging,"create_worker_start");if(!(i==null)){n.next=21;break}return n.abrupt("return",u(h,a,e,f,g));case 21:j=i.spin_time,k=i.version,l=i.rev;g.addAnnotations({"int":{storageWorkerSpinTime:j,storageWorkerVersion:k,storageWorkerRev:l}});m=d("SharedWorkerDevChangeManager").shouldUseStorageWorkerForDev(h,{storageWorkerResource:i,tabResource:a});if(!(l>=c("SiteData").client_revision&&(a.version===k||j>=c("SiteData")[c("StaticSiteData").spin_time_key])&&m)){n.next=28;break}return n.abrupt("return",q(h,i,a,e,f,g));case 28:return n.abrupt("return",t(h,i,a,e,f,g));case 29:case"end":return n.stop()}},null,this)}function a(a,e,f){f=(f=f)!=null?f:{};var g=f.onQPLEvent;f=f.reason;var h=a.name,i=c("buildSharedWorkerInitQPLLogger")(g);i.start({version:1,workerName:h,callReason:f});d("SharedWorkerLoggingUtils").logLocalStorageWriteAttempt();var j=new(c("Deferred"))();d("SharedWorkerLockManager").withWorkerLock(function(d){var f;c("promiseDone")(w({name:h,version:1,resourceUrlForLogging:(f=a.url)!=null?f:"",getJSModuleBundleResource:function(){return a},createSharedWorker:function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=c("createSharedWorkerBundleUrl")();e.t0=d;e.next=4;return b("regeneratorRuntime").awrap(m(d,h,a,i));case 4:e.t1=e.sent;return e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},null,this)}},d,e,i),function(a){i.markEventEnd("create_worker"),i.endSuccess(),j.resolve(a)},function(a){a=typeof a==="string"?c("err")(a):a;i.endFailure("worker_init_failure",{string:{workerInitFailureReason:a.message,errorName:a.name}});j.reject(a);d()})},{workerQPLLogger:i,onLockTimeout:function(){return j.reject(c("err")("Worker lock timeout"))}});return j.getPromise()}function x(a,e,f,g){var i;g===void 0&&(g=0);var j=a.name;i=(i=f)!=null?i:{};var k=i.onQPLEvent;i=i.reason;var m=c("buildSharedWorkerInitQPLLogger")(k);m.start({version:2,workerName:j,callReason:i});d("SharedWorkerLoggingUtils").logLocalStorageWriteAttempt();m.addAnnotations({bool:{usingModuleWorker:c("supportsModuleWorker")(!0)}});var o=new(c("Deferred"))(),p=g===0;d("SharedWorkerLockManager").withWorkerLock(function(d){c("promiseDone")(w({name:j,version:2,getJSModuleBundleResource:function(){return a},sandboxOnlyChecksum:a.sandboxOnlyChecksum,createSharedWorker:function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=c("createSharedWorkerV2BundleUrl")();e.t0=d;e.next=4;return b("regeneratorRuntime").awrap(n(d,j,a,m,p));case 4:e.t1=e.sent;return e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},null,this)},withPostMessageTimeout:p},d,e,m),function(a){m.markEventEnd("create_worker"),m.endSuccess(),o.resolve(a)},function(a){a=typeof a==="string"?c("err")(a):a;o.reject(a);d()})},{workerQPLLogger:m,onLockTimeout:function(){return o.reject(c("err")("Worker lock timeout"))},onLockFail:function(a){o.reject(a)}});return o.getPromise()["catch"](function(d){if(d instanceof l&&g<2){m.endCancel({string:{workerInitCancelReason:d.message},"int":{workerInitRetry:g}});return new(h||(h=b("Promise")))(function(b,d){c("setTimeout")(function(){c("promiseDone")(x(a,e,f,g+1),b,d)},g===0?200:500)})}m.endFailure("worker_init_failure",{string:{workerInitFailureReason:d.message,errorName:d.name}});throw d})}function e(a,b,e){var f=(b=b)!=null?b:a.name,g=new(c("Deferred"))(),h=c("buildSharedWorkerTerminateQPLLogger")();h.start({workerName:f});h.addAnnotations({string:{reason:e}});d("SharedWorkerLockManager").withWorkerLock(function(b){c("promiseDone")(d("SharedWorkerStorageManager").getSharedWorkerReference(f).then(function(b){h.markPoint("read_worker_reference",{"int":{storageWorkerVersion:b==null?void 0:b.version},bool:{storageReferenceExists:b!=null}});if(b!=null){var c;b.version===2?c=n(b.url,f,a,void 0,!1).then(function(a){a=a.worker;return a}):c=m(b.url,f,a).then(function(a){a=a.worker;return a});return d("SharedWorkerStorageManager").removeSharedWorkerReference(f).then(function(){h.markPoint("removed_worker_reference");return c})}return null}),function(a){try{b(),d("SharedWorkerUptimeTracker").stopUptimeTracking(f),a!=null?(d("SharedWorkerEventManager").registerWorkerShutdownListener(a,function(a){var b=a.workerID;a=a.isInitialized;g.resolve();h.endSuccess({string:{workerID:b},bool:{wasInitialized:a}})},{once:!0}),d("SharedWorkerEventManager").emitWorkerShutdown(a,{reason:e})):(h.endSuccess(),g.resolve())}catch(a){h.endFailure("terminate_worker_failure",{string:{workerTerminateFailReason:a.message}}),g.reject(a.message)}},function(a){c("FBLogger")("worker").catching(c("getErrorSafe")(a)).mustfix("Failed to terminate worker"),h.endFailure("terminate_worker_failure",{string:{workerTerminateFailReason:a.message}}),g.reject(a.message),b()})},{workerQPLLogger:h});c("setTimeout")(function(){return g.reject()},i);return g.getPromise()}function f(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").getSharedWorkerReference(a.name));case 2:c=e.sent;return e.abrupt("return",c!=null);case 4:case"end":return e.stop()}},null,this)}g.SelfTerminationError=l;g.createPushSafeSharedWebWorkerAsync=a;g.createPushSafeSharedWebWorkerV2Async=x;g.terminateSharedWorker=e;g.doesSharedWorkerReferenceExist=f}),98);
__d("WebWorkerV2Resource",["TrustedTypesWebWorkerScriptURLPolicy","WebWorkerV2DynamicData","XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","forEachObject","getAsyncParamsFromCurrentPageURI","getWorkerInitScriptSPINParams","nullthrows","promiseDone","supportsModuleWorker"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=(b=b)!=null?b:a.name;var e=c("supportsModuleWorker")(!1)?"module":"classic",f=c("getWorkerInitScriptSPINParams")();c("forEachObject")(c("getAsyncParamsFromCurrentPageURI")(),function(a,b){f.set(b,a)});var g=c("nullthrows")(c("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:c("supportsModuleWorker")(!1)?"MODULE":"CLASSIC"}).addQueryParams(f)).toString();g=c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(g);var h=new Worker(g,{name:b,type:e});c("promiseDone")(d("WebWorkerV2DynamicData").readDynamicDataForWorker(a).then(function(a){h.postMessage({type:"ww-hrp-init",hrp:a.hrp,js_env:a.js_env,is_dev:!1,tiered:!0})}));return{worker:h,url:g.toString()}}g.createDedicatedV2WebWorker=a}),98);
__d("MAWWebWorkerSingleton",["MAWMICSafe","MAWStartupLoggingUtils","MAWWebWorkerInstance","Promise","SharedWorkerBundleResource","WAResolvable","WebWorkerV2Resource","cr:6600","promiseDone","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWWebWorkerInstance").destroyWorkerInstance,j=new(d("WAResolvable").Resolvable)();function a(a){var e=d("MAWWebWorkerInstance").getWorkerInstancePromise();if(e)return e;d("MAWMICSafe").markEvent("maw_worker_create_start");var f=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();if(f){f=d("SharedWorkerBundleResource").createPushSafeSharedWebWorkerV2Async;e=f(b("cr:6600"),function(){c("promiseDone")(j.promise.then(function(){return i()}))},{onQPLEvent:d("MAWStartupLoggingUtils").logSharedWorkerQPLEvents,reason:a}).then(function(a){a.addEventListener("error",function(a){d("MAWStartupLoggingUtils").logWorkerError("Shared Worker",a,"")});return a.port})}else e=(h||(h=b("Promise"))).resolve(d("WebWorkerV2Resource").createDedicatedV2WebWorker(b("cr:6600"))).then(function(a){var b=a.url;a=a.worker;a.onerror=function(a){return d("MAWStartupLoggingUtils").logWorkerError("Dedicated Worker",a,b)};d("MAWStartupLoggingUtils").setImportScriptsErrorListener(a);return a});e=e.then(function(a){d("MAWMICSafe").markEvent("maw_worker_create_end");return a});d("MAWWebWorkerInstance").setWorkerInstancePromise(e);return e}function e(a){i=a,j.resolve()}g.createWorkerIfNone=a;g.setOnCloseForWorkerInstance=e}),98);
__d("waitForMAWWorkerCreated",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";a=new(d("WAResolvable").Resolvable)();b=a.promise;g.resolvable=a;g.promise=b}),98);
__d("MAWSetupWorker",["CurrentUser","Deferred","IGDWebUtils","MAWClientConsistencyRefresh","MAWCommonSetupWorker","MAWCrossWorkerPortal","MAWInit","MAWLoggerUtils","MAWMICSafe","MAWWebWorkerInstance","MAWWebWorkerSingleton","MAWWorkerWatchdog","SharedWorkerBundleResource","WATagsLogger","asyncToGeneratorRuntime","cr:6600","err","pageID","promiseDone","shouldUseMAWSharedWorker","waitForMAWWorkerCreated"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Shared worker responded to termination request: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker terminating: for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker doesn't exist, no need to terminate"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker setting up"]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.WorkerSetup,d("MAWLoggerUtils").Tag.MAWInit]),m=d("IGDWebUtils").isInstagramWebSupportedApp(Number(c("CurrentUser").getAppID())),n=m?"IGDAWMainWorker":"MAWMainWorker",o=null,p=!1;function q(a){switch(a){case"mawInit":return!0;case"mawReinitSetupMutex":case"mawReinitReregDevice":case"watchdogRestart":case"workerUpgraded":return!1}}function r(a,e,f,g,h,i){var j;i===void 0&&(i=null);d("MAWMICSafe").markEvent("maw_worker_init_start");if(p)throw c("err")("Worker is permanently killed.");var m=function(){return r(a,e,f,g,"workerUpgraded")};(j=i)==null?void 0:j.sharedWorkerRestartAddPoint("create_worker_instance_start");d("MAWWebWorkerSingleton").setOnCloseForWorkerInstance(function(){s("createWorkerIfNone:onClose"),d("MAWInit").MAWInit.addBoolAnnotation("workerUpgraded",!0),c("promiseDone")(m())});j=d("MAWWebWorkerSingleton").createWorkerIfNone(h);var q=new(c("Deferred"))();o=q.getPromise();return j.then(function(g){var h;d("waitForMAWWorkerCreated").resolvable.resolve();d("MAWInit").MAWInit.logPoint("create_worker_end");(h=i)==null?void 0:h.sharedWorkerRestartAddPoint("create_worker_instance_end");l.LOG(k());d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()&&g.addEventListener("message",function(a){var b;typeof a.data==="object"&&((b=a.data)==null?void 0:b.type)==="sw-shutdown"&&typeof a.data.response==="object"&&((b=a.data.response)==null?void 0:b.reason)==="maw-request-refresh"&&(d("MAWWorkerWatchdog").terminateWatchdog(),c("MAWClientConsistencyRefresh")("ls_forced_refresh"))});var j=new(d("MAWCommonSetupWorker").BridgeAdapter)(g,n);q.resolve(j);e(j);return d("MAWInit").MAWInit.measurePerformance("init_backend",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=function(){return d("MAWCommonSetupWorker").initWorker(j,a,m,f)};b=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?yield b():yield j.fullyConnected.then(b);d("MAWMICSafe").markEvent("maw_backend_init_end");return b}))})}function a(a,b,e,f,g,h){h===void 0&&(h=null);d("MAWInit").MAWInit.logPoint(o==null?"create_worker_start":"create_worker_skipped");if(o!=null)return o;h=r(a,b,e,f,g,h);q(g)&&d("MAWWorkerWatchdog").startWatchdog({initPageID:c("pageID"),onConnectToExistingWorker:e,onTerminateWorker:f,onWorkerConnect:b,vaultMaterials:a});return h}function e(){return o}function s(a,b){b===void 0&&(b=!1);if(!o){l.LOG(j());return!1}l.LOG(i(),a);c("promiseDone")(o.then(function(a){return a==null?void 0:a.close()}));o=null;d("MAWCrossWorkerPortal").killPortalWhenWorkerTerminating();d("MAWWebWorkerInstance").destroyWorkerInstance();b&&d("MAWWorkerWatchdog").terminateWatchdog();return!0}function f(){s("terminateWorkerPermanently",!0),p=!0}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("SharedWorkerBundleResource").terminateSharedWorker(b("cr:6600"),null,a?"maw-request-refresh":void 0)});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();if(b){b=(yield t(!1).then(function(){return!0},function(){return!1}));l.LOG(h(),b);(b=(yield o))==null?void 0:b.close();o=null;d("MAWCrossWorkerPortal").killPortalWhenWorkerTerminating();d("MAWWebWorkerInstance").destroyWorkerInstance()}else s(a,!0)});return w.apply(this,arguments)}g.getOrSetupWorker=a;g.waitForWorkerSetup=e;g.terminateDedicatedWorker=s;g.terminateWorkerPermanently=f;g.killSharedWorker=t;g.terminateWorker=v}),98);
__d("MAWSharedWorkerReboot",["MAWSetupWorker","MAWWaitForBackendSetup","ODS","Promise","WALogger","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["shared worker reconnection failed - ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clear the shared worker reference in MAWSharedWorkerReboot"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["starting reconnection to shared worker"]);l=function(){return a};return a}function m(a){(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_shared_worker_reboot","shared_worker_reboot_"+a)}function a(a,b,c,d,e){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i){d("WALogger").LOG(l());m("start");i.startSharedWorkerRestart();d("WALogger").LOG(k());c("gkx")("2496")?yield d("MAWSetupWorker").terminateWorker("MAWSharedWorkerReboot"):d("MAWSetupWorker").terminateDedicatedWorker("Clear the shared worker reference in MAWSharedWorkerReboot");d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").resetBackendSetup()});return new(h||(h=b("Promise")))(function(b,c){return d("MAWSetupWorker").getOrSetupWorker(a,e,f,g,"watchdogRestart").then(function(a){m("success"),i.endSuccessSharedWorkerRestart(),e(a),d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").resolveBackendSetup()}),b()})["catch"](function(a){d("WALogger").ERROR(j(),a.message),m("fail"),i.endFailureSharedWorkerRestart(a.message),d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").rejectBackendSetup(a)}),c(a)})})});return n.apply(this,arguments)}g.rebootSharedWorker=a}),98);
__d("MAWWorkerBadStateRecovery",["HiddenTabDataUtils","QPLUserFlow","performanceNow","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(1056840252,"808"),j=0;function a(){var a=j++,b;function e(e,f){var g=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();b=(h||(h=c("performanceNow")))();var j=d("HiddenTabDataUtils").getHiddenTabDataForTimeInterval(0,b);c("QPLUserFlow").start(i,{annotations:{bool:{isSharedWorker:g,wasHiddenBefore:j.wasHidden(),wasHiddenOnStart:j.isHidden()},"int":{lastTimeHiddenBefore:j.lastTimeHidden(),successfulHeartbeatsBefore:f,totalHiddenTimeBefore:j.totalHiddenTime()},string:{trigger:"heartbeat_timeout",workerInitPageID:e}},instanceKey:a});g||c("QPLUserFlow").endFailure(i,"recovery_not_supported",{instanceKey:a})}function f(d){if(b==null)return;var e=p(b);c("QPLUserFlow").addPoint(i,"shared_worker_restart_"+d,{instanceKey:a});c("QPLUserFlow").addAnnotations(i,e,{instanceKey:a})}function g(){f("start")}function k(){f("success")}function l(d){if(b==null)return;var e=p(b);f("fail");c("QPLUserFlow").addAnnotations(i,babelHelpers["extends"]({},e,{string:{sharedWorkerRestartFailureReason:d}}),{instanceKey:a})}function m(d){if(b==null)return;var e=p(b);c("QPLUserFlow").addPoint(i,"heartbeat_still_fails",{instanceKey:a});c("QPLUserFlow").addAnnotations(i,babelHelpers["extends"]({},e,{string:{recentHeartbeatFailureReason:d}}),{instanceKey:a})}function n(d){if(b==null)return;var e=p(b);c("QPLUserFlow").endFailure(i,d,{annotations:e,instanceKey:a})}function o(){if(b==null)return;var d=p(b);c("QPLUserFlow").endSuccess(i,{annotations:d,instanceKey:a})}function p(a){a=d("HiddenTabDataUtils").getHiddenTabDataForTimeInterval(a,(h||(h=c("performanceNow")))());return{bool:{wasHiddenDuringRecovery:a.wasHidden(),wasHiddenOnRecoveryEnd:a.isHidden()},"int":{lastTimeHiddenDuringRecovery:a.lastTimeHidden(),totalHiddenTimeDuringRecovery:a.totalHiddenTime()}}}return{endFailure:n,endFailureSharedWorkerRestart:l,endSuccess:o,endSuccessSharedWorkerRestart:k,postRestartHeartbeatsFailed:m,sharedWorkerRestartAddPoint:f,start:e,startSharedWorkerRestart:g}}g.buildWorkerBadStateRecoveryQPLLogger=a}),98);
__d("MAWWorkerWatchdog",["CurrentUser","MAWBridgeLoggingUtils","MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","MAWSharedWorkerReboot","MAWWaitForBackendSetup","MAWWorkerBadStateRecovery","Promise","WAShiftTimer","clearInterval","clearTimeout","err","gkx","justknobx","promiseDone","setInterval","setTimeout","shouldUseMAWSharedWorker","vc-tracker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("gkx")("24001"),j=c("justknobx")._("1008"),k=c("justknobx")._("1369"),l=k/2,m=!1,n=!1,o=function(){},p=0;function a(){return n}function q(){if(!n||!i)return;o();n=!1}function r(a,b){m=!1;return d("MAWSharedWorkerReboot").rebootSharedWorker(a.vaultMaterials,a.onWorkerConnect,a.onConnectToExistingWorker,a.onTerminateWorker,b)}function s(a){var b;(b=d("MAWIssueNewUserVisibleErrors")).issueError(b.MAWGeneralErrorMsgBody,b.MAWGeneralErrorMsgTitle,b.MAWUserVisibleErrorPresentationType.BANNER);return c("err")("Cannot recover the worker: "+a)}function t(){return(h||(h=b("Promise"))).race([d("MAWBridgeSendAndReceive").sendAndReceive("backend",d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE),new h(function(a,b){c("setTimeout")(function(){b(c("err")("Armadillo web worker heartbeat timed out."))},l)})]).then(function(a){return a===!0},function(a){return!1})}function u(){var a=null;return new(h||(h=b("Promise")))(function(b,e){var f=new(d("WAShiftTimer").ShiftTimer)(function(){c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend",d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE).then(function(d){d?(f.cancel(),c("clearTimeout")(g),b()):(f.onOrAfter(l),a="Wrong heartbeat result: "+d.toString())},function(b){f.onOrAfter(l),a="Heartbeat failure: "+b.message}))});f.forceRunNow();var g=c("setTimeout")(function(){var b;f.cancel();e(c("err")((b=a)!=null?b:"Did not get heartbeat response on time"))},j)})}function v(a,e){return new(h||(h=b("Promise")))(function(b,f){var g=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();g||f(s("Worker recovery is supported for shared worker only."));c("CurrentUser").isLoggedInNow()||f(s("User is not logged in, aborting recovery"));return r(a,e).then(function(){return u()},function(a){e.endFailureSharedWorkerRestart(a.message),f(s(a.message))}).then(function(){return b()},function(a){e.postRestartHeartbeatsFailed(a.message),f(s(a.message))})})}function w(){var a=c("vc-tracker").performanceNow();return c("vc-tracker").VisibilityState.wasHidden(a-1,a)}function e(a){if(n||!i)return;var b=c("setInterval")(function(){if(!m||w())return;c("promiseDone")(t(),function(b){if(!b){d("MAWBridgeLoggingUtils").logRecentBridgeEvents();var e=d("MAWWorkerBadStateRecovery").buildWorkerBadStateRecoveryQPLLogger();e.start(a.initPageID,p);c("promiseDone")(v(a,e),function(){e.endSuccess(),m=!0},function(a){e.endFailure(a.message),q()})}else p++})},k);d("MAWWaitForBackendSetup").runAfterBackendSetup(function(){m=!0},d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE);o=function(){a.onTerminateWorker(),c("clearInterval")(b)};n=!0}g.isWatchdogRunning=a;g.terminateWatchdog=q;g.startWatchdog=e}),98);
__d("MAWGetDBVersionForTest",["gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("justknobx")._("1495"))return;var a=new URL(document.location.href);a=a.searchParams.get("db_version");if(a==null)return;if(a==="current"||a==="latest")return a;a=parseInt(a,10);if(Number.isInteger(a))return Number(a)}function b(){if(!c("gkx")("1159"))return;var a=new URL(document.location.href);a=a.searchParams.get("db_migration_state");if(a!=null&&(a==="dexie"||a==="restore"))return a}g.getDbVersionForTest=a;g.getDbMigrationState=b}),98);
__d("MAWCommonSetupWorker",["Deferred","MAWCurrentUser","MAWGetDBVersionForTest","MAWInit","MAWMICSafe","MAWSetupWorker","MessengerWebInitData","WADevToolMessageChannel","WALogger","WorkerClient","WorkerMessagePort","err","gkx","pageID"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Terminating worker and rebooting..."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker receive invalid message: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["no setup hash for worker"]);j=function(){return a};return a}var k=c("gkx")("3282");b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;e.$BridgeAdapter$p_1=b;d("WorkerClient").init(babelHelpers.assertThisInitialized(e));e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);function a(a,b,e,f){var g=new(c("Deferred"))();a.addMessageListener("worker-setup",function(b){if(b.setupHash!==c("pageID")){d("WALogger").WARN(j());return}if(b==null||b.type!=="worker-setup"){d("WALogger").WARN(i(),b);return}if(b.status==="success")g.resolve(a.getBridgePort());else if(b.status==="failure"){var k;g.reject(c("err")((k=b.msg)!=null?k:"Error setting up worker"))}else if(b.status==="already-setup")if(b.action==="no-action"){g.resolve(a.getBridgePort());f();d("MAWInit").MAWInit.logPoint("worker_already_setup");return}else if(b.action==="reboot-required"&&b.setupHash===c("pageID")){d("WALogger").DEV(h());d("MAWSetupWorker").terminateDedicatedWorker("reboot required");d("MAWInit").MAWInit.addBoolAnnotation("worker_reboot_required",!0);return e().then(function(a){return g.resolve(a)})["catch"](function(a){return g.reject(a)})}else throw c("err")("Iinvalid action for worker-setup:already-setup: "+b.action);else throw c("err")("Invalid message for worker")});a.addMessageListener("worker-setup-ack",function(a){if(a.setupHash!==c("pageID"))return;d("MAWInit").MAWInit.logPoint("worker_ack");d("MAWMICSafe").markEvent("worker_init_setup_ack")});b={content:{fbId:d("MAWCurrentUser").getID(),sessionId:c("MessengerWebInitData").sessionId,testDbMigrationState:d("MAWGetDBVersionForTest").getDbMigrationState(),testDbVersion:d("MAWGetDBVersionForTest").getDbVersionForTest(),userKeyBase:c("MessengerWebInitData").userKeyBase,vaultMaterials:b},setupHash:c("pageID"),type:"worker-setup"};if(k){var l=d("WADevToolMessageChannel").createNewChannel();b.content.devToolMessageChannelPort2=l.port2;a.postMessage(b,[l.port2])}else a.postMessage(b);return g.getPromise()}g.BridgeAdapter=b;g.initWorker=a}),98);
__d("MWDeleteAllDBs",["MAWEncryptionIndexedDbV2","MAWIndexedDBDeletion","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","asyncToGeneratorRuntime","cr:4434","cr:6883"],(function(a,b,c,d,e,f,g){"use strict";function h(){d("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE,"full_due_to_ear")}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){b("cr:6883")&&(yield b("cr:6883").deleteIndexedDB(a)),b("cr:4434")&&(yield b("cr:4434").deleteEBIDB()),yield d("MAWIndexedDBDeletion").deleteMAWPersistence(),yield d("MAWEncryptionIndexedDbV2").deleteEncryptionDB(),h()});return i.apply(this,arguments)}g["default"]=a}),98);
__d("MAWEncryptionErrorHandler",["FBLogger","LSPlatformErrorChannel","MAWEARDecryptionError","MAWSetupWorker","MWDeleteAllDBs","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield d("MAWSetupWorker").terminateWorker(b);return c("MWDeleteAllDBs")(a)}catch(d){c("FBLogger")("maw_ear").catching(d).mustfixThrow("Fail to delete dbs from: %s terminateWorkerReason: %s",a,b)}});return i.apply(this,arguments)}function a(a){c("promiseDone")(h("bridge","EARDecryptionError")["finally"](function(){return c("LSPlatformErrorChannel").emit(new(c("MAWEARDecryptionError"))("MAW DB Decryption Error in "+a+" table"))}))}function e(){return h("error","MAWEARKeychainDecryptionError")}g.handleEARDecryptionError=a;g.handleEARKeychainError=e}),98);
__d("toMsgrUserJid",["MAWJids"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=d("MAWJids").toUserJid}),98);
__d("MAWFetchContacts",["I64","LSContactTypeExact","LSIntEnum","MAWContactRelationshipType","ReQL","WAJids","asyncToGeneratorRuntime","requireDeferred","toMsgrUserJid"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("MAWFetchContacts");function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j.load());b=(yield b());var e=new Set(a.map(function(a){return d("WAJids").extractUserId(a)}));return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(b.tables.contacts).filter(function(a){return e.has((h||(h=d("I64"))).to_string(a.id))})).then(function(a){return new Map(a.map(function(a){return[c("toMsgrUserJid")((h||(h=d("I64"))).to_string(a.id)),a]}))})});return l.apply(this,arguments)}function a(a){return k(a).then(function(a){var b=new Map();a.forEach(function(a,c){b.set(c,d("MAWContactRelationshipType").getContactRelationshipType(a))});return b})}function e(a){return k(a).then(function(a){var b=new Map();a.forEach(function(a,e){a=a.contactTypeExact!=null&&(h||(h=d("I64"))).equal(a.contactTypeExact,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").MESSENGER_ONLY_NOT_ALLOWED_ON_FB));b.set(e,a)});return b})}g.fetchContacts=k;g.fetchContactsRelationships=a;g.fetchContactsIsMsplit=e}),98);
__d("MAWSetupBridgeIsDbMigrating",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return function(b){b=b.status;switch(b){case!0:a({tag:"IsDbMigrating",value:!0});return;case!1:a({tag:"IsDbMigrating",value:!1});return}}};b=a;f["default"]=b}),66);
__d("MAWSetupBridgeOfflineSnapshot",["InteractionTracingMetrics","MAWMIC","MWChatInteraction","WAOfflineUtils","WATagsLogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["WA infra offline connection lost"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats end: "," / ",", messages: "," / ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Progress: "," / ",", messages: "," / ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats start: ",", messages: ",""]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["ServerRPC","Offline"]);function m(a){d("MAWMIC").addIntAnnotation("offlineQueueSize",a);var b=d("MWChatInteraction").get(d("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN);b!=null&&c("InteractionTracingMetrics").addAnnotationInt(b,"offlineQueueSize",a)}a=function(a){return function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.downloaded,e=b.expected,f=b.status;b=b.timestamp;switch(f){case d("WAOfflineUtils").WAClientInfraOfflineProgress.Initializing:l.LOG(k(),e.count,e.message);m(e.count);a({tag:"InitOfflineQueueSyncStart",value:e.count});d("MAWMIC").markEvent("worker_download_offline_queue_start",b);return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Processing:l.LOG(j(),c.count,e.count,c.message,e.message);a({tag:"InitOfflineQueueSyncProgress",value:c.count});return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Complete:l.LOG(i(),c.count,e.count,c.message,e.message);d("MAWMIC").addIntAnnotation("offlineQueueDownloadedCount",c.count);a({tag:"InitOfflineQueueSyncProgress",value:e.count});d("MAWMIC").markEvent("worker_download_offline_queue_end",b);return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Failed:l.LOG(h());d("MAWMIC").markEvent("worker_download_offline_queue_connection_lost",b);return}});return function(a){return c.apply(this,arguments)}}()};e=a;g["default"]=e}),98);
__d("IGDSetupBridge",["DTSG","FBLogger","JSResourceForInteraction","LSDatabaseSingleton","LSInitSyncCompleteSubscription","LSPlatformGraphQLLightspeedRequest","LSPlatformGraphQLLightspeedRequestForIGD","MAWAbPropsClient","MAWBridgeReceivedChatStateHandler","MAWBridgeUIEventHandler","MAWCommonSetupBridge","MAWEncryptionErrorHandler","MAWFetchContacts","MAWGetEphemeralSettings","MAWSetupBridgeIsDbMigrating","MAWSetupBridgeOfflineSnapshot","Promise","Run","WAExceededStorageQuota","asyncToGeneratorRuntime","cr:3411","emptyFunction","gkx","isInstamadillo","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(e=c("requireDeferred"))("ArmadilloCutoverClientFalcoEvent").__setRef("IGDSetupBridge"),k=e("IGDBridgeResignCdnUrlHandler").__setRef("IGDSetupBridge"),l=e("MAWBridgeUpdateDYIStatusV2").__setRef("IGDSetupBridge"),m=e("MAWSetupBridgeOfflineConsumer").__setRef("IGDSetupBridge"),n=(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(d("LSInitSyncCompleteSubscription").use).then(function(){return(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton}),o=function(a){j.loadImmediately(function(b){b=b.log;return b(function(){return{armadillo_thread_id:a.armadilloThreadId,domain:a.domain,event:a.event,event_details:a.eventDetails,open_thread_id:a.openThreadId,success:a.success,trace_id:a.traceId}})})},p=new Set(["StartTraceWithTraceId","TraceRecordCheckpoint"]),q=new Set(["ABPropsUpdated","ClockSkewUpdated","DropAllSecureThreads","LargeClockSkewValue","ReceivedChatState","UpdateMediaStatus"]);function a(a){var e=a.dispatch,g=a.logout,i=a.reregisterDevice,j=a.rotateCryptoAuthToken,r=a.worker;function s(){r.postMessage({type:"force-flush-data"})}d("Run").onUnload(s);d("Run").onBeforeUnload(s,!1);return d("MAWCommonSetupBridge").initBridge({customizeEventHandlers:{abPropsUpdated:function(a){d("MAWAbPropsClient").rewrite(a.abProps)},earDecryptionFailure:function(a){d("MAWEncryptionErrorHandler").handleEARDecryptionError(a.tableName)},executeGraphQLLightSpeedRequest:function(a){a=a.args;return c("gkx")("3889")?c("LSPlatformGraphQLLightspeedRequestForIGD").apply(void 0,a):c("LSPlatformGraphQLLightspeedRequest").apply(void 0,a)},getDTSGToken:function(){return(h||(h=b("Promise"))).resolve(d("DTSG").getToken())},getLSDBEphemeralSetting:function(a){return d("MAWGetEphemeralSettings").getEphemeralSetting(a.chatJid)},getLSDBUsersIsMsplit:function(a){return d("MAWFetchContacts").fetchContactsIsMsplit(a.users)},getLSDBUsersRelationships:function(a){return d("MAWFetchContacts").fetchContactsRelationships(a.users)},isDbMigrating:c("MAWSetupBridgeIsDbMigrating")(e),logCutoverEvent:o,logout:g,offlineConsumerProgress:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return(yield m.load())(n,e).apply(void 0,arguments)});function c(){return a.apply(this,arguments)}return c}(),offlineSnapshot:c("MAWSetupBridgeOfflineSnapshot")(e),receivedChatState:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield n);yield c.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield d("MAWBridgeReceivedChatStateHandler").call(b,a)});return function(a){return c.apply(this,arguments)}}(),"readwrite")});function c(b){return a.apply(this,arguments)}return c}(),reregisterDevice:i,resignCdnUrl:function(a){var b=a.deliveryObjectId,c=a.payload;return k.load().then(function(a){return a.call(c,b)})},rotateCryptoAuthToken:j,storageQuota:function(a){a=a.exceededStorageQuota;d("WAExceededStorageQuota").setExceededStorageQuota(a)},uiUpdate:function(a){a=a.events;var e=[],f=a.filter(function(a){if(p.has(a.tag)){e.push(a);return!1}if(q.has(a.tag))return!1});e.length>0&&(b("cr:3411")==null?void 0:b("cr:3411").recordBridgeUIEvent(a),d("MAWBridgeUIEventHandler").handleEvents(n,a));if(f.length===0)return;c("isInstamadillo")()?c("FBLogger")("igd_web_on_msgr").warn("[Instamadillo] Unsupported invocation of UI Event Handler. Please deprecate UI Event Handler: %s",a.map(function(a){return a.tag}).join(", ")):c("FBLogger")("igd_web_on_msgr").warn("[IGD] Deprecating UIEventHandlers, please update LSDB directly for UI changes: %s",a.map(function(a){return a.tag}).join(", "))},updateDYIStatus:function(a){var b=a.qplEvent,d=a.qplInstanceKeyE2E,e=a.status;c("promiseDone")(l.load().then(function(a){return a.call({qplEvent:b,qplInstanceKeyE2E:d,status:e})}))},updateMediaStatus:c("emptyFunction"),uploadMessagesToBackup:function(){return(h||(h=b("Promise"))).reject("should not be called for IGD")},uploadOpenMessages:function(a){var b=a.uploadPayloads;c("promiseDone")(c("JSResourceForInteraction")("IGDMessageUploadMutation").__setRef("IGDSetupBridge").load().then(function(a){return a.uploadOpenMessageOverGQL(b)}))}},worker:r})}g.setupBridge=a}),98);
__d("MessengerWaitForEvent",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c,d){var e,f=d;return new(g||(g=b("Promise")))(function(b){f?e=function(){f.apply(this,arguments)&&b.apply(this,arguments)}:e=b,a==null?void 0:a.addEventListener==null?void 0:a.addEventListener(c,e)})["finally"](function(){a==null?void 0:a.removeEventListener==null?void 0:a.removeEventListener(c,e)})}f.waitForEvent=a}),66);
__d("LocalStorageMutex",["MessengerWaitForEvent","Promise","QPLUserFlow","emptyFunction","err","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=null,j=1e3,k=c("qpl")._(1056847375,"584");a=function(){function a(a){var b=this,d=a.mutexKey,e=a.localTakeoverKey,f=a.log,g=a.logError,h=a.getStorage,i=a.setItemGuarded,k=a.mutexTimeoutMs;k=k===void 0?j:k;a=a.mutexTimeoutCallback;this.mutexFilter=function(a){if(a.key!==b.$1)return!1;a=a.newValue||"";return!a.includes(c("pageID"))};this.$1=d;this.$2=e;this.$5=h;this.$6=i;this.$3=f;this.$4=g;this.$7=k;this.$8=a}var e=a.prototype;e.init=function(){c("QPLUserFlow").start(k);this.$3("APPMUTEX - this tab is "+c("pageID"));var a=this.getMutex();if(a===c("pageID")){this.$3("APPMUTEX - WE ALREADY HAVE THE MUTEX LOCK WITHIN INIT");c("QPLUserFlow").endSuccess(k);return(h||(h=b("Promise"))).resolve(!0)}if(a!=null){this.$3("APPMUTEX - initiating localTAKEOVER");return this.localTakeover()}else{this.$3("APPMUTEX - NO1 ELSE IS ALIVE, GET THE MUTEX");a=this.$9(c("pageID"));var d=this.$10(c("pageID"));if(!a.success||!d.success){c("QPLUserFlow").addAnnotations(k,{bool:{setMutexResult:d.success,setTakeoverResult:a.success},string:{setMutexError:d.error,setTakeoverError:a.error}});c("QPLUserFlow").endFailure(k,"fail_to_set_takeover_or_mutex");return(h||(h=b("Promise"))).resolve(!1)}c("QPLUserFlow").endSuccess(k);return(h||(h=b("Promise"))).resolve(!0)}};e.localTakeover=function(){var a,e=this,f=this.$9(c("pageID"));if(!f.success){c("QPLUserFlow").addAnnotations(k,{string:{initTakeoverError:f.error}});c("QPLUserFlow").endFailure(k,"local_takeover_init_takeover_failure");return(h||(h=b("Promise"))).resolve(!1)}var g,i=function(){g!=null&&clearTimeout(g)};f=d("MessengerWaitForEvent").waitForEvent(window,"storage",this.mutexFilter);var l=(a=this.$7)!=null?a:j;return(h||(h=b("Promise"))).race([f,new h(function(a){g=setTimeout(function(){a()},l)}),this.$8?this.$8():new(h||(h=b("Promise")))(c("emptyFunction"))]).then(function(a){if(a==null){e.$3("AppMutex - Forcefully took the mutex and takeover lock");var b=e.$9(c("pageID")),d=e.$10(c("pageID"));if(!b.success||!d.success){c("QPLUserFlow").addAnnotations(k,{string:{setMutexError:d.error,setTakeoverError:b.error}});c("QPLUserFlow").endFailure(k,"local_takeover_forcefully_takeover_failure");return!1}c("QPLUserFlow").endSuccess(k);return!0}e.$3("APPMUTEX - GOT MUTEX STORAGE EVENT CHANGE FROM ANOTHER TAB");d=e.$11(a.newValue);if(!d&&e.hasTakeoverPermission()){e.$3("APPMUTEX - setting mutex on localtakeover");b=e.$10(c("pageID"));if(!b.success){c("QPLUserFlow").addAnnotations(k,{string:{setMutexError:b.error}});c("QPLUserFlow").endFailure(k,"local_takeover_set_mutex_failure");return!1}c("QPLUserFlow").endSuccess(k);return!0}else{e.hasTakeoverPermission()&&e.$12();c("QPLUserFlow").endFailure(k,"local_takeover_no_takeover_permission");return!1}}).then(function(a){i();return a})["catch"](function(a){i();e.$4("AppMutex - localTakeover error no permission - "+a);c("QPLUserFlow").endFailure(k,"local_takeover_general_failure");return!1})};e.onMutexDeath=function(){var a=this.getMutex();a!=null&&a===c("pageID")&&(this.$3("APPMUTEX - removing mutex on death"),this.$13(),this.hasTakeoverPermission()&&this.$12())};e.takeoverFilter=function(a){if(a.key!==this.$2)return!1;a=a.newValue||"";return!a.includes(c("pageID"))};e.$14=function(){if(!i){var a=this.$5();if(!a)throw c("err")("Could not get localStorage");i=a}return i};e.getMutex=function(){i=this.$14();return i.getItem(this.$1)};e.$10=function(a){i=this.$14();return this.$6(i,this.$1,a)};e.$13=function(){i=this.$14(),i.removeItem(this.$1)};e.getTakeover=function(){i=this.$14();return i.getItem(this.$2)};e.$9=function(a){i=this.$14();return this.$6(i,this.$2,a)};e.$12=function(){i=this.$14(),i.removeItem(this.$2)};e.$11=function(a){return a!=null?a:""};e.hasTakeoverPermission=function(){var a=this.getTakeover();return a!=null&&a===c("pageID")};return a}();g.THIS_TAB=c("pageID");g.LocalStorageMutex=a}),98);
__d("MAWAppMutex",["LocalStorageMutex","MAWLocalStorage","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h="armadillo_msgr_mutex",i="armadillo_msgr_local_takeover",j=null;function a(){j==null&&(j=new(d("LocalStorageMutex").LocalStorageMutex)({getStorage:d("MAWLocalStorage").getStorage,localTakeoverKey:i,log:function(a){d("WALogger").LOG([a])},logError:function(a){d("WALogger").ERROR([a])},mutexKey:h,setItemGuarded:d("MAWLocalStorage").setItemGuarded}));return j}g.MAW_MUTEX_KEY=h;g.MAW_LOCALTAKEOVER_KEY=i;g.use=a}),98);
__d("MAWCommonBackendSetup",["EARInitType","MAWAppMutex","MAWEncryptionIndexedDbV2","MAWInit","MAWInitError","MAWIssueNewUserVisibleErrors","MAWLocalStorage","MAWSetupWorker","MAWVaultMaterialsStorage","MWSetupDBEncryption","Promise","asyncToGeneratorRuntime","requireDeferredForDisplay","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferredForDisplay")("MAWMainThreadLogger").__setRef("MAWCommonBackendSetup");function a(a,b,c,d,e){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j){yield a.measurePerformance("prepare_logger",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=i.load();(yield a).setupMainWaLogger()}));var k=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();k||(yield a.measurePerformance("detection_support",function(){if(!d("MAWLocalStorage").isLocalStorageAvailable())throw new(d("MAWInitError").MAWInitError)("localstorage_not_supported");return(h||(h=b("Promise"))).resolve()}));var l=a.measurePerformance("setup_vault_materials",function(){return d("MAWVaultMaterialsStorage").setupVaultMaterials()}),m=(yield a.measurePerformance("acquire_mutex",function(){try{var a=d("MAWAppMutex").use().init();return k?a.then(function(){return(h||(h=b("Promise"))).resolve(!0)},function(){return(h||(h=b("Promise"))).resolve(!0)}):a}catch(a){if(k)return(h||(h=b("Promise"))).resolve(!0);throw a}})),n=(yield a.measurePerformance("main_ear_setup",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("MWSetupDBEncryption").setPerformanceMeasurementTool(d("MAWInit").MAWInit.measurePerformance);var a=(yield d("MWSetupDBEncryption").init(c("EARInitType").MAW_INIT));d("MAWEncryptionIndexedDbV2").maybeSetEncryptionDbOnVersionChange(function(){var a;(a=d("MAWIssueNewUserVisibleErrors")).issueError(a.MAWLegacyUserErrorMsgBody,a.MAWLegacyUserErrorMsgTitle,a.MAWUserVisibleErrorPresentationType.BANNER)});return a})));if(!n.success){a.logPoint("keychain_setup_failure");throw new(d("MAWInitError").MAWInitError)("keychain_setup_failure",n.payload)}if(!m){a.logPoint("maw_appmutex_no_permission");throw new(d("MAWInitError").MAWInitError)("maw_appmutex_no_permission")}var o=(yield l);yield a.measurePerformance("setup_worker",function(){return d("MAWSetupWorker").getOrSetupWorker(o,e,f,g,j)["catch"](function(a){throw new(d("MAWInitError").MAWInitError)("worker_setup_error",a)})})});return j.apply(this,arguments)}g.setupArmadilloBackend=a}),98);
__d("WADynamicRouterSync",["ExecutionEnvironment","Promise","WALogger","WAMapWithDefault","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not defined for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["No handler for bridge with namespace: "," route: "," called in environment: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge handler: ",""]);l=function(){return a};return a}a=function(){function a(){var a=this;this.$2=new Map();this.$4=new(d("WAMapWithDefault").MapWithDefault)(function(){return new Set()});this.fireAndForget=function(b,c,d,e,f){e===void 0&&(e=!1),a.$3==null?void 0:a.$3(b,c,d),a.$4.get(b).add({route:c,arg:d,resolver:null,silentLog:e,eventCallbacks:f}),a.$5(b,c)};this.sendAndReceive=function(c,d,e,f,g){f===void 0&&(f=!1);return new(i||(i=b("Promise")))(function(b){a.$3==null?void 0:a.$3(c,d,e),a.$4.get(c).add({route:d,arg:e,resolver:function(a){b(a)},silentLog:f,eventCallbacks:g}),a.$5(c,d)})}}var e=a.prototype;e.setAckPayload=function(a){this.$1=a};e.getAckPayoad=function(){return this.$1};e.hasHandlerForNamespace=function(a){return this.$2.has(a)};e.getHandledNamespaces=function(){return Array.from(this.$2.keys())};e.setOnRouteCalled=function(a){this.$3=a};e.setNamespaceHandler=function(a,b){var c=this.$2,d=c.get(a);if(d===b)return;c.set(a,b);d==null&&this.$5(a)};e.$6=function(a,c){var e=a.route,f=a.arg,g=a.resolver,h=a.silentLog;a=a.eventCallbacks;try{c(e,f,g,h,a)}catch(a){g==null?void 0:g((i||(i=b("Promise"))).reject(a)),d("WALogger").ERROR(l(),a)}};e.$5=function(a,b){var e=this,f=this.$4.get(a),g=this.$2.get(a);if(g==null){var i=(h||(h=c("ExecutionEnvironment"))).isInWorker?"worker":"main-thread";d("WALogger").ERROR(k(),a,b,i);return}f.forEach(function(a){e.$6(a,g),f["delete"](a)})};e.setHandlers=function(a,b){function e(e,f,g){if(b[e]==null){d("WALogger").ERROR(j(),e,a);throw c("err")(e+" is not defined for "+a)}e=b[e](f);g&&g(e)}this.setNamespaceHandler(a,e)};return a}();g.DynamicRouterSync=a}),98);
__d("useMWEncryptedBackupsProcessBackupIdsDeferred",["promiseDone","react","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect,j=c("requireDeferred")("MWEncryptedBackupsProcessBackupIdsDEPRECATED").__setRef("useMWEncryptedBackupsProcessBackupIdsDeferred");function a(a){var b=c("useAsyncReStore")();i(function(){var d,e=!1;j.onReadyImmediately(function(f){c("promiseDone")(b,function(b){e||(d=f.subscribeToEncryptedBackupsRow(b,a))})});return function(){e=!0,d==null?void 0:d()}},[b,a])}g["default"]=a}),98);
__d("MAWCommonSetup",["EARInitType","MAWBridgeFireAndForget","MAWCommonBackendSetup","MAWEARKeychainDecryptionError","MAWEncryptedBackupsStateManager","MAWInit","MAWInitError","MAWIsIDBOperational","MAWIssueNewUserVisibleErrors","MAWJobDefinitions","MAWMIC","MAWStateContext.react","MAWUIJob","MAWUnrecoverableDbErrors","MAWWaitForBackendSetup","MWEARKeychainV3","MWSetupDBEncryption","Promise","WABridge","WADynamicRouterSync","WAJobOrchestratorTypes","asyncToGeneratorRuntime","cr:7644","getErrorSafe","gkx","maybeSetupMAWMainThreadLogger","performance","promiseDone","react","requireDeferred","useMWEncryptedBackupsProcessBackupIdsDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=j||d("react");var k=e.useContext,l=e.useEffect,m=c("requireDeferred")("FBLogger").__setRef("MAWCommonSetup"),n=!1,o=function(){return(i||(i=c("performance"))).now()},p=function(a){d("MAWEncryptedBackupsStateManager").setEncryptedBackupsState(a),d("MAWBridgeFireAndForget").fireAndForget("backend","setEncryptedBackupsState",{newState:a})};function a(a){var b=k(d("MAWStateContext.react").MAWStateContext),e=b.dispatch,f=d("MAWIsIDBOperational").useIsIDBOperational();l(function(){f&&c("promiseDone")(t(e,a))},[a,e,f]);c("useMWEncryptedBackupsProcessBackupIdsDeferred")(p)}var q,r=new(h||(h=b("Promise")))(function(a){q=function(c){a(c),c.onmessage=function(a){return s.onmessage==null?void 0:s.onmessage(a)},q=function(a){a.onmessage=function(a){return s.onmessage==null?void 0:s.onmessage(a)},r=(h||(h=b("Promise"))).resolve(a)}}}),s={onmessage:null,postMessage:function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield r);b.postMessage(a)})())}};function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=e.logout,g=e.reregisterDevice,h=e.rotateCryptoAuthToken,i=e.setupBridge;if(n){void m.load().then(function(a){a("messenger_e2ee_web").warn("Armadillo already setup - return")});return}n=!0;d("MAWMIC").startMAWMICFlow();d("MAWInit").MAWInit.start();b("cr:7644")&&(d("maybeSetupMAWMainThreadLogger").maybeSetupMAWMainThreadLogger(),c("promiseDone")(d("MWSetupDBEncryption").init(c("EARInitType").MAW_IN_UI_INIT).then(function(){return b("cr:7644").makeDB(d("MWEARKeychainV3").getDbEncryptionKey,d("MAWWaitForBackendSetup").waitForBackendSetup("ui_dexie"))}),function(){},function(a){return m.load().then(function(b){return b("messenger_e2ee_web").catching(a).mustfix("UI Dexie initialisation failed: %s",a.message)})}));d("WABridge").makeWABridge(new(d("WADynamicRouterSync").DynamicRouterSync)());try{d("MAWIssueNewUserVisibleErrors").deleteAllErrors(),yield d("MAWCommonBackendSetup").setupArmadilloBackend(d("MAWInit").MAWInit,function(b){var d={close:function(){},onmessage:null,postMessage:function(a){return b.postMessage(a)}},e={close:function(){return b.close()},onmessage:null,postMessage:function(a){return b.postMessage(a)}};q==null?void 0:q(d);b.onmessage=function(a){d.onmessage==null?void 0:d.onmessage(a),e.onmessage==null?void 0:e.onmessage(a)};c("promiseDone")(i({dispatch:a,logout:f,reregisterDevice:g,rotateCryptoAuthToken:h,worker:e}))},function(){a({tag:"InitOfflineQueueSyncComplete",value:void 0}),a({tag:"IsDbMigrating",value:!1}),d("MAWMIC").onConnectToExistingWorker()},function(){a({tag:"InitOfflineQueueSyncComplete",value:void 0}),a({tag:"IsDbMigrating",value:!1})},"mawInit"),d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").jobSerializers.handleFutureproofMsg({priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW})),d("MAWInit").MAWInit.addIntAnnotation("endTimePageRelative",o()),d("MAWInit").MAWInit.endSuccess(),d("MAWWaitForBackendSetup").resolveBackendSetup()}catch(a){var j,k=c("getErrorSafe")(a);e=k instanceof d("MAWInitError").MAWInitError?k.message:"maw_init_failure";k.message=(j=k.message)!=null?j:"Unknown";e==="keychain_setup_failure"&&d("MAWUnrecoverableDbErrors").setError(new(d("MAWUnrecoverableDbErrors").EarInitError)(k));j=k.message==="maw_appmutex_no_permission"&&document.visibilityState!=="visible";j?d("MAWInit").MAWInit.cancel(e,k):(d("MAWWaitForBackendSetup").rejectBackendSetup(k),d("MAWInit").MAWInit.fail(e,k));d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER,c("gkx")("218")&&k instanceof d("MAWInitError").MAWInitError&&k.error instanceof c("MAWEARKeychainDecryptionError")?"MAWEARKeychainDecryptionError":k.message);k&&void m.load().then(function(a){a("messenger_e2ee_web").catching(k).mustfix("MAW backend setup failed -- %s",k.message)});throw k}});return u.apply(this,arguments)}g.useArmadillo=a;g.workerProxy=s}),98);
__d("MAWCatQuery.graphql",["cr:11203"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:11203")}),null);
__d("MAWCatQuery",["MAWCatQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("MAWCatQuery.graphql");c=a;g["default"]=c}),98);
__d("MAWCryptoAuthToken",["FBLogger","MAWCatQuery","RelayHooks"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null||a.secure_message_over_wa_cat_query==null||a.secure_message_over_wa_cat_query.encrypted_serialized_cat==null||a.secure_message_over_wa_cat_query.expiration_time_in_seconds==null?{error:"Crypto Auth Token was null or incomplete"}:{success:{encrypted_serialized_cat:a.secure_message_over_wa_cat_query.encrypted_serialized_cat,expiration_time_in_seconds:a.secure_message_over_wa_cat_query.expiration_time_in_seconds}}}function a(a){return d("RelayHooks").fetchQuery(a,c("MAWCatQuery"),{}).toPromise().then(h).then(function(a){if(a.error!==null&&a.error!==void 0)throw c("FBLogger")("maw_device_reg").mustfixThrow("[MAWCryptoAuthToken] Error while fetching CAT from GraphQL: %s",a.error);return a.success})}g.fetchFreshCAT=a}),98);
__d("MAWOccamadilloOnMutexChange",["I64","LSDefaultSyncGroups","LSIntEnum","LSSyncGroupsUtils","Promise","WALogger","isOccamadilloResumeSyncEnabled","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Resetting sync cursor and network request"]);k=function(){return a};return a}function l(a){var e=d("LSDefaultSyncGroups").e2eeMetadataSyncGroup;if(!c("isOccamadilloResumeSyncEnabled")()&&e!=null)return a.sync_groups.put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultSyncGroup,{groupId:(j||(j=d("LSIntEnum"))).ofNumber(e.groupId)}));else return(h||(h=b("Promise"))).resolve()}function m(a){if(!c("isOccamadilloResumeSyncEnabled")())return a.network_requests.put({epochId:void 0,failureCount:(i||(i=d("I64"))).zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:i.zero,lastSyncRequestTimestampMs:i.zero,networkTaskIdentifier:void 0,syncDatabaseId:(j||(j=d("LSIntEnum"))).ofNumber(95),taskQueueName:""});else return(h||(h=b("Promise"))).resolve()}function a(a){d("WALogger").LOG(k()),c("promiseDone")(a.runInTransaction(function(a){return(h||(h=b("Promise"))).all([l(a),m(a)])},"readwrite",void 0,void 0,f.id+":58"))}g.onOccamadilloMutexChange=a}),98);
__d("MAWReinit",["ExecutionEnvironment","MAWCurrentUser","MAWEBSwitch","QPLUserFlow","QuickPerformanceLogger","WAGetStorageQplAnnotations","asyncToGeneratorRuntime","gkx","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("qpl")._(25310984,"169");function a(a){var e=a!=null?{instanceKey:a}:void 0,f=!1,g=!1;function k(){if(g)return;g=!0;c("QPLUserFlow").start(j,babelHelpers["extends"]({cancelOnUnload:!0,onFlowTimeout:function(){f=!0},timeoutInMs:(h||(h=c("ExecutionEnvironment"))).canUseDOM?6e4:0},e));void d("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(j,a)});s()}function l(a){if(!g||f)return;s();c("QPLUserFlow").addPoint(j,a,e)}function m(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(j,{bool:(d={},d[a]=b,d)})}function n(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(j,{string:(d={},d[a]=b,d)})}function o(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(j,{"int":(d={},d[a]=b,d)})}function p(a){s(),f=!0,c("QPLUserFlow").addAnnotations(j,{string:{failReason:a}},e),c("QPLUserFlow").endFailure(j,"maw_init_fail",e),r=!1}function q(a){s(),f=!0,r=!1,c("QPLUserFlow").addAnnotations(j,{string:{dropReason:a}},e),(i||(i=c("QuickPerformanceLogger"))).markerDrop(j)}var r=!1;function s(){if(r)return;r=!0;c("QPLUserFlow").addAnnotations(j,{bool:{armadillo_init_sync_api_improvements:c("gkx")("24025"),is_eb_enabled:c("MAWEBSwitch").isEnabled(),isArmadilloPublicLaunchUser:c("gkx")("23405"),isTlcPublicUser:d("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()}})}function t(a){s(),f=!0,c("QPLUserFlow").addAnnotations(j,{string:{cancelReason:a}},e),c("QPLUserFlow").endCancel(j,e),r=!1}function u(){s(),f=!0,c("QPLUserFlow").endSuccess(j,e),r=!1}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a+"_start";a=a+"_end";l(c);c=(yield b());l(a);return c});return w.apply(this,arguments)}return{addBoolAnnotation:m,addIntAnnotation:o,addStringAnnotation:n,cancel:t,drop:q,endSuccess:u,fail:p,logPoint:l,measurePerformance:v,start:k}}g.getMAWReinit=a}),98);
__d("MAWReinitWorker",["MAWCommonBackendSetup","MAWOccamadilloOnMutexChange","MAWReinit","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.allTablesPersisted,e=a.db,f=a.dispatch,g=a.dispatchClearEphemeralSettings,h=a.instanceKey,i=a.logout,j=a.reregisterDevice,k=a.rotateCryptoAuthToken,l=a.setupBridge;a=a.workerCreateReason;h=d("MAWReinit").getMAWReinit(h);h.start();var m=function(){f({tag:"InitOfflineQueueSyncComplete",value:void 0}),f({tag:"IsDbMigrating",value:!1})};yield d("MAWCommonBackendSetup").setupArmadilloBackend(h,function(a){c("promiseDone")(l({dispatch:f,logout:i,reregisterDevice:j,rotateCryptoAuthToken:k,worker:a}).then(function(){b||d("MAWOccamadilloOnMutexChange").onOccamadilloMutexChange(e)}))},m,m,a);h.endSuccess();g()});return h.apply(this,arguments)}g["default"]=a}),98);
__d("MAWSetupMutex",["FBLogger","LocalStorageMutex","MAWAppMutex","MAWBridge","MAWInit","MAWIssueNewUserVisibleErrors","MAWLocalStorage","MAWMIC","MAWReinitWorker","MAWSetupWorker","MAWStateContext.react","MAWWaitForBackendSetup","MAWWebWorkerInstance","QPLUserFlow","Run","WALoggerDeferred","asyncToGeneratorRuntime","isInstamadillo","qpl","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, worker already exists"]);j=function(){return a};return a}e=i||d("react");var k=e.useCallback,l=e.useEffect,m=e.useMemo,n=c("FBLogger")("messenger_e2ee_web"),o=!1,p=0;function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(document.visibilityState!=="visible")return!1;a=a();var b=window.indexedDB!=null,c=d("MAWLocalStorage").isLocalStorageAvailable();if(a){void d("WALoggerDeferred").DEV(j());return!1}return!b||!c?!1:!0});return r.apply(this,arguments)}function a(a,e){var f=a.logout,g=a.reregisterDevice,i=a.rotateCryptoAuthToken,j=a.setupBridge,r=m(function(){return d("MAWAppMutex").use()},[]),s=(h||(h=c("useReStore")))(),t=d("MAWStateContext.react").useDispatchClearEphemeralSettings(),u=s.persistenceTypes.includes("indexeddb"),v=k(function(a){var b=r.takeoverFilter(a);if(!b||a.newValue===d("LocalStorageMutex").THIS_TAB||a.newValue==="")return;!u&&!c("isInstamadillo")()&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"DropAllSecureThreads",value:void 0}]});d("MAWSetupWorker").terminateDedicatedWorker("MAWSetupMutexV2:handleStoreChange");d("MAWWaitForBackendSetup").resetBackendSetup();d("MAWMIC").cancel("workerMutexLost");d("MAWInit").MAWInit.cancel("workerMutexLost");r.onMutexDeath()},[r,u]),w=k(function(){d("MAWSetupWorker").terminateDedicatedWorker("MAWSetupMutexV2:handleUnload"),r.onMutexDeath()},[r]),x=k(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield q(d("MAWWebWorkerInstance").doesWorkerExist));if(!a||o)return;o=!0;p++;try{yield c("MAWReinitWorker")({allTablesPersisted:u,db:s,dispatch:e,dispatchClearEphemeralSettings:t,instanceKey:p,logout:f,reregisterDevice:g,rotateCryptoAuthToken:i,setupBridge:j,workerCreateReason:"mawReinitSetupMutex"}),d("MAWWaitForBackendSetup").resolveBackendSetup(),d("MAWIssueNewUserVisibleErrors").deleteUserVisibleErrorByJSErrorMessage("maw_appmutex_no_permission")}catch(a){n.mustfix("AppMutex - failed to reinitialize worker: "+a.message.concat(" (",a.error,")")),n.catching(a),c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"failed_to_reinitialize_worker",{annotations:{string:{error:a.message.concat(": ",a.error)}},error:a,instanceKey:p})}finally{o=!1}}),[u,s,e,t,f,g,i,j]);l(function(){window.addEventListener("storage",v);var a=d("Run").onBeforeUnload(w,!1),b=d("Run").onUnload(w);window.addEventListener("visibilitychange",x);return function(){window.removeEventListener("storage",v),a.remove(),b.remove(),window.removeEventListener("visibilitychange",x)}},[v,w,x])}g.useMutex=a}),98);
__d("MAWSetupMutex.react",["MAWSetupMutex"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.dispatch;a.environment;a.fbId;a=a.platformSetupUtils;d("MAWSetupMutex").useMutex(a,b);return null}g["default"]=a}),98);
__d("LSGetThreadDataFromTam.nop",["I64","LSMessagingThreadTypeUtil","LSResult","LSShape","LSVec","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.threads).filter(function(a){a=a.threadType;return d("LSMessagingThreadTypeUtil").isArmadilloSecure(a)}).take((h||(h=d("I64"))).to_int32(e))));a=b.map(function(a,b){var c=a.lastActivityTimestampMs,e=a.lastReadWatermarkTimestampMs,f=a.threadKey;a=a.threadType;return d("LSShape").ofRecord({client_thread_pk:f,display_timestamp_ms:c,is_group_thread:d("LSMessagingThreadTypeUtil").isGroup(a),last_activity_timestamp_ms:c,last_read_watermark_timestamp_ms:e,server_thread_key:f,sort_order:(h||(h=d("I64"))).of_int32(b)})});return c("LSResult")(c("LSVec").ofArray(a))});function e(b,c,d){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("LSScheduleOccamThreadsIntegrityChecker",["LSGetCursor","LSGetThreadDataFromTam.nop","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,95])).then(function(a){return a=a,d[0]=a[0],a})},function(b){return d[1]=c.createArray(),d[2]=c.createArray(),c.i64.neq(a[1],void 0)?d[3]=a[1]:d[3]=c.i64.cast([0,20]),c.forEach(c.db.table(220).fetch([[[c.i64.cast([0,95]),c.i64.cast([0,0])]]]),function(a){a=a.item;return d[10]=a.minLastActivityTimestampMs,d[9]=new c.Map(),d[9].set("has_more_before",a.hasMoreBefore),d[9].set("is_loading_before",a.isLoadingBefore),d[9].set("min_last_activity_timestamp_ms",d[10]),d[9].set("min_thread_key",a.minThreadKey),d[9].set("parent_thread_key",c.i64.cast([0,0])),d[11]=(d[2].push(d[9]),d[2]),c.forEach(c.islc(c.filter(c.db.table(9).fetch([[[{gte:d[10]}]],"lastActivityTimestampMs"]),function(a){return c.i64.ge(a.lastActivityTimestampMs,d[10])&&c.i64.eq(a.syncGroup,c.i64.cast([0,95]))&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(d[3])),function(a){a=a.item;return d[11]=new c.Map(),d[11].set("authority_level",a.authorityLevel),d[11].set("folder_name",a.folderName),d[11].set("last_activity_timestamp_ms",a.lastActivityTimestampMs),d[11].set("last_read_watermark_timestamp_ms",a.lastReadWatermarkTimestampMs),d[11].set("thread_key",a.threadKey),d[12]=(d[1].push(d[11]),d[1])})})},function(a){return d[4]=c.createArray(),c.nativeOperation(b("LSGetThreadDataFromTam.nop"),d[3]).then(function(a){return a=a,d[5]=a[0],a})},function(a){return d[6]=c.createArray(),d[7]=new c.Map(),d[7].set("cursor",d[0]),d[7].set("mi_act_mapping_columns_for_integrity_check",d[6]),d[7].set("occam_threads_columns_for_integrity_check",d[1]),d[7].set("threads_ranges_columns_for_integrity_check",d[2]),d[7].set("tam_threads_columns_for_integrity_check",d[5]),d[8]=c.toJSON(d[7]),c.storedProcedure(b("LSIssueNewTask"),"occam-threads-integrity-check",c.i64.cast([0,701]),d[8],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxScheduleOccamThreadsIntegrityCheckerStoredProcedure";e.exports=a}),null);
__d("LSScheduleOccamThreadsIntegrityCheckerStoredProcedure",["LSScheduleOccamThreadsIntegrityChecker","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){b===void 0&&(b={});var d=[];d[0]=b.delayMs;d[1]=b.maxThreadCount;return c("LSScheduleOccamThreadsIntegrityChecker").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWChatFetchThreadMessageCounts",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";function a(a){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{}});return g.apply(this,arguments)}function c(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return 0});return h.apply(this,arguments)}f.fetchArmadilloThreadMessageCounts=a;f.fetchArmadilloThreadMessageCount=c}),66);
__d("globalCryptoSubtle",[],(function(a,b,c,d,e,f){"use strict";b=a.crypto.subtle;c=b;f["default"]=c}),66);
__d("useDataLossStatisticsStorageListener",["LSDatabaseSingleton","MWChatFetchThreadMessageCounts","Visibility","WebStorage","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(i||d("react")).useEffect,l="armadillo_msgr_data_loss_stats";function a(){k(function(){var a;window.setTimeout(function(){a=c("Visibility").addListener(c("Visibility").HIDDEN,function(){c("promiseDone")((j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){return d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){(h||(h=c("WebStorage"))).setItemGuarded(h.getLocalStorage(),l,JSON.stringify(a))})}))})},3e4);return function(){var b;(b=a)==null?void 0:b.remove()}},[])}g.DATA_LOSS_STATISTICS_STORAGE_KEY=l;g.useDataLossStatisticsStorageListener=a}),98);
__d("MWChatDataLossCheckerUtil",["FBLogger","I64","MWChatFetchThreadMessageCounts","Promise","QuickPerformanceLogger","WebStorage","asyncToGeneratorRuntime","gkx","globalCryptoSubtle","promiseDone","qpl","useDataLossStatisticsStorageListener"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(a){a=Array.from(new Uint8Array(a));return a.map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(c("gkx")("24059"))return a;var b=new TextEncoder();b=b.encode(a).buffer;a=(yield c("globalCryptoSubtle").digest("SHA-256",b));return l(a)}catch(a){return a}});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.currentIDBCnt,d=a.currentMsgCnt,e=a.logThreadId,f=a.prevMsgCnt,g=a.qplEvent;a=a.threadId;if(e!=null&&e){e=(yield m(a));b!=null?((j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),j.markerAnnotate(g,{"int":{current_idb_count:b,current_msg_count:d,prev_msg_count:f},string:{encrypted_threadId:e}}),j.markerEnd(g,2)):((j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),j.markerAnnotate(g,{"int":{current_msg_count:d,prev_msg_count:f},string:{encrypted_threadId:e}}),j.markerEnd(g,2))}else b!=null?((j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),j.markerAnnotate(g,{"int":{current_idb_count:b,current_msg_count:d,prev_msg_count:f}}),j.markerEnd(g,2)):((j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),j.markerAnnotate(g,{"int":{current_msg_count:d,prev_msg_count:f}}),j.markerEnd(g,2))});return p.apply(this,arguments)}function q(a){var b=a.currentMsgCnt,c=a.logThreadId,d=a.prevMsgCnt,e=a.qplEvent;a=a.threadId;return o({currentMsgCnt:b,logThreadId:c,prevMsgCnt:d,qplEvent:e,threadId:a})}function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCount(a,b));var e=(k||(k=c("WebStorage"))).getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return{isThreadMissingMessages:!1};e=JSON.parse(e);b=(e=e[(i||(i=d("I64"))).to_string(b)])!=null?e:null;if(b==null)return{isThreadMissingMessages:!1};return b>0&&a===0?{currCount:a,isThreadMissingMessages:!0,prevCount:b}:{isThreadMissingMessages:!1}}catch(a){c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss");return{isThreadMissingMessages:!1}}});return r.apply(this,arguments)}function e(a){a=d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a);a.then(function(a){var e=(k||(k=c("WebStorage"))).getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return(h||(h=b("Promise"))).resolve(null);e=JSON.parse(e);return(h||(h=b("Promise"))).resolve({current:a,previous:e})}).then(function(a){if(a==null)return(h||(h=b("Promise"))).resolve();var c=a.current;a=a.previous;return s(a,c)})["catch"](function(a){return c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss")});return a.then(function(){})}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d){var e=[];for(var f in a)Object.prototype.hasOwnProperty.call(d,f)&&e.push(f);f=[];for(var g=0;g<e.length;g++){var i=e[g],j={currentMsgCnt:d[i],prevMsgCnt:a[i],threadId:i};a[i]>0&&d[i]===0?(f.push(q(babelHelpers["extends"]({},j,{qplEvent:c("qpl")._(717553665,"1183")}))),f.push(q(babelHelpers["extends"]({},j,{logThreadId:!0,qplEvent:c("qpl")._(717562243,"1358")})))):(f.push(q(babelHelpers["extends"]({},j,{qplEvent:c("qpl")._(717553666,"1184")}))),f.push(q(babelHelpers["extends"]({},j,{logThreadId:!0,qplEvent:c("qpl")._(717556541,"1361")}))))}yield (h||(h=b("Promise"))).all(f)});return t.apply(this,arguments)}function f(a){var b=function(b){c("promiseDone")(m(b).then(function(d){(j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(c("qpl")._(717567419,"1383")),j.markerAnnotate(c("qpl")._(717567419,"1383"),{string:{encryptedThreadId:d,msg_count:a[b].toString()}}),j.markerEnd(c("qpl")._(717567419,"1383"),2)}))};for(var d in a)b(d)}g.qplLog=q;g.checkIsThreadMissingMessages=a;g.fetchCountsAndLogDataLoss=e;g.logThreadCompleteDataLoss=s;g.logLocalStatistics=f}),98);
__d("useOnMawSetupComplete.react",["emptyFunction","promiseDone","react","waitForMAWMIC"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a,b,e){b===void 0&&(b=c("emptyFunction")),i(function(){var e=!1;c("promiseDone")(d("waitForMAWMIC").promise.then(function(){if(e)return;a()})["catch"](function(){if(e)return;b()}));return function(){e=!0}},e)}g.useOnMawSetupComplete=a}),98);
__d("useDataLossChecker",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSScheduleOccamThreadsIntegrityCheckerStoredProcedure","MWChatDataLossCheckerUtil","asyncToGeneratorRuntime","gkx","justknobx","promiseDone","useDataLossStatisticsStorageListener","useOnMawSetupComplete.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(){d("useDataLossStatisticsStorageListener").useDataLossStatisticsStorageListener(),d("useOnMawSetupComplete.react").useOnMawSetupComplete(function(){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);yield d("MWChatDataLossCheckerUtil").fetchCountsAndLogDataLoss(a)})()),j()},j(),[])}function j(){try{var a=c("gkx")("24061"),e=c("justknobx")._("1683");a&&e&&c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return a.runInTransaction(function(a){return c("LSScheduleOccamThreadsIntegrityCheckerStoredProcedure")(c("LSFactory")(a),{delayMs:(i||(i=d("I64"))).of_int32(6e4),maxThreadCount:i.of_int32(20)})},"readonly",void 0,void 0,f.id+":61")})())}catch(a){c("FBLogger")("labyrinth_web").warn("Error running thread integrity checker",a)}}g["default"]=a}),98);
__d("useLegacyUserWatchdog",["MAWIssueNewUserVisibleErrors","clearTimeout","react","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;b=24*60*60*1e3;var j=5*b;function a(){i(function(){var a=c("setTimeout")(function(){var a;(a=d("MAWIssueNewUserVisibleErrors")).issueError(a.MAWLegacyUserErrorMsgBody,a.MAWLegacyUserErrorMsgTitle,a.MAWUserVisibleErrorPresentationType.BANNER)},j);return function(){return c("clearTimeout")(a)}})}g["default"]=a}),98);
__d("useMAWReregisterDeviceOnError",["LSPersistedDbGating","MAWIssueNewUserVisibleErrors","MAWLoggerUtils","MAWReinitWorker","MAWSetupWorker","MAWStateContext.react","MAWWaitForBackendSetup","ODS","WABridgedAPI","WATagsLogger","asyncToGeneratorRuntime","react","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to reinit worker ",""]);j=function(){return a};return a}e=h||d("react");var k=e.useCallback,l=e.useContext,m=!1,n=typeof window!=="undefined"?window:self;function o(){m=!0,d("MAWSetupWorker").terminateWorkerPermanently(),(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_forced_reregister_fail",n.location.hostname),d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)}function a(a){var e=a.rotateCryptoAuthToken,f=a.setupBridge,g=c("useAsyncReStore")(),h=d("MAWStateContext.react").useDispatchClearEphemeralSettings();a=l(d("MAWStateContext.react").MAWStateContext);var p=a.dispatch;return k(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(m)return;(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_forced_deregister",n.location.hostname);yield c("WABridgedAPI").removeCurrentDevice();yield d("MAWSetupWorker").terminateWorker("useMAWReregisterDeviceOnError");d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").resetBackendSetup()});try{var a=(yield g);yield c("MAWReinitWorker")({allTablesPersisted:d("LSPersistedDbGating").allTablesPersisted,db:a,dispatch:p,dispatchClearEphemeralSettings:h,logout:o,reregisterDevice:o,rotateCryptoAuthToken:e,setupBridge:f,workerCreateReason:"mawReinitReregDevice"});d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").resolveBackendSetup()})}catch(b){d("MAWWaitForBackendSetup").withKnobs(function(){return d("MAWWaitForBackendSetup").rejectBackendSetup(b)});a=b.description||b.message||b;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration,d("MAWLoggerUtils").Tag.LogoutHandler,d("MAWLoggerUtils").Tag.WorkerSetup,d("MAWLoggerUtils").Tag.MAWWorker,d("MAWLoggerUtils").Tag.MAWInit]).ERROR(j(),a);d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)}}),[g,p,h,e,f])}g["default"]=a}),98);
__d("useStorageUsageMetricsLogger",["cr:3504","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(){i(function(){void (b("cr:3504")==null?void 0:b("cr:3504").logMAWDBUsageMetrics())},[])}g["default"]=a}),98);
__d("MAWSetupImpl.react",["BaseHeadingContext","CometRelay","MAWCommonSetup","MAWCryptoAuthToken","MAWSetupMutex.react","MAWStateContext.react","cr:6159","cr:6160","cr:8800","promiseDone","react","shouldUseMAWSharedWorker","useDataLossChecker","useLegacyUserWatchdog","useMAWReregisterDeviceOnError","useStorageUsageMetricsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useCallback,k=e.useContext,l=e.useMemo;window.XPlatTesting=b("cr:6159");window.XPlatTestingGroups=b("cr:6160");window.XPlatMockServer=b("cr:8800");function a(a){var b=a.children,e=a.fbid,f=a.logout,g=a.setupBridge;a=k(d("MAWStateContext.react").MAWStateContext);a=a.dispatch;var h=d("CometRelay").useRelayEnvironment(),m=j(function(){return d("MAWCryptoAuthToken").fetchFreshCAT(h)},[h]),n=c("useMAWReregisterDeviceOnError")({rotateCryptoAuthToken:m,setupBridge:g}),o=l(function(){return{logout:f!=null?f:function(){return c("promiseDone")(n())},reregisterDevice:function(){return c("promiseDone")(n())},rotateCryptoAuthToken:m,setupBridge:g}},[m,f,n,g]);d("MAWCommonSetup").useArmadillo(o);c("useLegacyUserWatchdog")();c("useDataLossChecker")();c("useStorageUsageMetricsLogger")();var p=k(c("BaseHeadingContext")),q=!d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();return i.jsxs(c("BaseHeadingContext").Provider,{value:p+1,children:[b,q?i.jsx(c("MAWSetupMutex.react"),{dispatch:a,environment:h,fbId:e,platformSetupUtils:o}):null]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWBridgeInitOfflineQueueSyncStartHandler",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MessengerLogHistory").__setRef("MAWBridgeInitOfflineQueueSyncStartHandler");function a(){h.onReady(function(a){a=a.getInstance("maw_setup");a.debug("Init Offline Queue Sync Start")})}g.call=a}),98);
__d("MAWMediaDownloadStatusReducersUtils",["FBLogger","MAWGetIsMediaDownloadStatusEnabled","MAWMediaDownloadStatus","justknobx","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(!c("justknobx")._("3004")||!d("MAWGetIsMediaDownloadStatusEnabled").getIsMediaDownloadStatusEnabled())return a;b=b.filter(function(a){a.plaintextHash==null&&c("FBLogger")("messenger_web_media").mustfix("[NewMedia] No valid media plaintextHash found in reducer %s",a.mediaId);return a.plaintextHash!=null}).map(function(a){return{key:c("nullthrows")(a.plaintextHash).toString(),mediaDownloadStatusState:{mainMediaStatus:a.hasMedia?c("MAWMediaDownloadStatus").SUCCESS:c("MAWMediaDownloadStatus").MISSING_FILE,mainMediaStatusDetails:"initial_media_download",previewMediaStatus:void 0,previewMediaStatusDetails:null}}}).filter(function(b){b=b!=null&&b.key!=null&&(a.mediaDownloadStatus[b.key]==null||a.mediaDownloadStatus[b.key].mainMediaStatus===c("MAWMediaDownloadStatus").MISSING_FILE);return b});return b.length===0?a:babelHelpers["extends"]({},a,{mediaDownloadStatus:babelHelpers["extends"]({},a.mediaDownloadStatus,b.reduce(function(a,b){var c=b.key;b=b.mediaDownloadStatusState;c=c.toString();return babelHelpers["extends"]({},a,(a={},a[c]=b,a))},{}))})}g.handleNewMedias=a}),98);
__d("MAWStateContextProvider.react",["MAWBridgeInitOfflineQueueSyncCompleteHandler","MAWBridgeInitOfflineQueueSyncStartHandler","MAWMediaDownloadStatus","MAWMediaDownloadStatusReducersUtils","MAWSharedProtocolQueueConst","MAWStateContext.react","gkx","react","useUnsafeRef_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useEffect,m=b.useMemo,n=b.useReducer,o=b.useTransition,p=function(a,b){return Object.entries(a).filter(function(a){var c,d=a[0];a=a[1];return((c=b[d])==null?void 0:c.chatStatus)!==a.chatStatus||((c=b[d])==null?void 0:c.snippetStatus)!==a.snippetStatus})},q=function(a,b){return a.reduce(function(a,b){var c=b[0];b=b[1];a[c]={chatStatus:b.chatStatus,snippetStatus:b.snippetStatus};return a},b)},r=function(a,b){switch(b.tag){case"OptimisticSendMessage":var e;return babelHelpers["extends"]({},a,{messageLatencies:babelHelpers["extends"]({},a.messageLatencies,(e={},e[b.optimisticMsgId]={sent:b.timestamp},e))});case"NewMsg":case"MsgUpdated":var f,g;e=b.value.ack;var h=b.value.msgId;f=(f=b.value.offlineMsg)==null?void 0:f.msgId;f!=null&&a.messageLatencies[f]!=null&&(a.messageLatencies[h]=a.messageLatencies[f],delete a.messageLatencies[f]);f=a.messageLatencies[h];if((f==null?void 0:f.sent)!=null&&(f==null?void 0:f.acked)!=null)return a;f=(f==null?void 0:f.sent)||Date.now();e=e!==0?Date.now():void 0;return babelHelpers["extends"]({},a,{messageLatencies:babelHelpers["extends"]({},a.messageLatencies,(g={},g[h]={acked:e,sent:f},g))});case"InitOfflineQueueSyncProgress":h=b.value;return babelHelpers["extends"]({},a,{offlineQueueProgressDownloaded:h});case"InitOfflineQueueConsumerSyncProgress":e=b.value;f=e.chatJidStatus;g=e.processed;h=a.offlineQueueThreadStatus||{};e=p(f,h);return babelHelpers["extends"]({},a,{offlineQueueProgressProcessed:g,offlineQueueThreadStatus:e.length===0?h:q(e,babelHelpers["extends"]({},h))});case"InitOfflineQueueSyncStart":d("MAWBridgeInitOfflineQueueSyncStartHandler").call();f=b.value;return babelHelpers["extends"]({},a,{offlineQueueCount:f});case"InitOfflineQueueSyncComplete":d("MAWBridgeInitOfflineQueueSyncCompleteHandler").call();g=b.value;e=a.offlineQueueThreadStatus||{};h=g!=null?p(g,e):null;return babelHelpers["extends"]({},a,{offlineQueueSyncState:d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete,offlineQueueThreadStatus:h==null||h.length===0?e:q(h,babelHelpers["extends"]({},e))});case"IsDbMigrating":return babelHelpers["extends"]({},a,{isDbMigrating:b.value});case"UnArchivedSelfDeviceChangeAlerts":f=b.value;return babelHelpers["extends"]({},a,{unArchivedSelfDeviceChangeAlerts:f});case"EphemeralSettingsUpdatedForUI":g=b.value;h=g.chatJid;e=g.ephemeralSettingArgs;f=e.ephemeralExpirationInSec;g=e.ephemeralLastUpdatedOrSetTimestamp;e=h;return babelHelpers["extends"]({},a,{ephemeralSettings:babelHelpers["extends"]({},a.ephemeralSettings,(h={},h[e]={ephemeralExpirationInSec:f,ephemeralLastUpdatedOrSetTimestamp:g},h))});case"ClearEphemeralSettings":return babelHelpers["extends"]({},a,{ephemeralSettings:{}});case"UpdateMediaStatus":var i,j,k,l,m;e=b.value;f=e.details;g=e.key;h=e.status;var n=e.type;e=e.validationResult;g=g.toString();i=(i=a.mediaDownloadStatus[g])==null?void 0:i.mainMediaStatus;j=(j=a.mediaDownloadStatus[g])==null?void 0:j.mainMediaStatusDetails;k=(k=a.mediaDownloadStatus[g])==null?void 0:k.previewMediaStatus;l=(l=a.mediaDownloadStatus[g])==null?void 0:l.previewMediaStatusDetails;m=(m=a.mediaDownloadStatus[g])==null?void 0:m.validationResult;var o=n==="main"?i===c("MAWMediaDownloadStatus").SUCCESS:k===c("MAWMediaDownloadStatus").SUCCESS;return h===c("MAWMediaDownloadStatus").DOWNLOADING&&o?a:babelHelpers["extends"]({},a,{mediaDownloadStatus:babelHelpers["extends"]({},a.mediaDownloadStatus,(o={},o[g]={mainMediaStatus:n==="main"?h:i,mainMediaStatusDetails:n==="main"?f:j,previewMediaStatus:n==="preview"?h:k,previewMediaStatusDetails:n==="preview"?f:l,validationResult:(g=e)!=null?g:m},o))});case"SetMediaDownloadStatusState":i=b.value;j=i.key;h=i.newMediaDownloadState;k=j.toString();return(h==null?void 0:h.mainMediaStatus)===c("MAWMediaDownloadStatus").MISSING_FILE&&((n=a.mediaDownloadStatus[k])==null?void 0:n.mainMediaStatus)!=null?a:babelHelpers["extends"]({},a,{mediaDownloadStatus:babelHelpers["extends"]({},a.mediaDownloadStatus,(f={},f[k]=h,f))});case"IncreaseMediaDownloadRetryCount":l=b.value.key;e=l.toString();return babelHelpers["extends"]({},a,{mediaDownloadRetryCount:babelHelpers["extends"]({},a.mediaDownloadRetryCount,(g={},g[e]=((m=a.mediaDownloadRetryCount[e])!=null?m:0)+1,g))});case"NewMedia":return d("MAWMediaDownloadStatusReducersUtils").handleNewMedias(a,[b.value]);case"NewMedias":return d("MAWMediaDownloadStatusReducersUtils").handleNewMedias(a,b.value)}return a};function a(a){a=a.children;var b=n(r,d("MAWStateContext.react").initialState),e=b[0],f=b[1];b=o();b[0];var g=b[1],h=k(function(){for(var a=arguments.length,b=new Array(a),d=0;d<a;d++)b[d]=arguments[d];c("gkx")("5541")?g(function(){return f.apply(void 0,b)}):f.apply(void 0,b)},[g,f]),i=m(function(){return new Set()},[]);b=m(function(){return{dispatch:h,state:e,subscriptions:i}},[e,h,i]);var p=s(b),q=k(function(){return p.current},[p]);l(function(){i==null?void 0:i.forEach(function(a){return a(e)})},[e,i]);return j.jsx(d("MAWStateContext.react").MAWStateContext.Provider,{value:b,children:j.jsx(d("MAWStateContext.react").MAWNonRerenderingStateContext.Provider,{value:q,children:a})})}a.displayName=a.name+" [from "+f.id+"]";function s(a){var b=(h||(h=c("useUnsafeRef_DEPRECATED")))(a);b.current=a;return b}g["default"]=a}),98);
__d("IGDAWSetup.react",["CometRelayEnvironmentProvider","FBLogger","IGDSetIGE2EEEligibility","IGDSetupBridge","MAWCurrentUser","MAWSetupImpl.react","MAWStateContextProvider.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.c;function a(a){var b=j(4);a=a.children;var e=k;d("IGDSetIGE2EEEligibility").useUpsertSetIGE2EEEligibilityOnMount();var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f="xjp7ctv",b[0]=f):f=b[0];var g;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(g=d("MAWCurrentUser").getID(),b[1]=g):g=b[1];b[2]!==a?(f=i.jsx("div",{className:f,"data-testid":void 0,children:i.jsx(c("CometRelayEnvironmentProvider"),{children:i.jsx(c("MAWStateContextProvider.react"),{children:i.jsx(c("MAWSetupImpl.react"),{fbid:g,logout:e,setupBridge:d("IGDSetupBridge").setupBridge,children:a})})})}),b[2]=a,b[3]=f):f=b[3];return f}function k(){}g["default"]=a}),98);
__d("IGDBundleResource",["cr:3823"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:3823")}),98);
__d("LSPlatformSyncSystemDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LSPlatformSyncSystem").__setRef("LSPlatformSyncSystemDeferred");function a(){return h.load()}g["default"]=a}),98);
__d("MAWCatQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="23999698219677129"}),null);
__d("MAWCatQuery.instagram.graphql",["MAWCatQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SecureMessageOverWACATGraphResult",kind:"LinkedField",name:"secure_message_over_wa_cat_query",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_serialized_cat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_seconds",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWCatQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWCatQuery",selections:a},params:{id:b("MAWCatQuery_instagramRelayOperation"),metadata:{},name:"MAWCatQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("ServerJsRuntimeEnvironment",["invariant"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function a(a,b){i==null||h(0,71696),i={platform:a,executionContext:b}}function b(){return i!=null}function c(){var a;return(a=i)==null?void 0:a.executionContext}function d(){var a;return(a=i)==null?void 0:a.platform}g.init=a;g.isRunningServerJsRuntime=b;g.getExecutionContext=c;g.getPlatform=d}),98);
__d("MAWMainThreadLogger",["CurrentMessengerUser","FBLogger","MAWAppVersion","MAWConsoleLogger","MAWDeleteOldLogsFromDisk","MAWLeakDetection","MAWLoggingSwitches","MAWSaveLogToDisk","Promise","ServerJsRuntimeEnvironment","WADevToolsBridge","WAJids","WATagsLogger","asyncToGeneratorRuntime","err","getErrorSafe","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=!1;function a(){i=!1}function e(){i||(i=!0,d("WATagsLogger").initializeWaLogger(u))}var j=function(){return c("FBLogger")("messenger_e2ee_web")};function k(a,b){return b.length>0?d("MAWSaveLogToDisk").joinTags(b)+" "+a:a}function l(a,b,e){if(d("ServerJsRuntimeEnvironment").isRunningServerJsRuntime())return;var f=Date.now();c("gkx")("3282")&&d("WADevToolsBridge").getDevToolBridge().fireAndForget("devtool","logLine",{logLevel:a,logString:k(b,e)},!0);if(!d("MAWLoggingSwitches").removeLoggingFromBridge)return;b=b.replace(/\n/g," ");if(a==="debug"||typeof b!=="string")return;d("MAWSaveLogToDisk").saveLogEntry("browser",{args:b,date:f,event:d("MAWSaveLogToDisk").joinTags(e,"[unknown]"),level:a})}function m(a,b){a=n(a);a!=null&&l("log",a,b)}function n(a){if(!d("CurrentMessengerUser").isEmployee()&&!d("CurrentMessengerUser").isTestUser())return;a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);return a}function o(a,b){a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);l("log",a,b)}function p(a,b){a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);l("warn",a,b)}function f(a,b,d,e,f,g){d=c("err")(d);d.stack=e;c("promiseDone")(s(a,b,d,f,g))}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){a=d("MAWLeakDetection").maybeReplaceVaultedString(d("WAJids").maybeSanitizeLogLineText(a));c=d("MAWLeakDetection").maybeReplaceVaultedString(d("WAJids").maybeSanitizeLogLineText(c));var f=d("MAWLoggingSwitches").removeLoggingFromBridge?d("MAWSaveLogToDisk").getLastNEntries(e):(h||(h=b("Promise"))).resolve([]);e=e===0?[]:[].concat((yield f).map(function(a){return a.args}));return{errorLogString:c+" [Caught in "+a+"]",logs:[a].concat(e),sanitizedMessage:c}});return r.apply(this,arguments)}function s(a,b,c,d,e){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){a=(yield q(k(a,b),e.message,g));g=a.errorLogString;var h=a.logs;a=a.sanitizedMessage;var i=c("getErrorSafe")(e);try{e.message=a}catch(b){i=c("err")(a,e.fileName,e.lineNumber)}f!==0&&(i.framesToPop=f);(a=j())==null?void 0:(e=a.addMetadata("MESSENGER_E2EE_WEB","APP_VERSION",d("MAWAppVersion").getVersionNumber()).catching(i)).mustfix.apply(e,h);l("error",g,b)});return t.apply(this,arguments)}var u={debug:function(a,b){d("MAWConsoleLogger").logToConsole("log",a,b)},devConsole:function(a,b,c){for(var e=arguments.length,f=new Array(e>3?e-3:0),g=3;g<e;g++)f[g-3]=arguments[g];switch(a){case"DEV":d("MAWConsoleLogger").logToConsole.apply(void 0,["log",b,c].concat(f));break;case"DEV_XMPP":d("MAWConsoleLogger").logToConsole.apply(void 0,["log",b,c].concat(f));break;case"LOG":d("MAWConsoleLogger").logToConsole.apply(void 0,["info",b,c].concat(f));break;case"WARN":d("MAWConsoleLogger").logToConsole.apply(void 0,["warn",b,c].concat(f));break;case"ERROR":d("MAWConsoleLogger").logToConsole.apply(void 0,["error",b,c].concat(f));break;case"CATCHING":d("MAWConsoleLogger").logToConsole.apply(void 0,["error",b,c].concat(f));break}},error:function(a,b,e){a=d("MAWLeakDetection").maybeReplaceVaultedString(d("WAJids").maybeSanitizeLogLineText(a));e?c("promiseDone")(s(a,b,e,0,0)):c("promiseDone")(s(a,b,c("err")(a),2,0));d("MAWConsoleLogger").logToConsole("error",a,b)},info:function(a,b){o(a,b),d("MAWConsoleLogger").logToConsole("info",a,b)},logRestricted:function(a,b){m(a,b),d("MAWConsoleLogger").logToConsole("log",a,b)},warn:function(a,b){p(a,b),d("MAWConsoleLogger").logToConsole("warn",a,b)}};function v(){return!d("MAWLoggingSwitches").removeLoggingFromBridge?(h||(h=b("Promise"))).resolve([]):d("MAWSaveLogToDisk").getEntries()}function w(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("MAWLoggingSwitches").removeLoggingFromBridge)return;yield d("MAWDeleteOldLogsFromDisk").clearLogs()});return x.apply(this,arguments)}function y(a){return new Date(typeof a==="string"?parseInt(a,10):a).toISOString().replace("T"," ").replace("Z","")}function z(a){return a.map(function(a){try{var b=y(a.date);return[b,a.level,a.category,a.event,a.args].join(" | ")}catch(a){return[y(Date.now()),"error","LOGGER","Error formatting log: "+((a==null?void 0:a.message)||"")].join(" | ")}}).filter(Boolean).join("\n")}g.__testClearLoggerSetup=a;g.setupMainWaLogger=e;g.logToHistory=l;g.logRestricted=m;g.info=o;g.warn=p;g.logError=f;g.getEntries=v;g.clearEntries=w;g.formatEntries=z}),98);/*FB_PKG_DELIM*/
__d("AsyncTypedRequest",["AsyncRequest"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.setReplaceTransportMarkers();return b}var c=b.prototype;c.promisePayload=function(b){return a.prototype.promisePayload.call(this,b)};c.setPayloadHandler=function(b){a.prototype.setPayloadHandler.call(this,b);return this};return b}(c("AsyncRequest"));g["default"]=a}),98);
__d("BaseToastContentWrapper.react",["BaseTheme.react","BaseView.react","react","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={dark:"__fb-dark-mode ",light:"__fb-light-mode ",type:"CLASSNAMES"};b=i.forwardRef(a);function a(a,b){var d=a.children,e=a.testid;e=a.useInvertedDisplayMode;a=a.xstyle;var f=c("useCurrentDisplayMode")();f=f==="dark"?"light":"dark";return e?i.jsx(c("BaseTheme.react"),{config:j,displayMode:f,ref:b,testid:void 0,xstyle:a,children:d}):i.jsx(c("BaseView.react"),{ref:b,testid:void 0,xstyle:a,children:d})}a.displayName=a.name+" [from "+f.id+"]";e=b;g["default"]=e}),98);
__d("BaseToast.react",["BaseInlinePressable.react","BaseToastContentWrapper.react","BaseView.react","XPlatReactFocusRegion.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useId,k=b.useMemo,l={item:{display:"x78zum5",flexDirection:"xdt5ytf",paddingBottom:"x19yoh24",paddingStart:"xrxijuk",paddingLeft:null,paddingRight:null,paddingEnd:"xpowjs8",paddingTop:"x6enp1t",$$css:!0},itemText:{flexGrow:"x1iyjqo2",$$css:!0},link:{wordBreak:"xdnwjd9",$$css:!0},root:{alignItems:"x6s0dn4",backgroundColor:"x1wkzo03",borderTopColor:"xlnzwam",borderEndColor:"x12rs7x4",borderBottomColor:"xm9qwu6",borderStartColor:"xup3dfi",borderTopStartRadius:"x1192kqh",borderTopEndRadius:"xjfsc2c",borderBottomEndRadius:"xg8fqjl",borderBottomStartRadius:"x1kdh5me",borderTopStyle:"xhf2mca",borderEndStyle:"xrf2tuc",borderBottomStyle:"x13y0ya8",borderStartStyle:"x1pyzo2z",borderTopWidth:"xmqxc35",borderEndWidth:"x7gbks2",borderBottomWidth:"x21fg80",borderStartWidth:"x1q3d8fi",boxShadow:"xi1c1fh",display:"x78zum5",flexShrink:"x2lah0s",maxWidth:"x1cs6qxi",minWidth:"x1hqenl9",paddingTop:"x192rfv7",paddingBottom:"x13jxccy",paddingStart:"xuv3zuj",paddingLeft:null,paddingRight:null,paddingEnd:"xd3owfx",$$css:!0},rootFullWidth:{width:"xh8yej3",$$css:!0}};function a(a){var b=a.action,e=a.addOnStart,f=a.closeButton,g=a.linkWrapper,h=a.message,m=a.onDismiss,n=a.size;n=n===void 0?"full-width":n;var o=a.testid;o=a.toastRef;a=a.useInvertedDisplayMode;a=a===void 0?!0:a;var p=j(),q=k(function(){return b!=null?{}:{"aria-atomic":!0,role:"alert"}},[b]);e=i.jsxs(i.Fragment,{children:[e!=null&&i.jsx(c("BaseView.react"),{xstyle:l.item,children:e}),i.jsx(c("BaseView.react"),babelHelpers["extends"]({xstyle:[l.item,l.itemText]},q,{children:h({toastMessageId:p})})),b!=null&&i.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,children:i.jsx(c("BaseView.react"),{xstyle:l.item,children:b.element!=null?b.element:b.labelRenderer&&i.jsx(c("BaseInlinePressable.react"),{onPress:function(a){m(),b.onPress(a)},testid:void 0,xstyle:l.link,children:b.labelRenderer(b.label)})})}),f!=null&&i.jsx(c("BaseView.react"),{xstyle:l.item,children:f})]});e=g!=null?g(e):e;return i.jsx(c("BaseToastContentWrapper.react"),{ref:o,testid:void 0,useInvertedDisplayMode:a,xstyle:[l.root,n==="full-width"&&l.rootFullWidth],children:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],(function(a,b,c,d,e,f,g){var h,i="javascript-sandbox",j="OverrideServer",k="www_sandbox",l="www_tier";a=function(){function a(){}var d=a.prototype;d.patchRequestHeaders=function(a){var d={},e=c("RTISubscriptionManagerConfig").bladerunner_www_sandbox,f=c("RTISubscriptionManagerConfig").is_intern;if(!(h||(h=c("isEmpty")))(c("WebDriverConfig").auxiliaryServiceInfo)){var g;g=(g=c("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?g:c("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];g!=null?(typeof g.ip_address==="string"?d[j]=g.ip_address+":18295":typeof g.hostname==="string"&&(d[j]=g.hostname+":18295"),typeof c("WebDriverConfig").originHost==="string"&&(d[k]="www."+c("WebDriverConfig").originHost)):e!=null&&(d[i]=e)}else e!=null&&(d[i]=e);f===!0&&(d[l]="intern");if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){g=b("cr:3024")==null?void 0:b("cr:3024").get();g!=null&&(d.is_test="true",d.original_request_id=g)}c("gkx")("20929")&&(d["Accept-Ack"]="RSAck");for(e in a)d[e]=a[e];d.http_referer=window.location.href;return d};return a}();d=new a();e=d;g["default"]=e}),98);
__d("BladeRunnerLogger",["FBLogger","ODS"],(function(a,b,c,d,e,f,g){var h,i="bladerunner_js_client",j={info:"info",warning:"warning",exception:"exception"};a=function(){function a(){this.setFBLoggerLevel(1)}var b=a.prototype;b.info=function(a){this.$2>=2&&c("FBLogger")(i).info("BladeRunner info: %s",a),this.$3(j.info,a)};b.warn=function(a){this.$2>=1&&c("FBLogger")(i).warn("BladeRunner warn: %s",a),this.$3(j.warning,a)};b.exception=function(a,b){b===void 0&&(b="");var d=b+" "+a.toString();this.$2>=0&&c("FBLogger")(i).warn("BladeRunner exception: %s, %s",b,a.toString());this.$3(j.exception,d)};b.trimForLogging=function(a){var b=1024;return typeof a==="string"&&a.length>b?"[trimmed]:"+a.substring(0,b)+"...":a};b.bumpCounter=function(a,b){b===void 0&&(b=1),(h||(h=d("ODS"))).bumpEntityKey(2966,"BladeRunnerClient",a,b)};b.setClientSessionId=function(a){this.$1=a};b.setFBLoggerLevel=function(a){this.$2=a};b.$3=function(a,b){};return a}();b=new a();e=b;g["default"]=e}),98);
__d("BladeRunnerTypes",[],(function(a,b,c,d,e,f,g){a={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6};b={BLADE_RUNNER:1,GATEWAY:2};g.StreamFrameType=a;g.StreamRequestType=b}),98);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){var h=function(){function a(){}var b=a.prototype;b.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")};b.getInstrumentationData=function(){if(this.instrumentationData!=null&&this.instrumentationData.length>0)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.updateRetryRequestPayload=function(a){a!=null?this.payload=c("Base64").encode(a):this.payload=null};a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.requestType=o(b.requestType);c.payload=r(b.payload);c.headers=u(b.headers);c.extraHeader=r(b.extraHeader);c.requestTarget=r(b.requestTarget);c.instrumentationData=r(b.instrumentationData);return c};return a}(),i=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=p(b.dataId);c.data=r(b.data);c.shouldAck=w(b.shouldAck);return c};var b=a.prototype;b.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data};b.rawDataSize=function(){return this.data==null?0:this.data.length};b.decodeData=function(){if(this.data==null)throw new Error("Expected data");return c("Base64").decode(this.data)};b.setData=function(a){this.data=c("Base64").encode(a)};b.getInstrumentationData=function(){if(this.instrumentationData!=null)return JSON.parse(this.instrumentationData);else return null};return a}(),j=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=o(b.dataId);c.success=v(b.success);c.message=r(b.message);c.code=p(b.code);return c};return a}();j.ACK_CODE_LANDED_AND_ACCEPTED=20;j.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21;j.ACK_CODE_FAILED_TO_LAND=50;var k=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=p(b.streamId);c.message=r(b.message);return c};return a}(),l=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.status=o(b.status);c.message=r(b.message);c.code=p(b.code);c.shouldRetry=w(b.shouldRetry);c.retryDelayMs=p(b.retryDelayMs);return c};return a}(),m=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.newBody=r(b.newBody);c.newExtraHeader=r(b.newExtraHeader);c.patchExtraHeader=r(b.patchExtraHeader);c.killBody=w(b.killBody);c.temporary=w(b.temporary);return c};return a}(),n=function(){function a(){}var b=a.prototype;b.getRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")};b.getData=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")};b.getDataAck=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")};b.getStatusUpdate=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")};b.getLog=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")};b.getRewriteRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")};b.getStreamId=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")};b.isInstrumented=function(){if(this.type===d("BladeRunnerTypes").StreamFrameType.REQUEST)return this.getRequest().instrumentationData!=null;else if(this.type===d("BladeRunnerTypes").StreamFrameType.DATA)return this.getData().instrumentationData!=null;else return!1};a.readObject=function(b){var e=new a();e.type=o(b.type);switch(e.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:e.request=h.readObject(s(b.request));break;case d("BladeRunnerTypes").StreamFrameType.DATA:e.data=i.readObject(s(b.data));break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:e.dataAck=j.readObject(s(b.dataAck));break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:e.statusUpdate=l.readObject(s(b.statusUpdate));break;case d("BladeRunnerTypes").StreamFrameType.LOG:e.log=k.readObject(s(b.log));break;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:e.rewriteRequest=m.readObject(s(b.rewriteRequest));break;default:c("BladeRunnerLogger").warn("Frame with unexpected type: "+e.type);return null}return e};a.newRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REQUEST;c.request=b;return c};a.newDataFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA;c.data=b;return c};a.newDataAckFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA_ACK;c.dataAck=b;return c};a.newStatusUpdateFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE;c.statusUpdate=b;return c};a.newLogFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.LOG;c.log=b;return c};a.newRewriteRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST;c.rewriteRequest=b;return c};return a}();a=function(){function a(a,b,c){this.batchId=a,this.frames=b,this.instrumentationData=c}var b=a.prototype;b.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")};b.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.getInstrumentationDataDfTraceId=function(){if(this.instrumentationData!=null)try{var a=JSON.parse(this.instrumentationData);return(a=a.dataFlowTracingData)==null?void 0:a.traceId}catch(a){return null}else return null};b.write=function(){return JSON.stringify(this)};b.isInstrumented=function(){return this.getFrames().some(function(a){return a.isInstrumented()})};a.read=function(b){b=JSON.parse(b);var c=b.batchId||0,d=[];for(var e=b.frames,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=n.readObject(h);h!=null&&d.push(h)}h=b.instrumentationData||null;return new a(c,d,h)};return a}();function o(a){if(typeof a==="number")return a;throw new Error("Expected number")}function p(a){return a==null?null:o(a)}function q(a){if(typeof a==="string")return a;throw new Error("Expected string")}function r(a){return a==null?null:q(a)}function s(a){if(typeof a==="object"&&a!=null)return a;throw new Error("Expected object")}function t(a){if(typeof a==="object"&&a!=null){var b=a,c={};Object.keys(b).forEach(function(a){var d=b[a];typeof d==="string"&&d!=null&&(c[a]=d)});return c}throw new Error("Expected string map")}function u(a){return a==null?null:t(a)}function v(a){if(typeof a==="boolean"&&a!=null)return a;throw new Error("Expected boolean")}function w(a){return a==null?null:v(a)}g.GatewayStreamRequest=h;g.GatewayStreamData=i;g.GatewayStreamDataAck=j;g.GatewayStreamLog=k;g.GatewayStreamStatusUpdate=l;g.GatewayStreamRewriteRequest=m;g.GatewayStreamFrame=n;g.GatewayStreamBatch=a}),98);
__d("RequestStreamE2EClientLoggerEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});f["default"]=a}),66);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});f["default"]=a}),66);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=1e3;a=function(){function a(a,b,c){this.$2=a,this.$1=b,this.$3=c}var b=a.prototype;b.onProxyResponse=function(a){this.$4(a);var b=[];for(var e=a.getFrames(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;this.$2.witnessFrame(h)&&b.push(h)}h=this.$2.getRequest();(g=h.e2eLogger)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,{},(f=a.getInstrumentationData())==null?void 0:f.auxId,null,a.getInstrumentationDataDfTraceId());b.length>0&&this.$5(new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(a.batchId,b,a.instrumentationData))};b.onDisconnect=function(){this.$2.resetErrors();var a=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();a.streamId=this.$2.getRequest().streamId;a.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;a.shouldRetry=!0;a.retryDelayMs=0;a=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a)]);this.onProxyResponse(a)};b.$4=function(a){var b=this;a=a.getFrames().filter(function(a){return a.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;g=g.getStatusUpdate();if(g.status==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||g.status==d("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var i=g.shouldRetry!=null&&g.shouldRetry,j=g.message!=null?g.message:"null";if(i&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){g.status=d("BladeRunnerStreamStatus").StreamStatus.STOPPED;var k=h;g.retryDelayMs!=null&&(k=g.retryDelayMs);c("BladeRunnerLogger").info("Can retry: stream "+g.streamId+" closed with status "+g.status+", message "+j+". Error count: "+this.$2.getErrorCount()+", retryDelay "+k+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString());this.$2.getRetryRequestScheduled()?c("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(c("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),k>0?c("setTimeoutAcrossTransitions")(function(){return b.$6()},k):this.$6())}else c("BladeRunnerLogger").info("Will not retry: stream "+g.streamId+" closed with status "+g.status+", message "+j+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+i.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),i?c("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):c("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(g.streamId)}}};b.$6=function(){this.$2.setRetryRequestScheduled(!1);if(this.$2.isAlive()){var a=this.$1.getUpdatedRequestBody();a!=null&&this.$2.updateRetryRequestPayload(a);this.$3.sendRetryStreamRequest(this.$2)}};b.$5=function(a){c("BladeRunnerLogger").bumpCounter("send_to_handler");var b=[];this.$1.onBatch(a);for(var a=a.getFrames(),e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;try{switch(g.type){case d("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(g.getData());b.push(g.getData());break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(g.getStatusUpdate().status);break;case d("BladeRunnerTypes").StreamFrameType.LOG:g=g.getLog().message;g!=null&&this.$1.onLog(g);break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(a){c("BladeRunnerLogger").bumpCounter("send_to_handler_error"),c("BladeRunnerLogger").exception(a,"Failed sending frame to stream handler")}}this.$7(b)};b.$7=function(a){var b=[];for(var c=0;c<a.length;c++){var e=a[c];if(e.shouldAck===!0&&e.dataId!=null){var f=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();f.streamId=e.streamId;f.dataId=e.dataId;f.success=!0;b.push(f)}}this.$3.sendDataAcks(b)};return a}();g["default"]=a}),98);
__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("819");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",a);e=b;g["default"]=e}),98);
__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1857112");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client",a);e=b;g["default"]=e}),98);
__d("RequestStreamE2ELogger",["ConstUriUtils","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE","FBLQ:comet_notifications_live_query_experimental"],i=0;function j(){var a=Date.now();i>=a?i+=1:i=a;return i.toString()}var k=function(){function a(a,b,c,e,f,g,h,i,j,k){this.$10=[];this.$11=!1;this.$1=a;this.$2=b;this.$3=c;this.$4=e;this.$5=f;this.$6=g;this.$7=h;this.$8=i;this.$9=j;this.$12=(a=k)!=null?a:!1;b=d("ConstUriUtils").getUri(window.location.href);b&&(this.$13=b.getDomain())}var b=a.prototype;b.logE2EEvent=function(a,b,c,d,e,f){c===void 0&&(c=null);d===void 0&&(d=null);e===void 0&&(e=null);f===void 0&&(f=null);if(this.$3==="Falco")return;e={request_id:this.$1,resume_id:"0",retry_id:e,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:a,event:b,timestamp_ms:j(),aux_id:d,additional_data:c,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:f};this.$14(e)};b.$14=function(a){if(!this.$12){c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return a});return}this.$10.push(a);if(this.$11||a.event==c("RequestStreamE2EClientLoggerEvent").FAILURE||a.message_type==c("RequestStreamE2EClientLoggerMessageType").RESPONSE){var b={events:this.$10};c("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return b});this.$10=[];this.$11=!0}};b.getRequestId=function(){return this.$1};return a}();function a(a,b,c){if(a==null||a.method==null)return null;var d=!1;h.includes(a.method)&&(d=!0);if(b==null||b.length==0)return null;b=JSON.parse(b);return b.requestId==null?null:new k(b.requestId,c,a.method,l(a.method,a),b.requestLogContext,b.forceLogContext,b.sampleRate,b.dgwStreamGroupLoggingId,b.dgwCountPriorStreamsInGroup,d)}function l(a,b){if(a==="FBLQ"&&b.config_id)return b.config_id;if(a==="SKY"){if(b.topic){var c=b.topic.lastIndexOf("/");return c>0?b.topic.substr(0,c):b.topic}return}return a}function b(a,b,d,e,f,g){f===void 0&&(f=null);g===void 0&&(g=null);if(a==null||a.requestId==null||a.clientLoggingDisabled!=null)return;var h={request_id:a.requestId,resume_id:"0",transport:b,e2e_sample_rate:a.sampleRate,message_type:d,event:e,timestamp_ms:j(),aux_id:a.auxId,additional_data:f,df_trace_id:g};c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return h})}g.RequestStreamE2ELogger=k;g.createStreamLogger=a;g.logRequestStreamE2EEventStatic=b}),98);
__d("RequestStreamTransport",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);f.RequestStreamTransport=a}),66);
__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","justknobx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="Connected",j="Disconnected",k="/br_sr",l="/sr_res",m=null;function n(a){var b;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return(b=a.request)==null?void 0:b.getInstrumentationData();case d("BladeRunnerTypes").StreamFrameType.DATA:return(b=a.data)==null?void 0:b.getInstrumentationData()}return null}function o(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case d("BladeRunnerTypes").StreamFrameType.DATA:return c("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function p(a){if(a===null)return null;switch(a){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case d("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function q(a){var b={};a==null?void 0:(a=a.frames)==null?void 0:a.forEach(function(a){if(a.type===d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE){a=(a=a.statusUpdate)==null?void 0:a.status;a=p(a);a!==null&&(b.flow_status=a)}});return b}function r(a,b){var c;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:b.data_base64_size=(c=a.request)==null?void 0:(c=c.payload)==null?void 0:(c=c.length)==null?void 0:c.toString();break;case d("BladeRunnerTypes").StreamFrameType.DATA:b.data_base64_size=(c=a.data)==null?void 0:(b=c.rawDataSize())==null?void 0:b.toString();break}return null}function s(a,b,e){var f=n(a);if(f==null)return;var g=o(a);if(g==null)return;var h=null;switch(b){case d("MqttPublishListener").MqttPublishEvent.SENT:h=c("RequestStreamE2EClientLoggerEvent").SENT;break;case d("MqttPublishListener").MqttPublishEvent.ACKED:h=c("RequestStreamE2EClientLoggerEvent").PUBACK;break;case d("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case d("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:h=c("RequestStreamE2EClientLoggerEvent").FAILURE;e.reason==null&&(e.reason=b);break}if(h==null)return;r(a,e);if(((b=a.request)==null?void 0:b.e2eLogger)!=null&&f.clientLoggingDisabled==null){(b=a.request)==null?void 0:b.e2eLogger.logE2EEvent(g,h,e,f.auxId)}else d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(f,d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,g,h,e)}a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map(),this.$7=a!=null?a:c("FBMqttChannel"),this.$8=new Map(),c("BladeRunnerLogger").setClientSessionId(c("uuidv4")()),this.$9()}a.get=function(){m==null&&(m=new a(c("FBMqttChannel")));return m};var e=a.prototype;e.sendNewStreamRequest=function(b,d){d=new(c("BladeRunnerEventHandler"))(b,d,this);var e=b.getRequest();this.$6.set(e.streamId,d);if(!this.$10()){this.$11(d,e.streamId);return}this.getStreamCount()<=a.maxStreamCount?this.$12(e):(c("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),c("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(b.getRequest().getHeaders())),this.$11(d,e.streamId))};e.sendRetryStreamRequest=function(a){this.$12(a.getRequest())};e.sendCancel=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_cancel");var b=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();b.streamId=a.streamId;b.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;this.$13(b,a);this.removeStream(a.streamId)};e.sendAmendment=function(a,b,e){c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var f=new(d("BladeRunnerTypesInternal").GatewayStreamData)();f.streamId=a;f.setData(b);e!=null&&(f.instrumentationData=e);this.$14(f)};e.sendAmendmentWithAck=function(a,e,f){var g=this;c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var i=this.$15(),j=new(d("BladeRunnerTypesInternal").GatewayStreamData)();j.streamId=a;j.setData(e);j.shouldAck=!0;j.dataId=i;f!=null&&(j.instrumentationData=f);a=new(h||(h=b("Promise")))(function(a,b){g.$8.set(i,{resolve:a,reject:b})});this.$14(j);return a};e.$14=function(a){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(a)),this.$16()};e.sendDataAcks=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_data_ack",a.length),this.$17(a)};e.removeStream=function(a){this.$6["delete"](a)};e.getStreamCount=function(){return this.$6.size};e.getNextStreamId=function(){this.$5++;return this.$5};e.onMQTTStateChanged=function(a){this.$16();if(a!=j&&a!=i||this.$4==a)return;this.$4=a;c("BladeRunnerLogger").info("MQTTStateChanged: "+a);a==j?(c("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):a==i&&c("BladeRunnerLogger").bumpCounter("mqtt_state_connected")};e.$12=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_request");this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(a));if(!this.$16()){(a=a.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})}};e.$13=function(a,b){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a));if(this.$16()){(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").SENT)}};e.$17=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(c))}this.$16()};e.$19=function(){this.$2++;return this.$2};e.$15=function(){this.$3++;return this.$3};e.$16=function(){var a=!1;if(this.$7.getConnectionState()===i&&this.$1.length>0)try{this.$20(this.$1),a=!0}catch(a){}finally{this.$1=[]}return a};e.$20=function(a){var b=this,e=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(this.$19(),a),f=e.write();if(f.length>this.$21()){var g=Math.floor(a.length/2);if(g===0){a.forEach(function(a){return s(a,d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var h=new Error("Publish is too long: "+f.length);h.stack;this.$22(e,h,"Publish is too long");throw h}this.$20(a.slice(0,g));this.$20(a.slice(g,a.length))}else try{c("BladeRunnerLogger").info("send message to "+k+" ("+f.length+" bytes)");h={qos:1,skipBuffer:!1};if(e.isInstrumented()){var i=Date.now();h.listener={onEvent:function(b){var c=(Date.now()-i).toString();a.forEach(function(a){s(a,b,{latency:c})})}}}this.$7.publish(k,f,h)["catch"](function(a){b.$22(e,a,"Failed publishing to MQTT")});c("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(a){this.$22(e,a,"Failed publishing to MQTT");throw a}};e.$9=function(){var a=this;c("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent);this.onMQTTStateChanged(this.$7.getConnectionState());this.$7.subscribeChannelEvents({onMQTTStateChanged:function(b){a.onMQTTStateChanged(b)},onJSError:function(a){var b=a!=null&&typeof a.isRecoverable==="boolean"?a.isRecoverable:!1;b?c("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(c("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof a=="object"&&a!=null?a.toString():"unknown error")+", "+JSON.stringify(a)),c("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}});this.$7.subscribe(k,function(a){throw new Error("Unexpected response: "+k+" "+a.toString())});this.$7.subscribe(l,function(b){a.$23(b)})};e.$23=function(a){a=d("BladeRunnerTypesInternal").GatewayStreamBatch.read(a);this.processBatch(a)};e.$22=function(a,b,e){for(var a=a.getFrames(),f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=a.length)break;h=a[g++]}else{g=a.next();if(g.done)break;h=g.value}h=h;if(h.type===d("BladeRunnerTypes").StreamFrameType.REQUEST){var i=h.getRequest(),j=this.$6.get(i.streamId);j!=null&&this.$24(j,i.streamId,d("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else if(h.type===d("BladeRunnerTypes").StreamFrameType.DATA){j=h.getData();i=j.dataId;if(j.shouldAck!=null&&j.shouldAck&&i!=null){h=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();h.streamId=j.streamId;h.dataId=i;h.success=!1;h.code=d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND;h.message=e;this.$25(h)}}}c("BladeRunnerLogger").info("Failed publishing to MQTT: "+b.message);c("BladeRunnerLogger").bumpCounter("mqtt_publish_error")};e.$25=function(a){var b=this.$8.get(a.dataId);b!=null&&(this.$8["delete"](a.dataId),a.success?b.resolve(!0):a.code===d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?b.resolve(!1):b.reject(a.message))};e.processBatch=function(a){try{d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(a.getInstrumentationData(),d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,q(a),a.getInstrumentationDataDfTraceId());c("BladeRunnerLogger").bumpCounter("socket_process_batch");var b=JSON.stringify(a);c("BladeRunnerLogger").info("Received batch ("+b.length+" bytes)");b=null;for(var e=a.getFrames(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h.getStreamId();b==null&&(b=i);if(i!=null&&b!=i)throw new Error("Received batch with frames for multiple streams");h.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(h.getDataAck())}if(b!=null){i=this.$6.get(b);i!=null?i.onProxyResponse(a):c("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+b)}else c("BladeRunnerLogger").info("Received batch with no frames")}catch(a){c("BladeRunnerLogger").exception(a,"Failed processing batch from MQTT");c("BladeRunnerLogger").bumpCounter("socket_process_batch_error");throw a}};e.$18=function(){this.$6.forEach(function(a,b,c){a.onDisconnect()})};e.$11=function(a,b){this.$24(a,b,d("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)};e.$24=function(a,b,c,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();g.streamId=b;g.status=c;g.shouldRetry=e;g.retryDelayMs=f;b=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(g)]);a.onProxyResponse(b)};e.$10=function(){if(!c("CurrentUser").isLoggedIn()){c("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out");return!1}return!0};e.$21=function(){var a=1024*1024,b=512*1024;try{var d=c("justknobx")._("317");b=d*a}catch(a){}return Math.max(b-1024,0)};return a}();a.maxStreamCount=2e3;g["default"]=a}),98);
__d("BladeRunnerStream",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){var g;a=function(){function a(a){this.$1=a}var c=a.prototype;c.getStreamHandler=function(){return this.$1};c.cancel=function(){};c.amendWithAck=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},null,this)};c.amendFireAndForget=function(a){};c.amendWithoutAck=function(a){};c.start=function(){return(g||(g=b("Promise"))).resolve()};c.isAlive=function(){return!1};c.canAmend=function(){return!1};c.getStatus=function(){return null};c.getStreamId=function(){return 0};return a}();f["default"]=a}),66);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){a=function(){function a(a){this.$1=a,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var b=a.prototype;b.getRequest=function(){return this.$1};b.updateRetryRequestPayload=function(a){this.$1.updateRetryRequestPayload(a)};b.isAlive=function(){return!(this.$2==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.REJECTED)};b.canAmend=function(){return this.$2==d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STOPPED};b.getLastStatus=function(){return this.$2};b.setLastStatus=function(a){this.$2=a};b.onError=function(){this.$3+=1};b.getErrorCount=function(){return this.$3};b.resetErrors=function(){this.$3=0};b.getRetryRequestScheduled=function(){return this.$6};b.setRetryRequestScheduled=function(a){this.$6=a};b.witnessFrame=function(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var b=a.getStatusUpdate(),c=!0;switch(b.status){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:c=!this.$4;this.$4||(this.$4=!0);break;case d("BladeRunnerStreamStatus").StreamStatus.STARTED:c=this.getLastStatus()!=d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:c=this.getLastStatus()==d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:c=!0}this.setLastStatus(b.status);return c;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:this.$7(a.getRewriteRequest());return!1;default:return!0}};b.setRetriesAllowed=function(a){this.$5=a};b.getRetriesAllowed=function(){return this.$5};b.$7=function(a){if(!(a.temporary!=null||a.temporary==!0)){a.newBody!=null&&(this.$1.payload=a.newBody);a.newExtraHeader!=null&&(this.$1.extraHeader=a.newExtraHeader,this.$1.headers=JSON.parse(a.newExtraHeader));if(a.patchExtraHeader!=null)try{var b=JSON.parse(a.patchExtraHeader),d=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});var e=Object.keys(b);for(var f=0;f<e.length;f++){var g=e[f];this.$1.headers[g]=b[g];d[g]=b[g]}this.$1.extraHeader=JSON.stringify(d)}catch(b){c("BladeRunnerLogger").warn("Failed to patch header: "+a.patchExtraHeader)}a.killBody!=null&&a.killBody==!0&&(this.$1.payload=null)}};return a}();g["default"]=a}),98);
__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","regeneratorRuntime","uuidv4"],(function(a,b,c,d,e,f,g){var h,i=4,j={reason:"stream_dead"};a=function(a){babelHelpers.inheritsLoose(e,a);function e(b,d,e){b=a.call(this,b)||this;b.$BladeRunnerSocketStream1=e;b.$BladeRunnerSocketStream2=new(c("BladeRunnerStreamState"))(d);b.$BladeRunnerSocketStream2.setRetriesAllowed(i);return b}var f=e.prototype;f.start=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.send(),b()})};f.send=function(){var a,b=this.$BladeRunnerSocketStream2.getRequest();(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:(a=b.payload)==null?void 0:(b=a.length)==null?void 0:b.toString()});this.$BladeRunnerSocketStream1.sendNewStreamRequest(this.$BladeRunnerSocketStream2,this.getStreamHandler())};f.amendWithAck=function(a){var d,e,f,g,i,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=this.$BladeRunnerSocketStream2.getRequest();f=e.getInstrumentationData();f&&(f.auxId=c("uuidv4")(),(g=e.e2eLogger)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null?void 0:(i=a.length)==null?void 0:i.toString()},f.auxId));if(!this.canAmend()){m.next=6;break}f&&((k=e.e2eLogger)==null?void 0:k.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null?void 0:(l=a.length)==null?void 0:l.toString()},f.auxId));return m.abrupt("return",this.$BladeRunnerSocketStream1.sendAmendmentWithAck(e.streamId,this.$BladeRunnerSocketStream3(a),f==null?null:JSON.stringify(f)));case 6:(d=e.e2eLogger)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,j,f==null?void 0:f.auxId);return m.abrupt("return",(h||(h=b("Promise"))).reject("Stream is closed or not accepted"));case 8:case"end":return m.stop()}},null,this)};f.amendFireAndForget=function(a){var b=this.$BladeRunnerSocketStream2.getRequest(),d=b.getInstrumentationData();if(d){var e;d.auxId=c("uuidv4")();(e=b.e2eLogger)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null?void 0:(e=a.length)==null?void 0:e.toString()},d.auxId)}if(this.canAmend()){this.$BladeRunnerSocketStream1.sendAmendment(this.$BladeRunnerSocketStream2.getRequest().streamId,this.$BladeRunnerSocketStream3(a),d==null?null:JSON.stringify(d));if(d){(e=b.e2eLogger)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null?void 0:(e=a.length)==null?void 0:e.toString()},d.auxId)}}else{(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,j,d==null?void 0:d.auxId);throw new Error("Stream is closed or not accepted")}};f.amendWithoutAck=function(a){this.amendFireAndForget(a)};f.$BladeRunnerSocketStream3=function(a){return typeof a=="object"?btoa(new TextDecoder("utf8").decode(a)):a};f.cancel=function(){var a=this.$BladeRunnerSocketStream2.getRequest();(a=a.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.isAlive()&&(this.$BladeRunnerSocketStream1.sendCancel(this.$BladeRunnerSocketStream2.getRequest()),this.$BladeRunnerSocketStream2.setLastStatus(d("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())};f.isAlive=function(){return this.$BladeRunnerSocketStream2.isAlive()};f.canAmend=function(){return this.$BladeRunnerSocketStream2.canAmend()};f.getStatus=function(){return this.$BladeRunnerSocketStream2.getLastStatus()};f.getStreamId=function(){return this.$BladeRunnerSocketStream2.getRequest().streamId};return e}(c("BladeRunnerStream"));g["default"]=a}),98);
__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return a==null?!1:a.requestId!=null&&typeof a.requestId=="string"&&a.forceLogContext!=null&&typeof a.forceLogContext=="string"}function j(a,b){var d=c("RequestStreamE2EClientSamplingConfig").sampleRate;if(d>1&&a!=null){a=c("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[a];a==0?d=0:a!=null&&(d/=a)}return d==1?1:d/b}function k(a,b,d,e){var f=c("uuidv4")();(b.requestId==null||b.requestId===""||typeof b.requestId!="string")&&(a.requestId!=null&&typeof a.requestId=="string"?b.requestId=a.requestId:b.requestId=f);b.requestId+="/_"+f.substring(0,4);b.resumeId="0";d!=null?b.sampleRate=d:b.sampleRate=void 0;f="";e!=null&&e.length>0&&(f=e);f.length>0&&(b.requestLogContext!=null&&b.requestLogContext.length>0?b.requestLogContext+=":":b.requestLogContext="",b.requestLogContext+=f);(a==null?void 0:a.method)==="Falco"&&(b.clientLoggingDisabled="Falco");d={};for(e=Object.keys(b).sort(),f=Array.isArray(e),a=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(f){if(a>=e.length)break;g=e[a++]}else{a=e.next();if(a.done)break;g=a.value}g=g;d[g]=b[g]}return JSON.stringify(d)}function a(a,b,d,e){b&&(!b.requestId.includes("/")&&!b.requestId.includes("#")||h(0,41721));e=j(a.method,(e=e)!=null?e:1);if(c("Random").coinflip(e))return k(a,b||{requestId:""},e,d);return i(b)?k(a,b||{requestId:""},null,d):""}g.isForceLogged=i;g.getSampleRateForLogging=j;g.normalizeInstrumentationData=k;g.validateInstrumentationData=a}),98);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$2=d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=a!=null?a:c("BladeRunnerSocket").get(),b&&(this.$2=b)}var e=a.prototype;e.createStream=function(a,b,c,d){return this.$3(a,b,c,d)};e.requestStream=function(a,c,d,e){a=this.$3(a,c,d,e);a.send();b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return a};e.logInfo=function(a){c("BladeRunnerLogger").info(a)};e.bumpCounter=function(a){c("BladeRunnerLogger").bumpCounter(a)};e.$3=function(a,b,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamRequest)();g.streamId=this.$1.getNextStreamId();g.requestType=d("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER;g.headers=c("BladeRunnerConfig").patchRequestHeaders(a);g.extraHeader=JSON.stringify(g.headers);g.payload=b!=null?c("Base64").encode(b):null;f!=null&&(f.transport="WEB_RS_MQTT");g.instrumentationData=d("RequestStreamE2ESampling").validateInstrumentationData(g.headers||{},f);g.e2eLogger=d("RequestStreamE2ELogger").createStreamLogger(g.headers,g.instrumentationData,this.$2);return new(c("BladeRunnerSocketStream"))(e,g,this.$1)};return a}();g["default"]=a}),98);
__d("BootloaderEventsPerf",["invariant","Bootloader","BootloaderEvents","ResourceTimingStore","objectEntries","objectValues"],(function(a,b,c,d,e,f,g,h){var i={total_count:0,total_bytes:0,downloaded_count:0,downloaded_bytes:0,cached_count:0,cached_bytes:0,inlined_count:0,inlined_bytes:0,duration:0,missing_count:0};function j(a,b,c){return Math.max(0,((c=c)!=null?c:0)-Math.max(a,(c=b)!=null?c:0))}function k(){return{blocking:babelHelpers["extends"]({},i),nonblocking:babelHelpers["extends"]({},i),"default":babelHelpers["extends"]({},i)}}function l(a,b,c){var e,f;if(c==null)e=0,f="downloaded";else if(c[1])e=c[0].length,f="inlined";else{c=d("ResourceTimingStore").getEntryForURL(c[0]);c?(e=c.encodedBodySize,f=c.transferSize===0?"cached":"downloaded"):(e=0,f="downloaded",a.missing_count++)}a.total_count++;a.total_bytes+=e;if(!b)return;a.duration=Math.max(a.duration,b);switch(f){case"downloaded":a.downloaded_count++;a.downloaded_bytes+=e;break;case"inlined":a.inlined_count++;a.inlined_bytes+=e;break;case"cached":a.cached_count++;a.cached_bytes+=e;break}}function m(a,b,d,e,f){var g=c("Bootloader").getResourceState(b);l(a,j(d,g.loadStart,g.loadEnd),e);g.loadError!=null&&f.add(b)}function n(a,b,d,e){var f=k();for(var a=c("objectEntries")(a),g=Array.isArray(a),i=0,a=g?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(i>=a.length)break;j=a[i++]}else{i=a.next();if(i.done)break;j=i.value}j=j;var l=j[0];j=j[1];for(var j=j,n=Array.isArray(j),o=0,j=n?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=j.length)break;p=j[o++]}else{o=j.next();if(o.done)break;p=o.value}p=p;var q=p[0];p=p[1];var r=void 0,s=void 0;switch(p.type){case"async":s=null;r=d;break;case"js":case"css":s=[p.src,p.d===1];r=f;break;default:p,h(0,3721)}m(r[l],q,b,s,e)}}return f}function o(a,b){var e={unpredicted:d("BootloaderEvents").newResourceMapSet(),ef:d("BootloaderEvents").newResourceMapSet(),overpredicted:d("BootloaderEvents").newResourceMapSet()};for(var f=c("objectEntries")(b),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;var j=i[0];i=i[1];for(var i=i.entries(),k=Array.isArray(i),l=0,i=k?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=i.length)break;m=i[l++]}else{l=i.next();if(l.done)break;m=l.value}m=m;var n=m[0];m=m[1];a[j].has(n)?e.ef[j].set(n,m):e.overpredicted[j].set(n,m)}}for(n=c("objectEntries")(a),m=Array.isArray(n),l=0,n=m?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(m){if(l>=n.length)break;k=n[l++]}else{l=n.next();if(l.done)break;k=l.value}i=k;j=i[0];h=i[1];for(g=h.entries(),f=Array.isArray(g),a=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(a>=g.length)break;k=g[a++]}else{a=g.next();if(a.done)break;k=a.value}i=k;h=i[0];k=i[1];b[j].has(h)||e.unpredicted[j].set(h,k)}}return e}function a(a){var b=a.efData,c=a.rsrcs,d=a.startTime,e=new Set(),f;if(b){var g=o(c,b.tierOne);f=g.unpredicted;g={ef:n(g.ef,b.fetchRsrcsStart,k(),e),overpredicted:n(g.overpredicted,b.fetchRsrcsStart,k(),e)};b={ef_fetch_predictions:b.fetchPredictionsEnd-b.fetchPredictionsStart,ef_fetch_start_wait:b.fetchPredictionsEnd-b.fetchRsrcsStart,ef_head_start:d-b.fetchRsrcsStart}}else f=c,g={},b={};c=babelHelpers["extends"]({unpredicted:n(f,d,k(),e)},g);return{source:a.source,source_detail:a.sourceDetail,is_first_identical:a.isFirstIdentical,timeslice_context:(f=a.timesliceContext)==null?void 0:f.name,start_time:d,err_count:e.size,resources:c,durations:babelHelpers["extends"]({jsmods_wait:a.jsmodsStart-d,jsmods:a.jsmodsEnd-a.jsmodsStart,jsmods_done_wait:a.jsmodsEnd-d,download_done_wait:a.logTime-d},b),payloadStats:a.payloadStats}}function b(a){var b=a.startTime,e=0,f=0,g=0,h=0;for(var i=a.components,m=Array.isArray(i),o=0,i=m?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(m){if(o>=i.length)break;p=i[o++]}else{o=i.next();if(o.done)break;p=o.value}p=p;p=c("Bootloader").getComponentTiming(p);var q=p.tierTwoStart,r=p.tierTwoEnd,s=p.tierThreeStart;p=p.tierThreeEnd;e=Math.max(e,j(b,q,r));f=Math.max(f,j(b,b,r));g=Math.max(g,j(b,s,p));h=Math.max(h,j(b,b,p))}q=new Set();r=k();s=n(a.tierOne,b,r,q);p=n(a.tierTwo,b,r,q);o=n(a.tierThree,b,r,q);m=r.blocking.downloaded_count!=0;i=k();var t=d("BootloaderEvents").newResourceMapSet(),u=new Set(),v=[a.tierOne,a.tierTwo,a.tierThree];for(var w=0;w<v.length;w++){var x=v[w];for(var x=c("objectValues")(x),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}A=A;for(var A=A.keys(),B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}D=D;u.add(D)}}}D=0;C=0;B=0;for(A=a.beRequests.values(),z=Array.isArray(A),y=0,A=z?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(z){if(y>=A.length)break;x=A[y++]}else{y=A.next();if(y.done)break;x=y.value}v=x;D+=j(b,b,v.requestStart);C+=v.serverGenTime;B+=v.jsmodsEnd-v.jsmodsStart;l(i[m?"blocking":"nonblocking"],v.responseStart-v.requestStart,[v.uri,!1]);for(w=c("objectEntries")(v.rsrcs),x=Array.isArray(w),v=0,w=x?w:w[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(x){if(v>=w.length)break;E=w[v++]}else{v=w.next();if(v.done)break;E=v.value}E=E;var F=E[0];E=E[1];for(var E=E,G=Array.isArray(E),H=0,E=G?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var I;if(G){if(H>=E.length)break;I=E[H++]}else{H=E.next();if(H.done)break;I=H.value}I=I;var J=I[0];I=I[1];u.has(J)||t[F].set(J,I)}}}J=n(t,b,r,q);return{ref:a.ref,components:a.components,timeslice_context:(I=a.timesliceContext)==null?void 0:I.name,start_time:b,err_count:q.size,resources:{t1:s,t2:p,t3:o,be:i,unpredicted:J,async:r},durations:{fetch_start_wait:a.fetchStartTime-b,be_start_wait:D,be_server_gen:C,be_jsmods:B,callback_wait:a.callbackStart-b,callback:a.callbackEnd-a.callbackStart,bootload_done_wait:a.callbackEnd-b,rdfd_requirelazy:e,rdfd_done_wait:f,rd_requirelazy:g,rd_done_wait:h}}}function e(a){a.start_time;var b=a.resources,d=a.durations;a=babelHelpers.objectWithoutPropertiesLoose(a,["start_time","resources","durations"]);for(var b=c("objectEntries")(b),e=Array.isArray(b),f=0,b=e?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;var h=g[0];g=g[1];for(var g=c("objectEntries")(g),i=Array.isArray(g),j=0,g=i?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=g.length)break;k=g[j++]}else{j=g.next();if(j.done)break;k=j.value}k=k;var l=k[0];k=k[1];for(var k=c("objectEntries")(k),m=Array.isArray(k),n=0,k=m?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=k.length)break;o=k[n++]}else{n=k.next();if(n.done)break;o=n.value}o=o;var p=o[0];o=o[1];a[h+"_"+l+"_resources_"+p]=Math.round(Number(o))}}}for(p=c("objectEntries")(d),o=Array.isArray(p),n=0,p=o?p:p[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(o){if(n>=p.length)break;m=p[n++]}else{n=p.next();if(n.done)break;m=n.value}k=m;l=k[0];j=k[1];a[l+"_duration"]=Math.round(Number(j))}if(a.payloadStats){for(i=c("objectEntries")(a.payloadStats),g=Array.isArray(i),h=0,i=g?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(h>=i.length)break;f=i[h++]}else{h=i.next();if(h.done)break;f=h.value}e=f;b=e[0];d=e[1];for(m=c("objectEntries")(d),k=Array.isArray(m),l=0,m=k?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(l>=m.length)break;j=m[l++]}else{l=m.next();if(l.done)break;j=l.value}n=j;o=n[0];p=n[1];a[b+"_"+o+"_count"]=Math.round(Number(p))}}delete a.payloadStats}return a}g.computeHRData=a;g.computeBLData=b;g.flattenData=e}),98);
__d("BootloaderLoggingStatusEnum",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["SUCCESS","TIMEOUT"]);c=a;f["default"]=c}),66);
__d("CometBootloaderEventsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:CometBootloaderEventsLoggerConfig")}),null);
__d("HasteResponseFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1823926");b=d("FalcoLoggerInternal").create("haste_response",a);e=b;g["default"]=e}),98);
__d("CometBootloaderLoggerUtil",["BootloaderEvents","BootloaderEventsPerf","CometBootloaderEventsTypedLoggerLite","CometTimeSpentNavigation","HasteResponseFalcoEvent","ResourceTimingStore","SiteData","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h=!1;function a(a){var b=a.bl_sample_rate,e=a.hr_sample_rate,f=a.parent_lid;if(h||!(b||e))return;h=!0;d("ResourceTimingStore").init();var g=function(a){return{ms_since_navstart:Math.round(a-c("performanceNavigationStart")()),parent_lid:f,pkg_cohort:c("SiteData").pkg_cohort,request_path:(a=c("CometTimeSpentNavigation").getPathInfo())==null?void 0:a.name,svn_rev:c("SiteData").client_revision}};e&&d("BootloaderEvents").onHasteResponse(function(a){return c("HasteResponseFalcoEvent").log(function(){var b=d("BootloaderEventsPerf").computeHRData(a),c=d("BootloaderEventsPerf").flattenData(b);return babelHelpers["extends"]({},c,g(b.start_time))})});var i=function(a,b,e){a=d("BootloaderEventsPerf").computeBLData(a);var f=d("BootloaderEventsPerf").flattenData(a);c("CometBootloaderEventsTypedLoggerLite").log(babelHelpers["extends"]({},f,g(a.start_time),{status:b}),{weight:e})};b&&d("BootloaderEvents").onBootload(function(a){return i(a,"SUCCESS",b)});var j=1;d("BootloaderEvents").onBootloaderCallbackTimeout(function(a){return i(a,"TIMEOUT",j)})}g.initLogging=a}),98);
__d("CometFocusTableContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({FocusCell:null,FocusRow:null,FocusTable:null});g["default"]=b}),98);
__d("CometSSREntrypoint",["objectValues","relay-runtime/util/withProvidedVariables"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b,d=c("relay-runtime/util/withProvidedVariables")(a.variables,a.parameters.params.providedVariables);return{actor_id:(b=(b=a.environmentProviderOptions)==null?void 0:b.actorID)!=null?b:null,exclude_from_ssr:(b=(b=a.environmentProviderOptions)==null?void 0:b.excludeFromSSR)!=null?b:!1,id:a.parameters.params.id,name:a.parameters.params.name,num_connections_for_ssr:(a=(b=a.environmentProviderOptions)==null?void 0:b.numConnectionsForSSR)!=null?a:null,variables:d}}function i(a,b){b=a.getPreloadProps(b);var d=b.entryPoints;b=b.queries;b=(b=b)!=null?b:{};var e=c("objectValues")(b).filter(function(a){return a!=null}),f=[a.root.getModuleId()];if(d!=null){b=Object.keys(d);b.forEach(function(a){a=d[a];if(a==null)return;var b=a.entryPoint;a=a.entryPointParams;b=i(b,a);e=e.concat(b.queries);f=f.concat(b.roots)})}return{queries:e,roots:f}}function a(a,b){a=i(a,b);b=a.queries;return b.map(h)}function b(a){a=a.map(function(a){return i(a.entryPoint,a.entryPointParams)});return a.map(function(a){var b=a.queries;a=a.roots;return{quries:b.map(h),roots:a}})}function d(a,b){a=i(a,b);b=a.queries;a=a.roots;return{queries:b.map(h),roots:a}}function e(){throw new Error("This function should not be called. It exists solely for the type-generation")}function f(a,b){var d;a=a.map(function(a){return i(a.entryPoint,a.entryPointParams)});a=a.map(function(a){var b=a.queries;a=a.roots;return{queries:b.map(h),roots:a}});d=c("objectValues")((d=b==null?void 0:b.getDisplayQueries())!=null?d:{}).filter(function(a){return a!=null}).map(h);b=c("objectValues")((b=b==null?void 0:b.getDeferredQueries())!=null?b:{}).filter(function(a){return a!=null}).map(h);return{appshellQueries:{deferred:b,display:d},routeObjects:a}}g.processRootEntryPoint=a;g.processRootEntryPoints=b;g.processRootEntryPointData=d;g.preloadQuery=e;g.processServerEntryPoints=f}),98);
__d("CometRouterSSREntrypoint",["CometSSREntrypoint"],(function(a,b,c,d,e,f){"use strict";a=importNamespace("CometSSREntrypoint").processRootEntryPoint;b=importNamespace("CometSSREntrypoint").processRootEntryPointData;f.processRootEntryPoint=a;f.processRootEntryPointData=b}),66);
__d("CometRelayEF",["Bootloader","BootloaderEvents","ClientConsistencyEventEmitter","CometRouterSSREntrypoint","cometAsyncFetch","gkx","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function j(a,b){if(!c("gkx")("26332"))return;a=d("CometRouterSSREntrypoint").processRootEntryPoint(a,b);var e=[];a.forEach(function(a){a=a.name;i.has(a)||(e.push(a),d("BootloaderEvents").notifyHasteResponseEFStart("relay_3d",a))});if(e.length===0)return;var f=(h||(h=c("performanceAbsoluteNow")))(),g=c("cometAsyncFetch")("/ajax/relay-ef/",{data:{queries:e},method:"POST"}).then(function(a){return{fetchPredictionsEnd:(h||(h=c("performanceAbsoluteNow")))(),fetchPredictionsStart:f,payload:a}});e.forEach(function(a){return i.set(a,g)})}function a(a,b){if(!c("gkx")("26332"))return;var e=(h||(h=c("performanceAbsoluteNow")))();j(a,b);a=d("CometRouterSSREntrypoint").processRootEntryPoint(a,b);a.forEach(function(a){var b=a.name,f=i.get(b);f&&f!==!0&&c("promiseDone")(f,function(a){var f=a.fetchPredictionsEnd,g=a.fetchPredictionsStart;a=a.payload;if(a!=null&&typeof a==="object"){var h;c("Bootloader").loadPredictedResourceMap(a.predictions[b],{onLog:function(a){return d("BootloaderEvents").notifyHasteResponseEF("relay_3d",b,{fetchPredictionsEnd:f,fetchPredictionsStart:g,fetchRsrcsStart:e,tierOne:a})}},(h=(h=a.consistency)==null?void 0:h.rev)!=null?h:null);a.consistency!=null&&c("ClientConsistencyEventEmitter").emit("newEntry",a.consistency)}});i.set(a.name,!0)})}b={fetchPredictedResources:a,fetchPredictions:j};g["default"]=b}),98);
__d("CometToast.react",["fbt","ix","BaseToast.react","CometPressable.react","FDSCircleButton.react","FDSText.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useMemo,m={pressable:{alignItems:"x6s0dn4",display:"x78zum5",flexDirection:"x1q0g3np",width:"xh8yej3",$$css:!0}};function a(a){var b=a.action,e=a.href,f=a.icon,g=a.impressionLoggingRef,j=a.message,n=a.onDismiss,o=a.supressCloseButton;o=o===void 0?!1:o;var p=a.target,q=a.testid;q=q===void 0?"Toast":q;q=a.truncateText;var r=q===void 0?!0:q,s=babelHelpers.objectWithoutPropertiesLoose(a,["action","href","icon","impressionLoggingRef","message","onDismiss","supressCloseButton","target","testid","truncateText"]),t=l(function(){return e!=null?{target:p,url:e}:void 0},[e,p]);return k.jsx(c("BaseToast.react"),{action:b!=null?{label:b.label,labelRenderer:function(a){return k.jsx(c("FDSText.react"),{color:"blueLink",numberOfLines:1,type:"bodyLink3",children:a})},onPress:b.onPress,testid:b.testid}:void 0,addOnStart:f,closeButton:o!==!0&&k.jsx(c("FDSCircleButton.react"),{icon:d("fbicon")._(i("478231"),12),label:h._("__JHASH__cCrSTii9yXy__JHASH__"),onPress:n,size:24,testid:void 0}),linkWrapper:s.onPress!=null||t!=null?function(a){return k.jsx(c("CometPressable.react"),babelHelpers["extends"]({},s,{expanding:!0,linkProps:t,xstyle:m.pressable,children:a}))}:void 0,message:function(a){a=a.toastMessageId;return k.jsx(c("FDSText.react"),{color:"primary",id:a,numberOfLines:r?4:void 0,type:"body3",children:j})},onDismiss:n,testid:void 0,toastRef:g})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("jsbi",[],(function(a,b,c,d,e,f){(function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.JSBI=b()})(this,function(){"use strict";function a(b){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function i(){return i=h()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);b=Function.bind.apply(a,d);a=new b;return c&&g(a,c.prototype),a},i.apply(null,arguments)}function j(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function k(a){var b="function"==typeof Map?new Map:void 0;return k=function(a){function c(){return i(a,arguments,f(this).constructor)}if(null===a||!j(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),g(c,a)},k(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:l(a)}var n=function(c){var h=Math.abs,i=Math.max,j=Math.imul,k=Math.clz32;function g(a,c){if(b(this,g),a>g.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return a=m(this,f(g).call(this,a)),a.sign=c,a}return e(g,c),d(g,[{key:"toDebugString",value:function(){var a=["BigInt["],b=!0,c=!1,d=void 0;try{for(var e,e,f=this[Symbol.iterator]();!(b=(e=f.next()).done);b=!0)e=e.value,a.push((e?(e>>>0).toString(16):e)+", ")}catch(a){c=!0,d=a}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return a.push("]"),a.join("")}},{key:"toString",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>a||36<a)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(a&a-1)?g.__toStringBasePowerOfTwo(this,a):g.__toStringGeneric(this,a,!1)}},{key:"__copy",value:function(){for(var a=new g(this.length,this.sign),b=0;b<this.length;b++)a[b]=this[b];return a}},{key:"__trim",value:function(){for(var a=this.length,b=this[a-1];0===b;)a--,b=this[a-1],this.pop();return 0===a&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var a=0;a<this.length;a++)this[a]=0}},{key:"__clzmsd",value:function(){return k(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(a,b,c){c>this.length&&(c=this.length);for(var d=65535&a,a=a>>>16,e=0,f=65535&b,b=b>>>16,i=0;i<c;i++){var n=this.__digit(i),m=65535&n;n=n>>>16;var o=j(m,d);m=j(m,a);var p=j(n,d);n=j(n,a);var q=f+(65535&o);o=b+e+(q>>>16)+(o>>>16)+(65535&m)+(65535&p);f=(m>>>16)+(p>>>16)+(65535&n)+(o>>>16),e=f>>>16,f&=65535,b=n>>>16;this.__setDigit(i,65535&q|o<<16)}if(0!==e||0!==f||0!==b)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(a,b,c){for(var d,e=0,f=0;f<c;f++)d=this.__halfDigit(b+f)+a.__halfDigit(f)+e,e=d>>>16,this.__setHalfDigit(b+f,d);return e}},{key:"__inplaceSub",value:function(a,b,c){var d=0;if(1&b){b>>=1;for(var e=this.__digit(b),f=65535&e,k=0;k<c-1>>>1;k++){var l=a.__digit(k),m=(e>>>16)-(65535&l)-d;d=1&m>>>16,this.__setDigit(b+k,m<<16|65535&f),e=this.__digit(b+k+1),f=(65535&e)-(l>>>16)-d,d=1&f>>>16}m=a.__digit(k);l=(e>>>16)-(65535&m)-d;d=1&l>>>16,this.__setDigit(b+k,l<<16|65535&f);if(b+k+1>=this.length)throw new RangeError("out of bounds");0==(1&c)&&(e=this.__digit(b+k+1),f=(65535&e)-(m>>>16)-d,d=1&f>>>16,this.__setDigit(b+a.length,4294901760&e|65535&f))}else{b>>=1;for(l=0;l<a.length-1;l++){k=this.__digit(b+l);m=a.__digit(l);e=(65535&k)-(65535&m)-d;d=1&e>>>16;f=(k>>>16)-(m>>>16)-d;d=1&f>>>16,this.__setDigit(b+l,f<<16|65535&e)}k=this.__digit(b+l);m=a.__digit(l);f=(65535&k)-(65535&m)-d;d=1&f>>>16;e=0;0==(1&c)&&(e=(k>>>16)-(m>>>16)-d,d=1&e>>>16),this.__setDigit(b+l,e<<16|65535&f)}return d}},{key:"__inplaceRightShift",value:function(a){if(0!==a){for(var b,c=this.__digit(0)>>>a,d=this.length-1,e=0;e<d;e++)b=this.__digit(e+1),this.__setDigit(e,b<<32-a|c),c=b>>>a;this.__setDigit(d,c)}}},{key:"__digit",value:function(a){return this[a]}},{key:"__unsignedDigit",value:function(a){return this[a]>>>0}},{key:"__setDigit",value:function(a,b){this[a]=0|b}},{key:"__setDigitGrow",value:function(a,b){this[a]=0|b}},{key:"__halfDigitLength",value:function(){var a=this.length;return 65535>=this.__unsignedDigit(a-1)?2*a-1:2*a}},{key:"__halfDigit",value:function(a){return 65535&this[a>>>1]>>>((1&a)<<4)}},{key:"__setHalfDigit",value:function(a,b){var c=a>>>1,d=this.__digit(c);a=1&a?65535&d|b<<16:4294901760&d|65535&b;this.__setDigit(c,a)}}],[{key:"BigInt",value:function(b){var c=Math.floor,d=Number.isFinite;if("number"==typeof b){if(0===b)return g.__zero();if((0|b)===b)return 0>b?g.__oneDigit(-b,!0):g.__oneDigit(b,!1);if(!d(b)||c(b)!==b)throw new RangeError("The number "+b+" cannot be converted to BigInt because it is not an integer");return g.__fromDouble(b)}if("string"==typeof b){d=g.__fromString(b);if(null===d)throw new SyntaxError("Cannot convert "+b+" to a BigInt");return d}if("boolean"==typeof b)return!0===b?g.__oneDigit(1,!1):g.__zero();if("object"===a(b)){if(b.constructor===g)return b;c=g.__toPrimitive(b);return g.BigInt(c)}throw new TypeError("Cannot convert "+b+" to a BigInt")}},{key:"toNumber",value:function(a){var b=a.length;if(0===b)return 0;if(1===b){var c=a.__unsignedDigit(0);return a.sign?-c:c}c=a.__digit(b-1);var d=k(c),e=32*b-d;if(1024<e)return a.sign?-Infinity:1/0;e=e-1;c=c;b=b-1;d=d+1;var f=32===d?0:c<<d;f>>>=12;var h=d-12,i=12<=d?0:c<<20+d;d=20+d;0<h&&0<b&&(b--,c=a.__digit(b),f|=c>>>32-h,i=c<<h,d=h),0<d&&0<b&&(b--,c=a.__digit(b),i|=c>>>32-d,d-=32);h=g.__decideRounding(a,d,b,c);if((1===h||0===h&&1==(1&i))&&(i=i+1>>>0,0===i&&(f++,0!=f>>>20&&(f=0,e++,1023<e))))return a.sign?-Infinity:1/0;d=a.sign?-2147483648:0;return e=e+1023<<20,g.__kBitConversionInts[1]=d|e|f,g.__kBitConversionInts[0]=i,g.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(a){if(0===a.length)return a;var b=a.__copy();return b.sign=!a.sign,b}},{key:"bitwiseNot",value:function(a){return a.sign?g.__absoluteSubOne(a).__trim():g.__absoluteAddOne(a,!0)}},{key:"exponentiate",value:function(a,b){if(b.sign)throw new RangeError("Exponent must be positive");if(0===b.length)return g.__oneDigit(1,!1);if(0===a.length)return a;if(1===a.length&&1===a.__digit(0))return a.sign&&0==(1&b.__digit(0))?g.unaryMinus(a):a;if(1<b.length)throw new RangeError("BigInt too big");b=b.__unsignedDigit(0);if(1===b)return a;if(b>=g.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===a.length&&2===a.__digit(0)){var c=1+(b>>>5),d=a.sign&&0!=(1&b);d=new g(c,d);d.__initializeDigits();var e=1<<(31&b);return d.__setDigit(c-1,e),d}c=null;e=a;for(0!=(1&b)&&(c=a),b>>=1;0!==b;b>>=1)e=g.multiply(e,e),0!=(1&b)&&(null===c?c=e:c=g.multiply(c,e));return c}},{key:"multiply",value:function(a,b){if(0===a.length)return a;if(0===b.length)return b;var c=a.length+b.length;32<=a.__clzmsd()+b.__clzmsd()&&c--;c=new g(c,a.sign!==b.sign);c.__initializeDigits();for(var d=0;d<a.length;d++)g.__multiplyAccumulate(b,a.__digit(d),c,d);return c.__trim()}},{key:"divide",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return g.__zero();var c=a.sign!==b.sign,d=b.__unsignedDigit(0);if(1===b.length&&65535>=d){if(1===d)return c===a.sign?a:g.unaryMinus(a);d=g.__absoluteDivSmall(a,d,null)}else d=g.__absoluteDivLarge(a,b,!0,!1);return d.sign=c,d.__trim()}},{key:"remainder",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return a;var c=b.__unsignedDigit(0);if(1===b.length&&65535>=c){if(1===c)return g.__zero();c=g.__absoluteModSmall(a,c);return 0===c?g.__zero():g.__oneDigit(c,a.sign)}c=g.__absoluteDivLarge(a,b,!1,!0);return c.sign=a.sign,c.__trim()}},{key:"add",value:function(a,b){var c=a.sign;return c===b.sign?g.__absoluteAdd(a,b,c):0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c)}},{key:"subtract",value:function(a,b){var c=a.sign;return c===b.sign?0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c):g.__absoluteAdd(a,b,c)}},{key:"leftShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__rightShiftByAbsolute(a,b):g.__leftShiftByAbsolute(a,b)}},{key:"signedRightShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__leftShiftByAbsolute(a,b):g.__rightShiftByAbsolute(a,b)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(a,b){return 0>g.__compareToBigInt(a,b)}},{key:"lessThanOrEqual",value:function(a,b){return 0>=g.__compareToBigInt(a,b)}},{key:"greaterThan",value:function(a,b){return 0<g.__compareToBigInt(a,b)}},{key:"greaterThanOrEqual",value:function(a,b){return 0<=g.__compareToBigInt(a,b)}},{key:"equal",value:function(a,b){if(a.sign!==b.sign)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a.__digit(c)!==b.__digit(c))return!1;return!0}},{key:"notEqual",value:function(a,b){return!g.equal(a,b)}},{key:"bitwiseAnd",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteAnd(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length)+1;c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return c=g.__absoluteOr(c,d,c),g.__absoluteAddOne(c,!0,c).__trim()}if(a.sign){d=[b,a];a=d[0],b=d[1]}return g.__absoluteAndNot(a,g.__absoluteSubOne(b)).__trim()}},{key:"bitwiseXor",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteXor(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length);c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return g.__absoluteXor(c,d,c).__trim()}d=i(a.length,b.length)+1;if(a.sign){c=[b,a];a=c[0],b=c[1]}c=g.__absoluteSubOne(b,d);return c=g.__absoluteXor(c,a,c),g.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(a,b){var c=i(a.length,b.length);if(!a.sign&&!b.sign)return g.__absoluteOr(a,b).__trim();if(a.sign&&b.sign){var d=g.__absoluteSubOne(a,c),e=g.__absoluteSubOne(b);return d=g.__absoluteAnd(d,e,d),g.__absoluteAddOne(d,!0,d).__trim()}if(a.sign){e=[b,a];a=e[0],b=e[1]}d=g.__absoluteSubOne(b,c);return d=g.__absoluteAndNot(d,a,d),g.__absoluteAddOne(d,!0,d).__trim()}},{key:"asIntN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=b.__unsignedDigit(c-1),e=1<<(31&a-1);if(b.length===c&&d<e)return b;if(!((d&e)===e))return g.__truncateToNBits(a,b);if(!b.sign)return g.__truncateAndSubFromPowerOfTwo(a,b,!0);if(0==(d&e-1)){for(var f=c-2;0<=f;f--)if(0!==b.__digit(f))return g.__truncateAndSubFromPowerOfTwo(a,b,!1);return b.length===c&&d===e?b:g.__truncateToNBits(a,b)}return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}},{key:"asUintN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(b.sign){if(a>g.__kMaxLengthBits)throw new RangeError("BigInt too big");return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=31&a;if(b.length==c){if(0==d)return b;c=b.__digit(c-1);if(0==c>>>d)return b}return g.__truncateToNBits(a,b)}},{key:"ADD",value:function(a,b){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a)return"string"!=typeof b&&(b=b.toString()),a+b;if("string"==typeof b)return a.toString()+b;if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)&&g.__isBigInt(b))return g.add(a,b);if("number"==typeof a&&"number"==typeof b)return a+b;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(a,b){return g.__compare(a,b,0)}},{key:"LE",value:function(a,b){return g.__compare(a,b,1)}},{key:"GT",value:function(a,b){return g.__compare(a,b,2)}},{key:"GE",value:function(a,b){return g.__compare(a,b,3)}},{key:"EQ",value:function(b,c){for(;;){if(g.__isBigInt(b))return g.__isBigInt(c)?g.equal(b,c):g.EQ(c,b);if("number"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("string"==typeof b){if(g.__isBigInt(c))return b=g.__fromString(b),null!==b&&g.equal(b,c);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("boolean"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,+b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("symbol"===a(b)){if(g.__isBigInt(c))return!1;if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("object"===a(b)){if("object"===a(c)&&c.constructor!==g)return b==c;b=g.__toPrimitive(b)}else return b==c}}},{key:"NE",value:function(a,b){return!g.EQ(a,b)}},{key:"__zero",value:function(){return new g(0,!1)}},{key:"__oneDigit",value:function(a,b){b=new g(1,b);return b.__setDigit(0,a),b}},{key:"__decideRounding",value:function(a,b,c,d){if(0<b)return-1;if(0>b)b=-b-1;else{if(0===c)return-1;c--,d=a.__digit(c),b=31}b=1<<b;if(0==(d&b))return-1;if(b-=1,0!=(d&b))return 1;for(;0<c;)if(c--,0!==a.__digit(c))return 1;return 0}},{key:"__fromDouble",value:function(a){g.__kBitConversionDouble[0]=a;var b,c=2047&g.__kBitConversionInts[1]>>>20;c=c-1023;var d=(c>>>5)+1;a=new g(d,0>a);var e=1048575&g.__kBitConversionInts[1]|1048576,f=g.__kBitConversionInts[0],k=20;c=31&c;var n=0;if(c<k){var m=k-c;n=m+32,b=e>>>m,e=e<<32-m|f>>>m,f<<=32-m}else if(c===k)n=32,b=e,e=f;else{m=c-k;n=32-m,b=e<<m|f>>>32-m,e=f<<m}a.__setDigit(d-1,b);for(c=d-2;0<=c;c--)0<n?(n-=32,b=e,e=f):b=0,a.__setDigit(c,b);return a.__trim()}},{key:"__isWhitespace",value:function(a){return!!(13>=a&&9<=a)||(159>=a?32==a:131071>=a?160==a||5760==a:196607>=a?(a&=131071,10>=a||40==a||41==a||47==a||95==a||4096==a):65279==a)}},{key:"__fromString",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=0,d=a.length,e=0;if(e===d)return g.__zero();for(var f=a.charCodeAt(e);g.__isWhitespace(f);){if(++e===d)return g.__zero();f=a.charCodeAt(e)}if(43===f){if(++e===d)return null;f=a.charCodeAt(e),c=1}else if(45===f){if(++e===d)return null;f=a.charCodeAt(e),c=-1}if(0===b){if(b=10,48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(b=16,++e===d)return null;f=a.charCodeAt(e)}else if(79===f||111===f){if(b=8,++e===d)return null;f=a.charCodeAt(e)}else if(66===f||98===f){if(b=2,++e===d)return null;f=a.charCodeAt(e)}}}else if(16===b&&48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(++e===d)return null;f=a.charCodeAt(e)}}for(;48===f;){if(++e===d)return g.__zero();f=a.charCodeAt(e)}var m=d-e,i=g.__kMaxBitsPerChar[b],j=g.__kBitsPerCharTableMultiplier-1;if(m>1073741824/i)return null;var k=i*m+j>>>g.__kBitsPerCharTableShift,l=new g(k+31>>>5,!1),n=10>b?b:10,o=10<b?b-10:0;if(0==(b&b-1)){i>>=g.__kBitsPerCharTableShift;var p=[],q=[],r=!1;do{for(var s,t=0,u=0;;){if(void 0,f-48>>>0<n)s=f-48;else if((32|f)-97>>>0<o)s=(32|f)-87;else{r=!0;break}if(u+=i,t=t<<i|s,++e===d){r=!0;break}if(f=a.charCodeAt(e),32<u+i)break}p.push(t),q.push(u)}while(!r);g.__fillFromParts(l,p,q)}else{l.__initializeDigits();var v=!1,w=0;do{for(var x,y=0,z=1;;){if(void 0,f-48>>>0<n)x=f-48;else if((32|f)-97>>>0<o)x=(32|f)-87;else{v=!0;break}var A=z*b;if(4294967295<A)break;if(z=A,y=y*b+x,w++,++e===d){v=!0;break}f=a.charCodeAt(e)}j=32*g.__kBitsPerCharTableMultiplier-1;var B=i*w+j>>>g.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(z,y,B)}while(!v)}if(e!==d){if(!g.__isWhitespace(f))return null;for(e++;e<d;e++)if(f=a.charCodeAt(e),!g.__isWhitespace(f))return null}return 0!==c&&10!==b?null:(l.sign=-1===c,l.__trim())}},{key:"__fillFromParts",value:function(a,b,c){for(var d=0,e=0,f=0,k=b.length-1;0<=k;k--){var l=b[k],m=c[k];e|=l<<f,f+=m,32===f?(a.__setDigit(d++,e),f=0,e=0):32<f&&(a.__setDigit(d++,e),f-=32,e=l>>>m-f)}if(0!==e){if(d>=a.length)throw new Error("implementation bug");a.__setDigit(d++,e)}for(;d<a.length;d++)a.__setDigit(d,0)}},{key:"__toStringBasePowerOfTwo",value:function(a,b){var c=a.length,d=b-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);d=d;b=b-1;var e=a.__digit(c-1),f=k(e);f=0|(32*c-f+d-1)/d;if(a.sign&&f++,268435456<f)throw new Error("string too long");for(var h=Array(f),f=f-1,l=0,n=0,o=0;o<c-1;o++){var p=a.__digit(o),q=(l|p<<n)&b;h[f--]=g.__kConversionChars[q];q=d-n;for(l=p>>>q,n=32-q;n>=d;)h[f--]=g.__kConversionChars[l&b],l>>>=d,n-=d}p=(l|e<<n)&b;for(h[f--]=g.__kConversionChars[p],l=e>>>d-n;0!==l;)h[f--]=g.__kConversionChars[l&b],l>>>=d;if(a.sign&&(h[f--]="-"),-1!==f)throw new Error("implementation bug");return h.join("")}},{key:"__toStringGeneric",value:function(a,b,c){var d=a.length;if(0===d)return"";if(1===d){var e=a.__unsignedDigit(0).toString(b);return!1===c&&a.sign&&(e="-"+e),e}e=32*d-k(a.__digit(d-1));d=g.__kMaxBitsPerChar[b];d=d-1;e=e*g.__kBitsPerCharTableMultiplier;e+=d-1,e=0|e/d;var f;d=e+1>>1;e=g.exponentiate(g.__oneDigit(b,!1),g.__oneDigit(d,!1));var h=e.__unsignedDigit(0);if(1===e.length&&65535>=h){f=new g(a.length,!1),f.__initializeDigits();for(var i,j=0,l=2*a.length-1;0<=l;l--)i=j<<16|a.__halfDigit(l),f.__setHalfDigit(l,0|i/h),j=0|i%h;i=j.toString(b)}else{h=g.__absoluteDivLarge(a,e,!0,!0);f=h.quotient;l=h.remainder.__trim();i=g.__toStringGeneric(l,b,!0)}f.__trim();for(j=g.__toStringGeneric(f,b,!0);i.length<d;)i="0"+i;return!1===c&&a.sign&&(j="-"+j),j+i}},{key:"__unequalSign",value:function(a){return a?-1:1}},{key:"__absoluteGreater",value:function(a){return a?-1:1}},{key:"__absoluteLess",value:function(a){return a?1:-1}},{key:"__compareToBigInt",value:function(a,b){var c=a.sign;if(c!==b.sign)return g.__unequalSign(c);a=g.__absoluteCompare(a,b);return 0<a?g.__absoluteGreater(c):0>a?g.__absoluteLess(c):0}},{key:"__compareToNumber",value:function(a,b){if(!0|b){var c=a.sign,d=0>b;if(c!==d)return g.__unequalSign(c);if(0===a.length){if(d)throw new Error("implementation bug");return 0===b?0:-1}if(1<a.length)return g.__absoluteGreater(c);d=h(b);var e=a.__unsignedDigit(0);return e>d?g.__absoluteGreater(c):e<d?g.__absoluteLess(c):0}return g.__compareToDouble(a,b)}},{key:"__compareToDouble",value:function(a,b){if(b!==b)return b;if(b===1/0)return-1;if(b===-Infinity)return 1;var c=a.sign;if(c!==0>b)return g.__unequalSign(c);if(0===b)throw new Error("implementation bug: should be handled elsewhere");if(0===a.length)return-1;g.__kBitConversionDouble[0]=b;b=2047&g.__kBitConversionInts[1]>>>20;if(2047==b)throw new Error("implementation bug: handled elsewhere");b=b-1023;if(0>b)return g.__absoluteGreater(c);var d=a.length,e=a.__digit(d-1),f=k(e),l=32*d-f;b=b+1;if(l<b)return g.__absoluteLess(c);if(l>b)return g.__absoluteGreater(c);b=1048576|1048575&g.__kBitConversionInts[1];var m=g.__kBitConversionInts[0],o=20;f=31-f;if(f!==(l-1)%31)throw new Error("implementation bug");var p;l=0;if(f<o){var q=o-f;l=q+32,p=b>>>q,b=b<<32-q|m>>>q,m<<=32-q}else if(f===o)l=32,p=b,b=m;else{q=f-o;l=32-q,p=b<<q|m>>>32-q,b=m<<q}if(e>>>=0,p>>>=0,e>p)return g.__absoluteGreater(c);if(e<p)return g.__absoluteLess(c);for(f=d-2;0<=f;f--){0<l?(l-=32,p=b>>>0,b=m,m=0):p=0;o=a.__unsignedDigit(f);if(o>p)return g.__absoluteGreater(c);if(o<p)return g.__absoluteLess(c)}if(0!==b||0!==m){if(0===l)throw new Error("implementation bug");return g.__absoluteLess(c)}return 0}},{key:"__equalToNumber",value:function(a,b){return b|0===b?0===b?0===a.length:1===a.length&&a.sign===0>b&&a.__unsignedDigit(0)===h(b):0===g.__compareToDouble(a,b)}},{key:"__comparisonResultToBool",value:function(a,b){switch(b){case 0:return 0>a;case 1:return 0>=a;case 2:return 0<a;case 3:return 0<=a}throw new Error("unreachable")}},{key:"__compare",value:function(a,b,c){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a&&"string"==typeof b)switch(c){case 0:return a<b;case 1:return a<=b;case 2:return a>b;case 3:return a>=b}if(g.__isBigInt(a)&&"string"==typeof b)return b=g.__fromString(b),null!==b&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("string"==typeof a&&g.__isBigInt(b))return a=g.__fromString(a),null!==a&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)){if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("number"!=typeof b)throw new Error("implementation bug");return g.__comparisonResultToBool(g.__compareToNumber(a,b),c)}if("number"!=typeof a)throw new Error("implementation bug");if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToNumber(b,a),2^c);if("number"!=typeof b)throw new Error("implementation bug");return 0===c?a<b:1===c?a<=b:2===c?a>b:3===c?a>=b:void 0}},{key:"__absoluteAdd",value:function(a,b,c){if(a.length<b.length)return g.__absoluteAdd(b,a,c);if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);var d=a.length;(0===a.__clzmsd()||b.length===a.length&&0===b.__clzmsd())&&d++;for(var d=new g(d,c),c=0,e=0;e<b.length;e++){var f=b.__digit(e),h=a.__digit(e),m=(65535&h)+(65535&f)+c;h=(h>>>16)+(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}for(;e<a.length;e++){f=a.__digit(e);m=(65535&f)+c;h=(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}return e<d.length&&d.__setDigit(e,c),d.__trim()}},{key:"__absoluteSub",value:function(a,b,c){if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);for(var c=new g(a.length,c),d=0,e=0;e<b.length;e++){var f=a.__digit(e),l=b.__digit(e),m=(65535&f)-(65535&l)-d;d=1&m>>>16;f=(f>>>16)-(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}for(;e<a.length;e++){l=a.__digit(e);m=(65535&l)-d;d=1&m>>>16;f=(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}return c.__trim()}},{key:"__absoluteAddOne",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length;null===c?c=new g(d,b):c.sign=b;for(var e=!0,f=0;f<d;f++){var k=a.__digit(f),l=-1===k;e&&(k=0|k+1),e=l,c.__setDigit(f,k)}return e&&c.__setDigitGrow(d,1),c}},{key:"__absoluteSubOne",value:function(a,b){var c=a.length;b=b||c;for(var d=new g(b,!1),e=!0,f=0;f<c;f++){var k=a.__digit(f),l=0===k;e&&(k=0|k-1),e=l,d.__setDigit(f,k)}for(l=c;l<b;l++)d.__setDigit(l,0);return d}},{key:"__absoluteAnd",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,e,b=m,n}var k=f;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&b.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteAndNot",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;d<e&&(f=d);var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&~b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteOr",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)|b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteXor",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)^b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteCompare",value:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(c=a.length-1;0<=c&&a.__digit(c)===b.__digit(c);)c--;return 0>c?0:a.__unsignedDigit(c)>b.__unsignedDigit(c)?1:-1}},{key:"__multiplyAccumulate",value:function(a,b,c,d){if(0!==b){for(var e=65535&b,b=b>>>16,f=0,g=0,k=0,l=0;l<a.length;l++,d++){var m=c.__digit(d),n=65535&m,o=m>>>16,p=a.__digit(l),q=65535&p;p=p>>>16;var r=j(q,e);q=j(q,b);var s=j(p,e);p=j(p,b);n+=g+(65535&r),o+=k+f+(n>>>16)+(r>>>16)+(65535&q)+(65535&s),f=o>>>16,g=(q>>>16)+(s>>>16)+(65535&p)+f,f=g>>>16,g&=65535,k=p>>>16,m=65535&n|o<<16,c.__setDigit(d,m)}for(;0!==f||0!==g||0!==k;d++){r=c.__digit(d);q=(65535&r)+g;s=(r>>>16)+(q>>>16)+k+f;g=0,k=0,f=s>>>16,r=65535&q|s<<16,c.__setDigit(d,r)}}}},{key:"__internalMultiplyAdd",value:function(a,b,c,d,e){for(var c=c,f=0,h=0;h<d;h++){var l=a.__digit(h),m=j(65535&l,b),n=(65535&m)+f+c;c=n>>>16;l=j(l>>>16,b);m=(65535&l)+(m>>>16)+c;c=m>>>16,f=l>>>16,e.__setDigit(h,m<<16|65535&n)}if(e.length>d)for(e.__setDigit(d++,c+f);d<e.length;)e.__setDigit(d++,0);else if(0!==c+f)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(a,b,c){null===c&&(c=new g(a.length,!1));for(var d=0,e=2*a.length-1;0<=e;e-=2){var f=(d<<16|a.__halfDigit(e))>>>0,k=0|f/b;d=0|f%b,f=(d<<16|a.__halfDigit(e-1))>>>0;var l=0|f/b;d=0|f%b,c.__setDigit(e>>>1,k<<16|l)}return c}},{key:"__absoluteModSmall",value:function(a,b){for(var c,d=0,e=2*a.length-1;0<=e;e--)c=(d<<16|a.__halfDigit(e))>>>0,d=0|c%b;return d}},{key:"__absoluteDivLarge",value:function(a,b,c,d){var f=b.__halfDigitLength(),e=b.length,n=a.__halfDigitLength()-f,i=null;c&&(i=new g(n+2>>>1,!1),i.__initializeDigits());var l=new g(f+2>>>1,!1);l.__initializeDigits();var m=g.__clz16(b.__halfDigit(f-1));0<m&&(b=g.__specialLeftShift(b,m,0));for(var a=g.__specialLeftShift(a,m,1),k=b.__halfDigit(f-1),o=0,n=n;0<=n;n--){var p=65535,q=a.__halfDigit(n+f);if(q!==k){q=(q<<16|a.__halfDigit(n+f-1))>>>0;p=0|q/k;for(var q=0|q%k,r=b.__halfDigit(f-2),s=a.__halfDigit(n+f-2);j(p,r)>>>0>(q<<16|s)>>>0&&(p--,q+=k,!(65535<q)););}g.__internalMultiplyAdd(b,p,0,e,l);r=a.__inplaceSub(l,n,f+1);0!==r&&(r=a.__inplaceAdd(b,n,f),a.__setHalfDigit(n+f,a.__halfDigit(n+f)+r),p--),c&&(1&n?o=p<<16:i.__setDigit(n>>>1,o|p))}return d?(a.__inplaceRightShift(m),c?{quotient:i,remainder:a}:a):c?i:void 0}},{key:"__clz16",value:function(a){return k(a)-16}},{key:"__specialLeftShift",value:function(a,b,c){var e=a.length,d=new g(e+c,!1);if(0===b){for(var f=0;f<e;f++)d.__setDigit(f,a.__digit(f));return 0<c&&d.__setDigit(e,0),d}for(var j,f=0,l=0;l<e;l++)j=a.__digit(l),d.__setDigit(l,j<<b|f),f=j>>>32-b;return 0<c&&d.__setDigit(e,f),d}},{key:"__leftShiftByAbsolute",value:function(a,b){b=g.__toShiftAmount(b);if(0>b)throw new RangeError("BigInt too big");var c=b>>>5;b=31&b;var d=a.length,e=0!==b&&0!=a.__digit(d-1)>>>32-b,f=d+c+(e?1:0),m=new g(f,a.sign);if(0===b){for(var n=0;n<c;n++)m.__setDigit(n,0);for(;n<f;n++)m.__setDigit(n,a.__digit(n-c))}else{for(n=0,f=0;f<c;f++)m.__setDigit(f,0);for(var o,f=0;f<d;f++)o=a.__digit(f),m.__setDigit(f+c,o<<b|n),n=o>>>32-b;if(e)m.__setDigit(d+c,n);else if(0!==n)throw new Error("implementation bug")}return m.__trim()}},{key:"__rightShiftByAbsolute",value:function(a,b){var c=a.length,d=a.sign;b=g.__toShiftAmount(b);if(0>b)return g.__rightShiftByMaximum(d);var e=b>>>5;b=31&b;var f=c-e;if(0>=f)return g.__rightShiftByMaximum(d);var i=!1;if(d)if(0!=(a.__digit(e)&(1<<b)-1))i=!0;else for(var m=0;m<e;m++)if(0!==a.__digit(m)){i=!0;break}if(i&&0===b){m=a.__digit(c-1);0==~m&&f++}m=new g(f,d);if(0===b)for(f=e;f<c;f++)m.__setDigit(f-e,a.__digit(f));else{for(var n,d=a.__digit(e)>>>b,f=c-e-1,c=0;c<f;c++)n=a.__digit(c+e+1),m.__setDigit(c,n<<32-b|d),d=n>>>b;m.__setDigit(f,d)}return i&&(m=g.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(a){return a?g.__oneDigit(1,!0):g.__zero()}},{key:"__toShiftAmount",value:function(a){if(1<a.length)return-1;a=a.__unsignedDigit(0);return a>g.__kMaxLengthBits?-1:a}},{key:"__toPrimitive",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==a(b))return b;if(b.constructor===g)return b;var d=b[Symbol.toPrimitive];if(d){var e=d(c);if("object"!==a(e))return e;throw new TypeError("Cannot convert object to primitive value")}var f=b.valueOf;if(f){var k=f.call(b);if("object"!==a(k))return k}var l=b.toString;if(l){var m=l.call(b);if("object"!==a(m))return m}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(a){return g.__isBigInt(a)?a:+a}},{key:"__isBigInt",value:function(b){return"object"===a(b)&&b.constructor===g}},{key:"__truncateToNBits",value:function(a,b){for(var c=a+31>>>5,d=new g(c,b.sign),c=c-1,e=0;e<c;e++)d.__setDigit(e,b.__digit(e));e=b.__digit(c);if(0!=(31&a)){b=32-(31&a);e=e<<b>>>b}return d.__setDigit(c,e),d.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(a,b,c){for(var d=Math.min,e=a+31>>>5,c=new g(e,c),f=0,e=e-1,h=0,d=d(e,b.length);f<d;f++){var j=b.__digit(f),l=0-(65535&j)-h;h=1&l>>>16;j=0-(j>>>16)-h;h=1&j>>>16,c.__setDigit(f,65535&l|j<<16)}for(;f<e;f++)c.__setDigit(f,0|-h);l=e<b.length?b.__digit(e):0;j=31&a;if(0===j){d=0-(65535&l)-h;h=1&d>>>16;f=0-(l>>>16)-h;b=65535&d|f<<16}else{a=32-j;l=l<<a>>>a;d=1<<32-a;f=(65535&d)-(65535&l)-h;h=1&f>>>16;j=(d>>>16)-(l>>>16)-h;b=65535&f|j<<16,b&=d-1}return c.__setDigit(e,b),c.__trim()}},{key:"__digitPow",value:function(a,b){for(var c=1;0<b;)1&b&&(c*=a),b>>>=1,a*=a;return c}}]),g}(k(Array));return n.__kMaxLength=33554432,n.__kMaxLengthBits=n.__kMaxLength<<5,n.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],n.__kBitsPerCharTableShift=5,n.__kBitsPerCharTableMultiplier=1<<n.__kBitsPerCharTableShift,n.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.__kBitConversionBuffer=new ArrayBuffer(8),n.__kBitConversionDouble=new Float64Array(n.__kBitConversionBuffer),n.__kBitConversionInts=new Int32Array(n.__kBitConversionBuffer),n})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),j=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:i.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:i.CT_BOOLEAN_FALSE}),k=[i.CT_STOP,0,i.CT_BOOLEAN_TRUE,i.CT_BYTE,i.CT_DOUBLE,0,i.CT_I16,0,i.CT_I32,0,i.CT_I64,i.CT_BINARY,i.CT_STRUCT,i.CT_MAP,i.CT_SET,i.CT_LIST,0,0,0,i.CT_FLOAT],l=Math.pow(2,7)-1,m=-1*Math.pow(2,7),n=Math.pow(2,15)-1,o=-1*Math.pow(2,15),p=Math.pow(2,31)-1,q=-1*Math.pow(2,31),r=Math.pow(2,32)-1,s=(a=c("jsbi")).BigInt("9223372036854775807"),t=a.BigInt("-9223372036854775808"),u=a.BigInt("18446744073709551615"),v=a.BigInt(63),w=a.BigInt(1),x=a.BigInt(0),y=a.BigInt(7),z=a.BigInt(70),A=a.BigInt(127),B=a.BigInt(128),C=Math.pow(2,4);b=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var b=a.prototype;b.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};b.readStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};b.writeStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeFieldBegin=function(a){if(a.ftype===(h||(h=c("ThriftTypes"))).BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,j.NONE)};b.writeListBegin=function(a){return this.$8(a)};b.writeListEnd=function(){return 0};b.writeSetBegin=function(a){return this.$8(a)};b.writeSetEnd=function(){return 0};b.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};b.writeMapEnd=function(){return 0};b.$7=function(a,b){var c=0;b=b===j.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=C-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};b.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=C-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};b.readFieldBegin=function(){var a=this.$1.readByte(),b=a&15;if(b===(h||(h=c("ThriftTypes"))).STOP)return{ftype:(h||(h=c("ThriftTypes"))).STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(b);(b===i.CT_BOOLEAN_TRUE||b===i.CT_BOOLEAN_FALSE)&&(this.$5=b===i.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};b.readListBegin=function(){return this.$11()};b.readListEnd=function(){return 0};b.readSetBegin=function(){return this.$11()};b.readSetEnd=function(){return 0};b.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};b.readMapEnd=function(){return 0};b.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};b.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};b.readFieldEnd=function(){return 0};b.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};b.writeByte=function(a){if(a<m||a>l)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};b.readFloat=function(){return this.$1.readFloatBE()};b.writeFloat=function(a){return this.$1.writeFloatBE(a)};b.readDouble=function(){return this.$1.readDoubleBE()};b.writeDouble=function(a){return this.$1.writeDoubleBE(a)};b.writeString=function(a){return this.writeBinary(d("StringToUtf8").StringToUtf8(a))};b.skip=function(a){switch(a){case(h||(h=c("ThriftTypes"))).STOP:return;case(h||(h=c("ThriftTypes"))).BOOL:this.readBool();break;case(h||(h=c("ThriftTypes"))).BYTE:this.readByte();break;case(h||(h=c("ThriftTypes"))).DOUBLE:this.readDouble();break;case(h||(h=c("ThriftTypes"))).I16:this.readI16();break;case(h||(h=c("ThriftTypes"))).I32:this.readI32();break;case(h||(h=c("ThriftTypes"))).I64:this.readI64();break;case(h||(h=c("ThriftTypes"))).STRING:this.readString();break;case(h||(h=c("ThriftTypes"))).STRUCT:this.readStructBegin();var b;while(!0){b=this.readFieldBegin();if(b.ftype===(h||(h=c("ThriftTypes"))).STOP)break;this.skip(b.ftype)}this.readStructEnd();break;case(h||(h=c("ThriftTypes"))).MAP:b=this.readMapBegin();if(b.size>0&&b.ktype!=null&&b.vtype!=null){var d=b.ktype,e=b.vtype;for(var f=0;f<b.size;f++)this.skip(d),this.skip(e)}break;case(h||(h=c("ThriftTypes"))).SET:case(h||(h=c("ThriftTypes"))).LIST:f=this.$11();for(d=0;d<f.size;d++)this.skip(f.etype);break;case(h||(h=c("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};b.toByteArray=function(){return this.$1.toByteArray()};b.writeFieldEnd=function(){return 0};b.writeFieldStop=function(){return this.$1.writeByte((h||(h=c("ThriftTypes"))).STOP)};b.writeI16=function(a){if(a<o||a>n)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<o||a>n)throw new Error("read invalid i16: "+a);return a};b.writeI32=function(a){if(a<q||a>p)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI32=function(){return this.zigzagToI32(this.readVarint32())};b.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};b.readI64=function(){return this.zigzagToI64(this.readVarint64())};b.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===i.CT_BOOLEAN_TRUE;return a};b.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?j.CT_BOOLEAN_TRUE:j.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?i.CT_BOOLEAN_TRUE:i.CT_BOOLEAN_FALSE);return b};b.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};b.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};b.i32ToZigzag=function(a){if(a<q||a>p)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};b.zigzagToI32=function(a){if(a<0||a>r)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};b.i64ToZigzag=function(a){if(c("jsbi").greaterThan(a,s)||c("jsbi").lessThan(a,t))throw new Error("i64 out of range: "+a.toString());return c("jsbi").bitwiseXor(c("jsbi").signedRightShift(a,v),c("jsbi").leftShift(a,w))};b.zigzagToI64=function(a){if(c("jsbi").lessThan(a,0)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());return c("jsbi").equal(c("jsbi").bitwiseAnd(a,w),w)?c("jsbi").bitwiseNot(c("jsbi").signedRightShift(a,w)):c("jsbi").signedRightShift(a,w)};b.writeVarint32=function(a){if(a<0||a>r)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};b.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};b.writeVarint64=function(a){if(c("jsbi").lessThan(a,x)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(c("jsbi").equal(c("jsbi").signedRightShift(a,y),x)){this.$1.writeByte(c("jsbi").toNumber(a));b++;break}else{var d,e=(d=c("jsbi")).toNumber(d.bitwiseOr(d.bitwiseAnd(a,A),B));this.$1.writeByte(e);b++;a=d.signedRightShift(a,y)}return b};b.readVarint64=function(){var a=x,b=x,d;while(!0){var e;d=(e=c("jsbi")).BigInt(this.$1.readByte());a=e.bitwiseOr(a,e.leftShift(e.bitwiseAnd(d,A),b));b=e.add(b,y);if(c("jsbi").equal(c("jsbi").bitwiseAnd(d,B),x)){if(c("jsbi").equal(b,z)&&c("jsbi").notEqual(d,w))throw new Error("result exceeded 64 bit limit");break}if(c("jsbi").greaterThan(b,v))throw new Error("result exceeded 64 bit limit")}return a};b.readString=function(){return d("Utf8ToString").Utf8ToString(this.readBinary())};b.getLastFieldId=function(){return this.$3};b.getLastField=function(){return this.$2};b.getBooleanFieldInfo=function(){return this.$4};b.getBooleanValue=function(){return this.$5};b.$9=function(a){return k[a]};b.$10=function(a){switch(a){case i.CT_STOP:return(h||(h=c("ThriftTypes"))).STOP;case i.CT_BOOLEAN_FALSE:case i.CT_BOOLEAN_TRUE:return(h||(h=c("ThriftTypes"))).BOOL;case i.CT_BYTE:return(h||(h=c("ThriftTypes"))).BYTE;case i.CT_I16:return(h||(h=c("ThriftTypes"))).I16;case i.CT_I32:return(h||(h=c("ThriftTypes"))).I32;case i.CT_I64:return(h||(h=c("ThriftTypes"))).I64;case i.CT_DOUBLE:return(h||(h=c("ThriftTypes"))).DOUBLE;case i.CT_FLOAT:return(h||(h=c("ThriftTypes"))).FLOAT;case i.CT_BINARY:return(h||(h=c("ThriftTypes"))).STRING;case i.CT_LIST:return(h||(h=c("ThriftTypes"))).LIST;case i.CT_SET:return(h||(h=c("ThriftTypes"))).SET;case i.CT_MAP:return(h||(h=c("ThriftTypes"))).MAP;case i.CT_STRUCT:return(h||(h=c("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}};return a}();g["default"]=b}),98);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocolPolyfill"))(a);return b(a)}function a(a,b,c){try{return h(a,b)}catch(a){c!=null&&c(a)}return null}function i(a,b,d){d===void 0&&(d=!1);if(d){d=new(c("TNoOpWriteBuffer"))();var e=new(c("TCompactProtocolPolyfill"))(d);b(a,e);e=new(c("TWriteBuffer"))(d.currentSize())}else e=new(c("TWriteBuffer"))();d=new(c("TCompactProtocolPolyfill"))(e);b(a,d);return d.toByteArray()}function b(a,b,c,d){c===void 0&&(c=!1);try{return i(a,b,c)}catch(a){d!=null&&d(a)}return null}g.deserialize=h;g.deserializeNoThrow=a;g.serialize=i;g.serializeNoThrow=b}),98);
__d("ContextualConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a=1e3;b=", ";c={SAME:"same",NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"};d={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"};e=[];var g=[],h=[],i={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},j=10,k=", ",l={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};f.ANALYTICS_SAMPLE_RATE=a;f.BUCKET_DELIMITER=b;f.CONTEXT_BUCKET_STRATEGY=c;f.CONFIG_TYPE=d;f.EMPTY_RESOLVED_CONTEXTS=e;f.EMPTY_RESOLVED_MONITORS=g;f.EMPTY_RESULT_PARAMS=h;f.ERROR=i;f.JSON_SUB_SAMPLE_RATE=j;f.LIST_DELIMITER=k;f.TYPE=l}),66);
__d("ContextualConfigResolvedContextsUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.bucketIndex;if(e==void 0)break;b.push(e)}return b};b=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.bucketName;if(e===void 0)break;b.push(e)}return b};var g=function(a){return a.name};c=function(a){return a.map(g)};d=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.value;if(e===void 0)break;b.push(e)}return b};f.getBucketIndices=a;f.getBucketNames=b;f.getContextNames=c;f.getContextValues=d}),66);
__d("ContextualConfigCollateExposureData",["ContextualConfigConstants","ContextualConfigResolvedContextsUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=["cfg_ver_timestamp","policy_id","version","sample_rate"],i=function(a){return a.join(d("ContextualConfigConstants").LIST_DELIMITER)},j=function(a,b){for(var c=0;c<h.length;c++){var d=h[c];b[d]!=null&&(a[d]=b[d])}b.name&&(a.config_name=b.name)},k=function(a,b){var c=b[0],e=b[1],f=b[2];b=b[3];c!=null&&(a.exception=c.message);a.result=i(e.map(function(a){return a.value}))||"INVALID";a.context=i(d("ContextualConfigResolvedContextsUtils").getContextNames(f));a.context_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(f));a.bucket_name=i(d("ContextualConfigResolvedContextsUtils").getBucketNames(f));a.monitor=i(d("ContextualConfigResolvedContextsUtils").getContextNames(b));a.monitor_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(b))};function a(a,b,c){var e={sample_rate:d("ContextualConfigConstants").ANALYTICS_SAMPLE_RATE};j(e,a);k(e,b);c&&(e.config_contents=JSON.stringify(a));return e}g["default"]=a}),98);
__d("ContextualConfigExposureEvent",["Random"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$2=a,this.$4=d("Random").random()<1/a.sample_rate,this.$3=b,this.$1=c}var b=a.prototype;b.getData=function(){return this.$2};b.log=function(a){var b=this.$2,c=this.$3,d=this.$4;a&&c(b);d&&this.$1(b);return this};b.isSampled=function(){return this.$4};return a}();g["default"]=a}),98);
__d("ContextualConfigExposureLoggerFactory",["ContextualConfigExposureEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b){this.$2=a,this.$1=b}var b=a.prototype;b.createEvent=function(a){var b=this.$1,d=this.$2;a=new(c("ContextualConfigExposureEvent"))(a,d,b);return a};return a}();function a(a,b){return new h(a,b)}g["default"]=a}),98);
__d("MarauderLogger",["Banzai","CacheStorage","MarauderConfig"],(function(a,b,c,d,e,f){var g="client_event",h="navigation",i=18e4,j="marauder",k="marauder_last_event_time",l="marauder_last_session_id",m={},n=[],o=!1,p=null,q=null,r=null,s=0,t,u,v=!1,w=null;function a(){F().set(k,x())}b("Banzai").subscribe(b("Banzai").SHUTDOWN,a);function x(){t=t||F().get(k)||0;return t}function y(){v||(u=F().get(l),v=!0);var a=Date.now();(!u||a-i>x())&&(u=a.toString(16)+"-"+(~~(Math.random()*16777215)).toString(16),F().set(l,u));return u}function z(){return{user_agent:window.navigator.userAgent,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,density:window.screen.devicePixelRatio||null,platform:window.navigator.platform||null,locale:window.navigator.language||null}}function A(){return{locale:navigator.language}}function B(a,b,c,d,e,f,g){var h=g!=null&&g!=0?g:Date.now();t=g!=null&&g!=0?Date.now():h;g=b!=null&&b!=""?b:p;return{name:a,time:h/1e3,module:g,obj_type:d,obj_id:e,uuid:f,extra:c}}function C(a,b,c){return B("content",null,{flags:b},null,null,a,c)}function D(a){var b=window.__mrdr;if(b)for(var c in b){var d=b[c];if(d[3]!==0){delete b[c];if(c==="1")if(r!==null)c=r;else continue;a.push(C(c,1,d[1]));a.push(C(c,2,d[2]));a.push(C(c,3,d[3]))}}}function E(a,c){D(a);if(a.length===0)return;o&&a.push(B("counters",null,m));var d=b("Banzai").BASIC;c==="vital"&&(d=b("Banzai").VITAL);var e=b("MarauderConfig").gk_enabled;s===0&&e&&(a.push(B("device_status",null,A())),d={delay:5e3});c==="signal"&&(d={signal:!0});e&&Math.random()<.01&&a.push(B("device_info",null,z()));if(r!==null)for(c=0;c<a.length;c++){e=a[c];(e.uuid===null||e.uuid===void 0)&&(e.uuid=r)}e={app_ver:b("MarauderConfig").app_version,data:a,device_id:void 0,log_type:g,seq:s++,session_id:y()};c=F().get("device_id");c&&(e.device_id=c);m={};o=!1;b("Banzai").post(j,e,d)}function F(){w||(w=new(b("CacheStorage"))("localstorage",""));return w}function c(a){m[a]||(m[a]=0),m[a]++,o=!0}function G(b,a,c,d,f,g,h,i){E([B(b,a,c,d,f,g,h)],i)}function H(a,b){p!==b&&(n.push(B(h,p,{dest_module:b,source_url:q,destination_url:a})),p=b,q=a)}function d(a,b){p!==b&&(r=null,H(a,b))}function f(a,b,c){G(b?"show_module":"hide_module",a,c)}function I(a){p=a}function J(){return p}function K(a){r===null&&(r=a,a!==null&&(E(n),n=[]))}e.exports={count:c,log:G,navigateTo:d,navigateWithinSession:H,toggleModule:f,setUUID:K,setNavigationModule:I,getNavigationModule:J}}),null);
__d("ContextualConfigExposureLogger",["ContextualConfigExposureLoggerFactory","MarauderLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){};b=function(a){d("MarauderLogger").log("contextual_config_exposure","",a)};e=c("ContextualConfigExposureLoggerFactory")(a,b);g["default"]=e}),98);
__d("ContextualConfigAssert",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a===!1)throw new Error(b)}f["default"]=a}),66);
__d("ContextualConfigValidators",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return Array.isArray(a)};b=function(a){return typeof a==="boolean"};c=function(a){return a!=null};e=function(a){return function(b){return Object.prototype.hasOwnProperty.call(a,b)}};f=function(a){return i(a)&&a%1===0};var h=function(a){return j(a)&&a.length>0},i=function(a){return typeof a==="number"&&!isNaN(a)&&a!==Infinity&&a!==-Infinity},j=function(a){return typeof a==="string"},k=function(a){switch(a){case d("ContextualConfigConstants").TYPE.BOOL:case d("ContextualConfigConstants").TYPE.FLOAT:case d("ContextualConfigConstants").TYPE.INT:case d("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};g.isArray=a;g.isBoolean=b;g.isDefined=c;g.isKey=e;g.isInteger=f;g.isNonEmptyString=h;g.isNumber=i;g.isString=j;g.isType=k}),98);
__d("ContextualConfigParseBoolean",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.toUpperCase()){case"TRUE":return!0;case"FALSE":return!1;default:throw new Error(d("ContextualConfigConstants").ERROR.BAD_BOOLEAN_FORMAT)}}g["default"]=a}),98);
__d("ContextualConfigParsePredBoolean",["ContextualConfigConstants","ContextualConfigParseBoolean"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var f=c("ContextualConfigParseBoolean")(a);e=function(a){return a===f};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:e=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:e=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:e=function(a){return!0};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_BOOLEAN_STRATEGY)}return function(a){return e(a)}}g["default"]=a}),98);
__d("ContextualConfigParseFloat",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)(\.\d+)?$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseFloat(a);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigParseInteger",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseInt(a,10);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigPredAssertions",["ContextualConfigAssert","ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){return(h||(h=c("ContextualConfigAssert")))(a>0,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};b=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};e=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a<b,d("ContextualConfigConstants").ERROR.BAD_VALUE_ORDER)};g.assertHasValues=a;g.assertNumberOfValues=b;g.assertValueOrder=e}),98);
__d("ContextualConfigParsePredNumeric",["ContextualConfigConstants","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigPredAssertions","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f){var g=e.map(f?c("ContextualConfigParseInteger"):h||(h=c("ContextualConfigParseFloat"))),i;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var j=f?c("ContextualConfigParseInteger")(a):(h||(h=c("ContextualConfigParseFloat")))(a);i=function(a){return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===j};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:i=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:i=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:i=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.COR:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,2);d("ContextualConfigPredAssertions").assertValueOrder(g[0],g[1]);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]&&a<g[1]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<=g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.EQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NEQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a!==g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_NUMERIC_STRATEGY)}return function(a){return i(a)}}g["default"]=a}),98);
__d("ContextualConfigParseRegExp",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=/^\/(.+)\/(.*)$/;function a(a){try{var b=a.match(h);if(b!=null)return new RegExp(b[1],b[2]);else return new RegExp(a)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.REGEX_SYNTAX_ERROR)}}g["default"]=a}),98);
__d("ContextualConfigParsePredString",["ContextualConfigConstants","ContextualConfigParseRegExp","ContextualConfigPredAssertions"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){if(typeof a!=="string")throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE);return a},i=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;b.push(h(e))}return b};function a(a,b,e){var f=i(e),g;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:g=function(b){return typeof b!=="string"?!1:b===a};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:g=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:g=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:g=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.IN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NIN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)===-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CONTAINS:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);g=function(a){return typeof a!=="string"?!1:a.indexOf(f[0])!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.REGEX:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);var h=c("ContextualConfigParseRegExp")(f[0]);g=function(a){return typeof a!=="string"?!1:h.test(a)};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_STRING_STRATEGY)}return function(a){return g(a)}}g["default"]=a}),98);
__d("ContextualConfigParseContextBuckets",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParsePredBoolean","ContextualConfigParsePredNumeric","ContextualConfigParsePredString","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},k=d("ContextualConfigValidators").isKey(d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY),l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a)&&k(a.toUpperCase()),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_STRATEGY)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.ILLEGAL_BUCKET_VALUES)},n=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_NAME)},o=function(a,b){var e=b.name;n(e);var f=b.strategy;l(f);b=b.values||[];m(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParsePredBoolean")(e,f);case d("ContextualConfigConstants").TYPE.FLOAT:return c("ContextualConfigParsePredNumeric")(e,f,b,!1);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParsePredNumeric")(e,f,b,!0);case d("ContextualConfigConstants").TYPE.STRING:return c("ContextualConfigParsePredString")(e,f,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_BUCKET_DEFINITION)}},p=function(a,b){i(b);var c=b.name;n(c);return{name:c,pred:o(a,b)}};function a(a,b){j(b);return b.map(function(b){return p(a,b)})}g["default"]=a}),98);
__d("ContextualConfigParseContexts",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContextBuckets","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a)&&a.length>0,d("ContextualConfigConstants").ERROR.MISSING_CONTEXT_IN_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name,d=a.type;a=a.buckets;k(b);l(d);return{name:b,type:d,buckets:c("ContextualConfigParseContextBuckets")(d,a)}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigIsEqualParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c+=1){var d=a[c],e=b[c];if(d.name!==e.name||d.type!==e.type)return!1}return!0}f["default"]=a}),66);
__d("ContextualConfigParseResultParamValue",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseBoolean","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a),d("ContextualConfigConstants").ERROR.INVALID_STRING)};function a(a,b){j(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParseBoolean")(b);case d("ContextualConfigConstants").TYPE.FLOAT:return(i||(i=c("ContextualConfigParseFloat")))(b);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParseInteger")(b);case d("ContextualConfigConstants").TYPE.STRING:return b;default:throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigParseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_RESULTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},n=function(a,b){for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(f.name===b)return f.type}throw new Error(d("ContextualConfigConstants").ERROR.UNDECLARED_OUTPUT_PARAM)},o=function(a){return function(b){k(b);var d=b.name;l(d);var e=n(a,d);m(e);b=(i||(i=c("ContextualConfigParseResultParamValue")))(e,b.value);return{name:d,type:e,value:b}}};function a(a,b){j(b);return b.map(o(a))}g["default"]=a}),98);
__d("ContextualConfigParseDenseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b.map(function(b,c){return{name:a[c].name,value:b}}));i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseDenseDefaults",["ContextualConfigConstants","ContextualConfigParseDenseResultParams"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{return c("ContextualConfigParseDenseResultParams")(a,b)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)}}g["default"]=a}),98);
__d("ContextualConfigParseMonitors",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.BAD_MONITORED_CONTEXTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name;a=a.type;k(b);l(a);return{name:b,type:a}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigParseOutputParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_OUTPUTS_DEFINITION)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_TYPE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_NAME)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(m(a),d("ContextualConfigConstants").ERROR.DUPLICATE_OUTPUT_NAME)},m=function(a){var b={};for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(b[e.name])return!1;b[e.name]=!0}return!0},n=function(a){k(a.name);j(a.type);return a};function a(a){i(a);a=a.map(n);l(a);return a}g["default"]=a}),98);
__d("ContextualConfigParseVector",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_VECTOR)},k=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)},l=function(a,b){k(a.length,b.length);for(var d=0;d<a.length;d+=1){var e=a[d].type,f=b[d];(i||(i=c("ContextualConfigParseResultParamValue")))(e,f)}},m=function(a){return a.reduce(function(a,b){b=b.buckets;return a*b.length},1)};function a(a,b,c){j(c);b=m(b);var d=a.length;k(b*d,c.length);for(var e=0;e<b;e+=1){var f=e*d;l(a,c.slice(f,f+d))}return c}g["default"]=a}),98);
__d("ContextualConfigResolveContexts",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){for(var c=0;c<a.length;c+=1){var d=a[c];try{if(d.pred(b))return[d.name,c]}catch(a){return null}}return null};function a(a,b,c){var e=null;a=a.map(function(a){var f=a.name,g={name:f};if(e!=null)return g;var i;c[f]!=null?i=c[f]:b[f]!=null?i=b[f]():i=null;g.value=i;if(a.buckets!=null){f=h(a.buckets,i);if(f==null){e=new Error(d("ContextualConfigConstants").ERROR.MISSING_BUCKET_MATCH);return g}a=f[0];i=f[1];g.bucketName=a;g.bucketIndex=i}return g});return[e,a]}g["default"]=a}),98);
__d("DenseContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContexts","ContextualConfigParseDenseDefaults","ContextualConfigParseDenseResultParams","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseVector","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},j=function(a){var b=[],c=1;for(var d=a.length-1;d>=0;d-=1)b.push(c),c*=a[d].buckets.length;return b.reverse()},k=function(a,b,d,e){try{b=b.slice(d,d+a.length);return[null,c("ContextualConfigParseDenseResultParams")(a,b)]}catch(a){return[a,e]}},l=function(a,b,d){try{d=d.reduce(function(b,d,e){(h||(h=c("ContextualConfigAssert")))(e<a.length,"Auxillery index out of range.");return b+a[e]*d},0);return[null,d*b]}catch(a){return[a,-1]}};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);var d=c("ContextualConfigParseContexts")(a.contexts);this.aux=j(d);this.contexts=d;this.defaults=c("ContextualConfigParseDenseDefaults")(b,a.vectorDefaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.outputs=b;this.vector=c("ContextualConfigParseVector")(b,d,a.vector)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.aux,e=this.globalContextProviders,f=this.contexts,g=this.defaults,h=this.monitors,i=this.outputs,j=this.vector;f=c("ContextualConfigResolveContexts")(f,e,a);var m=f[0];f=f[1];if(m!=null)return[m,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=l(b,i.length,d("ContextualConfigResolvedContextsUtils").getBucketIndices(f));b=m[0];m=m[1];if(b!=null)return[b,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];b=k(i,j,m,g);i=b[0];j=b[1];if(i!=null)return[i,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=c("ContextualConfigResolveContexts")(h,e,a);g=m[0];b=m[1];return g!=null?[g,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,j,f,b]};return a}();g["default"]=a}),98);
__d("MultiOutputResolvedContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseResultParams","ContextualConfigResolveContexts","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.values=c("ContextualConfigParseResultParams")(b,a.values)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.values,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.monitors,f=this.values;e=c("ContextualConfigResolveContexts")(e,b,a);b=e[0];a=e[1];return b!=null?[b,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,a]};return a}();g["default"]=a}),98);
__d("ContextualConfigMergePartialResultParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;c[f.name]=f}f=[];for(e=a,d=Array.isArray(e),b=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(b>=e.length)break;a=e[b++]}else{b=e.next();if(b.done)break;a=b.value}a=a;var g=c[a.name];f.push(g!=null&&g.name===a.name&&g.type===a.type?g:a)}return f}f["default"]=a}),66);
__d("ContextualConfigParseDefaults",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b);i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseTable",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParams","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_BUCKET)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_VALUES)},m=function(a,b){j(b);var d=b.bucket;b=b.values;k(d);l(b);return{bucket:d,values:c("ContextualConfigParseResultParams")(a,b)}};function a(a,b){i(b);return b.reduce(function(b,c){c=m(a,c);b[c.bucket]=c.values;return b},{})}g["default"]=a}),98);
__d("TableContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigMergePartialResultParams","ContextualConfigParseContexts","ContextualConfigParseDefaults","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseTable","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){j(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.contexts=c("ContextualConfigParseContexts")(a.contexts);this.defaults=c("ContextualConfigParseDefaults")(b,a.defaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.table=c("ContextualConfigParseTable")(b,a.table)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.contexts,f=this.defaults,g=this.monitors,h=this.table;e=c("ContextualConfigResolveContexts")(e,b,a);var j=e[0];e=e[1];if(j!=null)return[j,f,e,[]];j=d("ContextualConfigResolvedContextsUtils").getBucketNames(e).join(d("ContextualConfigConstants").BUCKET_DELIMITER);h=h[j]||i;j=c("ContextualConfigMergePartialResultParams")(f,h);f=c("ContextualConfigResolveContexts")(g,b,a);h=f[0];g=f[1];return h!=null?[h,j,e,[]]:[null,j,e,g]};return a}();g["default"]=a}),98);
__d("ContextualConfigParseConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators","DenseContextualConfig","MultiOutputResolvedContextualConfig","TableContextualConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[1],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a)&&d("ContextualConfigValidators").isDefined(a.version),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(i.indexOf(a)!==-1,d("ContextualConfigConstants").ERROR.UNSUPPORTED_CONFIG_VERSION)};function a(a,b){j(a);k(a.version);switch(a.cctype){case d("ContextualConfigConstants").CONFIG_TYPE.DENSE:return new(c("DenseContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.MULTI_OUTPUT_RESOLVED:return new(c("MultiOutputResolvedContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.TABLE:return new(c("TableContextualConfig"))(a,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_CONFIG_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigWarn",[],(function(a,b,c,d,e,f){"use strict";function a(a){}f["default"]=a}),66);
__d("ContextualConfigResult",["ContextualConfigConstants","ContextualConfigWarn"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a.reduce(function(a,b){var c=b.name;b=b.value;a[c]=b;return a},{}),this.$2=a}var b=a.prototype;b.get=function(a,b){try{a=this.$1[a];if(typeof a!==typeof b){c("ContextualConfigWarn")(d("ContextualConfigConstants").ERROR.REQUESTED_PARAM_NOT_FOUND);return b}return a}catch(a){c("ContextualConfigWarn")(a.message);return b}};b.getParams=function(){return this.$2};return a}();g["default"]=a}),98);
__d("ErrorContextualConfig",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.error=a}var b=a.prototype;b.resolve=function(a){return[this.error,d("ContextualConfigConstants").EMPTY_RESULT_PARAMS,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]};return a}();g["default"]=a}),98);
__d("ContextualConfig",["ContextualConfigCollateExposureData","ContextualConfigConstants","ContextualConfigExposureLogger","ContextualConfigParseConfig","ContextualConfigResult","ErrorContextualConfig","Random"],(function(a,b,c,d,e,f,g){"use strict";var h=1/d("ContextualConfigConstants").JSON_SUB_SAMPLE_RATE,i=1;a=function(){function a(a,b){b===void 0&&(b={}),this.isDebugLoggingEnabled=!1,this.$3=!1,this.$4=a,this.$2=b}var b=a.prototype;b.$5=function(){if(this.$1)return this.$1;var a=this.$2,b=this.$4;try{b=c("ContextualConfigParseConfig")(b,a)}catch(a){b=new(c("ErrorContextualConfig"))(a)}this.$1=b;return b};b.$6=function(a){var b=this.isDebugLoggingEnabled,e=this.$4,f=this.$3;f=!f&&d("Random").random()<h;f&&(this.$3=!0);e=c("ContextualConfigCollateExposureData")(e,a,f);a=c("ContextualConfigExposureLogger").createEvent(e);a.log(b)};b.resolve=function(a){a===void 0&&(a={});var b=this.$1||this.$5();b=b.resolve(a);this.$6(b);return new(c("ContextualConfigResult"))(b[i])};return a}();g["default"]=a}),98);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1755537");b=d("FalcoLoggerInternal").create("dgw_client",a);e=b;g["default"]=e}),98);
__d("DGWLoggingContext",["$InternalEnum","DgwClientFalcoEvent","ODS","Random"],(function(a,b,c,d,e,f,g){"use strict";var h;a="dgw_client";var i=b("$InternalEnum")({STREAM_GROUP_COMPONENT:"WebStreamGroup",GROUPED_STREAM_COMPONENT:"GroupedWebStream",WEBSOCKET_TRANSPORT_COMPONENT:"WebSocketTransport",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec",RAW_CLIENT:"RAWDGWClient",PINGER:"DGWPinger"}),j={VERBOSE:-1,INFO:0,WARNING:1,ERROR:2,FATAL:3};function k(a){switch(a){case i.GROUPED_STREAM_COMPONENT:case i.ACK_MANAGER_COMPONENT:return!0;default:return!1}}e=function(){function a(a,b,c,d,e,f,g){f===void 0&&(f=!1),g===void 0&&(g=!1),this.$5=""+a,this.$1=b,this.$4=c,this.$3=d,this.$6=e,this.$2=f,this.$7=g}a.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};var b=a.prototype;b.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=this.$4+"."+a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};b.logEvent=function(a,b,c,d,e){d===void 0&&(d=!1),this.$2||this.$8(a,b,null,j.INFO,c,d,e)};b.$8=function(a,b,d,e,f,g,h){var i=this;g===void 0&&(g=!1);if(g&&!this.$7)return;(k(a)&&this.$1!=null||!k(a)&&this.$6!=null)&&c("DgwClientFalcoEvent").log(function(){var c;return{event:b,logging_id:(c=h)!=null?c:i.$1,dgw_version:i.$5,message:d,severity:e,uuid:i.$3,dgw_component:a,extra_info:f,destination_tier:i.$4,sg_transport_id:i.$6,source:2}})};b.logError=function(a,b,c,d,e,f){e===void 0&&(e=!1),this.$2||this.$8(a,b,c,j.ERROR,d,e,f)};b.logWarn=function(a,b,c,d,e){e===void 0&&(e=!1),this.$2||this.$8(a,b,c,j.WARNING,d,e)};return a}();g.DGW_MODULE=a;g.DGWLoggingComponent=i;g.DGWLoggingContext=e}),98);
__d("DGWAckManager",["DGWLoggingContext","Promise","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){var b=a.prototype;b.stopTracking=function(a){window.clearTimeout(this.$1),this.$3(a)};function a(a,b,c){var d=this;this.$3=c;this.sendId=a;this.$2=b;this.handleAckReceived=function(){d.stopTracking(!0)};this.$1=window.setTimeout(function(){d.stopTracking(!1)},b)}return a}();a=function(){function a(a){this.$1=new Map(),this.$2=a}var c=a.prototype;c.waitForAck=function(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_expected");e=this.$1;g.prev=2;g.next=5;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,d){e.set(a,new i(a,c,b))}));case 5:f=g.sent;f===!0?this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId:"+a,!0):(this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_timeout"),this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+a+" timed out after "+c+"ms"));e["delete"](a);return g.abrupt("return",f);case 11:g.prev=11;g.t0=g["catch"](2);this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_error");e["delete"](a);throw g.t0;case 16:case"end":return g.stop()}},null,this,[[2,11]])};c.handleAckReceived=function(a){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received");var b=this.$1.get(a);if(b===void 0){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received.not_tracked");this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+a+" which was not being tracked");return}b.handleAckReceived()};c.clearPendingAcks=function(){var a=this;this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending acks","ACKs cleared size: "+this.$1.size);this.$1.forEach(function(b,c,e){a.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+b.sendId,null,!0),b.stopTracking(!1),e["delete"](c)})};return a}();g.DGWAckManager=a}),98);
__d("DGWAuth",["$InternalEnum","err"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({TEST:"0:0",FACEBOOK:"1:0",INTERNALFB:"2:0",OCULUS:"3:0",ENTERPRISEFB:"7:0",RECRUITINGFB:"8:0",INSTAGRAM:"6:0",HORIZON_WEB:"12:0",SPARK_WEB:"13:0",ABRA:"15:0"});function a(a){if(a==="TEST")return h.TEST;else if(a==="FACEBOOK")return h.FACEBOOK;else if(a==="INTERNALFB")return h.INTERNALFB;else if(a==="OCULUS")return h.OCULUS;else if(a==="ENTERPRISEFB")return h.ENTERPRISEFB;else if(a==="RECRUITINGFB")return h.RECRUITINGFB;else if(a==="INSTAGRAM")return h.INSTAGRAM;else if(a==="HORIZON_WEB")return h.HORIZON_WEB;else if(a==="SPARK_WEB")return h.SPARK_WEB;else if(a==="ABRA")return h.ABRA;else throw c("err")("failed to convert string ("+a+") to DGWAuth Type")}function d(a){if(a===h.FACEBOOK)return"FACEBOOK";else if(a===h.INTERNALFB)return"INTERNALFB";else if(a===h.OCULUS)return"OCULUS";else if(a===h.ENTERPRISEFB)return"ENTERPRISEFB";else if(a===h.RECRUITINGFB)return"RECRUITINGFB";else if(a===h.INSTAGRAM)return"INSTAGRAM";else if(a===h.HORIZON_WEB)return"HORIZON_WEB";else if(a===h.SPARK_WEB)return"SPARK_WEB";else if(a===h.ABRA)return"ABRA";else return"TEST"}g.DGWAuth=h;g.fromStringToDGWAuth=a;g.fromDGWAuthToString=d}),98);
__d("DGWStream",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["ABNORMAL_CLOSURE","GOING_AWAY","SERVER_INTERNAL_ERROR","PREMATURE_CLOSE","UNKNOWN_ERROR","KEEPALIVE_TIMEOUT","TRANSPORT_CLOSED_BEFORE_STREAM_INIT","ESTABLISHMENT_TIMEOUT","UNAUTHENTICATED","UNAUTHORIZED","REJECTED","BAD_REQUEST","DGW_SERVER_ERROR","ESTABLISHMENT_ERROR"]);function a(a){switch(a){case g.UNAUTHENTICATED:case g.UNAUTHORIZED:case g.REJECTED:case g.BAD_REQUEST:case g.UNKNOWN_ERROR:case g.SERVER_INTERNAL_ERROR:return!1;default:return!0}}f.StreamError=g;f.isRetryableError=a}),66);
__d("DGWCppBridge",[],(function(l,m,n,o,p,q){var r=function(){var l=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(m){m=m||{};var m=typeof m!=="undefined"?m:{},n=function(){function m(){}function n(l,m){return function(){l.apply(m,arguments)}}function l(m){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if(typeof m!=="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];t(m,this)}function o(m,n){while(m._state===3)m=m._value;if(m._state===0){m._deferreds.push(n);return}m._handled=!0;l._immediateFn(function(){var l=m._state===1?n.onFulfilled:n.onRejected;if(l===null){(m._state===1?p:q)(n.promise,m._value);return}var o;try{o=l(m._value)}catch(l){q(n.promise,l);return}p(n.promise,o)})}function p(m,o){try{if(o===m)throw new TypeError("A promise cannot be resolved with itself.");if(o&&(typeof o==="object"||typeof o==="function")){var p=o.then;if(o instanceof l){m._state=3;m._value=o;r(m);return}else if(typeof p==="function"){t(n(p,o),m);return}}m._state=1;m._value=o;r(m)}catch(l){q(m,l)}}function q(l,m){l._state=2,l._value=m,r(l)}function r(m){m._state===2&&m._deferreds.length===0&&l._immediateFn(function(){m._handled||l._unhandledRejectionFn(m._value)});for(var n=0,p=m._deferreds.length;n<p;n++)o(m,m._deferreds[n]);m._deferreds=null}function s(l,m,n){this.onFulfilled=typeof l==="function"?l:null,this.onRejected=typeof m==="function"?m:null,this.promise=n}function t(l,m){var n=!1;try{l(function(l){if(n)return;n=!0;p(m,l)},function(l){if(n)return;n=!0;q(m,l)})}catch(l){if(n)return;n=!0;q(m,l)}}l.prototype["catch"]=function(l){return this.then(null,l)};l.prototype.then=function(l,n){var p=new this.constructor(m);o(this,new s(l,n,p));return p};l.all=function(m){return new l(function(l,n){if(!Array.isArray(m))return n(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(m);if(o.length===0)return l([]);var p=o.length;function q(m,r){try{if(r&&(typeof r==="object"||typeof r==="function")){var s=r.then;if(typeof s==="function"){s.call(r,function(l){q(m,l)},n);return}}o[m]=r;--p===0&&l(o)}catch(l){n(l)}}for(var r=0;r<o.length;r++)q(r,o[r])})};l.resolve=function(m){return m&&typeof m==="object"&&m.constructor===l?m:new l(function(l){l(m)})};l.reject=function(m){return new l(function(l,n){n(m)})};l.race=function(m){return new l(function(n,o){if(!Array.isArray(m))return o(new TypeError("Promise.race accepts an array"));for(var p=0,q=m.length;p<q;p++)l.resolve(m[p]).then(n,o)})};l._immediateFn=typeof setImmediate==="function"&&function(l){setImmediate(l)}||function(l){setTimeout(l,0)};l._unhandledRejectionFn=function(l){typeof console!=="undefined"&&console};return l}(),o,s;m.ready=new n(function(l,m){o=l,s=m});var t={},u;for(u in m)Object.prototype.hasOwnProperty.call(m,u)&&(t[u]=m[u]);var v=[];(function(l,m){throw m});var w=!0,x=!1,y="";function z(l){return m.locateFile?m.locateFile(l,y):y+l}var A;(w||x)&&(x?y=self.location.href:typeof document!=="undefined"&&document.currentScript&&(y=document.currentScript.src),l&&(y=l),y.indexOf("blob:")!==0?y=y.substr(0,y.lastIndexOf("/")+1):y="",(function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.send(null);return m.responseText}catch(n){m=ga(l);if(m)return fa(m);throw n}},x&&(A=function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.responseType="arraybuffer";m.send(null);return new Uint8Array(m.response)}catch(n){m=ga(l);if(m)return m;throw n}}),function(l,m,n){var o=new XMLHttpRequest();o.open("GET",l,!0);o.responseType="arraybuffer";o.onload=function(){if(o.status==200||o.status==0&&o.response){m(o.response);return}var p=ga(l);if(p){m(p.buffer);return}n()};o.onerror=n;o.send(null)}),function(l){document.title=l});m.print||emptyFunction.bind(console);var B=m.printErr||emptyFunction.bind(console);for(u in t)Object.prototype.hasOwnProperty.call(t,u)&&(m[u]=t[u]);t=null;m.arguments&&(v=m.arguments);m.thisProgram&&m.thisProgram;m.quit&&m.quit;var C;m.wasmBinary&&(C=m.wasmBinary);m.noExitRuntime||!0;var D={Memory:function(l){this.buffer=new ArrayBuffer(l.initial*65536)},Module:function(l){},Instance:function(l,m){this.exports=function(l){function m(l){l.set=function(l,m){this[l]=m};l.get=function(l){return this[l]};return l}var n,o=new Uint8Array(123);for(var p=25;p>=0;--p)o[48+p]=52+p,o[65+p]=p,o[97+p]=26+p;o[43]=62;o[47]=63;function q(m,n,p){var q,r,l=0,s=n,t=p.length;n=n+(t*3>>2)-(p[t-2]=="=")-(p[t-1]=="=");for(;l<t;l+=4)q=o[p.charCodeAt(l+1)],r=o[p.charCodeAt(l+2)],m[s++]=o[p.charCodeAt(l)]<<2|q>>4,s<n&&(m[s++]=q<<4|r>>2),s<n&&(m[s++]=r<<6|o[p.charCodeAt(l+3)])}function r(l){q(n,1024,"U3Q5dHlwZV9pbmZvAAAAAOAEAAAABAAATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAACAUAABgEAAAQBAAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAACAUAAEgEAAA8BAAATjEwX19jeHhhYml2MTE3X19wYmFzZV90eXBlX2luZm9FAAAACAUAAHgEAAA8BAAATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UACAUAAKgEAACcBAAAAAAAAGwEAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAAAAABQBQAAAQAAAAkAAAADAAAABAAAAAUAAAAKAAAACwAAAAwAAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAACAUAACgFAABsBA=="),q(n,1372,"gAkQ")}function s(l){var o=l.a,p=o.buffer;o.grow=xa;var q=new Int8Array(p),s=new Int16Array(p),t=new Int32Array(p),u=new Uint8Array(p),v=new Uint16Array(p),w=new Uint32Array(p);new Float32Array(p);new Float64Array(p);var x=Math.imul;Math.fround;Math.abs;var y=Math.clz32;Math.min;Math.max;Math.floor;Math.ceil;Math.trunc;Math.sqrt;l.abort;NaN;Infinity;var z=l.b,A=1051008,B;function C(o,p,l,r,m,n){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;var y=0,z=0,B;y=A-80|0;A=y;t[y+72>>2]=o;t[y+68>>2]=p;t[y+64>>2]=l;t[y+60>>2]=r;t[y+56>>2]=m;t[y+52>>2]=n;a:{if(t[y+52>>2]?!t[y+56>>2]|(!t[y+72>>2]|!t[y+68>>2]|(!t[y+64>>2]|!t[y+60>>2])):1){t[y+76>>2]=5;break a}t[t[y+64>>2]>>2]=0;t[t[y+60>>2]>>2]=0;p=t[y+68>>2];l=t[y+56>>2];r=t[y+52>>2];o=A+-64|0;A=o;t[o+56>>2]=t[y+72>>2];t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=0;t[o+36>>2]=t[o+56>>2];b:{c:{d:{while(1){if(!t[o+52>>2])break c;t[o+32>>2]=t[o+36>>2];q[o+31|0]=u[t[o+36>>2]];t[o+52>>2]=t[o+52>>2]-1;t[o+36>>2]=t[o+36>>2]+1;if(u[o+31|0]!=10?u[o+31|0]==2|u[o+31|0]==4|u[o+31|0]==9:1){t[o+40>>2]=t[o+40>>2]+1;continue}t[o+24>>2]=1;if(V(u[o+31|0])&1){z=o,B=X(u[o+31|0])&1,q[z+23|0]=B;t[o+16>>2]=q[o+23|0]&1?1:2;if(w[o+52>>2]<w[o+16>>2]){t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[o+52>>2]=t[o+52>>2]-t[o+16>>2];t[o+24>>2]=t[o+16>>2]+t[o+24>>2];t[o+36>>2]=t[o+16>>2]+t[o+36>>2];if(!(u[o+31|0]!=14?u[o+31|0]!=8:0)){t[o+40>>2]=t[o+40>>2]+1;continue}}if(w[o+52>>2]<3)break d;t[o+12>>2]=0;p=t[o+36>>2];l=u[p|0]|u[p+1|0]<<8;q[o+12|0]=l;q[o+13|0]=l>>>8;q[o+14|0]=u[p+2|0];t[o+52>>2]=t[o+52>>2]-3;t[o+24>>2]=t[o+24>>2]+3;t[o+36>>2]=t[o+36>>2]+3;if(w[o+12>>2]<=w[o+52>>2]){t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]=t[o+12>>2]+t[o+36>>2];t[o+52>>2]=t[o+52>>2]-t[o+12>>2];continue}break}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+44>>2]>>2]=t[o+52>>2]}t[o+60>>2]=t[o+40>>2];A=o- -64|0;t[y+48>>2]=t[o+60>>2];if(!t[y+48>>2]){t[y+76>>2]=0;break a}z=y,B=D(x(t[y+48>>2],20)),t[z+44>>2]=B;if(!t[y+44>>2]){t[y+76>>2]=3;break a}t[y+40>>2]=t[y+44>>2];t[y+36>>2]=t[y+72>>2];t[y+32>>2]=t[y+68>>2]-t[t[y+52>>2]>>2];t[y+28>>2]=0;while(1){if(w[y+28>>2]<w[y+48>>2]){if(w[y+32>>2]<1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}q[y+27|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;e:{if(!u[y+27|0]|u[y+27|0]==1|(u[y+27|0]==2|u[y+27|0]==3)|(u[y+27|0]==4|u[y+27|0]==9|u[y+27|0]==10))break e;if(V(u[y+27|0])&1)break e;O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=6;break a}o=t[y+40>>2];t[o>>2]=u[y+27|0]&15|t[o>>2]&-16;f:{if(u[y+27|0]!=10?u[y+27|0]==2|u[y+27|0]==4|u[y+27|0]==9:1){o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441;t[y+40>>2]=t[y+40>>2]+20;break f}if(V(u[y+27|0])&1){o=A-48|0;A=o;t[o+40>>2]=t[y+40>>2];t[o+36>>2]=y+36;t[o+32>>2]=y+32;g:{if(!(V(t[t[o+40>>2]>>2]&15)&1)){t[o+44>>2]=1;break g}z=o,B=X(t[t[o+40>>2]>>2]&15)&1,q[z+31|0]=B;t[o+24>>2]=q[o+31|0]&1?1:2;if(w[t[o+32>>2]>>2]<w[o+24>>2]){t[o+44>>2]=1;break g}ba(t[o+40>>2]+4|0,t[t[o+36>>2]>>2],t[o+24>>2]);p=t[o+36>>2];t[p>>2]=t[o+24>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+24>>2];if((t[t[o+40>>2]>>2]&15)==8){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==14){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if(w[t[o+32>>2]>>2]<3){t[o+44>>2]=11;break g}t[o+20>>2]=0;p=t[t[o+36>>2]>>2];l=u[p|0]|u[p+1|0]<<8;q[o+20|0]=l;q[o+21|0]=l>>>8;q[o+22|0]=u[p+2|0];p=t[o+36>>2];t[p>>2]=t[p>>2]+3;p=t[o+32>>2];t[p>>2]=t[p>>2]-3;p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441|(t[o+20>>2]&16777215)<<4;if(w[t[o+32>>2]>>2]<w[o+20>>2]){t[o+44>>2]=11;break g}if((t[t[o+40>>2]>>2]&15)==15){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==5){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}h:{if(!((t[t[o+40>>2]>>2]&15)!=6?(t[t[o+40>>2]>>2]&15)!=7:0)){z=o,B=Q(t[o+36>>2],t[o+32>>2],o+19|0,o+18|0),t[z+12>>2]=B;if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}break h}if(!((t[t[o+40>>2]>>2]&15)!=13?(t[t[o+40>>2]>>2]&15)!=12:0)){l=t[o+32>>2];p=A-32|0;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=o+19;t[p+12>>2]=o+16;s[p+10>>1]=0;i:{if(w[t[p+20>>2]>>2]<2){t[p+28>>2]=1;break i}l=t[t[p+24>>2]>>2];l=u[l|0]|u[l+1|0]<<8;q[p+10|0]=l;q[p+11|0]=l>>>8;l=t[p+24>>2];t[l>>2]=t[l>>2]+2;l=t[p+20>>2];t[l>>2]=t[l>>2]-2;q[t[p+16>>2]]=(v[p+10>>1]&32768)==32768;s[t[p+12>>2]>>1]=v[p+10>>1]&32767;t[p+28>>2]=0}t[o+12>>2]=t[p+28>>2];if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}}}if((t[t[o+40>>2]>>2]&15)==12){p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==7){p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==13){l=t[o+32>>2];r=t[o+20>>2];m=t[o+40>>2]+12|0;n=t[o+40>>2];p=A-32|0;A=p;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=r;t[p+12>>2]=m;t[p+8>>2]=n+16;j:{if(w[p+16>>2]<2){t[p+28>>2]=9;break j}t[t[p+8>>2]>>2]=t[p+16>>2]-2;if(w[t[p+20>>2]>>2]<w[t[p+8>>2]>>2]){t[p+28>>2]=1;break j}l=D(t[t[p+8>>2]>>2]);t[t[p+12>>2]>>2]=l;if(!t[t[p+12>>2]>>2]){t[p+28>>2]=3;break j}ba(t[t[p+12>>2]>>2],t[t[p+24>>2]>>2],t[t[p+8>>2]>>2]);l=t[p+24>>2];t[l>>2]=t[t[p+8>>2]>>2]+t[l>>2];l=t[p+20>>2];t[l>>2]=t[l>>2]-t[t[p+8>>2]>>2];t[p+28>>2]=0}A=p+32|0;t[o+8>>2]=t[p+28>>2];if(t[o+8>>2]){t[o+44>>2]=t[o+8>>2];break g}p=t[o+40>>2];s[p+8>>1]=q[o+19|0]&1|v[p+8>>1]&65534;p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==6){z=o,B=M(t[o+36>>2],t[o+32>>2],t[o+20>>2],t[o+40>>2]+12|0,t[o+40>>2]+16|0),t[z+4>>2]=B;if(t[o+4>>2]){t[o+44>>2]=t[o+4>>2];break g}p=t[o+40>>2];q[p+8|0]=q[o+19|0]&1|u[p+8|0]&254;p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}t[o+44>>2]=1}A=o+48|0;t[y+20>>2]=t[o+44>>2];if(!t[y+20>>2]){t[y+40>>2]=t[y+40>>2]+20;break f}O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+20>>2];break a}t[y+16>>2]=0;if(w[y+32>>2]<3){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}o=t[y+36>>2];p=u[o|0]|u[o+1|0]<<8;q[y+16|0]=p;q[y+17|0]=p>>>8;q[y+18|0]=u[o+2|0];t[y+36>>2]=t[y+36>>2]+3;t[y+32>>2]=t[y+32>>2]-3;if(!(t[y+16>>2]==1|u[y+27|0]!=1)){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=7;break a}o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441|(t[y+16>>2]&16777215)<<4;if(u[y+27|0]==3){if(t[y+16>>2]!=1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=10;break a}q[y+15|0]=0;if(w[y+32>>2]<1){J(t[y+44>>2]);t[y+76>>2]=1;break a}q[y+15|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;k:{if(u[y+15|0]<=4){q[t[y+40>>2]+4|0]=u[y+15|0];break k}q[t[y+40>>2]+4|0]=4}t[y+40>>2]=t[y+40>>2]+20;break f}z=y,B=Q(y+36|0,y+32|0,y+14|0,y+13|0),t[z+8>>2]=B;if(t[y+8>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+8>>2];break a}if(u[y+27|0]==1){o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20;break f}if(!u[y+27|0]){z=y,B=M(y+36|0,y+32|0,t[y+16>>2],t[y+40>>2]+8|0,t[y+40>>2]+12|0),t[z+4>>2]=B;if(t[y+4>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+4>>2];break a}o=t[y+40>>2];q[o+4|0]=q[y+14|0]&1|u[o+4|0]&254;o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20}}t[y+28>>2]=t[y+28>>2]+1;continue}break}if(t[y+32>>2]){O(t[y+44>>2],t[y+48>>2]);t[y+76>>2]=1;break a}t[t[y+64>>2]>>2]=t[y+44>>2];t[t[y+60>>2]>>2]=t[y+48>>2];t[y+76>>2]=0}A=y+80|0;return t[y+76>>2]}function D(o){var q=0,l=0,r=0,m=0,n=0,s=0,u=0,v,w=0,x,p;w=8;a:{b:{if(o>>>0>4294967239)break b;while(1){w=w>>>0>8?w:8;l=t[603];n=l;m=t[602];u=m;o=o>>>0>8?o+3&-4:8;c:{if(o>>>0<=127){s=(o>>>3|0)-1|0;break c}r=y(o);s=((o>>>29-r^4)-(r<<2)|0)+110|0;if(o>>>0<=4095)break c;r=((o>>>30-r^2)-(r<<1)|0)+71|0;s=r>>>0<63?r:63}q=s;r=q&31;(q&63)>>>0>=32?(q=0,l=l>>>r|0):(q=l>>>r|0,l=((1<<r)-1&l)<<32-r|u>>>r);r=q;if(l|q){while(1){n=l;q=r;d:{if(q|l){m=q-1|0;v=m+1|0;u=m;m=l-1|0;u=(m|0)!=-1?v:u;m=y(l^m)+32|0;l=y(q^u);l=(l|0)==32?m:l;q=63-l|0;0-(l>>>0>63)|0;break d}q=64}m=q;q=m;l=q&31;(q&63)>>>0>=32?(q=0,u=r>>>l|0):(q=r>>>l|0,u=((1<<l)-1&r)<<32-l|n>>>l);r=q;s=m+s|0;n=s<<4;q=t[n+1384>>2];m=n+1376|0;e:{if((q|0)!=(m|0)){l=I(q,w,o);if(l)break b;l=t[q+4>>2];t[l+8>>2]=t[q+8>>2];t[t[q+8>>2]+4>>2]=l;t[q+8>>2]=m;l=n+1380|0;t[q+4>>2]=t[l>>2];t[l>>2]=q;t[t[q+4>>2]+8>>2]=q;s=s+1|0;l=(r&1)<<31|u>>>1;r=r>>>1|0;break e}x=t[603];q=s;v=q&63;l=v;n=l&31;l>>>0>=32?(l=0,m=-1>>>n|0):(l=-1>>>n|0,m=(1<<n)-1<<32-n|-1>>>n);m=m&-2;n=v&31;v>>>0>=32?(l=m<<n,v=0):(l=(1<<n)-1&m>>>32-n|l<<n,v=m<<n);n=l;m=0-q&63;l=m;q=l&31;l>>>0>=32?(l=-1<<q,q=0):(l=(1<<q)-1&-1>>>32-q|-1<<q,q=-1<<q);p=q&-2;q=m&31;m>>>0>=32?(m=0,q=l>>>q|0):(m=l>>>q|0,q=((1<<q)-1&l)<<32-q|p>>>q);l=q|v;B=n|m;t[602]=t[602]&l;t[603]=B&x;l=u^1}if(l|r)continue;break}m=t[602];n=t[603]}f:{if(n|m){r=y(n);r=63-((r|0)==32?y(m)+32|0:r)<<4;q=r+1376|0;r=t[r+1384>>2];g:{if(!n&m>>>0<1073741824)break g;s=98;if((q|0)==(r|0))break g;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if(!s)break g;s=s-1|0;if((q|0)!=(r|0))continue;break}}if(G(o+48|0))break f;if(!r|(q|0)==(r|0))break a;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if((q|0)!=(r|0))continue;break}break a}if(!G(o+48|0))break a}l=0;if(o>>>0>4294967239)break b;r=w;q=0;while(1){s=q;if(r){r=r-1&r;q=q+1|0;continue}break}if(s>>>0<=1)continue;break}}return l}return 0}function E(o,p,l,r,m,n,x){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;x=x|0;var y=0,z=0;y=A-32|0;A=y;s[y+26>>1]=o;t[y+20>>2]=p;t[y+16>>2]=l;q[y+15|0]=r;s[y+12>>1]=m;t[y+8>>2]=n;t[y+4>>2]=x;a:{if(!(!(q[y+15|0]&1)|v[y+12>>1]<=32767)){t[y+28>>2]=4;break a}p=t[y+20>>2];l=t[y+16>>2];r=t[y+8>>2];m=t[y+4>>2];n=q[y+15|0]&1;o=A+-64|0;A=o;t[o+56>>2]=y+26;t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=m;q[o+39|0]=2;q[o+38|0]=13;t[o+32>>2]=y+12;q[o+31|0]=n;q[o+30|0]=2;b:{c:{if(!(!t[o+52>>2]|(!t[o+44>>2]|!t[o+40>>2]))&&w[o+48>>2]<=16777215)break c;t[o+60>>2]=5;break b}t[o+24>>2]=t[o+48>>2]+(u[o+39|0]+(u[o+30|0]+4|0)|0);z=o,x=D(t[o+24>>2]),t[z+20>>2]=x;if(!t[o+20>>2]){t[o+60>>2]=3;break b}t[o+16>>2]=t[o+20>>2];q[t[o+16>>2]]=u[o+38|0];t[o+16>>2]=t[o+16>>2]+1;ba(t[o+16>>2],t[o+56>>2],u[o+30|0]);t[o+16>>2]=u[o+30|0]+t[o+16>>2];t[o+12>>2]=u[o+39|0]+t[o+48>>2];if(w[o+12>>2]<w[o+48>>2]){J(t[o+20>>2]);t[o+60>>2]=9;break b}p=t[o+16>>2];l=u[o+12|0]|u[o+13|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+14|0];t[o+16>>2]=t[o+16>>2]+3;if(q[o+31|0]&1)d:{if(u[o+38|0]==6){p=t[o+32>>2];q[p|0]=u[p|0]|128;break d}e:{if(u[o+38|0]==13){p=t[o+32>>2];s[p>>1]=v[p>>1]|32768;break e}J(t[o+20>>2]);t[o+60>>2]=1;break b}}ba(t[o+16>>2],t[o+32>>2],u[o+39|0]);t[o+16>>2]=u[o+39|0]+t[o+16>>2];ba(t[o+16>>2],t[o+52>>2],t[o+48>>2]);t[t[o+44>>2]>>2]=t[o+20>>2];t[t[o+40>>2]>>2]=t[o+24>>2];t[o+60>>2]=0}A=o- -64|0;t[y+28>>2]=t[o+60>>2]}A=y+32|0;return t[y+28>>2]}function F(o,p,l,r,m){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;var n=0,v=0;n=A-32|0;A=n;s[n+30>>1]=o;t[n+24>>2]=p;t[n+20>>2]=l;t[n+16>>2]=r;t[n+12>>2]=m;p=t[n+24>>2];l=t[n+20>>2];r=t[n+16>>2];m=t[n+12>>2];o=A-48|0;A=o;t[o+40>>2]=n+30;t[o+36>>2]=p;t[o+32>>2]=l;t[o+28>>2]=r;t[o+24>>2]=m;q[o+23|0]=2;q[o+22|0]=15;a:{if(!(t[o+24>>2]?t[o+28>>2]:0)){t[o+44>>2]=5;break a}t[t[o+28>>2]>>2]=0;t[t[o+24>>2]>>2]=0;if(!(w[o+32>>2]<=16777215?t[o+36>>2]:0)){t[o+44>>2]=5;break a}t[o+16>>2]=t[o+32>>2]+(u[o+23|0]+4|0);v=o,r=D(t[o+16>>2]),t[v+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break a}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+22|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];p=t[o+8>>2];l=u[o+32|0]|u[o+33|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+34|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+36>>2],t[o+32>>2]);t[o+8>>2]=t[o+32>>2]+t[o+8>>2];t[t[o+28>>2]>>2]=t[o+12>>2];t[t[o+24>>2]>>2]=t[o+16>>2];t[o+44>>2]=0}A=o+48|0;A=n+32|0;return t[o+44>>2]}function G(o){var p=0,l,r=0,m=0,n,s=0;r=t[343];l=o+3&-4;p=r+l|0;a:{b:{if(p>>>0<=r>>>0?l:0)break b;if(p>>>0>wa()<<16>>>0&&!(z(p|0)|0))break b;t[343]=p;break a}t[604]=48;r=-1}if((r|0)!=-1){l=o+r|0;p=l-16|0;t[p+12>>2]=16;t[p>>2]=16;o=t[600];o?s=t[o+8>>2]:s=0;c:{d:{if((s|0)==(r|0)){m=r-(t[r-4>>2]&-2)|0;n=t[m-4>>2];t[o+8>>2]=l;o=m-(n&-2)|0;l=-16;if(!(q[(o+t[o>>2]|0)-4|0]&1))break d;l=t[o+4>>2];t[l+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=l;p=p-o|0;t[o>>2]=p;break c}t[r+12>>2]=16;t[r>>2]=16;t[r+8>>2]=l;t[r+4>>2]=o;t[600]=r;l=16}o=r+l|0;p=p-o|0;t[o>>2]=p}t[((p&-4)+o|0)-4>>2]=p|1;s=o;m=t[o>>2]-8|0;e:{if(m>>>0<=127){p=(m>>>3|0)-1|0;break e}n=y(m);p=((m>>>29-n^4)-(n<<2)|0)+110|0;if(m>>>0<=4095)break e;p=((m>>>30-n^2)-(n<<1)|0)+71|0;p=p>>>0<63?p:63}l=p<<4;t[s+4>>2]=l+1376;l=l+1384|0;t[o+8>>2]=t[l>>2];t[l>>2]=o;t[t[o+8>>2]+4>>2]=o;l=t[603];o=p&31;(p&63)>>>0>=32?(p=1<<o,o=0):(p=(1<<o)-1&1>>>32-o,o=1<<o);t[602]=o|t[602];t[603]=p|l}return(r|0)!=-1}function la(o,p,l,r){o=o|0;p=p|0;l=l|0;r=r|0;var m=0,n=0;m=A-16|0;A=m;s[m+10>>1]=o;s[m+8>>1]=p;t[m+4>>2]=l;t[m>>2]=r;a:{if(v[m+8>>1]>32767){t[m+12>>2]=4;break a}p=t[m+4>>2];l=t[m>>2];o=A-48|0;A=o;t[o+40>>2]=m+10;t[o+36>>2]=p;t[o+32>>2]=l;q[o+31|0]=2;q[o+30|0]=12;t[o+24>>2]=m+8;q[o+23|0]=2;b:{if(!(t[o+32>>2]?t[o+36>>2]:0)){t[o+44>>2]=5;break b}t[o+16>>2]=u[o+31|0]+(u[o+23|0]+4|0);n=o,r=D(t[o+16>>2]),t[n+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break b}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+30|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];t[o+4>>2]=u[o+31|0];p=t[o+8>>2];l=u[o+4|0]|u[o+5|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+6|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+24>>2],u[o+31|0]);t[t[o+32>>2]>>2]=t[o+16>>2];t[t[o+36>>2]>>2]=t[o+12>>2];t[o+44>>2]=0}A=o+48|0;t[m+12>>2]=t[o+44>>2]}A=m+16|0;return t[m+12>>2]}function H(o,p,l){o=o|0;p=p|0;l=l|0;var q=0,m=0,n=0,r=0,s=0;n=A+-64|0;A=n;m=1;a:{if(R(o,p,0))break a;m=0;if(!p)break a;q=A+-64|0;A=q;m=t[p>>2];r=t[m-4>>2];s=t[m-8>>2];t[q+20>>2]=0;t[q+16>>2]=1084;t[q+12>>2]=p;t[q+8>>2]=1132;m=0;ca(q+24|0,39);p=p+s|0;b:{if(R(r,1132,0)){t[q+56>>2]=1;ka[t[t[r>>2]+20>>2]](r,q+8|0,p,p,1,0);m=t[q+32>>2]==1?p:0;break b}ka[t[t[r>>2]+24>>2]](r,q+8|0,p,1,0);c:switch(t[q+44>>2]){case 0:m=t[q+48>>2]==1?t[q+36>>2]==1?t[q+40>>2]==1?t[q+28>>2]:0:0:0;break b;case 1:break c;default:break b}if(t[q+48>>2]|t[q+36>>2]!=1|t[q+40>>2]!=1?t[q+32>>2]!=1:0)break b;m=t[q+24>>2]}A=q- -64|0;p=m;m=0;if(!p)break a;ca(n+8|4,52);t[n+56>>2]=1;t[n+20>>2]=-1;t[n+16>>2]=o;t[n+8>>2]=p;ka[t[t[p>>2]+28>>2]](p,n+8|0,t[l>>2],1);o=t[n+32>>2];(o|0)==1&&(t[l>>2]=t[n+24>>2]);m=(o|0)==1}o=m;A=n- -64|0;return o|0}function I(o,p,l){var q=0,m,n=0,r=0;q=o+4|0;m=(q+p|0)-1&0-p;p=t[o>>2];if(m+l>>>0<=(p+o|0)-4>>>0){n=t[o+4>>2];t[n+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=n;(q|0)!=(m|0)&&(m=m-q|0,n=o-(t[o-4>>2]&-2)|0,q=m+t[n>>2]|0,t[n>>2]=q,t[(n+(q&-4)|0)-4>>2]=q,o=o+m|0,p=p-m|0,t[o>>2]=p);a:{if(l+24>>>0<=p>>>0){q=(o+l|0)+8|0;p=(p-l|0)-8|0;t[q>>2]=p;t[(q+(p&-4)|0)-4>>2]=p|1;r=q;n=t[q>>2]-8|0;b:{if(n>>>0<=127){m=(n>>>3|0)-1|0;break b}p=y(n);m=((n>>>29-p^4)-(p<<2)|0)+110|0;if(n>>>0<=4095)break b;p=((n>>>30-p^2)-(p<<1)|0)+71|0;m=p>>>0<63?p:63}p=m;m=p<<4;t[r+4>>2]=m+1376;m=m+1384|0;t[q+8>>2]=t[m>>2];t[m>>2]=q;t[t[q+8>>2]+4>>2]=q;m=t[603];q=p&31;(p&63)>>>0>=32?(p=1<<q,r=0):(p=(1<<q)-1&1>>>32-q,r=1<<q);t[602]=r|t[602];t[603]=p|m;p=l+8|0;t[o>>2]=p;t[((p&-4)+o|0)-4>>2]=p;break a}t[(o+p|0)-4>>2]=p}o=o+4|0}else o=0;return o}function J(o){var p=0,l,q=0,m,n=0;if(o){l=o-4|0;m=t[l>>2];q=m;p=l;n=t[o-8>>2];o=n&-2;(o|0)!=(n|0)&&(p=l-o|0,q=t[p+4>>2],t[q+8>>2]=t[p+8>>2],t[t[p+8>>2]+4>>2]=q,q=o+m|0);o=l+m|0;l=t[o>>2];(l|0)!=t[(o+l|0)-4>>2]&&(m=t[o+4>>2],t[m+8>>2]=t[o+8>>2],t[t[o+8>>2]+4>>2]=m,q=q+l|0);t[p>>2]=q;t[((q&-4)+p|0)-4>>2]=q|1;n=p;q=t[p>>2]-8|0;a:{if(q>>>0<=127){o=(q>>>3|0)-1|0;break a}m=y(q);o=((q>>>29-m^4)-(m<<2)|0)+110|0;if(q>>>0<=4095)break a;o=((q>>>30-m^2)-(m<<1)|0)+71|0;o=o>>>0<63?o:63}l=o<<4;t[n+4>>2]=l+1376;l=l+1384|0;t[p+8>>2]=t[l>>2];t[l>>2]=p;t[t[p+8>>2]+4>>2]=p;l=t[603];p=o&31;(o&63)>>>0>=32?(o=1<<p,p=0):(o=(1<<p)-1&1>>>32-p,p=1<<p);t[602]=p|t[602];t[603]=o|l}}function K(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-48|0;A=p;t[p+40>>2]=n;t[p+36>>2]=o;t[p+32>>2]=l;a:{if(!(t[p+32>>2]?t[p+36>>2]:0)){t[p+44>>2]=5;break a}if(w[p+40>>2]>4){t[p+44>>2]=8;break a}t[p+28>>2]=5;m=p,l=D(t[p+28>>2]),t[m+24>>2]=l;if(!t[p+24>>2]){t[p+44>>2]=3;break a}t[p+20>>2]=t[p+24>>2];q[p+19|0]=3;q[t[p+20>>2]]=u[p+19|0];t[p+20>>2]=t[p+20>>2]+1;t[p+12>>2]=1;n=t[p+20>>2];o=u[p+12|0]|u[p+13|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;q[n+2|0]=u[p+14|0];t[p+20>>2]=t[p+20>>2]+3;q[p+11|0]=t[p+40>>2];q[t[p+20>>2]]=u[p+11|0];t[t[p+36>>2]>>2]=t[p+24>>2];t[t[p+32>>2]>>2]=t[p+28>>2];t[p+44>>2]=0}A=p+48|0;return t[p+44>>2]}function L(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(R(n,t[o>>2],m)){if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+32>>2]=p;b:{if(t[o+44>>2]==4)break b;s[o+52>>1]=0;n=t[n+8>>2];ka[t[t[n>>2]+20>>2]](n,o,l,l,1,m);if(u[o+53|0]){t[o+44>>2]=3;if(!u[o+52|0])break b;break a}t[o+44>>2]=4}t[o+20>>2]=l;t[o+40>>2]=t[o+40>>2]+1;if(t[o+36>>2]!=1|t[o+24>>2]!=2)break a;q[o+54|0]=1;return}n=t[n+8>>2];ka[t[t[n>>2]+24>>2]](n,o,l,p,m)}}function M(o,p,l,q,m){var n=0;n=A-32|0;A=n;t[n+24>>2]=o;t[n+20>>2]=p;t[n+16>>2]=l;t[n+12>>2]=q;t[n+8>>2]=m;a:{if(w[n+16>>2]<1){t[n+28>>2]=9;break a}t[t[n+8>>2]>>2]=t[n+16>>2]-1;if(w[t[n+20>>2]>>2]<w[t[n+8>>2]>>2]){t[n+28>>2]=1;break a}o=D(t[t[n+8>>2]>>2]);t[t[n+12>>2]>>2]=o;if(!t[t[n+12>>2]>>2]){t[n+28>>2]=3;break a}ba(t[t[n+12>>2]>>2],t[t[n+24>>2]>>2],t[t[n+8>>2]>>2]);o=t[n+24>>2];t[o>>2]=t[t[n+8>>2]>>2]+t[o>>2];o=t[n+20>>2];t[o>>2]=t[o>>2]-t[t[n+8>>2]>>2];t[n+28>>2]=0}A=n+32|0;return t[n+28>>2]}function N(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-32|0;A=p;s[p+26>>1]=n;t[p+20>>2]=o;t[p+16>>2]=l;t[t[p+16>>2]>>2]=3;m=p,l=D(t[t[p+16>>2]>>2]),t[m+12>>2]=l;a:{if(!t[p+12>>2]){t[p+28>>2]=3;break a}t[t[p+20>>2]>>2]=t[p+12>>2];q[p+11|0]=14;q[t[p+12>>2]]=u[p+11|0];t[p+12>>2]=t[p+12>>2]+1;n=t[p+12>>2];o=u[p+26|0]|u[p+27|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;t[p+28>>2]=0}A=p+32|0;return t[p+28>>2]}function O(m,n){var l=0;l=A-16|0;A=l;t[l+12>>2]=m;t[l+8>>2]=n;t[l+4>>2]=0;while(1){if(w[l+4>>2]<w[l+8>>2]){t[l>>2]=t[l+12>>2]+x(t[l+4>>2],20);a:{if(!(t[t[l>>2]>>2]&15)){J(t[t[l>>2]+8>>2]);break a}b:{if((t[t[l>>2]>>2]&15)==5){J(t[t[l>>2]+8>>2]);break b}(t[t[l>>2]>>2]&15)==6&&J(t[t[l>>2]+12>>2])}}t[l+4>>2]=t[l+4>>2]+1;continue}break}J(t[l+12>>2]);A=l+16|0}function P(m,n,l,o){q[m+53|0]=1;a:{if(t[m+4>>2]!=(l|0))break a;q[m+52|0]=1;l=t[m+16>>2];if(!l){t[m+36>>2]=1;t[m+24>>2]=o;t[m+16>>2]=n;if((o|0)!=1|t[m+48>>2]!=1)break a;q[m+54|0]=1;return}if((n|0)==(l|0)){l=t[m+24>>2];(l|0)==2&&(t[m+24>>2]=o,l=o);if(t[m+48>>2]!=1|(l|0)!=1)break a;q[m+54|0]=1;return}q[m+54|0]=1;t[m+36>>2]=t[m+36>>2]+1}}function Q(n,o,l,p){var m;m=A-32|0;t[m+24>>2]=n;t[m+20>>2]=o;t[m+16>>2]=l;t[m+12>>2]=p;q[m+11|0]=0;a:{if(w[t[m+20>>2]>>2]<1){t[m+28>>2]=1;break a}q[m+11|0]=u[t[t[m+24>>2]>>2]];n=t[m+24>>2];t[n>>2]=t[n>>2]+1;n=t[m+20>>2];t[n>>2]=t[n>>2]-1;q[t[m+16>>2]]=(u[m+11|0]&128)==128;q[t[m+12>>2]]=u[m+11|0]&127;t[m+28>>2]=0}return t[m+28>>2]}function ma(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(!R(n,t[o>>2],m))break a;if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+20>>2]=l;t[o+32>>2]=p;t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]!=1|t[o+24>>2]!=2||(q[o+54|0]=1);t[o+44>>2]=4}}function R(m,n,l){var o;if(!l)return t[m+4>>2]==t[n+4>>2];if((m|0)==(n|0))return 1;l=t[m+4>>2];m=u[l|0];n=t[n+4>>2];o=u[n|0];a:{if(!m|(o|0)!=(m|0))break a;while(1){o=u[n+1|0];m=u[l+1|0];if(!m)break a;n=n+1|0;l=l+1|0;if((m|0)==(o|0))continue;break}}return(m|0)==(o|0)}function na(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=9;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function S(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=10;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function T(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=2;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function U(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=4;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function V(l){var m=0;m=A-16|0;A=m;t[m+12>>2]=l;l=1;a:{if(X(t[m+12>>2])&1)break a;l=1;if(t[m+12>>2]==15)break a;l=1;if(t[m+12>>2]==13)break a;l=1;if(t[m+12>>2]==12)break a;l=t[m+12>>2]==14}A=m+16|0;return l}function W(m,n,l){var o;o=t[m+16>>2];if(!o){t[m+36>>2]=1;t[m+24>>2]=l;t[m+16>>2]=n;return}a:{if((n|0)==(o|0)){if(t[m+24>>2]!=2)break a;t[m+24>>2]=l;return}q[m+54|0]=1;t[m+24>>2]=2;t[m+36>>2]=t[m+36>>2]+1}}function X(l){var m;m=A-16|0;t[m+12>>2]=l;l=1;a:{if(t[m+12>>2]==5)break a;l=1;if(t[m+12>>2]==6)break a;l=1;if(t[m+12>>2]==7)break a;l=t[m+12>>2]==8}return l}function Y(o,p,l,q,m,n){o=o|0;p=p|0;l=l|0;q=q|0;m=m|0;n=n|0;if(R(o,t[p+8>>2],n)){P(p,l,q,m);return}o=t[o+8>>2];ka[t[t[o>>2]+20>>2]](o,p,l,q,m,n)}function Z(){var m=0,n,l;while(1){n=m<<4;l=n+1376|0;t[n+1380>>2]=l;t[n+1384>>2]=l;m=m+1|0;if((m|0)!=64)continue;break}G(48)}function $(m,n,l,o){m=m|0;n=n|0;l=l|0;o=o|0;if(R(m,t[n+8>>2],0)){W(n,l,o);return}m=t[m+8>>2];ka[t[t[m>>2]+28>>2]](m,n,l,o)}function aa(o,p,l,q,m,n){o=o|0,p=p|0,l=l|0,q=q|0,m=m|0,n=n|0,R(o,t[p+8>>2],n)&&P(p,l,q,m)}function ba(m,n,l){if(l)while(1){q[m|0]=u[n|0];m=m+1|0;n=n+1|0;l=l-1|0;if(l)continue;break}}function ca(l,m){if(m)while(1){q[l|0]=0;l=l+1|0;m=m-1|0;if(m)continue;break}}function oa(m,n,l,o){m=m|0,n=n|0,l=l|0,o=o|0,R(m,t[n+8>>2],0)&&W(n,l,o)}function da(m,n,l){t[m+28>>2]==1|t[m+4>>2]!=(n|0)||(t[m+28>>2]=l)}function pa(l,m){l=l|0;m=m|0;return x(m,20)+l|0}function ea(l){l=l|0;return v[l+8>>1]>>>1|0}function qa(l){l=l|0;return s[l+8>>1]&1}function fa(l){l=l|0;return t[l+12>>2]}function ra(l){l=l|0;return t[l>>2]&15}function sa(l){l=l|0;return t[l+16>>2]}function ga(l){l=l|0;return v[l+4>>1]}function ha(l){l=l|0;return t[l+8>>2]}function ia(l){l=l|0;return u[l+4|0]}function ja(l){l=l|0;return l|0}function ta(l){return D(l)}function ua(l){l=l|0,J(l)}function va(l){l|0}n=u;r(l);var ka=m([null,ja,ua,va,va,H,aa,ma,oa,ua,Y,L,$]);function wa(){return p.byteLength/65536|0}function xa(l){l=l|0;var m=wa()|0;l=m+l|0;if(m<l&&l<65536){l=new ArrayBuffer(x(l,65536));var r=new Int8Array(l);r.set(q);q=new Int8Array(l);s=new Int16Array(l);t=new Int32Array(l);u=new Uint8Array(l);v=new Uint16Array(l);w=new Uint32Array(l);new Float32Array(l);new Float64Array(l);p=l;o.buffer=p;n=u}return m}return{c:Z,d:ta,e:ua,f:T,g:U,h:K,i:F,j:N,k:E,l:la,m:na,n:S,o:C,p:ra,q:ia,r:pa,s:ga,t:ha,u:fa,v:fa,w:sa,x:ea,y:qa,z:ea,A:ka}}return s(l)}(ha)},instantiate:function(l,m){return{then:function(n){var m=new D.Module(l);n({instance:new D.Instance(m)})}}},RuntimeError:Error};C=[];typeof D!=="object"&&Y("no native wasm support detected");var E,F=!1;function G(l,m){l||Y("Assertion failed: "+m)}function la(l,m){l%m>0&&(l+=m-l%m);return l}var H,I;function J(l){H=l,m.HEAP8=new Int8Array(l),m.HEAP16=new Int16Array(l),m.HEAP32=new Int32Array(l),m.HEAPU8=I=new Uint8Array(l),m.HEAPU16=new Uint16Array(l),m.HEAPU32=new Uint32Array(l),m.HEAPF32=new Float32Array(l),m.HEAPF64=new Float64Array(l)}u=m.INITIAL_MEMORY||2097152;m.wasmMemory?E=m.wasmMemory:E=new D.Memory({initial:u/65536,maximum:2147483648/65536});E&&(H=E.buffer);H.byteLength;J(H);var K,L=[],M=[],N=[];function O(){if(m.preRun){typeof m.preRun=="function"&&(m.preRun=[m.preRun]);while(m.preRun.length)ma(m.preRun.shift())}da(L)}function P(){da(M)}function Q(){if(m.postRun){typeof m.postRun=="function"&&(m.postRun=[m.postRun]);while(m.postRun.length)na(m.postRun.shift())}da(N)}function ma(l){L.unshift(l)}function R(l){M.unshift(l)}function na(l){N.unshift(l)}(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(l,m){var n=l>>>16;l=l&65535;var o=m>>>16;m=m&65535;return l*m+(n*m+l*o<<16)|0});if(!Math.fround){var S=new Float32Array(1);Math.fround=function(l){S[0]=l;return S[0]}}Math.clz32||(Math.clz32=function(l){var m=32,n=l>>16;n&&(m-=16,l=n);n=l>>8;n&&(m-=8,l=n);n=l>>4;n&&(m-=4,l=n);n=l>>2;n&&(m-=2,l=n);n=l>>1;return n?m-2:m-l});Math.trunc||(Math.trunc=function(l){return l<0?Math.ceil(l):Math.floor(l)});var T=0,U=null,V=null;function W(l){T++,m.monitorRunDependencies&&m.monitorRunDependencies(T)}function X(l){T--;m.monitorRunDependencies&&m.monitorRunDependencies(T);if(T==0){U!==null&&(clearInterval(U),U=null);if(V){l=V;V=null;l()}}}m.preloadedImages={};m.preloadedAudios={};function Y(l){m.onAbort&&m.onAbort(l);l+="";B(l);F=!0;l="abort("+l+"). Build with -s ASSERTIONS=1 for more info.";l=new D.RuntimeError(l);s(l);throw l}var Z="data:application/octet-stream;base64,";function $(l){return l.startsWith(Z)}var aa="dgwcppbridge.wasm";$(aa)||(aa=z(aa));function ba(l){try{if(l==aa&&C)return new Uint8Array(C);var m=ga(l);if(m)return m;if(A)return A(l);else throw"both async and sync fetching of the wasm failed"}catch(l){Y(l)}}function ca(){return!C&&(w||x)&&typeof fetch==="function"?fetch(aa,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+aa+"'";return l.arrayBuffer()})["catch"](function(){return ba(aa)}):n.resolve().then(function(){return ba(aa)})}function oa(){var n={a:ha};function o(n,l){l=n.exports;m.asm=l;K=m.asm.A;R(m.asm.c);X("wasm-instantiate")}W("wasm-instantiate");function r(l){o(l.instance)}function t(l){return ca().then(function(l){l=D.instantiate(l,n);return l}).then(l,function(l){B("failed to asynchronously prepare wasm: "+l),Y(l)})}function u(){if(!C&&typeof D.instantiateStreaming==="function"&&!$(aa)&&typeof fetch==="function")return fetch(aa,{credentials:"same-origin"}).then(function(l){l=D.instantiateStreaming(l,n);return l.then(r,function(l){B("wasm streaming compile failed: "+l);B("falling back to ArrayBuffer instantiation");return t(r)})});else return t(r)}if(m.instantiateWasm)try{var l=m.instantiateWasm(n,o);return l}catch(l){B("Module.instantiateWasm callback failed with error: "+l);return!1}u()["catch"](s);return{}}function da(l){while(l.length>0){var n=l.shift();if(typeof n=="function"){n(m);continue}var o=n.func;typeof o==="number"?n.arg===void 0?K.get(o)():K.get(o)(n.arg):o(n.arg===void 0?null:n.arg)}}function pa(l){try{E.grow(l-H.byteLength+65535>>>16);J(E.buffer);return 1}catch(l){}}function ea(l){var m=I.length;l=l>>>0;var n=2147483648;if(l>n)return!1;for(var o=1;o<=4;o*=2){var p=m*(1+.2/o);p=Math.min(p,l+100663296);p=Math.min(n,la(Math.max(l,p),65536));p=pa(p);if(p)return!0}return!1}var qa=!1;function fa(l){var m=[];for(var n=0;n<l.length;n++){var o=l[n];o>255&&(qa&&G(!1,"Character code "+o+" ("+String.fromCharCode(o)+")  at offset "+n+" not in 0x00-0xFF."),o&=255);m.push(String.fromCharCode(o))}return m.join("")}var ra=typeof atob==="function"?atob:function(l){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",o,p,q,r,s,t=0;l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do p=m.indexOf(l.charAt(t++)),q=m.indexOf(l.charAt(t++)),r=m.indexOf(l.charAt(t++)),s=m.indexOf(l.charAt(t++)),p=p<<2|q>>4,q=(q&15)<<4|r>>2,o=(r&3)<<6|s,n=n+String.fromCharCode(p),r!==64&&(n=n+String.fromCharCode(q)),s!==64&&(n=n+String.fromCharCode(o));while(t<l.length);return n};function sa(l){try{l=ra(l);var m=new Uint8Array(l.length);for(var n=0;n<l.length;++n)m[n]=l.charCodeAt(n);return m}catch(l){throw new Error("Converting base64 string to bytes failed.")}}function ga(l){if(!$(l))return;return sa(l.slice(Z.length))}var ha={b:ea,a:E};oa();m.___wasm_call_ctors=function(){return(m.___wasm_call_ctors=m.asm.c).apply(null,arguments)};m.__malloc=function(){return(m.__malloc=m.asm.d).apply(null,arguments)};m.__free=function(){return(m.__free=m.asm.e).apply(null,arguments)};m.__DgwCodecEncodeEmpty=function(){return(m.__DgwCodecEncodeEmpty=m.asm.f).apply(null,arguments)};m.__DgwCodecEncodeDeauth=function(){return(m.__DgwCodecEncodeDeauth=m.asm.g).apply(null,arguments)};m.__DgwCodecEncodeDrain=function(){return(m.__DgwCodecEncodeDrain=m.asm.h).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EstabStream=function(){return(m.__DgwCodecEncodeStreamGroup_EstabStream=m.asm.i).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EndOfData=function(){return(m.__DgwCodecEncodeStreamGroup_EndOfData=m.asm.j).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Data=function(){return(m.__DgwCodecEncodeStreamGroup_Data=m.asm.k).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Ack=function(){return(m.__DgwCodecEncodeStreamGroup_Ack=m.asm.l).apply(null,arguments)};m.__DgwCodecEncodePing=function(){return(m.__DgwCodecEncodePing=m.asm.m).apply(null,arguments)};m.__DgwCodecEncodePong=function(){return(m.__DgwCodecEncodePong=m.asm.n).apply(null,arguments)};m.__DgwCodecDecode=function(){return(m.__DgwCodecDecode=m.asm.o).apply(null,arguments)};m.__getFrameType=function(){return(m.__getFrameType=m.asm.p).apply(null,arguments)};m.__getDrainReasonFromDrainFrame=function(){return(m.__getDrainReasonFromDrainFrame=m.asm.q).apply(null,arguments)};m.__getDGWFramePtr=function(){return(m.__getDGWFramePtr=m.asm.r).apply(null,arguments)};m.__getStreamIdFromStreamGroupFrame=function(){return(m.__getStreamIdFromStreamGroupFrame=m.asm.s).apply(null,arguments)};m.__getEncodedParamsFromEstablishStreamFrame=function(){return(m.__getEncodedParamsFromEstablishStreamFrame=m.asm.t).apply(null,arguments)};m.__getEncodedParamsSizeFromEstablishStreamFrame=function(){return(m.__getEncodedParamsSizeFromEstablishStreamFrame=m.asm.u).apply(null,arguments)};m.__getDataFromGroupedStreamDataFrame=function(){return(m.__getDataFromGroupedStreamDataFrame=m.asm.v).apply(null,arguments)};m.__getDataSizeFromGroupedStreamDataFrame=function(){return(m.__getDataSizeFromGroupedStreamDataFrame=m.asm.w).apply(null,arguments)};m.__getAckIdFromGroupedStreamDataFrame=function(){return(m.__getAckIdFromGroupedStreamDataFrame=m.asm.x).apply(null,arguments)};m.__getRequiresAckFromGroupedStreamDataFrame=function(){return(m.__getRequiresAckFromGroupedStreamDataFrame=m.asm.y).apply(null,arguments)};m.__getAckIdFromGroupedStreamAckFrame=function(){return(m.__getAckIdFromGroupedStreamAckFrame=m.asm.z).apply(null,arguments)};var ia;V=function l(){ia||ja(),ia||(V=l)};function ja(l){l||v;if(T>0)return;O();if(T>0)return;function n(){if(ia)return;ia=!0;m.calledRun=!0;if(F)return;P();o(m);m.onRuntimeInitialized&&m.onRuntimeInitialized();Q()}m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),n()},1)):n()}m.run=ja;if(m.preInit){typeof m.preInit=="function"&&(m.preInit=[m.preInit]);while(m.preInit.length>0)m.preInit.pop()()}ja();return m.ready}}();typeof q==="object"&&typeof p==="object"?p.exports=r:typeof define==="function"&&define.amd?define([],function(){return r}):typeof q==="object"&&(q.Module=r)}),null);
__d("DGWUtils",["Base64","DGWConstants","DGWCppBridge","DGWLoggingContext","Promise","Random","URI","gkx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=4;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=d("Random").random()*16|0;a=a==="x"?b:b&3|8;return a.toString(16)})}function k(a){var b=new TextDecoder();b=b.decode(a);a=c("Base64").encode(b);b=a.replace(/\+/gi,"-").replace(/\//gi,"_").replace(/=/gi,"");return b}var l=null,m=null;function n(){m==null&&(m=(i||(i=b("Promise"))).resolve().then(function(){return c("DGWCppBridge")()}).then(function(a){l=a}));return m}e=function(){function a(){}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!c("gkx")("9999")){a.next=4;break}return a.abrupt("return",n());case 4:if(!(l!=null)){a.next=6;break}return a.abrupt("return");case 6:a.next=8;return b("regeneratorRuntime").awrap(c("DGWCppBridge")());case 8:l=a.sent;case 9:case"end":return a.stop()}},null,this)};a.constructConnectUrl=function(a){var b,e,f=a.appId,g=a.appVersion,i=a.authType,j=a.deviceId,l=a.dgwVersion,m=a.fbId,n=a.tier,o=a.loggingId,p=a.headers,q=a.endpoint,r=a.serviceId,s=a.regionHint;a=a.establishStreamFrame;var t=(b={},b[(e=d("DGWConstants")).HEADER_CONSTANTS.HEADER_APPID]=f,b[e.HEADER_CONSTANTS.HEADER_APPVERSION]=g,b[e.HEADER_CONSTANTS.HEADER_AUTHTYPE]=i,b[e.HEADER_CONSTANTS.HEADER_DGW_VERSION]=""+l,b[e.HEADER_CONSTANTS.HEADER_UUID]=m,b[e.HEADER_CONSTANTS.HEADER_TARGET_TIER]=n,b);a!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64]=k(a));o!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_LOGGING_ID]=o);s!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_REGIONHINT]=s);j!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_DEVICE_ID]=j);Object.keys(p).forEach(function(a){var b=d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+a;Object.prototype.hasOwnProperty.call(t,b)||(t[b]=p[a])});f=new(h||(h=c("URI")))(q);f.setQueryData(t);f.setPath(f.getPath()+"/"+r);f.toString().length>2e3&&(delete t[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64],f.setQueryData(t));return f.toString()};return a}();f=function(){function a(a,b,c){this.$1=null,this.$2=a,this.$3=b,this.$4=c}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!c("gkx")("9999")){a.next=4;break}return a.abrupt("return",n());case 4:if(!(l!=null)){a.next=6;break}return a.abrupt("return");case 6:a.next=8;return b("regeneratorRuntime").awrap(c("DGWCppBridge")());case 8:l=a.sent;case 9:case"end":return a.stop()}},null,this)};var e=a.prototype;e.malloc=function(a){try{a=l.__malloc(a);if(a===0){var b;(b=this.$2)==null?void 0:b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","malloc returned 0");return-1}return a}catch(a){(b=this.$2)==null?void 0:b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","exception during malloc",a.toString());return-1}};e.free=function(a){l.__free(a)};e.append=function(a){if(this.$1==null){this.$1=a;return}var b=this.$1.length,c=new Uint8Array(b+a.length);c.set(this.$1,0);c.set(a,b);this.$1=c};e.processData=function(){var a=this;if(this.$1==null)return;var b=this.$1.length,c=this.malloc(b);if(c===-1)return;var e=l.HEAPU8.subarray(c,c+b);if(this.$1)for(var f=0;f<e.length;++f)e[f]=this.$1[f];f=this.malloc(j*4);if(f===-1)return;e=f;var g=e+j,h=g+j,i=h+j;b=l.__DgwCodecDecode(c,b,e,g,h,i);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){this.free(f);(h=this.$2)==null?void 0:h.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return}c=l.HEAPU32.subarray(i/j,i/j+1)[0];if(this.$1==null){this.free(f);return}h=this.$1.length-c;if(this.$1&&this.$1.length>h){this.$1=new Uint8Array(((b=this.$1)==null?void 0:b.subarray(h))||[])}else this.$1=null;i=l.HEAPU32.subarray(g/j,g/j+1)[0];c=l.HEAPU32.subarray(e/j,e/j+1)[0];var k=[];for(b=0;b<i;++b){var m=l.__getDGWFramePtr(c,b);h=l.__getFrameType(m);switch(h){case d("DGWConstants").DgwFrameType.DgwFrameType_Drain:g=function(){var b=l.__getDrainReasonFromDrainFrame(m),c=d("DGWConstants").drainReasonToDrainReasonString(b);(b=a.$2)==null?void 0:b.logEvent(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+c);k.push(function(){var b;return(b=a.$3)==null?void 0:b.receivedDrainSignal(c)});return"break"}();if(g==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EstabStream:e=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getEncodedParamsFromEstablishStreamFrame(m),d=new Uint8Array(l.HEAPU8.subarray(c,c+l.__getEncodedParamsSizeFromEstablishStreamFrame(m)));a.free(c);k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamEstablishStreamReceived(b,d)});return"break"}();if(e==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Data:h=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getDataFromGroupedStreamDataFrame(m),d=new Uint8Array(l.HEAPU8.subarray(c,c+l.__getDataSizeFromGroupedStreamDataFrame(m)));a.free(c);var e=l.__getRequiresAckFromGroupedStreamDataFrame(m)?l.__getAckIdFromGroupedStreamDataFrame(m):null;k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamDataReceived(b,d,e)});return"break"}();if(h==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Ack:g=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getAckIdFromGroupedStreamAckFrame(m);k.push(function(){var d;return(d=a.$3)==null?void 0:d.onGroupedStreamAckReceived(b,c)});return"break"}();if(g==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EndOfData:e=function(){var b=l.__getStreamIdFromStreamGroupFrame(m);k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamEndOfDataReceived(b)});return"break"}();if(e==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_Ping:k.push(function(){var b;return(b=a.$3)==null?void 0:b.onPingReceived()});break;case d("DGWConstants").DgwFrameType.DgwFrameType_Pong:k.push(function(){var b;return(b=a.$3)==null?void 0:b.onPongReceived()});break;default:break}this.free(m)}this.free(f);for(h=0;h<k.length;h++)k[h]()};e.encodeData=function(a,b,c,e){var f=this.malloc(a.length);if(f===-1)return null;var g=l.HEAPU8.subarray(f,f+a.length);for(var h=0;h<g.length;++h)g[h]=a[h];a=this.malloc(j*2);h=a;var i=a+j;e=l.__DgwCodecEncodeStreamGroup_Data(e,f,g.length,b,c,h,i);this.free(f);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(g=this.$2)==null?void 0:g.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}b=l.HEAPU32.subarray(h/j,h/j+1)[0];c=l.HEAPU32.subarray(i/j,i/j+1)[0];f=new Uint8Array(l.HEAPU8.subarray(b,b+c));this.free(b);this.free(a);return f};e.encodeAck=function(a,b){var c=this.malloc(j*2);if(c===-1)return null;var e=c,f=c+j;b=l.__DgwCodecEncodeStreamGroup_Ack(b,a,e,f);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(a=this.$2)==null?void 0:a.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return null}a=l.HEAPU32.subarray(e/j,e/j+1)[0];b=l.HEAPU32.subarray(f/j,f/j+1)[0];e=new Uint8Array(l.HEAPU8.subarray(a,a+b));this.free(a);this.free(c);return e};e.encodeDrain=function(a){var b=this.malloc(j*2);if(b===-1)return null;var c=b,e=b+j;a=l.__DgwCodecEncodeDrain(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=l.HEAPU32.subarray(c/j,c/j+1)[0];a=l.HEAPU32.subarray(e/j,e/j+1)[0];c=new Uint8Array(l.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};e.encodeEstablishStream=function(a,b){var c=this.malloc(b.length);if(c===-1)return null;var e=l.HEAPU8.subarray(c,c+b.length);for(var f=0;f<b.length;++f)e[f]=b[f];e=this.malloc(j*2);f=e;var g=e+j;b=l.__DgwCodecEncodeStreamGroup_EstabStream(a,c,b.length,f,g);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(c=this.$2)==null?void 0:c.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EstablishStream Frame encode failure","Failed to encode EstablishStream Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b)+" for StreamId "+a);return null}c=l.HEAPU32.subarray(f/j,f/j+1)[0];b=l.HEAPU32.subarray(g/j,g/j+1)[0];a=new Uint8Array(l.HEAPU8.subarray(c,c+b));this.free(c);this.free(e);return a};e.encodeEndOfData=function(a){var b=this.malloc(j*2);if(b===-1)return null;var c=b,e=b+j;a=l.__DgwCodecEncodeStreamGroup_EndOfData(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EndOfData Frame encode failure","Failed to encode EndOfData Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=l.HEAPU32.subarray(c/j,c/j+1)[0];a=l.HEAPU32.subarray(e/j,e/j+1)[0];c=new Uint8Array(l.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};e.encodePing=function(){if(this.$5!=null)return this.$5;var a=this.malloc(j*2);if(a===-1)return null;var b=a,c=a+j,e=l.__DgwCodecEncodePing(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Ping Frame encode failure","Failed to encode Ping Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=l.HEAPU32.subarray(b/j,b/j+1)[0];e=l.HEAPU32.subarray(c/j,c/j+1)[0];b=new Uint8Array(l.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);this.$5=b;return b};e.encodePong=function(){if(this.$6!=null)return this.$6;var a=this.malloc(j*2);if(a===-1)return null;var b=a,c=a+j,e=l.__DgwCodecEncodePong(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Pong Frame encode failure","Failed to encode Pong Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=l.HEAPU32.subarray(b/j,b/j+1)[0];e=l.HEAPU32.subarray(c/j,c/j+1)[0];b=new Uint8Array(l.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);this.$6=b;return b};return a}();g.uuidv4=a;g.Uint8ArrayToBase64UrlStr=k;g.DGWUtils=e;g.DGWCodec=f}),98);
__d("DGWExponentialBackoff",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g,h={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},i=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.errors=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:c===void 0&&(c=h);d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(j(a,c));case 4:return d.abrupt("return",d.sent);case 7:d.prev=7;d.t0=d["catch"](1);throw d.t0.errors[d.t0.errors.length-1];case 10:case"end":return d.stop()}},null,this,[[1,7]])}function j(a,c){var d,e,f,g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:d=0,e=[],f=c.baseRetryInterval,g=c.backoffFactor;case 4:if(!(d<=c.maxRetries)){j.next=20;break}j.prev=5;j.next=8;return b("regeneratorRuntime").awrap(a());case 8:h=j.sent;return j.abrupt("return",h);case 12:j.prev=12,j.t0=j["catch"](5),e.push(j.t0);case 15:j.next=17;return b("regeneratorRuntime").awrap(k(f*Math.pow(g,d)));case 17:++d;j.next=4;break;case 20:throw new i("Max call count exceeded",e);case 21:case"end":return j.stop()}},null,this,[[5,12]])}function k(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(new(g||(g=b("Promise")))(function(b){return window.setTimeout(b,a)}));case 2:case"end":return c.stop()}},null,this)}f.callWithExponentialBackoff=a}),66);
__d("DGWPinger",["DGWLoggingContext"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$4=b,this.$5=c,this.$3=!1}var b=a.prototype;b.$6=function(){var a=this;if(this.$3){var b;(b=d("DGWLoggingContext")).DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout_fired.reset");this.$3=!1;this.$4();b.DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout.newtimeout");this.$2=window.setTimeout(function(){a.$6()},this.$1)}else d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.disconnect"),this.$5()};b.reset=function(){var a=this;this.$3=!0;this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset"),window.clearTimeout(this.$2),this.$2=null);this.$1>0&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset.newtimeout"),this.$2=window.setTimeout(function(){a.$6()},this.$1))};b.cancel=function(){this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"canceled"),window.clearTimeout(this.$2),this.$2=null)};return a}();g.DGWPinger=a}),98);
__d("DGWStreamGroupCallbacks",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum")({TRANSPORT_SERVER_INTERNAL_ERROR:0,TRANSPORT_ABNORMAL_CLOSURE:1,TRANSPORT_GOING_AWAY:2,TRANSPORT_UNKNOWN_ERROR:3,TRANSPORT_KEEPALIVE_TIMEOUT:4,TRANSPORT_UNAUTHORIZED:5,TRANSPORT_REJECTED:6,TRANSPORT_BAD_REQUEST:7,TRANSPORT_DGW_SERVER_ERROR:8});function a(a){switch(a){case g.TRANSPORT_UNAUTHORIZED:return!1;default:return!0}}c=function(){function a(){}var b=a.prototype;b.onStreamGroupError=function(){};b.onStreamGroupMustDrain=function(){};b.onStreamGroupTransportClose=function(){};return a}();f.DGWStreamGroupError=g;f.isRetryableError=a;f.NoOpDGWStreamGroupCallbacks=c}),66);
__d("DGWTransportEvents",["DGWLoggingContext","NetworkStatus"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$3=a}var b=a.prototype;b.transportEstablished=function(){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"open"),this.$2=Date.now(),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_success")};b.transportEstablishmentPending=function(){this.$1=Date.now(),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transportPending",null,!0),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_pending")};b.transportClosed=function(a,b){this.$4=Date.now(),a?(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_graceful"),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed gracefully",null,!0)):(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_with_error"),this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed abnormally",b))};b.transportEstablishmentFailure=function(a){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"WebSocket transport establishment failure","WebSocket close code: "+a+" onLine:"+String(c("NetworkStatus").isOnline())),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_failure")};b.streamEstablishmentTimeout=function(a,b,e){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment timeout",a,"streamId:"+b+", onLine:"+String(c("NetworkStatus").isOnline()),!1,e),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_timeout")};b.streamEstablishmentPending=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment pending","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_pending")};b.streamEstablishmentSuccess=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment success","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_success")};b.transportError=function(a,b,c){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,a,b,c)};b.receivedFrameForInactiveStream=function(a,b,c){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Frame received for inactive stream","frameType: "+a+", streamID: "+b,c)};b.ranOutOfStreamIds=function(a){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Hit max StreamId limit","Hit max StreamId limit",a)};return a}();g.DGWTransportEvents=a}),98);
__d("DGWWebSocketTransport",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=new WebSocket(a);a.binaryType="arraybuffer";a.onopen=function(){};a.onclose=function(){};a.onerror=function(){};return a}f.getWebSocketConnection=a}),66);
__d("DGWStreamEvents",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$4=new Map(),this.$5=new Map(),this.$6=a,this.$1=b,c!=null&&(this.$8="streamId:"+c+"::")}var b=a.prototype;b.dataSent=function(a,b,c){var d=c?"sendWithAckRequested":"sendWithoutAckRequested";this.$6.logEvent(this.$1,d,((d=this.$8)!=null?d:"")+"sendId:"+a+", payloadSize:"+b,!0);this.$4.set(a,{ackRequested:c,payloadSize:b,sendTimestamp:Date.now()})};b.ackReceived=function(a){var b;this.$6.logEvent(this.$1,"AckReceived",((b=this.$8)!=null?b:"")+"sendId:"+a,!0);this.$6.bumpODSKey(this.$1,"ack_received");b=this.$4.get(a);b!=null&&(b.ackReceivedTimestamp=Date.now())};b.ackSent=function(a){var b;this.$6.bumpODSKey(this.$1,"ack_sent");this.$6.logEvent(this.$1,"ACK sent",((b=this.$8)!=null?b:"")+"ackId:"+a,!0)};b.drainSent=function(a){var b;this.$6.logEvent(this.$1,"Drain sent",((b=this.$8)!=null?b:"")+"drainReason: "+a)};b.dataReceived=function(a,b,c){var d;this.$6.bumpODSKey(this.$1,"data_received");this.$6.logEvent(this.$1,"Data received",((d=this.$8)!=null?d:"")+"sendId:"+((d=c)!=null?d:"null")+", ackRequested:"+b.toString()+", payloadSize:"+a,!0);c!=null&&this.$5.set(c,{ackRequested:b,payloadSize:a,receiveTimestamp:Date.now()})};b.endOfDataReceived=function(){this.$6.bumpODSKey(this.$1,"end_of_data_received"),this.$6.logEvent(this.$1,"EndOfDataReceived",this.$8,!0)};b.endOfDataSent=function(){this.$6.bumpODSKey(this.$1,"end_of_data_sent"),this.$6.logEvent(this.$1,"EndOfDataSent",this.$8,!0)};b.streamClosed=function(a,b){this.$7=Date.now();var c=this.$9();if(a){this.$6.bumpODSKey(this.$1,"stream_closed_gracefully");this.$6.logEvent(this.$1,"Stream closed gracefully",""+((a=this.$8)!=null?a:"")+c)}else{this.$6.bumpODSKey(this.$1,"stream_closed_with_error");this.$6.logError(this.$1,"Stream closed abnormally",b,""+((a=this.$8)!=null?a:"")+c)}};b.connectionEstablishmentFailure=function(a){this.$6.logEvent(this.$1,"WebSocket connection establishment failure","WebSocket close code: "+a)};b.streamEstablishmentFailure=function(a,b){this.$6.logError(this.$1,"Failed to establish DGW Stream","Last seen error: "+a.toString(),""+((a=this.$8)!=null?a:"")+b);this.$6.bumpODSKey(this.$1,"stream_establishment_failure")};b.error=function(a,b){b={msg:b,state:this.$9()};this.$6.logError(this.$1,a,JSON.stringify(b),this.$8)};b.$9=function(){var a={currentNetworkCondition:window.navigator&&window.navigator.onLine===!0,establishRequestTimestamp:this.$2,establishedTimestamp:this.$3,streamClosedTimestamp:this.$7,sendHistory:JSON.stringify(Array.from(this.$4.entries())),receiveHistory:JSON.stringify(Array.from(this.$5.entries()))};return JSON.stringify(a)};return a}();f.DGWStreamEvents=a}),66);
__d("GroupedStream",["DGWAckManager","DGWConstants","DGWLoggingContext","DGWStream","DGWStreamEvents","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,e,f,g,h){this.$1=a,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=b,this.$7=c,this.$8=e,this.$2=g,this.$9=f,this.$10=new(d("DGWAckManager").DGWAckManager)(this.$9),this.$12=new(d("DGWStreamEvents").DGWStreamEvents)(this.$9,d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,this.$1),this.$11=0,this.$13=h}var c=a.prototype;c.send=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=this.$11++%d("DGWConstants").MAX_ACK_ID;if(this.$14(a,!0,f)){h.next=3;break}return h.abrupt("return",!1);case 3:h.next=5;return b("regeneratorRuntime").awrap(this.$10.waitForAck(f,(e=c)!=null?e:d("DGWConstants").DEFAULT_ACK_TIMEOUT_MS));case 5:g=h.sent;return h.abrupt("return",g);case 7:case"end":return h.stop()}},null,this)};c.sendAndForget=function(a){return this.$14(a,!1)};c.close=function(){var a=this.$2.encodeEndOfData(this.$1);if(a==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode EndOfData","streamId: "+this.$1);return}a=this.$8.send(a);if(!a){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send EndOfData","streamId: "+this.$1+". StreamGroupTransport not open during send");return}this.$12.endOfDataSent();this.$5=!0;this.$4&&this.$15()};c.loggingContext=function(){return this.$9};c.__sendDrain=function(a){var b=d("DGWConstants").drainReasonToDrainReasonString(a);if(this.$5)return!1;a=this.$2.encodeDrain(a);if(a==null)return!1;this.$12.drainSent(b);b=this.$8.send(a);return b};c.__transportCloseHook=function(a){this.$13(),this.$10.clearPendingAcks(),a?(this.$12.error("Received StreamError","StreamErrorType: "+a),this.$6.onError(a)):this.$5&&this.$4?this.$15():(this.$12.streamClosed(!1,"Stream closed: ClosedLocally: "+this.$5.toString()+", EndOfDataReceived: "+this.$4.toString()),this.$6.onError(d("DGWStream").StreamError.PREMATURE_CLOSE))};c.$15=function(){this.$13(),this.$12.streamClosed(!0,"Graceful close"),this.$6.onClose(this)};c.__dataReceivedHook=function(a,b){this.$12.dataReceived(a.length,b!=null,b),b!=null&&this.$16(b),this.$6.onDataReceived(a)};c.__ackReceivedHook=function(a){this.$12.ackReceived(a),this.$10.handleAckReceived(a)};c.__drainReceivedHook=function(a){this.$3===!1&&(this.$6.onStreamMustDrain(this,a),this.$3=!0)};c.__endOfDataHook=function(){this.$12.endOfDataReceived(),this.$4=!0,this.$5?this.$15():this.$6.onServerHasFinishedSendingData(this)};c.$14=function(a,b,c){b===void 0&&(b=!1);c===void 0&&(c=0);if(this.$5){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","Stream closed locally");return!1}a=this.$2.encodeData(a,b,c,this.$1);if(a==null)return!1;var e=this.$8.send(a);if(!e){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","ClosedLocally: "+this.$5.toString());return!1}this.$12.dataSent(c,a.length,b);return!0};c.$16=function(a){var b=this.$2.encodeAck(a,this.$1);if(b==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode ACK","ackId: "+a);return!1}b=this.$8.send(b);if(!b){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send ACK","ackId: "+a);return!1}this.$12.ackSent(a);return!0};return a}();g.GroupedStream=a}),98);
__d("StreamIdGenerator",["err"],(function(a,b,c,d,e,f,g){"use strict";var h=65535;a=function(){function a(){this.$1=new Set(),this.$2=-1}var b=a.prototype;b.getNextStreamId=function(){if(!this.streamIdAvailable())throw c("err")("Max number of stream IDs reached");return++this.$2};b.putBackStreamId=function(a){this.$1.add(a)};b.streamIdAvailable=function(){return this.$2<h};return a}();g.MAX_STREAM_ID=h;g.StreamIdGeneratorImpl=a}),98);
__d("StreamGroupWebSocketTransport",["DGWConstants","DGWExponentialBackoff","DGWLoggingContext","DGWPinger","DGWStream","DGWStreamGroupCallbacks","DGWTransportEvents","DGWUtils","DGWWebSocketTransport","GroupedStream","Promise","StreamIdGenerator","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b,c,e,f){var g=this;this.groupedStream=a;this.$1=window.setTimeout(function(){c(d("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},e);this.handleEstablishFrameReceived=function(){window.clearTimeout(g.$1),b(g.groupedStream)};this.abortStream=function(a){f(),c(a)}};a=function(){function a(b,e,f,g,h,i,j,k){var l=this;this.$14=h;this.$16=this.__getStreamIdGenerator();this.$5=new Map();this.$6=new Map();this.$7=g.keepAliveMs;this.$8=!1;this.$3=!0;this.$4=!1;this.$12=f;this.$10=new TextEncoder();this.$11=new TextDecoder();this.$13=g;h={onDataReceived:function(){},handleAckReceived:function(){},receivedDrainSignal:function(a){l.$13.streamGroupCallbacks.onStreamGroupMustDrain(a),l.$5.forEach(function(b){b.__drainReceivedHook(a)})},onGroupedStreamDataReceived:function(a,b,c){if(l.$5.has(a)){var d=l.$5.get(a);d==null?void 0:d.__dataReceivedHook(b,c)}else{l.$12.receivedFrameForInactiveStream("Data",a,"sendAckID: "+((d=c)!=null?d:"null"))}},onGroupedStreamAckReceived:function(a,b){if(l.$5.has(a)){var c=l.$5.get(a);c==null?void 0:c.__ackReceivedHook(b)}else{l.$12.receivedFrameForInactiveStream("ACK",a,"ackId: "+((c=b)!=null?c:"null"))}},onGroupedStreamEndOfDataReceived:function(a){if(l.$5.has(a)){var b=l.$5.get(a);b==null?void 0:b.__endOfDataHook()}else l.$12.receivedFrameForInactiveStream("EndOfData",a)},onGroupedStreamEstablishStreamReceived:function(a,b){if(l.$6.has(a)){var c=l.$6.get(a);l.$6["delete"](a);b=JSON.parse(l.$11.decode(b));(b.code===void 0||b.code!==200)&&(c==null?void 0:c.abortStream(d("DGWStream").StreamError.ABNORMAL_CLOSURE));c==null?void 0:c.handleEstablishFrameReceived()}else l.$12.receivedFrameForInactiveStream("EstablishStream",a,"EstablishStream received for non-inflight stream")},onPingReceived:function(){var a=l.$2.encodePing();if(a==null)return;l.send(a)},onPongReceived:function(){}};this.$2=new(d("DGWUtils").DGWCodec)(i,h,g.dgwVersion);if(g.enableFirstStreamOnWsHandshake){if(j===void 0)throw c("err")("Missing grouped stream options");if(k===void 0)throw c("err")("Missing grouped stream callbacks");var m=this.$16.getNextStreamId();f=this.createEstablishStreamFrame(m,j);h=d("DGWUtils").DGWUtils.constructConnectUrl({appId:g.appId,appVersion:g.appVersion,authType:g.authType,deviceId:(i=g.deviceId)!=null?i:void 0,dgwVersion:g.dgwVersion,fbId:g.fbId,tier:g.tier,loggingId:(h=g.loggingId)!=null?h:void 0,headers:a.__prefixAppHeaders(g.headers),endpoint:g.connectEndpoint,serviceId:g.serviceId,regionHint:(i=g.regionHint)!=null?i:void 0,establishStreamFrame:f});this.$1=e(h);if(!h.includes(d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64))return;this.$15=this.waitForEstablishStream(m,k,j,new(d("DGWLoggingContext").DGWLoggingContext)(this.$13.dgwVersion,j.loggingId,this.$13.serviceId,this.$13.fbId,this.$13.loggingId,j.disableFalcoLogging),function(a){l.$5.set(m,a)},function(){l.$16.putBackStreamId(m)})}else this.$1=e(b)}var e=a.prototype;e.send=function(a){try{this.$1.send(a);return!0}catch(a){this.$12.transportError("Failed to send over transport","readyState: "+this.$1.readyState,a.toString());return!1}};e.close=function(){this.$1.close(d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE)};e.abort=function(a,b,c,d){this.$8=!0,this.$12.transportClosed(!1,d),this.$5.forEach(function(a){a.__transportCloseHook(b)}),this.$6.forEach(function(a){a.abortStream(b)}),this.$13.streamGroupCallbacks.onStreamGroupError(a),this.$5.clear(),this.$6.clear(),this.$1.close(c)};e.cleanup=function(){var a;(a=this.$9)==null?void 0:a.cancel();this.$1!=null&&(this.$1.onopen=function(a){},this.$1.onmessage=function(a){},this.$1.onerror=function(a){},this.$1.onclose=function(a){},this.$1.close())};a.getTransportWithInitialStream=function(c,e,f,g,h){var i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(d("DGWUtils").DGWCodec.initialize());case 2:i=new(d("DGWTransportEvents").DGWTransportEvents)(g);i.transportEstablishmentPending();j=function(){return a.$17("",f,i,h,g,c,e)};m.prev=5;m.next=8;return b("regeneratorRuntime").awrap(d("DGWExponentialBackoff").callWithExponentialBackoff(j));case 8:k=m.sent;l=k.$15!=null?k.$15:k.establishGroupedStream(e,c,new(d("DGWLoggingContext").DGWLoggingContext)(f.dgwVersion,c.loggingId,f.serviceId,f.fbId,f.loggingId,c.disableFalcoLogging));return m.abrupt("return",{transport:k,streamPromise:l});case 13:m.prev=13;m.t0=m["catch"](5);throw m.t0;case 16:case"end":return m.stop()}},null,this,[[5,13]])};a.getTransport_DEPRECATED=function(c,e,f,g,h){var i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("DGWUtils").DGWCodec.initialize());case 2:i=new(d("DGWTransportEvents").DGWTransportEvents)(f);i.transportEstablishmentPending();j=function(){return a.$17(c,e,i,g,f)};k.prev=5;k.next=8;return b("regeneratorRuntime").awrap(d("DGWExponentialBackoff").callWithExponentialBackoff(j,h));case 8:return k.abrupt("return",k.sent);case 11:k.prev=11;k.t0=k["catch"](5);throw k.t0;case 14:case"end":return k.stop()}},null,this,[[5,11]])};e.establishGroupedStream=function(a,d,e){var f=this,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:g=this.getStreamId();h=this.createEstablishStreamFrame(g,d);i=this.waitForEstablishStream(g,a,d,e,function(a){f.$5.set(g,a)},function(){f.$16.putBackStreamId(g)});if(this.send(h)){k.next=5;break}throw c("err")("Websocket connection closed before stream established");case 5:k.next=7;return b("regeneratorRuntime").awrap(i);case 7:j=k.sent;return k.abrupt("return",j);case 9:case"end":return k.stop()}},null,this)};a.__prefixAppHeaders=function(a){return Object.keys(a).reduce(function(b,c){b[""+d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+c]=a[c];return b},{})};e.waitForEstablishStream=function(a,c,d,e,f,g){var j=this,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:this.$12.streamEstablishmentPending(a,d.loggingId);k=this.__createGroupedStream(a,c,d,e);m.prev=2;m.next=5;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,c){j.$6.set(a,new i(k,b,c,3e4,function(){j.streamEndCallback(a)}))}));case 5:l=m.sent;f(k);this.$12.streamEstablishmentSuccess(a,d.loggingId);return m.abrupt("return",l);case 11:m.prev=11;m.t0=m["catch"](2);g();this.$12.streamEstablishmentTimeout("Stream establishment timeout",a,d.loggingId);throw m.t0;case 16:case"end":return m.stop()}},null,this,[[2,11]])};a.$17=function(c,e,f,g,h,i,j){var k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:k=new a(c,d("DGWWebSocketTransport").getWebSocketConnection,f,e,g,h,i,j);k.$1.onmessage=a.$18(k);k.$1.onopen=function(){f.transportEstablished(),k.$3=!1,k.$7!=null&&(k.$9=new(d("DGWPinger").DGWPinger)(k.$7,function(){k.$19()},function(){k.abort(d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_KEEPALIVE_TIMEOUT,d("DGWStream").StreamError.KEEPALIVE_TIMEOUT,d("DGWConstants").WebsocketCloseCodes.KEEPALIVE_TIMEOUT,"Aborting transport because of keepalive timeout")}))};k.$1.onerror=function(){};k.$1.onclose=a.$20(k);m.next=7;return b("regeneratorRuntime").awrap(a.getTransportPromise(k));case 7:l=m.sent;return m.abrupt("return",l);case 9:case"end":return m.stop()}},null,this)};a.getTransportPromise=function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,c){var e=a.$1.onerror,f=a.$1.onopen;a.$1.onerror=function(){window.clearTimeout(g),e(),c(d("DGWStream").StreamError.ESTABLISHMENT_ERROR)};a.$1.onopen=function(){window.clearTimeout(g),f(),b(a)};var g=window.setTimeout(function(){a.cleanup(),c(d("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},2e4)}));case 2:c=e.sent;return e.abrupt("return",c);case 4:case"end":return e.stop()}},null,this)};a.$18=function(a){return function(b){var c;(c=a.$9)==null?void 0:c.reset();if(!(b.data instanceof ArrayBuffer)){a.$12.transportError("Incorrect Data Protocol","Received "+typeof b.data+" instead of ArrayBuffer");return}a.$2.append(new Uint8Array(b.data));a.$2.processData()}};a.$20=function(a){return function(b){var c;(c=a.$9)==null?void 0:c.cancel();if(a.$8===!0||a.$4)return;if(a.$3===!0){a.$12.transportEstablishmentFailure(b.code);a.$5.clear();return}a.$14();a.$3=!0;if(b.code!==d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE){a.$12.transportClosed(!1,"Websocket connection failure with code "+b.code);c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;var e=d("DGWStream").StreamError.UNKNOWN_ERROR;switch(b.code){case d("DGWConstants").WebsocketCloseCodes.NORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.ABNORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.SERVER_INTERNAL_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.SERVER_INTERNAL_ERROR;break;case d("DGWConstants").WebsocketCloseCodes.GOING_AWAY:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_GOING_AWAY;e=d("DGWStream").StreamError.GOING_AWAY;break;case d("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNAUTHORIZED;e=d("DGWStream").StreamError.UNAUTHORIZED;break;case d("DGWConstants").WebsocketCloseCodes.REJECTED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_REJECTED;e=d("DGWStream").StreamError.REJECTED;break;case d("DGWConstants").WebsocketCloseCodes.BAD_REQUEST:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_BAD_REQUEST;e=d("DGWStream").StreamError.BAD_REQUEST;break;case d("DGWConstants").WebsocketCloseCodes.DGW_SERVER_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.DGW_SERVER_ERROR;c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_DGW_SERVER_ERROR;break;default:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;e=d("DGWStream").StreamError.UNKNOWN_ERROR;break}a.$13.streamGroupCallbacks.onStreamGroupError(c);a.$5.forEach(function(a){a.__transportCloseHook(e)});a.$6.forEach(function(a){a.abortStream(e)})}else a.$12.transportClosed(!0,""),a.$13.streamGroupCallbacks.onStreamGroupTransportClose(),a.$5.forEach(function(a){a.__transportCloseHook()}),a.$6.forEach(function(a){a.abortStream(d("DGWStream").StreamError.TRANSPORT_CLOSED_BEFORE_STREAM_INIT)});a.$5.clear();a.$6.clear()}};e.$19=function(){var a=this.$2.encodePing();if(a==null)throw c("err")("Failed to encode Ping Frame");this.send(a)};e.isClosedLocally=function(){return this.$3||this.$8||this.$4};e.streamEndCallback=function(a){this.$5["delete"](a),this.$6["delete"](a),this.$16.putBackStreamId(a)};e.canCreateGroupedStream=function(){return this.$16.streamIdAvailable()};e.createEstablishStreamFrame=function(b,d){d=this.$2.encodeEstablishStream(b,new Uint8Array(this.$10.encode(JSON.stringify(a.__prefixAppHeaders(d.groupedStreamHeaders)))));if(d==null){this.$16.putBackStreamId(b);throw c("err")("Failed to encode EstablishStreamFrame")}return d};e.getStreamId=function(){try{return this.$16.getNextStreamId()}catch(a){this.$12.ranOutOfStreamIds("inFlightGroupedStreamSize: "+this.$6.size+" groupedStreamSize: "+this.$5.size);throw a}};e.__createGroupedStream=function(a,b,c,e){var f=this;return new(d("GroupedStream").GroupedStream)(a,b,c,this,e,this.$2,function(){f.streamEndCallback(a)})};e.__getStreamIdGenerator=function(){return new(d("StreamIdGenerator").StreamIdGeneratorImpl)()};return a}();g.StreamGroupWebSocketTransport=a}),98);
__d("StreamGroup",["DGWConstants","DGWLoggingContext","DGWUtils","StreamGroupWebSocketTransport","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,e,f,g,h,i,j){this.$2=j;this.$1=j.getNewStreamGroupId();j=(j=h.overrideUrl)!=null?j:f;this.$5=null;this.$3={appId:a,appVersion:b,authType:c,deviceId:h.deviceId,dgwVersion:e,headers:h.streamGroupAppHeaders,tier:(f=h.serviceTier)!=null?f:d("DGWConstants").DEFAULT_SERVICE_TIER,connectEndpoint:j,fbId:g,loggingId:h.loggingId,serviceId:h.serviceId,streamGroupCallbacks:i,keepAliveMs:h.keepAliveMs,regionHint:h.regionHint,enableFirstStreamOnWsHandshake:!1};this.$4=h;this.streamGroupLoggingContext=new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,null,this.$3.serviceId,this.$3.fbId,this.$4.loggingId,!1,(a=h.verboseLoggingEnabled)!=null?a:!1);this.$6=d("DGWUtils").DGWUtils.constructConnectUrl({appId:this.$3.appId,appVersion:this.$3.appVersion,authType:this.$3.authType,deviceId:(b=this.$3.deviceId)!=null?b:void 0,dgwVersion:this.$3.dgwVersion,fbId:this.$3.fbId,headers:babelHelpers["extends"]({},this.$3.headers),loggingId:(c=this.$3.loggingId)!=null?c:void 0,tier:this.$3.tier,serviceId:this.$3.serviceId,endpoint:this.$3.connectEndpoint,regionHint:(e=this.$3.regionHint)!=null?e:void 0})}var c=a.prototype;c.initTransport=function(){var a=this,c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){a.$2.removeStreamGroupAndTransport(a.$1)},c);f.prev=2;f.next=5;return b("regeneratorRuntime").awrap(this.$5);case 5:e=f.sent;this.$5=null;f.next=13;break;case 9:f.prev=9;f.t0=f["catch"](2);this.$5=null;throw f.t0;case 13:this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,e);return f.abrupt("return",e);case 15:case"end":return f.stop()}},null,this,[[2,9]])};c.establishStream=function(a,c){var e=this,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(this.$2.containsStreamGroup(this.$1)===!1)){h.next=22;break}if(this.$3.enableFirstStreamOnWsHandshake){h.next=17;break}this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)});h.prev=3;h.next=6;return b("regeneratorRuntime").awrap(this.$5);case 6:f=h.sent;this.$5=null;h.next=14;break;case 10:h.prev=10;h.t0=h["catch"](3);this.$5=null;throw h.t0;case 14:this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,f);h.next=22;break;case 17:h.next=19;return b("regeneratorRuntime").awrap(d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransportWithInitialStream(a,c,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)}));case 19:g=h.sent;this.$2.setStreamGroupAndTransport(this.$1,g.transport);return h.abrupt("return",g.streamPromise);case 22:return h.abrupt("return",this.establishStreamWithTransport(a,c));case 23:case"end":return h.stop()}},null,this,[[3,10]])};c.establishStreamWithTransport=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=a.loggingId;this.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Establishing Grouped Stream",null,!0,f);h.next=4;return b("regeneratorRuntime").awrap(this.$2.getStreamGroupTransport(this.$1).establishGroupedStream(c,a,new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,f,this.$3.serviceId,this.$3.fbId,this.$3.loggingId,a.disableFalcoLogging,(e=a.verboseLoggingEnabled)!=null?e:!1)));case 4:g=h.sent;return h.abrupt("return",g);case 6:case"end":return h.stop()}},null,this)};c.canCreateGroupedStream=function(){var a=!0;if(this.$2.containsStreamGroup(this.$1)!==!1){var b=this.$2.getStreamGroupTransport(this.$1);a=b.canCreateGroupedStream()}d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,a?"can_create":"cannot_create");return a};c.close=function(){var a=this.$2.getStreamGroupTransport(this.$1);a.close()};return a}();g.StreamGroup=a}),98);
__d("StreamGroupRegistry",["Random","err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new Map(),this.$2=new Set()}var b=a.prototype;b.setStreamGroupAndTransport=function(a,b){this.$1.set(a,b)};b.containsStreamGroup=function(a){return this.$1.has(a)};b.removeStreamGroupAndTransport=function(a){this.$1["delete"](a)};b.getStreamGroupTransport=function(a){a=this.$1.get(a);if(a==null)throw c("err")("No stream group transport");return a};b.getNewStreamGroupId=function(){var a=d("Random").uint32();while(this.$2.has(a))a=d("Random").uint32();this.$2.add(a);return a};return a}();g.StreamGroupRegistry=a}),98);
__d("RawDGWClient",["CurrentUser","DGWLoggingContext","DGWStream","StreamGroup","StreamGroupRegistry","isFastRefreshEnabledForCurrentDomain","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.appId,c=a.appVersion,e=a.authType,f=a.dgwVersion,g=a.endpoint;a=a.fbId;this.$1=b;this.$2=c;this.$3=e;this.$4=f;this.$5=g;this.$6=a;this.$7=new(d("StreamGroupRegistry").StreamGroupRegistry)()}var b=a.prototype;b.createStreamGroup=function(a,b){c("justknobx")._("1023")&&this.handleUserChecks();return new(d("StreamGroup").StreamGroup)(this.$1,this.$2,this.$3,this.$4,this.$5,this.$6,b,a,this.$7)};b.handleUserChecks=function(){if(!c("CurrentUser").isLoggedInNow()&&!c("isFastRefreshEnabledForCurrentDomain")()){d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.RAW_CLIENT,"unauthenticated");throw d("DGWStream").StreamError.UNAUTHENTICATED}};return a}();g.RawDGWClient=a}),98);
__d("DGWClient",["DGWAuth","DGWEnvUtil","DGWWebConfig","RawDGWClient","err"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("RawDGWClient").RawDGWClient)({appId:c("DGWWebConfig").appId,appVersion:c("DGWWebConfig").appVersion,authType:d("DGWAuth").fromStringToDGWAuth(c("DGWEnvUtil").getDGWAuthType()),dgwVersion:c("DGWEnvUtil").getDGWVersion(),endpoint:c("DGWEnvUtil").getDGWEndpoint(),fbId:c("DGWWebConfig").fbId});function a(){if(c("DGWEnvUtil").isDGWEnvCompatible())return h;else throw c("err")("unsupported_environment_retry_with_mqtt")}g["default"]=a}),98);
__d("DGWRequestStreamUtils",["Base64","WebDriverConfig","cr:3024","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,d,e,f){var g={};a=Object.entries(a);for(var h=0;h<a.length;h++){var i=a[h],j=i[0];i=i[1];typeof i=="string"?g["XRSS-"+j]=i:typeof i=="number"?g["XRSN-"+j]=i.toString():typeof i=="boolean"?g["XRSB-"+j]=i.toString():typeof i=="object"&&i!=null&&(g["XRSO-"+j]=c("Base64").encode(JSON.stringify(i)))}d&&(g["xrs-body"]="true");e!=null&&e.length>0&&(g["xrs-instrumentation"]=c("Base64").encode(e));g["XRS-Accept-Ack"]="RSAck";f!=null&&f.ackTimeoutSec!=null&&(g["XRS-SRAck-Timeout"]=f.ackTimeoutSec.toString());g["XRSS-http_referer"]=window.location.href;if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){j=b("cr:3024")==null?void 0:b("cr:3024").get();j!=null&&(g["XRSB-is_test"]="true",g["XRSS-original_request_id"]=j)}return g}function h(a){return Object.keys(a).reduce(function(b,c){(typeof a[c]==="string"||typeof a[c]==="boolean"||typeof a[c]==="number"||typeof a[c]==="object")&&(b[c]=a[c]);return b},{})}function d(a){if(a.response&&a.response.instrumentation_data!=null&&a.response.instrumentation_data.length>0)try{a=JSON.parse(new TextDecoder("utf-8").decode(a.response.instrumentation_data));return{auxId:a.auxId,dfTraceId:(a=a.dataFlowTracingData)==null?void 0:a.traceId}}catch(a){}return null}function e(a,b){var c=a.headers;a=a.body;b.kill_body===!0&&(a=null);b.new_body!=null&&(a=b.new_body);if(b.new_headers!=null)try{c=h(JSON.parse(b.new_headers))}catch(a){}if(b.patch_headers!=null)try{c=babelHelpers["extends"]({},c,h(JSON.parse(b.patch_headers)))}catch(a){}return{headers:c,body:a}}g.convertHeaders=a;g.cleanHeaders=h;g.getInstrumentationDataFieldsFromPayload=d;g.transformContextWithRewriteDelta=e}),98);
__d("DGWStreamHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d,e){this.$2=a,this.$3=b,this.$4=c,this.$5=d,this.$6=e,this.$1=!0}var b=a.prototype;b.onClose=function(a){if(!this.$1)return;this.$2(a)};b.onDataReceived=function(a){if(!this.$1)return;this.$3(a)};b.onError=function(a){if(!this.$1)return;this.$4(a)};b.onStreamMustDrain=function(a,b){if(!this.$1)return;this.$5(a,b)};b.onServerHasFinishedSendingData=function(a){if(!this.$1)return;this.$6(a)};b.stop=function(){this.$1=!1};b.isStopped=function(){return!this.$1};return a}();f["default"]=a}),66);
__d("InflightAmends",["Deferred","err"],(function(a,b,c,d,e,f,g){"use strict";var h="inflight_amends_timeout",i="inflight_amends_duplicate_id";a=function(){function a(a,b,c){this.$1=a,this.$3=b,this.$4=c,this.$2=new Map()}var b=a.prototype;b.add=function(a){var b=this;if(this.$2.has(a))throw c("err")(i);var d=new(c("Deferred"))(),e=Date.now(),f=setTimeout(function(){b.$2.has(a)&&b.reject(a,c("err")(h))},this.$1);this.$2.set(a,{id:a,deferred:d,createdTimestampMs:e,timeoutId:f});return d.getPromise()};b.getPromise=function(a){return(a=this.$5(a))==null?void 0:a.deferred.getPromise()};b.resolve=function(a,b){a=this.$5(a);a&&(a.deferred.resolve==null?void 0:a.deferred.resolve(b),this.$3(a.id,Date.now()-a.createdTimestampMs),this.$6(a))};b.reject=function(a,b){a=this.$5(a);a&&(a.deferred.reject==null?void 0:a.deferred.reject(b),this.$4(a.id,b),this.$6(a))};b.rejectAll=function(a){for(var b=this.$2.entries(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e[1];this.reject(f,a)}};b.getSize=function(){return this.$2.size};b.getAllPromises=function(){var a=[];for(var b=this.$2.values(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;a.push(e.deferred.getPromise())}return a};b.$6=function(a){clearTimeout(a.timeoutId),this.$2["delete"](a.id)};b.$5=function(a){return this.$2.get(a)};return a}();g["default"]=a}),98);
__d("RequestStreamCloseReason",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["UserIntention","StartStreamFailure","StreamError","RemoteTermination","ServerDataEnd","ServerDrain","ReestablishError","ClientError"]);f.RequestStreamCloseReason=a}),66);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{expected_existing_headers:"",patch_headers_if_match:""}}function e(){return{bytes:Uint8Array.of()}}function f(){return{message:""}}function i(){return{reason:d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}}function j(){return{}}function k(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}}function l(){return{caller_timestamp_ms:"0"}}function m(){return{original_ping_timestamp_ms:"0"}}function n(){return{}}function o(a,b){b.writeStructBegin("ResponseRewriteRequest"),a.new_headers!=null&&(b.writeFieldBegin({fname:"new_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.new_headers),b.writeFieldEnd()),a.new_body!=null&&(b.writeFieldBegin({fname:"new_body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.new_body),b.writeFieldEnd()),a.patch_headers!=null&&(b.writeFieldBegin({fname:"patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers),b.writeFieldEnd()),a.kill_body!=null&&(b.writeFieldBegin({fname:"kill_body",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:4}),b.writeBool(a.kill_body),b.writeFieldEnd()),a.temporary!=null&&(b.writeFieldBegin({fname:"temporary",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:5}),b.writeBool(a.temporary),b.writeFieldEnd()),a.conditional_patch_headers!=null&&(b.writeFieldBegin({fname:"conditional_patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),p(a.conditional_patch_headers,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function p(a,b){b.writeStructBegin("ResponseRewriteConditionalPatchHeaders");b.writeFieldBegin({fname:"expected_existing_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.expected_existing_headers!=null)b.writeString(a.expected_existing_headers);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"patch_headers_if_match",ftype:h.STRING,fid:2});if(a.patch_headers_if_match!=null)b.writeString(a.patch_headers_if_match);else{d="";b.writeString(d)}b.writeFieldEnd();a.patch_headers_otherwise!=null&&(b.writeFieldBegin({fname:"patch_headers_otherwise",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers_otherwise),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function q(a,b){b.writeStructBegin("ResponseData");b.writeFieldBegin({fname:"bytes",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.bytes!=null)b.writeBinary(a.bytes);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.metadata!=null&&(b.writeFieldBegin({fname:"metadata",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.metadata),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function r(a,b){b.writeStructBegin("LogMessage");b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.message!=null)b.writeString(a.message);else{a="";b.writeString(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("Termination");b.writeFieldBegin({fname:"reason",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reason!=null){var e;b.writeI32((e=a.reason)!=null?e:0)}else{e=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.message!=null&&(b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.message),b.writeFieldEnd());a.retry_delay_ms!=null&&(b.writeFieldBegin({fname:"retry_delay_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(c("jsbi").BigInt(a.retry_delay_ms)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function t(a,b){b.writeStructBegin("AmendStreamAck"),a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd()),a.accepted!=null&&(b.writeFieldBegin({fname:"accepted",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:2}),b.writeBool(a.accepted),b.writeFieldEnd()),a.result!=null&&(b.writeFieldBegin({fname:"result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.result),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function u(a,b){b.writeStructBegin("StreamCheck");b.writeFieldBegin({fname:"stream_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.stream_id!=null)b.writeI64(c("jsbi").BigInt(a.stream_id));else{var e="0";b.writeI64(c("jsbi").BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"last_sequencer",ftype:h.I32,fid:2});if(a.last_sequencer!=null)b.writeI32(a.last_sequencer);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"amendment_count",ftype:h.I32,fid:4});if(a.amendment_count!=null)b.writeI32(a.amendment_count);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"last_status",ftype:h.I32,fid:3});if(a.last_status!=null){b.writeI32((e=a.last_status)!=null?e:0)}else{a=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);b.writeI32((e=a)!=null?e:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("Ping");b.writeFieldBegin({fname:"caller_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.caller_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.caller_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.streams_to_check!=null){b.writeFieldBegin({fname:"streams_to_check",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.streams_to_check.length});for(var d=a.streams_to_check,a=Array.isArray(d),e=0,d=a?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(a){if(e>=d.length)break;f=d[e++]}else{e=d.next();if(e.done)break;f=e.value}f=f;u(f,b)}b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("Pong");b.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.original_ping_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.original_ping_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.stream_ids_missing!=null){b.writeFieldBegin({fname:"stream_ids_missing",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.I64,size:a.stream_ids_missing.length});for(var d=a.stream_ids_missing,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(c("jsbi").BigInt(g))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_behind!=null){b.writeFieldBegin({fname:"stream_ids_behind",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:3});b.writeListBegin({etype:h.I64,size:a.stream_ids_behind.length});for(g=a.stream_ids_behind,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}d=d;b.writeI64(c("jsbi").BigInt(d))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_lost_amendments!=null){b.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:4});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_lost_amendments.length});for(d=a.stream_ids_with_lost_amendments,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(c("jsbi").BigInt(g))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_wrong_status!=null){b.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:5});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_wrong_status.length});for(g=a.stream_ids_with_wrong_status,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}a=d;b.writeI64(c("jsbi").BigInt(a))}b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("StreamResponseDelta");if(a.flow_status!=null){var d;b.writeFieldBegin({fname:"flow_status",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.flow_status)!=null?d:0);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.log!=null){b.writeFieldBegin({fname:"log",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});r(a.log,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.rewrite!=null){b.writeFieldBegin({fname:"rewrite",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});o(a.rewrite,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.data!=null){b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});q(a.data,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.termination!=null){b.writeFieldBegin({fname:"termination",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});s(a.termination,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend_ack!=null){b.writeFieldBegin({fname:"amend_ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});t(a.amend_ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.new_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.new_body=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).BOOL?b.kill_body=a.readBool():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).BOOL?b.temporary=a.readBool():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRUCT?b.conditional_patch_headers=z(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function z(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.expected_existing_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_if_match=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_otherwise=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.expected_existing_headers===void 0&&(b.expected_existing_headers="");b.patch_headers_if_match===void 0&&(b.patch_headers_if_match="");return b}function A(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.bytes=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.metadata=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.bytes===void 0&&(b.bytes=Uint8Array.of());return b}function B(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.message===void 0&&(b.message="");return b}function C(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.retry_delay_ms=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.reason===void 0&&(b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0));return b}function D(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).BOOL?b.accepted=a.readBool():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.result=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function E(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.stream_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.last_sequencer=a.readI32():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.amendment_count=a.readI32():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.stream_id===void 0&&(b.stream_id="0");b.last_sequencer===void 0&&(b.last_sequencer=0);b.amendment_count===void 0&&(b.amendment_count=0);b.last_status===void 0&&(b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0));return b}function F(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.caller_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.streams_to_check=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=E(a);b.streams_to_check.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.caller_timestamp_ms===void 0&&(b.caller_timestamp_ms="0");return b}function G(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.original_ping_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_missing=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.stream_ids_missing.push(g)}}else a.skip(e);break;case 3:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_behind=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_behind.push(d)}}else a.skip(e);break;case 4:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_lost_amendments=[];d=a.readListBegin();for(f=0;f<d.size;f++){g=a.readI64().toString();b.stream_ids_with_lost_amendments.push(g)}}else a.skip(e);break;case 5:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_wrong_status=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_with_wrong_status.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.original_ping_timestamp_ms===void 0&&(b.original_ping_timestamp_ms="0");return b}function H(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).I32)if(b==null)e.flow_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()),b="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.log=B(a),b="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.rewrite=y(a),b="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.data=A(a),b="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.termination=C(a),b="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend_ack=D(a),b="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.ResponseRewriteRequest$DefaultConstructor=a;g.ResponseRewriteConditionalPatchHeaders$DefaultConstructor=b;g.ResponseData$DefaultConstructor=e;g.LogMessage$DefaultConstructor=f;g.Termination$DefaultConstructor=i;g.AmendStreamAck$DefaultConstructor=j;g.StreamCheck$DefaultConstructor=k;g.Ping$DefaultConstructor=l;g.Pong$DefaultConstructor=m;g.StreamResponseDelta$DefaultConstructor=n;g.serializeResponseRewriteRequest=o;g.serializeResponseRewriteConditionalPatchHeaders=p;g.serializeResponseData=q;g.serializeLogMessage=r;g.serializeTermination=s;g.serializeAmendStreamAck=t;g.serializeStreamCheck=u;g.serializePing=v;g.serializePong=w;g.serializeStreamResponseDelta=x;g.deserializeResponseRewriteRequest=y;g.deserializeResponseRewriteConditionalPatchHeaders=z;g.deserializeResponseData=A;g.deserializeLogMessage=B;g.deserializeTermination=C;g.deserializeAmendStreamAck=D;g.deserializeStreamCheck=E;g.deserializePing=F;g.deserializePong=G;g.deserializeStreamResponseDelta=H}),98);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500});c=b("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});e.exports={Ack:a,Payload$Types:c}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{body:Uint8Array.of()}}function e(){return{amendment:Uint8Array.of()}}function f(){return{ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}}function i(){return{delta:[]}}function j(){return{}}function k(a,b){b.writeStructBegin("RequestStreamHeaders"),a.headers!=null&&(b.writeFieldBegin({fname:"headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeBinary(a.headers),b.writeFieldEnd()),a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function l(a,b){b.writeStructBegin("RequestStreamBody");b.writeFieldBegin({fname:"body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.body!=null)b.writeBinary(a.body);else{a=Uint8Array.of();b.writeBinary(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a,b){b.writeStructBegin("AmendStream");a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"amendment",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.amendment!=null)b.writeBinary(a.amendment);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.is_query!=null&&(b.writeFieldBegin({fname:"is_query",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:3}),b.writeBool(a.is_query),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function n(a,b){b.writeStructBegin("StreamResponseAck");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.ack!=null){var e;b.writeI32((e=a.ack)!=null?e:0)}else{e=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.query_result!=null&&(b.writeFieldBegin({fname:"query_result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.query_result),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function o(a,b){b.writeStructBegin("StreamResponse");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"delta",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});if(a.delta!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.delta.length});for(var e=a.delta,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(g>=e.length)break;i=e[g++]}else{g=e.next();if(g.done)break;i=g.value}i=i;d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(i,b)}b.writeListEnd()}else{i=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:i.length});for(g=0;g<i.length;g++){f=i[g];d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(f,b)}b.writeListEnd()}b.writeFieldEnd();if(a.ack_level!=null){b.writeFieldBegin({fname:"ack_level",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3});b.writeI32((e=a.ack_level)!=null?e:0);b.writeFieldEnd()}a.query_request!=null&&(b.writeFieldBegin({fname:"query_request",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.query_request),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function p(a,b){b.writeStructBegin("Payload");if(a.request_headers!=null){b.writeFieldBegin({fname:"request_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});k(a.request_headers,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.request_body!=null){b.writeFieldBegin({fname:"request_body",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});l(a.request_body,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend!=null){b.writeFieldBegin({fname:"amend",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});m(a.amend,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ack!=null){b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});n(a.ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.response!=null){b.writeFieldBegin({fname:"response",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});o(a.response,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ping!=null){b.writeFieldBegin({fname:"ping",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});d("RequestStreamCommonRequestStreamCommonSerializers").serializePing(a.ping,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.pong!=null){b.writeFieldBegin({fname:"pong",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7});d("RequestStreamCommonRequestStreamCommonSerializers").serializePong(a.pong,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function q(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.headers=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function r(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.body=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.body===void 0&&(b.body=Uint8Array.of());return b}function s(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.amendment=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.is_query=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.amendment===void 0&&(b.amendment=Uint8Array.of());return b}function t(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.query_result=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.ack===void 0&&(b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0));return b}function u(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).LIST){b.delta=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(a);b.delta.push(i)}}else a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.ack_level=d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.query_request=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.delta===void 0&&(b.delta=[]);return b}function v(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_headers=q(a),b="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_body=r(a),b="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend=s(a),b="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ack=t(a),b="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.response=u(a),b="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ping=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(a),b="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+b);else a.skip(g);break;case 7:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.pong=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(a),b="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.RequestStreamHeaders$DefaultConstructor=a;g.RequestStreamBody$DefaultConstructor=b;g.AmendStream$DefaultConstructor=e;g.StreamResponseAck$DefaultConstructor=f;g.StreamResponse$DefaultConstructor=i;g.Payload$DefaultConstructor=j;g.serializeRequestStreamHeaders=k;g.serializeRequestStreamBody=l;g.serializeAmendStream=m;g.serializeStreamResponseAck=n;g.serializeStreamResponse=o;g.serializePayload=p;g.deserializeRequestStreamHeaders=q;g.deserializeRequestStreamBody=r;g.deserializeAmendStream=s;g.deserializeStreamResponseAck=t;g.deserializeStreamResponse=u;g.deserializePayload=v}),98);
__d("RequestStreamState",["RequestStreamCommonRequestStreamCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(b){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:return a.seenAccepted?a:{flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted,seenAccepted:!0};default:if(!a.seenAccepted||a.flowStatus===b)return a;else return{flowStatus:b,seenAccepted:!0}}}g.getNextState=a}),98);
__d("StreamRetryState",[],(function(a,b,c,d,e,f){"use strict";var g=1e3,h=2*60*1e3;a=function(){function a(){this.$1=0}var b=a.prototype;b.resetErrorAndRetryCount=function(){this.$1=0};b.onRetry=function(){this.$1+=1};b.getRetryCount=function(){return this.$1};b.getBackoffDelayMs=function(){if(this.$1<=1)return 0;if(this.$1===2)return g*Math.random();var a=g*Math.pow(2,this.$1-3),b=a*Math.random();a=a+b;return Math.min(a,h)};return a}();f["default"]=a}),66);
__d("DGWRequestStreamRef",["CompactSerializerPolyfill","DGWRequestStreamUtils","DGWStream","DGWStreamHandler","InflightAmends","Promise","RequestStreamCloseReason","RequestStreamCommonRequestStreamCommonTypes","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","RequestStreamSingleChannelSingleChannelRequestStreamTypes","RequestStreamState","RequestStreamTransport","RtiWebRequestStreamClient","StreamRetryState","err","gkx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=4,j=0,k=1e3,l=2,m=c("gkx")("20915")?3e4:5e3,n="dgw_stream_send_ack_failure";function o(a){if(!a){a=c("err")(n);a.stack;throw a}}function p(a,b){if(a==null||a.length===0)return null;a=JSON.parse(a);a.auxId=b;return new TextEncoder().encode(JSON.stringify(a))}function q(a){var b={};a=a.delta;a.forEach(function(a){if(a.flow_status){b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Flow_status;switch(a.flow_status){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:b.flow_status="Accepted";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:b.flow_status="Started";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:b.flow_status="Stopped";break}}else a.log?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Log:a.rewrite?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Rewrite:a.data?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Data:a.termination?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Termination:a.amend_ack&&(b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Amend_ack)});return b}a=function(){function a(a,b,e,f,g,h){var j=this;this.$6=null;this.$7={};this.$10=!1;this.$15=new(c("StreamRetryState"))();this.$16=0;this.$17=0;this.$18=0;this.$21=0;var k=null;typeof b=="string"?k=new TextEncoder().encode(b):typeof b=="object"&&(k=b);this.$1={headers:a,body:k};this.$3=e;this.$4=f;this.$12=i;this.$9=!1;this.$14=!1;this.$20=h;g!=null&&(this.$22()||(g.dgwStreamGroupLoggingId=this.$20.getStreamGroupLoggingId()),g.dgwCountPriorStreamsInGroup=this.$20.guessStreamGroupPriorStreamCount(),g.transport="WEB_RS_STARGATE");this.$5=d("RequestStreamE2ESampling").validateInstrumentationData(a,g,f==null?void 0:f.requestLogContext,f==null?void 0:f.upsampleMultiplier);!this.$22()?this.$6=d("RequestStreamE2ELogger").createStreamLogger(a,this.$5,d("RequestStreamTransport").RequestStreamTransport.WEB_RS_STARGATE):this.$7.disableFalcoLogging=!0;(f==null?void 0:f.deviceId)!=null&&(this.$7.deviceId=f.deviceId);this.$6&&(this.$7.loggingId=this.$6.getRequestId());f&&f.overrideUrl!=null&&(this.$7.overrideUrl=f.overrideUrl);this.$8={flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped,seenAccepted:!1};this.$19=new(c("InflightAmends"))(m,function(a,b){var d;(d=j.$6)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").RECEIVED,babelHelpers["extends"]({},j.$23(),{latency:b.toString()}),a)},function(a,b){if(b.message!==n){var d;(d=j.$6)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers["extends"]({},j.$23(),{reason:b.message}),a)}});(k=this.$6)==null?void 0:k.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:(h=b==null?void 0:(e=b.length)==null?void 0:e.toString())!=null?h:"0"},"0","0")}var e=a.prototype;e.getInstrumentationData=function(){return this.$5};e.getE2EClientLogger=function(){return this.$6};e.amendWithAck=function(a){a=this.$24(a,!0);return a===null||a===void 0?(h||(h=b("Promise"))).resolve(!1):this.$19.getPromise(a)||(h||(h=b("Promise"))).resolve(!1)};e.amendWithoutAck=function(a){this.$24(a,!1)};e.cancel=function(){var a;(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.$9=!0;this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)};e.start=function(a){var e=this;a===void 0&&(a=!1);var f=String(this.$16++),g=Date.now();return this.$26(f).then(function(){var a;e.$14=!1;e.$21=0;var b=(Date.now()-g).toString();(a=e.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:b},f,String(e.$18))})["catch"](function(g){g.stack;if(g.message===n&&e.$10)return;e.$14=!1;if(g!==d("DGWStream").StreamError.ESTABLISHMENT_ERROR){var i,j=g.message;g===d("DGWStream").StreamError.UNAUTHENTICATED?j="UNAUTHENTICATED":g===d("DGWStream").StreamError.UNAUTHORIZED&&(j="UNAUTHORIZED");(i=e.$6)==null?void 0:i.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:j},f,String(e.$18));e.$25(a?d("RequestStreamCloseReason").RequestStreamCloseReason.ReestablishError:d("RequestStreamCloseReason").RequestStreamCloseReason.StartStreamFailure,j,!0);if(g===d("DGWStream").StreamError.UNAUTHENTICATED||g===d("DGWStream").StreamError.UNAUTHORIZED)return;throw g}else{(i=e.$6)==null?void 0:i.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:(j=g.message)!=null?j:g},f,String(e.$18));e.$15.onRetry();var m=c("gkx")("20916")?e.$15.getBackoffDelayMs():k*Math.pow(l,e.$21);return new(h||(h=b("Promise")))(function(a){return window.setTimeout(a,m)}).then(function(){e.$21++;e.$18++;return e.start()})}})};e.getFlowStatus=function(){return this.$8.flowStatus};e.shouldTerminateOrRetry=function(a,e,f,g){var i=this;if(this.$14)return;var k=e;this.$12||(k="cannot retry for error: "+e+" because of hit max retry limitation");if(a!==d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError){(e=this.$6)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:k},null,String(this.$18))}e=f&&(c("gkx")("20916")||this.$12);this.$25(a,k,!e);if(e){var l=c("gkx")("20916")?Math.max((f=g)!=null?f:0,this.$15.getBackoffDelayMs()):(a=g)!=null?a:j;this.$14=!0;return new(h||(h=b("Promise")))(function(a){return window.setTimeout(a,l)}).then(function(){return i.$27()})["catch"](function(a){})}};e.$28=function(){return this.$11!=null};e.$24=function(a,b){var e,f=this,g=typeof a=="string"?new TextEncoder().encode(a):a,h=String(this.$17++);(e=this.$6)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{},h);e=p(this.$5,h);g={amend:{amendment:g,instrumentation_data:e}};b&&g.amend&&(g.amend.amendment_id=h);e=d("CompactSerializerPolyfill").serialize(g,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);var i=Date.now();if(this.$29()&&this.$11!=null){b&&this.$19.add(h);this.$11.send(e).then(function(a){var b;o(a);a=(Date.now()-i).toString();(b=f.$6)==null?void 0:b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:a},h)})["catch"](function(a){var b;(b=f.$6)==null?void 0:b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:a.message},h);f.$19.reject(h,a)});(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:(e=a==null?void 0:(b=a.length)==null?void 0:b.toString())!=null?e:"0"},h);return h}else{(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},h)}};e.$26=function(a){var e=this,f,g,h,j,k,l,m,n,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:if(this.$9){q.next=39;break}g=this.$2||this.$1;q.prev=2;h=this.$30();this.$13=h;j=g.headers.www_sandbox;k=babelHelpers["extends"]({},g.headers,this.$31());j!=null&&(k=babelHelpers["extends"]({},k,{www_sandbox:j}));l=d("DGWRequestStreamUtils").convertHeaders(k,g.body!=null,this.$5);q.next=11;return b("regeneratorRuntime").awrap(this.$20.establishStream(l,h,this.$7));case 11:this.$11=q.sent;q.next=26;break;case 14:q.prev=14;q.t0=q["catch"](2);if(!(q.t0===d("DGWStream").StreamError.ESTABLISHMENT_ERROR)){q.next=18;break}throw q.t0;case 18:if(!(d("DGWStream").StreamError.isValid(q.t0)&&!d("DGWStream").isRetryableError(q.t0))){q.next=22;break}throw q.t0;case 22:if(!(d("DGWStream").StreamError.isValid(q.t0)&&d("DGWStream").isRetryableError(q.t0))){q.next=25;break}this.$32(q.t0);return q.abrupt("return");case 25:throw q.t0;case 26:if(!this.$9){q.next=29;break}this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0);return q.abrupt("return");case 29:m=new Uint8Array([]);g.body!=null&&(n={request_body:{body:g.body}},m=d("CompactSerializerPolyfill").serialize(n,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload));if(this.$11){q.next=33;break}throw new Error("dgwstream_is_null");case 33:p=this.$11.send(m).then(function(a){o(a),e.$9&&e.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)});(f=this.$6)==null?void 0:f.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").SENT,{},a,String(this.$18));this.$12=i;return q.abrupt("return",p);case 39:throw new Error("stream_already_canceled");case 40:case"end":return q.stop()}},null,this,[[2,14]])};e.$29=function(){return this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started||this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted};e.$25=function(a,b,e){var f;this.$11&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination&&this.$11.close();c("gkx")("20917")&&this.$19.rejectAll(c("err")("stream terminating: "+b));(f=this.$13)==null?void 0:f.stop();this.$11=null;this.$10=!0;this.$33(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped)&&this.$3.onFlowStatus(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped);e&&!this.$9&&this.$3.onTermination("terminate stream because "+a+" with msg : "+b)};e.$33=function(a){var b=this.$8;this.$8=d("RequestStreamState").getNextState(b,a);return b!==this.$8};e.$27=function(){this.$12--;this.$18++;this.$15.onRetry();return this.start(!0)};e.$34=function(a){var b=this;a=d("CompactSerializerPolyfill").deserialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(a.response){var e=d("DGWRequestStreamUtils").getInstrumentationDataFieldsFromPayload(a),f=e==null?void 0:e.auxId;e=e==null?void 0:e.dfTraceId;if(!this.$28()){var g;(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"response_received_after_close"},f,String(this.$18),e);return}(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,q(a.response),f,String(this.$18),e);g=a.response.delta;g.forEach(function(a){if(a.data)b.$15.resetErrorAndRetryCount(),b.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&b.$3.onData(new TextDecoder("utf-8").decode(a.data.bytes));else if(a.flow_status){var c=a.flow_status;c===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&b.$15.resetErrorAndRetryCount();b.$33(c)&&b.$3.onFlowStatus(c)}else if(a.termination){c=(c=a.termination.message)!=null?c:"unknown termination msg";b.$2=null;b.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,c,a.termination.reason===d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.TryAgain,a.termination.retry_delay_ms!=null?parseInt(a.termination.retry_delay_ms,10):null)}else if(a.log)b.$3.onLog(a.log.message);else if(a.amend_ack){c=a.amend_ack.amendment_id;if(c!=null){var e=a.amend_ack.accepted||!1;b.$19.resolve(c,e)}}else if(a.rewrite){c=d("DGWRequestStreamUtils").transformContextWithRewriteDelta(b.$1,a.rewrite);a.rewrite.temporary===!0?b.$2=c:b.$1=c}});(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,q(a.response),f,String(this.$18),e);a.response.ack_level===d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.Device&&a.response.response_id!=null&&this.$35(a.response.response_id,f)}else{(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"unexpected_payload_type"},null,String(this.$18))}};e.$35=function(a,b){a={ack:{response_id:a,ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.Success}};a=d("CompactSerializerPolyfill").serialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);if(this.$11!=null){this.$11.send(a);(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").SENT,{},b,String(this.$18))}else{(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},b,String(this.$18))}};e.$22=function(){return this.$1.headers.method==="Falco"};e.$30=function(){return new(c("DGWStreamHandler"))(this.$36.bind(this),this.$37.bind(this),this.$32.bind(this),this.$38.bind(this),this.$39.bind(this))};e.$39=function(a){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Has FinishedSendingData"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDataEnd,"Client receive OnServerHasFinishedSendingData and Server will not send more data",!0)};e.$36=function(a){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Close Connection"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,"Client receive OnClose and Server will not send more data",!0)};e.$37=function(a){try{this.$34(a)}catch(b){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:b.message},null,String(this.$18));this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError,b.message,!1)}};e.$32=function(a){var b="",c=d("DGWStream").isRetryableError(a);b="StreamError: Received "+a;this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError,b,c)};e.$38=function(a,b){this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDrain,b,!0)};e.$31=function(){return c("RtiWebRequestStreamClient").overrideHeaders};e.$23=function(){var a={};c("gkx")("20918")&&(a.pending_amendments_size=this.$19.getSize().toString());return a};return a}();g["default"]=a}),98);
__d("DGWStreamGroupHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=c}var b=a.prototype;b.onStreamGroupError=function(a){this.$1(a)};b.onStreamGroupMustDrain=function(a){this.$2(a)};b.onStreamGroupTransportClose=function(){this.$3()};return a}();f["default"]=a}),66);
__d("DGWStreamFactory",["DGWClient","DGWStreamGroupHandler","Promise","gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="realtime",j=1e4,k=null;a=function(){function a(){this.$3=0,this.$1=null,c("gkx")("20920")&&(this.$2=c("uuidv4")())}a.get=function(){k==null&&(k=new a());return k};var d=a.prototype;d.getStreamGroupLoggingId=function(){return this.$2};d.guessStreamGroupPriorStreamCount=function(){return this.$3};d.establishStream=function(a,d,e){var f=this;if(this.$1==null||!this.$1.canCreateGroupedStream()){var g={deviceId:e.deviceId,serviceId:i,disableFalcoLogging:e.disableFalcoLogging,streamGroupAppHeaders:{"stream-group":"group1"}};e.overrideUrl!=null&&(g.overrideUrl=e.overrideUrl);g.keepAliveMs=j;c("gkx")("20920")?(this.$2=c("uuidv4")(),g.loggingId=this.$2):this.$2=null;this.$3=0;try{this.$1=c("DGWClient")().createStreamGroup(new(c("DGWStreamGroupHandler"))(function(){f.$1=null},function(){f.$1=null},function(){f.$1=null}),g)}catch(a){return(h||(h=b("Promise"))).reject(a)}}this.$3++;return this.$1.establishStream({loggingId:e.loggingId,disableFalcoLogging:e.disableFalcoLogging,groupedStreamHeaders:a},d)};return a}();g["default"]=a}),98);
__d("DGWRequestStreamClient",["DGWRequestStreamRef","DGWStreamFactory","Promise","cr:2046346"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$1=a!=null?a:c("DGWStreamFactory").get()}var d=a.prototype;d.createStream=function(a,d,e,f,g){b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return(h||(h=b("Promise"))).resolve(new(c("DGWRequestStreamRef"))(a,d,f,g,e,this.$1))};return a}();g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("PolarisLoggedOutEndOfClipUpsell.react",["fbt","ix","IGCoreImage.react","IGDSBox.react","IGDSButton.react","IGDSIconButton.react","IGDSText.react","PolarisAppInstallStrings","PolarisIgLiteCarbonUpsellsUtils","PolarisLinkBuilder","PolarisLoggedOutCtaClickLogger","PolarisLoggedOutCtaLogger","PolarisLoggedOutUpsellStrings","PolarisNavigationStrings","PolarisOpenInApp","browserHistory_DO_NOT_USE","react","usePolarisGetDeepLink","usePolarisPageID"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;b.useCallback;var l=b.c,m={button:{borderTopStartRadius:"xfh8nwu",borderTopEndRadius:"xoqspk4",borderBottomEndRadius:"x12v9rci",borderBottomStartRadius:"x138vmkv",height:"xn3w4p2",$$css:!0},buttonPrimaryBlack:{backgroundColor:"x1ma4ser",$$css:!0},icon:{height:"x1peatla",width:"x1fu8urw",$$css:!0}};function a(){var a=l(23),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=d("PolarisIgLiteCarbonUpsellsUtils").isIgLiteCarbonUpsellsEligible(),a[0]=b):b=a[0];var e=b,f=c("usePolarisGetDeepLink")(),g=c("usePolarisPageID")();a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=d("PolarisLinkBuilder").buildLoginLink(d("browserHistory_DO_NOT_USE").getPath(d("browserHistory_DO_NOT_USE").browserHistory),{source:"logged_out_video_overlay"}),a[1]=b):b=a[1];b=b;var j;a[2]!==g?(j=function(){d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"end_of_video_app_upsell",ctaVersion:e?"instagramlitecarbon":"",eventName:"login_click",module:g}),d("PolarisLoggedOutCtaClickLogger").logLoggedOutCtaClickEvent("login","video_end",g)},a[2]=g,a[3]=j):j=a[3];j=j;var n;a[4]!==f||a[5]!==g?(n=function(){var a=f(),b=a.android,c=a.ios;a=a.originalPath;d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"end_of_video_app_upsell",ctaVersion:e?"instagramlitecarbon":"",eventName:"app_open_click",module:g});d("PolarisLoggedOutCtaClickLogger").logLoggedOutCtaClickEvent("app_open","video_end",g);d("PolarisOpenInApp").openInApp(b,c,a,e)},a[4]=f,a[5]=g,a[6]=n):n=a[6];n=n;var o;a[7]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._("__JHASH__EubW9vzR0uu__JHASH__"),a[7]=o):o=a[7];a[8]===Symbol["for"]("react.memo_cache_sentinel")?(o=k.jsx(c("IGCoreImage.react"),{alt:o,objectFit:"cover",src:{light:i("387448")}}),a[8]=o):o=a[8];a[9]!==n?(o=k.jsx(c("IGDSBox.react"),{maxHeight:800,overflow:"auto",children:k.jsx(c("IGDSBox.react"),{alignItems:"center",justifyContent:"center",children:k.jsx(c("IGDSIconButton.react"),{onClick:n,padding:0,xstyle:m.icon,children:o})})}),a[9]=n,a[10]=o):o=a[10];var p;a[11]===Symbol["for"]("react.memo_cache_sentinel")?(p=k.jsx(c("IGDSBox.react"),{marginBottom:6,marginTop:6,children:k.jsx(c("IGDSText.react").TitleEmphasized,{color:"textOnMedia",textAlign:"center",children:d("PolarisLoggedOutUpsellStrings").KEEP_WATCHING_TEXT})}),a[11]=p):p=a[11];var q;a[12]!==n?(q=k.jsx(c("IGDSButton.react"),{display:"block",label:d("PolarisAppInstallStrings").OPEN_THE_INSTAGRAM_APP,onClick:n,variant:"secondary",xstyle:m.button}),a[12]=n,a[13]=q):q=a[13];a[14]===Symbol["for"]("react.memo_cache_sentinel")?(n=[m.button,m.buttonPrimaryBlack],a[14]=n):n=a[14];a[15]!==j?(b=k.jsx(c("IGDSButton.react"),{display:"block",href:b,label:d("PolarisNavigationStrings").LOG_IN_TEXT,onClick:j,variant:"primary_black",xstyle:n}),a[15]=j,a[16]=b):b=a[16];a[17]!==q||a[18]!==b?(n=k.jsxs(c("IGDSBox.react"),{rowGap:3,children:[q,b]}),a[17]=q,a[18]=b,a[19]=n):n=a[19];a[20]!==o||a[21]!==n?(j=k.jsx(c("IGDSBox.react"),{justifyContent:"center",marginBottom:"auto",marginEnd:0,marginStart:0,marginTop:"auto",children:k.jsxs(c("IGDSBox.react"),{alignItems:"stretch",flex:"grow",padding:4,children:[o,p,n]})}),a[20]=o,a[21]=n,a[22]=j):j=a[22];return j}g["default"]=a}),226);
__d("PolarisLoggedOutEndOfVideoUpsell.react",["fbt","ix","IGCoreImage.react","IGDSBox.react","IGDSButton.react","IGDSIconButton.react","IGDSText.react","PolarisAppInstallStrings","PolarisFastLink.react","PolarisIgLiteCarbonUpsellsUtils","PolarisLinkBuilder","PolarisLoggedOutCtaClickLogger","PolarisLoggedOutCtaLogger","PolarisLoggedOutUpsellStrings","PolarisNavigationStrings","PolarisOpenInApp","browserHistory_DO_NOT_USE","react","usePolarisGetDeepLink","usePolarisPageID"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;b.useCallback;var l=b.c,m={icon:{height:"xqvfhly",width:"xzuapc8",$$css:!0}};function a(){var a=l(23),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=d("PolarisIgLiteCarbonUpsellsUtils").isIgLiteCarbonUpsellsEligible(),a[0]=b):b=a[0];var e=b,f=c("usePolarisGetDeepLink")(),g=c("usePolarisPageID")();a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=d("PolarisLinkBuilder").buildLoginLink(d("browserHistory_DO_NOT_USE").getPath(d("browserHistory_DO_NOT_USE").browserHistory),{source:"logged_out_video_overlay"}),a[1]=b):b=a[1];b=b;var j;a[2]!==g?(j=function(){d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"end_of_video_app_upsell",ctaVersion:e?"instagramlitecarbon":"",eventName:"login_click",module:g}),d("PolarisLoggedOutCtaClickLogger").logLoggedOutCtaClickEvent("login","video_end",g)},a[2]=g,a[3]=j):j=a[3];j=j;var n;a[4]!==f||a[5]!==g?(n=function(){var a=f(),b=a.android,c=a.ios;a=a.originalPath;d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"end_of_video_app_upsell",ctaVersion:e?"instagramlitecarbon":"",eventName:"app_open_click",module:g});d("PolarisLoggedOutCtaClickLogger").logLoggedOutCtaClickEvent("app_open","video_end",g);d("PolarisOpenInApp").openInApp(b,c,a,e)},a[4]=f,a[5]=g,a[6]=n):n=a[6];n=n;var o;a[7]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._("__JHASH__EubW9vzR0uu__JHASH__"),a[7]=o):o=a[7];a[8]===Symbol["for"]("react.memo_cache_sentinel")?(o=k.jsx(c("IGCoreImage.react"),{alt:o,objectFit:"cover",src:{light:i("382940")}}),a[8]=o):o=a[8];a[9]!==n?(o=k.jsx(c("IGDSBox.react"),{maxHeight:800,overflow:"auto",position:"relative",children:k.jsx(c("IGDSBox.react"),{alignItems:"center",justifyContent:"center",marginBottom:1,paddingY:3,position:"relative",children:k.jsx(c("IGDSIconButton.react"),{onClick:n,padding:0,xstyle:m.icon,children:o})})}),a[9]=n,a[10]=o):o=a[10];var p;a[11]===Symbol["for"]("react.memo_cache_sentinel")?(p=k.jsx(c("IGDSBox.react"),{marginBottom:5,marginTop:2,position:"relative",children:k.jsx(c("IGDSText.react").LabelEmphasized,{textAlign:"center",children:d("PolarisLoggedOutUpsellStrings").KEEP_WATCHING_TEXT})}),a[11]=p):p=a[11];var q;a[12]!==n?(q=k.jsx(c("IGDSButton.react"),{display:"block",label:d("PolarisAppInstallStrings").OPEN_THE_INSTAGRAM_APP,onClick:n,variant:"primary"}),a[12]=n,a[13]=q):q=a[13];a[14]===Symbol["for"]("react.memo_cache_sentinel")?(n=k.jsx(c("IGDSText.react").BodyEmphasized,{color:"primaryButton",textAlign:"center",children:d("PolarisNavigationStrings").LOG_IN_TEXT}),a[14]=n):n=a[14];a[15]!==j?(b=k.jsx(c("IGDSBox.react"),{alignItems:"center",justifyContent:"center",minHeight:40,width:"100%",children:k.jsx(c("PolarisFastLink.react"),{display:"inline",href:b,onClick:j,children:n})}),a[15]=j,a[16]=b):b=a[16];a[17]!==q||a[18]!==b?(n=k.jsxs(c("IGDSBox.react"),{position:"relative",children:[q,b]}),a[17]=q,a[18]=b,a[19]=n):n=a[19];a[20]!==o||a[21]!==n?(j=k.jsx(c("IGDSBox.react"),{justifyContent:"center",margin:"auto",position:"relative",children:k.jsx(c("IGDSBox.react"),{color:"primaryBackground",flex:"shrink",position:"relative",shape:"extraRounded",width:260,children:k.jsxs(c("IGDSBox.react"),{padding:4,position:"relative",children:[o,p,n]})})}),a[20]=o,a[21]=n,a[22]=j):j=a[22];return j}g["default"]=a}),226);
__d("oz-player/shims/ozReportUnexpectedError",["oz-player/shims/www/ozReportUnexpectedErrorWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/ozReportUnexpectedErrorWWW")}),98);
__d("oz-player/loggings/OzLoggingUtils",["oz-player/shims/ozReportUnexpectedError"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){a=a.getOperationLogger(b).start();try{return c(a)}catch(b){a.setError(b);throw b}finally{a.log()}}function b(a,b,d,e,f){e===void 0&&(e=function(){});f===void 0&&(f=function(){});var g=b.getOperationLogger(d).start();e(g);a.then(function(a){f(g),g.log()},function(a){f(g),g.setError(a),g.log()})["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,d+" logger")})}g.executeOperationAndLog=a;g.monitorPromiseAndLogOperation=b}),98);
__d("oz-player/loggings/OzOperationLoggerBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$52=new Map(),this.$1=a}var b=a.prototype;b.start=function(){var a=Date.now();this.setClientTimeBegin(a);this.setClientTimeEnd(null);this.setClientTimeDuration(null);return this};b.log=function(){var a=Date.now(),b=this.getClientTimeBegin(),c=this.getClientTimeEnd();(b==null||b===0)&&(b=a,this.setClientTimeBegin(b));(c==null||c===0)&&(c=a,this.setClientTimeEnd(c));this.setClientTimeDuration(c-b)};b.setError=function(a){this.$2=a;return this};b.setPerSessionSampleRate=function(a){this.$3=a;return this};b.setAppendTarget=function(a){this.$47=a;return this};b.setOneObserved=function(a){this.$44=a;return this};b.setOneReqWave=function(a){this.$45=a;return this};b.setOneResWave=function(a){this.$46=a;return this};b.setIsP2pPlayback=function(a){this.$43=a;return this};b.setResult=function(a){this.$4=a;return this};b.setType=function(a){this.$5=a;return this};b.setClientTimeBegin=function(a){this.$6=a;return this};b.setClientTimeDuration=function(a){this.$7=a;return this};b.setClientTimeEnd=function(a){this.$8=a;return this};b.setSegmentCount=function(a){this.$15=a;return this};b.setTimeToFirstByte=function(a){this.$9=a;return this};b.setTimeToLastByte=function(a){this.$10=a;return this};b.setTimeToRequestStart=function(a){this.$11=a;return this};b.setTimeToRequestSent=function(a){this.$12=a;return this};b.setReason=function(a){this.$13=a;return this};b.setResource=function(a){this.$14=a;return this};b.setSegmentStartTime=function(a){this.$16=a;return this};b.setSegmentEndTime=function(a){this.$17=a;return this};b.setLength=function(a){this.$18=a;return this};b.setLiveheadPosition=function(a){this.$19=a;return this};b.setLiveheadSeqNumHeader=function(a){this.$20=a;return this};b.setLiveheadSeqNumMpd=function(a){this.$21=a;return this};b.setManifestType=function(a){this.$22=a;return this};b.setMediaSourceNewDuration=function(a){this.$23=a;return this};b.setMediaSourcePreviousDuration=function(a){this.$24=a;return this};b.setPriorityFloat=function(a){this.$25=a;return this};b.setAppendedBufferMs=function(a){this.$26=a;return this};b.setInitiator=function(a){this.$27=a;return this};b.setPreloadTime=function(a){this.$28=a;return this};b.setConcluder=function(a){this.$29=a;return this};b.setPreviousRepresentationID=function(a){this.$30=a;return this};b.setRepresentationID=function(a){this.$31=a;return this};b.setStreamSwitchReason=function(a){this.$32=a;return this};b.setState=function(a){this.$33=a;return this};b.setContentLengthHeader=function(a){this.$34=a;return this};b.setOriginHitHeader=function(a){this.$36=a;return this};b.setEdgeHitHeader=function(a){this.$37=a;return this};b.setFNAHitHeader=function(a){this.$38=a;return this};b.setCode=function(a){this.$35=a;return this};b.setResponseTimeMsHeader=function(a){this.$39=a;return this};b.setIsTemplatedManifest=function(a){this.$40=a;return this};b.setIsLatencyCachupEnabled=function(a){this.$41=a;return this};b.setPlayerFormat=function(a){this.$42=a;return this};b.setIsRingBufferSample=function(a){this.$48=a;return this};b.setIsOnline=function(a){this.$49=a;return this};b.setProxyStatusHeader=function(a){this.$50=a;return this};b.setPlaybackFbmsParam=function(a){return this};b.setPreferredEdgeLatency=function(a){this.$51=a;return this};b.setUserInfo=function(a){return this};b.setDynamicStatusHeader=function(a){return this};b.setIsMixedCodecManifest=function(a){this.$53=a;return this};b.getPerSessionSampleRate=function(){return this.$3};b.setMediaSourceSourceBuffer=function(a,b){this.$52.set(a,b);return this};b.unsetMediaSourceSourceBuffers=function(){this.$52.clear();return this};b.getError=function(){return this.$2};b.getResult=function(){return this.$4};b.getType=function(){return this.$5};b.getClientTimeBegin=function(){return this.$6};b.getClientTimeEnd=function(){return this.$7!=null?this.$6!=null?this.$6+this.$7:null:this.$8};b.getTimeToRequestStart=function(){return this.$11};b.getTimeToRequestSent=function(){return this.$12};b.getReason=function(){return this.$13};b.getResource=function(){return this.$14};b.getOperationName=function(){return this.$1};b.getSegmentStartTime=function(){return this.$16};b.getSegmentEndTime=function(){return this.$17};b.getLength=function(){return this.$18};b.getLiveheadPosition=function(){return this.$19};b.getManifestType=function(){return this.$22};b.getIsMixedCodecManifest=function(){return this.$53};b.getPriorityFloat=function(){return this.$25};b.getAppendedBufferMs=function(){return this.$26};b.getInitiator=function(){return this.$27};b.getPreloadTime=function(){return this.$28};b.getConcluder=function(){return this.$29};b.getContentLengthHeader=function(){return this.$34};b.getOriginHitHeader=function(){return this.$36};b.getEdgeHitHeader=function(){return this.$37};b.getFNAHitHeader=function(){return this.$38};b.getCode=function(){return this.$35};b.getResponseTimeMsHeader=function(){return this.$39};b.getIsTemplatedManifest=function(){return this.$40};b.getOneObserved=function(){return this.$44};b.getOneReqWave=function(){return this.$45};b.getOneResWave=function(){return this.$46};b.getAppendTarget=function(){return this.$47};b.getIsRingBufferSample=function(){return this.$48};b.getIsOnline=function(){return this.$49};b.getProxyStatusHeader=function(){return this.$50};b.getMediaSourceSourceBuffers=function(){return this.$52};return a}();f["default"]=a}),66);
__d("oz-player/shims/www/OzMaybeNativePromiseWWW",["cr:3014"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:3014")}),98);
__d("oz-player/shims/OzMaybeNativePromise",["oz-player/shims/www/OzMaybeNativePromiseWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzMaybeNativePromiseWWW")}),98);
__d("oz-player/utils/OzErrorEmitter",["oz-player/shims/OzEventEmitter","oz-player/shims/ozvariant"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var d;b===void 0&&(b=!1);d=a.call(this)||this;d.$OzErrorEmitter$p_1=!1;d.$OzErrorEmitter$p_2=!1;d.$OzErrorEmitter$p_3=[];d.emitError=function(a){!d.$OzErrorEmitter$p_1?d.$OzErrorEmitter$p_2?d.$OzErrorEmitter$p_3.push(a):d.$OzErrorEmitter$p_1||c("oz-player/shims/ozvariant")(0,14038):d.emit("error",a)};d.$OzErrorEmitter$p_2=b;return d}var d=b.prototype;d.onError=function(a){this.$OzErrorEmitter$p_1=!0;a=this.addListener("error",a);this.$OzErrorEmitter$p_2&&this.$OzErrorEmitter$p_3.length>0&&this.$OzErrorEmitter$p_3.forEach(this.emitError);return a};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/drm/OzDrmManager",["oz-player/drm/OzDrmUtils","oz-player/loggings/OzLoggingUtils","oz-player/loggings/OzOperationLoggerBase","oz-player/shims/OzDOMEventListener","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzSubscriptionsHandler","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e){var f=this;e===void 0&&(e=null);this.$1=null;this.$2=new Map();this.$4=!1;this.$6=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$7=new(c("oz-player/utils/OzErrorEmitter"))();this.$8=!1;this.$9=null;this.$10=0;this.$11=[];this.$12=[];this.$22=function(a,b){a instanceof c("oz-player/loggings/OzOperationLoggerBase")&&a.getError()&&a.setResult("failed"),b!=null&&a.setReason(b)};this.$19=function(a){if(f.$4)return c("oz-player/shims/OzMaybeNativePromise").reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"OzDrmManager destroyed before call to mediaKeySystemAccess.createMediaKeys()."}));var b=f.$5.mediaKeys!=null?c("oz-player/shims/OzMaybeNativePromise").resolve(f.$5.mediaKeys):a.createMediaKeys();b=b.then(function(b){return{mediaKeySystemAccess:a,mediaKeys:b}});d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(b,f.$3,"drm_create_media_keys",function(){},f.$22);return b};this.$20=function(a){if(f.$4)return c("oz-player/shims/OzMaybeNativePromise").reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"OzDrmManager destroyed before call to setMediaKeys()"}));var b=a.mediaKeySystemAccess,e=a.mediaKeys;if(!e)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"No mediaKeys for mediaKeySystemAccess"});a=f.$5.setMediaKeys(e).then(function(){if(f.$4)return c("oz-player/shims/OzMaybeNativePromise").reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"OzDrmManager destroyed after setMediaKeys() called."}));var a=Array.from(f.$2.values()).find(function(a){return a.getKeySystem()===b.keySystem});if(!a)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"Can't find OzDrmProvider for keySystem "+b.keySystem});var g=a.getServerCertificate();return g?e.setServerCertificate(g).then(function(){return{mediaKeys:e,provider:a}}):{mediaKeys:e,provider:a}});d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(a,f.$3,"drm_set_media_keys",function(){},f.$22);return a};this.$21=function(a){var b=a.mediaKeys,e=a.provider;a=e.getInitDatas();if(a.length===0){f.$6.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(f.$5,"encrypted",function(a){f.$23(b,e,a)["catch"](function(a){f.$14(d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{type:"OZ_DRM_MANAGER",description:"DRM encrypted rejection"}))})}));return c("oz-player/shims/OzMaybeNativePromise").resolve([])}a=a.map(function(a){return f.$23(b,e,{initData:a.data,initDataType:a.type})});a=c("oz-player/shims/OzMaybeNativePromise").all(a);d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(a,f.$3,"drm_request_license",function(){},f.$22);return a};this.$5=b;this.$1=e;this.$3=a.cloneContext().setType("drm_manager")}var b=a.prototype;b.hasContentProtections=function(){return this.$9};b.onError=function(a){return this.$7.onError(a)};b.$13=function(a){this.$7.emitError(a)};b.$14=function(a){var b;b=(b=(b=this.$1)==null?void 0:b.maxStartEMEAttempts)!=null?b:-1;this.$10<b?this.$15():this.$13(a)};b.addProvider=function(a){this.$2.set(a.getSchemeId(),a)};b.getProviderForSchemeId=function(a){return this.$2.get(a)};b.$16=function(a){if(!a)return null;var b=[];for(var c=0;c<a.length;c++){var e=a[c],f=e.$.schemeIdUri;f=this.getProviderForSchemeId(f);if(f){var g=f.getInitDatas();if(g.length==0&&e["cenc:pssh"]&&e["cenc:pssh"].length===1){e=(e=e["cenc:pssh"][0]._)!=null?e:"";e=d("oz-player/drm/OzDrmUtils").base64ToUint8Array(e.replace(/-/g,"+").replace(/_/g,"/"));g=[{data:e,type:"cenc"}];f.setInitDatas(g)}b.push({provider:f,initDatas:g})}}return b};b.$15=function(){try{this.$8=!1,this.startEME(this.$11,this.$12)}catch(b){var a=b;this.$13(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"Restart EME failed with: "+String(a),extra:{}}))}};b.startEME=function(a,b){var c=this;if(this.$8)return;this.$8=!0;this.$10+=1;this.$11=a;this.$12=b;var e=new Map();this.$17(b,e,"audio");this.$17(a,e,"video");var f;e.forEach(function(a,b){!f?f=c.$18(b,a):f=f["catch"](function(){return c.$18(b,a)})});if(!f){this.$9=!1;return}this.$9=!0;var g=this.$3.getOperationLogger("drm_setup").start();f.then(this.$19).then(this.$20).then(this.$21).then(function(){return g.log()},function(a){a=d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{type:"OZ_DRM_MANAGER",description:"DRM keyPromiseChain rejection"});c.$13(a);g.setResult("failed").setError(a).log()})};b.$17=function(a,b,c){var d=this;a.forEach(function(a){var e=d.$16(a.getContentProtectionXml()),f=a.getMimeCodecs();e!=null&&e.forEach(function(a){a=a.provider;var d=a.getKeySystem(),e=b.get(d);e||(e={audioCapabilities:new Map(),videoCapabilities:new Map(),distinctiveIdentifier:a.getRequireDistinctiveIdentifier(),persistentState:a.getRequirePersistentState(),sessionTypes:a.getDrmSessionTypes(),initDataTypes:a.getInitDataTypes()},b.set(d,e));c==="audio"&&!e.audioCapabilities.has(f)&&e.audioCapabilities.set(f,{contentType:f,robustness:a.getAudioRobustness()});c==="video"&&!e.videoCapabilities.has(f)&&e.videoCapabilities.set(f,{contentType:f,robustness:a.getVideoRobustness()})})})};b.destroy=function(){this.$6.release(),this.$4=!0};b.$18=function(a,b){var e=this,f={audioCapabilities:Array.from(b.audioCapabilities.values()),videoCapabilities:Array.from(b.videoCapabilities.values()),distinctiveIdentifier:b.distinctiveIdentifier,persistentState:b.persistentState,sessionTypes:b.sessionTypes,initDataTypes:b.initDataTypes};b=window.navigator.requestMediaKeySystemAccess(a,[f]);d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(b,this.$3,"drm_request_media_key_system_access",function(){},function(b){var d=null;b instanceof c("oz-player/loggings/OzOperationLoggerBase")&&b.getError()&&(d="keySystem: "+a+";domConfig: "+JSON.stringify(f));return e.$22(b,d)});return b};b.$23=function(a,b,e){var f=this,g=a.createSession();this.$6.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g,"message",function(a){f.$24(g,b,a)["catch"](function(a){f.$14(d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{type:"OZ_DRM_MANAGER",description:"DRM message rejection"}))})}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(g,"keystatuseschange",function(a){f.$25(g)["catch"](function(a){f.$14(d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{type:"OZ_DRM_MANAGER",description:"DRM keystatuseschange rejection"}))})}));return g.generateRequest(e.initDataType,e.initData)};b.$24=function(a,b,c){var e=this;c=b.getLicenseRequestInfo(c.message.slice(0));var f=this.$3.getOperationLogger("drm_fetch_license").setResource(c.url).start();return window.fetch(c.url,c).then(function(c){c.ok?f.setResult("success").setCode(c.status).log():f.setResult("failed").setCode(c.status).setError(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"DRM license fetch HTTP status not OK ("+c.status+")",extra:{code:c.status.toString()}})).log();return c.arrayBuffer().then(function(f){var g=new Uint8Array(f);g=b.parseLicenseResponse(g);if(g==null||g.byteLength===0){var h=g==null?"License is null or undefined.":"License is 0 bytes.";!c.ok?h+=" HTTP status not OK ("+c.status+")":f.byteLength===0&&(h+=" HTTP status OK ("+c.status+"), but response body is 0 bytes");f=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DRM_MANAGER",description:"No license for "+b.getKeySystem()+" - "+h,extra:{code:c.status.toString(),headers:c.headers,url:c.url}});h=(h=(h=e.$1)==null?void 0:h.throwNoLicenseError)!=null?h:!1;if(h)throw f;else e.$13(f)}else a.update(g)})})};b.$25=function(a){return a.expiration<Date.now()?a.close():c("oz-player/shims/OzMaybeNativePromise").resolve()};return a}();g.OzDrmManager=a}),98);
__d("oz-player/loggings/OzPerfLoggerProviderBase",["oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.cloneContext=function(){var a=this.createLoggerProvider();this.$11(a);return a};b.setType=function(a){this.$1=a;return this};b.setInitiator=function(a){this.$2=a;return this};b.setResource=function(a){this.$4=a;return this};b.setRepresentationID=function(a){this.$3=a;return this};b.setSegmentStartTime=function(a){this.$5=a;return this};b.setSegmentEndTime=function(a){this.$6=a;return this};b.setStreamSwitchReason=function(a){this.$7=a;return this};b.setIsP2pPlayback=function(a){this.$8=a;return this};b.setIsRingBufferSample=function(a){this.$9=a;return this};b.setPerSessionSampleRate=function(a){this.$10=a;return this};b.getType=function(){return this.$1};b.getInitiator=function(){return this.$2};b.getRepresentationID=function(){return this.$3};b.getStreamSwitchReason=function(){return this.$7};b.getResource=function(){return this.$4};b.getSegmentStartTime=function(){return this.$5};b.getSegmentEndTime=function(){return this.$6};b.getIsP2pPlayback=function(){return this.$8};b.getIsRingBufferSample=function(){return this.$9};b.getOperationLogger=function(a){a=this.createOperationLogger(a);return this.setOperationContext(a)};b.setOperationContext=function(a){this.$11(a);return a};b.createOperationLogger=function(a){throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NOT_IMPLEMENTED_ERROR",description:"Not implemented: createOperationLogger"})};b.createLoggerProvider=function(){throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NOT_IMPLEMENTED_ERROR",description:"Not implemented: createLoggerProvider"})};b.$11=function(a){this.getType()&&a.setType(this.getType()),this.getInitiator()&&a.setInitiator(this.getInitiator()),this.getResource()&&a.setResource(this.getResource()),this.getRepresentationID()&&a.setRepresentationID(this.getRepresentationID()),this.getStreamSwitchReason()&&a.setStreamSwitchReason(this.getStreamSwitchReason()),typeof this.getSegmentStartTime()==="number"&&a.setSegmentStartTime(this.getSegmentStartTime()),typeof this.getSegmentEndTime()==="number"&&a.setSegmentEndTime(this.getSegmentEndTime()),typeof this.getIsP2pPlayback()==="boolean"&&a.setIsP2pPlayback(this.getIsP2pPlayback()),typeof this.getIsRingBufferSample()==="boolean"&&a.setIsRingBufferSample(this.getIsRingBufferSample())};return a}();g["default"]=a}),98);
__d("oz-player/loggings/OzDevConsolePerfLogger",["oz-player/loggings/OzOperationLoggerBase","oz-player/loggings/OzPerfLoggerProviderBase"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a;for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];(a=console).debug.apply(a,["[oz]"].concat(c))}function i(){var a;for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];(a=console).error.apply(a,["[oz]"].concat(c))}function j(a,b){return Math.floor(a).toString().padStart(b,"0")}function k(a,b){b===void 0&&(b=null);var c=function(a){return j(a.getHours(),2)+":"+j(a.getMinutes(),2)+":"+j(a.getSeconds(),2)+" "+j(a.getMilliseconds(),3)},d=b?b.getTime()-a.getTime():0;return"["+c(a)+(b?" - "+c(b):"")+" ("+d+" ms)]"}function l(a){return a==="failed"?i:h}function m(a){return a==null||a===0?null:a.toFixed(2)}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.createOperationLogger=function(a){return new n(a)};c.createLoggerProvider=function(){return new b()};return b}(c("oz-player/loggings/OzPerfLoggerProviderBase"));var n=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.log=function(){b.prototype.log.call(this);var a=this.getClientTimeBegin()||0,c=this.getClientTimeEnd();c=c!=null&&c!==0?new Date(c):null;var d=this.getResult()||"success",e=this.getType(),f=this.getInitiator(),g=this.getResource(),h=m(this.getSegmentStartTime()),i=m(this.getSegmentEndTime());l(d)("["+d+"]",this.getOperationName()+": "+k(new Date(a),c),e!=null&&e!==""?"["+e+"]":"",h!=null&&h!==""&&i!=null&&i!==""?"[segment time range: "+h+" - "+i+"]":"",f||"",g||"")};return a}(c("oz-player/loggings/OzOperationLoggerBase"));g.OzDevConsolePerfLoggerProvider=a;g.OzDevConsoleOperationLogger=n}),98);
__d("oz-player/loggings/OzMultiDestinationPerfLogger",["oz-player/loggings/OzOperationLoggerBase","oz-player/loggings/OzPerfLoggerProviderBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$OzMultiDestinationPerfLoggerProvider$p_1=b;return c}var c=b.prototype;c.createOperationLogger=function(a){return new h(a,this.$OzMultiDestinationPerfLoggerProvider$p_1.map(function(b){return b.getOperationLogger(a)}))};c.createLoggerProvider=function(){return new b(this.$OzMultiDestinationPerfLoggerProvider$p_1)};return b}(c("oz-player/loggings/OzPerfLoggerProviderBase"));var h=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.$OzMultiDestinationOperationLogger$p_1=c;return a}var c=a.prototype;c.start=function(){b.prototype.start.call(this);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(a){return a.start()});return this};c.setPerSessionSampleRate=function(a){b.prototype.setPerSessionSampleRate.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPerSessionSampleRate(a)});return this};c.setResult=function(a){b.prototype.setResult.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setResult(a)});return this};c.setError=function(a){b.prototype.setError.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setError(a)});return this};c.setType=function(a){b.prototype.setType.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setType(a)});return this};c.setMediaSourcePreviousDuration=function(a){b.prototype.setMediaSourcePreviousDuration.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setMediaSourcePreviousDuration(a)});return this};c.setMediaSourceNewDuration=function(a){b.prototype.setMediaSourceNewDuration.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setMediaSourceNewDuration(a)});return this};c.setClientTimeBegin=function(a){b.prototype.setClientTimeBegin.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setClientTimeBegin(a)});return this};c.setClientTimeDuration=function(a){b.prototype.setClientTimeDuration.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setClientTimeDuration(a)});return this};c.setClientTimeEnd=function(a){b.prototype.setClientTimeEnd.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setClientTimeEnd(a)});return this};c.setSegmentCount=function(a){b.prototype.setSegmentCount.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setSegmentCount(a)});return this};c.setTimeToFirstByte=function(a){b.prototype.setTimeToFirstByte.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setTimeToFirstByte(a)});return this};c.setTimeToLastByte=function(a){b.prototype.setTimeToLastByte.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setTimeToLastByte(a)});return this};c.setTimeToRequestStart=function(a){b.prototype.setTimeToRequestStart.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setTimeToRequestStart(a)});return this};c.setTimeToRequestSent=function(a){b.prototype.setTimeToRequestSent.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setTimeToRequestSent(a)});return this};c.setReason=function(a){b.prototype.setReason.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setReason(a)});return this};c.setResource=function(a){b.prototype.setResource.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setResource(a)});return this};c.setSegmentStartTime=function(a){b.prototype.setSegmentStartTime.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setSegmentStartTime(a)});return this};c.setSegmentEndTime=function(a){b.prototype.setSegmentEndTime.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setSegmentEndTime(a)});return this};c.setAppendedBufferMs=function(a){b.prototype.setAppendedBufferMs.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setAppendedBufferMs(a)});return this};c.setLength=function(a){b.prototype.setLength.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setLength(a)});return this};c.setLiveheadPosition=function(a){b.prototype.setLiveheadPosition.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setLiveheadPosition(a)});return this};c.setLiveheadSeqNumHeader=function(a){b.prototype.setLiveheadSeqNumHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setLiveheadSeqNumHeader(a)});return this};c.setLiveheadSeqNumMpd=function(a){b.prototype.setLiveheadSeqNumMpd.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setLiveheadSeqNumMpd(a)});return this};c.setManifestType=function(a){b.prototype.setManifestType.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setManifestType(a)});return this};c.setPriorityFloat=function(a){b.prototype.setPriorityFloat.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPriorityFloat(a)});return this};c.setInitiator=function(a){b.prototype.setInitiator.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setInitiator(a)});return this};c.setPreloadTime=function(a){b.prototype.setPreloadTime.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPreloadTime(a)});return this};c.setConcluder=function(a){b.prototype.setConcluder.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setConcluder(a)});return this};c.setPreviousRepresentationID=function(a){b.prototype.setPreviousRepresentationID.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPreviousRepresentationID(a)});return this};c.setRepresentationID=function(a){b.prototype.setRepresentationID.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setRepresentationID(a)});return this};c.setState=function(a){b.prototype.setState.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setState(a)});return this};c.setContentLengthHeader=function(a){b.prototype.setContentLengthHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setContentLengthHeader(a)});return this};c.setEdgeHitHeader=function(a){b.prototype.setEdgeHitHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setEdgeHitHeader(a)});return this};c.setFNAHitHeader=function(a){b.prototype.setFNAHitHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setFNAHitHeader(a)});return this};c.setOriginHitHeader=function(a){b.prototype.setOriginHitHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setOriginHitHeader(a)});return this};c.setCode=function(a){b.prototype.setCode.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setCode(a)});return this};c.setResponseTimeMsHeader=function(a){b.prototype.setResponseTimeMsHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setResponseTimeMsHeader(a)});return this};c.setIsTemplatedManifest=function(a){b.prototype.setIsTemplatedManifest.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsTemplatedManifest(a)});return this};c.setIsLatencyCachupEnabled=function(a){b.prototype.setIsLatencyCachupEnabled.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsLatencyCachupEnabled(a)});return this};c.setPlayerFormat=function(a){b.prototype.setPlayerFormat.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPlayerFormat(a)});return this};c.setIsP2pPlayback=function(a){b.prototype.setIsP2pPlayback.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsP2pPlayback(a)});return this};c.setOneObserved=function(a){b.prototype.setOneObserved.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setOneObserved(a)});return this};c.setOneReqWave=function(a){b.prototype.setOneReqWave.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setOneReqWave(a)});return this};c.setOneResWave=function(a){b.prototype.setOneResWave.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setOneResWave(a)});return this};c.setAppendTarget=function(a){b.prototype.setAppendTarget.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setAppendTarget(a)});return this};c.setIsRingBufferSample=function(a){b.prototype.setIsRingBufferSample.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsRingBufferSample(a)});return this};c.setIsOnline=function(a){b.prototype.setIsOnline.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsOnline(a)});return this};c.setIsMixedCodecManifest=function(a){b.prototype.setIsMixedCodecManifest.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setIsMixedCodecManifest(a)});return this};c.setProxyStatusHeader=function(a){b.prototype.setProxyStatusHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setProxyStatusHeader(a)});return this};c.setPlaybackFbmsParam=function(a){b.prototype.setPlaybackFbmsParam.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPlaybackFbmsParam(a)});return this};c.setPreferredEdgeLatency=function(a){b.prototype.setPreferredEdgeLatency.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setPreferredEdgeLatency(a)});return this};c.setUserInfo=function(a){b.prototype.setUserInfo.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setUserInfo(a)});return this};c.setDynamicStatusHeader=function(a){b.prototype.setDynamicStatusHeader.call(this,a);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setDynamicStatusHeader(a)});return this};c.setMediaSourceSourceBuffer=function(a,c){b.prototype.setMediaSourceSourceBuffer.call(this,a,c);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(b){return b.setMediaSourceSourceBuffer(a,c)});return this};c.unsetMediaSourceSourceBuffers=function(){b.prototype.unsetMediaSourceSourceBuffers.call(this);this.$OzMultiDestinationOperationLogger$p_1.forEach(function(a){return a.unsetMediaSourceSourceBuffers()});return this};c.log=function(){b.prototype.log.call(this),this.$OzMultiDestinationOperationLogger$p_1.forEach(function(a){return a.log()})};return a}(c("oz-player/loggings/OzOperationLoggerBase"));g.OzMultiDestinationPerfLoggerProvider=a}),98);
__d("oz-player/loggings/OzOperationLoggerObserver",["oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new(c("oz-player/shims/OzSubscriptionsHandler"))()}var b=a.prototype;b.observe=function(a,b){var c;a=a.map(function(a){var c=a.setOperationLoggedListener(function(a){var c=a.getClientTimeBegin()||0,d=a.getClientTimeEnd()||0;b.getOperationLogger(a.getOperationName()).setClientTimeBegin(c).setClientTimeDuration(d-c).setClientTimeEnd(d).setLength(a.getLength()).setResult(a.getResult()||"success").setInitiator(a.getInitiator()).setType(a.getType()).log()});a.activate();return c});(c=this.$1).addSubscriptions.apply(c,a)};b.destroy=function(){this.$1.release()};return a}();g["default"]=a}),98);
__d("oz-player/shims/www/OzNetworkDiagnosticsWWW",["VideoPlayerOzWWWGlobalConfig"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(!a)return null;a=parseInt(a.get(b),10);return!isNaN(a)&&isFinite(a)?a:null}function i(a,b,c){if(!a||b===""||c==="")return null;b=(a=a.get(b))!=null?a:"";a=b.split(";");for(b=0;b<a.length;b++){var d=a[b].split(":");if(d.length===2&&d[0]===c){d=parseInt(d[1],10);return isFinite(d)?d:null}}return null}a={getNextValidSegmentId:function(a){return h(a,"x-fb-next-valid-segment-id")},getResponseTimeMs:function(a){return h(a,"x-fb-response-time-ms")},getDvlSegmentPTS:function(a){return h(a,"x-fb-segment-pts-start")},getDvlStatus:function(a){return a==null?void 0:a.get("x-fb-dynamic-status")},getUsableResponseSizeForBandwidthEstimation:function(a){return h(a,"x-fb-dynamic-predictive-response-chunk-size")},getBandwidthMeanEstimate:function(a){var b=c("VideoPlayerOzWWWGlobalConfig").getString("bandwidth_estimate_header_key",""),d=c("VideoPlayerOzWWWGlobalConfig").getString("bandwidth_estimate_key","");return i(a,b,d)},getBandwidthStandardDeviationEstimate:function(a){return h(a,"x-bwe-std-dev")},getTimeToFirstByteMsEstimate:function(a){return h(a,"x-mrtt-ms")}};b=a;g["default"]=b}),98);
__d("oz-player/shims/OzNetworkDiagnostics",["oz-player/shims/www/OzNetworkDiagnosticsWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzNetworkDiagnosticsWWW")}),98);
__d("oz-player/manifests/OzDynamicVideoLibrary",["oz-player/shims/OzNetworkDiagnostics"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$4=null;this.$5=null;this.$6=new RegExp(/(.*)\.(m4v|m4a)(\?|$)/);this.$7={m4a:{time:0},m4v:{time:0}};this.$8={audio:"m4a",video:"m4v"};this.$9={};a=a.config;this.$3=a}var b=a.prototype;b.getLastSegmentStartPTS=function(){return this.$1};b.getLast200RequestedTime=function(){return this.$5};b.getLast200RequestedUrlDecisionMinTime=function(){var a=[];for(var b in this.$7)a.push(this.$7[b].time);return Math.min.apply(Math,a)};b.getLast200RequestedUrlDecisionTimeByMimeType=function(a){return(a=this.$7[this.$8[a]])==null?void 0:a.time};b.updateWithResponse=function(a,b,d,e){var f;if(!e.headers||e.status!=200)return;this.$5=b;this.$1=(f=c("oz-player/shims/OzNetworkDiagnostics").getDvlSegmentPTS(e.headers))!=null?f:this.$1;this.$2=c("oz-player/shims/OzNetworkDiagnostics").getDvlStatus(e.headers);this.$10(a,d);(this.$2!=null||this.$2==="200")&&(this.$4=b)};b.$10=function(a,b){a=this.$6.exec(a);if(a!=null){a=a[2];b!=null&&(this.$7[a]={time:b})}};b.shouldRequestDynamicInfo=function(a){if(a!=="video")return!1;this.$11(a);a=this.$12(a);return a!=null&&a<=this.$3.getNumber("dvl_initial_segment_ignore_count")?!1:this.$3.getNumber("dvl_update_interval_ms")==0||this.$4==null||this.$4+this.$3.getNumber("dvl_update_interval_ms")<=Date.now()};b.$11=function(a){this.$9[a]==null&&(this.$9[a]={segmentCount:0});return this.$9[a].segmentCount=this.$9[a].segmentCount!=null?this.$9[a].segmentCount+1:0};b.$12=function(a){return this.$9[a].segmentCount};return a}();g["default"]=a}),98);
__d("oz-player/manifests/OzRepresentationBase",["oz-player/parsers/getMIMECodecs","oz-player/shims/ozvariant","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$1=a,this.$2=b,this.$10=c,this.$5=f,this.$3=d,this.$4=e,this.$6=g,this.$7=h,this.$8=i,this.$9=j,this.$11=k,this.$12=l}var b=a.prototype;b.getContentProtectionXml=function(){return this.$2};b.getID=function(){return this.$10};b.getBandwidth=function(){return this.$9};b.getMimeCodecs=function(){return c("oz-player/parsers/getMIMECodecs")(this.$3,this.$4)};b.getMimeType=function(){return this.$3};b.getCodecs=function(){return this.$4};b.getLang=function(){return this.$5};b.getRole=function(){return this.$6};b.getDisplayLabel=function(){return this.$10};b.getInitSegment=function(){return this.$7};b.getCustomFieldFirstSegment=function(){return this.$11};b.getCustomField=function(a){if(this.$12==null||!this.$12[a])throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_REPRESENTATION_PARSER",description:"Custom field "+a+" is not specified by caller",extra:{code:"OZ_RP-8"}});a=this.$12[a];try{return a(this.$1)}catch(a){return null}};b.updateWith=function(b){b instanceof a||c("oz-player/shims/ozvariant")(0,229),this.$8.updateWith(b.$8)};b.getSegmentByTime=function(a){return this.$8.getSegmentByTime(a)};b.getSegment=function(a){return this.$8.getSegment(a)};b.getPredictedSegmentAfter=function(a){return this.$8.getPredictedSegmentAfter(a)};b.canPredict=function(){return this.$8.canPredict()};b.canApproximateId=function(){return this.$8.canApproximateId()};b.getSegmentAfter=function(a){return this.$8.getSegmentAfter(a)};b.isEndingSegment=function(a){return this.$8.isEndingSegment(a)};b.addUpdateListener=function(a){return this.$8.addUpdateListener(a)};b.getTimeRanges=function(){return this.$8.getTimeRanges()};b.blockTimeRange=function(a){this.$8.blockTimeRange(a)};b.getEndingSegment=function(){return this.$8.getEndingSegment()};b.getMaxGopSec=function(){return this.$8.getMaxGopSec()};return a}();g["default"]=a}),98);
__d("oz-player/manifests/OzVideoRepresentation",["oz-player/manifests/OzRepresentationBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o){c=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m)||this;c.$OzVideoRepresentation$p_5=null;c.$OzVideoRepresentation$p_6=null;c.$OzVideoRepresentation$p_7=null;c.$OzVideoRepresentation$p_1=n;c.$OzVideoRepresentation$p_2=o;c.$OzVideoRepresentation$p_4=m;c.$OzVideoRepresentation$p_3=b;if(m!=null){if(m.playbackResolutionMos!=null){d=c.getCustomField("playbackResolutionMos");c.$OzVideoRepresentation$p_7=d!=null?String(d):null}if(m.playbackResolutionCsvqm!=null){e=c.getCustomField("playbackResolutionCsvqm");c.$OzVideoRepresentation$p_6=e!=null?String(e):null}}return c}var c=b.prototype;c.getQualityScoreCurveString=function(a){if(a==="csvqm")return this.$OzVideoRepresentation$p_6;else return this.$OzVideoRepresentation$p_7};c.getWidth=function(){return this.$OzVideoRepresentation$p_1};c.getHeight=function(){return this.$OzVideoRepresentation$p_2};c.getDisplayLabel=function(){if(this.$OzVideoRepresentation$p_5!=null)return this.$OzVideoRepresentation$p_5;var a=this.$OzVideoRepresentation$p_4?this.$OzVideoRepresentation$p_4.qualityLabel:null;a&&(this.$OzVideoRepresentation$p_5=a(this.$OzVideoRepresentation$p_3));(this.$OzVideoRepresentation$p_5==null||this.$OzVideoRepresentation$p_5=="")&&(this.$OzVideoRepresentation$p_5=this.getHeight().toString()+"p");return this.$OzVideoRepresentation$p_5||""};return b}(c("oz-player/manifests/OzRepresentationBase"));g["default"]=a}),98);
__d("oz-player/utils/OzMimeUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){return(a.split("/")[0]||"").trim()}function b(a){a=(a.split(";")[0]||"").trim();a=(a.split("/")[1]||"").trim();return a}function c(a){a=a.split('codecs="').pop();return a.split(".")[0].trim()}f.getMimeType=a;f.getContainerType=b;f.getParsedCodecFamily=c}),66);
__d("oz-player/media_source/OzMSESourceBufferImpl",["oz-player/shims/OzDOMEventListener","oz-player/utils/OzErrorUtils","oz-player/utils/OzMimeUtil"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d){this.$1=a,this.$2=c,this.$3=b,this.$4=d}var b=a.prototype;b.registerOnUpdateStartListener=function(a){return c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"updatestart",a)};b.registerOnUpdateEndListener=function(a){return c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"updateend",a)};b.registerOnUpdateListener=function(a){return c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"update",a)};b.registerOnErrorListener=function(a){return c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"error",a)};b.getIsUpdating=function(){return this.$1.updating};b.getBuffered=function(){return this.$1.buffered};b.setAppendWindowEnd=function(a){this.$1.appendWindowEnd=a};b.appendBuffer=function(a,b){var c,e=(c=d("oz-player/utils/OzMimeUtil")).getMimeType(b)!==c.getMimeType(this.$3),f=c.getContainerType(b)!==c.getContainerType(this.$3);c=c.getParsedCodecFamily(b)!==c.getParsedCodecFamily(this.$3);if(e||f||c)if(this.$4){try{this.$1.changeType(b)}catch(a){throw d("oz-player/utils/OzErrorUtils").createOzError({description:'SourceBufferChangeTypeError: Failed to changeType("'+b+'"): '+String(a)+" current MIME Codecs: "+this.$3,type:"OZ_SOURCE_BUFFER_CHANGE_TYPE"})}this.$3=b}else throw d("oz-player/utils/OzErrorUtils").createOzError({description:"SourceBufferChangeTypeError: attempted to call changeType() on a SourceBuffer that does not support it.",type:"OZ_SOURCE_BUFFER_CHANGE_TYPE_UNAVAILABLE"});this.$1.appendBuffer(a)};b.abort=function(){this.$1.abort()};b.remove=function(a,b){this.$1.remove(a,b)};return a}();g["default"]=a}),98);
__d("oz-player/media_source/OzMediaErrorProvider",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.hasError=function(){return this.$1.error!==null};b.getMediaErrorName=function(){var a=this.$1.error;return a&&a.message?this.$2(a.message):null};b.getErrorCode=function(){var a=this.$1.error;return a&&a.code?a.code:null};b.getVideoNode=function(){return this.$1};b.$2=function(a){return a.replace(/([0-9]{2,})/g,function(a){var b="";while(b.length<a.length)b+="#";return b})};return a}();f["default"]=a}),66);
__d("oz-player/utils/OzSourceBufferUtil",["oz-player/utils/OzNumericalRangeUtil"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=0;for(var c=0;c<a.getBuffered().length;c++)b+=a.getBuffered().end(c)-a.getBuffered().start(c);return b}function b(a){return a.reduce(function(a,b){return a+(b.endTime-b.startTime)},0)}function c(a){return a.getBuffered().length==0?0:a.getBuffered().start(0)}function e(a){var b=null;try{b=a.getBuffered()}catch(a){return 0}return b.length==0?0:b.end(b.length-1)}function f(a){var b=[];for(var c=0;c<a.length;c++)b.push({startTime:a.start(c),endTime:a.end(c)});return b}function h(a,b,c){c=d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(c,b,a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));b=c>=0?parseFloat((a[c].endTime-b).toFixed(3)):0;a=c>=0?a.length-1-c:-1;return{bufferAheadSec:b,bufferedOffset:a}}function i(a,b,c){var e=a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}});c=d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(c,b,e);e=parseFloat(e.reduce(function(a,c){var e=c.rangeEnd;return e==null?a:a+(d("oz-player/utils/OzNumericalRangeUtil").isWithin(b,c)?e-b:d("oz-player/utils/OzNumericalRangeUtil").isLargerThan(c.rangeStart,b)?e-c.rangeStart:0)},0).toFixed(3));a=c>=0?a.length-1-c:-1;return{bufferAheadSec:e,bufferedOffset:a}}g.getTotalBufferedTime=a;g.getTotalInBufferedRanges=b;g.getStartBufferedTime=c;g.getEndBufferedTime=e;g.convertToBufferedTimeRangeArray=f;g.getBufferAheadInBufferedRanges=h;g.getTotalBufferAheadOfPosition=i}),98);
__d("oz-player/media_source/SourceBufferManagerUtils",["oz-player/utils/OzSourceBufferUtil"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=d("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(b);return function(){var a=d("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(b);return{startTime:e,endTime:a}}}g.startMeasuringAppendedBuffer=a}),98);
__d("oz-player/shims/www/OzDeferredWWW",["Deferred"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("Deferred")}),98);
__d("oz-player/shims/OzDeferred",["oz-player/shims/www/OzDeferredWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzDeferredWWW")}),98);
__d("oz-player/utils/OzFakeEventTarget",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var b=a.prototype;b.dispatchEvent=function(a){if(this.$1[a]==null)return;this.$1[a].forEach(function(a){return a()})};b.addEventListener=function(a,b){var c=this;this.$1[a]===void 0&&(this.$1[a]=new Set());this.$1[a].add(b);return{remove:function(){c.removeEventListener(a,b)}}};b.removeEventListener=function(a,b){if(!this.$1[a])return;this.$1[a]["delete"](b)};b.destroy=function(){this.$1={}};return a}();f["default"]=a}),66);
__d("oz-player/states/OzObservedSourceBufferState",["oz-player/shims/OzSubscriptionsHandler","oz-player/utils/OzFakeEventTarget"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$OzObservedSourceBufferState$p_2=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzObservedSourceBufferState$p_3=[];e.$OzObservedSourceBufferState$p_6=function(){var a;try{a=e.$OzObservedSourceBufferState$p_1.getBuffered()}catch(a){if(a.name==="InvalidStateError"){e.$OzObservedSourceBufferState$p_3=[];return}else throw a}var b=[];for(var c=0;c<a.length;c++)b.push({startTime:a.start(c),endTime:a.end(c)});e.$OzObservedSourceBufferState$p_3=b};e.$OzObservedSourceBufferState$p_1=b;e.$OzObservedSourceBufferState$p_4=d;e.$OzObservedSourceBufferState$p_5();return e}var d=b.prototype;d.$OzObservedSourceBufferState$p_5=function(){var a=this;this.$OzObservedSourceBufferState$p_2.release();this.$OzObservedSourceBufferState$p_2=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$OzObservedSourceBufferState$p_2.addSubscriptions(this.$OzObservedSourceBufferState$p_1.registerOnUpdateEndListener(function(){a.$OzObservedSourceBufferState$p_6(),a.dispatchEvent("buffer_updated")}),this.$OzObservedSourceBufferState$p_1.registerOnErrorListener(this.$OzObservedSourceBufferState$p_6))};d.setSourceBuffer=function(a){this.$OzObservedSourceBufferState$p_1=a,this.$OzObservedSourceBufferState$p_5(),this.$OzObservedSourceBufferState$p_6()};d.getBufferedRanges=function(){return this.$OzObservedSourceBufferState$p_3};d.destroy=function(){a.prototype.destroy.call(this),this.$OzObservedSourceBufferState$p_2.release(),this.$OzObservedSourceBufferState$p_2.engage()};return b}(c("oz-player/utils/OzFakeEventTarget"));g["default"]=a}),98);
__d("oz-player/utils/OzCustomErrorCode",[],(function(a,b,c,d,e,f){"use strict";a={APPEND_BUFFER_UNKNOWN_ERROR:"21539",APPEND_BUFFER_INVALID_STATE_ERROR_SOURCE_BUFFER_HAS_BEEN_REMOVED:"21540",APPEND_BUFFER_MEDIA_ERROR_ATTRIBUTE_NOT_NULL:"21541",APPEND_BUFFER_SOURCE_BUFFER_UPDATING_ATTRIBUTE_IS_TRUE:"21542",SOURCE_BUFFER_MANAGER_ADD_SOURCE_BUFFER_ERROR:"21543",SOURCE_BUFFER_MANAGER_CREATE_ERROR:"21544",SETUP_STREAMS_PROMISE_REJECTION:"21545",APPEND_BUFFER_QUOTA_EXCEEDED_ERROR:"21546",APPEND_BUFFER_INVALID_STATE_ERROR:"21547",SOURCE_BUFFER_MANAGER_UPDATEEND_UNKNOWN_ERROR:"21548",NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR:"21549",STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR:"21550",SOURCE_BUFFER_MANAGER_CLEAR_RANGE_FAILED:"21551",WEBVTT_CAPTION_PARSE_ERROR:"21552"};b=a;f["default"]=b}),66);
__d("oz-player/media_source/SourceBufferManager",["Promise","oz-player/loggings/OzLoggingUtils","oz-player/media_source/SourceBufferManagerUtils","oz-player/shims/OzDOMEventListener","oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzStreams","oz-player/shims/OzSubscriptionsHandler","oz-player/states/OzObservedSourceBufferState","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorUtils","oz-player/utils/ozConcatUint8Arrays"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b,e,f,g,h){var i=this;h===void 0&&(h=null);this.$4=null;this.$5=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$7=!1;this.$8=[];this.$12=!1;this.$13=!1;this.$14=0;this.$26=function(){if(i.$10.hasError()){i.$13=!1;i.$12=!1;var a=i.$10.getMediaErrorName();a=a!=null?a:"An unknown source buffer error occurred.";var b=i.$10.getErrorCode();b=b!=null?String(b):c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_UPDATEEND_UNKNOWN_ERROR;a=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:a,extra:{code:b}});i.$4&&i.$4.reject(a);i.$4=null;i.cancelOperationAndCleanQueue()}else if(!i.$13){i.$13=!0;b=i.$10.getVideoNode();a=i.$26;b=c("oz-player/shims/OzDOMEventListener").listenDOMEvent(b,"error",a);i.$5.addSubscriptions(b)}};this.$17=function(){var a=i.$2;if(a!=null){a.getOperationLogger("source_buffer_updateend").setError((a=i.$10.getMediaErrorName())!=null?a:void 0).setCode(i.$10.getErrorCode()).setResult(i.$12?"failed":"success").log()}a=i.$4;a&&(i.$12?i.$26():(a.resolve(),i.$4&&(i.$4=null)))};this.$18=function(){var a=i.$2;if(a!=null){a.getOperationLogger("source_buffer_error").setError((a=i.$10.getMediaErrorName())!=null?a:void 0).setCode(i.$10.getErrorCode()).setResult("failed").log()}i.$12=!0};this.$1=a;this.$2=h;this.$3=b;this.$11=e;this.$16();this.$9=new(c("oz-player/states/OzObservedSourceBufferState"))(this.$3,this.$11);this.$10=f;this.$15=g}var e=a.prototype;e.$16=function(){this.$5.release(),this.$5=new(c("oz-player/shims/OzSubscriptionsHandler"))(),this.$5.addSubscriptions(this.$3.registerOnUpdateEndListener(this.$17),this.$3.registerOnErrorListener(this.$18))};e.setSourceBuffer=function(a){if(a==null)return;this.cancelOperationAndCleanQueue();this.$3=a;this.$16();this.$9.setSourceBuffer(a)};e.queueData=function(a,b,d,e,f){e===void 0&&(e=null);f===void 0&&(f=0);var g=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));this.$8.push({data:a,deferred:g,loggerProvider:e,appendTarget:f,mimeCodecs:b,clearSourceBufferRange:d});a=g.getPromise();this.$7||this.$19()["catch"](function(a){});return a};e.cancelOperationAndCleanQueue=function(a){a===void 0&&(a=null);a&&a.cloneContext().getOperationLogger("source_buffer_cancel_and_clean").log();var b=d("oz-player/utils/OzErrorUtils").createOzCancelledError("SBM cancel and clean");this.$8.forEach(function(a){a=a.deferred;a.reject(b)});this.$8=[];try{this.$11.getBool("enable_alternative_audio_tracks")?this.$15()==="open"&&(this.$10.hasError()||this.$3.abort()):this.$15()!=="closed"&&!0&&(this.$10.hasError()||this.$3.abort())}catch(b){var c=b;a&&a.cloneContext().getOperationLogger("cancel_operation_abort_failed").setError(c).setReason(this.$15?this.$15():null).log()}a=this.$4;a&&a.reject(b);this.$6&&(this.$6.reject(b),this.$6=null)};e.getSourceBufferState=function(){return this.$9};e.$20=function(a,b){a=Math.max(a,0);b>0&&b>a&&this.$3.remove(a,b)};e.$21=function(a,b){a=Math.max(a,0);if(b>0&&b>a){var d=this.$22();this.$20(a,b);return d}return c("oz-player/shims/OzMaybeNativePromise").resolve()};e.clearRangeWithWait=function(a){var c=this;this.cancelOperationAndCleanQueue();return a.reduce(function(a,b){var d=b.fromTime,e=b.toTime;return a.then(function(){return c.$21(d,e)})},(h||(h=b("Promise"))).resolve())};e.$22=function(a){var b=this.$4=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));b=b.getPromise();a&&d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(b,a,"wait_for_source_buffer");return b};e.$23=function(a,b,e,f){var g=this,h=function(){var h=g.$4=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),i=!1,j=!0;try{j=!!g.$3.getBuffered()}catch(a){j=!1}try{i=g.$3.getIsUpdating();if(j)g.$3.appendBuffer(a,b);else{h.resolve();return h.getPromise()}}catch(a){j=a;var k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_UNKNOWN_ERROR,l=j.name,m=j.message;l==="QuotaExceededError"?k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_QUOTA_EXCEEDED_ERROR:g.$10.hasError()?k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_MEDIA_ERROR_ATTRIBUTE_NOT_NULL:i?k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_SOURCE_BUFFER_UPDATING_ATTRIBUTE_IS_TRUE:l==="InvalidStateError"&&typeof m==="string"&&/SourceBuffer has been removed/.test(m)?k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_INVALID_STATE_ERROR_SOURCE_BUFFER_HAS_BEEN_REMOVED:l==="InvalidStateError"&&(k=c("oz-player/utils/OzCustomErrorCode").APPEND_BUFFER_INVALID_STATE_ERROR);i=d("oz-player/utils/OzErrorUtils").createOzError({type:g.$11.getBool("emit_caption_parse_errors_as_warning")&&d("oz-player/utils/OzErrorUtils").isOzError(j)?j.getType():l==="QuotaExceededError"?"OZ_SOURCE_BUFFER_QUOTA_EXCEEDED":l==="OZ_SOURCE_BUFFER_CHANGE_TYPE"?"OZ_SOURCE_BUFFER_CHANGE_TYPE":"OZ_SOURCE_BUFFER",description:"SBM#"+g.$1+" appendBuffer("+b+") failed: "+String(m),extra:g.$11.getBool("emit_caption_parse_errors_as_warning")&&d("oz-player/utils/OzErrorUtils").isOzError(j)?j.getExtra():{originalError:j,code:k}});g.$4=null;h.reject(i)}l=h.getPromise();e&&d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(l,e,"append",function(b){var c;b.setLength(a.byteLength);c=(c=f==null?void 0:f.appendTarget)!=null?c:null;b.setAppendTarget(c)});return l};if(this.$3.getIsUpdating())return this.$22(e).then(h)["catch"](function(a){throw a});this.$14+=a.byteLength;return h()};e.$19=function(){var a=this;if(this.$7)return c("oz-player/shims/OzMaybeNativePromise").reject(this.$24("Another unit of queued data is being appended."));var b=this.$8.shift();if(!b){this.$7=!1;return c("oz-player/shims/OzMaybeNativePromise").resolve()}var e=b.data,f=b.mimeCodecs,g=b.deferred,h=b.loggerProvider,i=b.appendTarget,j=b.clearSourceBufferRange;this.$7=!0;var k;b=function(){return e instanceof d("oz-player/shims/OzStreams").OzReadableStream?a.$25(e,f,h,i):a.$23(e,f,h,{appendTarget:i})};j?(k=this.$3.getIsUpdating()?this.$22(h):c("oz-player/shims/OzMaybeNativePromise").resolve(),k=k.then(function(){return a.clearRangeWithWait([{fromTime:j[0],toTime:j[1]}])}).then(b)):k=b();var l=d("oz-player/media_source/SourceBufferManagerUtils").startMeasuringAppendedBuffer(this.$11,this.$3,this.$9);return k["catch"](function(a){g.reject(a)}).then(function(){var b=l(),c=b.startTime;b=b.endTime;g.resolve({startTime_UNSAFE:c,endTime_UNSAFE:b,appendedSec:b-c});a.$7=!1;a.$19()["catch"](function(a){})})};e.$25=function(a,b,e,f){var g=this,h=[],i=0,j=a.getReader();a=function a(){var k=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));g.$6=k;j.read().then(function(a){k.resolve(a),g.$6=null})["catch"](function(a){k.reject(a),g.$6=null});return k.getPromise().then(function(d){if(d.done){var j=c("oz-player/utils/ozConcatUint8Arrays")(h);j=j.buffer;h.length=0;i=0;return j.byteLength>0?g.$23(j,b,e,{appendTarget:f}):c("oz-player/shims/OzMaybeNativePromise").resolve()}j=d.value;d=j;if(f>0){j=j instanceof Uint8Array?j:new Uint8Array(j);h.push(j);i+=j.byteLength;if(i>=f){j=c("oz-player/utils/ozConcatUint8Arrays")(h);j=j.buffer;h.length=0;i=0;d=j}}return d&&d.byteLength>=f?g.$23(d,b,e,{appendTarget:f}).then(function(){return a()}):a()},function(a){if(g.$11.getBool("enable_alternative_audio_tracks"))try{g.$15()==="open"&&(g.$10.hasError()||g.$3.abort())}catch(a){a}else try{g.$3.abort()}catch(a){a}if(typeof a==="object"&&d("oz-player/utils/OzErrorUtils").isOzError(a))return c("oz-player/shims/OzMaybeNativePromise").reject(a);if(typeof a==="object"&&a!=null&&typeof a.name==="string"&&a.name==="TypeError"&&typeof a.message==="string"&&a.message.includes("network error")){var e=d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{description:"SBM#"+g.$1+" appendReadableStream("+b+") failed: Stream read is interrupted (previously TypeError network error)}",extra:{originalError:a},type:"OZ_NETWORK"});return c("oz-player/shims/OzMaybeNativePromise").reject(e)}e=d("oz-player/utils/OzErrorUtils").convertPromiseRejectionReasonToOzError(a,{description:"SBM#"+g.$1+" appendReadableStream("+b+") failed: Unexpected error while reading from stream: "+String(a),extra:{originalError:a},type:"OZ_NETWORK"});return c("oz-player/shims/OzMaybeNativePromise").reject(e)})};return a()};e.$24=function(a){var b=this.$2;b!=null&&b.getOperationLogger("source_buffer_invariant").setError(a).setResult("failed").log();return d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:"SBM invariant: "+a})};e.destroy=function(){var a=this,b=this.$2;b&&b.cloneContext().getOperationLogger("source_buffer_destroy").log();b=this.$4;b&&(!this.$13?(b.reject(d("oz-player/utils/OzErrorUtils").createOzCancelledError("SBM destroyed")),this.$4=null,this.$5.release(),this.$5=new(c("oz-player/shims/OzSubscriptionsHandler"))()):b.getPromise()["catch"](function(){a.$4=null,a.$5.release(),a.$5=new(c("oz-player/shims/OzSubscriptionsHandler"))()}));this.$9.destroy()};e.getDebug=function(){return{SourceBuffer:this.$3}};return a}();g["default"]=a}),98);
__d("oz-player/shims/www/getOzVTTSourceBufferImplLazyWWW",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("OzVTTSourceBufferImpl").__setRef("oz-player/shims/www/getOzVTTSourceBufferImplLazyWWW");function a(){return h.load()}g["default"]=a}),98);
__d("oz-player/shims/www/getOzVTTSourceBufferImplWWW",["oz-player/shims/www/getOzVTTSourceBufferImplLazyWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/getOzVTTSourceBufferImplLazyWWW")}),98);
__d("oz-player/shims/getOzVTTSourceBufferImpl",["oz-player/shims/www/getOzVTTSourceBufferImplWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/getOzVTTSourceBufferImplWWW")}),98);
__d("oz-player/shims/www/ozClearTimeoutWWW",["clearTimeout"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("clearTimeout")}),98);
__d("oz-player/shims/ozClearTimeout",["oz-player/shims/www/ozClearTimeoutWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/ozClearTimeoutWWW")}),98);
__d("oz-player/shims/www/ozSetTimeoutAcrossTransitionsWWW",["setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("setTimeoutAcrossTransitions")}),98);
__d("oz-player/shims/ozSetTimeoutAcrossTransitions",["oz-player/shims/www/ozSetTimeoutAcrossTransitionsWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/ozSetTimeoutAcrossTransitionsWWW")}),98);
__d("oz-player/utils/ozGetErrorNameFromMediaErrorCode",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:}return"MEDIA_ERR_UNKNOWN"}f["default"]=a}),66);
__d("oz-player/media_source/MediaSourceManager",["oz-player/loggings/OzMultiDestinationPerfLogger","oz-player/media_source/OzMSESourceBufferImpl","oz-player/media_source/OzMediaErrorProvider","oz-player/media_source/SourceBufferManager","oz-player/shims/OzDOMEventListener","oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/getOzVTTSourceBufferImpl","oz-player/shims/ozClearTimeout","oz-player/shims/ozReportUnexpectedError","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/shims/ozThrottle","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzMimeUtil","oz-player/utils/ozGetErrorNameFromMediaErrorCode"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this,e=a.videoNode,f=a.config,g=a.perfLoggerProvider;g=g===void 0?new(d("oz-player/loggings/OzMultiDestinationPerfLogger").OzMultiDestinationPerfLoggerProvider)([]):g;var h=a.isChangeTypeSupported,i=a.handleVttCaptionsUpdated,j=a.onClearVideoNodeError;a=a.onRetryVideoElementError;this.$3=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$4=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$6=[];this.$7=new Map();this.$8=[];this.$10=!1;this.$12=!1;this.$13=!1;this.$14=!1;this.$15=!1;this.$18=null;this.$19=null;this.$20=new(c("oz-player/utils/OzErrorEmitter"))();this.$22="undetected";this.$23=!1;this.$29=function(){b.$32()||(b.$10=!1);if(!b.$33())return;var a=b.$8.shift();a&&(a(b.$2),b.$10=!0)};this.$5=g;this.$11=f;this.$1=e;this.$21=i;this.$16=j;this.$17=a;this.$23=h;this.$9=new(c("oz-player/media_source/OzMediaErrorProvider"))(this.$1);this.$3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"error",function(){var a;b.$5.getOperationLogger("media_element_error").setError((a=b.$9.getMediaErrorName())!=null?a:void 0).setCode(b.$9.getErrorCode()).setResult("failed").setUserInfo({av1HardwareSupport:b.$22}).log();b.$8=[];b.$6=[];b.$4.release();b.$4=new(c("oz-player/shims/OzSubscriptionsHandler"))();b.$15=b.$15||b.$14||b.$13;a=b.$1.error;var e=(a==null?void 0:a.code)||0,f=d("oz-player/utils/OzErrorUtils").createOzError({type:c("oz-player/utils/ozGetErrorNameFromMediaErrorCode")(e),description:(a==null?void 0:a.message)!=null?a.message:"",extra:{originalError:a,code:String(e)}});if(b.$19!=null){b.$5.getOperationLogger("media_element_error").setError(a).setCode(e).setReason("mitigation_failed").setResult("failed").setUserInfo({av1HardwareSupport:b.$22}).log();b.$20.emitError(f);return}b.$19=b.$1.currentTime;b.$18==null&&(b.$18=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){b.$18=null,b.$11.getBool("retry_video_element_error")&&(b.$17!=null&&b.$17(f),b.$24())},0))}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"play",function(){b.$14=!0}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"playing",function(){b.$14=!1,b.$15=!1,b.$19=null,b.$13=!0}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"pause",function(){b.$14=!1,b.$13=!1,b.$15=!!b.$1.error}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"ended",function(){b.$14=!1,b.$13=!1}));this.$2=new MediaSource();this.$5.getOperationLogger("media_source_new").log();this.$3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceopen",function(){b.$5.getOperationLogger("media_source_open").log()}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceended",function(){b.$5.getOperationLogger("media_source_ended").log()}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceclose",function(){b.$5.getOperationLogger("media_source_close").log()}));this.$25(this.$2)}var b=a.prototype;b.$25=function(a){var b=this.$1,c=b.src;c!==""&&URL.revokeObjectURL(c);a?b.src=URL.createObjectURL(a):(b.removeAttribute("src"),b.removeAttribute("srcObject"))};b.$24=function(){var a=this;this.$7.forEach(function(a){a.cancelOperationAndCleanQueue()});this.$2=new MediaSource();this.$25(this.$2);this.$7.forEach(function(a,b){a.setSourceBuffer(null)});var b=this.$26().then(function(){var b=[];a.$7.forEach(function(c,d){var e=a.$27(d).then(function(b){c.setSourceBuffer(b),a.$28(b,d)});b.push(e)});return c("oz-player/shims/OzMaybeNativePromise").all(b)});b.then(function(){a.$16&&a.$16();a.$19!=null&&(a.$1.currentTime=a.$19);if(a.$15){var b=a.$1.play();return b==null?void 0:b["catch"](function(){})}})["catch"](function(b){a.$20.emitError(b)})};b.$26=function(){var a=this;if(this.$11.getBool("msm_refactor_wait_for_sourceopen")){if(this.$2.readyState==="open")return c("oz-player/shims/OzMaybeNativePromise").resolve();var b=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),d=c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceopen",function(){d.remove(),b.resolve(),a.$29()});this.$3.addSubscriptions(d);return b.getPromise()}else{if(this.$2.readyState==="open")return c("oz-player/shims/OzMaybeNativePromise").resolve();var e=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));this.$3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceopen",function(){e.resolve(),a.$29()}));return e.getPromise()}};b.$27=function(a){var b=this;if(this.$11.getBool("msm_refactor_wait_for_sourceopen"))return c("oz-player/shims/OzMaybeNativePromise").resolve().then(function(){return b.$30(a)})["catch"](function(b){b=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:'Failed to addSourceBuffer("'+a+'"): '+String(b),extra:{originalError:b,code:c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_ADD_SOURCE_BUFFER_ERROR.toString()}});throw b});else try{return this.$30(a)}catch(b){var e=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:'Failed to addSourceBuffer("'+a+'"): '+(b.message||String(b)),extra:{originalError:b,code:c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_ADD_SOURCE_BUFFER_ERROR.toString()}});throw e}};b.$30=function(a){var b=this,e;a.includes("vtt")?e=this.$31(a):e=this.$26().then(function(){return new(c("oz-player/media_source/OzMSESourceBufferImpl"))(b.$2.addSourceBuffer(a),a,b.$11,b.$23)});return e.then(function(c){b.$6.push(c);c.registerOnUpdateListener(function(){b.$5.cloneContext().getOperationLogger("source_buffer_update_start").setType(d("oz-player/utils/OzMimeUtil").getMimeType(a)).setMediaSourceSourceBuffer(d("oz-player/utils/OzMimeUtil").getMimeType(a),c).setType(d("oz-player/utils/OzMimeUtil").getMimeType(a)).log()});b.$5.getOperationLogger("add_source_buffer").setMediaSourceSourceBuffer(d("oz-player/utils/OzMimeUtil").getMimeType(a),c).log();return c})};b.$28=function(a,b){var c=this;this.$4.addSubscriptions(a.registerOnUpdateEndListener(function(){c.$29()}))};b.$31=function(a){var b=this;return c("oz-player/shims/getOzVTTSourceBufferImpl")().then(function(e){if(b.$21!=null){var f=new e({onCaptionsChanged:b.$21,config:b.$11}),g=c("oz-player/shims/ozThrottle")(function(){f.setCurrentVideoTime(b.$1.currentTime)},200);b.$3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(b.$1,"timeupdate",function(){g()}),{remove:function(){g=function(){}}});return f}else throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:'Failed to addSourceBuffer("'+a+'"): No handleVttCaptionsUpdated callback provided',extra:{code:c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_ADD_SOURCE_BUFFER_ERROR.toString()}})})};b.createSourceBufferManager=function(a,b,e,f){var g=this;return(this.$11.getBool("msm_refactor_wait_for_sourceopen")?this.$27(b).then(function(a){return[void 0,a]}):c("oz-player/shims/OzMaybeNativePromise").all([this.$26(),this.$27(b)])).then(function(e){e[0];e=e[1];var f=new(c("oz-player/media_source/SourceBufferManager"))(a,e,g.$11,g.$9,function(){return g.$2.readyState},g.$5.cloneContext().setType(d("oz-player/utils/OzMimeUtil").getMimeType(b)));g.$28(e,b);g.$7.set(b,f);return f})["catch"](function(b){var e=d("oz-player/utils/OzErrorUtils").isOzError(b)?b.getExtra():void 0,f=e==null?void 0:e.code;f=d("oz-player/utils/OzErrorUtils").isOzError(b)?""+b.getType()+(f!=null?"#"+f:"")+": "+b.getDescription():String(b);f=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:"Failed to create SBM#"+a+": "+f+", support AAC-LC="+(MediaSource.isTypeSupported("audio/mp4; codecs=mp4a.40.2")?"true":"false")+", readyState="+g.$2.readyState,extra:babelHelpers["extends"]({},e,{originalError:b,code:c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_CREATE_ERROR.toString()})});throw f})};b.getReadyState=function(){return this.$2.readyState};b.getMediaSource=function(){return this.$2};b.notifyEndOfStream=function(a,b){var d=this,e=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));this.$3.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$2,"sourceended",function(){e.resolve()}));this.$8.push(function(c){if(c.readyState==="open"){var e=d.$5.getOperationLogger("end_of_stream");e.setInitiator(a).setReason(b);e.log();c.endOfStream()}});this.$29();return e.getPromise()};b.updateDuration=function(a,b){var e=this,f=this.$2.duration;if(Number.isFinite(f)&&(!b||f>=a))return;this.$8.push(function(b){b.duration!==f&&!(isNaN(b.duration)&&isNaN(f))&&c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:"mediaSource duration discrepancy: "+b.duration+" != "+f}),"MediaSourceManager updateDuration","warn");var g=e.$11.getBool("msm_refactor_wait_for_sourceopen")?b.duration!==Infinity&&a<b.duration:a<b.duration;if(g){e.$5.getOperationLogger("media_source_update_duration").setMediaSourcePreviousDuration(b.duration).setMediaSourceNewDuration(a).setResult("failed").log();return}e.$5.getOperationLogger("media_source_update_duration").setMediaSourcePreviousDuration(b.duration).setMediaSourceNewDuration(a).log();b.duration=a});this.$29();return};b.detach=function(){this.$18&&(c("oz-player/shims/ozClearTimeout")(this.$18),this.$18=null);this.$5.getOperationLogger("source_buffer_detach").unsetMediaSourceSourceBuffers();this.$25(null);for(var a=0;a<this.$2.sourceBuffers.length;a++){var b=this.$2.sourceBuffers[a];this.$2.removeSourceBuffer(b)}this.$3.release();this.$3.engage();this.$4.release();this.$4.engage();this.$8=[];this.$10=!1;this.$12=!0};b.$33=function(){return!this.$32()&&this.$2.readyState==="open"&&!this.$10&&!this.$12};b.$32=function(){return this.$6.some(function(a){return a.getIsUpdating()})};b.onError=function(a){return this.$20.onError(a)};return a}();g["default"]=a}),98);
__d("oz-player/media_source/OzMediaSeekableRangeManager",["oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var d=this;this.$5=function(a){a===void 0&&(a=!0);var b=d.$2;if(!b)return;b=b.getTimeRanges();if(!b.length)return;b=b[b.length-1];d.$1.updateDuration(b.endTime,a)};this.$1=a;this.$3=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$4=b}var b=a.prototype;b.setTimeRangeProvider=function(a){this.$3.release(),this.$3.engage(),this.$3.addSubscriptions(a.addUpdateListener(this.$5)),this.$2=a};b.listenToMediaStreamInitAppended=function(a){var b=this;return a.addListener("initAppended",function(){b.$5(!1)})};b.destroy=function(){this.$3.release()};return a}();g["default"]=a}),98);
__d("oz-player/networks/OzCreateErrorStream",["oz-player/shims/OzStreams"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return new(d("oz-player/shims/OzStreams").OzReadableStream)({pull:function(b){b.error(a)}})}g["default"]=a}),98);
__d("oz-player/shims/OzFetchAPI",[],(function(a,b,c,d,e,f){"use strict";b=function(b,c){return a.fetch(b,c)};c=function(b,c){return new a.Response(b,c)};f.fetch=b;f.Response=c}),66);
__d("oz-player/networks/FetchWithTimeout",["oz-player/shims/OzFetchAPI","oz-player/shims/ozClearTimeout","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";function b(b,e,f,g){if(!d("oz-player/shims/OzFetchAPI").fetch)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"fetch api is missing"});var h=null;if("AbortController"in a&&f!=null&&f!=0){var i=new AbortController();h=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){return i.abort()},f);f={credentials:e,signal:i.signal}}else f={credentials:e};g!=null&&(f=babelHelpers["extends"]({},f,{referrer:g}));return d("oz-player/shims/OzFetchAPI").fetch(b,f).then(function(a){c("oz-player/shims/ozClearTimeout")(h);return a})}g["default"]=b}),98);
__d("oz-player/networks/OzHTTPHeaders",["oz-player/shims/ozvariant"],(function(a,b,c,d,e,f,g){"use strict";d=function(){function a(){this.$1=new Map()}var b=a.prototype;b.append=function(a,b){a=a.toLowerCase();var c=this.$1.get(a);c!=null?this.$1.set(a,c+", "+b):this.$1.set(a,b)};b.get=function(a){a=a.toLowerCase();a=this.$1.get(a);return(a=a)!=null?a:null};b.entries=function(){return this.$1.entries()};b.has=function(a){return this.get(a)!==null};return a}();e=a.Headers;f=e&&e.prototype;var h=e&&f&&typeof f.append==="function"&&typeof f.entries==="function"&&typeof f.get==="function"&&typeof f.has==="function"?e:d;function b(a){if(a==null)return null;if(typeof a==="object"&&typeof a.append==="function"&&typeof a.get==="function"&&typeof a.has==="function")if(typeof a.entries==="function")return a;else if(typeof a.forEach==="function"){var b=new h();a.forEach(function(a,c){b.append(c,a)});return b}c("oz-player/shims/ozvariant")(!1,"Malformed Headers object: %s %s",typeof a,String(a));return null}g.OzHTTPHeaders=h;g.maybeConvertHeadersToOzHTTPHeaders=b}),98);
__d("oz-player/utils/arrayBuffer2OzReadableStream",["oz-player/shims/OzStreams"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return new(d("oz-player/shims/OzStreams").OzReadableStream)({start:function(b){var c=new Uint8Array(a);b.enqueue(c);b.close()}})}g["default"]=a}),98);
__d("oz-player/utils/maybeConvertReadableStreamToOzReadableStream",["asyncToGeneratorRuntime","oz-player/shims/OzStreams"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(!d("oz-player/shims/OzStreams").OzReadableStreamIsPolyfilled)return a;var c=a.getReader();return new(d("oz-player/shims/OzStreams").OzReadableStream)({start:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){while(!0){var b=(yield c.read());if(b.done)break;a.enqueue(b.value)}a.close()});function d(b){return a.apply(this,arguments)}return d}()})}g["default"]=a}),98);
__d("oz-player/utils/processFetchResponse",["oz-player/networks/OzHTTPHeaders","oz-player/shims/OzMaybeNativePromise","oz-player/utils/arrayBuffer2OzReadableStream","oz-player/utils/maybeConvertReadableStreamToOzReadableStream"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.body,e=a.ok,f=a.status,g=a.headers;return b!=null?c("oz-player/shims/OzMaybeNativePromise").resolve({ok:e,status:f,headers:d("oz-player/networks/OzHTTPHeaders").maybeConvertHeadersToOzHTTPHeaders(g),body:c("oz-player/utils/maybeConvertReadableStreamToOzReadableStream")(b),arrayBuffer:function(){return a.arrayBuffer()}}):a.arrayBuffer().then(function(a){return{ok:e,status:f,headers:d("oz-player/networks/OzHTTPHeaders").maybeConvertHeadersToOzHTTPHeaders(g),body:c("oz-player/utils/arrayBuffer2OzReadableStream")(a),arrayBuffer:function(){return c("oz-player/shims/OzMaybeNativePromise").resolve(a)}}})}g["default"]=a}),98);
__d("oz-player/networks/OzFetchRequestImplementation",["oz-player/networks/FetchWithTimeout","oz-player/utils/processFetchResponse"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e,f,g,h,i){f=d?d.networkTimeoutMs:null;g=c("oz-player/networks/FetchWithTimeout")(a,b.credentials,f);return g.then(function(a){var b=a.ok,d=a.status,f=a.headers;return e!=null&&!b&&typeof a.text==="function"?a.text().then(function(c){return{ok:b,status:d,headers:f,body:c,arrayBuffer:function(){return a.arrayBuffer()}}}):c("oz-player/utils/processFetchResponse")(a)})}b=a;d=b;g["default"]=d}),98);
__d("oz-player/networks/withRetries",["Promise","asyncToGeneratorRuntime","oz-player/shims/ozSetTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,d,e){return new(h||(h=b("Promise")))(function(f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){try{f(yield a())}catch(a){if(b>0){var i=typeof e==="function"?e(d-b):e;c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){h(b-1)},i)}else g(a)}});return i.apply(this,arguments)}h(d)})}g["default"]=a}),98);
__d("oz-player/networks/OzFetchWithCache",["oz-player/networks/OzFetchRequestImplementation","oz-player/networks/withRetries","oz-player/shims/OzMaybeNativePromise","oz-player/utils/OzErrorUtils","oz-player/utils/arrayBuffer2OzReadableStream","oz-player/utils/processFetchResponse"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.config,e=a.url,f=a.http,g=a.overrideOzRequestImplementation,h=a.options,i=a.prefetchCache,j=a.mediaStreamType,k=a.onPerfEntryAvailable,l=a.dataAppendedCallback,m=a.dataAppendedErrorCallback,n=g!=null?function(){return g.apply(void 0,arguments)}:c("oz-player/networks/OzFetchRequestImplementation");a=i?i.getCacheValue(e):null;i=a;a=!1;if(i)a=!0,i=i.then(function(a){if(a.initiator==="FETCH"){var b=a.response,e=b.ok,f=b.status,g=b.headers;return!e&&typeof a.response.text==="function"?a.response.text().then(function(b){return{ok:!1,status:f,headers:g,body:b,arrayBuffer:function(){return a.response.arrayBuffer()}}}):c("oz-player/utils/processFetchResponse")(a.response)}else if(a.initiator==="XHR_REQUEST"){b=c("oz-player/utils/arrayBuffer2OzReadableStream")(a.response);return{body:b,status:200,headers:null,ok:!0,arrayBuffer:function(){return c("oz-player/shims/OzMaybeNativePromise").resolve(a.response)}}}else throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_UNEXPECTED_CACHE_INITIATOR",description:"Unable to handle request initiator: "+a.initiator})})["catch"](function(a){return n(e,f,null,null,j,k,l,m)});else{var o;o=(o=h==null?void 0:h.retryAttempts_SIDX_USE_ONLY)!=null?o:0;if(o>0){var p;p=(p=h==null?void 0:h.retryTimeoutMs_SIDX_USE_ONLY)!=null?p:100;i=c("oz-player/networks/withRetries")(function(){return n(e,f,h,b,j,k,l,m)},o,p)}else i=n(e,f,h,b,j,k,l,m)}return{promise:i,retrievedFromCache:a}}g["default"]=a}),98);
__d("oz-player/utils/OzVideoUrlUtils",[],(function(a,b,c,d,e,f){"use strict";c=1<<31;var g=~c,h=c+1;function i(a){a=a|0;return Math.max(h,Math.min(a,g))}function j(a){a=Number.parseInt(a,16);return Number.isFinite(a)?new Date(i(a)*1e3):null}function k(){return i(Date.now()/1e3)}var l={OE:"oe",OE2:"oe2",ODM:"odm",USS:"uss"};function m(a){a=a instanceof URL?a.searchParams:new URL(a).searchParams;a=a.get(l.OE);a=a==null?void 0:j(a);return{expirationDate:a}}function a(a){a=a instanceof URL?a.searchParams:new URL(a).searchParams;return a.get(l.OE2)!==null||a.get(l.ODM)!==null||a.get(l.USS)!==null}function b(a){a=m(a);a=a.expirationDate;return a!=null&&a<=new Date(k()*1e3)}f.DEFAULT_UNIXTIME=c;f.MAX_INT=g;f.parseCdnUrlParams=m;f.isShortenedExpiryTimestampCdnUrl=a;f.isCdnUrlExpired=b}),66);
__d("oz-player/networks/OzNetworkRequestStream",["Promise","oz-player/networks/OzCreateErrorStream","oz-player/networks/OzFetchWithCache","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorUtils","oz-player/utils/OzResourceTimingUtils","oz-player/utils/OzVideoUrlUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$8=!1;var b=a.debugName,c=a.config,d=a.baseUri,e=a.baseUriDecisionTime,f=a.options,g=a.requestParamCreator,h=a.networkRequestStreamHandlers,i=a.overrideOzRequestImplementation,j=a.prefetchCache,k=a.networkRequestStreamRetryHandler,l=a.networkRequestUrlRefreshHandler,m=a.dynamicVideoLibrary,n=a.mediaStreamType,o=a.dataAppendedCallback;a=a.dataAppendedErrorCallback;this.$1=b;this.$2=d;this.$3=f;this.$4=g;this.$10=(b=h)!=null?b:[];this.$11=k;this.$12=l;this.$9=i;this.$13=j;this.$14=c;this.$15=m;this.$16=e;this.$17=n;this.$18=o;this.$19=a}var e=a.prototype;e.$20=function(a){var b=this;a=this.$4.createRequestParam(this.$2,a);var d=a.uri;a=a.http;d=d.toString();this.$5=d;a=c("oz-player/networks/OzFetchWithCache")({config:this.$14,url:d,http:a,overrideOzRequestImplementation:this.$9,options:this.$3,prefetchCache:this.$13,mediaStreamType:this.$17,onPerfEntryAvailable:function(a){b.$21(a)},dataAppendedCallback:this.$18,dataAppendedErrorCallback:this.$19});var e=a.promise;a=a.retrievedFromCache;this.$8=a;return{requestPromise:e,requestUrl:d}};e.startStream=function(a){var b=this;return this.$22().then(function(){if(b.$14.getBool("video_cdn_url_refresh")&&!d("oz-player/utils/OzVideoUrlUtils").isShortenedExpiryTimestampCdnUrl(b.$2.toString())&&d("oz-player/utils/OzVideoUrlUtils").isCdnUrlExpired(b.$2.toString()))return c("oz-player/networks/OzCreateErrorStream")(d("oz-player/utils/OzErrorUtils").createOzNetworkError({description:"OzNetworkRequestStream("+b.$1+") CDN URL expired.",responseStatus:0,responseHeaders:null,requestUrl:b.$2.toString()}));var e=b.$20(a),f=e.requestPromise,g=e.requestUrl,h=g,i=Date.now();return f.then(function(e){var f;(f=b.$15)==null?void 0:f.updateWithResponse(g,i,b.$16,e);b.$7=e;if(b.$11!=null&&e.ok===!1)return b.$11(e,function(){var d=b.$20(a),c=d.requestPromise;d=d.requestUrl;h=d;return c},h)["catch"](function(a){throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR",description:String(a),extra:{originalError:a,code:c("oz-player/utils/OzCustomErrorCode").NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR,url:h}})});else return e}).then(function(a){var e=[];for(var f=0;f<b.$10.length;f++)try{var g=b.$10[f].onResponse(a,h);g&&e.push(g)}catch(a){g=a;return c("oz-player/networks/OzCreateErrorStream")(g)}g=a.body;f=a.headers;var i=a.ok;a=a.status;if(!i)return c("oz-player/networks/OzCreateErrorStream")(d("oz-player/utils/OzErrorUtils").createOzNetworkError({description:"OzNetworkRequestStream("+b.$1+") HTTP status not OK",responseStatus:a,responseHeaders:f,requestUrl:h,responseBody:typeof g==="string"?g:void 0}));typeof g!=="string"&&typeof g.getReader==="function"||c("oz-player/shims/ozvariant")(0,3287);i=g;for(a=0;a<e.length;a++)i=i.pipeThrough(e[a]);return i},function(a){var e=[];for(var f=0;f<b.$10.length;f++)try{var g=b.$10[f].onError(a,h);g&&e.push(g)}catch(a){g=a;return c("oz-player/networks/OzCreateErrorStream")(g)}if(a instanceof TypeError){g=c("oz-player/networks/OzCreateErrorStream")(d("oz-player/utils/OzErrorUtils").createOzNetworkError({description:"OzNetworkRequestStream("+b.$1+") TypeError: "+a.message,responseStatus:0,responseHeaders:null,requestUrl:h}));for(f=0;f<e.length;f++)g=g.pipeThrough(e[f]);return g}throw a})["catch"](function(a){if(d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR")throw a;if(a.name==="AbortError"){var b=a.message;return c("oz-player/networks/OzCreateErrorStream")({type:a.name,status:a.code,url:h,message:b})}return c("oz-player/networks/OzCreateErrorStream")({type:"stream_processing",status:0,url:h,message:"Stream processing error. "+a})})})};e.$21=function(a){this.$6=a};e.getLastPerformanceEntry=function(){if(this.$6!=null)return this.$6;return this.$5==null?null:d("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(this.$5)};e.getLastRequestUrl=function(){return this.$5};e.getLastResponse=function(){return this.$7};e.retrievedFromCache=function(){return this.$8};e.$22=function(){var a=this;if(this.$14.getBool("video_cdn_url_refresh")&&!d("oz-player/utils/OzVideoUrlUtils").isShortenedExpiryTimestampCdnUrl(this.$2.toString())&&d("oz-player/utils/OzVideoUrlUtils").isCdnUrlExpired(this.$2.toString())&&this.$12)return this.$12(this.$2.toString()).then(function(b){b.refreshedUrl!=null&&b.reason==="OK"&&(a.$2=new(c("oz-player/shims/OzURI"))(b.refreshedUrl));return});else return(h||(h=b("Promise"))).resolve()};return a}();g["default"]=a}),98);
__d("oz-player/manifests/OzByteRange",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.startByte===b.startByte}function b(a,b){return b.endByte===null?!1:a.startByte===b.endByte+1}function c(a,b){return a.startByte<b.startByte?!1:b.endByte==null||b.endByte>=a.startByte}function d(a,b){a=a;b=b;if(b.startByte<a.startByte){var c=a;a=b;b=c}if(a.endByte==null)return{startByte:a.startByte,endByte:null};if(b.startByte>a.endByte+1)return null;c=b.endByte==null||b.endByte>a.endByte?b.endByte:a.endByte;return{startByte:a.startByte,endByte:c}}function e(a,b){if(b.endByte==null)return null;if(a.startByte>b.endByte)return{startByte:a.startByte,endByte:a.endByte};return a.endByte!=null&&a.endByte<=b.endByte?null:{startByte:b.endByte+1,endByte:a.endByte}}function g(a){return a.endByte==null?null:a.endByte-a.startByte+1}f.startsAtSame=a;f.startsImmediateAfter=b;f.startsDuring=c;f.union=d;f.disjoinAfter=e;f.getLength=g}),66);
__d("oz-player/networks/OzProducerInterruptedError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("oz-player/networks/OzDeferredBuffer",["oz-player/networks/OzProducerInterruptedError","oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){a===void 0&&(a={});this.$2=[];this.$3=!1;this.$5=0;a=a;a=a.disableArrayShift;this.$1=!!a}var b=a.prototype;b.produce=function(a){this.$6(a)};b.signalProducerInterruption=function(){this.$6(new(c("oz-player/networks/OzProducerInterruptedError"))("producer interrupted"))};b.consume=function(a){var b=this;if(this.$3)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DEFERRED_BUFFER",description:"A buffer can only be consumed by one client at a time"});this.$3=!0;var e=c("oz-player/shims/OzMaybeNativePromise").resolve();this.isEmpty()&&(this.$4=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),e=this.$4.getPromise());return e.then(function(){if(b.$1){if(b.$2[b.$5]===void 0)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DEFERRED_BUFFER",description:"buffer has no value at position "+b.$5})}else if(b.$2.length===0)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_DEFERRED_BUFFER",description:"buffer length must not be 0"});b.$4=null;b.$3=!1;var c=b.$1?b.$7(a):b.$8(a);if(c instanceof Uint8Array)return c;throw c})};b.$6=function(a){this.$2.push(a),this.$4&&this.$4.resolve()};b.$7=function(a){var b=this.$2[this.$5];if(b===void 0)return new Uint8Array([]);b=b;if(!(b instanceof Uint8Array)){this.$2[this.$5]=void 0;this.$5++;return b}if(a!==void 0&&b.length>a){var c=b.slice(a);b=b.slice(0,a);this.$2[this.$5]=c}else this.$2[this.$5]=void 0,this.$5++;return b};b.$8=function(a){if(this.$2.length===0)return new Uint8Array([]);var b=this.$2[0];if(!(b instanceof Uint8Array)){this.$2.shift();return b}if(a!==void 0&&b.length>a){var c=b.slice(a);b=b.slice(0,a);this.$2[0]=c}else this.$2.shift();return b};b.isEmpty=function(){return this.$1?this.$2[this.$5]===void 0:this.$2.length===0};return a}();g["default"]=a}),98);
__d("oz-player/utils/ozPipeErrorTo",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){try{a==null?void 0:a.error(b)}catch(a){}}f["default"]=a}),66);
__d("oz-player/networks/OzPausableRangeStream",["oz-player/manifests/OzByteRange","oz-player/networks/OzDeferredBuffer","oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/utils/OzErrorUtils","oz-player/utils/ozPipeErrorTo"],(function(a,b,c,d,e,f,g){"use strict";function h(){return d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_STREAM",description:"Upstream has an inconsistent range"})}var i=function(){function a(){this.$1=0}var b=a.prototype;b.setBytesToSkip=function(a){this.$1=a};b.setBytesSkipped=function(a){this.$1-=a};b.getBytesToSkip=function(){return this.$1};b.hasMoreBytesToSkip=function(){return this.$1>0};return a}();a=function(){function a(b,d,e,f,g){var j=this;this.$5=!1;this.$7=0;this.$8=0;this.$13=!1;this.$14=new i();this.$15=!1;this.$16=!1;this.$17=!1;this.startStream=function(){j.$13=!0;var b={startByte:j.$1.startByte,endByte:j.$1.endByte};!j.$15?b.startByte+=j.$8:j.$8&&(j.$3.produce("skip_buffered_bytes"),j.$8=0);var d=j.$4;return j.$2.startStream(b).then(function(b){b.pipeTo(j.$16?d:j.$4).then(function(){j.$12&&j.$12.resolve("stream_done")})["catch"](function(b){j.$12&&!j.$12.isSettled()&&(j.$16&&b===a.STREAM_PAUSED?j.$12.resolve("stream_paused"):j.$12.reject(b))});j.$12=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));return{statusPromise:j.$12.getPromise()}})};this.$18=b;this.$19=d;this.$1=e;this.$2=f;b=g||{};d=b.fixStreamingUndefinedEndByte;e=b.disableDeferredBufferArrayShift;f=b.enablePausableStreamResumeFromStartDangerously;g=b.fixPausePreReadableStream;b=b.throwErrorWhenAborted;this.$11=!!d;this.$15=!!f;this.$16=!!g;this.$17=!!b;this.$3=new(c("oz-player/networks/OzDeferredBuffer"))({disableArrayShift:!!e});this.$6=new this.$18({start:function(a){j.$10=a},pull:function(a){if((j.$11&&j.$1.endByte===null&&j.$5||j.$7===j.$20())&&j.$3.isEmpty()){a.close();return c("oz-player/shims/OzMaybeNativePromise").resolve()}var b=function b(){var d=j.$14.hasMoreBytesToSkip()?j.$14.getBytesToSkip():void 0;return j.$3.consume(d).then(function(d){if(j.$14.hasMoreBytesToSkip()){j.$14.setBytesSkipped(d.length);return b()}j.$7+=d.length;var e=j.$20();e!==null&&j.$7>(e||0)&&c("oz-player/utils/ozPipeErrorTo")(j.$10,h());a.enqueue(d)})["catch"](function(a){if(a==="skip_buffered_bytes"){j.$14.setBytesToSkip(j.$7);return b()}throw a})};return b()},cancel:function(a){j.$12&&j.$12.resolve("stream_cancelled"),c("oz-player/utils/ozPipeErrorTo")(j.$9,a)}});this.$4=this.$21()}var b=a.prototype;b.$20=function(){var a=this.$1,b=a.startByte;a=a.endByte;return a!=null?a-b+1:null};b.$21=function(){var a=this;return new this.$19({start:function(b){a.$9=b},write:function(b){a.$3.produce(b),a.$8+=b.length},close:function(){a.$5=!0;var b=a.$1,d=b.endByte;b=b.startByte;a.$11&&d===null&&a.$3.produce(new Uint8Array([]));d!==null&&a.$8!==(d||0)-b+1&&c("oz-player/utils/ozPipeErrorTo")(a.$10,h())},abort:function(b){a.$12&&(a.$17?a.$12.reject(b):a.$12.resolve("stream_aborted")),c("oz-player/utils/ozPipeErrorTo")(a.$10,b)}})};b.getStream=function(){return this.$6};b.pauseStream=function(){c("oz-player/utils/ozPipeErrorTo")(this.$9,a.STREAM_PAUSED),this.$12&&this.$12.resolve("stream_paused"),this.$4=this.$21()};b.getByteRange=function(){return this.$1};b.getBytesStreamed=function(){return this.$7};b.tryConcatByteRange=function(a){if(this.$13||!d("oz-player/manifests/OzByteRange").startsImmediateAfter(a,this.$1))return!1;this.$1={startByte:this.$1.startByte,endByte:a.endByte};return!0};return a}();a.STREAM_PAUSED="streamPaused";g["default"]=a}),98);
__d("oz-player/networks/RequestParamCreator",["oz-player/shims/OzURI"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){var d=this;this.createRequestParam=function(a,b){var e=new(c("oz-player/shims/OzURI"))(a.toString());if(b){a=b.startByte;var f=b.endByte;a===0&&f==null||(e.addQueryData({bytestart:b.startByte}),f!=null&&e.addQueryData({byteend:f}))}if(d.$2){var g=d.$2(e);g&&Object.keys(g).forEach(function(a){var b=g[a];e.addQueryData(a,b)})}a=d.$1&&d.$1(e)?"include":"same-origin";return{uri:e,http:{credentials:a}}};this.$1=a;this.$2=b};g["default"]=a}),98);
__d("oz-player/networks/getOzSegmentStreamableRange",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(!a.length)return null;var b=a[0].getURI().toString(),c=a[0].getByteRange();if(!c)return null;var d=c;for(var e=1;e<a.length;e++){var f=a[e];if(f.getURI().toString()!==b)return null;f=f.getByteRange();if(!d||!f)return null;if(d.endByte===null||f.startByte!==d.endByte+1)return null;d=f}return{startByte:c.startByte,endByte:d.endByte}}f["default"]=a}),66);
__d("oz-player/utils/OzNetworkRequestLoggingUtils",["oz-player/shims/OzNetworkDiagnostics","oz-player/utils/OzResourceTimingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){return a?parseInt(a.get("content-length"),10):null},i=function(a){return a?a.get("x-fb-fna-hit"):null},j=function(a){return a?a.get("x-fb-edge-hit"):null},k=function(a){return a?a.get("x-fb-origin-hit"):null},l=function(a){return a?parseInt(a.get("x-fb-dynamic-latest-segment-id"),10):null},m=function(a,b){b=d("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(b);b&&a.setTimeToFirstByte(Math.round(b.responseStart-b.startTime)).setTimeToLastByte(Math.round(b.responseEnd-b.startTime)).setTimeToRequestStart(Math.round(b.requestStart-b.startTime))};a=function(a,b,d,e,f,g){d.length&&a.setSegmentCount(d.length),b!=null&&b!==""&&m(a,String(b)),a.setResource(b!=null&&b!==""?b:null).setInitiator("fetch").setTimeToRequestSent(Math.round(Math.floor(e))).setLiveheadSeqNumHeader(l(g==null?void 0:g.headers)).setContentLengthHeader(h(g==null?void 0:g.headers)).setEdgeHitHeader(j(g==null?void 0:g.headers)).setOriginHitHeader(k(g==null?void 0:g.headers)).setFNAHitHeader(i(g==null?void 0:g.headers)).setResponseTimeMsHeader(c("oz-player/shims/OzNetworkDiagnostics").getResponseTimeMs(g==null?void 0:g.headers)).setUserInfo({segmentPTSHeader:String(c("oz-player/shims/OzNetworkDiagnostics").getDvlSegmentPTS(g==null?void 0:g.headers))}).setCode(g==null?void 0:g.status).setLength(f)};b=function(a,b,d,e,f,g,i){b!=null&&b!==""&&m(a,String(b)),a.setResource(b!=null&&b!==""?b:null).setLiveheadSeqNumHeader(l(e==null?void 0:e.headers)).setContentLengthHeader(h(e==null?void 0:e.headers)).setEdgeHitHeader(j(e==null?void 0:e.headers)).setOriginHitHeader(k(e==null?void 0:e.headers)).setResponseTimeMsHeader(c("oz-player/shims/OzNetworkDiagnostics").getResponseTimeMs(e==null?void 0:e.headers)).setCode(e==null?void 0:e.status).setLength(d).setClientTimeBegin(f).setClientTimeDuration(g-f).setClientTimeEnd(g).setUserInfo(i!=null&&i>0?{chunkSize:String(i)}:null)};g.setPerformanceLoggingAttributes=m;g.setFetchStreamLoggingAttributes=a;g.setBandwidthSampledLoggingAttributes=b}),98);
__d("oz-player/networks/OzNetworkManager",["oz-player/loggings/OzLoggingUtils","oz-player/networks/OzNetworkRequestStream","oz-player/networks/OzPausableRangeStream","oz-player/networks/RequestParamCreator","oz-player/networks/getOzSegmentStreamableRange","oz-player/shims/OzStreams","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzNetworkRequestLoggingUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$10=null;var b=a.config,d=a.prefetchCache,e=a.networkRequestStreamHandlers,f=a.getOverrideOzRequestImplementation,g=a.getShouldIncludeCredentials,h=a.getCustomRequestParametersForURI,i=a.networkRequestStreamRetryHandler,j=a.networkRequestUrlRefreshHandler,k=a.setCustomFetchStreamLoggingAttributes,l=a.dynamicVideoLibrary,m=a.configureCustomRequestParametersForSegment;a=a.onResourceTimingBufferFull;this.$2=b;this.$8=g;this.$9=h;this.$1=new(c("oz-player/networks/RequestParamCreator"))(this.$8,this.$9);this.$3=d;this.$4=e;this.$5=i;this.$6=j;this.$7=f;this.$10=k;this.$11=l;this.$12=m;this.$13=a}var b=a.prototype;b.destroy=function(){};b.request=function(a){var b=a.debugName,d=a.segments,e=a.pipeThroughRangeStreamProviders,f=a.loggerProvider,g=a.requestOptions,h=a.mediaStreamType,i=a.dataAppendedCallback;a=a.dataAppendedErrorCallback;d.length>0||c("oz-player/shims/ozvariant")(0,212);var j=c("oz-player/networks/getOzSegmentStreamableRange")(d)||{startByte:0,endByte:null},k=this.$7?this.$7():null,l=this.$14(d[0]);b=new(c("oz-player/networks/OzNetworkRequestStream"))({debugName:b,config:this.$2,baseUri:l,baseUriDecisionTime:null,options:g,requestParamCreator:this.$1,networkRequestStreamHandlers:this.$4,networkRequestUrlRefreshHandler:this.$6,overrideOzRequestImplementation:k,prefetchCache:this.$3,networkRequestStreamRetryHandler:this.$5,mediaStreamType:h,dataAppendedCallback:i,dataAppendedErrorCallback:a});return this.$15(j,b,e,f,d)};b.createPausableStream=function(a){var b=a.debugName,d=a.segments,e=a.pipeThroughRangeStreamProviders,f=a.loggerProvider,g=a.mediaStreamType,h=a.dataAppendedCallback;a=a.dataAppendedErrorCallback;d.length>0||c("oz-player/shims/ozvariant")(0,212);var i=c("oz-player/networks/getOzSegmentStreamableRange")(d)||{startByte:0,endByte:null},j=null,k=this.$2.getNumber("network_seg_timeout_ms");k>0&&(j={networkTimeoutMs:k});k=this.$7?this.$7():null;var l=new(c("oz-player/networks/OzNetworkRequestStream"))({debugName:b,config:this.$2,baseUri:this.$14(d[0]),baseUriDecisionTime:d[0].getOptions().getSegmentNumDecisionTime(),options:j,requestParamCreator:this.$1,networkRequestStreamHandlers:this.$4,networkRequestUrlRefreshHandler:this.$6,overrideOzRequestImplementation:k,prefetchCache:this.$3,networkRequestStreamRetryHandler:this.$5,dynamicVideoLibrary:this.$11,mediaStreamType:g,dataAppendedCallback:h,dataAppendedErrorCallback:a});return{pausableStream:this.$16(i,l,e||null,f),loggingPayloads:{getRequestUrl:function(){return l.getLastRequestUrl()||null},segments:d,getResponse:function(){return l.getLastResponse()}}}};b.requestRawUrl=function(a){var b=a.debugName,d=a.url,e=a.options;a=a.loggerProvider;var f=this.$7?this.$7():null;b=new(c("oz-player/networks/OzNetworkRequestStream"))({debugName:b,config:this.$2,baseUri:new(c("oz-player/shims/OzURI"))(d),baseUriDecisionTime:null,options:e,requestParamCreator:this.$1,networkRequestStreamHandlers:this.$4,networkRequestUrlRefreshHandler:this.$6,overrideOzRequestImplementation:f,prefetchCache:this.$3,networkRequestStreamRetryHandler:this.$5,dynamicVideoLibrary:this.$11,mediaStreamType:null,dataAppendedCallback:null,dataAppendedErrorCallback:null});d={startByte:0,endByte:null};return this.$15(d,b,[],a)};b.$16=function(a,b,e,f){b=b;if(e!=null)for(var g=0;g<e.length;g++){var h=e[g];b=h(this.$2,b,f,this.$13)}return new(c("oz-player/networks/OzPausableRangeStream"))(d("oz-player/shims/OzStreams").OzReadableStream,d("oz-player/shims/OzStreams").OzWritableStream,a,b,{fixStreamingUndefinedEndByte:!0,enablePausableStreamResumeFromStartDangerously:!0,fixPausePreReadableStream:!0,throwErrorWhenAborted:!0})};b.$15=function(a,b,c,e,f){var g=this;f===void 0&&(f=[]);var h=this.$16(a,b,c,e);a=h.startStream();var i=this.$17(a);if(e){c=function(a){d("oz-player/utils/OzNetworkRequestLoggingUtils").setFetchStreamLoggingAttributes(a,b.getLastRequestUrl(),f,0,h.getBytesStreamed(),b.getLastResponse());var c=g.$10;c&&c(a,b.getLastRequestUrl(),b.getLastResponse())};d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(i,e,"fetch_stream",c,c)}return{getStream:function(){return h.getStream()},cancel:function(){return h.pauseStream()},getStatusChangePromise:function(){return i}}};b.$17=function(a){return a.then(function(a){a=a.statusPromise;return a.then(function(a){return"done"})})};b.$14=function(a){var b=this.$12,d=new(c("oz-player/shims/OzURI"))(a.getURI().toString());if(b){var e=b(a);e&&Object.keys(e).forEach(function(a){var b=e[a];d.addQueryData(a,b)})}return d};a.getStreamableSegmentsRange=function(a){if(!a.length)return[];return!c("oz-player/networks/getOzSegmentStreamableRange")(a)?[a[0]]:a.slice(0)};return a}();g["default"]=a}),98);
__d("oz-player/manifests/Mpd",["oz-player/shims/OzEventEmitter","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i){var j;j=a.call(this)||this;j.$Mpd$p_9=!1;j.$Mpd$p_1=b;j.$Mpd$p_5=g;j.$Mpd$p_2=c;j.$Mpd$p_3=d;j.$Mpd$p_4=e;j.$Mpd$p_6=f;j.$Mpd$p_7=h;j.$Mpd$p_8=i;return j}var c=b.prototype;c.markRefreshed=function(){this.$Mpd$p_10=Date.now()};c.getRefreshDate=function(){return this.$Mpd$p_10};c.updateLocation=function(a){this.$Mpd$p_6=a,this.$Mpd$p_9=!0,this.emit("locationUpdated")};c.getLocation=function(){return this.$Mpd$p_6};c.getMinimumUpdatePeriod=function(){return this.$Mpd$p_5};c.getVideoRepresentations=function(){return this.$Mpd$p_2};c.getVideoRepresentationsByVariant=function(a){return a.lang===null?this.$Mpd$p_2.filter(function(b){return b.getLang()===a.lang&&b.getRole()===a.role}):this.$Mpd$p_2.filter(function(b){return b.getLang()===a.lang&&b.getRole()===a.role})};c.getAudioRepresentationsByVariant=function(a){return a.lang===null?this.$Mpd$p_3.filter(function(b){return b.getLang()===a.lang&&b.getRole()===a.role}):this.$Mpd$p_3.filter(function(b){return b.getLang()===a.lang&&b.getRole()===a.role})};c.getAudioRepresentations=function(){return this.$Mpd$p_3};c.getApplicationRepresentations=function(){return this.$Mpd$p_4};c.getCustomField=function(a){var b=this.$Mpd$p_7.get(a);if(!b)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_MPD_PARSER",description:"Custom parser not specified for field "+a});try{return b(this.$Mpd$p_1)}catch(a){return null}};c.isStaticMpd=function(){return this.$Mpd$p_8};c.updateWith=function(a){this.$Mpd$p_9&&(this.$Mpd$p_9=!1,this.$Mpd$p_2.splice(0,this.$Mpd$p_2.length),this.$Mpd$p_3.splice(0,this.$Mpd$p_3.length),this.$Mpd$p_4.splice(0,this.$Mpd$p_4.length)),this.$Mpd$p_1=a.$Mpd$p_1,this.$Mpd$p_11(this.$Mpd$p_2,a.getVideoRepresentations()),this.$Mpd$p_11(this.$Mpd$p_3,a.getAudioRepresentations()),this.$Mpd$p_11(this.$Mpd$p_4,a.getApplicationRepresentations()),this.$Mpd$p_8=a.isStaticMpd(),this.$Mpd$p_5=a.getMinimumUpdatePeriod(),this.emit("updated")};c.blockTimeRange=function(a){this.$Mpd$p_2.forEach(function(b){return b.blockTimeRange(a)}),this.$Mpd$p_3.forEach(function(b){return b.blockTimeRange(a)}),this.$Mpd$p_4.forEach(function(b){return b.blockTimeRange(a)})};c.unblockTimeRange=function(){this.blockTimeRange({startTime:0,endTime:0})};c.$Mpd$p_11=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=!1;for(var f=0;f<a.length;f++){var g=a[f];if(d.getID()===g.getID()){g.updateWith(d);e=!0;break}}e||a.push(d)}};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/manifests/OzApplicationRepresentation",["oz-player/manifests/OzRepresentationBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c("oz-player/manifests/OzRepresentationBase"));g["default"]=a}),98);
__d("oz-player/parsers/OzSegmentTemplateParser",["oz-player/manifests/OzSegmentOptions","oz-player/parsers/OzDefaultSegmentTimelineParser","oz-player/shims/OzURI","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b){this.$3=new(c("oz-player/manifests/OzSegmentOptions"))(),this.$2=a,this.$1=b}var b=a.prototype;b.getData=function(){return this.$1};b.getTimeRange=function(){return{startTime:0,endTime:0}};b.getByteRange=function(){return null};b.getURI=function(){return this.$2};b.getSequenceNumber=function(){return null};b.getOptions=function(){return this.$3};return a}();a=function(){function a(a,b,d,e,f){this.$2=d,this.$1=b,this.$3=a,e?this.$4=e:this.$4=new(c("oz-player/parsers/OzDefaultSegmentTimelineParser"))(),this.$5=f}var b=a.prototype;b.parseInitializationSegment=function(){var a=d("oz-player/utils/OzUrlHelper").joinUrlPaths(this.$2.baseUrl,this.$1.$.initialization);return new h(new(c("oz-player/shims/OzURI"))(a),this.$5)};b.parseSegmentsContainer=function(){return this.$4.parseSegmentsContainer(this.$3,this.$2,this.$1)};return a}();g["default"]=a}),98);
__d("oz-player/manifests/OzZeroTimeRangeSegment",["oz-player/manifests/OzSegmentOptions"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d){this.$4=new(c("oz-player/manifests/OzSegmentOptions"))(),this.$1=a,this.$2=b,this.$3=d}var b=a.prototype;b.getData=function(){return null};b.getURI=function(){return this.$1};b.getTimeRange=function(){return{startTime:0,endTime:0}};b.getByteRange=function(){return{startByte:this.$2,endByte:this.$3}};b.getSequenceNumber=function(){return null};b.getOptions=function(){return this.$4};return a}();g["default"]=a}),98);
__d("oz-player/networks/OzNetworkRequestStreamBandwidthReporter",["oz-player/networks/OzTransformStream","oz-player/shims/OzNetworkDiagnostics","oz-player/utils/OzNetworkRequestLoggingUtils"],(function(a,b,c,d,e,f,g){"use strict";b=function(){function b(b){var d=this;this.$8=Date.now();this.$9=Date.now();this.$10=0;this.$11=0;this.$12=function(){};this.$13=function(){};this.$14=function(){};this.$16=new(c("oz-player/networks/OzTransformStream"))();this.$19=!1;this.$20=!1;this.$21=null;this.$22=function(a){d.$25();a.length!=null&&(d.$11+=a.length);d.$26();if(d.$18)return;d.$27()};this.$23=function(){if(d.$21!=null&&d.$21>0)return;var b=Date.now()-d.$8,c=d.$1.getLastPerformanceEntry();c&&d.$13(c.responseStart-c.requestStart,c.responseEnd-c.requestStart,d.$11);!c&&a.__isresourcetimingbufferfull&&d.$15&&d.$15();d.$3>0&&b>0&&d.$10===0&&d.$11>=d.$3&&d.$28(d.$11,b)};var e=b.stream,f=b.loggerProvider,g=b.byteCountPerSample,h=b.minimumBytesToSampleOnClose,i=b.minimumSampleDuration,j=b.maximumSampleBandwidth,k=b.useResponseTimeMs,l=b.responseTimeHandicapMs,m=b.ignoreOnStreamWriteSamples;b=b.onResourceTimingBufferFull;this.$1=e;this.$17=f;this.$2=g;this.$3=h;this.$4=i;this.$5=j;this.$6=k;this.$7=l;this.$18=m;this.$16.addListener("writableWrite",this.$22);this.$16.addListener("writableClose",this.$23);this.$15=b}var e=b.prototype;e.getTransformStream=function(){return this.$16};e.onBandwidthSample=function(a){this.$12=a};e.onNavigationTimingSample=function(a){this.$13=a};e.onEstimateFromHeaders=function(a){this.$14=a};e.$24=function(a,b,c){b=b-c;c=this.$17?this.$17.getOperationLogger("bandwidth_sampled"):null;if(c){var e=Date.now(),f=e-b;d("oz-player/utils/OzNetworkRequestLoggingUtils").setBandwidthSampledLoggingAttributes(c,this.$1.getLastRequestUrl(),a,this.$1.getLastResponse(),f,e,this.$21);c.log()}this.$12(a,b)};e.$29=function(a,b,c){if(b-c<=0)return!0;c=a*8/(b/1e3);return b<this.$4&&c>this.$5};e.$28=function(a,b){var d=this.$1.getLastResponse();d=this.$6?c("oz-player/shims/OzNetworkDiagnostics").getResponseTimeMs(d==null?void 0:d.headers)||0:0;this.$29(a,b,d)||this.$24(a,b,Math.max(d-this.$7,0))};e.$25=function(){var a;a=(a=this.$1.getLastResponse())==null?void 0:a.headers;if(this.$20||a==null)return;this.$20=!0;a=c("oz-player/shims/OzNetworkDiagnostics").getBandwidthMeanEstimate(a);a!=null&&this.$14(a)};e.$26=function(){if(this.$19)return;if(this.$21==null){var a=this.$1.getLastResponse();this.$21=c("oz-player/shims/OzNetworkDiagnostics").getUsableResponseSizeForBandwidthEstimation(a==null?void 0:a.headers)||0}this.$21!=null&&this.$21>0&&this.$11>=this.$21&&(this.$19=!0,this.$28(this.$11,Date.now()-this.$9))};e.$27=function(){var a=Date.now(),b=a-this.$8;this.$2>0&&this.$11>=this.$10+this.$2&&!this.$29(this.$11,b,0)&&(this.$24(this.$11-this.$10,b,0),this.$8=a,this.$10=this.$11)};return b}();g["default"]=b}),98);
__d("oz-player/networks/bandwidth/pipeStreamThroughBandwidthEstimator",["oz-player/networks/OzNetworkRequestStreamBandwidthReporter"],(function(a,b,c,d,e,f,g){"use strict";var h=2e5;function a(a,b,d,e,f){return{startStream:function(g){var i=new(c("oz-player/networks/OzNetworkRequestStreamBandwidthReporter"))({stream:b,loggerProvider:d,byteCountPerSample:a.getNumber("byte_count_per_sample",h),minimumBytesToSampleOnClose:a.getNumber("minimum_bytes_to_sample_on_close",25e3),minimumSampleDuration:a.getNumber("minimum_bandwidth_sample_duration",10),maximumSampleBandwidth:a.getNumber("maximum_bandwidth_sample_bandwidth",1e8),useResponseTimeMs:a.getBool("bandwidth_use_response_time_adjustment",!1),responseTimeHandicapMs:a.getNumber("bandwidth_response_time_handicap",0),ignoreOnStreamWriteSamples:a.getBool("bandwidth_ignore_on_stream_write_samples",!1),onResourceTimingBufferFull:f});i.onBandwidthSample(function(a,b){e.addBandwidthSample(a,b)});i.onNavigationTimingSample(function(b,c,d){var f=a.getNumber("time_to_first_byte_ignore_above_threshold_ms",0);(f===0||b<=f)&&e.addNavigationTimingSample(b,c,d)});i.onEstimateFromHeaders(function(a){e.setBandwidthEstimateFromHeaders({meanEstimate:a})});return b.startStream(g).then(function(a){return b.retrievedFromCache()?a:a.pipeThrough(i.getTransformStream())})}}}g.pipeStreamThroughBandwidthEstimator=a}),98);
__d("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter",["oz-player/networks/OzBandwidthEstimator","oz-player/networks/OzNetworkRequestStream","oz-player/networks/bandwidth/pipeStreamThroughBandwidthEstimator"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b,e,f,g){var h=a==="video";return e instanceof c("oz-player/networks/OzNetworkRequestStream")&&h?d("oz-player/networks/bandwidth/pipeStreamThroughBandwidthEstimator").pipeStreamThroughBandwidthEstimator(b.getLegacyConfig(),e,f,c("oz-player/networks/OzBandwidthEstimator"),g):e}}g["default"]=a}),98);
__d("oz-player/manifests/OzDataSegment",["oz-player/manifests/OzSegmentOptions"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f){this.$6=new(c("oz-player/manifests/OzSegmentOptions"))(),this.$1=a,this.$2=b,this.$3=d,this.$4=e,this.$5=f}var b=a.prototype;b.getData=function(){return null};b.getURI=function(){return this.$1};b.getTimeRange=function(){return{startTime:this.$2,endTime:this.$3}};b.getByteRange=function(){return{startByte:this.$4,endByte:this.$5}};b.getSequenceNumber=function(){return null};b.getOptions=function(){return this.$6};return a}();g["default"]=a}),98);
__d("oz-player/shims/www/OzDataViewReaderWWW",["DataViewReader"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("DataViewReader")}),98);
__d("oz-player/shims/OzDataViewReader",["oz-player/shims/www/OzDataViewReaderWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzDataViewReaderWWW")}),98);
/**
 * License: https://www.facebook.com/legal/license/Vkd8AdLnKqZ/
 */
__d("oz-player/parsers/OzMp4SidxParser",["oz-player/manifests/OzDataSegment","oz-player/manifests/OzSegmentOptions","oz-player/shims/OzDataViewReader","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=1936286840;function a(a,b,e,f){var g=new(c("oz-player/shims/OzDataViewReader"))(new DataView(f.buffer));f=g.readUint32();var i=g.readUint32();if(i!==h)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SIDX_PARSER",description:'Invalid box type, expected "sidx".'});f==1&&(f=g.readUint64());i=g.readUint8();g.skip(3);g.skip(4);var j=g.readUint32();if(!j)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SIDX_PARSER",description:"Invalid timescale."});var k;i==0?(i=g.readUint32(),k=g.readUint32()):(i=g.readUint64(),k=g.readUint64());g.skip(2);var l=g.readUint16(),m=i,n=e+f+k,o=0,p=a.getBool("sidx_parser_memory_optimization"),q=[];i=function(a){var e=g.readUint32(),f=(e&2147483648)>>>31;e=e&2147483647;var h=g.readUint32();g.readUint32();if(f==1)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SIDX_PARSER",description:"Heirarchical SIDXs are not supported."});var i=m/j,k=(m+h)/j;a===0&&(o=i);var l=n,r=l+e-1,s=new(c("oz-player/manifests/OzSegmentOptions"))();q.push(p?new(c("oz-player/manifests/OzDataSegment"))(b,i-o,k-o,l,r):{getData:function(){return null},getURI:function(){return b},getTimeRange:function(){return{startTime:i-o,endTime:k-o}},getByteRange:function(){return{startByte:l,endByte:r}},getSequenceNumber:function(){return null},getOptions:function(){return s}});m+=h;n+=e};for(e=0;e<l;e++)i(e);return q}g.parse=a}),98);
__d("oz-player/parsers/OzSidxSegmentsContainer",["oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getSegmentByTime=function(a){var b=this.$1();for(var c=0;c<b.length;c++){var d=b[c],e=d.getTimeRange();if(e.startTime<=a&&e.endTime>a)return d}return null};b.getSegmentAfter=function(a){var b=this.$1(),c=b.findIndex(function(b){return b.getTimeRange().startTime===a.getTimeRange().startTime&&b.getTimeRange().endTime===a.getTimeRange().endTime});return c>=0&&c+1<b.length?b[c+1]:null};b.getPredictedSegmentAfter=function(a){return null};b.canPredict=function(){return!1};b.canApproximateId=function(){return!1};b.isEndingSegment=function(a){var b=this.$1();if(!b||!b.length)return!1;b=b[b.length-1].getTimeRange();a=a.getTimeRange();return b.startTime===a.startTime&&b.endTime===a.endTime};b.getSegment=function(a){return this.$1()[a]||null};b.updateWith=function(a){throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NOT_IMPLEMENTED_ERROR",description:"Not implemented: updatedWith"})};b.addUpdateListener=function(a){return this.$2.addListener("segment_updated",a)};b.getTimeRanges=function(){var a=this.$1();if(a.length===0)return[];else{var b=a[0];a=a[a.length-1];return[{startTime:b.getTimeRange().startTime,endTime:a.getTimeRange().endTime}]}};b.blockTimeRange=function(){};b.getEndingSegment=function(){var a=this.$1();return a.length>0?a[a.length-1]:null};b.getMaxGopSec=function(){return null};return a}();g["default"]=a}),98);
/**
 * License: https://www.facebook.com/legal/license/Vkd8AdLnKqZ/
 */
__d("oz-player/parsers/OzWebmSidxParser",["oz-player/manifests/OzDataSegment","oz-player/shims/OzDataViewReader","oz-player/shims/ozvariant"],(function(a,b,c,d,e,f,g){"use strict";var h=440786851,i=408125543,j=357149030,k=2807729,l=17545,m=475249515,n=187,o=179,p=183,q=241,r=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])];function s(a,b){if(!a&&!b)return!0;if(!a||!b)return!1;if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0}var t=function(){function a(a,b){this.id=a,this.$1=b}var b=a.prototype;b.getOffset=function(){return this.$1.byteOffset};b.createParser=function(){return new u(this.$1)};b.getUint=function(){if(this.$1.byteLength>8)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(this.$1.byteLength==8&&this.$1.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");var a=0;for(var b=0;b<this.$1.byteLength;b++){var c=this.$1.getUint8(b);a=256*a+c}return a};b.getFloat=function(){if(this.$1.byteLength==4)return this.$1.getFloat32(0);else if(this.$1.byteLength==8)return this.$1.getFloat64(0);else throw new RangeError("EbmlElement: floating point numbers must be 4 or 8 bytes.")};return a}(),u=function(){function a(a){this.$1=a,this.$2=new(c("oz-player/shims/OzDataViewReader"))(this.$1)}var b=a.prototype;b.hasMoreData=function(){return this.$2.hasMoreData()};b.parseElement=function(){var b=this.$3(),c=this.$4(),d;a.$5(c)?d=this.$1.byteLength-this.$2.getCursor():d=a.$6(c);c=this.$2.getCursor()+d<=this.$1.byteLength?d:this.$1.byteLength-this.$2.getCursor();d=new DataView(this.$1.buffer,this.$1.byteOffset+this.$2.getCursor(),c);this.$2.skip(c);return new t(b,d)};b.$3=function(){var a=this.$4();if(a.length>7)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");var b=0;for(var c=0;c<a.length;c++)b=256*b+a[c];return b};b.$4=function(){var a=this.$2.readUint8(),b;for(b=1;b<=8;b++){var c=1<<8-b;if(a&c)break}if(b>8)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");c=new Uint8Array(b);c[0]=a;for(a=1;a<b;a++)c[a]=this.$2.readUint8();return c};a.$6=function(a){if(a.length==8&&a[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");var b=1<<8-a.length;b=a[0]&b-1;for(var c=1;c<a.length;c++)b=256*b+a[c];return b};a.$5=function(a){for(var b=0;b<r.length;b++)if(s(a,r[b]))return!0;return!1};return a}();function v(a){a=a.createParser();var b=1e6,c=null;while(a.hasMoreData()){var d=a.parseElement();d.id==k?b=d.getUint():d.id==l&&(c=d.getFloat())}if(c==null)return null;d=b/1e9;a=c*d;return{timecodeScale:d,duration:a}}function w(a,b,d,e,f,g){a=[];b=b.createParser();var h=-1,i=-1;while(b.hasMoreData()){var j=b.parseElement();if(j.id!=n)continue;j=x(j);if(!j)continue;var k=e*j.unscaledTime;j=d+j.relativeOffset;h>=0&&(i>=0||c("oz-player/shims/ozvariant")(0,4010),a.push(new(c("oz-player/manifests/OzDataSegment"))(g,h,k,i,j-1)));h=k;i=j}if(h>=0){i>=0||c("oz-player/shims/ozvariant")(0,4010);k=f;a.push(new(c("oz-player/manifests/OzDataSegment"))(g,h,k,i,null))}return a}function x(a){a=a.createParser();var b=a.parseElement();if(b.id!=o)return null;b=b.getUint();a=a.parseElement();if(a.id!=p)return null;a=a.createParser();var c=0;while(a.hasMoreData()){var d=a.parseElement();if(d.id!=q)continue;c=d.getUint();break}return{unscaledTime:b,relativeOffset:c}}function y(a){a=a.createParser();var b=null;while(a.hasMoreData()){var c=a.parseElement();if(c.id!=j)continue;b=c;break}return!b?null:v(b)}function z(a){a=new u(a);var b=a.parseElement();if(b.id!=h)return null;b=a.parseElement();if(b.id!=i)return null;a=b.getOffset();b=y(b);return!b?null:{segmentOffset:a,timecodeScale:b.timecodeScale,duration:b.duration}}function a(a,b,c,d){d=new DataView(d.buffer);c=new DataView(c.buffer);d=z(d);if(!d)return[];c=new u(c);c=c.parseElement();return c.id!=m?[]:w(a,c,d.segmentOffset,d.timecodeScale,d.duration,b)}g.parse=a}),98);
__d("oz-player/parsers/OzSidxSegmentsParser",["oz-player/loggings/OzLoggingUtils","oz-player/manifests/OzSegmentOptions","oz-player/manifests/OzZeroTimeRangeSegment","oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter","oz-player/parsers/OzMp4SidxParser","oz-player/parsers/OzSidxSegmentsContainer","oz-player/parsers/OzWebmSidxParser","oz-player/shims/OzEventEmitter","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzURI","oz-player/utils/OzErrorEmitter","oz-player/utils/OzReadableStreamUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.split("-");return{startByte:Number.parseInt(a[0],10),endByte:Number.parseInt(a[1],10)}}a=function(){function a(a,b,d,e,f,g,h){this.$6=new(c("oz-player/utils/OzErrorEmitter"))(),this.$7=[],this.$9=new(c("oz-player/shims/OzEventEmitter"))(),this.$1=b,this.$2=new(c("oz-player/shims/OzURI"))(d),this.$3=e,this.$5=f,this.$4=g,this.$8=h.cloneContext().setType(f==="video"||f==="audio"?f+";sidx":"sidx"),this.$10=a}var b=a.prototype;b.onError=function(a){return this.$6.onError(a)};b.parseInitializationSegment=function(){var a=this,b=this.$1.Initialization[0].$.range,d=h(b),e=new(c("oz-player/manifests/OzSegmentOptions"))();return this.$10.getBool("sidx_parser_memory_optimization")?new(c("oz-player/manifests/OzZeroTimeRangeSegment"))(this.$2,d.startByte,d.endByte):{getData:function(){return null},getURI:function(){return a.$2},getTimeRange:function(){return{startTime:0,endTime:0}},getByteRange:function(){return d},getSequenceNumber:function(){return null},getOptions:function(){return e}}};b.parseSegmentsContainer=function(){var a=this,b=this.$11();d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(b,this.$8,"process_sidx");b["catch"](function(b){a.$6.emitError(b)});return new(c("oz-player/parsers/OzSidxSegmentsContainer"))(function(){return a.$7},this.$9)};b.$12=function(a,b,e){a=new(c("oz-player/manifests/OzZeroTimeRangeSegment"))(a,b.startByte,b.endByte);b=this.$5+";sidx";a=this.$4.request({debugName:"OzSidxSegmentsParser/sidx/"+this.$5,segments:[a],pipeThroughRangeStreamProviders:[c("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter")(b)],loggerProvider:this.$8,requestOptions:{networkTimeoutMs:null,retryAttempts_SIDX_USE_ONLY:this.$10.getNumber("sidx_segment_retry_attempts"),retryTimeoutMs_SIDX_USE_ONLY:this.$10.getNumber("sidx_segment_retry_interval_ms")},mediaStreamType:e});b=a.getStream().getReader();return d("oz-player/utils/OzReadableStreamUtils").pumpAllData(b)};b.$11=function(){var a=this,b=this.$1.$.indexRange,e=h(b);b=[this.$12(this.$2,e,null)];if(this.$3==="webm"){var f=h(this.$1.Initialization[0].$.range);b.push(this.$12(this.$2,f,null));f=c("oz-player/shims/OzMaybeNativePromise").all(b).then(function(b){var c=b[0];b=b[1];a.$7=d("oz-player/parsers/OzWebmSidxParser").parse(a.$10,a.$2,c,b)})}else f=b[0].then(function(b){a.$7=d("oz-player/parsers/OzMp4SidxParser").parse(a.$10,a.$2,e.startByte,b)});return f.then(function(){a.$9.emit("segment_updated")})};return a}();g["default"]=a}),98);
__d("oz-player/parsers/OzVideoContainerType",[],(function(a,b,c,d,e,f){"use strict";function a(a){return(a.split("/")[1]||"").trim()}f.parse=a}),66);
__d("oz-player/parsers/OzRepresentationParserBase",["oz-player/manifests/OzRepresentationBase","oz-player/parsers/OzSegmentTemplateParser","oz-player/parsers/OzSidxSegmentsParser","oz-player/parsers/OzVideoContainerType","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzMimeUtil"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f,g,h,i,j,k,l,m,n,o){this.$8=new(c("oz-player/utils/OzErrorEmitter"))();this.$1=b;this.$2=d;this.$9=f;this.$10=g;this.$12=e;this.$13=a;this.$14=h;this.$3=i;this.$4=j;this.$5=k;this.$6=(b=l)!=null?b:null;this.$7=(d=m)!=null?d:null;this.$15=n;this.$16=o;try{this.$10=this.$10.cloneContext().setRepresentationID(this.parseID())}catch(a){}}var b=a.prototype;b.$17=function(){var a=this,b=this.$11;if(b)return b;if(this.$1.SegmentBase){var e=this.$1.SegmentBase[0],f=this.$1.BaseURL[0]._;if(typeof f!=="string")throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_REPRESENTATION_PARSER",description:"Missing representation BaseURL",extra:{code:"OZ_RP-9"}});b=new(c("oz-player/parsers/OzSidxSegmentsParser"))(this.$13,e,f,d("oz-player/parsers/OzVideoContainerType").parse(this.$1.$.mimeType),d("oz-player/utils/OzMimeUtil").getMimeType(this.$1.$.mimeType),this.$9,this.$10);b.onError(function(b){var c;if((c=a.$16)==null?void 0:c.handleError(a.parseID(),b))return;return a.$8.emitError(b)})}else if(this.$1.SegmentTemplate)b=this.$18(this.$1.SegmentTemplate[0],{isShared:!1});else if(this.$3)b=this.$18(this.$3[0],{isShared:!0});else throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_REPRESENTATION_PARSER",description:"Unrecognized representation type",extra:{code:"OZ_RP-7"}});this.$11=b;return b};b.$18=function(a,b){var e;a=a;b.isShared&&(a=babelHelpers["extends"]({},a,{$:babelHelpers["extends"]({},a.$,{initialization:a.$.initialization.replace("$RepresentationID$",this.$1.$.id),media:a.$.media.replace("$RepresentationID$",this.$1.$.id)})}));b=this.$12.mpdUrl;var f=this.$1.BaseURL&&this.$1.BaseURL[0]?this.$1.BaseURL[0]._:null;f=f!=null?f:b;if(f==null)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_REPRESENTATION_PARSER",description:"Missing mpd url for template manifest",extra:{code:"OZ_RP-6"}});var g=this.$12.customSegmentTimelineParser;e=(e=this.$12.customRepresentationParsers)==null?void 0:e.initializationBinary;e=e?e(this.$1):null;return new(c("oz-player/parsers/OzSegmentTemplateParser"))(this.$13,a,{baseUrl:f,mpdUrl:b,isStaticMpd:this.$14.manifestType==="static",isTemplatedMpd:this.$14.manifestIsTemplated},g,e)};b.onError=function(a){return this.$8.onError(a)};b.parseInitSegment=function(){return this.$17().parseInitializationSegment()};b.parseBandwidth=function(){return Number(this.$1.$.bandwidth)};b.parseMimeType=function(){var a;return(a=(a=this.$1.$.mimeType)!=null?a:this.$4)!=null?a:""};b.parseCodecs=function(){var a;return(a=(a=this.$1.$.codecs)!=null?a:this.$5)!=null?a:""};b.parseLang=function(){return this.$6};b.parseRole=function(){return this.$7};b.parseSegmentsContainer=function(){return this.$17().parseSegmentsContainer()};b.parseID=function(){return""+this.$1.$.id};b.parseCustomFieldFirstSegment=function(){var a=this.$12.customRepresentationParsers?this.$12.customRepresentationParsers.firstSegmentParser:null;return a?a(this.$1):null};b.parse=function(){return new(c("oz-player/manifests/OzRepresentationBase"))(this.$1,this.$2,this.parseID(),this.parseMimeType(),this.parseCodecs(),this.parseLang(),this.parseRole(),this.parseInitSegment(),this.parseSegmentsContainer(),this.parseBandwidth(),this.parseCustomFieldFirstSegment(),this.$12.customRepresentationParsers)};return a}();g["default"]=a}),98);
__d("oz-player/parsers/OzApplicationRepresentationParser",["oz-player/manifests/OzApplicationRepresentation","oz-player/parsers/OzRepresentationParserBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k,l,m,n){b=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m,n)||this;b.$OzApplicationRepresentationParser$p_1=c;b.$OzApplicationRepresentationParser$p_3=e;return b}var d=b.prototype;d.parse=function(){var a=this.$OzApplicationRepresentationParser$p_3.customRepresentationParsers;return new(c("oz-player/manifests/OzApplicationRepresentation"))(this.$OzApplicationRepresentationParser$p_1,this.$OzApplicationRepresentationParser$p_2,this.parseID(),this.parseMimeType(),this.parseCodecs(),this.parseLang(),this.parseRole(),this.parseInitSegment(),this.parseSegmentsContainer(),this.parseBandwidth(),this.parseCustomFieldFirstSegment(),a)};return b}(c("oz-player/parsers/OzRepresentationParserBase"));g["default"]=a}),98);
__d("oz-player/manifests/OzAudioRepresentation",["oz-player/manifests/OzRepresentationBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k,l,m){b=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m)||this;b.$OzAudioRepresentation$p_1=d;b.$OzAudioRepresentation$p_2=k;b.$OzAudioRepresentation$p_3={id:d,displayLabel:b.getDisplayLabel(),lang:g,role:h};return b}var c=b.prototype;c.getBitrateKbps=function(){var a=1024;return(this.$OzAudioRepresentation$p_2/a).toFixed(1)+"Kbps"};c.getDisplayLabel=function(){var b=a.prototype.getLang.call(this),c=a.prototype.getRole.call(this);b=b==null?"Default":b;return c==null?b:b+" - "+c};c.getAudioTrack=function(){return this.$OzAudioRepresentation$p_3};return b}(c("oz-player/manifests/OzRepresentationBase"));g["default"]=a}),98);
__d("oz-player/parsers/OzAudioRepresentationParser",["oz-player/manifests/OzAudioRepresentation","oz-player/parsers/OzRepresentationParserBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k,l,m,n){b=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m,n)||this;b.$OzAudioRepresentationParser$p_1=c;b.$OzAudioRepresentationParser$p_3=e;return b}var d=b.prototype;d.parse=function(){var a=this.$OzAudioRepresentationParser$p_3.customRepresentationParsers;return new(c("oz-player/manifests/OzAudioRepresentation"))(this.$OzAudioRepresentationParser$p_1,this.$OzAudioRepresentationParser$p_2,this.parseID(),this.parseMimeType(),this.parseCodecs(),this.parseLang(),this.parseRole(),this.parseInitSegment(),this.parseSegmentsContainer(),this.parseBandwidth(),this.parseCustomFieldFirstSegment(),a)};return b}(c("oz-player/parsers/OzRepresentationParserBase"));g["default"]=a}),98);
__d("oz-player/parsers/OzVideoRepresentationParser",["oz-player/manifests/OzVideoRepresentation","oz-player/parsers/OzRepresentationParserBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o){b=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m,n,o)||this;b.$OzVideoRepresentationParser$p_1=c;b.$OzVideoRepresentationParser$p_2=d;b.$OzVideoRepresentationParser$p_3=e;return b}var d=b.prototype;d.parse=function(){var a=Number.parseInt(this.$OzVideoRepresentationParser$p_1.$.height,10),b=Number.parseInt(this.$OzVideoRepresentationParser$p_1.$.width,10),d=this.$OzVideoRepresentationParser$p_3.customRepresentationParsers;return new(c("oz-player/manifests/OzVideoRepresentation"))(this.$OzVideoRepresentationParser$p_1,this.$OzVideoRepresentationParser$p_2,this.parseID(),this.parseMimeType(),this.parseCodecs(),this.parseLang(),this.parseRole(),this.parseInitSegment(),this.parseSegmentsContainer(),this.parseBandwidth(),this.parseCustomFieldFirstSegment(),d,b,a)};return b}(c("oz-player/parsers/OzRepresentationParserBase"));g["default"]=a}),98);
__d("oz-player/utils/OzIbrUtils",["oz-player/networks/OzBandwidthEstimator"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,d){var e=c("oz-player/networks/OzBandwidthEstimator").getAdjustedBandwidth(b.getLegacyConfig());a=a.slice(0);a.sort(function(a,b){return a.getBandwidth()-b.getBandwidth()});b=b.getNumber("live_audio_ibr_bandwidth_percentage");b=e*b;for(var f=a.length-1;f>=0;f--)if(a[f].getBandwidth()<=b){d.getOperationLogger("audio_ibr_success").setRepresentationID(a[f].getID()).setReason(e.toString()).log();return a[f]}d.getOperationLogger("audio_ibr_no_op").setReason(e.toString()).log();return null};g.getInitialAudioRepresentation=a}),98);
__d("oz-player/parsers/OzMpdParser",["oz-player/manifests/Mpd","oz-player/parsers/OzApplicationRepresentationParser","oz-player/parsers/OzAudioRepresentationParser","oz-player/parsers/OzVideoRepresentationParser","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzIbrUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.blockedRepresentationsManager,d=a.config,e=a.drmManager,f=a.enableAlternativeAudioTracks,g=a.initialRepresentationIDs,h=a.networkManager,i=a.ozParserContext;a=a.perfLoggerProvider;this.$2=new(c("oz-player/utils/OzErrorEmitter"))();this.$5=d;this.$1=h;this.$3=a;this.$4=i;this.$6=e;this.$7=(d=g)!=null?d:[];this.$8=(h=b)!=null?h:null;this.$9=f;this.$10=!0}var b=a.prototype;b.onError=function(a){return this.$2.onError(a)};b.parse=function(a){var b=this,e=[];a=a;var f=this.$4.createXmlParser().parse(a);f=f.MPD&&f.MPD.length>0?f.MPD[0]:null;if(!f){var g=2e3;throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_MPD_PARSER",description:"parsed manifest XML missing MPD node; truncated xml ("+Math.min(g,a.length)+"/"+a.length+"): "+a.substring(0,g)})}g=f.Period&&f.Period.length>0?f.Period[0]:null;if(!g){var h=2e3;throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_MPD_PARSER",description:"parsed manifest XML missing Period node; truncated xml ("+Math.min(h,a.length)+"/"+a.length+"): "+a.substring(0,h)})}a=g.AdaptationSet||[];h=this.$11(f);this.$10=h==="static";g=this.$12(f);var i=this.$13(this.$14(a,"video"),{manifestType:h,manifestIsTemplated:g},e),j;this.$9?j=this.$15(this.$14(a,"audio"),{manifestType:h,manifestIsTemplated:g},e).sort(function(a,b){return a.getBandwidth()-b.getBandwidth()}):j=this.$16(this.$17(a,"audio"),c("oz-player/parsers/OzAudioRepresentationParser"),{manifestType:h,manifestIsTemplated:g},e).sort(function(a,b){return a.getBandwidth()-b.getBandwidth()});var k=[];if(this.$5.getBool("vtt_caption_representation")){a=this.$14(a,"application");k=this.$16(a[0],c("oz-player/parsers/OzApplicationRepresentationParser"),{manifestType:h,manifestIsTemplated:g},e)}a=this.$4.mpdUrl;h=new(c("oz-player/manifests/Mpd"))(f,i,j,k,a,this.$18(f),this.$4.customParsers||new Map(),this.$10);if(this.$6){g=this.$6;g.startEME(i,j)}e.forEach(function(a){a.onError(b.$2.emitError)});return h};b.$18=function(a){a=a.$.minimumUpdatePeriod||"";a=/\d+/g.exec(a);if(a&&a.length){a=a[0];return a?Number.parseInt(a,10):null}return null};b.$11=function(a){return a.$.type||"static"};b.$12=function(a){var b;b=(b=this.$4.customParsers)==null?void 0:b.get("isLiveTemplated");if(!b)return!1;b=b(a);return typeof b==="boolean"&&b};b.$17=function(a,b){return a.find(this.$19(b))};b.$14=function(a,b){return a.filter(this.$19(b))};b.$19=function(a){return function(b){if(b.$.mimeType!=null)return b.$.mimeType.indexOf(a)!==-1;b=b.Representation;return b&&b.length>0&&b[0].$.mimeType.indexOf(a)!==-1}};b.$16=function(a,b,c,d){var e=this;if(!a)return[];var f=a.Role;f=(f=f)!=null?f:[];f=f[0];var g=f?f.$.value:null;f=a.$.lang;var h=f==="und"?null:f;return a.Representation.map(function(f){f=new b(e.$5,f,(f=f.ContentProtection)!=null?f:a.ContentProtection,e.$4,e.$1,e.$3,c,a.SegmentTemplate,a.$.mimeType,a.$.codecs,h,g,e.$7,e.$8);var i=f.parse();d.push(f);return i})};b.$13=function(a,b,d){var e=this,f=[],g=new Set();a.filter(Boolean).forEach(function(a,h,i){h=h===i.length-1;for(var i=a.Representation,j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l,m;if(j){if(k>=i.length)break;m=i[k++]}else{k=i.next();if(k.done)break;m=k.value}m=m;if(((l=m.$.FBAbrPolicyTags)==null?void 0:l.includes("avoid_on_abr"))&&!h)continue;l=a.Role;l=(l=l)!=null?l:[];l=l[0];l=l?l.$.value:null;var n=a.$.lang;n=n==="und"?null:n;m=new(c("oz-player/parsers/OzVideoRepresentationParser"))(e.$5,m,(m=m.ContentProtection)!=null?m:a.ContentProtection,e.$4,e.$1,e.$3,b,a.SegmentTemplate,a.$.mimeType,a.$.codecs,n,l,e.$7,e.$8);n=m.parse();d.push(m);if(!MediaSource.isTypeSupported(n.getMimeCodecs())){g.add(n.getMimeCodecs());continue}f.push(n)}});return f.filter(Boolean)};b.$15=function(a,b,e){var f=this,g=[],h=new Set();a=a.filter(Boolean).map(function(a){var d=a.Role;d=(d=d)!=null?d:[];d=d[0];d=d?d.$.value:null;var g=a.$.lang;g=g==="und"?null:g;var i=[];for(var j=a.Representation,k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;m=new(c("oz-player/parsers/OzAudioRepresentationParser"))(f.$5,m,(m=m.ContentProtection)!=null?m:a.ContentProtection,f.$4,f.$1,f.$3,b,a.SegmentTemplate,a.$.mimeType,a.$.codecs,g,d,f.$7);var n=m.parse();e.push(m);if(!MediaSource.isTypeSupported(n.getMimeCodecs())){h.add(n.getMimeCodecs());continue}i.push(n)}return i});a.forEach(function(a){if(a.length>1){var b=d("oz-player/utils/OzIbrUtils").getInitialAudioRepresentation(a,f.$5,f.$3);g.push((b=b)!=null?b:a[0])}else g.push.apply(g,a)});return g.filter(Boolean)};return a}();g["default"]=a}),98);
__d("oz-player/utils/OzMpdUtils",[],(function(a,b,c,d,e,f){"use strict";function g(a){var b=null;a.forEach(function(a){if(a){var c=a.endTime;c<((c=(c=b)==null?void 0:c.endTime)!=null?c:Infinity)&&(b=a)}});return b}function a(a,b){b=[];b.push.apply(b,a.getVideoRepresentations().concat(a.getAudioRepresentations()));if(b.length){a=b.map(function(a){a=a.getEndingSegment();return a?a.getTimeRange():null});return g(a)}return null}function b(a){var b=[];b.push.apply(b,a.getVideoRepresentations().concat(a.getAudioRepresentations()));if(b.length){a=b[0].getEndingSegment();if(a)return a.getSequenceNumber()}return null}f.getLeastEndTimeTimeRange=g;f.getMpdLastTimeRange=a;f.getMpdLastSequenceNumber=b}),66);
__d("oz-player/utils/OzStreamInterruptChecker",["oz-player/shims/OzEventEmitter","oz-player/utils/OzMpdUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this)||this;d.$OzStreamInterruptChecker$p_4=0;d.$OzStreamInterruptChecker$p_5=null;d.$OzStreamInterruptChecker$p_6=!1;d.$OzStreamInterruptChecker$p_2=b;d.$OzStreamInterruptChecker$p_3=c;d.$OzStreamInterruptChecker$p_1=d.$OzStreamInterruptChecker$p_3.getNumber("live_numerical_error_epsilon");return d}var c=b.prototype;c.notifyMpdUpdated=function(){var a=d("oz-player/utils/OzMpdUtils").getMpdLastTimeRange(this.$OzStreamInterruptChecker$p_2,this.$OzStreamInterruptChecker$p_3),b=a?a.endTime:null,c=!1;b!==null&&(c=b===this.$OzStreamInterruptChecker$p_5);c?this.$OzStreamInterruptChecker$p_4++:(this.$OzStreamInterruptChecker$p_4=0,this.$OzStreamInterruptChecker$p_6&&this.$OzStreamInterruptChecker$p_5!==null&&this.$OzStreamInterruptChecker$p_5!==void 0&&a!==null&&a!==void 0&&this.emit("streamResumedAt",a.startTime),this.$OzStreamInterruptChecker$p_6=!1);c=this.$OzStreamInterruptChecker$p_3.getNumber("stream_interrupt_check_mpd_stale_count_threshold");!this.$OzStreamInterruptChecker$p_6&&c>0&&this.$OzStreamInterruptChecker$p_4>=c&&b!==null&&b!==void 0&&(this.emit("streamInterruptAt",b),this.$OzStreamInterruptChecker$p_6=!0);this.$OzStreamInterruptChecker$p_5=b};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/parsers/OzMpdUpdater",["oz-player/parsers/OzMpdParser","oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/OzURI","oz-player/shims/ozClearTimeout","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzMpdUtils","oz-player/utils/OzReadableStreamUtils","oz-player/utils/OzStreamInterruptChecker"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e,f,g,h,i,j,k){var l;l=a.call(this)||this;l.$OzMpdUpdater$p_8=new(c("oz-player/utils/OzErrorEmitter"))();l.$OzMpdUpdater$p_10=new(c("oz-player/shims/OzSubscriptionsHandler"))();l.$OzMpdUpdater$p_11=!1;l.$OzMpdUpdater$p_16=0;l.$OzMpdUpdater$p_18=0;l.$OzMpdUpdater$p_19=null;l.$OzMpdUpdater$p_21=!0;l.$OzMpdUpdater$p_22=0;l.$OzMpdUpdater$p_25=function(){var a,b=l.$OzMpdUpdater$p_2.getLocation();l.$OzMpdUpdater$p_21=!1;if(b==null||b==="")return;var e=new(c("oz-player/shims/OzURI"))(b),f=String((a=(a=e.getQueryData().ms)!=null?a:e.getQueryData().msdev)!=null?a:e.getQueryData().mstest);if(!l.$OzMpdUpdater$p_12.isPlaying()){l.setupUpdateLoop();return}var g=l.$OzMpdUpdater$p_5.getOperationLogger("update_manifest").start();l.$OzMpdUpdater$p_27(b).then(function(a){var e,h;l.$OzMpdUpdater$p_18=0;l.$OzMpdUpdater$p_28();l.$OzMpdUpdater$p_7=0;if(l.$OzMpdUpdater$p_21)return;var i=babelHelpers["extends"]({},l.$OzMpdUpdater$p_13,{mpdUrl:b});i=new(c("oz-player/parsers/OzMpdParser"))({config:l.$OzMpdUpdater$p_6,ozParserContext:i,networkManager:l.$OzMpdUpdater$p_1,perfLoggerProvider:l.$OzMpdUpdater$p_5,drmManager:l.$OzMpdUpdater$p_14,initialRepresentationIDs:[],blockedRepresentationsManager:null,enableAlternativeAudioTracks:!1});i.onError(function(a){l.$OzMpdUpdater$p_8.emitError(a),g.setError(a).log()});i=i.parse(a);a=l.$OzMpdUpdater$p_2.isStaticMpd();l.$OzMpdUpdater$p_2.updateWith(i);l.$OzMpdUpdater$p_2.markRefreshed();i.isStaticMpd()&&!a&&l.emit("streamTransitionToStatic");i=d("oz-player/utils/OzMpdUtils").getMpdLastTimeRange(l.$OzMpdUpdater$p_2,l.$OzMpdUpdater$p_6);a=i&&i.endTime!=0?i.endTime:null;i=String((i=(i=l.$OzMpdUpdater$p_2)==null?void 0:i.getCustomField("currentServerTimeMs"))!=null?i:"");e=String((e=(e=l.$OzMpdUpdater$p_2)==null?void 0:e.getCustomField("lastVideoFrameTs"))!=null?e:"");i={currentServerTimeMs:i,ingestLastVideoFrameTs:e,nowMs:String(Date.now())};e=new Set(((e=(e=l.$OzMpdUpdater$p_2)==null?void 0:e.getVideoRepresentations())!=null?e:[]).map(function(a){return a.getCodecs()})).size>1;h=new Set(((h=(h=l.$OzMpdUpdater$p_2)==null?void 0:h.getAudioRepresentations())!=null?h:[]).map(function(a){return a.getCodecs()})).size>1;g.setLiveheadPosition(a).setLiveheadSeqNumMpd(d("oz-player/utils/OzMpdUtils").getMpdLastSequenceNumber(l.$OzMpdUpdater$p_2)).setManifestType(l.$OzMpdUpdater$p_2.isStaticMpd()?"static":"dynamic").setIsMixedCodecManifest(e||h).setIsTemplatedManifest(Boolean(l.$OzMpdUpdater$p_2.getCustomField("isLiveTemplated"))).setPlaybackFbmsParam(f).setUserInfo(i).log();l.$OzMpdUpdater$p_9.notifyMpdUpdated();l.setupUpdateLoop()})["catch"](function(a){l.$OzMpdUpdater$p_28();g.setError(a).log();var c=null;if(d("oz-player/utils/OzErrorUtils").isOzError(a))c=a;else{var e,f=null,h="Caught an unknown error when fetching the manifest.";if(a!=null)if(l.$OzMpdUpdater$p_6.getBool("normalize_mpd_fetch_errors")){var i=d("oz-player/utils/OzErrorUtils").getNormalizedErrorAndCode(a),j=i[0];i[1];c=j}else e=a,f=e.code!=null?String(e.code):null,h=e.name+"; "+e.message+"; "+e.description+";";if(c==null){i={originalError:e,url:b};f!==null&&(i.code=f);c=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NETWORK",description:h,extra:i})}}l.$OzMpdUpdater$p_26(c,b)})};var m=e.getMinimumUpdatePeriod();l.$OzMpdUpdater$p_7=0;l.$OzMpdUpdater$p_1=f;l.$OzMpdUpdater$p_2=e;l.$OzMpdUpdater$p_12=g;l.$OzMpdUpdater$p_3=m;l.$OzMpdUpdater$p_5=h.cloneContext().setType("manifest");l.$OzMpdUpdater$p_6=b;l.$OzMpdUpdater$p_13=i;l.$OzMpdUpdater$p_14=j;l.$OzMpdUpdater$p_15=k;l.$OzMpdUpdater$p_2.addListener("locationUpdated",function(){l.$OzMpdUpdater$p_23(),l.setupUpdateLoop()});l.$OzMpdUpdater$p_9=new(c("oz-player/utils/OzStreamInterruptChecker"))(l.$OzMpdUpdater$p_2,l.$OzMpdUpdater$p_6);l.$OzMpdUpdater$p_10.addSubscriptions(l.$OzMpdUpdater$p_9.addListener("streamResumedAt",function(a){l.emit("streamResumedAt",a)}),l.$OzMpdUpdater$p_9.addListener("streamInterruptAt",function(a){l.emit("streamInterruptAt",a)}));return l}var e=b.prototype;e.$OzMpdUpdater$p_23=function(){c("oz-player/shims/ozClearTimeout")(this.$OzMpdUpdater$p_4),this.$OzMpdUpdater$p_4=null,this.$OzMpdUpdater$p_24(),this.$OzMpdUpdater$p_21=!0};e.setupUpdateLoop=function(){var a,b=!this.$OzMpdUpdater$p_11;b&&(b=!this.$OzMpdUpdater$p_2.isStaticMpd(),this.$OzMpdUpdater$p_3=this.$OzMpdUpdater$p_2.getMinimumUpdatePeriod());a=this.$OzMpdUpdater$p_17==null&&this.$OzMpdUpdater$p_6.getNumber("manifest_initial_update_delay_ms")>0?this.$OzMpdUpdater$p_6.getNumber("manifest_initial_update_delay_ms"):this.$OzMpdUpdater$p_6.getNumber("manifest_update_frequency_ms")||((a=this.$OzMpdUpdater$p_3)!=null?a:0)*1e3;b&&a&&this.$OzMpdUpdater$p_2.getLocation()&&(this.$OzMpdUpdater$p_4=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(this.$OzMpdUpdater$p_25,a))};e.onError=function(a){return this.$OzMpdUpdater$p_8.onError(a)};e.$OzMpdUpdater$p_26=function(a,b){var c=this;b=!0;var d=this.$OzMpdUpdater$p_18-1,e=a.getExtra().code;this.$OzMpdUpdater$p_19!==e?(this.$OzMpdUpdater$p_19=e,this.$OzMpdUpdater$p_16=1):this.$OzMpdUpdater$p_16++;var f=function(){b=!1};e={endStream:function(){f(),c.$OzMpdUpdater$p_11=!0,c.emit("streamGone")},consecutiveFailuresForErrorCode:this.$OzMpdUpdater$p_16,error:a,isInitialRequest:!1,retry:function(b){c.emit("manifestFetchErrorRetry",a),f(),c.setupUpdateLoop()},retryAttemptCount:d};this.emit("manifestFetchError",e);b&&this.$OzMpdUpdater$p_8.emitError(a)};e.$OzMpdUpdater$p_29=function(a,b){a=new(c("oz-player/shims/OzURI"))(a);a.addQueryData("_nc_expid",b);return a.toString()};e.$OzMpdUpdater$p_30=function(a){if(!this.$OzMpdUpdater$p_15)return a;a=new(c("oz-player/shims/OzURI"))(a);a.addQueryData("_nc_tsid","mpd-"+this.$OzMpdUpdater$p_22++);return a.toString()};e.$OzMpdUpdater$p_27=function(a){this.$OzMpdUpdater$p_24();this.$OzMpdUpdater$p_18++;var b=this.$OzMpdUpdater$p_6.getString("cdn_experiment_id");a=b.length===0?a:this.$OzMpdUpdater$p_29(a,b);a=this.$OzMpdUpdater$p_30(a);b=this.$OzMpdUpdater$p_1.requestRawUrl({debugName:"OzMpdUpdater/requestMpd/mpd",url:a,options:{networkTimeoutMs:this.$OzMpdUpdater$p_6.getNumber("mpd_updater_network_request_timeout_ms")},loggerProvider:this.$OzMpdUpdater$p_5});this.$OzMpdUpdater$p_17=Date.now();this.$OzMpdUpdater$p_20=b;a=b.getStream().getReader();return d("oz-player/utils/OzReadableStreamUtils").pumpString(a)};e.$OzMpdUpdater$p_24=function(){this.$OzMpdUpdater$p_20&&(this.$OzMpdUpdater$p_20.cancel(),this.$OzMpdUpdater$p_18=0),this.$OzMpdUpdater$p_28()};e.$OzMpdUpdater$p_28=function(){this.$OzMpdUpdater$p_20=null};e.destroy=function(){this.$OzMpdUpdater$p_4&&c("oz-player/shims/ozClearTimeout")(this.$OzMpdUpdater$p_4),this.$OzMpdUpdater$p_10.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/shims/www/OzXmlParserTrustedTypesHTMLPolicyWWW",["TrustedTypes","err"],(function(a,b,c,d,e,f,g){"use strict";b={createHTML:function(a){if(a.startsWith('<?xml version="1.0"?>\n<')||a.startsWith('<?xml version="1.0" encoding="UTF-8"?>\n<')||a.startsWith('\n<MPD xmlns="urn:mpeg:dash:schema:mpd:2011"'))return a;throw c("err")("Violating Trusted Type policies. Only works for XML.")}};var h=c("TrustedTypes").createPolicy("oz-player-xml",b);function a(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.createHTML.apply(h,[a].concat(c))}g.createTrustedHTMLForDOMParser=a}),98);
__d("oz-player/shims/OzXmlParserTrustedTypesHTMLPolicy",["oz-player/shims/www/OzXmlParserTrustedTypesHTMLPolicyWWW"],(function(a,b,c,d,e,f,g){"use strict";g.createTrustedHTMLForDOMParser=d("oz-player/shims/www/OzXmlParserTrustedTypesHTMLPolicyWWW").createTrustedHTMLForDOMParser}),98);
__d("oz-player/parsers/OzXmlParserImplDOMParser",["oz-player/shims/OzXmlParserTrustedTypesHTMLPolicy","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){function h(){return{$:{}}}function i(a){var b=h();for(var c=a.attributes,d=0;d<c.length;++d){var e=c[d];b.$[e.name]=e.value}for(e=a.childNodes,c=0;c<e.length;++c){d=e[c];if(d instanceof Element){a=d.nodeName;Object.prototype.hasOwnProperty.call(b,a)||(b[a]=[]);b[a].push(i(d))}else{a=d.nodeValue.trim();a&&(b._=a)}}return b}a=function(){function a(){this.$1=new DOMParser()}var b=a.prototype;b.parse=function(a){try{var b=h(),c=d("oz-player/shims/OzXmlParserTrustedTypesHTMLPolicy").createTrustedHTMLForDOMParser(a);c=this.$1.parseFromString(c,"application/xml");var e=c.querySelector("parsererror");if(e){var f=e.querySelector("h3");f=f?f.nextElementSibling:null;f=f?f.innerHTML:e.innerHTML;e=2e3;throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_XML_PARSER",description:"DOMParser parsererror: "+String(f).trim()+"; truncated xml ("+Math.min(e,a.length)+"/"+a.length+"): "+a.substring(0,e),extra:{}})}f=c.documentElement;f!=null&&(b[f.nodeName]=[i(f)]);return b}catch(b){if(d("oz-player/utils/OzErrorUtils").isOzError(b))throw b;else{e=2e3;throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_XML_PARSER",description:"XML parse exception: "+String(b)+"; truncated xml ("+Math.min(e,a.length)+"/"+a.length+"): "+a.substring(0,e),extra:{originalError:b}})}}};return a}();g["default"]=a}),98);
__d("oz-player/playback_controls/OzClearSourceBufferOnSeekManager",["oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e){e===void 0&&(e=null),this.$3=new(c("oz-player/utils/OzErrorEmitter"))(),this.$4=new Map(),this.$5=!1,this.$6=!1,this.$7=!1,this.$8=null,this.$9=[],this.$10=null,this.$11=null,this.$1=a,this.$2=b,this.$4=d,this.$11=e}var b=a.prototype;b.$12=function(a){var b;this.$5=!0;return(b=this.$8)!=null?b:a.call(this.$1)};b.$13=function(a,b){this.$6=!0,this.$9.push({t:b}),this.$8=b,this.$9.length===1&&this.$14(a)};b.$15=function(a){this.$7=!0;return this.$8!=null?!0:a.call(this.$1)};b.$16=function(a,b){var d=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),e=[];this.$4.forEach(function(c,d){d=c.clearSourceBufferRange(a,b);e.push(d)});var f=c("oz-player/shims/OzMaybeNativePromise").all(e);f.then(function(){d.resolve()})["catch"](function(a){d.reject(a)});return d.getPromise()};b.$14=function(a){var b=this,e=this.$9.length>0?this.$9[0]:null,f=this.$2.getNumber("clear_buffer_on_seek_epsilon_s");if(e){var g=e.t;e=this.$1.buffered;var h=e.length,i=e.length<=0,j=-1,k=!1;for(var l=0;j<0&&l<h;++l)j=g-f>=e.start(l)&&g+f<e.end(l)?l:j,k=g<e.start(l)-f;l=j>-1;var m=this.$2.getNumber("clear_buffer_on_seek_nudge_s");l&&j>=0&&j<h&&m>0&&(g=Math.min(g,e.end(j)-m),g=Math.max(g,e.start(j)+m));if(i||l||!k)this.$11&&this.$11.getOperationLogger("seek_to_next_time").setLength(Math.round(g*1e3)).setInitiator("no_clear").log(),a.call(this.$1,g),this.$9.shift(),this.$14(a);else{var n=null;this.$11&&(n=this.$11.getOperationLogger("clear_buffer_before_seek").setLength(Math.round(g*1e3)).setUserInfo({bufferRangesLength:String(h),nudgeSec:String(m)}).start());j=this.$16(Math.max(g-f,0),e.end(h-1)+f);j.then(function(){n&&n.log(),b.$11&&b.$11.getOperationLogger("seek_to_next_time").setLength(Math.round(g*1e3)).setInitiator("after_clear").log(),a.call(b.$1,g),b.$9.shift(),b.$14(a)})["catch"](function(a){n&&n.setError(a).log(),b.$3.emitError(d("oz-player/utils/OzErrorUtils").isOzError(a)?a:d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SOURCE_BUFFER",description:a?a.name+": "+a.message:"Unknown error while clearing the buffer.",extra:{code:c("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_MANAGER_CLEAR_RANGE_FAILED,originalError:a}}))})}}else this.$8=null};b.maybeOverwriteVideoCurrentTimeProperty=function(){var a,b,c=this,d=Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(this.$1,"currentTime");d=(a=d)!=null?a:Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"currentTime");a=Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(this.$1,"seeking");a=(b=a)!=null?b:Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"seeking");var e=d&&typeof d.get==="function"?d.get:null,f=d&&typeof d.set==="function"?d.set:null,g=a&&typeof a.get==="function"?a.get:null;if(e&&f&&g&&Object.defineProperty){try{Object.defineProperty(this.$1,"currentTime",{get:function(){return c.$12(e)},set:function(a){c.$13(f,a)},configurable:!0,enumerable:!0});Object.defineProperty(this.$1,"seeking",{get:function(){return c.$15(g)},configurable:!0,enumerable:!0});b=this.$1.currentTime;this.$1.currentTime=b;this.$1.seeking}catch(a){}this.$17(function(){c.getCurrentTimePropertyOverwriteSuccess()&&Object.defineProperty(c.$1,"currentTime",{get:e,set:f,configurable:!0,enumerable:!0}),c.getSeekingPropertyOverwriteSuccess()&&Object.defineProperty(c.$1,"seeking",{get:g,configurable:!0,enumerable:!0})})}};b.getCurrentTimePropertyOverwriteSuccess=function(){return this.$5&&this.$6};b.getSeekingPropertyOverwriteSuccess=function(){return this.$7};b.$17=function(a){this.$10=a};b.onError=function(a){return this.$3.onError(a)};b.destroy=function(){try{this.$10&&this.$10()}catch(a){}};return a}();g["default"]=a}),98);
__d("oz-player/playback_controls/OzSteadyStateManager",["oz-player/shims/ozvariant"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=[],this.$2=a,this.$3=b}var b=a.prototype;b.addSample=function(a){var b,c=Math.floor(Date.now()/(1e3*this.$3)),d=c%this.$2;((b=this.$1[d])==null?void 0:b.bucketNumber)!=c&&(this.$1[d]={bucketNumber:0,val:null});this.$1[d]={bucketNumber:c,val:Math.min(a,(b=this.$1[d].val)!=null?b:a)}};b.min=function(){var a=this,b=Date.now(),d=this.$1.filter(function(c){return c!=null&&c.val!=null&&b-a.$2*1e3*a.$3<c.bucketNumber*1e3*a.$3});if(d.length<this.$2)return null;d=d.reduce(function(a,b){if(a==null)return b;var d=b.val;d!=null||c("oz-player/shims/ozvariant")(0,56011);var e=a.val;e!=null||c("oz-player/shims/ozvariant")(0,56011);return d<e?b:a},null);return d==null?void 0:d.val};b.reset=function(){this.$1=[]};return a}();g["default"]=a}),98);
__d("oz-player/playback_controls/OzLiveLatencyManager",["oz-player/playback_controls/OzSteadyStateManager","oz-player/shims/OzDOMEventListener","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozThrottle","oz-player/utils/OzSourceBufferUtil"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.$8=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$9=null;this.$10=!1;this.$11=null;this.$12=null;this.$13=null;this.$14=!0;var d=a.config,e=a.mpd,f=a.playbackState,g=a.bufferingDetector,h=a.video,i=a.loggerProvider;a=a.getUserSelectedPlaybackRate;this.$1=d;this.$2=e;this.$3=f;this.$15=a;d.getNumber("steadystate_minbuffer_buckets")>0&&(this.$7=new(c("oz-player/playback_controls/OzSteadyStateManager"))(this.$1.getNumber("steadystate_minbuffer_buckets"),this.$1.getNumber("steadystate_minbuffer_buckets_sec")));g!=null&&(this.$8.addSubscriptions(g.addListener("enterBuffering",function(a){if(a==="in_play"){b.$9=0;(a=b.$7)==null?void 0:a.reset()}b.$10=!1;(a=b.$6)==null?void 0:a.log();b.$6=null})),this.$8.addSubscriptions(g.addListener("leaveBuffering",function(){b.$9===0&&(b.$9=Date.now()),b.$10=!1})));this.$4=h;this.$5=i;if(this.$16()){this.$8.addSubscriptions((e=c("oz-player/shims/OzDOMEventListener")).listenDOMEvent(this.$4,"timeupdate",c("oz-player/shims/ozThrottle")(function(){b.$17(),b.$18()},this.$1.getNumber("playhead_manager_timeupdate_throttle_ms"))),e.listenDOMEvent(this.$4,"waiting",function(){b.$17()}),e.listenDOMEvent(this.$4,"durationchange",function(){b.$17()}),e.listenDOMEvent(this.$4,"seeking",function(){var a;b.$13=Date.now();b.$11=null;(a=b.$7)==null?void 0:a.reset()}),e.listenDOMEvent(this.$4,"playing",function(){b.$13=Date.now(),b.$11=null}),e.listenDOMEvent(h,"pause",function(){var a;return(a=b.$7)==null?void 0:a.reset()}))}}var b=a.prototype;b.enabled=function(){var a=this.$1.getNumber("catchup_timeout_after_buffering_sec");return a===0||this.$9==null||this.$9!==0&&this.$9+a*1e3<=Date.now()};b.isBehindPreferredLiveHeadLatencyWithTolerance=function(){return this.$3.getCurrentTime()<this.getInitialPlayHeadPosition()-this.getPreferredLiveHeadLatencyToleranceSec()};b.$19=function(){return this.$3.getCurrentTime()<this.getInitialPlayHeadPosition()};b.$20=function(){var a;a=(a=this.$7)==null?void 0:a.min();return!this.$21()&&a!=null&&a>this.$1.getNumber("steadystate_minbuffer_sec")};b.getInitialPlayHeadPosition=function(){return this.getLiveHeadTimeSec()-this.getPreferredLiveHeadLatencySec()};b.getLiveHeadTimeSec=function(){var a=this.$22();return(a==null?void 0:(a=a.getEndingSegment())==null?void 0:a.getTimeRange().endTime)||0};b.$21=function(){return this.$9!=null&&this.$1.getBool("latencymanager_stalled_edgelatency_sec_on")};b.getPreferredLiveHeadLatencySec=function(){var a=this.$21()?this.$1.getNumber("latencymanager_stalled_edgelatency_sec"):this.$1.getNumber("pdash_download_cursor_catchup_threshold_sec");a=this.$23(a);this.$5.getOperationLogger("latency_manager").setPreferredEdgeLatency(a*1e3);return a};b.getPreferredLiveHeadLatencyToleranceSec=function(){return this.$1.getNumber("pdash_download_cursor_catchup_tolerance_sec")};b.shouldEnableManifestTimeRangeCatchup=function(){return!this.$1.getNumber("pdash_download_cursor_catchup_threshold_sec")};b.shouldEnableCursorBasedCatchup=function(){var a=this.$2.getVideoRepresentations()[0];a=a&&a.canPredict();return a&&this.$1.getNumber("pdash_download_cursor_catchup_threshold_sec")>0};b.setEnableCatchup=function(a){var b=this.$14;!this.$14&&a===!0&&(this.$9=null);this.$14=a;this.$1.getBool("fix_live_rewind_user_selected_playback_speed")&&a!==b&&this.$18()};b.$24=function(a,b,c){var d=this.$1.getNumber("playback_speed_min_sharpness_factor");c=a*2/(1+Math.pow(Math.E,-(c-b)*d));return 1-a+c};b.$16=function(){return!this.$1.getBool("playback_speed_latency_adjustment_disabled")&&(this.$1.getNumber("playback_speed_latency_adjustment_rate")>0||this.$1.getNumber("playback_speed_latency_slowdown_adjustment_rate")>0||this.$1.getNumber("playback_speed_latency_speedup_adjustment_rate")>0)};b.$17=function(){var a,b=d("oz-player/utils/OzSourceBufferUtil").getBufferAheadInBufferedRanges(d("oz-player/utils/OzSourceBufferUtil").convertToBufferedTimeRangeArray(this.$4.buffered),this.$3.getCurrentTime(),this.$1).bufferAheadSec;(a=this.$7)==null?void 0:a.addSample(b)};b.$18=function(){var a=d("oz-player/utils/OzSourceBufferUtil").getBufferAheadInBufferedRanges(d("oz-player/utils/OzSourceBufferUtil").convertToBufferedTimeRangeArray(this.$4.buffered),this.$3.getCurrentTime(),this.$1),b=a.bufferAheadSec;a=a.bufferedOffset;this.$25(b,a)};b.$25=function(a,b){var c=this.$1.getNumber("playback_speed_enabled_delay_sec"),d=this.$1.getNumber("playback_speed_min_buffer_sec");a>d&&(this.$10=!0);var e=this.$1.getNumber("playback_speed_min_duration_sec"),f=this.$1.getNumber("playback_speed_restore_min_duration_sec"),g=this.$1.getNumber("playback_speed_latency_adjustment_rate"),h=this.$1.getNumber("playback_speed_latency_slowdown_adjustment_rate"),i=this.$1.getNumber("playback_speed_latency_speedup_adjustment_rate");if(this.$4.playbackRate===0){var j;(j=this.$6)==null?void 0:j.log();this.$6=null}else if(this.$14&&this.$10&&a<d&&(g>0||h>0)&&b===0&&(c===0||this.$13!=null&&this.$13+c*1e3<Date.now())){j=h>0?1-h:this.$24(g,d,a);this.$6==null&&(this.$6=this.$5.getOperationLogger("latency_manager").start().setInitiator("speed_adjustment").setReason("slow").setUserInfo({newPlaybackRate:String(j),oldPlaybackRate:String(this.$4.playbackRate)}));this.$26(j)}else if(this.$14&&this.$10&&(this.$19()||this.$20())&&i>0&&b===0&&(this.$12==null||this.$12+f*1e3<Date.now())&&(c===0||this.$13!=null&&this.$13+c*1e3<Date.now())){h=1+i;this.$6==null&&(this.$6=this.$5.getOperationLogger("latency_manager").start().setInitiator("speed_adjustment").setReason("fast").setUserInfo({newPlaybackRate:String(h),oldPlaybackRate:String(this.$4.playbackRate)}));this.$26(h)}else if(this.$14===!1||this.$11==null||this.$11+e*1e3<Date.now()){g=this.$4.playbackRate;this.$1.getBool("fix_live_rewind_user_selected_playback_speed")?this.$4.playbackRate=this.$14===!1?this.$15():1:this.$4.playbackRate=1;(d=this.$6)==null?void 0:d.log();this.$6=null;g!==this.$4.playbackRate&&(this.$12=Date.now())}};b.$26=function(a){try{this.$4.playbackRate=a,this.$11=Date.now()}catch(b){(a=this.$6)==null?void 0:a.setError(b).setResult("failed").log();this.$6=null}};b.$22=function(){var a=this.$2.getVideoRepresentations().concat(this.$2.getAudioRepresentations());return a.length===0?null:a.reduce(function(a,b){var c;return(((c=a.getEndingSegment())==null?void 0:c.getTimeRange().endTime)||0)>(((c=b.getEndingSegment())==null?void 0:c.getTimeRange().endTime)||0)?a:b})};b.$23=function(a){var b;if(a<=0)return a;var c=this.$22();b=c==null?void 0:(b=c.getEndingSegment())==null?void 0:b.getTimeRange();if(!b)return a;c=c==null?void 0:(c=c.getSegmentByTime((b==null?void 0:b.endTime)-a))==null?void 0:c.getTimeRange();return!c?a:(b==null?void 0:b.endTime)-(c==null?void 0:c.startTime)};b.destroy=function(){this.$8.release()};return a}();g["default"]=a}),98);
__d("oz-player/playback_controls/OzPlaybackTimeRangeManager",["oz-player/shims/OzSubscriptionsHandler","oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.$4=null;this.$5=0;this.$6=0;this.$7=!0;this.$8=0;this.$9=0;this.$10=!1;this.$12=0;this.$13=0;this.$15=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$17=function(){b.$10!=b.$14.isPlaying()&&(b.$14.isPlaying()&&(b.$11=Date.now()),b.$10=b.$14.isPlaying())};var d=a.video,e=a.config,f=a.mpd,g=a.liveheadFallBehindBlockThreshold,h=a.liveheadFallBehindBlockMargin,i=a.playbackState;a=a.perfLoggerProvider;this.$1=e;this.$2=d;this.$3=f;this.$8=g;this.$9=h;this.$14=i;this.$16=a;this.$1.getNumber("catchup_timeout_after_play_sec")!==0&&this.$15.addSubscriptions(this.$14.addEventListener("play",this.$17),this.$14.addEventListener("pause",this.$17))}var b=a.prototype;b.setTimelineBlockingEnabled=function(a){this.$7=a,this.$7||this.$3.unblockTimeRange()};b.setTimeRangeProvider=function(a){var b=this;this.$4!=null&&this.$4.remove();this.$4=a.addUpdateListener(function(){var c=a.getTimeRanges(),d=0;if(c.length!==0){c=c[c.length-1];d=c.endTime}b.$18(d)})};b.$18=function(a){var b;if(!this.$7)return;if(this.$5===a)return;this.$5=a;if(this.$2.currentTime<=this.$6)return;a=this.$1.getBool("catchup_use_timeline_range_end_time_as_end")?a:this.$2.duration;var c=this.$1.getNumber("overwrite_livehead_fall_behind_block_threshold")!==0?this.$1.getNumber("overwrite_livehead_fall_behind_block_threshold"):this.$8,e=this.$1.getNumber("overwrite_live_time_range_block_margin")!==0?this.$1.getNumber("overwrite_live_time_range_block_margin"):this.$9;this.$17();this.$1.getBool("reset_catchup_timeout_after_play_sec_on_overwrite")&&(this.$13!=e||this.$12!=c)&&(this.$13=e,this.$12=c,this.$11=Date.now());b=this.$1.getNumber("catchup_timeout_after_play_sec")===0||Date.now()-((b=this.$11)!=null?b:0)<this.$1.getNumber("catchup_timeout_after_play_sec")*1e3;if(b&&this.$1.getNumber("pdash_download_cursor_catchup_threshold_sec")===0&&e!==0&&c!==0&&a-this.$2.currentTime>c){b=[];for(c=0;c<this.$2.buffered.length;c++)b.push({startTime:this.$2.buffered.start(c),endTime:this.$2.buffered.end(c)});c=d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(this.$2.currentTime,b);this.$6=this.$2.currentTime+Math.min(c,e);b={startTime:this.$6,endTime:a-e};this.$16.getOperationLogger("latency_manager").setInitiator("time_range_manager").setReason("blocked_range").setLength(b.endTime-b.startTime).setUserInfo({blockedRangeStart:String(b.startTime),blockedRangeEnd:String(b.endTime)}).log();this.$3.blockTimeRange(b)}};b.destroy=function(){this.$4!=null&&(this.$4.remove(),this.$4=null),this.$15.release()};return a}();g["default"]=a}),98);
__d("oz-player/strategies/LiveheadSeekaheadStrategy",[],(function(a,b,c,d,e,f){"use strict";var g=.05;function a(a,b){b=Math.max.apply(Math,b.map(function(a){return a.startTime}));return b-a>0?b-a+g:0}f.computeSeekAhead=a}),66);
__d("oz-player/utils/OzTimelineGapUtil",["oz-player/utils/OzNumericalHelper","oz-player/utils/OzNumericalRangeUtil"],(function(a,b,c,d,e,f,g){"use strict";var h=1.5;function a(a,b,c,e){b=b.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}});return d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(c,a,b,e)===-1}function b(a,b,c,e,f){f===void 0&&(f=h);var g=b.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}});c=d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(c,a,g,e);if(c!==-1){g=b[c];return d("oz-player/utils/OzNumericalHelper").lessThanOrEqual(a,g.endTime)&&g.endTime-a<f}return!1}g.isInGap=a;g.isNearGap=b}),98);
__d("oz-player/playback_controls/OzPlayheadManager",["oz-player/shims/OzDOMEventListener","oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozThrottle","oz-player/shims/ozvariant","oz-player/strategies/LiveheadSeekaheadStrategy","oz-player/utils/OzNumericalRangeUtil","oz-player/utils/OzSourceBufferUtil","oz-player/utils/OzTimelineGapUtil"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a){this.$1=a.perfLoggerProvider,this.$2=a.video,this.$4=a.config}var b=a.prototype;b.markState=function(a,b){var c=d("oz-player/utils/OzSourceBufferUtil").convertToBufferedTimeRangeArray(this.$2.buffered),e=this.$3;if(e==null){this.$3=c;return}var f=d("oz-player/utils/OzSourceBufferUtil").getBufferAheadInBufferedRanges(c,b.getCurrentTime(),this.$4);e=d("oz-player/utils/OzSourceBufferUtil").getBufferAheadInBufferedRanges(e,b.getCurrentTime(),this.$4);e.bufferedOffset!==-1&&f.bufferedOffset===-1&&this.$1.getOperationLogger("playhead_adjustment").setError("buffer_deleted").setResult("failed").setUserInfo({vidSeeking:String(this.$2.seeking),vidErrCode:this.$2.error?String(this.$2.error.code):null}).setInitiator(a).log();this.$3=c};return a}(),i=function(){function a(a){this.$5=!1,this.$6={},this.$1=a.perfLoggerProvider,this.$2=a.video}var b=a.prototype;b.markState=function(a,b){var c=this;if(this.$2.paused){this.$3=null;this.$4=null;this.$5=!1;this.$6={};return}(this.$3==null||this.$2.currentTime>this.$3)&&(this.$4=Date.now(),this.$3=this.$2.currentTime,this.$5=!1,this.$6={});this.$6[a]=this.$6[a]==null?1:this.$6[a]+1;var d=this.$4;if(!this.$5&&!this.$2.paused&&d!=null&&d+1e4<Date.now()){this.$5=!0;var e={};Object.keys(this.$6).forEach(function(a){e[a]=String(c.$6[a])});this.$1.getOperationLogger("playhead_adjustment").setError("not_advancing").setResult("failed").setLength(Date.now()-d).setUserInfo(babelHelpers["extends"]({},e,b,{lastCurrentTime:String(this.$3),lastCurrentTimeChanged:String(d-Date.now()),vidSeeking:String(this.$2.seeking),vidErrCode:this.$2.error?String(this.$2.error.code):null})).setInitiator(a).log()}};return a}();a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;e.$OzPlayheadManager$p_2=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzPlayheadManager$p_3=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzPlayheadManager$p_4=new Set();e.$OzPlayheadManager$p_10=new Set();e.$OzPlayheadManager$p_12=function(a){e.$OzPlayheadManager$p_1.currentTime=a};e.$OzPlayheadManager$p_14=!1;e.$OzPlayheadManager$p_15=!1;e.$OzPlayheadManager$p_16=!0;e.$OzPlayheadManager$p_17=!1;e.$OzPlayheadManager$p_23=function(a,b){b===void 0&&(b=null);if(e.$OzPlayheadManager$p_20!=null?!e.$OzPlayheadManager$p_20.shouldEnableManifestTimeRangeCatchup():!1)return;var c=e.$OzPlayheadManager$p_9;if(c&&c.isEnabled(e.$OzPlayheadManager$p_1,e.$OzPlayheadManager$p_8)){c=c.computeNewPlayheadPosition(e.$OzPlayheadManager$p_1,e.$OzPlayheadManager$p_8);if(typeof c==="number"){e.$OzPlayheadManager$p_27(c,"live_catch_up_strategy",a,b);return}}c=e.$OzPlayheadManager$p_6.getNumber("auto_seek_playhead_slack");if(c===0)return;var f=e.$OzPlayheadManager$p_5;if(!f)return;var g=e.$OzPlayheadManager$p_7.getCurrentTime(),h=f.getTimeRanges().map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}),i=d("oz-player/utils/OzNumericalRangeUtil").findNextRangeIndex(g,h);if((d("oz-player/utils/OzTimelineGapUtil").isNearGap(g,f.getTimeRanges(),e.$OzPlayheadManager$p_6)||d("oz-player/utils/OzTimelineGapUtil").isInGap(g,f.getTimeRanges(),e.$OzPlayheadManager$p_6))&&i!==-1){g=h[i];e.$OzPlayheadManager$p_27(g.rangeStart+c,"jump_over_timeline_gap",a,b)}};var f=b.video,g=b.mpd,j=b.playheadCatchup,k=b.playbackState,l=b.config,m=b.perfLoggerProvider,n=b.seekHandler,o=b.initialPlaybackPosition,p=b.canSupportSkipVideobufferGaps,q=b.liveLatencyManager;b=b.dynamicVideoLibrary;e.$OzPlayheadManager$p_1=f;e.$OzPlayheadManager$p_6=l;e.$OzPlayheadManager$p_7=k;e.$OzPlayheadManager$p_8=g;e.$OzPlayheadManager$p_9=j;e.$OzPlayheadManager$p_11=m;n&&(e.$OzPlayheadManager$p_12=n);e.$OzPlayheadManager$p_17=p;e.$OzPlayheadManager$p_20=q;e.$OzPlayheadManager$p_13=o;e.$OzPlayheadManager$p_21=b;e.$OzPlayheadManager$p_18=new i({video:f,perfLoggerProvider:m});e.$OzPlayheadManager$p_19=new h({video:f,perfLoggerProvider:m,config:l});e.$OzPlayheadManager$p_2.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"durationchange",function(){e.setPlaybackPositionOnFirstDurationChange("durationchange",e.$OzPlayheadManager$p_1.duration),e.$OzPlayheadManager$p_23("durationchange"),e.$OzPlayheadManager$p_24("durationchange")}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"pause",function(){e.$OzPlayheadManager$p_23("pause")}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"play",function(){e.$OzPlayheadManager$p_23("play")}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"playing",function(){e.$OzPlayheadManager$p_23("playing")}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"waiting",function(){e.$OzPlayheadManager$p_23.bind(babelHelpers.assertThisInitialized(e),"waiting"),e.$OzPlayheadManager$p_24("waiting")}),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"timeupdate",c("oz-player/shims/ozThrottle")(function(){e.$OzPlayheadManager$p_23("timeupdate"),e.$OzPlayheadManager$p_6.getBool("playhead_manager_buffered_timerange_update_on_timeupdate")&&e.$OzPlayheadManager$p_24("timeupdate")},e.$OzPlayheadManager$p_6.getNumber("playhead_manager_timeupdate_throttle_ms"))),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadManager$p_1,"seeking",function(){e.$OzPlayheadManager$p_22=Date.now()}));return e}var e=b.prototype;e.$OzPlayheadManager$p_25=function(){return this.$OzPlayheadManager$p_1.playbackRate===0};e.observeSourceBufferState=function(a,b){var d=this;this.$OzPlayheadManager$p_4.has(a)&&c("oz-player/shims/ozvariant")(0,4179);this.$OzPlayheadManager$p_4.add(a);this.$OzPlayheadManager$p_2.addSubscriptions(a.addEventListener("buffer_updated",function(){d.$OzPlayheadManager$p_26(a,b),d.$OzPlayheadManager$p_6.getBool("skip_videobuffer_gaps_on_buffer_updated")&&d.$OzPlayheadManager$p_17&&d.$OzPlayheadManager$p_24("buffer_updated")}))};e.$OzPlayheadManager$p_26=function(a,b){var c=[];this.$OzPlayheadManager$p_4.forEach(function(a){a=a.getBufferedRanges();a.length&&c.push(a[0])});c.length>0&&this.$OzPlayheadManager$p_10.add(a);a=this.$OzPlayheadManager$p_1.currentTime;a=d("oz-player/strategies/LiveheadSeekaheadStrategy").computeSeekAhead(a,c);var e=this.$OzPlayheadManager$p_6.getNumber("timeline_offset_threshold");a>0&&(e===0||a<e)&&this.$OzPlayheadManager$p_27(this.$OzPlayheadManager$p_1.currentTime+a,"first_available_buffer","source_buffer",b)};e.setTimeRangeProvider=function(a){var b=this;this.$OzPlayheadManager$p_3.release();this.$OzPlayheadManager$p_3.engage();this.$OzPlayheadManager$p_3.addSubscriptions(a.addUpdateListener(function(){b.$OzPlayheadManager$p_23("time_range_updated")}));this.$OzPlayheadManager$p_5=a;this.$OzPlayheadManager$p_23("time_range_set")};e.resetCurrentTime=function(){this.$OzPlayheadManager$p_15=!1,this.setPlaybackPositionOnFirstDurationChange("reset",this.$OzPlayheadManager$p_1.duration)};e.setPlaybackPositionOnFirstDurationChange=function(a,b){if(this.$OzPlayheadManager$p_13!==0&&!this.$OzPlayheadManager$p_15&&!isNaN(b)&&b!==Infinity){b=this.$OzPlayheadManager$p_13>0?this.$OzPlayheadManager$p_13:b+this.$OzPlayheadManager$p_13;if(this.$OzPlayheadManager$p_20!=null){var c;b=(c=this.$OzPlayheadManager$p_20)==null?void 0:c.getInitialPlayHeadPosition()}this.$OzPlayheadManager$p_15=!0;if(this.$OzPlayheadManager$p_6.getBool("playhead_manager_clamp_initial_playback_position")){c=(c=this.$OzPlayheadManager$p_5)==null?void 0:c.getTimeRanges();c!=null&&c.length>0&&c[0].startTime>b&&(b=c[0].startTime)}this.$OzPlayheadManager$p_27(b,"initial_playback_position",a);this.emit("initialPlaybackPositionSet",b)}};e.$OzPlayheadManager$p_24=function(a){var b,c,e=this;if(!this.$OzPlayheadManager$p_6.getBool("skip_videobuffer_gaps"))return;if(!this.$OzPlayheadManager$p_17)return;var f=this.$OzPlayheadManager$p_6.getNumber("playhead_manager_buffered_auto_seek_playhead_slack");if(f===0)return;var g=this.$OzPlayheadManager$p_7.getCurrentTime(),h=[];for(var i=0;i<this.$OzPlayheadManager$p_1.buffered.length;i++)h.push({startTime:this.$OzPlayheadManager$p_1.buffered.start(i),endTime:this.$OzPlayheadManager$p_1.buffered.end(i)});i=h.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}});this.$OzPlayheadManager$p_19&&this.$OzPlayheadManager$p_19.markState(a,this.$OzPlayheadManager$p_7);var j=d("oz-player/utils/OzNumericalRangeUtil").findNextRangeIndex(g,i),k=d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(this.$OzPlayheadManager$p_6,g,i),l=this.$OzPlayheadManager$p_16?0:this.$OzPlayheadManager$p_6.getNumber("skip_videobuffer_gaps_max_gap_size_sec"),m=this.$OzPlayheadManager$p_6.getNumber("playhead_manager_buffered_is_near_gap_threshold"),n=this.$OzPlayheadManager$p_6.getNumber("playhead_manager_buffered_numerical_error");b=(b=this.$OzPlayheadManager$p_21)==null?void 0:b.getLastSegmentStartPTS();var o=b!=null?b/1e3:null,p=(c=this.$OzPlayheadManager$p_21)==null?void 0:c.getLast200RequestedUrlDecisionMinTime();c=o!=null?d("oz-player/utils/OzNumericalRangeUtil").findCurrentRangeIndex(this.$OzPlayheadManager$p_6,o,i):-1;var q=c>=0?i[c]:null,r=function(b){var c=e.$OzPlayheadManager$p_22==null||p==null||e.$OzPlayheadManager$p_22<p;!c&&b!=null&&e.$OzPlayheadManager$p_11.getOperationLogger("playhead_adjustment").setError("ignore_before_seek_main_"+b).setResult("failed").setInitiator(a).setUserInfo({last200RequestedUrlDecisionMinTime:String(p),lastSeekTime:String(e.$OzPlayheadManager$p_22)}).log();return c};if(o!=null&&this.$OzPlayheadManager$p_25()&&this.$OzPlayheadManager$p_16==!1&&r("buf")){if(o<g&&q!=null&&q.rangeStart<=o&&q.rangeEnd!=null&&q.rangeEnd>o){this.$OzPlayheadManager$p_27(o,"reverse_jump_over_buffer_gap",a,null,{lastSegmentStartPTS:String(b),last200RequestedUrlDecisionMinTime:String(p),lastSeekTime:String(this.$OzPlayheadManager$p_22)});return}if(q!=null&&c!=k){this.$OzPlayheadManager$p_27(q.rangeStart,"jump_over_buffer_gap_last_dl_range",a,null,{lastSegmentStartPTS:String(b),last200RequestedUrlDecisionMinTime:String(p),lastSeekTime:String(this.$OzPlayheadManager$p_22)});return}}if((d("oz-player/utils/OzTimelineGapUtil").isNearGap(g,h,this.$OzPlayheadManager$p_6,n,m)||d("oz-player/utils/OzTimelineGapUtil").isInGap(g,h,this.$OzPlayheadManager$p_6,n))&&j!==-1&&(l===0||i[j].rangeStart-g<l)&&(this.$OzPlayheadManager$p_16==!0||r("main"))){o=i[j];this.$OzPlayheadManager$p_6.getBool("enable_alternative_audio_tracks")&&this.$OzPlayheadManager$p_8.isStaticMpd()&&o.rangeStart!==0&&o.rangeEnd===this.$OzPlayheadManager$p_7.getDuration()?this.$OzPlayheadManager$p_27(0,"do_not_jump_over_buffer_gap",a,null,{lastSegmentStartPTS:String(b),last200RequestedUrlDecisionMinTime:String(p),lastSeekTime:String(this.$OzPlayheadManager$p_22)}):this.$OzPlayheadManager$p_27(o.rangeStart+f,"jump_over_buffer_gap",a,null,{lastSegmentStartPTS:String(b),last200RequestedUrlDecisionMinTime:String(p),lastSeekTime:String(this.$OzPlayheadManager$p_22)});return}this.$OzPlayheadManager$p_18&&this.$OzPlayheadManager$p_18.markState(a,{nextBufferedRangeIndex:String(j),limitMaxGapSize:String(l),rangeStart:j!==-1?String(i[j].rangeStart):null,isNearGapThreshold:String(m),numericalError:String(n)})};e.setEnableLiveheadCatchup=function(a){this.$OzPlayheadManager$p_16=a};e.destroy=function(){this.$OzPlayheadManager$p_2.release(),this.$OzPlayheadManager$p_3.release(),this.$OzPlayheadManager$p_4.clear()};e.$OzPlayheadManager$p_27=function(a,b,c,d,e){var f=a-this.$OzPlayheadManager$p_1.currentTime,g=this.$OzPlayheadManager$p_6.getNumber("seek_ahead_epsilon");if(g>0&&Math.abs(f)<=g)return;this.$OzPlayheadManager$p_11.getOperationLogger("playhead_adjustment").setLength(Math.round(a*1e3)).setReason(b).setInitiator(c).setType(d).setUserInfo(babelHelpers["extends"]({},e,{seekAdjustment:String(Math.round(f*1e3))})).log();this.$OzPlayheadManager$p_12(a);b==="initial_playback_position"&&(this.$OzPlayheadManager$p_14=!0)};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/shims/www/OzUuidWWW",["uuidv4"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("uuidv4")}),98);
__d("oz-player/shims/OzUuid",["oz-player/shims/www/OzUuidWWW"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/shims/www/OzUuidWWW")}),98);
__d("oz-player/states/OzObservedPlaybackState",["oz-player/loggings/OzMultiDestinationPerfLogger","oz-player/shims/OzDOMEventListener","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e){var f=this;e===void 0&&(e=new(d("oz-player/loggings/OzMultiDestinationPerfLogger").OzMultiDestinationPerfLoggerProvider)([]));this.$2=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$4=function(){f.$3.getOperationLogger("pause").setState("paused").log()};this.$5=function(){f.$3.getOperationLogger("playing").setState("playing").log()};this.$1=b;this.$3=e;this.$2.addSubscriptions(c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"pause",this.$4),c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,"playing",this.$5))}var b=a.prototype;b.isPlaying=function(){return!this.$1.paused};b.getCurrentTime=function(){return this.$1.currentTime};b.getCurrentTimeUpdateTime=function(){return Date.now()};b.getDuration=function(){return this.$1.duration};b.addEventListener=function(a,b){return c("oz-player/shims/OzDOMEventListener").listenDOMEvent(this.$1,a,b)};b.destroy=function(){this.$2.release()};return a}();g["default"]=a}),98);
__d("oz-player/utils/OzPositionToViewportUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){b=b.filter(function(a){a=a.position;if(a==null)return!1;var b=a.y-window.scrollY;return b>=0||(a.height+b)/a.height>c}).sort(function(a,b){return a.position==null||b.position==null?0:a.position.y-b.position.y});return b.findIndex(function(b){return b.video===a})}function b(a){return a.isIntersecting!=null?a.isIntersecting:a.intersectionRatio>0||a.intersectionRect&&(a.intersectionRect.height>0||a.intersectionRect.width>0)}f.determinePositionIndexOfVideoFromViewportVertically=a;f.intersectionObserverEntryIsIntersecting=b}),66);
__d("oz-player/states/OzPositionToViewportTracker",["oz-player/shims/OzEventEmitter","oz-player/utils/OzPositionToViewportUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=.5;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$OzPositionToViewportTracker$p_1=[];c.$OzPositionToViewportTracker$p_5=function(a){a.forEach(function(a){var b=c.$OzPositionToViewportTracker$p_1.find(function(b){return a.target===b.video});b!=null&&(d("oz-player/utils/OzPositionToViewportUtils").intersectionObserverEntryIsIntersecting(a)?b.position=c.$OzPositionToViewportTracker$p_7(a):c.$OzPositionToViewportTracker$p_1.map(function(b){a.target===b.video&&(b.position=null)}));c.$OzPositionToViewportTracker$p_1.forEach(function(a){a.positionIndexToViewportVertically=c.$OzPositionToViewportTracker$p_6(a.video)})}),c.emit("state_changed")};c.$OzPositionToViewportTracker$p_2=b;return c}var c=b.prototype;c.$OzPositionToViewportTracker$p_4=function(){if(this.$OzPositionToViewportTracker$p_3!=null)return;this.$OzPositionToViewportTracker$p_3=new IntersectionObserver(this.$OzPositionToViewportTracker$p_5,{rootMargin:this.$OzPositionToViewportTracker$p_2.getNumber("pixels_above_viewport_to_observe")+"px 0px "+this.$OzPositionToViewportTracker$p_2.getNumber("pixels_below_viewport_to_observe")+"px 0px",threshold:0})};c.registerVideo=function(a){this.$OzPositionToViewportTracker$p_1.push({video:a,position:null,positionIndexToViewportVertically:-1}),this.$OzPositionToViewportTracker$p_4(),this.$OzPositionToViewportTracker$p_3!=null&&this.$OzPositionToViewportTracker$p_3.observe(a)};c.getPositionIndexOfVideoFromViewportVertically=function(a){var b=this.$OzPositionToViewportTracker$p_1.find(function(b){return b.video===a});return b!=null?b.positionIndexToViewportVertically:-1};c.$OzPositionToViewportTracker$p_6=function(a){return d("oz-player/utils/OzPositionToViewportUtils").determinePositionIndexOfVideoFromViewportVertically(a,this.$OzPositionToViewportTracker$p_1,i)};c.$OzPositionToViewportTracker$p_7=function(a){a=a.boundingClientRect;return{x:a.x+window.scrollX,y:a.y+window.scrollY,width:a.width,height:a.height}};b.getInstance=function(a){h==null&&(h=new b(a));return h};c.unregisterVideo=function(a){var b=this,c=[];this.$OzPositionToViewportTracker$p_1.forEach(function(d){d.video===a&&b.$OzPositionToViewportTracker$p_3!=null?b.$OzPositionToViewportTracker$p_3.unobserve(a):c.push(d)});this.$OzPositionToViewportTracker$p_1=c;this.$OzPositionToViewportTracker$p_1.length===0&&this.$OzPositionToViewportTracker$p_3!=null&&(this.$OzPositionToViewportTracker$p_3.disconnect(),this.$OzPositionToViewportTracker$p_3=null)};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/states/OzPositionToViewport",["oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/states/OzPositionToViewportTracker"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$OzPositionToViewport$p_1=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzPositionToViewport$p_3=b;e.$OzPositionToViewport$p_2=c("oz-player/states/OzPositionToViewportTracker").getInstance(d);e.$OzPositionToViewport$p_2.registerVideo(b);e.$OzPositionToViewport$p_1.addSubscriptions(e.$OzPositionToViewport$p_2.addListener("state_changed",function(){e.emit("state_changed")}));return e}var d=b.prototype;d.getPositionIndexOfVideoFromViewportVertically=function(){return this.$OzPositionToViewport$p_3!=null?this.$OzPositionToViewport$p_2.getPositionIndexOfVideoFromViewportVertically(this.$OzPositionToViewport$p_3):-1};d.destroy=function(){this.$OzPositionToViewport$p_3!=null&&this.$OzPositionToViewport$p_2.unregisterVideo(this.$OzPositionToViewport$p_3),this.$OzPositionToViewport$p_3=null};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzPlaybackConfidenceUtils",[],(function(a,b,c,d,e,f){"use strict";var g=.8;function a(a,b,c,d,e,f){f=Math.min(1,c/d);c=1+(1-f)*e;d=a.getBandwidth()*c;return d>b?g*(b/d):1-(1-g)*d/b}f.getPlaybackConfidence=a}),66);
__d("oz-player/strategies/OzAbrManager",["oz-player/networks/OzBandwidthEstimator","oz-player/strategies/OzPlaybackConfidenceUtils","oz-player/utils/OzAbrUtils","oz-player/utils/OzBufferingUtils","oz-player/utils/OzPlaybackRestrictionsUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d,e,f,g,h,i){this.$2=0,this.$3=Date.now(),this.$4=!1,this.$10=null,this.$1=a,this.$5=b,this.$6=this.$15(b,c),this.$7=d,this.$8=e,this.$11=f,this.$12=g,this.$13=h,this.$14=i,this.$1.getBool("enable_abr_logging")&&this.$14.getOperationLogger("abr_initialized").setResult("success").setUserInfo({newRepresentationIds:c.map(function(a){return a.getID()}).join(","),newCodecs:c.map(function(a){return a.getCodecs()}).join("|"),newDisplayLabels:c.map(function(a){return a.getDisplayLabel()}).join(",")}).setRepresentationID(b.getID()).setType("video").setInitiator("OzAbrManager").log()}var b=a.prototype;b.setSourceBuffer=function(a){this.$9=a};b.$15=function(a,b){var c=this.$1.getNumber("abr_restrict_from_index"),d=this.$1.getNumber("abr_restrict_to_index");if(d===0&&c===0)return b;var e=b.findIndex(function(b){return a.getID()===b.getID()});return e===-1?b:b.filter(function(a,b){return b-e>=c&&b-e<=d})};b.$16=function(a){a=d("oz-player/utils/OzAbrUtils").excludeLargeRepresentations(a,this.$12(),this.$11,{resolutionConstraintFactor:this.$1.getNumber("resolution_constraint_factor")});a=d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(this.$7,this.$12(),a);return a};b.getBestRepresentation=function(a){var b;a=(a=a==null?void 0:a.length)!=null?a:null;b=(b=(b=this.$9)==null?void 0:b.getSourceBufferState().getBufferedRanges())!=null?b:null;var e=this.$8.getCurrentTime();e=d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(e,b);b=d("oz-player/utils/OzAbrUtils").getReasonToPreventEvaluation(this.$1,this.$4,e,c("oz-player/networks/OzBandwidthEstimator").getSampleCount(),this.$2,this.$3);if(b!=null){this.$10=b;this.$1.getBool("enable_abr_logging")&&this.$14.getOperationLogger("abr_best_representation_selected").setResult("failed").setReason(this.$10).setType("video").setInitiator("OzAbrManager").log();return this.$5}b=Date.now();this.$2=b;var f=c("oz-player/networks/OzBandwidthEstimator").getAdjustedBandwidth(this.$1.getLegacyConfig()),g=this.$16(this.$6);f=this.$17(g,f,e,a);a=g[0];f=f||a;if(this.$18(e,f)){this.$10="high_buffer";this.$1.getBool("enable_abr_logging")&&this.$14.getOperationLogger("abr_best_representation_selected").setResult("failed").setUserInfo({filteredRepresentationIds:g.map(function(a){return a.getID()}).join(",")}).setPreviousRepresentationID(this.$5.getID()).setReason(this.$10).setType("video").setInitiator("OzAbrManager").log();return this.$5}a=this.$5;a!==f&&(this.$4=!0,this.$3=b,this.$5=f);this.$10="bandwidth";this.$1.getBool("enable_abr_logging")&&this.$14.getOperationLogger("abr_best_representation_selected").setResult("success").setUserInfo({filteredRepresentationIds:g.map(function(a){return a.getID()}).join(",")}).setRepresentationID(f.getID()).setPreviousRepresentationID(a==null?void 0:a.getID()).setReason(this.$10).setType("video").setInitiator("OzAbrManager").log();return f};b.$17=function(a,b,c,e){e===void 0&&(e=null);var f=null;for(var g=0;g<a.length;g++){var h=d("oz-player/strategies/OzPlaybackConfidenceUtils").getPlaybackConfidence(a[g],b,c,this.$1.getNumber("low_buffer_bandwidth_target_threshold"),this.$1.getNumber("low_buffer_bandwidth_target_increase_factor"),e);h>this.$1.getNumber("abr_confidence_threshold")&&(!f||f.getBandwidth()<a[g].getBandwidth())&&(f=a[g])}return f};b.$18=function(a,b){var c=this.$1.getNumber("abr_prevent_down_switch_buffer_threshold");return c>0&&a>=c&&this.$5.getBandwidth()>b.getBandwidth()?!0:!1};b.getLastEvaluationReason=function(){return this.$10};b.updateRepresentations=function(a){var b=this,c=this.$6;this.$6=a;var d=this.$6.find(function(a){return a.getDisplayLabel()===b.$5.getDisplayLabel()}),e=this.$5;this.$5=(d=d)!=null?d:this.$6[0];this.$1.getBool("enable_abr_logging")&&this.$14.getOperationLogger("abr_representations_updated").setResult("success").setUserInfo({previousRepresentationIds:c.map(function(a){return a.getID()}).join(","),newRepresentationIds:a.map(function(a){return a.getID()}).join(","),newCodecs:a.map(function(a){return a.getCodecs()}).join("|"),newDisplayLabels:a.map(function(a){return a.getDisplayLabel()}).join(",")}).setRepresentationID(this.$5.getID()).setPreviousRepresentationID(e==null?void 0:e.getID()).setReason(this.$10).setType("video").setInitiator("OzAbrManager").log()};return a}();g["default"]=a}),98);
__d("oz-player/strategies/getSegmentsCount",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){var e=0,f=a.getTimeRange().startTime;a=a;var g=a.getTimeRange().startTime;while(a!==null&&g<c+f){var h=g;e++;a=b.getSegmentAfter(a);if(a)g=a.getTimeRange().startTime;else break;if(g<=h)return d}return Math.max(e,1)}f["default"]=a}),66);
__d("oz-player/strategies/OzStaticStreamSegmentsStrategy",["oz-player/strategies/getSegmentsCount"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.isActive=function(){return!0};b.getSegmentsCount=function(a,b,d){a=this.$1.getNumber("seconds_to_stream");var e=this.$1.getNumber("segments_to_stream");a>0&&(e=c("oz-player/strategies/getSegmentsCount")(b,d,a,e));return e};return a}();g["default"]=a}),98);
__d("oz-player/strategies/OzBandwidthBoundaryStreamSegmentsCountStrategy",["oz-player/networks/OzBandwidthEstimator","oz-player/strategies/OzStaticStreamSegmentsStrategy","oz-player/strategies/getSegmentsCount"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b,this.$3=new(c("oz-player/strategies/OzStaticStreamSegmentsStrategy"))(a)}var b=a.prototype;b.isActive=function(a){return!0};b.getSegmentsCount=function(a,b,d){var e=c("oz-player/networks/OzBandwidthEstimator").getBandwidth(this.$1.getLegacyConfig()),f=c("oz-player/networks/OzBandwidthEstimator").getStandardDeviationOfBandwidth(),g=this.$1.getNumber("bandwidth_boundary_standard_deviation_factor"),h=this.$2.some(function(a){a=a.getBandwidth();return Math.abs(a-e)<f*g});h=h?this.$4(a,b,d):this.$3.getSegmentsCount(a,b,d);a=this.$5(b,e);return Math.min(h,a)};b.$4=function(a,b,d){a=this.$1.getNumber("seconds_to_stream_near_bandwidth_boundary");var e=this.$1.getNumber("segments_to_stream_near_bandwidth_boundary");a>0&&(e=c("oz-player/strategies/getSegmentsCount")(b,d,a,e));return e};b.$5=function(a,b){var c=Infinity;a=a.getByteRange();if(a){var d=a.endByte;if(d!=null){var e=this.$1.getNumber("per_stream_duration_target");d=d-a.startByte;e>1e-5&&d!==0&&(c=Math.ceil(e*b/(d*8)))}}return c};return a}();g["default"]=a}),98);
__d("oz-player/strategies/OzBlockedRepresentationsManager",["oz-player/shims/OzEventEmitter","oz-player/shims/ozClearTimeout","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$2=new Map(),this.$3=new Set(),this.$4=new Set(),this.$5=new(c("oz-player/shims/OzEventEmitter"))(),this.$6(a),this.$7(a)}var b=a.prototype;b.isBlocked=function(a){return this.$3.has(a)};b.handleError=function(a,b){if(this.$1!=null&&this.$3.size===this.$1-1)return!1;if(d("oz-player/utils/OzErrorUtils").isOzError(b)&&b.getType()==="OZ_NETWORK"){b=Number(b.getExtra().code);if(!isNaN(b)&&this.$2.has(b)){this.$3.has(a)||this.$8(a,b);return!0}}return!1};b.$8=function(a,b){var d,e=this;this.$3.add(a);(d=this.$5)==null?void 0:d.emit("representation_blocked",a);d=this.$2.get(b)||0;if(d>0){var f=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){e.$3["delete"](a),e.$4["delete"](f)},d);this.$4.add(f)}};b.applyRestriction=function(a){var b=this;return a.filter(function(a){return!b.$3.has(a.getID())})};b.onRepresentationBlocked=function(a){return this.$5?this.$5.addListener("representation_blocked",a):{remove:function(){}}};b.setAvailableRepresentationsCount=function(a){this.$1=a};b.destroy=function(){var a;(a=this.$5)==null?void 0:a.removeAllListeners();this.$5=null;for(var a=this.$4,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;c("oz-player/shims/ozClearTimeout")(e)}this.$4.clear()};b.$6=function(a){var b=this;try{a=JSON.parse(a.getString("block_representation_status_codes_json"));Array.isArray(a)&&a.forEach(function(a){a=parseInt(a,10);isNaN(a)||b.$2.set(a,-1)})}catch(a){}};b.$7=function(a){var b=this;try{a=JSON.parse(a.getString("block_representation_status_codes_temporarily_json"));Object.entries(a).forEach(function(a){var c=a[0];a=a[1];c=parseInt(c,10);a=parseInt(a,10);!isNaN(c)&&!isNaN(a)&&b.$2.set(c,a)})}catch(a){}};return a}();g["default"]=a}),98);
__d("oz-player/strategies/OzBufferAheadPriorityStrategy",["oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozThrottle","oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=6,i=1e3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$OzBufferAheadPriorityStrategy$p_3=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzBufferAheadPriorityStrategy$p_5=function(){e.emit("state_changed")};e.$OzBufferAheadPriorityStrategy$p_4=b;e.$OzBufferAheadPriorityStrategy$p_1=d;e.$OzBufferAheadPriorityStrategy$p_3.addSubscriptions(e.$OzBufferAheadPriorityStrategy$p_1.addEventListener("progress",c("oz-player/shims/ozThrottle")(e.$OzBufferAheadPriorityStrategy$p_5,i)),e.$OzBufferAheadPriorityStrategy$p_1.addEventListener("timeupdate",c("oz-player/shims/ozThrottle")(e.$OzBufferAheadPriorityStrategy$p_5,i)));return e}var e=b.prototype;e.getName=function(){return"buffer_ahead"};e.setSourceBufferState=function(a){if(this.$OzBufferAheadPriorityStrategy$p_2)return;this.$OzBufferAheadPriorityStrategy$p_2=a;this.$OzBufferAheadPriorityStrategy$p_3.addSubscriptions(a.addEventListener("buffer_updated",c("oz-player/shims/ozThrottle")(this.$OzBufferAheadPriorityStrategy$p_5,i)))};e.isActive=function(){return!0};e.getPriority=function(){var a=this.$OzBufferAheadPriorityStrategy$p_2;if(!a)return 1;var b=this.$OzBufferAheadPriorityStrategy$p_1.getCurrentTime();a=a.getBufferedRanges();b=d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(b,a);return b>=h?0:1};e.destroy=function(){this.$OzBufferAheadPriorityStrategy$p_3.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzBufferAheadTargetStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.isActive=function(){return!0};b.getBufferTarget=function(){return this.$1.getNumber("buffer_ahead_target")};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzBufferEndLimitStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.isActive=function(){return!0};b.getBufferTarget=function(){var a=this.$3();return this.$2>=a?this.$2-a:0};b.$3=function(){return this.$1.buffered.length===0?0:this.$1.buffered.end(0)};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzBufferTargetBoundedStreamSegmentsCountStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.isActive=function(a){return!a.isPlaying()};b.getSegmentsCount=function(a,b,c){a=a.getCurrentTime();var d=this.$1.computeBufferTarget(),e=1,f=b;b=b.getTimeRange().startTime;while(f!==null&&b<d+a){f=c.getSegmentAfter(f);if(!f)break;b=f.getTimeRange().startTime;e++}return e};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzBufferTargetCalculator",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=0,this.$2=a,this.$3=b}var b=a.prototype;b.computeBufferTarget=function(){var a=this.$1;for(var b=this.$2,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(e.isActive()){a=e.getBufferTarget();break}}for(e=this.$3,d=Array.isArray(e),c=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(c>=e.length)break;b=e[c++]}else{c=e.next();if(c.done)break;b=c.value}b=b;a=b.adjustBufferTargetInSeconds(a)}this.$1=a;return a};b.handleEvent=function(a){for(var b=this.$3,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.handleEvent(a)}};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzBufferTargetCalculatorQuotaExceededConstraint",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var b=a.config;a=a.minimumBufferTargetSec;this.$2=1;this.$1=b;this.$3=a}var b=a.prototype;b.adjustBufferTargetInSeconds=function(a){var b;return Math.max((b=this.$3)!=null?b:this.$1.getNumber("buffer_target_constraint_minimum_sec"),a*this.$2)};b.handleEvent=function(a){var b=this.$2;switch(a){case"append_succeeded":b=Math.max(0,Math.min(1,b+this.$1.getNumber("buffer_target_constraint_append_succeeded_reward")));break;case"append_quota_exceeded":b=Math.max(0,Math.min(1,b-this.$1.getNumber("buffer_target_constraint_quota_exceeded_penalty")));break;default:a}this.$2=b};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzPausedStreamSegmentsCountStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.isActive=function(){return!this.$1.isPlaying()};b.getSegmentsCount=function(a,b,c){return this.$2.getNumber("paused_stream_segments_count")};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzPlayheadAtInterruptionDetector",["oz-player/shims/OzDOMEventListener","oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=1;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$OzPlayheadAtInterruptionDetector$p_2=null;e.$OzPlayheadAtInterruptionDetector$p_3=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzPlayheadAtInterruptionDetector$p_4=null;e.$OzPlayheadAtInterruptionDetector$p_1=b;b=d?d.addListener("enterBuffering",function(){e.$OzPlayheadAtInterruptionDetector$p_5()}):c("oz-player/shims/OzDOMEventListener").listenDOMEvent(e.$OzPlayheadAtInterruptionDetector$p_1,"waiting",function(){e.$OzPlayheadAtInterruptionDetector$p_5()});e.$OzPlayheadAtInterruptionDetector$p_3.addSubscriptions(b);e.$OzPlayheadAtInterruptionDetector$p_4=d;return e}var d=b.prototype;d.notifyStreamInterrupted=function(a){this.$OzPlayheadAtInterruptionDetector$p_2=a,this.$OzPlayheadAtInterruptionDetector$p_5()};d.notifyStreamResumed=function(){this.$OzPlayheadAtInterruptionDetector$p_2=null};d.$OzPlayheadAtInterruptionDetector$p_5=function(){if(this.$OzPlayheadAtInterruptionDetector$p_2!=null){var a=this.$OzPlayheadAtInterruptionDetector$p_2||0;Math.abs(this.$OzPlayheadAtInterruptionDetector$p_1.currentTime-a)<h&&this.emit("playheadAtInterruption",a)}};d.destroy=function(){this.$OzPlayheadAtInterruptionDetector$p_3.release(),this.$OzPlayheadAtInterruptionDetector$p_4=null};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzPlayingStatePriorityStrategy",["oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var d;d=a.call(this)||this;d.$OzPlayingStatePriorityStrategy$p_1=new(c("oz-player/shims/OzSubscriptionsHandler"))();d.$OzPlayingStatePriorityStrategy$p_3=function(){d.emit("state_changed")};d.$OzPlayingStatePriorityStrategy$p_2=b;d.$OzPlayingStatePriorityStrategy$p_1.addSubscriptions(d.$OzPlayingStatePriorityStrategy$p_2.addEventListener("playing",d.$OzPlayingStatePriorityStrategy$p_3),d.$OzPlayingStatePriorityStrategy$p_2.addEventListener("play",d.$OzPlayingStatePriorityStrategy$p_3),d.$OzPlayingStatePriorityStrategy$p_2.addEventListener("pause",d.$OzPlayingStatePriorityStrategy$p_3));return d}var d=b.prototype;d.isActive=function(){return!0};d.getName=function(){return"playing_state"};d.setSourceBufferState=function(a){};d.getPriority=function(){return this.$OzPlayingStatePriorityStrategy$p_2.isPlaying()?1:0};d.destroy=function(){this.$OzPlayingStatePriorityStrategy$p_1.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzPositionToViewportPriorityStrategy",["oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$OzPositionToViewportPriorityStrategy$p_3=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzPositionToViewportPriorityStrategy$p_4=function(){e.emit("state_changed")};e.$OzPositionToViewportPriorityStrategy$p_2=b;e.$OzPositionToViewportPriorityStrategy$p_1=d;e.$OzPositionToViewportPriorityStrategy$p_3.addSubscriptions(b.addListener("state_changed",e.$OzPositionToViewportPriorityStrategy$p_4));return e}var d=b.prototype;d.isActive=function(){return!0};d.getName=function(){return"position_to_viewport"};d.setSourceBufferState=function(a){};d.getPriority=function(){var a=this.$OzPositionToViewportPriorityStrategy$p_1.getNumber("prioritize_by_viewport_static_penalty"),b=this.$OzPositionToViewportPriorityStrategy$p_2.getPositionIndexOfVideoFromViewportVertically();return a>0?b===-1?a*-1:0:b===-1?-Infinity:-1*b};d.destroy=function(){this.$OzPositionToViewportPriorityStrategy$p_3.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzPriorityCalculator",["oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var d;d=a.call(this)||this;d.$OzPriorityCalculator$p_2=new(c("oz-player/shims/OzSubscriptionsHandler"))();d.$OzPriorityCalculator$p_1=b;(b=d.$OzPriorityCalculator$p_2).addSubscriptions.apply(b,d.$OzPriorityCalculator$p_1.map(function(a){return a.addListener("state_changed",function(){d.emit("state_changed",d.compute(),a.getName())})}));return d}var d=b.prototype;d.setSourceBufferState=function(a){this.$OzPriorityCalculator$p_1.forEach(function(b){return b.setSourceBufferState(a)}),this.emit("state_changed",this.compute(),"source_buffer")};d.compute=function(){var a=this.$OzPriorityCalculator$p_1.reduce(function(a,b){b=b.isActive()?b.getPriority():0;return a+b},0);return Math.max(a,0)};d.destroy=function(){this.$OzPriorityCalculator$p_2.release()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/strategies/OzSingleCodecRestriction",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var b=a.prototype;b.applyRestriction=function(a){if(a.length<=0)return a.slice();var b=new Set(a.map(function(a){return g(a)})),c="av01",d=b.has(c)?c:b.values().next().value;return d==null?a.slice():a.filter(function(a){return g(a)===d})};return a}();function g(a){return a.getMimeCodecs().replace(/\..*$/,"")}f["default"]=a}),66);
__d("oz-player/strategies/OzStaleManifestBufferTargetStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=b,this.$2=a}var b=a.prototype;b.isActive=function(){return this.$2.getRefreshDate()==null&&this.$1.getNumber("stale_mpd_buffer_ahead_target")>0};b.getBufferTarget=function(){return this.$1.getNumber("stale_mpd_buffer_ahead_target")};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzStartupBufferTargetStrategy",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$3=b}var b=a.prototype;b.isActive=function(){var a=this.$1.isPlaying();a&&(this.$2=!0);return!this.$2};b.getBufferTarget=function(){return this.$3.getNumber("pre_start_buffer_ahead_target")};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzStreamSegmentsCountCalculator",[],(function(a,b,c,d,e,f){"use strict";var g=1;a=function(){function a(a){this.$1=a}var b=a.prototype;b.computeMin=function(a,b,c){var d=Number.MAX_VALUE;for(var e=this.$1,f=Array.isArray(e),h=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(h>=e.length)break;i=e[h++]}else{h=e.next();if(h.done)break;i=h.value}i=i;i.isActive(a)&&(d=Math.min(d,i.getSegmentsCount(a,b,c)))}return d===Number.MAX_VALUE?g:Math.max(d,g)};return a}();f["default"]=a}),66);
__d("oz-player/strategies/OzSupportedMimeCodecsRestriction",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var b=a.prototype;b.applyRestriction=function(a){return a.filter(function(a){a=MediaSource.isTypeSupported(a.getMimeCodecs());return!!a})};return a}();f["default"]=a}),66);
__d("oz-player/streams/OzEndOfStreamWatcher",["oz-player/shims/OzEventEmitter","oz-player/shims/ozvariant"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this)||this;d.$OzEndOfStreamWatcher$p_1=new Map();d.$OzEndOfStreamWatcher$p_4=!1;d.$OzEndOfStreamWatcher$p_2=b;d.$OzEndOfStreamWatcher$p_3=c;return d}var d=b.prototype;d.registerMediaStream=function(a){this.$OzEndOfStreamWatcher$p_1.has(a)&&c("oz-player/shims/ozvariant")(0,5191),this.$OzEndOfStreamWatcher$p_1.set(a,!1)};d.notifyRepresentationSwitched=function(a){this.$OzEndOfStreamWatcher$p_1.has(a)||c("oz-player/shims/ozvariant")(0,5192),this.$OzEndOfStreamWatcher$p_1.get(a)===!0&&this.$OzEndOfStreamWatcher$p_1.set(a,!1),this.$OzEndOfStreamWatcher$p_5("end_of_stream_watcher","representation_switched")};d.notifyMediaStreamEnded=function(a,b){this.$OzEndOfStreamWatcher$p_1.has(a)||c("oz-player/shims/ozvariant")(0,5192),this.$OzEndOfStreamWatcher$p_1.set(a,!0),this.$OzEndOfStreamWatcher$p_5("end_of_stream_watcher","media_stream_ended:"+b)};d.$OzEndOfStreamWatcher$p_5=function(a,b){var c=this;if(this.$OzEndOfStreamWatcher$p_3.getBool("do_not_end_stream")){!this.$OzEndOfStreamWatcher$p_4&&this.$OzEndOfStreamWatcher$p_6()&&(this.$OzEndOfStreamWatcher$p_4=!0,this.emit("streamEnd"));return}var d=this.$OzEndOfStreamWatcher$p_2.getReadyState();d==="open"&&this.$OzEndOfStreamWatcher$p_6()&&this.$OzEndOfStreamWatcher$p_2.notifyEndOfStream(a,b).then(function(){c.emit("streamEnd")})["catch"](function(){c.emit("streamEnd")})};d.$OzEndOfStreamWatcher$p_6=function(){if(this.$OzEndOfStreamWatcher$p_1.size===0)return!1;for(var a=this.$OzEndOfStreamWatcher$p_1.values(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;if(!d)return!1}return!0};d.destroy=function(){this.$OzEndOfStreamWatcher$p_1.clear()};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/streams/OzHandleUserRepresentationSwitch",["oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozReportUnexpectedError","oz-player/utils/OzErrorEmitter"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f,g){var h=this;this.$2=new(c("oz-player/utils/OzErrorEmitter"))();this.$5=null;this.$6=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$1=a;this.$3=b;this.$4=d;this.$7=e;this.$8=g;f.then(function(a){h.$5=a},function(){})["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzHandleUserRepresentationSwitch SBM promise then - create")});this.$6.addSubscriptions(e.addListener("switchRepresentation",function(a,b){h.$9(a,b)}))}var b=a.prototype;b.destroy=function(){this.$6.release(),this.$6.engage()};b.onError=function(a){return this.$2.onError(a)};b.$9=function(a,b){if(a!=="user")return;a=this.$5;if(a==null)return;var d=this.$7.getRepresentationIDAtTime(this.$3.getCurrentTime()),e;for(var f=0;f<this.$4.length;f++)this.$4[f].getID()===d&&(e=this.$4[f]);if(e&&b&&(this.$8||e.getBandwidth()<b.getBandwidth())){d=e.getSegmentByTime(this.$3.getCurrentTime());d&&a.clearRangeWithWait([{fromTime:this.$3.getCurrentTime(),toTime:this.$3.getDuration()}])["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzHandleUserRepresentationSwitch clearRangeWithWait catch")})}};return a}();g["default"]=a}),98);
__d("oz-player/manifests/IOzSegment",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return((a==null?void 0:a.getSequenceNumber())||0)===((b==null?void 0:b.getSequenceNumber())||0)}function b(a,b){return((a==null?void 0:a.getSequenceNumber())||0)>=((b==null?void 0:b.getSequenceNumber())||0)}f.isSequenceNumberEqual=a;f.isSequenceNumberGreaterOrEqual=b}),66);
__d("oz-player/networks/OzReadableStreamDataReader",["oz-player/networks/OzTransformStream","oz-player/utils/ozConcatUint8Arrays"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$OzReadableStreamDataReader$p_1=[];c.$OzReadableStreamDataReader$p_2=b;return c}var d=b.prototype;d.onDataWritten=function(a){this.$OzReadableStreamDataReader$p_1.push(a)};d.onClose=function(){var a=this.$OzReadableStreamDataReader$p_1,b=c("oz-player/utils/ozConcatUint8Arrays")(a);b=b.buffer;a.length=0;this.$OzReadableStreamDataReader$p_2(b)};return b}(c("oz-player/networks/OzTransformStream"));g["default"]=a}),98);
__d("oz-player/networks/OzStreamingTask",["oz-player/loggings/OzLoggingUtils","oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzPerformance","oz-player/utils/OzErrorUtils","oz-player/utils/OzNetworkRequestLoggingUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d){this.$3=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),this.$5=!1,this.$9=null,this.$1=this.$2=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),this.$6=c("oz-player/shims/OzPerformance").now(),this.$7=b,this.$8=a,this.$9=d}var b=a.prototype;b.run=function(){var a=this.$3.getPromise(),b=this.$7;if(b){var e=c("oz-player/shims/OzPerformance").now()-this.$6;d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(a,b,"streaming_task",function(){},function(a){a.setTimeToRequestSent(Math.floor(e))})}this.$2.resolve();return a};b.getPromise=function(){return this.$3.getPromise()};b.cancel=function(){this.$3.getPromise()["catch"](function(){}),this.$3.reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_STREAMING_TASK",description:"task cancelled",extra:{code:"OZ_ST-1"}})),this.$5=!0};b.finish=function(){this.$3.resolve()};b.isCancelled=function(){return this.$5};b.addStreamDeferred=function(a,b){var d=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),e=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));this.$10({createStreamResult:a,changeStatusDeferred:d,createStreamDeferred:e,loggerProviderWithStreamContext:b});b=function(){return e.getPromise()};return{genStream:b,cancel:function(){if(a){var b=a.pausableStream;return b.pauseStream()}},getStatusChangePromise:function(){return d.getPromise()}}};b.$10=function(a){var b=this,e=a.createStreamResult,f=a.changeStatusDeferred,g=a.createStreamDeferred,h=a.loggerProviderWithStreamContext,i=a.loggingPayloads;a=this.$1.getPromise();var j=c("oz-player/shims/OzPerformance").now(),k=this.$1=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));k.getPromise()["catch"](function(){});a.then(function(){if(e){var a=e.pausableStream;e.loggingPayloads&&(i=e.loggingPayloads);g.resolve(a.getStream());b.$4=a;var f=c("oz-player/shims/OzPerformance").now(),k=b.$11(a.startStream());if(h){var l=function(c){var e=i;if(e){d("oz-player/utils/OzNetworkRequestLoggingUtils").setFetchStreamLoggingAttributes(c,e.getRequestUrl(),e.segments,f-j,a.getBytesStreamed(),e.getResponse());var g=b.$9;g&&g(c,e.getRequestUrl(),e.getResponse())}};d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(k,h,"fetch_stream",l,l)}return k}return null}).then(function(a){b.$4=null,k.resolve(),f.resolve(a||"cancelled")})["catch"](function(a){b.$4=null,b.$3.reject(a),k.reject(a),f.reject(a)})};b.$11=function(a){return a.then(function(a){a=a.statusPromise;return a.then(function(a){return a==="stream_done"?"done":"error"})})};return a}();g["default"]=a}),98);
__d("oz-player/scheduling/OzRoundRobinPriorityTaskQueue",["oz-player/shims/ozReportUnexpectedError"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){b===void 0&&(b=-1),this.$3=function(){},this.$4=[],this.$5=new Map(),this.$1=a,this.$2=b}var b=a.prototype;b.getHighestPriority=function(){return Math.max.apply(Math,this.$4.map(function(a){return a.queue.length?a.priority:-Infinity}))};b.enqueue=function(a,b){var d=this;b=b;b=this.$6(b);var e=this.$5.get(a);if(e===b)return;this.$5.has(a)&&this.remove(a);e=this.$7(b);var f=this.$4[e];f&&f.priority===b||(f={priority:b,queue:[]},this.$4.splice(e,0,f));this.$5.set(a,b);f.queue.push(a);a.getPromise().then(function(){d.remove(a)},function(){d.remove(a)})["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzRoundRobinPriorityTaskQueue remove after task run")});this.$3(a,b>=this.$1?"immediate":"normal")};b.updatePriority=function(a,b){if(!this.$5.has(a))return;this.enqueue(a,b)};b.dequeue=function(){for(var a=0;a<this.$4.length;a++){var b=this.$4[a];if(b.queue.length){b=b.queue.shift();this.$5["delete"](b);return b}}return null};b.remove=function(a){var b=this.$5.get(a);if(b!==void 0){b=this.$7(b);b=this.$4[b];if(b&&b.queue){var c=b.queue.findIndex(function(b){return b===a});c>-1&&b.queue.splice(c,1)}this.$5["delete"](a)}};b.setOnTaskUpdated=function(a){this.$3=a};b.clearOnTaskUpdated=function(){this.setOnTaskUpdated(function(){})};b.getLength=function(){return this.$5.size};b.test_isEmpty=function(){return this.$5.size===0&&this.$4.every(function(a){return a.queue.length===0})};b.$7=function(a){a=a;a=this.$6(a);var b;for(b=0;b<this.$4.length;b++)if(a>=this.$4[b].priority)return b;return b};b.$6=function(a){a=a;this.$2>=0&&(a=Number.parseFloat(a.toFixed(this.$2)));return a};return a}();g["default"]=a}),98);
__d("oz-player/scheduling/OzSequentialTaskScheduler",["oz-player/shims/OzMaybeNativePromise","oz-player/shims/ozReportUnexpectedError","oz-player/shims/ozSetTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$3=0;this.$1=a;a=b||{};b=a.taskTimeout;this.$4=b||0}var b=a.prototype;b.start=function(){this.$1.setOnTaskUpdated(this.$5.bind(this));var a=this.$1.dequeue();a&&this.$6(a,"immediate")};b.destroy=function(){this.$2&&this.$2.cancel(),this.$1.clearOnTaskUpdated()};b.$5=function(a,b){b=this.$6(a,b);b&&this.$1.remove(a)};b.$6=function(a,b){var d=this;if(this.$2&&b!=="immediate")return!1;this.$2&&this.$2.cancel();b=a.run()["catch"](function(a){});this.$4>0&&(b=c("oz-player/shims/OzMaybeNativePromise").race([b,new(c("oz-player/shims/OzMaybeNativePromise"))(function(a,b){c("oz-player/shims/ozSetTimeoutAcrossTransitions")(a,d.$4)})]));this.$3++;this.$2=a;b=b.then(function(){d.$3--;d.$2===a&&(d.$2=null);if(d.$3===0){var b=d.$1.dequeue();b&&d.$6(b,"immediate")}});b["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzSequentialTaskScheduler task complete")});return!0};return a}();g["default"]=a}),98);
__d("oz-player/networks/OzStreamingTaskQueueProvider",["oz-player/scheduling/OzRoundRobinPriorityTaskQueue","oz-player/scheduling/OzSequentialTaskScheduler"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map(),i=new Map(),j=2,k=2,l=6e4;function a(a){var b=h.get(a);if(!b){b=new(c("oz-player/scheduling/OzRoundRobinPriorityTaskQueue"))(j,k);var d=new(c("oz-player/scheduling/OzSequentialTaskScheduler"))(b,{taskTimeout:l});h.set(a,b);i.set(a,d);d.start()}return b}g.OZ_QUEUE_MAX_PRIORITY=j;g.getQueue=a}),98);
__d("oz-player/networks/OzStreamingTaskStateManager",["Promise","oz-player/networks/OzStreamingTask","oz-player/networks/OzStreamingTaskQueueProvider","oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=this;this.$3=new(c("oz-player/shims/OzSubscriptionsHandler"))();this.$4=0;this.$9=!1;this.$10=null;var e=a.mimeType,f=a.priorityCalculator,g=a.loggerProvider,h=a.setCustomFetchStreamLoggingAttributes;a=a.config;this.$5=e;this.$1=f;this.$6=d("oz-player/networks/OzStreamingTaskQueueProvider").getQueue(this.$5);this.$7=g;this.$8=a;this.$10=h;this.$3.addSubscriptions(this.$1.addListener("state_changed",function(a,c){b.$11(a,c),b.$2&&b.$6.updatePriority(b.$2,b.$4)}))}var e=a.prototype;e.$12=function(){var a=[];a.push(c("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter")(this.$5));return a};e.startStreamDeferred=function(a){var b=a.debugName,c=a.segments,d=a.networkManager,e=a.segmentsLoggerProvider,f=a.mediaStreamType,g=a.dataAppendedCallback;a=a.dataAppendedErrorCallback;var h=this.$13(e),i=this.$12();c.length>0?d=d.createPausableStream({debugName:b,segments:c,pipeThroughRangeStreamProviders:i,loggerProvider:e,mediaStreamType:f,dataAppendedCallback:g,dataAppendedErrorCallback:a}):d=null;this.$9=!0;b=h.addStreamDeferred(d,e);return{genStream:b.genStream,cancel:b.cancel,getStatusChangePromise:this.$14(b.getStatusChangePromise)}};e.$13=function(a){var b=this.$2;this.$11(this.$1.compute(),"start_stream");!b||b.isCancelled()?(b=this.$2=new(c("oz-player/networks/OzStreamingTask"))(this.$8,a,this.$10),this.$6.enqueue(b,this.$4)):this.$6.updatePriority(b,this.$4);return b};e.$14=function(a){var c=this;return function(){return a().then(function(a){c.$15();return a})["catch"](function(a){c.$15();return(h||(h=b("Promise"))).reject(a)})}};e.finishTaskIfNoOngoingStream=function(){this.$9||this.$16()};e.destroy=function(){this.$3.release();var a=this.$2;this.$2=null;a&&this.$6.remove(a)};e.$15=function(){this.$9=!1,this.$11(this.$1.compute(),"end_stream"),this.$4<d("oz-player/networks/OzStreamingTaskQueueProvider").OZ_QUEUE_MAX_PRIORITY&&this.$16()};e.$16=function(){this.$2&&(this.$2.finish(),this.$2=null)};e.$11=function(a,b){if(a===this.$4)return;this.$4=a;this.$7&&this.$7.getOperationLogger("priority_changed").setPriorityFloat(this.$4).setInitiator(b).log()};return a}();g["default"]=a}),98);
__d("oz-player/strategies/OzStreamLengthStrategy",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d,e){b=b;e=e;var f=a.getNumber("segments_to_stream_under_playhead_threshold");a=a.getNumber("low_segment_stream_playhead_threshold");f>0&&d.getCurrentTime()<a&&(b=f);d=[];d.push(e);for(a=1;a<b;a++){f=c.getSegmentAfter(e);if(!f)break;e=f;d.push(e)}return d}f.getStreamingSegments=a}),66);
__d("oz-player/streams/OzMediaStreamLoopDriver",["oz-player/shims/ozClearTimeout","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var d=this;this.$2=null;this.$3=!1;this.$6=function(){var a;d.$7();if(d.$3)return;(a=d.$5)==null?void 0:a.start();a=d.$1.execute();var b=d.$1.getLoopInterval();b&&(d.$2=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){d.$6()},b));a&&a.then(d.$6)["catch"](function(b){d.$7();var a=d.$1.handleError(b);if(a)d.$2=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(d.$6,a);else{(a=d.$5)==null?void 0:a.setError(b);(a=d.$5)==null?void 0:a.log();d.$5=null;d.$3=!0}})};this.$1=a;this.$4=b}var b=a.prototype;b.start=function(){if(this.$3)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_NOT_IMPLEMENTED_ERROR",description:"restart is not implemented"});this.$5=this.$4.getOperationLogger("media_stream").start();this.$6()};b.stop=function(){var a;this.$7();this.$3=!0;(a=this.$5)==null?void 0:a.log();this.$5=null};b.$7=function(){this.$2&&(c("oz-player/shims/ozClearTimeout")(this.$2),this.$2=null)};return a}();g["default"]=a}),98);
__d("oz-player/utils/OzRangeUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b=b.filter(function(b){return b.startTime<=a&&b.endTime>=a});return b!=null&&b.length>0?b[0]:null}f.getRangeForTime=a}),66);
__d("oz-player/streams/OzSegmentLocator",["oz-player/utils/OzNumericalRangeUtil","oz-player/utils/OzRangeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.getEndingSegment();return a!=null&&a.getSequenceNumber()!=null?a.getSequenceNumber():0}var h=function(a,b){a=a.getCurrentTime();return b?d("oz-player/utils/OzRangeUtils").getRangeForTime(a,b.getBufferedRanges()):null},i=function(a,b,c){b=h(a,b);c=c?c.getTimeRange().endTime:0;a=a.getCurrentTime()||0;c?a=c:b&&(a=b.endTime);return a};b=function(a,b,c,e,f,g,h,j){h=a.getPredictedSegmentAfter(g);if(h&&b.isPlaying())return h;j=i(b,e,g);h=f.getTimeRanges();e=d("oz-player/utils/OzNumericalRangeUtil").findDiffCoveredByRanges(b.getCurrentTime(),j,h.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));if(e>c)return null;g=a.getSegment(0);g&&g.getTimeRange().startTime>j&&(j=g.getTimeRange().startTime);return a.getSegmentByTime(j)};g.getEndingSequenceNumber=a;g.getTimeToQuery=i;g.getSegment=b}),98);
__d("oz-player/streams/OzSegmentUtils",["oz-player/manifests/OzSegmentOptions","oz-player/shims/OzURI"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.reduce(function(a,b){var c;return((c=b==null?void 0:b.getSequenceNumber())!=null?c:0)>((c=a==null?void 0:a.getSequenceNumber())!=null?c:0)?b:a})}function b(a,b){var d=new(c("oz-player/manifests/OzSegmentOptions"))();return a.getPredictedSegmentAfter({getData:function(){return null},getByteRange:function(){return null},getSequenceNumber:function(){return b-1},getTimeRange:function(){return{endTime:0,startTime:0}},getURI:function(){return new(c("oz-player/shims/OzURI"))("")},getOptions:function(){return d}})}function d(a){a.getOptions().setSegmentNumDecisionTime(Date.now());return a}g.getMaxSegment=a;g.getSegmentForSequenceNumber=b;g.markSegmentCreateTime=d}),98);
__d("oz-player/utils/OzTaggedTimeRanges",[],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=a?a:function(a,b){return a===b}}var b=a.prototype;b.add=function(a,b,c){if(b<a)return;if(b===a)return;if(this.$1.length===0){this.$1.push({startTime:a,endTime:b,tag:c});return}var d=0,e=0;for(var f=0;f<this.$1.length;f++){if(a===this.$1[f].startTime&&b===this.$1[f].endTime){d=f;e=f+1;break}a>=this.$1[f].startTime&&(d=f+1);b<=this.$1[f].endTime&&(e=f);if(b<this.$1[f].startTime)break}this.$1.splice(d,e-d,{startTime:a,endTime:b,tag:c});this.$5(d)};b.$5=function(a){a=a;var b=this.$1[a],c=null;a!==0&&(c=this.$1[a-1]);c!==null&&(this.$4(c.tag,b.tag)?c.endTime>=b.startTime&&(this.$1.splice(a-1,2,{startTime:c.startTime,endTime:Math.max(b.endTime,c.endTime),tag:b.tag}),a--):(c.endTime>b.startTime&&c.startTime===b.startTime?(this.$1.splice(a-1,1),a--):c.endTime>b.startTime&&this.$1.splice(a-1,1,{startTime:c.startTime,endTime:b.startTime,tag:c.tag}),c.endTime>b.endTime&&this.$1.splice(a+1,0,{startTime:b.endTime,endTime:c.endTime,tag:c.tag})));c=null;a!==this.$1.length-1&&(c=this.$1[a+1]);c&&(this.$4(c.tag,b.tag)?c.startTime<=b.endTime&&this.$1.splice(a,2,{startTime:b.startTime,endTime:Math.max(c.endTime,b.endTime),tag:b.tag}):c.startTime<=b.endTime&&(c.endTime<b.endTime?(this.$1.splice(a,1,{startTime:b.startTime,endTime:c.startTime,tag:b.tag}),this.$1.push({startTime:c.endTime,endTime:b.endTime,tag:b.tag})):this.$1.splice(a+1,1,{startTime:b.endTime,endTime:c.endTime,tag:c.tag})))};b.get=function(a){var b=a>=this.$3?this.$2:0,c=null;for(b=b;b<this.$1.length;b++)if(this.$1[b].startTime<=a&&a<this.$1[b].endTime){c=b;break}this.$2=c===null?0:c;this.$3=a;return c===null?null:this.$1[c].tag};b.getLength=function(){return this.$1.length};return a}();f["default"]=a}),66);
__d("oz-player/streams/OzMediaStream",["oz-player/manifests/IOzSegment","oz-player/networks/OzNetworkManager","oz-player/networks/OzReadableStreamDataReader","oz-player/networks/OzStreamingTaskStateManager","oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter","oz-player/shims/OzDeferred","oz-player/shims/OzEventEmitter","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzNetworkDiagnostics","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozClearTimeout","oz-player/shims/ozReportUnexpectedError","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/shims/ozvariant","oz-player/strategies/OzStreamLengthStrategy","oz-player/streams/OzMediaStreamLoopDriver","oz-player/streams/OzSegmentLocator","oz-player/streams/OzSegmentUtils","oz-player/utils/OzBufferingUtils","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzMimeUtil","oz-player/utils/OzTaggedTimeRanges"],(function(a,b,c,d,e,f,g){"use strict";var h=1e3,i=.2,j={AUDIO:1,CAPTION:3,VIDEO:0};a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;e.$OzMediaStream$p_2=0;e.$OzMediaStream$p_3=0;e.$OzMediaStream$p_4=null;e.$OzMediaStream$p_13=null;e.$OzMediaStream$p_15=!1;e.$OzMediaStream$p_16=null;e.$OzMediaStream$p_17=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$OzMediaStream$p_19=[];e.$OzMediaStream$p_22=0;e.$OzMediaStream$p_29=!0;e.$OzMediaStream$p_31=!1;e.$OzMediaStream$p_32=null;e.$OzMediaStream$p_33=new(c("oz-player/utils/OzErrorEmitter"))();e.$OzMediaStream$p_35=!0;e.$OzMediaStream$p_38=0;e.$OzMediaStream$p_39=null;e.$OzMediaStream$p_40=null;var f=b.config,g=b.sourceBufferManagerPromise,h=b.networkManager,i=b.playbackState,j=b.endOfStreamWatcher,k=b.bufferTargetCalculator,l=b.priorityCalculator,m=b.streamSegmentsCountCalculator,n=b.abrManager,o=b.representation,p=b.loggerProvider,q=b.segmentLocator,r=b.setCustomFetchStreamLoggingAttributes,s=b.blockedRepresentationsManager,t=b.dynamicVideoLibrary,u=b.shouldAppendOncePerStream,v=b.mediaStreamType,w=b.warningEmitter;b=b.mpd;e.$OzMediaStream$p_1=f;e.$OzMediaStream$p_5=g;e.$OzMediaStream$p_5.then(function(a){e.$OzMediaStream$p_6=a,e.$OzMediaStream$p_16&&e.$OzMediaStream$p_16.setSourceBuffer(a),e.$OzMediaStream$p_27.setSourceBufferState(a.getSourceBufferState()),e.$OzMediaStream$p_47()},function(){})["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzMediaStream SBM promise then - create")});e.$OzMediaStream$p_12=h;e.$OzMediaStream$p_7=i;e.$OzMediaStream$p_14=j;(f=e.$OzMediaStream$p_14)==null?void 0:f.registerMediaStream(babelHelpers.assertThisInitialized(e));e.$OzMediaStream$p_26=k;e.$OzMediaStream$p_27=l;e.$OzMediaStream$p_28=m;e.$OzMediaStream$p_16=n;e.$OzMediaStream$p_18=p.cloneContext();e.$OzMediaStream$p_36=q;e.$OzMediaStream$p_25=new(c("oz-player/utils/OzTaggedTimeRanges"))(function(a,b){return a.id===b.id});e.$OzMediaStream$p_39=r;e.$OzMediaStream$p_40=s;e.$OzMediaStream$p_42=t;e.$OzMediaStream$p_43=u;e.$OzMediaStream$p_44=v;e.$OzMediaStream$p_45=w;e.$OzMediaStream$p_46=b;e.$OzMediaStream$p_17.addSubscriptions(e.$OzMediaStream$p_7.addEventListener("seeking",function(){var a=i.getCurrentTime(),b=null;e.$OzMediaStream$p_1.getBool("ignore_reset_after_seek_if_bufferahead")&&e.$OzMediaStream$p_8.canPredict()&&(e.$OzMediaStream$p_6?d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(a,e.$OzMediaStream$p_6.getSourceBufferState().getBufferedRanges())>0:!1)?b="no_reset_anchor":(b="reset_anchor",e.$OzMediaStream$p_41=Date.now(),e.$OzMediaStream$p_9!=null&&(e.$OzMediaStream$p_48(),e.$OzMediaStream$p_31=!1,e.$OzMediaStream$p_24&&e.$OzMediaStream$p_24.resolve()));e.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_element_event").setInitiator("seeking").setLength(a*1e3).setReason(b).setUserInfo({streamAnchorSegmentNumber:String((a=e.$OzMediaStream$p_9)==null?void 0:a.getSequenceNumber())}).log()}));e.$OzMediaStream$p_40!=null&&e.$OzMediaStream$p_17.addSubscriptions(e.$OzMediaStream$p_40.onRepresentationBlocked(function(a){return e.$OzMediaStream$p_49(a)}));e.$OzMediaStream$p_21=d("oz-player/utils/OzMimeUtil").getMimeType(o.getMimeCodecs());e.$OzMediaStream$p_30=new(c("oz-player/networks/OzStreamingTaskStateManager"))({mimeType:e.$OzMediaStream$p_21,priorityCalculator:e.$OzMediaStream$p_27,loggerProvider:e.$OzMediaStream$p_18,setCustomFetchStreamLoggingAttributes:e.$OzMediaStream$p_39,config:e.$OzMediaStream$p_1});e.$OzMediaStream$p_23=new(c("oz-player/streams/OzMediaStreamLoopDriver"))(babelHelpers.assertThisInitialized(e),e.$OzMediaStream$p_18);e.$OzMediaStream$p_50(o);return e}var e=b.prototype;e.start=function(){this.$OzMediaStream$p_23.start()};e.getCurrentRepresentation=function(){return this.$OzMediaStream$p_8};e.switchRepresentation=function(a,b){b===void 0&&(b=null),this.$OzMediaStream$p_50(a,"user",b)};e.onError=function(a){return this.$OzMediaStream$p_33.onError(a)};e.updateRunTimeConfigs=function(a){var b=a.streamDataHandler;a=a.resetStreamAnchor;b!==void 0&&(this.$OzMediaStream$p_34=b);a===!0&&this.$OzMediaStream$p_8.canApproximateId()&&(this.$OzMediaStream$p_48(),this.$OzMediaStream$p_10=null)};e.$OzMediaStream$p_50=function(a,b,d){var e,f=this;b===void 0&&(b="internal");d===void 0&&(d=null);b==="user"&&this.$OzMediaStream$p_48();(e=this.$OzMediaStream$p_20)==null?void 0:e.remove();this.$OzMediaStream$p_20=null;e=this.$OzMediaStream$p_18.cloneContext().setType(this.$OzMediaStream$p_21+";init");var g=e.cloneContext().setRepresentationID(a.getID()),h=a.getInitSegment(),i=h.getData(),j=e.getOperationLogger("stream_switch").setPreviousRepresentationID(this.$OzMediaStream$p_8?this.$OzMediaStream$p_8.getID():null).setInitiator(b).setRepresentationID(a.getID()).setReason(b==="internal"?this.$OzMediaStream$p_16&&this.$OzMediaStream$p_16.getLastEvaluationReason():b).start();this.$OzMediaStream$p_8=a;e=function(){var a;j.log();f.$OzMediaStream$p_26.handleEvent("append_succeeded");f.emit("initAppended");(a=f.$OzMediaStream$p_14)==null?void 0:a.notifyRepresentationSwitched(f)};var k=function(b){var c;j.setError(b).log();f.$OzMediaStream$p_51(b);(c=f.$OzMediaStream$p_40)==null?void 0:c.handleError(a.getID(),b);if(a.getID()!==f.$OzMediaStream$p_8.getID()){(c=f.$OzMediaStream$p_24)==null?void 0:c.resolve()}};if(i==null){h=this.$OzMediaStream$p_12.request({debugName:"OzMediaStream/init/"+this.$OzMediaStream$p_44,segments:[h],pipeThroughRangeStreamProviders:[c("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter")(this.$OzMediaStream$p_21)],loggerProvider:g,requestOptions:null,mediaStreamType:this.$OzMediaStream$p_44,dataAppendedCallback:e,dataAppendedErrorCallback:k});i=h.getStream()}this.emit("switchRepresentation",b,a);this.$OzMediaStream$p_52({data:i,mimeCodecs:a.getMimeCodecs(),clearSourceBufferRange:d,dataAppendedCallback:e,dataAppendedErrorCallback:k,loggerProvider:g.cloneContext(),appendTarget:0});if(d){h=a.getSegmentByTime(d[0]);if(h){b=this.$OzMediaStream$p_12.request({debugName:"OzMediaStream/startingSegment/"+this.$OzMediaStream$p_44,segments:[h],pipeThroughRangeStreamProviders:[c("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter")(this.$OzMediaStream$p_21)],loggerProvider:g,requestOptions:null,mediaStreamType:this.$OzMediaStream$p_44,dataAppendedCallback:e,dataAppendedErrorCallback:k});i=b.getStream();this.$OzMediaStream$p_52({data:i,mimeCodecs:a.getMimeCodecs(),clearSourceBufferRange:null,dataAppendedCallback:e,dataAppendedErrorCallback:k,loggerProvider:g.cloneContext(),appendTarget:1})}}};e.getLoopInterval=function(){return this.$OzMediaStream$p_22};e.execute=function(){var a=this.$OzMediaStream$p_53();if(a){var b=this.$OzMediaStream$p_24=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise"));a.then(function(){return b.resolve()})["catch"](function(a){return b.reject(a)});return b.getPromise()}return null};e.$OzMediaStream$p_54=function(a){if(this.$OzMediaStream$p_16&&this.$OzMediaStream$p_29&&this.$OzMediaStream$p_15){a=this.$OzMediaStream$p_16.getBestRepresentation(a);if(this.$OzMediaStream$p_8!==a)return a}return null};e.$OzMediaStream$p_55=function(a){var b=this.$OzMediaStream$p_6?this.$OzMediaStream$p_6.getSourceBufferState():null,c=this.$OzMediaStream$p_26.computeBufferTarget();if(c<=0)return null;var e=null;a&&(e=this.$OzMediaStream$p_8.getCustomFieldFirstSegment());if(!e&&this.$OzMediaStream$p_8.canPredict()&&this.$OzMediaStream$p_36!=null){a=this.$OzMediaStream$p_35&&this.$OzMediaStream$p_7.isPlaying();return this.$OzMediaStream$p_36.getSegment(this.$OzMediaStream$p_8,this.$OzMediaStream$p_7,c,b,this.$OzMediaStream$p_9,this.$OzMediaStream$p_10,this.$OzMediaStream$p_1,a,this.$OzMediaStream$p_21)}else{e||(e=d("oz-player/streams/OzSegmentLocator").getSegment(this.$OzMediaStream$p_8,this.$OzMediaStream$p_7,c,b,this.$OzMediaStream$p_8,this.$OzMediaStream$p_9,this.$OzMediaStream$p_1,this.$OzMediaStream$p_32));if(this.$OzMediaStream$p_8.canPredict()){a=this.$OzMediaStream$p_10&&this.$OzMediaStream$p_10.getSequenceNumber()||0;c=e&&e.getSequenceNumber()||0;if(e&&this.$OzMediaStream$p_10&&a>=c){c=d("oz-player/streams/OzSegmentLocator").getEndingSequenceNumber(this.$OzMediaStream$p_8);return(c||0)>=a?this.$OzMediaStream$p_10:null}}}if(!e&&!this.$OzMediaStream$p_56()){c=this.$OzMediaStream$p_8.getEndingSegment();if(c&&this.$OzMediaStream$p_8.isEndingSegment(c)){a=c.getTimeRange().endTime;b=d("oz-player/streams/OzSegmentLocator").getTimeToQuery(this.$OzMediaStream$p_7,b,this.$OzMediaStream$p_9);b>=a&&!this.$OzMediaStream$p_56()&&(e=c)}}return e};e.$OzMediaStream$p_57=function(){return!this.$OzMediaStream$p_15};e.$OzMediaStream$p_58=function(a,b){var e;e=(e=b.fetchSingleSegment)!=null?e:!1;b=(b=b.preventRepresentationSwitch)!=null?b:!1;var f=[];if(e)f=[a];else{e=this.$OzMediaStream$p_28.computeMin(this.$OzMediaStream$p_7,a,this.$OzMediaStream$p_8);f=d("oz-player/strategies/OzStreamLengthStrategy").getStreamingSegments(this.$OzMediaStream$p_1,e,this.$OzMediaStream$p_8,this.$OzMediaStream$p_7,a);f=c("oz-player/networks/OzNetworkManager").getStreamableSegmentsRange(f);if(!b){e=this.$OzMediaStream$p_54(f);if(e){this.$OzMediaStream$p_50(e);a=this.$OzMediaStream$p_55(!1);if(!a)return[];else return this.$OzMediaStream$p_58(a,{fetchSingleSegment:!1,preventRepresentationSwitch:!0})}}}return f};e.$OzMediaStream$p_59=function(){var a=this,b=function(b){b==null?void 0:b.remove(),a.$OzMediaStream$p_20===b&&(a.$OzMediaStream$p_20=null)};b(this.$OzMediaStream$p_20);var d=null;return new(c("oz-player/shims/OzMaybeNativePromise"))(function(c,e){d=a.getCurrentRepresentation().addUpdateListener(function(){b(d),c()}),a.$OzMediaStream$p_20=d})["catch"](function(a){b(d);throw a})};e.$OzMediaStream$p_53=function(){var a=this,b=this.$OzMediaStream$p_6?this.$OzMediaStream$p_6.getSourceBufferState():null;if(this.$OzMediaStream$p_8.canPredict()&&this.$OzMediaStream$p_10&&this.$OzMediaStream$p_8.isEndingSegment(this.$OzMediaStream$p_10)){this.endStream("pdash_ending_segment_had_error");this.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_loop_end").setInitiator("end1").setRepresentationID(this.$OzMediaStream$p_8.getID()).log();return}if(this.$OzMediaStream$p_8.canPredict()&&this.$OzMediaStream$p_9&&this.$OzMediaStream$p_8.isEndingSegment(this.$OzMediaStream$p_9)){this.endStream("pdash_anchor_segment_is_ending_segment");this.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_loop_end").setInitiator("end2").setRepresentationID(this.$OzMediaStream$p_8.getID()).log();return}var e=this.$OzMediaStream$p_57(),f=this.$OzMediaStream$p_55(e);if(this.$OzMediaStream$p_8.canPredict()&&this.$OzMediaStream$p_11!=null&&d("oz-player/manifests/IOzSegment").isSequenceNumberGreaterOrEqual(f,this.$OzMediaStream$p_11)){this.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_loop_end").setInitiator("segment_end").setRepresentationID(this.$OzMediaStream$p_8.getID()).log();return}d("oz-player/manifests/IOzSegment").isSequenceNumberEqual(f,this.$OzMediaStream$p_37)?this.$OzMediaStream$p_38++:this.$OzMediaStream$p_38=0;this.$OzMediaStream$p_37=f;this.$OzMediaStream$p_7.isPlaying()&&this.$OzMediaStream$p_38>0&&this.$OzMediaStream$p_18.cloneContext().getOperationLogger("get_segment_to_stream_same_segment").setReason((f==null?void 0:f.getSequenceNumber())!=null?String(f==null?void 0:f.getSequenceNumber()):null).setLength(this.$OzMediaStream$p_38).setRepresentationID(this.$OzMediaStream$p_8.getID()).setSegmentStartTime(f==null?void 0:f.getTimeRange().startTime).setSegmentEndTime(f==null?void 0:f.getTimeRange().endTime).log();if(this.$OzMediaStream$p_31){var g;this.$OzMediaStream$p_22=h;this.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_loop_end").setInitiator("ongoing_stream").setReason(((g=this.$OzMediaStream$p_9)==null?void 0:g.getSequenceNumber())!=null?String((g=this.$OzMediaStream$p_9)==null?void 0:g.getSequenceNumber()):null).setRepresentationID(this.$OzMediaStream$p_8.getID()).log();return null}if(!f||this.$OzMediaStream$p_31){if(this.$OzMediaStream$p_8.canPredict()&&this.$OzMediaStream$p_1.getBool("ms_promise_for_null")){var i=this.$OzMediaStream$p_1.getNumber("ms_promise_for_null_ms");return new(c("oz-player/shims/OzMaybeNativePromise"))(function(b,d){var e=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){c("oz-player/shims/ozClearTimeout")(e),b()},i?i:(a.$OzMediaStream$p_8.getMaxGopSec()||1)*1e3)})}this.$OzMediaStream$p_22=h;this.$OzMediaStream$p_31||this.$OzMediaStream$p_30.finishTaskIfNoOngoingStream();return this.$OzMediaStream$p_59()}this.$OzMediaStream$p_22=0;var j=this.$OzMediaStream$p_58(f,{fetchSingleSegment:e});if(j.length===0){this.$OzMediaStream$p_18.cloneContext().getOperationLogger("media_loop_end").setInitiator("no_stream_segments").setReason(((g=this.$OzMediaStream$p_9)==null?void 0:g.getSequenceNumber())!=null?String((f=this.$OzMediaStream$p_9)==null?void 0:f.getSequenceNumber()):null).setRepresentationID(this.$OzMediaStream$p_8.getID()).log();return this.$OzMediaStream$p_59()}this.$OzMediaStream$p_15=!0;var k=j[j.length-1]||null,l=this.$OzMediaStream$p_8,m=function(){return l.isEndingSegment(k)};j.length!==0||c("oz-player/shims/ozvariant")(0,23148);g=j[0];f=g.getTimeRange().startTime;var n=k.getTimeRange().endTime,o={startTime:f,endTime:n,tag:{id:this.$OzMediaStream$p_8.getID()}},p=function(b){v.setAppendedBufferMs(Math.round(b.appendedSec*1e3)),v.log(),a.$OzMediaStream$p_26.handleEvent("append_succeeded"),j.forEach(function(b){a.emit("SegmentAppended",a.$OzMediaStream$p_60(b,o))}),m()&&a.endStream("appended_ending_segment"),a.$OzMediaStream$p_61(o,b)},q=function(b){v.setError(b).log();var c=t||s;c&&c.cancel();a.$OzMediaStream$p_51(b)},r=this.$OzMediaStream$p_18.cloneContext();r.setRepresentationID(this.$OzMediaStream$p_8.getID());r.setSegmentStartTime(f).setSegmentEndTime(n);var s,t;!e?(t=this.$OzMediaStream$p_30.startStreamDeferred({debugName:"OzMediaStream/streamableSegments/"+this.$OzMediaStream$p_44,segments:j,networkManager:this.$OzMediaStream$p_12,sourceBufferState:b,playbackState:this.$OzMediaStream$p_7,segmentsLoggerProvider:r.cloneContext(),mediaStreamType:this.$OzMediaStream$p_44,dataAppendedCallback:p,dataAppendedErrorCallback:q}),this.$OzMediaStream$p_13=s):(s=this.$OzMediaStream$p_12.request({debugName:"OzMediaStream/streamableSegments/"+this.$OzMediaStream$p_44+"/prefetch",segments:j,pipeThroughRangeStreamProviders:[c("oz-player/networks/getOzBandwidthEstimatorPipeThroughReporter")(this.$OzMediaStream$p_21)],loggerProvider:r.cloneContext(),requestOptions:null,mediaStreamType:this.$OzMediaStream$p_44,dataAppendedCallback:p,dataAppendedErrorCallback:q}),this.$OzMediaStream$p_13=s);this.$OzMediaStream$p_31=!0;var u=this.$OzMediaStream$p_62(g,k,j.length),v=r.getOperationLogger("queued_append");v.start().setReason(this.$OzMediaStream$p_16&&this.$OzMediaStream$p_16.getLastEvaluationReason());var w=function(c,b){a.$OzMediaStream$p_52({data:c,mimeCodecs:b,clearSourceBufferRange:null,dataAppendedCallback:p,dataAppendedErrorCallback:q,loggerProvider:r.cloneContext(),appendTarget:u})},x;!!t||!!s||c("oz-player/shims/ozvariant")(0,23147);var y=this.$OzMediaStream$p_8.getMimeCodecs();t?(t.genStream().then(function(a){return w(a,y)})["catch"](function(b){return a.$OzMediaStream$p_33.emitError(b)}),x=t.getStatusChangePromise()):s&&(w(s.getStream(),y),x=s.getStatusChangePromise());!x&&c("oz-player/shims/ozvariant")(0,51928);f=x.then(function(b){a.$OzMediaStream$p_63(b,k);return a.$OzMediaStream$p_64()}).then(function(){a.$OzMediaStream$p_2=0});return f["catch"](function(b){var c,d=a.$OzMediaStream$p_9;a.$OzMediaStream$p_65(k);(c=a.$OzMediaStream$p_40)==null?void 0:c.handleError(l.getID(),b);return a.$OzMediaStream$p_66(b,k,d)})};e.handleError=function(a){var b=this.$OzMediaStream$p_18.getOperationLogger("media_stream_loop_error");b.setError(a).setResult("failed").log();return this.$OzMediaStream$p_1.getNumber("loop_body_handle_error_interval_ms")};e.$OzMediaStream$p_66=function(a,b,e){var f=this;this.$OzMediaStream$p_31=!1;var g=new(c("oz-player/shims/OzDeferred"))(c("oz-player/shims/OzMaybeNativePromise")),h=d("oz-player/utils/OzErrorUtils").getNormalizedErrorAndCode(a),i=h[0],j=h[1],k=d("oz-player/utils/OzErrorUtils").getOzErrorWithMIMEType(i,this.$OzMediaStream$p_21),l=function(b){f.$OzMediaStream$p_2++;f.$OzMediaStream$p_18.getOperationLogger("media_stream").setInitiator("fetch_stream_"+(b.behavior!=null?b.behavior:"default")).setLength(b.timeoutMs).setReason(""+k.getDescription()).setError(k).setCode(j.length>0?Number.parseInt(j,10):null).setType(f.$OzMediaStream$p_21).log();if(b.behavior==="retry_failed_request")f.$OzMediaStream$p_9=e;else if(b.behavior==="recover_failed_request"&&d("oz-player/utils/OzErrorUtils").isOzError(a)){var h;h=(h=a.getExtra())==null?void 0:h.headers;h=c("oz-player/shims/OzNetworkDiagnostics").getNextValidSegmentId(h);h!=null&&(f.$OzMediaStream$p_9=d("oz-player/streams/OzSegmentUtils").getSegmentForSequenceNumber(f.$OzMediaStream$p_8,h-1))}c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){f.emit("streamErrorRetry",k);return g.resolve()},b.timeoutMs)};this.$OzMediaStream$p_4!==j?(this.$OzMediaStream$p_4=j,this.$OzMediaStream$p_3=1):this.$OzMediaStream$p_3++;h=!0;var m=function(){h=!1};i={consecutiveFailuresForErrorCode:this.$OzMediaStream$p_3,endStream:function(){m(),f.$OzMediaStream$p_10=b,f.$OzMediaStream$p_11=b,f.endStream("streamError_event_object"),g.resolve()},error:k,isInitialRequest:!1,retry:function(a){var b;m();l({timeoutMs:(b=a==null?void 0:a.waitMs)!=null?b:0,behavior:a==null?void 0:a.behavior})},retryAttemptCount:this.$OzMediaStream$p_2};this.emit("streamError",i);h&&(this.$OzMediaStream$p_33.emitError(k),this.$OzMediaStream$p_2=0,g.resolve());return g.getPromise()};e.$OzMediaStream$p_65=function(a){this.$OzMediaStream$p_48();this.$OzMediaStream$p_10=a;this.$OzMediaStream$p_30.finishTaskIfNoOngoingStream();a=this.$OzMediaStream$p_6;a&&a.cancelOperationAndCleanQueue(this.$OzMediaStream$p_18)};e.$OzMediaStream$p_63=function(a,b){a==="done"&&(this.$OzMediaStream$p_9=b)};e.$OzMediaStream$p_64=function(){this.$OzMediaStream$p_31=!1};e.$OzMediaStream$p_52=function(a){this.$OzMediaStream$p_19.push(a),this.$OzMediaStream$p_6&&this.$OzMediaStream$p_47()};e.$OzMediaStream$p_61=function(a,b){if(a==null)return;this.$OzMediaStream$p_8.canPredict()&&b.startTime_UNSAFE&&b.endTime_UNSAFE?this.$OzMediaStream$p_25.add(b.startTime_UNSAFE,b.endTime_UNSAFE,a.tag):this.$OzMediaStream$p_25.add(a.startTime,a.endTime,a.tag)};e.$OzMediaStream$p_47=function(){var a=this;this.$OzMediaStream$p_19.forEach(function(b){var d=b.data,e=b.mimeCodecs,f=b.clearSourceBufferRange,g=b.dataAppendedCallback,h=b.dataAppendedErrorCallback,i=b.loggerProvider;b=b.appendTarget;d=d instanceof Uint8Array||a.$OzMediaStream$p_34==null?d:d.pipeThrough(new(c("oz-player/networks/OzReadableStreamDataReader"))(a.$OzMediaStream$p_34.bind(a,a.$OzMediaStream$p_8)));a.$OzMediaStream$p_6&&a.$OzMediaStream$p_6.queueData(d,e,f,i,b).then(function(a){if(!a)return;g(a)})["catch"](function(a){h(a)})});this.$OzMediaStream$p_19=[]};e.$OzMediaStream$p_67=function(){var a=this.$OzMediaStream$p_6;if(!a)return c("oz-player/shims/OzMaybeNativePromise").resolve();var b=this.$OzMediaStream$p_7.getCurrentTime(),d=[{fromTime:0,toTime:b}],e=this.$OzMediaStream$p_1.getNumber("clear_buffer_around_playhead_boundary_ms");if(e>0){e=e/1e3;var f=a.getSourceBufferState();f=f.getBufferedRanges();f=f.length>=1?f[f.length-1].endTime:b;d=[{fromTime:0,toTime:Math.max(0,b-e)}];b+e<f&&d.push({fromTime:b+e,toTime:f})}return a.clearRangeWithWait(d)};e.$OzMediaStream$p_68=function(a){return!1};e.$OzMediaStream$p_51=function(a){var b=this;if(d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_SOURCE_BUFFER_QUOTA_EXCEEDED"){this.emit("streamErrorRetry",d("oz-player/utils/OzErrorUtils").getOzErrorWithMIMEType(a,this.$OzMediaStream$p_21));this.$OzMediaStream$p_26.handleEvent("append_quota_exceeded");var e=this.$OzMediaStream$p_67();e.then(function(){b.restartLoopBody()})["catch"](function(a){a=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR",description:"Stream append quota exceeded: "+String(a),extra:{originalError:a,code:c("oz-player/utils/OzCustomErrorCode").STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR}});b.$OzMediaStream$p_33.emitError(a)})}else if(d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_CANCELLED")return;else if(d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_SOURCE_BUFFER_CHANGE_TYPE")this.$OzMediaStream$p_33.emitError(a);else if(d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_SOURCE_BUFFER_CHANGE_TYPE_UNAVAILABLE")this.$OzMediaStream$p_33.emitError(a);else if(this.$OzMediaStream$p_1.getBool("emit_caption_parse_errors_as_warning")&&d("oz-player/utils/OzErrorUtils").isOzError(a)&&a.getType()==="OZ_WEBVTT_CAPTION_PARSE_ERROR"){c("oz-player/shims/ozReportUnexpectedError")(a,"OzMediaStream append error callback: OZ_WEBVTT_CAPTION_PARSE_ERROR branch","warn");(e=this.$OzMediaStream$p_45)==null?void 0:e.emitError(a)}else c("oz-player/shims/ozReportUnexpectedError")(a,"OzMediaStream append error callback","warn"),this.$OzMediaStream$p_68(a)&&this.$OzMediaStream$p_33.emitError(a)};e.$OzMediaStream$p_62=function(a,b,c){var d=0;if(this.$OzMediaStream$p_43)return Infinity;var e=this.$OzMediaStream$p_1.getNumber("appends_per_segment");if(e>0){a=a.getByteRange();b=b.getByteRange();a&&b&&b.endByte!=null&&(d=Math.ceil((b.endByte-a.startByte+1)/(c*e)))}d===0&&(d=this.$OzMediaStream$p_1.getNumber("append_byte_target_without_range"));return d};e.getIsAdaptationEnabled=function(){return this.$OzMediaStream$p_29};e.enableAdaptation=function(){this.$OzMediaStream$p_29=!0};e.disableAdaptation=function(){this.$OzMediaStream$p_29=!1};e.destroy=function(){this.$OzMediaStream$p_23.stop(),this.$OzMediaStream$p_5.then(function(a){a.destroy()},function(){})["catch"](function(a){c("oz-player/shims/ozReportUnexpectedError")(a,"OzMediaStream SBM promise then - destroy")}),this.$OzMediaStream$p_30.destroy(),this.$OzMediaStream$p_17.release(),this.$OzMediaStream$p_17.engage(),this.removeAllListeners(),this.$OzMediaStream$p_20&&(this.$OzMediaStream$p_20.remove(),this.$OzMediaStream$p_20=null)};e.getRepresentationIDAtTime=function(a){var b=this.$OzMediaStream$p_25.get(a);if(!b){var c=this.$OzMediaStream$p_8.getTimeRanges();c=c[c.length-1];var d=.001;c&&a>=c.endTime&&a<=this.$OzMediaStream$p_7.getDuration()+d&&(b=this.$OzMediaStream$p_25.get(c.endTime-d))}return b?b.id:null};e.endStream=function(a){var b;(b=this.$OzMediaStream$p_14)==null?void 0:b.notifyMediaStreamEnded(this,a);this.$OzMediaStream$p_69()};e.endStreamIfBufferedToEndTime=function(){var a=this.$OzMediaStream$p_8.getTimeRanges();if(a.length>0){a=a[a.length-1].endTime;if(this.$OzMediaStream$p_6){var b=this.$OzMediaStream$p_6.getSourceBufferState().getBufferedRanges();b.length>0&&(Math.abs(b[b.length-1].endTime-a)<i&&this.endStream("buffered_to_end_time"))}}};e.$OzMediaStream$p_60=function(a,b){return{type:this.$OzMediaStream$p_21.indexOf("audio")===0?j.AUDIO:this.$OzMediaStream$p_21.indexOf("video")===0?j.VIDEO:j.CAPTION,segment:a,sourceBuffer:(a=(a=this.$OzMediaStream$p_6)==null?void 0:(a=a.getDebug())==null?void 0:a.SourceBuffer)!=null?a:null,timeRange:b}};e.$OzMediaStream$p_48=function(){this.$OzMediaStream$p_9=null};e.restartLoopBody=function(){this.$OzMediaStream$p_48(),this.$OzMediaStream$p_31=!1,this.$OzMediaStream$p_13&&this.$OzMediaStream$p_13.cancel(),this.$OzMediaStream$p_22!==0&&this.$OzMediaStream$p_24&&this.$OzMediaStream$p_24.resolve()};e.$OzMediaStream$p_69=function(){if(this.$OzMediaStream$p_6){var a=this.$OzMediaStream$p_6.getSourceBufferState().getBufferedRanges();a.length>0&&(this.$OzMediaStream$p_32=a[a.length-1].endTime)}};e.$OzMediaStream$p_56=function(){return this.$OzMediaStream$p_32!==null};e.$OzMediaStream$p_49=function(a){this.$OzMediaStream$p_8.getID()===a&&this.$OzMediaStream$p_16!=null&&this.$OzMediaStream$p_50(this.$OzMediaStream$p_16.getBestRepresentation())};e.setEnableLiveheadCatchup=function(a){this.$OzMediaStream$p_35=a};e.clearSourceBufferRange=function(a,b){var d=this.$OzMediaStream$p_6;return d?d.clearRangeWithWait([{fromTime:a,toTime:b}]):c("oz-player/shims/OzMaybeNativePromise").resolve()};e.getDebug=function(){return{SourceBufferManager:this.$OzMediaStream$p_6,MediaStreamAbrManager:this.$OzMediaStream$p_16}};return b}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player/streams/OzPredictedSegmentLocator",["oz-player/streams/OzSegmentLocator","oz-player/streams/OzSegmentUtils","oz-player/utils/OzSourceBufferUtil"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=0;for(var d in a){var e;if(d===b)continue;c=Math.max(c,(e=a[d].lastSkippedToSegmentNumber)!=null?e:0)}return c}function i(a,b){var c=null;for(var d in a){if(d===b)continue;a[d].inBufferAheadTimeSince!=null&&(c=c!=null?Math.min(c,a[d].inBufferAheadTimeSince):a[d].inBufferAheadTimeSince)}return c}a=function(){function a(a){this.$5={};var b=a.videoNode,c=a.liveLatencyManager,d=a.loggerProvider;a=a.dynamicVideoLibrary;this.$1=b;this.$2=c;this.$3=d;this.$4=a}var b=a.prototype;b.getSegment=function(a,b,c,d,e,f,g,h,i){var j;this.$5[i]==null&&(this.$5[i]={lastSkippedToSegmentNumber:null,inBufferAheadTimeSince:null});(j=this.$2)==null?void 0:j.setEnableCatchup(h);j=this.$6(a,b,c,d,e,f,g,h,i);(a=j.segment)==null?void 0:a.getOptions().setSegmentNumDecisionTime(Date.now());j.segment===null&&this.$3.getOperationLogger("segment_locator").setInitiator(j.initiator).setReason(j.reason).setType(i).setUserInfo(j.userInfo).log();b=this.$4;if(j.segment&&b!=null){c=j.segment.getOptions();c.setIsDVLEnabled(b.shouldRequestDynamicInfo(i))}return j.segment};b.$6=function(a,b,c,e,f,g,j,k,l){var m,n=b.getCurrentTime(),o=this.$2==null?!1:this.$2.shouldEnableCursorBasedCatchup(),p=e!=null?d("oz-player/utils/OzSourceBufferUtil").getTotalBufferAheadOfPosition(e.getBufferedRanges(),b.getCurrentTime(),j):{bufferAheadSec:0,bufferedOffset:0},q=p.bufferAheadSec;p=p.bufferedOffset;var r=null,s=null,t=this.$2?this.$2.enabled():!0,u=a.getPredictedSegmentAfter(f),v=d("oz-player/streams/OzSegmentUtils").getSegmentForSequenceNumber(a,j.getNumber("pdash_download_cursor_between_catchups_seg")>0?h(this.$5):h(this.$5,l)),w=!0,x=null;if(o&&k&&((m=u)==null?void 0:m.getSequenceNumber())!=null&&((m=(m=u)==null?void 0:m.getSequenceNumber())!=null?m:0)<=((m=v==null?void 0:v.getSequenceNumber())!=null?m:0)){u=v;r="paired_catchup";this.$3.getOperationLogger("segment_locator").setInitiator(r).setUserInfo({bufferAheadSec:String(q),bufferedOffset:String(p)}).setLength(((m=v==null?void 0:v.getSequenceNumber())!=null?m:0)-((m=(m=u)==null?void 0:m.getSequenceNumber())!=null?m:0)).setType(l).log();w=!1;x=r}else if(o&&k&&t&&u!=null&&((m=this.$2)==null?void 0:m.isBehindPreferredLiveHeadLatencyWithTolerance())){if(this.$2&&q>this.$2.getPreferredLiveHeadLatencySec()&&p==0)return{segment:null,initiator:"catchup_pause",userInfo:{bufferAheadSec:String(q),bufferedOffset:String(p)}};o=a.getEndingSegment();k=d("oz-player/streams/OzSegmentUtils").getMaxSegment([o,u]);m=j.getNumber("pdash_download_cursor_between_catchups_seg")===0||((m=v==null?void 0:v.getSequenceNumber())!=null?m:0)+j.getNumber("pdash_download_cursor_between_catchups_seg")<((v=o==null?void 0:o.getSequenceNumber())!=null?v:0);if(m){if(((o=k==null?void 0:k.getSequenceNumber())!=null?o:0)>((m=(v=u)==null?void 0:v.getSequenceNumber())!=null?m:0)){this.$5[l].lastSkippedToSegmentNumber=(o=k==null?void 0:k.getSequenceNumber())!=null?o:0;this.$3.getOperationLogger("segment_locator").setInitiator("catchup").setUserInfo({bufferAheadSec:String(q),bufferedOffset:String(p)}).setLength(((v=k==null?void 0:k.getSequenceNumber())!=null?v:0)-((o=(m=u)==null?void 0:m.getSequenceNumber())!=null?o:0)).setType(l).log()}u=k;r="catchup";w=!1;x=r}}else if(f==null){u=a.getSegmentByTime(n);r="1st_run";v=a.getTimeRanges();s={approx:String(a.canApproximateId()),ranges:String(v.length),mpdStartTime:v.length>0?String(v[v.length-1].startTime):null,mpdEndTime:v.length>0?String(v[v.length-1].endTime):null};this.$5[l].lastSkippedToSegmentNumber=(o=(m=u)==null?void 0:m.getSequenceNumber())!=null?o:0}w&&(w=t,x="stream_state");if(w&&q>c){this.$5[l].inBufferAheadTimeSince==null&&(this.$5[l].inBufferAheadTimeSince=Date.now());return{segment:null,initiator:"buffer_ahead_rule",userInfo:{bufferAheadSec:String(q),bufferedOffset:String(p),lastMaxSegNum:String(h(this.$5,l)),segment:u?String(u.getSequenceNumber()):null,computedBufferAheadTarget:String(c)}}}else!w&&q>c&&this.$3.getOperationLogger("segment_locator").setUserInfo({bufferAheadSec:String(q),bufferedOffset:String(p),computedBufferAheadTarget:String(c)}).setReason("disabled_buffer_ahead_rule:"+(x||"")).setType(l).log();k=g&&g.getSequenceNumber()||0;f=u&&u.getSequenceNumber()||0;if(u&&g&&k>=f){n=d("oz-player/streams/OzSegmentLocator").getEndingSequenceNumber(a);return(n||0)>=k?{segment:g}:{segment:null,initiator:"mpd_refresh",userInfo:{leSegNum:String(k)}}}v=e?d("oz-player/utils/OzSourceBufferUtil").getTotalInBufferedRanges(e.getBufferedRanges()):0;m=e?d("oz-player/utils/OzSourceBufferUtil").getTotalBufferAheadOfPosition(e.getBufferedRanges(),b.getCurrentTime(),j).bufferAheadSec:0;o=i(this.$5,l);t=Date.now();if(j.getNumber("download_cursor_total_buffer_max_sec")!=0&&j.getNumber("download_cursor_total_buffer_max_sec")<m||j.getNumber("download_cursor_buffer_ahead_time_max_sec")!=0&&o!=null&&j.getNumber("download_cursor_buffer_ahead_time_max_sec")<(t-o)/1e3){this.$5[l].lastSkippedToSegmentNumber=(x=(w=u)==null?void 0:w.getSequenceNumber())!=null?x:0;this.$3.getOperationLogger("segment_locator").setUserInfo({bufferAheadSec:String(q),bufferedOffset:String(p),totalBufferedSec:String(v),computedBufferAheadTarget:String(c),inBufferAheadElapsedTime:String((t-((f=o)!=null?f:0))/1e3)}).setReason("force_paired_catchup").setType(l).log()}this.$5[l].inBufferAheadTimeSince=null;return{segment:u,initiator:r?r:void 0,userInfo:s?s:void 0}};return a}();g.OzPredictedSegmentLocator=a}),98);
__d("oz-player/utils/getRepresentationInCache",["oz-player/networks/RequestParamCreator"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("oz-player/networks/RequestParamCreator"))();function a(a,b){b===void 0&&(b=null);return a.find(function(a){a=a.getInitSegment();var c=a&&a.getByteRange();return a&&c&&b?b.hasCacheValue(h.createRequestParam(a.getURI(),c).uri.toString()):!1})||null}g["default"]=a}),98);
__d("oz-player/Player",["Promise","oz-player/configs/OzPlayerConfig","oz-player/drm/OzDrmManager","oz-player/loggings/OzDevConsolePerfLogger","oz-player/loggings/OzLoggingUtils","oz-player/loggings/OzMultiDestinationPerfLogger","oz-player/loggings/OzOperationLoggerObserver","oz-player/manifests/OzDynamicVideoLibrary","oz-player/manifests/OzVideoRepresentation","oz-player/media_source/MediaSourceManager","oz-player/media_source/OzMediaSeekableRangeManager","oz-player/networks/OzClientClock","oz-player/networks/OzNetworkManager","oz-player/parsers/OzMpdParser","oz-player/parsers/OzMpdUpdater","oz-player/parsers/OzXmlParserImplDOMParser","oz-player/playback_controls/OzClearSourceBufferOnSeekManager","oz-player/playback_controls/OzLiveLatencyManager","oz-player/playback_controls/OzPlaybackTimeRangeManager","oz-player/playback_controls/OzPlayheadManager","oz-player/shims/OzEventEmitter","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzPerformance","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/OzUuid","oz-player/shims/ozClearTimeout","oz-player/shims/ozReportUnexpectedError","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/shims/ozvariant","oz-player/states/OzObservedPlaybackState","oz-player/states/OzPositionToViewport","oz-player/strategies/OzAbrManager","oz-player/strategies/OzBandwidthBoundaryStreamSegmentsCountStrategy","oz-player/strategies/OzBlockedRepresentationsManager","oz-player/strategies/OzBufferAheadPriorityStrategy","oz-player/strategies/OzBufferAheadTargetStrategy","oz-player/strategies/OzBufferEndLimitStrategy","oz-player/strategies/OzBufferTargetBoundedStreamSegmentsCountStrategy","oz-player/strategies/OzBufferTargetCalculator","oz-player/strategies/OzBufferTargetCalculatorQuotaExceededConstraint","oz-player/strategies/OzBufferingDetector","oz-player/strategies/OzPausedStreamSegmentsCountStrategy","oz-player/strategies/OzPlayheadAtInterruptionDetector","oz-player/strategies/OzPlayingStatePriorityStrategy","oz-player/strategies/OzPositionToViewportPriorityStrategy","oz-player/strategies/OzPriorityCalculator","oz-player/strategies/OzSingleCodecRestriction","oz-player/strategies/OzStaleManifestBufferTargetStrategy","oz-player/strategies/OzStartupBufferTargetStrategy","oz-player/strategies/OzStaticStreamSegmentsStrategy","oz-player/strategies/OzStreamSegmentsCountCalculator","oz-player/strategies/OzSupportedMimeCodecsRestriction","oz-player/streams/OzEndOfStreamWatcher","oz-player/streams/OzHandleUserRepresentationSwitch","oz-player/streams/OzMediaStream","oz-player/streams/OzPredictedSegmentLocator","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorEmitter","oz-player/utils/OzErrorUtils","oz-player/utils/OzIbrUtils","oz-player/utils/OzMimeUtil","oz-player/utils/OzMpdUtils","oz-player/utils/OzPlaybackRestrictionsUtils","oz-player/utils/OzReadableStreamUtils","oz-player/utils/getRepresentationInCache"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){a||c("oz-player/shims/ozvariant")(0,21876);return a}var j="av01",k="vp09",l="avc1";a=function(a){babelHelpers.inheritsLoose(e,a);function e(b){var e;e=a.call(this)||this;e.$Player$p_5=new Map();e.$Player$p_6=new Map();e.$Player$p_9=void 0;e.$Player$p_10=new(c("oz-player/shims/OzSubscriptionsHandler"))();e.$Player$p_11=new(c("oz-player/utils/OzErrorEmitter"))();e.$Player$p_12=new(c("oz-player/utils/OzErrorEmitter"))();e.$Player$p_19=void 0;e.$Player$p_25=[];e.$Player$p_26=void 0;e.$Player$p_27=void 0;e.$Player$p_32=null;e.$Player$p_33=null;e.$Player$p_43=null;e.$Player$p_51=!1;e.$Player$p_54=0;e.$Player$p_55=null;e.$Player$p_56=null;e.$Player$p_57=0;e.$Player$p_58=null;e.$Player$p_59=null;e.$Player$p_60=!1;e.$Player$p_63=null;e.$Player$p_64=null;e.$Player$p_70=!1;e.$Player$p_71=!1;e.$Player$p_76=!1;e.$Player$p_87=function(){var a=new(c("oz-player/parsers/OzXmlParserImplDOMParser"))();return a};e.$Player$p_89=function(){e.$Player$p_5.forEach(function(a){return a.endStreamIfBufferedToEndTime()})};e.$Player$p_90=function(){e.$Player$p_5.forEach(function(a){return a.endStream("streamGone")})};var f=b.audioOnly;f=f===void 0?!1:f;var g=b.bufferingDetector,h=b.videoNode,i=b.config,j=b.configMap,k=b.rawMpdXml,l=b.mpdUrl;l=l===void 0?null:l;var m=b.loggerConfig;m=m===void 0?{perfLoggerProviders:[],observedOperationLoggers:[],isOzDevConsoleEnabled:!1}:m;var n=b.customVTTBufferTargetStrategies;n=n===void 0?null:n;var o=b.prefetchCache;o=o===void 0?null:o;var p=b.getOverrideOzRequestImplementation;p=p===void 0?null:p;var q=b.getUserSelectedPlaybackRate,r=b.networkRequestStreamHandlers,s=b.networkRequestStreamRetryHandler,t=b.networkRequestUrlRefreshHandler,u=b.getShouldIncludeCredentials;u=u===void 0?null:u;var v=b.getCustomRequestParametersForURI;v=v===void 0?null:v;var w=b.initialRepresentationIDs;w=w===void 0?[]:w;var x=b.debugCreateInitiator;x=x===void 0?null:x;var y=b.customParsers;y=y===void 0?new Map():y;var z=b.videoPlaybackRestrictions;z=z===void 0?[]:z;var A=b.customSegmentTimelineParser;A=A===void 0?null:A;var B=b.customRepresentationParsers;B=B===void 0?{}:B;var C=b.videoAbrManagerFactory;C=C===void 0?null:C;var D=b.seekHandler;D=D===void 0?null:D;var E=b.initialPlaybackPositionForDynamicMpd;E=E===void 0?-20:E;var F=b.liveheadFallBehindBlockThreshold;F=F===void 0?30:F;var G=b.liveheadFallBehindBlockMargin;G=G===void 0?5.9:G;var H=b.startTimeStamp;H=H===void 0?0:H;var I=b.drmProviders;I=I===void 0?[]:I;var J=b.getVideoDimensions;J=J===void 0?null:J;var K=b.setCustomFetchStreamLoggingAttributes;K=K===void 0?null:K;var L=b.bufferEndLimit;L=L===void 0?null:L;var M=b.configureCustomRequestParametersForSegment;M=M===void 0?null:M;var N=b.isClientTriggeredTraceEnabled;N=N===void 0?!1:N;var O=b.enableImmediateQualityDownSwitch;O=O===void 0?!1:O;b=b.userPreferenceLang;b=b===void 0?null:b;e.$Player$p_75="changeType"in SourceBuffer.prototype;e.$Player$p_1=n;e.$Player$p_49=x;n=m.perfLoggerProviders;x=m.observedOperationLoggers;m=m.isOzDevConsoleEnabled;e.$Player$p_17=m||!1;e.$Player$p_16=new(d("oz-player/loggings/OzMultiDestinationPerfLogger").OzMultiDestinationPerfLoggerProvider)(e.$Player$p_77().concat(n));e.$Player$p_2=f;e.$Player$p_4=(m=i)!=null?m:new(c("oz-player/configs/OzPlayerConfig"))((n=j)!=null?n:{});e.$Player$p_12.onError(function(){});e.$Player$p_22=new(c("oz-player/loggings/OzOperationLoggerObserver"))();e.$Player$p_22.observe(x,e.$Player$p_16);e.$Player$p_16.getOperationLogger("player_initialization").setInitiator("player-"+c("oz-player/shims/OzUuid")()).log();e.$Player$p_53=p;e.$Player$p_28=y;e.$Player$p_67=new(c("oz-player/strategies/OzBlockedRepresentationsManager"))(e.$Player$p_4);e.$Player$p_10.addSubscriptions(e.$Player$p_67.onRepresentationBlocked(function(a){e.emit("representationBlocked",a)}));e.$Player$p_31=[e.$Player$p_67,new(c("oz-player/strategies/OzSupportedMimeCodecsRestriction"))()].concat(z);e.$Player$p_75||e.$Player$p_31.push(new(c("oz-player/strategies/OzSingleCodecRestriction"))());e.$Player$p_29=B;e.$Player$p_30=A;e.$Player$p_35=C;e.$Player$p_36=D;e.$Player$p_37=H;e.$Player$p_38=E;e.$Player$p_41=(f=q)!=null?f:function(){return 1};e.$Player$p_39=F;e.$Player$p_42=G;e.$Player$p_66=L;e.$Player$p_69=N;e.$Player$p_71=O;e.$Player$p_47=I;e.$Player$p_63=K;e.$Player$p_3=h;e.$Player$p_7=new(c("oz-player/media_source/MediaSourceManager"))({videoNode:e.$Player$p_3,config:e.$Player$p_4,perfLoggerProvider:e.$Player$p_16,isChangeTypeSupported:e.$Player$p_75,handleVttCaptionsUpdated:function(a){var b;b=(b=e.$Player$p_5.get("caption"))==null?void 0:(b=b.getCurrentRepresentation())==null?void 0:b.getLang();e.emit("vttCaptionsUpdated",a,b)},onClearVideoNodeError:function(){e.$Player$p_78()},onRetryVideoElementError:function(a){e.emit("videoNodeErrorRetry",a)}});e.$Player$p_7.onError(function(a){e.$Player$p_11.emitError(a)});if(e.$Player$p_4.getBool("clear_on_seek")){i=new(c("oz-player/playback_controls/OzClearSourceBufferOnSeekManager"))(e.$Player$p_3,e.$Player$p_4,e.$Player$p_5,e.$Player$p_16);i.maybeOverwriteVideoCurrentTimeProperty();e.$Player$p_10.addSubscriptions(i.onError(e.$Player$p_11.emitError));e.$Player$p_64=i}e.$Player$p_24=o;m=e.$Player$p_24&&e.$Player$p_24.getCachedRepresentations();e.$Player$p_25=m||w;e.$Player$p_65=new(c("oz-player/manifests/OzDynamicVideoLibrary"))({config:e.$Player$p_4});e.$Player$p_44=r;e.$Player$p_45=u;e.$Player$p_46=v;e.$Player$p_68=M;e.$Player$p_13=new(c("oz-player/networks/OzNetworkManager"))({config:e.$Player$p_4,prefetchCache:e.$Player$p_24,networkRequestStreamHandlers:e.$Player$p_44,getOverrideOzRequestImplementation:e.$Player$p_53,getShouldIncludeCredentials:e.$Player$p_45,getCustomRequestParametersForURI:e.$Player$p_46,networkRequestStreamRetryHandler:s,networkRequestUrlRefreshHandler:t,setCustomFetchStreamLoggingAttributes:e.$Player$p_63,dynamicVideoLibrary:e.$Player$p_65,configureCustomRequestParametersForSegment:e.$Player$p_68,onResourceTimingBufferFull:function(){e.$Player$p_79()}});e.$Player$p_18=l;e.$Player$p_8=k;e.$Player$p_14=new(c("oz-player/states/OzObservedPlaybackState"))(e.$Player$p_4,e.$Player$p_3,e.$Player$p_16);e.$Player$p_52=J;e.$Player$p_15=new(c("oz-player/streams/OzEndOfStreamWatcher"))(e.$Player$p_7,e.$Player$p_4);e.$Player$p_10.addSubscriptions(e.$Player$p_15.addListener("streamEnd",function(){e.$Player$p_51=!0,e.emit("streamEnd")}));e.$Player$p_50=(j=g)!=null?j:e.$Player$p_80();e.$Player$p_4.getNumber("pixels_below_viewport_to_observe")>0&&(e.$Player$p_61=new(c("oz-player/states/OzPositionToViewport"))(e.$Player$p_3,e.$Player$p_4));e.$Player$p_72=b;e.$Player$p_73=null;e.$Player$p_74={lang:null,role:null};return e}var f=e.prototype;f.$Player$p_79=function(){if(this.$Player$p_70)return;c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_JAVASCRIPT_NATIVE",description:"ResourceTiming buffer is full"}),"ResourceTiming buffer is full","warn");this.$Player$p_70=!0};f.$Player$p_81=function(a){var b=this;this.$Player$p_82();var c=d("oz-player/loggings/OzLoggingUtils").executeOperationAndLog(this.$Player$p_16.cloneContext().setInitiator(this.$Player$p_49),"parse_manifest",function(e){var f,g,c=b.$Player$p_83(a);f=String((f=c.getCustomField("currentServerTimeMs"))!=null?f:"");g=String((g=c.getCustomField("lastVideoFrameTs"))!=null?g:"");f={currentServerTimeMs:f,ingestLastVideoFrameTs:g,nowMs:String(Date.now())};g=d("oz-player/utils/OzMpdUtils").getMpdLastTimeRange(c,b.$Player$p_4);g=g&&g.endTime!=0?g.endTime:null;e.setLiveheadPosition(g).setLiveheadSeqNumMpd(d("oz-player/utils/OzMpdUtils").getMpdLastSequenceNumber(c)).setManifestType(c.isStaticMpd()?"static":"dynamic").setIsMixedCodecManifest(b.$Player$p_76).setIsTemplatedManifest(Boolean(c.getCustomField("isLiveTemplated"))).setUserInfo(f);return c});this.$Player$p_84(c)};f.$Player$p_84=function(a){var b=this;this.$Player$p_9=i(a);this.$Player$p_4.getBool("player_emit_mpdparsed_early")&&this.emit("mpdParsed",a);this.$Player$p_26=this.$Player$p_85();this.$Player$p_27=this.$Player$p_86();this.$Player$p_67.setAvailableRepresentationsCount(a.getVideoRepresentations().length);if(this.$Player$p_18!=null){var e=new(c("oz-player/parsers/OzMpdUpdater"))(this.$Player$p_4,a,this.$Player$p_13,this.$Player$p_14,this.$Player$p_16,{mpdUrl:null,createXmlParser:this.$Player$p_87,customParsers:this.$Player$p_28,customRepresentationParsers:this.$Player$p_29,customSegmentTimelineParser:this.$Player$p_30},this.$Player$p_48,this.$Player$p_69);this.$Player$p_88(e);this.$Player$p_10.addSubscriptions(e.onError(this.$Player$p_11.emitError),e.addListener("manifestFetchError",function(a){return b.emit("manifestFetchError",a)}),e.addListener("manifestFetchErrorRetry",function(a){return b.emit("manifestFetchErrorRetry",a)}),e.addListener("streamTransitionToStatic",this.$Player$p_89),e.addListener("streamGone",this.$Player$p_90));e.setupUpdateLoop();this.$Player$p_21=e}this.$Player$p_4.getBool("use_live_latency_manager")?!a.isStaticMpd()?(this.$Player$p_40=new(c("oz-player/playback_controls/OzLiveLatencyManager"))({config:this.$Player$p_4,mpd:a,playbackState:this.$Player$p_14,bufferingDetector:this.$Player$p_50,video:this.$Player$p_3,loggerProvider:this.$Player$p_16,getUserSelectedPlaybackRate:this.$Player$p_41}),this.$Player$p_37=this.$Player$p_40.getPreferredLiveHeadLatencySec()*-1):this.$Player$p_37=this.$Player$p_37:this.$Player$p_37=a.isStaticMpd()?this.$Player$p_37:this.$Player$p_91(a);this.$Player$p_19=new(c("oz-player/playback_controls/OzPlayheadManager"))({video:this.$Player$p_3,mpd:a,dynamicVideoLibrary:this.$Player$p_65,playheadCatchup:this.$Player$p_34,playbackState:this.$Player$p_14,config:this.$Player$p_4,perfLoggerProvider:this.$Player$p_16,seekHandler:this.$Player$p_36,initialPlaybackPosition:this.$Player$p_37,canSupportSkipVideobufferGaps:(e=(e=this.$Player$p_64)==null?void 0:e.getCurrentTimePropertyOverwriteSuccess())!=null?e:!1,liveLatencyManager:this.$Player$p_40});this.$Player$p_20=new(c("oz-player/playback_controls/OzPlaybackTimeRangeManager"))({config:this.$Player$p_4,video:this.$Player$p_3,mpd:a,liveheadFallBehindBlockThreshold:this.$Player$p_39,liveheadFallBehindBlockMargin:this.$Player$p_42,playbackState:this.$Player$p_14,perfLoggerProvider:this.$Player$p_16});this.$Player$p_92()["catch"](function(a){var e=d("oz-player/utils/OzErrorUtils").isOzError(a)?a:null;b.$Player$p_11.emitError(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"Failed to setup streams: "+String(a),extra:babelHelpers["extends"]({},e==null?void 0:e.getExtra(),{originalError:a,code:c("oz-player/utils/OzCustomErrorCode").SETUP_STREAMS_PROMISE_REJECTION.toString()})}))});this.emit("mpdReady",a)};f.load=function(a){var b=this;this.$Player$p_18=a;try{var c=this.$Player$p_8;c!=null?this.$Player$p_81(c):a!=null?this.$Player$p_93(a).then(function(a){if(b.$Player$p_60){b.$Player$p_60=!1;b.load(b.$Player$p_18);return}b.$Player$p_8=a;b.$Player$p_54=0;b.$Player$p_81(a)})["catch"](function(c){if(b.$Player$p_60){b.$Player$p_60=!1;b.load(b.$Player$p_18);return}var e=d("oz-player/utils/OzErrorUtils").isOzError(c)?c:null;e=d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"Failed to setup player with fetched MPD: "+String(c),extra:babelHelpers["extends"]({},e==null?void 0:e.getExtra(),{originalError:c,url:a})});b.$Player$p_94(e,a)}):this.$Player$p_11.emitError(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"Cannot start Oz without a raw mpd xml or mpd url"}))}catch(a){c=d("oz-player/utils/OzErrorUtils").isOzError(a)?a:null;this.$Player$p_11.emitError(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"Failed to setup player: "+String(a),extra:babelHelpers["extends"]({},c==null?void 0:c.getExtra(),{originalError:a})}))}};f.$Player$p_91=function(a){var b;b=(b=a.getVideoRepresentations()[0].getMaxGopSec())!=null?b:0;a=(a=a.getVideoRepresentations()[0].getEndingSegment())==null?void 0:a.getTimeRange();a=a!=null?a.endTime-a.startTime:0;a>0&&(b=a);return Math.min(this.$Player$p_38+this.$Player$p_4.getNumber("dynamic_mpd_initial_playback_position_offset_modifier"),-1*b*this.$Player$p_4.getNumber("pdash_download_cursor_catchup_threshold_gop_multiplier"))};f.$Player$p_93=function(a){this.$Player$p_54++;a=this.$Player$p_13.requestRawUrl({debugName:"OzPlayer/fetchMpdXml/mpd",url:a,options:null,loggerProvider:this.$Player$p_16});a=a.getStream().getReader();return d("oz-player/utils/OzReadableStreamUtils").pumpString(a)};f.$Player$p_95=function(){this.$Player$p_55!=null&&(c("oz-player/shims/ozClearTimeout")(this.$Player$p_55),this.$Player$p_55=null)};f.$Player$p_94=function(a,b){var d=this,e=!0,f=this.$Player$p_54-1,g=a.getExtra().code;this.$Player$p_56!==g?(this.$Player$p_56=g,this.$Player$p_57=1):this.$Player$p_57++;var h=function(){e=!1};g={endStream:function(){h(),d.$Player$p_51=!0,d.emit("streamGoneBeforeStart")},consecutiveFailuresForErrorCode:this.$Player$p_57,error:a,isInitialRequest:!0,retry:function(a){h(),d.$Player$p_95(),d.$Player$p_55=c("oz-player/shims/ozSetTimeoutAcrossTransitions")(function(){d.$Player$p_95(),d.load(b)},(a==null?void 0:a.waitMs)!=null?a==null?void 0:a.waitMs:1e3)},retryAttemptCount:f};this.$Player$p_4.getNumber("initial_manifest_request_retry_count")>0&&this.emit("manifestFetchError",g);e&&this.$Player$p_11.emitError(a)};f.updatePlayerRunTimeConfig=function(a){var b=a.manifestUrl,c=a.audioStreamDataHandler,d=a.videoStreamDataHandler,e=a.applicationStreamDataHandler;a=a.resetStreamAnchor;if(d!==void 0){var f=this.$Player$p_5.get("video");f&&f.updateRunTimeConfigs({streamDataHandler:d})}if(a!==void 0){f=this.$Player$p_5.get("video");f&&f.updateRunTimeConfigs({resetStreamAnchor:a});d=this.$Player$p_5.get("audio");d&&d.updateRunTimeConfigs({resetStreamAnchor:a});(f=this.$Player$p_19)==null?void 0:f.resetCurrentTime()}if(c!==void 0){d=this.$Player$p_5.get("audio");d&&d.updateRunTimeConfigs({streamDataHandler:c})}if(e!==void 0){f=this.$Player$p_5.get("caption");f&&f.updateRunTimeConfigs({streamDataHandler:e,resetStreamAnchor:a})}b!=null&&b!==""&&this.$Player$p_96(b)};f.$Player$p_97=function(a,b){var c=this,e=a.getMimeCodecs();e=this.$Player$p_7.createSourceBufferManager(b+"/"+a.getMimeType()+"/"+a.getCodecs(),e,b,a.getInitSegment().getData());this.$Player$p_98(e,b,a);a=e.then(function(a){c.$Player$p_50&&b!=="caption"&&c.$Player$p_50.setSourceBufferState(b,a.getSourceBufferState());return a});d("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(a,this.$Player$p_16,"source_attach",function(a){a.setType(b)});return a.then(function(a){if(b!=="caption"){var d;(d=c.$Player$p_19)==null?void 0:d.observeSourceBufferState(a.getSourceBufferState(),b)}})};f.isDrm=function(){var a=this.$Player$p_48;if(a!=null){a=a.hasContentProtections();return a!=null?a:!1}return!1};f.$Player$p_82=function(){var a=this.$Player$p_47;if(a.length>0){var b=this.$Player$p_48=new(d("oz-player/drm/OzDrmManager").OzDrmManager)(this.$Player$p_16,this.$Player$p_3,{maxStartEMEAttempts:this.$Player$p_4.getNumber("max_start_eme_attempts"),throwNoLicenseError:!0});a.forEach(function(a){b.addProvider(a)});this.$Player$p_10.addSubscriptions(b.onError(this.$Player$p_11.emitError))}};f.$Player$p_99=function(a){var b=this,d=i(this.$Player$p_9);a=[this.$Player$p_4,a,this.$Player$p_100(),this.$Player$p_31,this.$Player$p_14,window.devicePixelRatio||1,function(){return b.$Player$p_101()},d.isStaticMpd()?"static":"dynamic",this.$Player$p_16];d=this.$Player$p_35&&this.$Player$p_35.apply(this,a);return(d=d)!=null?d:babelHelpers.construct(c("oz-player/strategies/OzAbrManager"),a)};f.$Player$p_102=function(a){return a==="caption"?!0:!1};f.$Player$p_98=function(a,b,e){var f=this,g=i(this.$Player$p_9),h=this.$Player$p_6.get(b),j=new(c("oz-player/streams/OzMediaStream"))({config:this.$Player$p_4,sourceBufferManagerPromise:a,networkManager:this.$Player$p_13,playbackState:this.$Player$p_14,endOfStreamWatcher:b!=="caption"?this.$Player$p_15:null,bufferTargetCalculator:this.$Player$p_103(b),priorityCalculator:this.$Player$p_104(),streamSegmentsCountCalculator:this.$Player$p_105(b),abrManager:h,representation:e,loggerProvider:this.$Player$p_16.cloneContext().setType(b),segmentLocator:this.$Player$p_62,setCustomFetchStreamLoggingAttributes:this.$Player$p_63,blockedRepresentationsManager:this.$Player$p_67,dynamicVideoLibrary:this.$Player$p_65,shouldAppendOncePerStream:this.$Player$p_102(b),mediaStreamType:b,warningEmitter:this.$Player$p_12,mpd:g});this.$Player$p_37===0?j.start():(i(this.$Player$p_9),this.$Player$p_19&&this.$Player$p_10.addSubscriptions(this.$Player$p_19.addListener("initialPlaybackPositionSet",function(){j.start()})));this.$Player$p_10.addSubscriptions(j.onError(this.$Player$p_11.emitError));this.$Player$p_23&&this.$Player$p_10.addSubscriptions(this.$Player$p_23.listenToMediaStreamInitAppended(j));b==="video"&&(this.$Player$p_33=new(c("oz-player/streams/OzHandleUserRepresentationSwitch"))(this.$Player$p_4,this.$Player$p_14,d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(this.$Player$p_31,this.$Player$p_101(),this.$Player$p_100()),j,a,this.$Player$p_71),this.$Player$p_10.addSubscriptions(this.$Player$p_33.onError(this.$Player$p_11.emitError)));this.$Player$p_5.set(b,j);this.$Player$p_10.addSubscriptions(j.addListener("switchRepresentation",function(){var c,a=j.getCurrentRepresentation();(c=f.$Player$p_23)==null?void 0:c.setTimeRangeProvider(a);(c=f.$Player$p_19)==null?void 0:c.setTimeRangeProvider(a);(c=f.$Player$p_20)==null?void 0:c.setTimeRangeProvider(a);b==="video"&&f.emit("switchVideoRepresentation")}),j.addListener("SegmentAppended",function(a){f.$Player$p_106("SegmentAppended",a)}),j.addListener("streamError",function(a){f.emit("streamError",a)}),j.addListener("streamErrorRetry",function(a){f.emit("streamErrorRetry",a)}))};f.$Player$p_107=function(){if(this.$Player$p_66!=null)return[new(c("oz-player/strategies/OzBufferEndLimitStrategy"))(this.$Player$p_3,this.$Player$p_66)];else return[new(c("oz-player/strategies/OzStaleManifestBufferTargetStrategy"))(i(this.$Player$p_9),this.$Player$p_4),new(c("oz-player/strategies/OzStartupBufferTargetStrategy"))(this.$Player$p_14,this.$Player$p_4),new(c("oz-player/strategies/OzBufferAheadTargetStrategy"))(this.$Player$p_4)]};f.$Player$p_108=function(){return this.$Player$p_66==null?[new(c("oz-player/strategies/OzBufferTargetCalculatorQuotaExceededConstraint"))({config:this.$Player$p_4,minimumBufferTargetSec:this.$Player$p_4.getNumber("buffer_target_constraint_minimum_sec")})]:[]};f.$Player$p_109=function(){return this.$Player$p_66==null?[new(c("oz-player/strategies/OzBufferTargetCalculatorQuotaExceededConstraint"))({config:this.$Player$p_4,minimumBufferTargetSec:0})]:[]};f.$Player$p_85=function(){return new(c("oz-player/strategies/OzBufferTargetCalculator"))(this.$Player$p_107(),this.$Player$p_108())};f.$Player$p_86=function(){return this.$Player$p_1!=null?new(c("oz-player/strategies/OzBufferTargetCalculator"))([].concat(this.$Player$p_1,this.$Player$p_107()),this.$Player$p_109()):this.$Player$p_85()};f.$Player$p_103=function(a){var b=a==="caption"?this.$Player$p_27:this.$Player$p_26;b||c("oz-player/shims/ozvariant")(0,76764,a);return b};f.$Player$p_88=function(a){var b=this;if(this.$Player$p_4.getNumber("stream_interrupt_check_mpd_stale_count_threshold")>0){var d=this.$Player$p_50,e=new(c("oz-player/strategies/OzPlayheadAtInterruptionDetector"))(this.$Player$p_3,d);this.$Player$p_10.addSubscriptions(e.addListener("playheadAtInterruption",function(a){b.$Player$p_16.getOperationLogger("stream_interrupted").log(),b.emit("streamInterruptAt",a)}),a.addListener("streamInterruptAt",function(a){var c;(c=b.$Player$p_50)==null?void 0:c.notifyStreamInterrupted();e.notifyStreamInterrupted(a)}),a.addListener("streamResumedAt",function(a){var c;b.$Player$p_16.getOperationLogger("stream_resumed").log();(c=b.$Player$p_50)==null?void 0:c.notifyStreamResumed();e.notifyStreamResumed();b.emit("streamResumedAt",a)}));this.$Player$p_32=e}};f.$Player$p_104=function(){var a=[new(c("oz-player/strategies/OzPlayingStatePriorityStrategy"))(this.$Player$p_14),new(c("oz-player/strategies/OzBufferAheadPriorityStrategy"))(this.$Player$p_4,this.$Player$p_14)].concat(this.$Player$p_4.getNumber("pixels_below_viewport_to_observe")>0&&this.$Player$p_61!=null?new(c("oz-player/strategies/OzPositionToViewportPriorityStrategy"))(this.$Player$p_61,this.$Player$p_4):[]);return new(c("oz-player/strategies/OzPriorityCalculator"))(a)};f.$Player$p_105=function(a){var b=[new(c("oz-player/strategies/OzStaticStreamSegmentsStrategy"))(this.$Player$p_4),new(c("oz-player/strategies/OzBufferTargetBoundedStreamSegmentsCountStrategy"))(this.$Player$p_103(a),this.$Player$p_4)];this.$Player$p_4.getNumber("paused_stream_segments_count")!==0&&b.push(new(c("oz-player/strategies/OzPausedStreamSegmentsCountStrategy"))(this.$Player$p_14,this.$Player$p_4));a==="video"&&b.push(new(c("oz-player/strategies/OzBandwidthBoundaryStreamSegmentsCountStrategy"))(this.$Player$p_4,this.$Player$p_100()));return new(c("oz-player/strategies/OzStreamSegmentsCountCalculator"))(b)};f.onError=function(a){return this.$Player$p_11.onError(a)};f.onWarning=function(a){return this.$Player$p_12.onError(a)};f.getSelectedVideoQuality=function(){var a=this.$Player$p_9;if(!a||this.$Player$p_2)return null;a=this.$Player$p_5.get("video");a=a&&a.getCurrentRepresentation();if(a instanceof c("oz-player/manifests/OzVideoRepresentation"))return a.getDisplayLabel();a=this.$Player$p_100();a=a[0];return a?a.getDisplayLabel():null};f.getTargetAudioTrack=function(){var a=this.$Player$p_9;if(!a)return null;a=this.$Player$p_5.get("audio");a=a&&a.getCurrentRepresentation();if(a){var b;return{id:a.getID(),displayLabel:a.getDisplayLabel(),lang:(b=a.getLang())!=null?b:null,role:a.getRole()}}b=this.$Player$p_110();a=b[0];return a?a.getAudioTrack():null};f.getCurrentPlayingVideoVariant=function(){return this.$Player$p_73};f.getTargetVideoVariant=function(){return this.$Player$p_74};f.switchToVideoQuality=function(a){var b=this.$Player$p_100().find(function(b){return b.getDisplayLabel()===a});if(b){var c=this.$Player$p_5.get("video");c&&(c.switchRepresentation(b),c.disableAdaptation())}};f.switchToVideoVariant=function(a){this.$Player$p_74=a===null?{lang:null,role:null}:a;if(this.$Player$p_74.lang===((a=(a=this.$Player$p_73)==null?void 0:a.lang)!=null?a:null)&&this.$Player$p_74.role===((a=(a=this.$Player$p_73)==null?void 0:a.role)!=null?a:null)){c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SWITCH_VARIANT",description:"switchToVideoVariant switch to the same lang: "+((a=this.$Player$p_74.lang)!=null?a:"default lang")+", same role: "+((a=this.$Player$p_74.role)!=null?a:"default role")}),"switchToVideoVariant switch to the same lang: "+((a=this.$Player$p_74.lang)!=null?a:"default lang")+", same role: "+((a=this.$Player$p_74.role)!=null?a:"default role"),"warn");return}else if(!this.$Player$p_9){c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SWITCH_VARIANT",description:"switchToVideoVariant mpd is void"}),"switchToVideoVariant mpd is void","warn");return}else if(!this.$Player$p_111(this.$Player$p_74.lang)){c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SWITCH_VARIANT",description:"switchToVideoVariant lang not exist in mpd: "+((a=this.$Player$p_74.lang)!=null?a:"default lang")+", same role: "+((a=this.$Player$p_74.role)!=null?a:"default role")}),"switchToVideoVariant lang not exist in mpd: "+((a=this.$Player$p_74.lang)!=null?a:"default lang")+", same role: "+((a=this.$Player$p_74.role)!=null?a:"default role"),"warn");return}this.$Player$p_112();this.$Player$p_4.getBool("enable_lip_sync_abr_select_quality")&&this.$Player$p_4.getBool("enable_alternative_audio_tracks")&&this.$Player$p_75&&this.$Player$p_113();this.$Player$p_73=this.$Player$p_74};f.$Player$p_112=function(){var a=this.$Player$p_110()[0];if(a){var b=this.$Player$p_5.get("audio");b&&(b.switchRepresentation(a,[0,this.$Player$p_14.getDuration()]),b.disableAdaptation())}};f.$Player$p_113=function(){var a=this.$Player$p_5.get("video");if(!a)return;var b=a.getCurrentRepresentation();if(b.getLang()===this.$Player$p_74.lang&&b.getRole()===this.$Player$p_74.role)return;b=this.$Player$p_100();if(b.length===0){c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SWITCH_VARIANT",description:"switchVideoByTargetVariant no representations with target variant: "+JSON.stringify(this.$Player$p_74)}),"switchVideoByTargetVariant no representations with target variant: "+JSON.stringify(this.$Player$p_74),"warn");return}var e=this.$Player$p_6.get("video");e?(e.updateRepresentations(b),e=e.getBestRepresentation()):e=b[0];if(!e){c("oz-player/shims/ozReportUnexpectedError")(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_SWITCH_VARIANT",description:"switchVideoByTargetVariant unable to update representations given target variant: "+JSON.stringify(this.$Player$p_74)}),"switchVideoByTargetVariant unable to update representations given target variant: "+JSON.stringify(this.$Player$p_74));return}a.switchRepresentation(e,[0,this.$Player$p_14.getDuration()]);return};f.getIsVideoQualityAdaptationEnabled=function(){var a=this.$Player$p_5.get("video");return a?a.getIsAdaptationEnabled():!1};f.enableVideoQualityAdaptation=function(){var a=this.$Player$p_5.get("video");a&&a.enableAdaptation()};f.getVideoQualities=function(){var a=this,b=this.$Player$p_9;if(!b)return[];b=this.$Player$p_100().filter(function(b){var c;return!((c=a.$Player$p_67)==null?void 0:c.isBlocked(b.getID()))});var c=b.some(function(a){return d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getCodecs())===j}),e=b.some(function(a){return d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getCodecs())===k});c=c?b.filter(function(a){return d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getCodecs())===j}):e?b.filter(function(a){return d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getCodecs())===k}):b.filter(function(a){return d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getCodecs())===l});return c.sort(function(a,b){return a.getBandwidth()-b.getBandwidth()}).map(function(a){return a.getDisplayLabel()})};f.getVideoTracks=function(){var a=this,b=this.$Player$p_9;return!b?[]:this.$Player$p_100().filter(function(b){var c;return!((c=a.$Player$p_67)==null?void 0:c.isBlocked(b.getID()))}).map(function(a){return{codec:a.getCodecs(),codecFamily:d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(a.getMimeCodecs()),displayLabel:a.getDisplayLabel(),qualityLabel:a.getDisplayLabel(),height:a.getHeight(),id:a.getID(),qualityScoreCurveString:a.getQualityScoreCurveString("csvqm"),width:a.getWidth()}})};f.getAudioTracks=function(){var a=this,b=this.$Player$p_9;return!b?[]:b.getAudioRepresentations().filter(function(b){var c;return!((c=a.$Player$p_67)==null?void 0:c.isBlocked(b.getID()))}).map(function(a){return a.getAudioTrack()})};f.setEnableLiveheadCatchup=function(a){if(this.$Player$p_20){var b;a?this.$Player$p_16.getOperationLogger("live_catchup_enabled").setIsLatencyCachupEnabled(!0).log():this.$Player$p_16.getOperationLogger("live_catchup_disabled").setIsLatencyCachupEnabled(!1).log();(b=this.$Player$p_20)==null?void 0:b.setTimelineBlockingEnabled(a)}this.$Player$p_5.forEach(function(b){b.setEnableLiveheadCatchup(a)});(b=this.$Player$p_19)==null?void 0:b.setEnableLiveheadCatchup(a)};f.$Player$p_92=function(){var a=this;if(this.$Player$p_4.getBool("enable_alternative_audio_tracks")&&this.$Player$p_111(this.$Player$p_72)){var c;this.$Player$p_74=babelHelpers["extends"]({},this.$Player$p_74,{lang:(c=this.$Player$p_72)!=null?c:null,role:this.$Player$p_72!=null?"dub":null})}c=this.$Player$p_100()[0];this.$Player$p_62=c&&c.canPredict()&&this.$Player$p_4.getBool("pdash_use_pdash_segmentlocator")||c&&c.canApproximateId()?new(d("oz-player/streams/OzPredictedSegmentLocator").OzPredictedSegmentLocator)({videoNode:this.$Player$p_3,liveLatencyManager:this.$Player$p_40,loggerProvider:this.$Player$p_16,dynamicVideoLibrary:this.$Player$p_65}):null;c=this.$Player$p_2?[this.$Player$p_114({liveConfigsFromAudioStream:!0}),this.$Player$p_115()]:[this.$Player$p_116(),this.$Player$p_114({liveConfigsFromAudioStream:!1}),this.$Player$p_115()];var e=[];return(h||(h=b("Promise"))).all(c).then(function(){var b=a.$Player$p_5.get("video"),c=a.$Player$p_5.get("audio"),d=a.$Player$p_5.get("caption");b&&e.push(b.getCurrentRepresentation());c&&e.push(c.getCurrentRepresentation());d&&e.push(d.getCurrentRepresentation());e.forEach(function(b){a.$Player$p_10.addSubscriptions(b.addUpdateListener(function(){a.$Player$p_106("SegmentIndexesUpdated",e)}))});a.$Player$p_106("InitialSegmentIndexes",e);a.$Player$p_3&&a.$Player$p_3.style&&(a.$Player$p_3.style.display=a.$Player$p_2?"none":"block");a.$Player$p_73=a.$Player$p_74;a.emit("initialized")})};f.$Player$p_117=function(a){if(!a.getTimeRanges().length){this.$Player$p_16.getOperationLogger("playhead_adjustment").setInitiator("setup_initial_duration").setResult("failed").log();return}a=a.getTimeRanges()[a.getTimeRanges().length-1].endTime;this.$Player$p_7.updateDuration(a,!0)};f.$Player$p_118=function(a){var b;this.$Player$p_23=new(c("oz-player/media_source/OzMediaSeekableRangeManager"))(this.$Player$p_7,this.$Player$p_4);this.$Player$p_117(a);(b=this.$Player$p_23)==null?void 0:b.setTimeRangeProvider(a);(b=this.$Player$p_19)==null?void 0:b.setTimeRangeProvider(a);(b=this.$Player$p_20)==null?void 0:b.setTimeRangeProvider(a)};f.$Player$p_116=function(){var a=this.$Player$p_100();if(!a.length)return c("oz-player/shims/OzMaybeNativePromise").reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"No video representations in the manifest",extra:{code:c("oz-player/utils/OzCustomErrorCode").SETUP_STREAMS_PROMISE_REJECTION.toString()}}));var b=d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(this.$Player$p_31,this.$Player$p_101(),a);if(!b.length){a=a.map(function(a){return a.getDisplayLabel()+"@"+a.getWidth()+"x"+a.getHeight()+"("+a.getMimeCodecs()+")"});return c("oz-player/shims/OzMaybeNativePromise").reject(d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_INITIALIZATION",description:"Restricted all video representations: "+a.join(", "),extra:{code:c("oz-player/utils/OzCustomErrorCode").SETUP_STREAMS_PROMISE_REJECTION.toString()}}))}this.$Player$p_118(b[0]);a=this.$Player$p_119(b);a&&this.$Player$p_4.getBool("enable_abr_logging")&&this.$Player$p_16.getOperationLogger("video_stream_setup_initial_representation_from_prefetch").setResult("success").setReason("player_initialized").setRepresentationID(a.getID()).setPreviousRepresentationID(null).setUserInfo({initialRepresentationIDs:JSON.stringify(this.$Player$p_25)}).setType("video").setInitiator("Player").log();var e=this.$Player$p_99(a||b[0]);this.$Player$p_6.set("video",e);a||(a=e.getBestRepresentation());return this.$Player$p_97(a||b[0],"video")};f.$Player$p_100=function(){var a=this.$Player$p_9;if(!a)return[];var b=a.getVideoRepresentations();if(this.$Player$p_4.getBool("enable_lip_sync_abr_select_quality")&&this.$Player$p_4.getBool("enable_alternative_audio_tracks")&&this.$Player$p_75){var c=a.getVideoRepresentationsByVariant(this.$Player$p_74);b=c.length>0?c:a.getVideoRepresentationsByVariant({lang:null,role:null})}var e=d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(this.$Player$p_31,this.$Player$p_101(),b);return b.filter(function(a){return e.includes(a)})};f.$Player$p_110=function(){var a=this.$Player$p_9;if(!a)return[];return this.$Player$p_4.getBool("enable_alternative_audio_tracks")?a.getAudioRepresentationsByVariant(this.$Player$p_74):a.getAudioRepresentations()};f.$Player$p_111=function(a){var b=this.$Player$p_9;if(!b)return!1;var c=b.getAudioRepresentations();if(a==null)return!0;if(this.$Player$p_4.getBool("enable_alternative_audio_tracks")&&b.isStaticMpd()){b=c.findIndex(function(b){return b.getLang()===a});return b>-1}return!1};f.$Player$p_114=function(a){var b=this;a=a.liveConfigsFromAudioStream;a=a===void 0?!1:a;var d=i(this.$Player$p_9),e=d.getAudioRepresentations();a&&this.$Player$p_118(e[0]);a=-1;this.$Player$p_4.getBool("enable_alternative_audio_tracks")&&e.length>1&&d.isStaticMpd()&&(this.$Player$p_72!=null&&(a=e.findIndex(function(a){return a.getLang()===b.$Player$p_72})));if(e.length){d=a>-1?a:e.findIndex(function(a){return a.getLang()==null&&a.getRole()==null});d=d>-1?d:0;return this.$Player$p_97(a>=0&&a<e.length?e[a]:this.$Player$p_120(e)||e[d],"audio")}return c("oz-player/shims/OzMaybeNativePromise").resolve()};f.$Player$p_115=function(){var a=i(this.$Player$p_9);a=a.getApplicationRepresentations();return a.length?this.$Player$p_97(this.$Player$p_121(a)||a[0],"caption"):c("oz-player/shims/OzMaybeNativePromise").resolve()};f.getMpd=function(){return this.$Player$p_9};f.destroy=function(a){var c,d,e=this;a=this.$Player$p_16.getOperationLogger("unload").setInitiator(a).start();(c=this.$Player$p_64)==null?void 0:c.destroy();this.$Player$p_95();this.$Player$p_5.forEach(function(a){a.destroy()});this.$Player$p_33&&(this.$Player$p_33.destroy(),this.$Player$p_33=null);this.$Player$p_5=new Map();this.$Player$p_10.release();this.$Player$p_10.engage();this.$Player$p_14.destroy();this.$Player$p_19&&this.$Player$p_19.destroy();this.$Player$p_40&&(this.$Player$p_40.destroy(),this.$Player$p_40=null);this.$Player$p_20&&(this.$Player$p_20.destroy(),this.$Player$p_20=null);this.$Player$p_48&&this.$Player$p_48.destroy();this.$Player$p_61&&this.$Player$p_61.destroy();this.$Player$p_13&&this.$Player$p_13.destroy();this.$Player$p_52&&(this.$Player$p_52=null);this.$Player$p_7&&this.$Player$p_7.detach();c=(h||(h=b("Promise"))).resolve();this.$Player$p_3.pause();this.$Player$p_3.removeAttribute("src");this.$Player$p_3.removeAttribute("srcObject");"function"===typeof this.$Player$p_3.setMediaKeys&&(c=this.$Player$p_3.setMediaKeys(null));this.$Player$p_21&&this.$Player$p_21.destroy();this.$Player$p_32&&this.$Player$p_32.destroy();this.$Player$p_22.destroy();(d=this.$Player$p_23)==null?void 0:d.destroy();this.$Player$p_50&&this.$Player$p_50.destroy();this.$Player$p_67&&this.$Player$p_67.destroy();a.log();this.emit("destroyed");d=[c];return h.all(d).then(function(){e.$Player$p_3.load()})};f.$Player$p_119=function(a){var b=this,d=a.find(function(a){return b.$Player$p_25.indexOf(a.getID())!==-1});d||(d=c("oz-player/utils/getRepresentationInCache")(a,this.$Player$p_24));return d||null};f.$Player$p_120=function(a){var b=this,e,f=a.find(function(a){return b.$Player$p_25.indexOf(a.getID())!==-1});f||(f=c("oz-player/utils/getRepresentationInCache")(a,this.$Player$p_24));!f&&!((e=this.$Player$p_9)==null?void 0:e.isStaticMpd())&&a.length>1&&(f=d("oz-player/utils/OzIbrUtils").getInitialAudioRepresentation(a,this.$Player$p_4,this.$Player$p_16));return f||null};f.$Player$p_121=function(a){return null};f.$Player$p_83=function(a){var b=new(c("oz-player/parsers/OzMpdParser"))({config:this.$Player$p_4,ozParserContext:{mpdUrl:this.$Player$p_18,createXmlParser:this.$Player$p_87,customParsers:this.$Player$p_28,customRepresentationParsers:this.$Player$p_29,customSegmentTimelineParser:this.$Player$p_30},networkManager:this.$Player$p_13,perfLoggerProvider:this.$Player$p_16,drmManager:this.$Player$p_48,initialRepresentationIDs:this.$Player$p_25,blockedRepresentationsManager:this.$Player$p_67,enableAlternativeAudioTracks:this.$Player$p_4.getBool("enable_alternative_audio_tracks")});a=b.parse(a);this.$Player$p_10.addSubscriptions(b.onError(this.$Player$p_11.emitError));b=d("oz-player/utils/OzPlaybackRestrictionsUtils").applyVideoPlaybackRestrictions(this.$Player$p_31,this.$Player$p_101(),a.getVideoRepresentations());if(b.length>1){var e=d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(b[0].getMimeCodecs());this.$Player$p_76=!b.reduce(function(a,b){return a&&d("oz-player/utils/OzMimeUtil").getParsedCodecFamily(b.getMimeCodecs())===e},!0)}return a};f.$Player$p_77=function(){var a=[];this.$Player$p_17&&a.push(new(d("oz-player/loggings/OzDevConsolePerfLogger").OzDevConsolePerfLoggerProvider)());return a};f.$Player$p_122=function(a,b){b=this.$Player$p_5.get(b);return b?b.getRepresentationIDAtTime(a):null};f.getAudioRepresentationIDAtTime=function(a){return this.$Player$p_122(a,"audio")};f.getVideoRepresentationIDAtTime=function(a){return this.$Player$p_122(a,"video")};f.getCurrentVideoRepresentation=function(){return this.$Player$p_123("video")};f.getCurrentAudioRepresentation=function(){return this.$Player$p_123("audio")};f.getCurrentPlayingAudioTrackID=function(){var a=this.getCurrentAudioRepresentation();return a==null?void 0:a.getID()};f.$Player$p_123=function(a){var b=this.$Player$p_122(this.$Player$p_14.getCurrentTime(),a),c=this.$Player$p_9;if(!c)return null;c=[];a==="audio"?c=this.$Player$p_110():a==="video"&&(c=this.$Player$p_100());return(a=c.find(function(a){return a.getID()===b}))!=null?a:null};f.getSelectedVideoRepresentation=function(){var a=this.$Player$p_5.get("video");return a!=null?a.getCurrentRepresentation():null};f.getSelectedAudioRepresentation=function(){var a=this.$Player$p_5.get("audio");return a!=null?a.getCurrentRepresentation():null};f.getDebug=function(){var a=this,b=this.$Player$p_5.get("video"),c=this.$Player$p_5.get("audio"),d=this.$Player$p_5.get("caption"),e,f,g,h,j,k,l;if(b){var m;e=(m=b.getDebug())==null?void 0:m.MediaStreamAbrManager;f=(m=b.getDebug())==null?void 0:m.SourceBufferManager;if(f){g=(m=f.getDebug())==null?void 0:m.SourceBuffer}}if(c){h=(m=c.getDebug())==null?void 0:m.SourceBufferManager;if(h){j=(m=h.getDebug())==null?void 0:m.SourceBuffer}}if(d){k=(m=d.getDebug())==null?void 0:m.SourceBufferManager;if(k){l=(m=k.getDebug())==null?void 0:m.SourceBuffer}}return{getManifest:function(){return i(a.$Player$p_9)},DashManifestParsed:this.$Player$p_9,VideoSourceStream:b,VideoAbrManager:e,VideoBufferManager:f,VideoSourceBuffer:g,AudioSourceStream:c,AudioBufferManager:h,AudioSourceBuffer:j,CaptionSourceStream:d,CaptionBufferManager:k,CaptionSourceBuffer:l}};f.injectExternalDebugEvent=function(a,b){this.$Player$p_106(a,b)};f.$Player$p_106=function(a,b){this.emit("debug/dashPlayerEvent",{detail:{type:a,event:b}})};f.$Player$p_80=function(){var a=this,b=new(c("oz-player/strategies/OzBufferingDetector"))(this.$Player$p_3,this.$Player$p_4.getLegacyConfig(),function(){return a.$Player$p_51?a.$Player$p_3.duration:Infinity});b.attachPerfLoggerProvider(this.$Player$p_16);this.$Player$p_10.addSubscriptions(b.addListener("enterBuffering",function(b){a.emit("enterBuffering",b)}),b.addListener("leaveBuffering",function(b){a.emit("leaveBuffering",b)}));return b};f.$Player$p_101=function(){var a=this.$Player$p_52?this.$Player$p_52():{width:this.$Player$p_3.offsetWidth,height:this.$Player$p_3.offsetHeight};return a};f.getMpdUrl=function(){return this.$Player$p_18};f.$Player$p_96=function(a){var b=this;this.$Player$p_18=a;var c=this.$Player$p_9;if(!c){this.$Player$p_60=!0;return}else{c.updateLocation(a);this.$Player$p_43&&(this.$Player$p_10.releaseOne(this.$Player$p_43),this.$Player$p_43=null);a=function(){b.$Player$p_43&&(b.$Player$p_10.releaseOne(b.$Player$p_43),b.$Player$p_43=null),b.$Player$p_5.forEach(function(a,d){var e=a.getCurrentRepresentation(),f=e.getDisplayLabel();e=(d==="video"?b.$Player$p_100():c.getAudioRepresentations()).slice();if(d==="video"){d=b.$Player$p_6.get(d);d&&d.updateRepresentations(b.$Player$p_100())}d=e[0];e.forEach(function(a){var b=a.getDisplayLabel();b===f&&(d=a)});a.switchRepresentation(d);a.restartLoopBody()})};this.$Player$p_43=c.addListener("updated",a);this.$Player$p_10.addSubscriptions(this.$Player$p_43)}};f.getPerfLoggerProvider=function(){return this.$Player$p_16};f.getApproximateFBLSToPlayerDisplayLatency=function(){var a,b;a=Number((a=(a=this.$Player$p_9)==null?void 0:a.getCustomField("lastVideoFrameTs"))!=null?a:void 0);b=Number((b=(b=this.$Player$p_9)==null?void 0:b.getCustomField("currentServerTimeMs"))!=null?b:void 0);var c=this.$Player$p_124(a,b);a=this.$Player$p_125(a,b);return{latencyFromClockSync:a,latencyFromMpdUpdate:c}};f.$Player$p_124=function(a,b){if(!this.$Player$p_14.getCurrentTime()||isNaN(a)||isNaN(b))return null;b=0;this.$Player$p_58===a?b=(c("oz-player/shims/OzPerformance").now()-Number(this.$Player$p_59))/1e3:(this.$Player$p_59=c("oz-player/shims/OzPerformance").now(),this.$Player$p_58=a);a=a/1e3+b-this.$Player$p_14.getCurrentTime();return a};f.$Player$p_125=function(a,b){var d;if(!this.$Player$p_14.getCurrentTime()||isNaN(a)||isNaN(b)||c("oz-player/networks/OzClientClock").getClientClockOffsetMs()==null||!c("oz-player/networks/OzClientClock").getClientClockOffsetMs())return null;d=this.$Player$p_14.getCurrentTimeUpdateTime()+((d=c("oz-player/networks/OzClientClock").getClientClockOffsetMs())!=null?d:0);b=b;var e=this.$Player$p_14.getCurrentTime()*1e3;a=a;d=(d-b-(e-a))/1e3;return d};f.$Player$p_78=function(){this.$Player$p_5.forEach(function(a){a.restartLoopBody();var b=a.getCurrentRepresentation();a.switchRepresentation(b)})};return e}(c("oz-player/shims/OzEventEmitter"));g["default"]=a}),98);
__d("oz-player",["oz-player/Player"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/Player")}),98);/*FB_PKG_DELIM*/
__d("ArmadilloReceiveWriteDbSuccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5721");b=d("FalcoLoggerInternal").create("armadillo_receive_write_db_success",a);e=b;g["default"]=e}),98);
__d("EBAPIQPLPoints",[],(function(a,b,c,d,e,f){"use strict";a={GRAPHQL_QUERY_END:"graphql_query_end",GRAPHQL_QUERY_START:"graphql_query_start"};f.EBMessageMetadataQPLPoints=a}),66);
__d("EBFormatUtils",["I64","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(a!=null)return(h||(h=d("I64"))).min(a,h.of_float(d("WATimeUtils").millisTime()));switch(b){case"before":return(h||(h=d("I64"))).of_float(d("WATimeUtils").millisTime());case"after":return(h||(h=d("I64"))).zero;default:b;return(h||(h=d("I64"))).max_int}}function b(a,b){switch(b){case"before":return[a,0];case"after":return[0,a];default:b;return[Math.ceil(a/2),Math.ceil(a/2)]}}g.adjustTs=a;g.adjustCount=b}),98);
__d("LSIssueNewEbTaskAndGetTaskIDV2",["LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),a[0],a[1],a[2],void 0,void 0,c.i64.cast([0,0]),a[3],a[4],void 0,a[5],a[7]).then(function(a){return a=a,d[0]=a[0],a})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueNewEbTaskAndGetTaskIDV2StoredProcedure";e.exports=a}),null);
__d("LSIssuePointQueryRestoreTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSLogWebQpl.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] Beginning execution."),c.sequence([function(d){return a[3]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[3],c.i64.cast([0,2512]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[11],c.i64.cast([0,3]))):c.resolve()}])},function(e){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] Point query restore v2 is enabled"),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(e){return d[9]=new c.Map(),d[9].set("error_code",c.i64.cast([0,1])),d[9].set("error_message",""),d[9].set("stored_procedure","issuePointQueryRestoreTask"),d[10]=new c.Map(),d[10].set("act_thread_id",a[0]),d[11]=new c.Map(),d[11].set("restore_context",d[10]),d[11].set("failure",d[9]),d[12]=d[11].get("restore_context"),d[11],d[13]=d[11].get("success"),d[11],d[13]!==void 0?(d[19]=d[13].get("message_id"),d[13],d[14]=d[19]):d[14]="",d[15]=d[12].get("act_thread_id"),d[12],d[16]=":",d[17]=c.toJSON(d[11]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",d[16],d[15],d[16],d[14]].join(""),c.i64.cast([0,50035]),d[17],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[18]=a[0],a})},function(a){return d[1]=d[18]}]):(f=e.item,c.sequence([function(a){return d[16]=f.deviceId,d[15]=f.backupTenancy,d[14]=f.encryptionVersion,d[9]=void 0,c.i64.neq(d[9],void 0)?c.resolve(d[10]=d[9]):c.sequence([function(a){return d[17]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[18]=a[0],a})},function(a){return d[18]?d[27]=(d[17].push(c.i64.cast([0,0])),d[17]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[27]=(d[17].push(c.i64.cast([0,2])),d[17]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[27]=(d[17].push(c.i64.cast([0,3])),d[17]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[27]=(d[17].push(c.i64.cast([0,4])),d[17]):0,d[22]=c.createArray(),d[23]=c.i64.of_int32(d[17].length),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(a){return d[27]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[17],d[27]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],a})},function(a){return d[30]=(d[22].push(d[28]),d[22])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[27]=c.createArray(),d[28]=c.i64.of_int32(d[22].length),c.i64.gt(d[28],c.i64.cast([0,0]))?c.loopAsync(d[28],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[22],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=(d[27].push(c.i64.to_string(d[31])),d[27])}])}):c.resolve()},function(a){return d[29]=d[27].join(","),d[24]=d[29]}])},function(a){return d[22].some(function(a){return c.i64.eq(d[14],a)})?d[25]=d[14]:d[25]=void 0,c.i64.neq(d[25],void 0)?d[26]=d[25]:d[26]=void 0,d[10]=d[26]}])},function(e){return c.i64.neq(d[10],void 0)?d[11]=d[10]:d[11]=c.i64.cast([0,0]),c.i64.neq(d[15],void 0)?d[12]=d[15]:d[12]=c.i64.cast([0,1]),c.i64.neq(d[16],void 0)?c.sequence([function(e){return d[17]=new c.Map(),d[17].set("act_thread_id",a[0]),d[17].set("request_id",a[3]),d[17].set("tam_thread_subtype",c.i64.cast([0,0])),d[17].set("source",a[4]),c.nativeOperation(b("LSBase64Encode.nop"),f.ocmfClientStateBlob).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.mailboxRootKeyBlob).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[20]=new c.Map(),d[20].set("ocmf_client_state_blob",d[18]==null?"":d[18]),d[20].set("mailbox_root_key",d[19]==null?"":d[19]),d[21]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[36]=(d[21].push(a.epochId),d[21])})},function(a){return d[34]="Queried locally available epochs. Count: ",d[22]=c.i64.of_int32(d[21].length),d[35]=c.i64.to_string(d[22]),d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[23],d[34],d[23],d[35]].join("")),c.resolve()},function(e){return d[24]=new c.Map(),d[24].set("device_id",d[16]),d[24].set("raw_tokens",d[20]),d[24].set("locally_available_epochs",d[21]),d[25]=new c.Map(),d[25].set("reference_timestamp",a[2]),d[25].set("device_context",d[24]),d[25].set("message_id",a[1]),d[26]=new c.Map(),d[26].set("restore_context",d[17]),d[26].set("success",d[25]),d[27]=d[26].get("restore_context"),d[26],d[28]=d[26].get("success"),d[26],d[28]!==void 0?(d[36]=d[28].get("message_id"),d[28],d[29]=d[36]):d[29]="",d[30]=d[27].get("act_thread_id"),d[27],d[31]=":",d[32]=c.toJSON(d[26]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",d[31],d[30],d[31],d[29]].join(""),c.i64.cast([0,50035]),d[32],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[13]=d[33]}]):c.sequence([function(e){return d[17]=new c.Map(),d[17].set("error_code",c.i64.cast([0,1])),d[17].set("error_message",""),d[17].set("stored_procedure","issuePointQueryRestoreTask"),d[18]=new c.Map(),d[18].set("act_thread_id",a[0]),d[19]=new c.Map(),d[19].set("restore_context",d[18]),d[19].set("failure",d[17]),d[20]=d[19].get("restore_context"),d[19],d[21]=d[19].get("success"),d[19],d[21]!==void 0?(d[27]=d[21].get("message_id"),d[21],d[22]=d[27]):d[22]="",d[23]=d[20].get("act_thread_id"),d[20],d[24]=":",d[25]=c.toJSON(d[19]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",d[24],d[23],d[24],d[22]].join(""),c.i64.cast([0,50035]),d[25],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[13]=d[26]}])},function(a){return d[1]=d[13]}]))})},function(d){return a[3]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),a[3],c.i64.cast([0,521476165]),"restore_task_start",c.i64.cast([0,1]),a[4],void 0):c.resolve()},function(e){return c.sequence([function(d){return a[3]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[3],c.i64.cast([0,2513]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[11],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[1]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure";e.exports=a}),null);
__d("LSIssuePointQueryRestoreTaskStoredProcedure",["LSIssuePointQueryRestoreTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadId;d[1]=b.messageId;d[2]=b.startSortKey;d[3]=b.traceId;d[4]=b.source;return c("LSIssuePointQueryRestoreTask").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("EBLSMessagePointQuery",["I64","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","LSIssuePointQueryRestoreTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWMessageReceiveReliabilityLogger","MWEncryptedBackUpEBNotEnabledError","QPLUserFlow","WAGetStorageQplAnnotations","WAHashStringToNumber","WAPushSafeTypes","WAResultOrError","asyncToGeneratorRuntime","cr:10036","err","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(b("cr:10036")==null)throw c("err")("Calling EBLS without EBLS being available for message range query");a=d("WAPushSafeTypes").unsafeNotNullable(a);var e=a.chatJid,f=a.messageId,g=a.startSortKey,j=a.taskSource,k=a.threadId;yield b("cr:10036").init();a=(yield b("cr:10036").getLSStorage());var l=(yield d("MAWEncryptedBackupUtils").getBackupTenancy(a.tables));if(l!=null&&!(h||(h=d("I64"))).equal(l,(i||(i=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return d("WAResultOrError").makeError(d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED);l=d("WAHashStringToNumber").hashStringToNumber(f);var m=l.toString(),n=j===c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES?c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES:c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT;n===c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES&&(c("QPLUserFlow").start(c("qpl")._(1056840931,"814"),{instanceKey:l,timeoutInMs:d("MAWMessageReceiveReliabilityLogger").RECEIVE_RELIABILITY_TIMEOUT}),c("promiseDone")(d("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(c("qpl")._(1056840931,"814"),a)})),c("QPLUserFlow").addPoint(c("qpl")._(1056840931,"814"),"eb_point_restore_begin",{data:{"int":{msgId:l},string:{jid:e}},instanceKey:l}));d("MAWEBRestoreTrackingUtils").markEBRestorePoint(n,m,"LS_WORKER");return a.runInTransaction(function(a){return c("LSIssuePointQueryRestoreTaskStoredProcedure")(c("LSFactory")(a),{messageId:f,source:(i||(i=d("LSIntEnum"))).ofNumber(n),startSortKey:g,threadId:k,traceId:m})},"readwrite").then(function(){return d("WAResultOrError").makeResult()})});return j.apply(this,arguments)}g.messagePointQuery=a}),98);
__d("LSEncryptedBackupsMessagesRangeQueryDirection",[],(function(a,b,c,d,e,f){a=Object.freeze({BEFORE:1,AFTER:2});f["default"]=a}),66);
__d("LSLoadThreadPkFromThreadId",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadThreadPkFromThreadId] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(173).fetch(),function(b){return c.i64.to_string(b.jid)===a[0]}).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,100])),d[13].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[13].set("error_message",""),e=[void 0,d[13]],d[2]=e[0],d[3]=e[1],e):(b=a.item,e=[b.clientThreadPk,void 0],d[2]=e[0],d[3]=e[1],e)})},function(a){return c.i64.neq(d[2],void 0)?(a=[d[2],d[3]],d[5]=a[0],d[6]=a[1],a):(d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,7])),d[13].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[13].set("error_message",""),c.i64.neq(void 0,void 0)?(a=[void 0,d[13]],d[14]=a[0],d[15]=a[1],a):(d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,100])),d[16].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[16].set("error_message",""),a=[void 0,d[16]],d[14]=a[0],d[15]=a[1],a),a=[d[14],d[15]],d[5]=a[0],d[6]=a[1],a),d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadThreadPkFromThreadId] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadThreadPkFromThreadId",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure";e.exports=a}),null);
__d("LSIssueMessageRangeQueryTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSFlushDataTrace.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] Beginning execution."),d[6]=c.i64.gt(a[1],c.i64.cast([0,0]))&&c.i64.gt(a[5],c.i64.cast([0,0])),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(e){return d[6]?(d[12]=new c.Map(),d[12].set("error_code",c.i64.cast([0,1])),d[12].set("error_message",""),d[12].set("stored_procedure","issueMessageRangeQueryTask"),d[13]=new c.Map(),d[13].set("act_thread_id",a[0]),d[14]=new c.Map(),d[14].set("restore_context",d[13]),d[14].set("failure",d[12]),d[15]=d[14].get("restore_context"),d[14],d[16]=d[15].get("act_thread_id"),d[15],d[17]=c.toJSON(d[14]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[16]].join(""),c.i64.cast([0,50031]),d[17],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[18]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[12]=void 0:(f=e.item,c.sequence([function(a){return d[28]=f.deviceId,d[27]=f.backupTenancy,d[26]=f.encryptionVersion,d[21]=void 0,c.i64.neq(d[21],void 0)?c.resolve(d[22]=d[21]):c.sequence([function(a){return d[29]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[39]=(d[29].push(c.i64.cast([0,0])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[31]=a[0],a})},function(a){return d[31]?d[39]=(d[29].push(c.i64.cast([0,2])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[39]=(d[29].push(c.i64.cast([0,3])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[33]?d[39]=(d[29].push(c.i64.cast([0,4])),d[29]):0,d[34]=c.createArray(),d[35]=c.i64.of_int32(d[29].length),c.i64.gt(d[35],c.i64.cast([0,0]))?c.loopAsync(d[35],function(a){return d[39]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],d[39]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],a})},function(a){return d[42]=(d[34].push(d[40]),d[34])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[39]=c.createArray(),d[40]=c.i64.of_int32(d[34].length),c.i64.gt(d[40],c.i64.cast([0,0]))?c.loopAsync(d[40],function(a){return d[42]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[34],d[42]).then(function(a){return a=a,d[43]=a[0],d[44]=a[1],a})},function(a){return d[45]=(d[39].push(c.i64.to_string(d[43])),d[39])}])}):c.resolve()},function(a){return d[41]=d[39].join(","),d[36]=d[41]}])},function(a){return d[34].some(function(a){return c.i64.eq(d[26],a)})?d[37]=d[26]:d[37]=void 0,c.i64.neq(d[37],void 0)?d[38]=d[37]:d[38]=void 0,d[22]=d[38]}])},function(a){return c.i64.neq(d[22],void 0)?d[23]=d[22]:d[23]=c.i64.cast([0,0]),c.i64.neq(d[27],void 0)?d[24]=d[27]:d[24]=c.i64.cast([0,1]),c.i64.neq(d[28],void 0)?d[25]=d[28]:d[25]=void 0,d[12]=d[25]}]))})},function(e){return d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,1])),d[14].set("error_message",void 0==null?"":void 0),d[14].set("stored_procedure","issueMessageRangeQueryTask"),d[15]=new c.Map(),d[15].set("act_thread_id",a[0]),d[15].set("source",a[6]),d[15].set("restore_operation_type",c.i64.cast([0,2])),d[15].set("request_id",a[4]),d[15].set("device_id",d[12]),d[16]=new c.Map(),d[16].set("restore_context",d[15]),d[16].set("failure",d[14]),d[17]=d[16].get("queue_name"),d[16],d[17]!==void 0?d[18]=d[17]:(d[21]=d[16].get("restore_context"),d[16],d[22]=d[21].get("act_thread_id"),d[21],d[18]=["encrypted_backups_restore",":",d[22]].join("")),d[19]=c.toJSON(d[16]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[18],c.i64.cast([0,50030]),d[19],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],a})}])},function(e){return d[11]="backup not found",d[11]!==void 0?c.sequence([function(e){return d[13]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[11]].join(""),function(a){c.logger(a).mustfix(a)}(d[13]),d[12]=c.createArray(),a[4]!==void 0?d[14]=(d[12].push(a[4]),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[11],d[12],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[13],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[16]=a[0],a})},function(a){return d[16]?d[17]=!0:d[17]=!1,d[17]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]=c.createArray(),void 0!==void 0?d[19]=(d[18].push(void 0),d[18]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[18],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!0:d[15]=!1,d[15]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[16],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!0:d[15]=!1,d[15]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[16],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[12]=a[0],a})},function(a){return d[12]?d[13]=!0:d[13]=!1,d[13]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[14],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[10]=c.i64.cast([0,5]):d[10]=c.i64.cast([0,2]),d[1]=!1}]):(f=e.item,c.sequence([function(a){return d[19]=f.mailboxRootKeyBlob,d[18]=f.ocmfClientStateBlob,d[17]=f.deviceId,d[16]=f.backupTenancy,d[15]=f.encryptionVersion,d[10]=void 0,c.i64.neq(d[10],void 0)?c.resolve(d[11]=d[10]):c.sequence([function(a){return d[20]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[30]=(d[20].push(c.i64.cast([0,0])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[30]=(d[20].push(c.i64.cast([0,2])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[30]=(d[20].push(c.i64.cast([0,3])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[30]=(d[20].push(c.i64.cast([0,4])),d[20]):0,d[25]=c.createArray(),d[26]=c.i64.of_int32(d[20].length),c.i64.gt(d[26],c.i64.cast([0,0]))?c.loopAsync(d[26],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=(d[25].push(d[31]),d[25])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[30]=c.createArray(),d[31]=c.i64.of_int32(d[25].length),c.i64.gt(d[31],c.i64.cast([0,0]))?c.loopAsync(d[31],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[36]=(d[30].push(c.i64.to_string(d[34])),d[30])}])}):c.resolve()},function(a){return d[32]=d[30].join(","),d[27]=d[32]}])},function(a){return d[25].some(function(a){return c.i64.eq(d[15],a)})?d[28]=d[15]:d[28]=void 0,c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=void 0,d[11]=d[29]}])},function(e){return c.i64.neq(d[11],void 0)?d[12]=d[11]:d[12]=c.i64.cast([0,0]),c.i64.neq(d[16],void 0)?d[13]=d[16]:d[13]=c.i64.cast([0,1]),c.i64.neq(d[17],void 0)?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[0]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(e){return c.i64.neq(d[20],void 0)?d[6]?c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),d[23]=new c.Map(),d[23].set("act_thread_id",a[0]),d[23].set("tam_thread_subtype",d[22]),d[23].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[26]=new c.Map(),d[26].set("ocmf_client_state_blob",d[24]==null?"":d[24]),d[26].set("mailbox_root_key",d[25]==null?"":d[25]),d[27]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[39]=(d[27].push(a.epochId),d[27])})},function(a){return d[37]="Queried locally available epochs. Count: ",d[28]=c.i64.of_int32(d[27].length),d[38]=c.i64.to_string(d[28]),d[29]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[29],d[37],d[29],d[38]].join("")),c.resolve()},function(e){return d[30]=new c.Map(),d[30].set("device_id",d[17]),d[30].set("raw_tokens",d[26]),d[30].set("locally_available_epochs",d[27]),d[31]=new c.Map(),d[31].set("reference_timestamp",a[2]),d[31].set("server_thread_key",void 0),d[31].set("device_context",d[30]),d[31].set("source",a[6]),d[32]=new c.Map(),d[32].set("restore_context",d[23]),d[32].set("success",d[31]),d[33]=d[32].get("restore_context"),d[32],d[34]=d[33].get("act_thread_id"),d[33],d[35]=c.toJSON(d[32]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[34]].join(""),c.i64.cast([0,50031]),d[35],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[36]=a[0],a})}]):c.i64.gt(a[1],c.i64.cast([0,0]))?c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),a[7]===!0?d[23]=!0:d[23]=!1,d[24]=new c.Map(),d[24].set("act_thread_id",a[0]),d[24].set("request_id",a[4]),d[24].set("tam_thread_subtype",d[22]),d[24].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),d[28]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[40]=(d[28].push(a.epochId),d[28])})},function(a){return d[38]="Queried locally available epochs. Count: ",d[29]=c.i64.of_int32(d[28].length),d[39]=c.i64.to_string(d[29]),d[30]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[30],d[38],d[30],d[39]].join("")),c.resolve()},function(e){return d[31]=new c.Map(),d[31].set("device_id",d[17]),d[31].set("raw_tokens",d[27]),d[31].set("locally_available_epochs",d[28]),d[32]=new c.Map(),d[32].set("reference_timestamp",a[2]),d[32].set("direction",c.i64.cast([0,1])),d[32].set("server_thread_key",void 0),d[32].set("device_context",d[31]),d[32].set("source",a[6]),d[32].set("include_offset",d[23]),d[33]=new c.Map(),d[33].set("restore_context",d[24]),d[33].set("success",d[32]),d[33].set("queue_name",void 0),d[34]=d[33].get("queue_name"),d[33],d[34]!==void 0?d[35]=d[34]:(d[40]=d[33].get("restore_context"),d[33],d[41]=d[40].get("act_thread_id"),d[40],d[35]=["encrypted_backups_restore",":",d[41]].join("")),d[36]=c.toJSON(d[33]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[35],c.i64.cast([0,50030]),d[36],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})}]):c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),a[7]===!0?d[23]=!0:d[23]=!1,d[24]=new c.Map(),d[24].set("act_thread_id",a[0]),d[24].set("request_id",a[4]),d[24].set("tam_thread_subtype",d[22]),d[24].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),d[28]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[40]=(d[28].push(a.epochId),d[28])})},function(a){return d[38]="Queried locally available epochs. Count: ",d[29]=c.i64.of_int32(d[28].length),d[39]=c.i64.to_string(d[29]),d[30]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[30],d[38],d[30],d[39]].join("")),c.resolve()},function(e){return d[31]=new c.Map(),d[31].set("device_id",d[17]),d[31].set("raw_tokens",d[27]),d[31].set("locally_available_epochs",d[28]),d[32]=new c.Map(),d[32].set("reference_timestamp",a[2]),d[32].set("direction",c.i64.cast([0,2])),d[32].set("server_thread_key",void 0),d[32].set("device_context",d[31]),d[32].set("source",a[6]),d[32].set("include_offset",d[23]),d[33]=new c.Map(),d[33].set("restore_context",d[24]),d[33].set("success",d[32]),d[33].set("queue_name",void 0),d[34]=d[33].get("queue_name"),d[33],d[34]!==void 0?d[35]=d[34]:(d[40]=d[33].get("restore_context"),d[33],d[41]=d[40].get("act_thread_id"),d[40],d[35]=["encrypted_backups_restore",":",d[41]].join("")),d[36]=c.toJSON(d[33]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[35],c.i64.cast([0,50030]),d[36],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})}]):c.sequence([function(e){return d[6]?(d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,100])),d[24].set("error_message",""),d[24].set("stored_procedure","issueMessageRangeQueryTask"),d[25]=new c.Map(),d[25].set("act_thread_id",a[0]),d[26]=new c.Map(),d[26].set("restore_context",d[25]),d[26].set("failure",d[24]),d[27]=d[26].get("restore_context"),d[26],d[28]=d[27].get("act_thread_id"),d[27],d[29]=c.toJSON(d[26]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[28]].join(""),c.i64.cast([0,50031]),d[29],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[24]=void 0:(f=e.item,c.sequence([function(a){return d[40]=f.deviceId,d[39]=f.backupTenancy,d[38]=f.encryptionVersion,d[33]=void 0,c.i64.neq(d[33],void 0)?c.resolve(d[34]=d[33]):c.sequence([function(a){return d[41]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]?d[51]=(d[41].push(c.i64.cast([0,0])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[51]=(d[41].push(c.i64.cast([0,2])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]?d[51]=(d[41].push(c.i64.cast([0,3])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[51]=(d[41].push(c.i64.cast([0,4])),d[41]):0,d[46]=c.createArray(),d[47]=c.i64.of_int32(d[41].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[51]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],d[51]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],a})},function(a){return d[54]=(d[46].push(d[52]),d[46])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[51]=c.createArray(),d[52]=c.i64.of_int32(d[46].length),c.i64.gt(d[52],c.i64.cast([0,0]))?c.loopAsync(d[52],function(a){return d[54]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[57]=(d[51].push(c.i64.to_string(d[55])),d[51])}])}):c.resolve()},function(a){return d[53]=d[51].join(","),d[48]=d[53]}])},function(a){return d[46].some(function(a){return c.i64.eq(d[38],a)})?d[49]=d[38]:d[49]=void 0,c.i64.neq(d[49],void 0)?d[50]=d[49]:d[50]=void 0,d[34]=d[50]}])},function(a){return c.i64.neq(d[34],void 0)?d[35]=d[34]:d[35]=c.i64.cast([0,0]),c.i64.neq(d[39],void 0)?d[36]=d[39]:d[36]=c.i64.cast([0,1]),c.i64.neq(d[40],void 0)?d[37]=d[40]:d[37]=void 0,d[24]=d[37]}]))})},function(e){return d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,100])),d[26].set("error_message",void 0==null?"":void 0),d[26].set("stored_procedure","issueMessageRangeQueryTask"),d[27]=new c.Map(),d[27].set("act_thread_id",a[0]),d[27].set("source",a[6]),d[27].set("restore_operation_type",c.i64.cast([0,2])),d[27].set("request_id",a[4]),d[27].set("device_id",d[24]),d[28]=new c.Map(),d[28].set("restore_context",d[27]),d[28].set("failure",d[26]),d[29]=d[28].get("queue_name"),d[28],d[29]!==void 0?d[30]=d[29]:(d[33]=d[28].get("restore_context"),d[28],d[34]=d[33].get("act_thread_id"),d[33],d[30]=["encrypted_backups_restore",":",d[34]].join("")),d[31]=c.toJSON(d[28]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[30],c.i64.cast([0,50030]),d[31],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[32]=a[0],a})}])},function(e){return d[23]="threak pk not found for jid",d[23]!==void 0?c.sequence([function(e){return d[25]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[23]].join(""),function(a){c.logger(a).mustfix(a)}(d[25]),d[24]=c.createArray(),a[4]!==void 0?d[26]=(d[24].push(a[4]),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[23],d[24],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[25],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[22]=c.i64.cast([0,5]):d[22]=c.i64.cast([0,2])}])},function(a){return d[14]=!0}]):c.sequence([function(e){return d[6]?(d[22]=new c.Map(),d[22].set("error_code",c.i64.cast([0,1])),d[22].set("error_message",""),d[22].set("stored_procedure","issueMessageRangeQueryTask"),d[23]=new c.Map(),d[23].set("act_thread_id",a[0]),d[24]=new c.Map(),d[24].set("restore_context",d[23]),d[24].set("failure",d[22]),d[25]=d[24].get("restore_context"),d[24],d[26]=d[25].get("act_thread_id"),d[25],d[27]=c.toJSON(d[24]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[26]].join(""),c.i64.cast([0,50031]),d[27],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[28]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[22]=void 0:(f=e.item,c.sequence([function(a){return d[38]=f.deviceId,d[37]=f.backupTenancy,d[36]=f.encryptionVersion,d[31]=void 0,c.i64.neq(d[31],void 0)?c.resolve(d[32]=d[31]):c.sequence([function(a){return d[39]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[40]=a[0],a})},function(a){return d[40]?d[49]=(d[39].push(c.i64.cast([0,0])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[41]=a[0],a})},function(a){return d[41]?d[49]=(d[39].push(c.i64.cast([0,2])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]?d[49]=(d[39].push(c.i64.cast([0,3])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[49]=(d[39].push(c.i64.cast([0,4])),d[39]):0,d[44]=c.createArray(),d[45]=c.i64.of_int32(d[39].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(a){return d[49]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[39],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(a){return d[52]=(d[44].push(d[50]),d[44])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[49]=c.createArray(),d[50]=c.i64.of_int32(d[44].length),c.i64.gt(d[50],c.i64.cast([0,0]))?c.loopAsync(d[50],function(a){return d[52]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[44],d[52]).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[55]=(d[49].push(c.i64.to_string(d[53])),d[49])}])}):c.resolve()},function(a){return d[51]=d[49].join(","),d[46]=d[51]}])},function(a){return d[44].some(function(a){return c.i64.eq(d[36],a)})?d[47]=d[36]:d[47]=void 0,c.i64.neq(d[47],void 0)?d[48]=d[47]:d[48]=void 0,d[32]=d[48]}])},function(a){return c.i64.neq(d[32],void 0)?d[33]=d[32]:d[33]=c.i64.cast([0,0]),c.i64.neq(d[37],void 0)?d[34]=d[37]:d[34]=c.i64.cast([0,1]),c.i64.neq(d[38],void 0)?d[35]=d[38]:d[35]=void 0,d[22]=d[35]}]))})},function(e){return d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,1])),d[24].set("error_message",void 0==null?"":void 0),d[24].set("stored_procedure","issueMessageRangeQueryTask"),d[25]=new c.Map(),d[25].set("act_thread_id",a[0]),d[25].set("source",a[6]),d[25].set("restore_operation_type",c.i64.cast([0,2])),d[25].set("request_id",a[4]),d[25].set("device_id",d[22]),d[26]=new c.Map(),d[26].set("restore_context",d[25]),d[26].set("failure",d[24]),d[27]=d[26].get("queue_name"),d[26],d[27]!==void 0?d[28]=d[27]:(d[31]=d[26].get("restore_context"),d[26],d[32]=d[31].get("act_thread_id"),d[31],d[28]=["encrypted_backups_restore",":",d[32]].join("")),d[29]=c.toJSON(d[26]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[28],c.i64.cast([0,50030]),d[29],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})}])},function(e){return d[21]="backup not found",d[21]!==void 0?c.sequence([function(e){return d[23]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[21]].join(""),function(a){c.logger(a).mustfix(a)}(d[23]),d[22]=c.createArray(),a[4]!==void 0?d[24]=(d[22].push(a[4]),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[21],d[22],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[23],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[23]=!0:d[23]=!1,d[23]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[20]=c.i64.cast([0,5]):d[20]=c.i64.cast([0,2]),d[14]=!1}])},function(a){return d[1]=d[14]}]))})},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[9]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ",d[5],d[7],d[5],d[8],d[5],d[9]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueMessageRangeQueryTaskStoredProcedure",["LSIssueMessageRangeQueryTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadId;d[1]=b.numMessages;d[2]=b.startSortKey;d[3]=b.isPointQuery;d[4]=b.traceId;d[5]=b.newerNumMessages;d[6]=b.source;d[7]=b.includeOffset;return c("LSIssueMessageRangeQueryTask").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8422073107849682"}),null);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql",["MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"app_id"},c={defaultValue:null,kind:"LocalArgument",name:"restore_payload_string"},d={defaultValue:null,kind:"LocalArgument",name:"restore_type"},e=[{kind:"Variable",name:"app_id",variableName:"app_id"},{kind:"Variable",name:"restore_payload_string",variableName:"restore_payload_string"},{kind:"Variable",name:"restore_type",variableName:"restore_type"}],f={alias:null,args:null,kind:"ScalarField",name:"encryption_version",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"encrypted_protobuf_stanza",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"protobuf_timestamp_ms",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"sk_ciphertext",storageKey:null},l=[g,h];return{fragment:{argumentDefinitions:[a,c,d],kind:"Fragment",metadata:null,name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,d,a],kind:"Operation",name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMessage",kind:"LinkedField",name:"encrypted_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEchoDocument",kind:"LinkedField",name:"echo_document",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"echo_document_string",storageKey:null},f,g,h,{alias:null,args:null,kind:"ScalarField",name:"epoch_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"otid",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanzas",kind:"LinkedField",name:"protobuf_stanzas",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"top_level_protobuf",plural:!1,selections:[i,f,g,h,j,k],storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"supplemental_protobufs",plural:!0,selections:[i,f,g,h,j,k,{alias:null,args:null,kind:"ScalarField",name:"supplemental_key",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},{alias:null,args:null,concreteType:"XFBMessageRangeInfo",kind:"LinkedField",name:"message_range_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_more_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_more_after",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_after",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_delete_mailbox",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation"),metadata:{},name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WorkerRelayEnvironment",["ActorURIConfig","MAWCurrentUser","RelayAPIConfig","WAResolvable","createRelayFBNetwork","createRelayFBNetworkFetch","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=i(d("MAWCurrentUser").getID());a={execute:a.execute};h.resolve(a);return a}var h=new(d("WAResolvable").Resolvable)();function b(){return h.promise}function i(a,b){b={actorID:a,batchResponseChunks:!0,getAdditionalData:function(){var b={};a!=null&&(b[c("ActorURIConfig").PARAMETER_ACTOR]=a);c("RelayAPIConfig").useXController===!1&&c("RelayAPIConfig").accessToken!==""&&(b.access_token=c("RelayAPIConfig").accessToken);return b},graphURI:b};b=c("createRelayFBNetworkFetch")(b);var e=function(a,b,c){return d("relay-runtime").Observable.create(function(a){return a.complete()})};return c("createRelayFBNetwork")(b,e,null,null)}g.createWorkerRelayEnvironment=a;g.getWorkerRelayEnvironment=b}),98);
__d("executeGraphQLQuery",["DTSG","MAWBridge","asyncToGeneratorRuntime","err","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=d("relay-runtime").getRequest(b);if(b.params.operationKind==="subscription")throw c("err")("executeGraphQLQuery: Expected query or mutation operation");var f={force:!0},g=(yield d("MAWBridge").getBridge().sendAndReceive("event","getDTSGToken")["catch"](function(a){throw c("err")("executeGraphQLQuery: Failed to get DTSG token from the main thread",a)}));if(g==null||g===""||typeof g!=="string")throw c("err")("executeGraphQLQuery: Received an empty DTSG token from the main thread");d("DTSG").setToken(g);g=d("relay-runtime").createOperationDescriptor(b,e,f);return a.execute(g.request.node.params,g.request.variables,f)});return h.apply(this,arguments)}g.executeGraphQLQuery=a}),98);
__d("createWorkerMutation",["WorkerRelayEnvironment","asyncToGeneratorRuntime","err","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=d("relay-runtime").getRequest(a);if(e.params.operationKind!=="mutation")throw c("err")("createWorkerMutation: Expected mutation operation");var f=d("WorkerRelayEnvironment").getWorkerRelayEnvironment();e=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield f);return d("executeGraphQLQuery").executeGraphQLQuery(c,a,b).then(function(a){return a.toPromise()}).then(function(a){if(Array.isArray(a)){return(a=a[0])==null?void 0:a.data}else return null})});return function(a){return c.apply(this,arguments)}}();return[e]}g["default"]=a}),98);
__d("createWorkerQuery",["WorkerRelayEnvironment","asyncToGeneratorRuntime","err","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("relay-runtime").getRequest(a);if(e.params.operationKind!=="query")throw c("err")("createWorkerQuery: Expected query operation");e=(yield d("WorkerRelayEnvironment").getWorkerRelayEnvironment());e=(yield d("executeGraphQLQuery").executeGraphQLQuery(e,a,b).then(function(a){return a.toPromise()}).then(function(a){return Array.isArray(a)?a[0].data:(a=a.data)!=null?a:null}));return e});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WorkerRelay",["WorkerRelayEnvironment","createWorkerMutation","createWorkerQuery","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";f.exports={createWorkerMutation:c("createWorkerMutation"),createWorkerQuery:c("createWorkerQuery"),executeGraphQLQuery:d("executeGraphQLQuery").executeGraphQLQuery,getWorkerRelayEnvironment:d("WorkerRelayEnvironment").getWorkerRelayEnvironment,graphql:d("relay-runtime").graphql}}),34);
__d("XFBLSRestoreOperationType.facebook",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["INITIAL_RESTORE","MESSAGE_QUERY_RESTORE","POINT_QUERY_RESTORE","RANGE_QUERY_RESTORE","SNAPSHOT_RESTORE","SURROUNDING_RESTORE","UNKNOWN"]);c=a;f["default"]=c}),66);
__d("LSDecryptSupplementalKey",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptSupplementalKey] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.nativeOperation(b("LSBase64Decode.nop"),a[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(a){return c.blobs.neq(d[2],void 0)?c.sequence([function(a){return d[13]=d[3].get("epoch_root_key"),d[3],d[14]=c.createArray(),d[21]=(d[14].push(c.i64.cast([0,32])),d[14]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,d[13],d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return d[15]!==void 0?c.sequence([function(a){return d[21]=c.i64.of_int32(d[15].length),c.i64.ge(d[21],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[15],c.i64.cast([0,0])).then(function(a){return a=a,d[23]=a[0],d[24]=a[1],a})},function(a){return d[22]=d[23]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[23],c.i64.cast([0,3]))},function(a){return d[22]=void 0}])},function(a){return d[16]=d[22]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[21],c.i64.cast([0,3]))},function(a){return d[16]=void 0}])},function(a){return c.blobs.neq(d[16],void 0)?d[17]=!0:d[17]=!1,d[17]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedData.nop"),d[16],c.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),d[2]).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.blobs.neq(d[18],void 0)?(a=[c.blobs.to_string(d[18]),void 0],d[19]=a[0],d[20]=a[1],a):(d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,109])),d[21].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[21].set("error_message",""),a=[void 0,d[21]],d[19]=a[0],d[20]=a[1],a),a=[d[19],d[20]],d[5]=a[0],d[6]=a[1],a}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,109])),d[13].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[13].set("error_message",""),a=[void 0,d[13]],d[5]=a[0],d[6]=a[1],a))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptSupplementalKey] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptSupplementalKey",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessageProtobufs",["LSArrayGetObjectAt","LSDecryptProtobuf","LSDecryptSupplementalKey","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessageProtobufs] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[11]=new c.Map(),d[11].set("error_code",c.i64.cast([0,1])),d[11].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[11].set("error_message",""),g=[void 0,d[11]],d[2]=g[0],d[3]=g[1],g):(f=e.item,c.sequence([function(a){return d[19]=f.backupId,d[18]=f.backupTenancy,d[17]=f.encryptionVersion,d[11]=void 0,c.i64.neq(d[11],void 0)?c.resolve(d[12]=d[11]):c.sequence([function(a){return d[20]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[30]=(d[20].push(c.i64.cast([0,0])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[30]=(d[20].push(c.i64.cast([0,2])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[30]=(d[20].push(c.i64.cast([0,3])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[30]=(d[20].push(c.i64.cast([0,4])),d[20]):0,d[25]=c.createArray(),d[26]=c.i64.of_int32(d[20].length),c.i64.gt(d[26],c.i64.cast([0,0]))?c.loopAsync(d[26],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=(d[25].push(d[31]),d[25])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[30]=c.createArray(),d[31]=c.i64.of_int32(d[25].length),c.i64.gt(d[31],c.i64.cast([0,0]))?c.loopAsync(d[31],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[36]=(d[30].push(c.i64.to_string(d[34])),d[30])}])}):c.resolve()},function(a){return d[32]=d[30].join(","),d[27]=d[32]}])},function(a){return d[25].some(function(a){return c.i64.eq(d[17],a)})?d[28]=d[17]:d[28]=void 0,c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=void 0,d[12]=d[29]}])},function(e){return c.i64.neq(d[12],void 0)?d[13]=d[12]:d[13]=c.i64.cast([0,0]),c.i64.neq(d[18],void 0)?d[14]=d[18]:d[14]=c.i64.cast([0,1]),c.i64.neq(f.deviceId,void 0)?c.sequence([function(e){return d[20]=c.createArray(),d[21]=c.createArray(),d[22]=new c.Map(),d[23]=c.i64.of_int32(a[0].length),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(e){return d[27]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[27]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],a})},function(a){return d[30]=d[28].get("encrypted_protobufs"),d[28],d[31]=d[30].get("toplevel_protobuf"),d[30],d[32]=d[31].get("epoch_id"),d[31],d[33]=d[31].get("epoch_anon_id"),d[31],d[34]=d[22].get(c.blobs.to_string(d[33])),d[22],d[34]!==void 0?c.resolve(d[35]=d[34]):c.sequence([function(a){return c.i64.neq(d[32],void 0)?c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[32]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[32])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[41]=d[42]}]):c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[33])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[41]=d[42]}])},function(a){return d[35]=d[41]}])},function(e){return d[36]=d[31].get("epoch_anon_id"),d[31],d[22].set(c.blobs.to_string(d[36]),d[35]),d[37]=d[31].get("encrypted_protobuf"),d[31],d[38]=d[31].get("encryption_version"),d[31],c.storedProcedure(b("LSDecryptProtobuf"),d[37],d[38],a[1],d[35]).then(function(a){return a=a,d[39]=a[0],d[40]=a[1],a})},function(e){return c.blobs.neq(d[39],void 0)?c.sequence([function(e){return d[41]=d[28].get("encrypted_protobufs"),d[28],d[42]=d[41].get("supplemental_protobufs"),d[41],d[43]=new c.Map(),d[44]=d[42].keys(),d[45]=c.i64.of_int32(d[44].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[50]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[44],d[50]).then(function(a){return a=a,d[51]=a[0],d[52]=a[1],a})},function(e){return d[53]=d[42].get(d[51]),d[42],d[53]!==void 0?c.sequence([function(a){return d[54]=d[53].get("epoch_id"),d[53],d[55]=d[53].get("epoch_anon_id"),d[53],d[56]=d[22].get(c.blobs.to_string(d[55])),d[22],d[56]!==void 0?c.resolve(d[57]=d[56]):c.sequence([function(a){return c.i64.neq(d[54],void 0)?c.sequence([function(a){return d[63]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[54]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[54])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[64]=new c.Map(),d[64].set("epoch_root_key",a.epochRootKeyBlob),d[64].set("epoch_anon_id",a.epochAnonIdBlob),d[65]=(d[63].push(d[64]),d[63])})},function(a){return d[62]=d[63]}]):c.sequence([function(a){return d[63]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[55])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[64]=new c.Map(),d[64].set("epoch_root_key",a.epochRootKeyBlob),d[64].set("epoch_anon_id",a.epochAnonIdBlob),d[65]=(d[63].push(d[64]),d[63])})},function(a){return d[62]=d[63]}])},function(a){return d[57]=d[62]}])},function(a){return d[58]=d[53].get("epoch_anon_id"),d[53],d[22].set(c.blobs.to_string(d[58]),d[57]),d[59]=d[53].get("sk_ciphertext"),d[53],c.storedProcedure(b("LSDecryptSupplementalKey"),d[59]==null?"":d[59],d[57]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],a})},function(e){return d[60]!==void 0?c.sequence([function(e){return d[62]=d[53].get("encrypted_protobuf"),d[53],d[63]=d[53].get("encryption_version"),d[53],c.storedProcedure(b("LSDecryptProtobuf"),d[62],d[63],a[1],d[57]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return c.blobs.neq(d[64],void 0)?(d[66]=d[53].get("protobuf_timestamp_ms"),d[53],d[67]=new c.Map(),d[67].set("decrypted_protobuf",d[64]),d[67].set("protobuf_timestamp_ms",d[66]),d[43].set(d[60],d[67])):d[66]=(d[21].push(d[65]),d[21])}]):c.resolve((d[62]=new c.Map(),d[62].set("error_code",c.i64.cast([0,109])),d[62].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[62].set("error_message",""),d[63]=(d[21].push(d[62]),d[21])))}]):c.resolve()}])}):c.resolve()},function(a){return d[46]=d[28].get("otid"),d[28],d[47]=d[31].get("protobuf_timestamp_ms"),d[31],d[48]=new c.Map(),d[48].set("decrypted_protobuf",d[39]),d[48].set("protobuf_timestamp_ms",d[47]),d[49]=new c.Map(),d[49].set("otid",d[46]),d[49].set("toplevel_protobuf",d[48]),d[49].set("supplemental_protobufs",d[43]),d[50]=(d[20].push(d[49]),d[20])}]):c.resolve(d[41]=(d[21].push(d[40]),d[21]))}])}):c.resolve()},function(a){return d[24]=c.i64.of_int32(d[21].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[21],c.i64.cast([0,0])).then(function(a){return a=a,d[27]=a[0],d[28]=a[1],a})},function(a){return a=[void 0,d[27]],d[25]=a[0],d[26]=a[1],a}]):c.resolve((a=[d[20],void 0],d[25]=a[0],d[26]=a[1],a))},function(a){return a=[d[25],d[26]],d[15]=a[0],d[16]=a[1],a}]):c.resolve((d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,24])),d[20].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[15]=e[0],d[16]=e[1],e))},function(a){return a=[d[15],d[16]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessageProtobufs] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageProtobufs",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessageProtobufsStoredProcedure",["LSDecryptMessageProtobufs","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.encryptedMessagesWithProtobufs;d[1]=b.actThreadId;return c("LSDecryptMessageProtobufs").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSSymmetricEncryptionCreateDecryptedString.nop",["Base64Utils","CryptoLogger","LSResult","LSSymmetricEncryptionCreateDecryptedData.nop","XPlatReactTextDecoder"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return c("LSResult")(a)}a=function(a,b,e,f,g){var i=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_decrypted_string");g=d("Base64Utils").toArrayBuffer(g);return c("LSSymmetricEncryptionCreateDecryptedData.nop")(a,b,e,f,g).then(function(a){a=a[0];return a}).then(function(a){return a==null?h():h(new(d("XPlatReactTextDecoder").TextDecoder)().decode(a))})["catch"](function(a){d("CryptoLogger").captureError(i,a).mustfix("symmetric string decryption failed");return h()})};g["default"]=a}),98);
__d("LSDecryptMessageV2",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSIsMobileClient","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessageV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[8]=a[2]==null?c.i64.cast([0,0]):a[2],d[2]=c.i64.of_int32(a[3].length),c.i64.eq(d[2],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[3],c.i64.cast([0,0])).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(e){return d[14]=d[12].get("epoch_anon_id"),d[12],d[15]=d[12].get("epoch_root_key"),d[12],d[16]=c.createArray(),d[26]=(d[16].push(c.i64.cast([0,32])),d[16]),c.i64.ge(d[8],c.i64.cast([0,3]))?c.resolve(d[17]=void 0):c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[1]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[17]=d[26]}])},function(e){return c.i64.ge(d[8],c.i64.cast([0,4]))?(d[26]="_",d[18]=["message_key_in_epoch",d[26],c.blobs.to_string(d[14]),d[26],"cipher_version",d[26],c.i64.to_string(d[8]),d[26],"thread",d[26],a[1]==null?"":a[1]].join("")):(c.i64.ge(d[8],c.i64.cast([0,3]))?(d[27]="_",d[26]=["message_key_in_epoch",d[27],c.blobs.to_string(d[14]),d[27],"cipher_version",d[27],c.i64.to_string(d[8]),d[27],"thread",d[27],a[1]==null?"":a[1]].join("")):(c.i64.ge(d[8],c.i64.cast([0,2]))?(d[28]="_",d[27]=["message_key_in_epoch",d[28],c.blobs.to_string(d[14]),d[28],"cipher_version",d[28],c.i64.to_string(d[8])].join("")):d[27]=["message_key_in_epoch","_",c.blobs.to_string(d[14])].join(""),d[26]=d[27]),d[18]=d[26]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[18]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[19],d[17],d[15],d[16]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!1:d[21]=!0,d[21]?c.resolve(d[22]=void 0):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],c.i64.cast([0,0])).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],a})},function(a){return d[22]=d[26]}])},function(e){return c.blobs.neq(d[22],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedString.nop"),d[22],c.blobs.of_string(["message_thread","_",a[1]].join("")),a[0]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]!==void 0?c.resolve(d[27]=d[26]):c.sequence([function(a){return d[28]=["Failed to decrypt message. Epoch Anon ID: ",c.blobs.to_string(d[14]),", Encryption Version: ",c.i64.to_string(d[8])].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] ","",d[28]].join("")),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptMessageV2StoredProcedure",[d[28]].join(""),d[29],c.i64.cast([0,3]))},function(a){return d[27]=void 0}])},function(a){return d[23]=d[27]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] Decryption message key is null"),void 0!==void 0?c.sequence([function(a){return void 0!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),void 0,c.i64.cast([0,85]),c.i64.cast([0,2]),"[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] Decryption message key is null",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[27]?d[28]=!0:d[28]=!1,d[28]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[29],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptMessageV2StoredProcedure","Decryption message key is null",d[26],c.i64.cast([0,3]))},function(a){return d[23]=void 0}])},function(a){return d[23]!==void 0?(a=[d[23],void 0],d[24]=a[0],d[25]=a[1],a):(d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,101])),d[26].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[26].set("error_message",""),a=[void 0,d[26]],d[24]=a[0],d[25]=a[1],a),a=[d[24],d[25]],d[3]=a[0],d[4]=a[1],a}]):c.resolve((d[12]=c.i64.of_int32(a[3].length),c.i64.eq(d[12],c.i64.cast([0,0]))?(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,102])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1],e):(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,103])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1],e),e=[d[13],d[14]],d[3]=e[0],d[4]=e[1],e))},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[11]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessageV2] ",d[7],d[9],d[7],d[10],d[7],d[11]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageV2",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[3],d[4]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessageV2StoredProcedure";e.exports=a}),null);
__d("LSDecryptMessages",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDecryptMessageV2","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessages] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[11]=new c.Map(),d[11].set("error_code",c.i64.cast([0,1])),d[11].set("stored_procedure","LSEncryptedBackupsDecryptMessagesStoredProcedure"),d[11].set("error_message",""),g=[void 0,d[11]],d[2]=g[0],d[3]=g[1],g):(f=e.item,c.sequence([function(a){return d[19]=f.backupId,d[20]=f.deviceId,d[18]=f.backupTenancy,d[17]=f.encryptionVersion,d[11]=void 0,c.i64.neq(d[11],void 0)?c.resolve(d[12]=d[11]):c.sequence([function(a){return d[21]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[31]=(d[21].push(c.i64.cast([0,0])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[31]=(d[21].push(c.i64.cast([0,2])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[31]=(d[21].push(c.i64.cast([0,3])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[25]?d[31]=(d[21].push(c.i64.cast([0,4])),d[21]):0,d[26]=c.createArray(),d[27]=c.i64.of_int32(d[21].length),c.i64.gt(d[27],c.i64.cast([0,0]))?c.loopAsync(d[27],function(a){return d[31]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[21],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(a){return d[34]=(d[26].push(d[32]),d[26])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[31]=c.createArray(),d[32]=c.i64.of_int32(d[26].length),c.i64.gt(d[32],c.i64.cast([0,0]))?c.loopAsync(d[32],function(a){return d[34]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],d[34]).then(function(a){return a=a,d[35]=a[0],d[36]=a[1],a})},function(a){return d[37]=(d[31].push(c.i64.to_string(d[35])),d[31])}])}):c.resolve()},function(a){return d[33]=d[31].join(","),d[28]=d[33]}])},function(a){return d[26].some(function(a){return c.i64.eq(d[17],a)})?d[29]=d[17]:d[29]=void 0,c.i64.neq(d[29],void 0)?d[30]=d[29]:d[30]=void 0,d[12]=d[30]}])},function(e){return c.i64.neq(d[12],void 0)?d[13]=d[12]:d[13]=c.i64.cast([0,0]),c.i64.neq(d[18],void 0)?d[14]=d[18]:d[14]=c.i64.cast([0,1]),c.i64.neq(d[20],void 0)?c.sequence([function(e){return d[21]=c.createArray(),d[22]=c.createArray(),d[23]=new c.Map(),d[24]=c.i64.of_int32(a[0].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.loopAsync(d[24],function(e){return d[28]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return d[31]=d[29].get("epoch_anon_id"),d[29],d[32]=d[23].get(c.blobs.to_string(d[31])),d[23],d[32]!==void 0?c.resolve(d[33]=d[32]):c.sequence([function(a){return d[38]=d[29].get("epoch_anon_id"),d[29],d[39]=d[29].get("epoch_id"),d[29],c.i64.neq(d[39],void 0)?c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[39]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[39])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[40]=d[42]}]):c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[38])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[40]=d[42]}])},function(a){return d[41]=c.i64.of_int32(d[40].length),c.i64.gt(d[41],c.i64.cast([0,0]))?(d[42]=d[29].get("epoch_anon_id"),d[29],d[23].set(c.blobs.to_string(d[42]),d[40])):0,d[33]=d[40]}])},function(e){return d[34]=d[29].get("value"),d[29],d[35]=d[29].get("encryption_version"),d[29],c.storedProcedure(b("LSDecryptMessageV2"),d[34],a[1],d[35],d[33]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return d[36]!==void 0?c.resolve((d[38]=d[29].get("otid"),d[29],d[39]=new c.Map(),d[39].set("value",d[36]),d[39].set("otid",d[38]),d[40]=(d[21].push(d[39]),d[21]))):c.sequence([function(a){return d[37]!==void 0?c.sequence([function(a){return d[38]=c.i64.of_int32(d[33].length),c.i64.gt(d[38],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=d[49].get("epoch_root_key"),d[49],d[52]=c.createArray(),d[57]=(d[52].push(c.i64.cast([0,18])),d[52]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[51],d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(a){return d[53]!==void 0?c.sequence([function(a){return d[57]=c.i64.of_int32(d[53].length),c.i64.ge(d[57],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[53],c.i64.cast([0,0])).then(function(a){return a=a,d[59]=a[0],d[60]=a[1],a})},function(a){return d[58]=d[59]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[59]=c.createArray(),void 0!==void 0?d[60]=(d[59].push(void 0),d[59]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[59],c.i64.cast([0,3]))},function(a){return d[58]=void 0}])},function(a){return d[54]=d[58]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[57]=c.createArray(),void 0!==void 0?d[58]=(d[57].push(void 0),d[57]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[57],c.i64.cast([0,3]))},function(a){return d[54]=void 0}])},function(a){return c.blobs.neq(d[54],void 0)?d[55]=!0:d[55]=!1,d[55]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.neq(d[54],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[54]).then(function(a){return a=a,d[57]=a[0],a})},function(a){return d[56]=d[57]==null?"[encodingFailed]":d[57]}]):c.resolve(d[56]="[null]")},function(a){return d[39]=d[56]}]):c.resolve(d[39]="[noEpochs]")},function(a){return d[40]=d[29].get("otid"),d[29],d[41]=d[29].get("epoch_anon_id"),d[29],d[42]=d[29].get("encryption_version"),d[29],c.i64.neq(d[42],void 0)?d[43]=c.i64.to_string(d[42]):d[43]="null",d[44]=c.i64.of_int32(d[33].length),d[45]=d[29].get("epoch_fingerprint"),d[29],c.blobs.neq(d[45],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[46]=d[49]==null?"[encodingFailed]":d[49]}]):c.resolve(d[46]="[null]")},function(a){return d[47]=d[29].get("backup_id"),d[29],d[48]="",d[37].set("error_message",["Decryption failed for message with otid:",d[48],d[40],d[48]," epoch:",d[48],c.blobs.to_string(d[41]),d[48]," version:",d[48],d[43],d[48]," epoch_key_count:",d[48],c.i64.to_string(d[44]),d[48]," vsr_fingerprint:",d[48],d[46],d[48]," local_fingerprint:",d[48],d[39],d[48]," vsr_backup_id:",d[48],c.i64.to_string(d[47])==null?"[null]":c.i64.to_string(d[47]),d[48]," local_backup_id:",d[48],c.i64.to_string(d[19]),d[48]," local_device_id:",d[48],c.i64.to_string(d[20])].join(""))}]):c.resolve()},function(a){return d[38]=(d[22].push(d[37]),d[22])}])}])}):c.resolve()},function(a){return d[25]=c.i64.of_int32(d[22].length),c.i64.gt(d[25],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[22],c.i64.cast([0,0])).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],a})},function(a){return a=[void 0,d[28]],d[26]=a[0],d[27]=a[1],a}]):c.resolve((a=[d[21],void 0],d[26]=a[0],d[27]=a[1],a))},function(a){return a=[d[26],d[27]],d[15]=a[0],d[16]=a[1],a}]):c.resolve((d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,24])),d[21].set("stored_procedure","LSEncryptedBackupsDecryptMessagesStoredProcedure"),d[21].set("error_message",""),e=[void 0,d[21]],d[15]=e[0],d[16]=e[1],e))},function(a){return a=[d[15],d[16]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessages] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessages",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessagesStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessagesStoredProcedure",["LSDecryptMessages","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.encryptedMessages;d[1]=b.actThreadId;return c("LSDecryptMessages").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSDeleteAndReenrollDeviceState",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Beginning execution."),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] No reenrollment trigger table. Doing nothing."),d[1]=c.createArray(),void 0!==void 0?d[8]=(d[1].push(void 0),d[1]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure","No reenrollment trigger table. Doing nothing.",d[1],c.i64.cast([0,3]))},function(a){return d[2]=c.i64.of_float(Date.now()),d[3]=c.i64.random(),d[5]="Finishing execution. Execution time: ",d[6]=c.i64.to_string(c.i64.sub(d[2],d[0])),d[7]=" ms",d[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ",d[4],d[5],d[4],d[6],d[4],d[7]].join("")),c.i64.eq(c.i64.mod_(d[3],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[8]=",",d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",[d[5],d[8],d[6],d[8],d[7]].join(""),d[9],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure";e.exports=a}),null);
__d("LSDeleteAndReenrollDeviceStateStoredProcedure",["LSDeleteAndReenrollDeviceState","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.targetDeviceId;d[1]=b.reenrollmentReason;return c("LSDeleteAndReenrollDeviceState").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSGetNextEpochAnonId.nop",["CryptoLogger","LSCryptoUtils","LSResult","Promise","XPlatReactTextDecoder"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f){a=d("LSCryptoUtils").strToBuf("0");if(f!=null){e=f;if(e.byteLength===0)f=a;else{var g=new(d("XPlatReactTextDecoder").TextDecoder)();g=g.decode(e);e=Number.parseInt(g,10);g=e+1;f=d("LSCryptoUtils").strToBuf(String(g))}}else f=a;return(h||(h=b("Promise"))).resolve(c("LSResult")(f))["catch"](function(a){d("CryptoLogger").captureError(d("CryptoLogger").CryptoLogger("get_next_epoch_anonid"),a).mustfix("Getting next epoch anon id failed");throw a})};g["default"]=a}),98);
__d("PublicKeyEncryptionUtils",["Promise","UInt8Array","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){}function c(a){if(a!=null)return a;else return new Uint8Array(0).buffer}function e(a,b,c,e,f){return d("UInt8Array").concatBytes([a,b,c,e,f]).buffer}function f(a,b,c,e){return d("XPlatReactCrypto").subtleImportKey("raw",a.buffer,"HKDF",!1,["deriveKey"]).then(function(a){return d("XPlatReactCrypto").subtleDeriveKey({hash:"SHA-256",info:c,name:"HKDF",salt:b},a,{length:256,name:"AES-GCM"},!1,[e])})}var i="key length is not "+32;function j(a,b){if(a.length!==32)return b(i)}function k(a){return new(h||(h=b("Promise")))(function(b,c){j(a,c);return b()})}var l=32;g.assertValidCurvePoint=a;g.getSalt=c;g.concatAad=e;g.getAesKey=f;g.testKeyLength=j;g.assertKeyLength=k;g.keyLength=l}),98);
__d("LSPublicEncryptionCreateDecryptedData.nop",["CryptoLogger","Promise","PublicKeyEncryptionUtils","RetUtil","XPlatReactCrypto","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("PublicKeyCrypto").__setRef("LSPublicEncryptionCreateDecryptedData.nop"),j=c("requireDeferred")("X25519").__setRef("LSPublicEncryptionCreateDecryptedData.nop");function k(a,b){var c=1+d("PublicKeyEncryptionUtils").keyLength+16;a=a.length;a<1+d("PublicKeyEncryptionUtils").keyLength+16&&b("CipherText length is "+a+", < "+c)}function l(a,b,c){b=b[0];if(b!==a)return c("Unexpected version "+b)}function m(a){return new(h||(h=b("Promise")))(function(b,c){l(1,a,c);k(a,c);return b()})}function n(a,c){return new(h||(h=b("Promise")))(function(b,e){d("PublicKeyEncryptionUtils").assertValidCurvePoint(a,e);d("PublicKeyEncryptionUtils").assertValidCurvePoint(c,e);return b()})}a=function(a,c,e,f,g,k,l,o){var p=new Uint8Array(l),q=new Uint8Array([1]),r=d("PublicKeyEncryptionUtils").getSalt(k),s=new Uint8Array(e),t=new Uint8Array(g),u=new Uint8Array(f),v=new Uint8Array(o);return(h||(h=b("Promise"))).all([d("PublicKeyEncryptionUtils").assertKeyLength(s),d("PublicKeyEncryptionUtils").assertKeyLength(u),d("PublicKeyEncryptionUtils").assertKeyLength(t)]).then(function(){return m(v)}).then(function(){return j.load()}).then(function(a){var c=v.slice(1,d("PublicKeyEncryptionUtils").keyLength+1),e=a.publicKeyFromBytes(c,a.KeyPurpose.Encryption);return n(e,t).then(function(){var f=d("PublicKeyEncryptionUtils").concatAad(q,t,s,c,p),g=function(c,d,f){c=a.publicKeyFromBytes(c,a.KeyPurpose.Encryption);d=a.publicKeyFromBytes(d,a.KeyPurpose.Encryption);f=a.secretKeyFromBytes(f,a.KeyPurpose.Encryption);return c==null||d==null||f==null||e==null?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).resolve([c,d,f,e])};return g(s,t,u).then(function(a){if(a==null)return;return{ephemeralPub:a[3],innerAad:f,receiverPriv:a[2],receiverPub:a[0],senderPub:a[1]}})})}).then(function(a){if(a==null)return;var b=a.ephemeralPub,c=a.receiverPriv,e=a.senderPub,f=a.innerAad;return i.load().then(function(a){return a.receiverDeriveSharedSecret(c,b,e)}).then(function(a){if(a==null)return null;else return d("PublicKeyEncryptionUtils").getAesKey(a,r,f,"decrypt")}).then(function(a){if(a==null)return;var b=new Uint8Array(12).buffer,c=v.slice(d("PublicKeyEncryptionUtils").keyLength+1).buffer;return d("XPlatReactCrypto").subtleDecrypt({additionalData:f,iv:new Uint8Array(b),name:"AES-GCM",tagLength:128},a,c)})}).then(function(a){return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(a))})["catch"](function(a){var c=d("CryptoLogger").CryptoLogger("public_encryption_create_decrypted_data");d("CryptoLogger").captureError(c,a).mustfix("Creation of decrypted data for public encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(void 0))})};g["default"]=a}),98);
__d("LSDeriveAndStoreEpochs",["LSArrayGetObjectAt","LSBase64Decode.nop","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSGetNextEpochAnonId.nop","LSIsEncryptionVersionSecure","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSPublicEncryptionCreateDecryptedData.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Beginning execution."),d[1]=c.i64.of_int32(a[0].length),c.i64.gt(d[1],c.i64.cast([0,0]))?c.sequence([function(e){return d[8]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Unable to load client state: 1"),d[21]=c.createArray(),void 0!==void 0?d[24]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure","Unable to load client state: 1",d[21],c.i64.cast([0,3]))},function(e){return d[22]=c.createArray(),d[23]=c.i64.of_int32(a[0].length),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(e){return d[24]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[24]).then(function(a){return a=a,d[25]=a[0],d[26]=a[1],a})},function(a){return d[27]=d[25].get("from_epoch"),d[25],d[28]=d[27].get("epoch_anon_id"),d[27],c.nativeOperation(b("LSBase64Encode.nop"),d[28]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]!==void 0?d[30]=d[29]:d[30]="",d[31]=d[25].get("from_epoch"),d[25],d[32]=d[31].get("epoch_id"),d[31],d[33]=new c.Map(),d[33].set("anon_id",d[30]),d[33].set("epoch_id",d[32]),d[34]=d[25].get("to_epoch"),d[25],d[35]=d[34].get("epoch_anon_id"),d[34],c.nativeOperation(b("LSBase64Encode.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]!==void 0?d[37]=d[36]:d[37]="",d[38]=d[25].get("to_epoch"),d[25],d[39]=d[38].get("epoch_id"),d[38],d[40]=new c.Map(),d[40].set("anon_id",d[37]),d[40].set("epoch_id",d[39]),d[41]=d[25].get("forward_edge"),d[25],d[41]?d[42]=!1:d[42]=!0,d[42]?d[43]=!1:d[43]=!0,d[44]=d[25].get("backward_edge"),d[25],c.blobs.neq(d[44],void 0)?d[45]=!0:d[45]=!1,d[46]=new c.Map(),d[46].set("from",d[33]),d[46].set("to",d[40]),d[46].set("has_forward_edge",d[43]),d[46].set("has_backward_edge",d[45]),d[46].set("result_code",c.i64.cast([0,7])),d[46].set("error_message",void 0),d[47]=(d[22].push(d[46]),d[22])}])}):c.resolve()},function(b){return b=[void 0,void 0,void 0,a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[22]],d[9]=b[0],d[10]=b[1],d[11]=b[2],d[12]=b[3],d[13]=b[4],d[14]=b[5],d[15]=b[6],b}]):(f=e.item,c.sequence([function(a){return d[35]=f.epochStoragePublicKeyBlob,d[34]=f.deviceId,d[33]=f.backupTenancy,d[32]=f.encryptionVersion,d[21]=void 0,c.i64.neq(d[21],void 0)?c.resolve(d[22]=d[21]):c.sequence([function(a){return d[36]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[46]=(d[36].push(c.i64.cast([0,0])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[38]?d[46]=(d[36].push(c.i64.cast([0,2])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[46]=(d[36].push(c.i64.cast([0,3])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[40]=a[0],a})},function(a){return d[40]?d[46]=(d[36].push(c.i64.cast([0,4])),d[36]):0,d[41]=c.createArray(),d[42]=c.i64.of_int32(d[36].length),c.i64.gt(d[42],c.i64.cast([0,0]))?c.loopAsync(d[42],function(a){return d[46]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=(d[41].push(d[47]),d[41])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[41].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[49]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(a){return d[52]=(d[46].push(c.i64.to_string(d[50])),d[46])}])}):c.resolve()},function(a){return d[48]=d[46].join(","),d[43]=d[48]}])},function(a){return d[41].some(function(a){return c.i64.eq(d[32],a)})?d[44]=d[32]:d[44]=void 0,c.i64.neq(d[44],void 0)?d[45]=d[44]:d[45]=void 0,d[22]=d[45]}])},function(e){return c.i64.neq(d[22],void 0)?d[23]=d[22]:d[23]=c.i64.cast([0,0]),c.i64.neq(d[33],void 0)?d[24]=d[33]:d[24]=c.i64.cast([0,1]),c.i64.neq(d[34],void 0)?c.sequence([function(b){return c.i64.neq(a[1],void 0)?c.sequence([function(b){return c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,f){var b=e.done;e=e.value;return b?d[44]=!1:(f=e.item,d[47]=f.deviceId,c.i64.neq(d[47],void 0)?d[46]=c.i64.neq(d[47],a[1]):d[46]=!1,d[44]=d[46])})},function(a){return d[36]=d[44]}]):c.resolve(d[36]=!1)},function(e){return d[36]?c.sequence([function(e){return d[44]=c.createArray(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[46]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=d[47].get("from_epoch"),d[47],d[50]=d[49].get("epoch_anon_id"),d[49],c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]!==void 0?d[52]=d[51]:d[52]="",d[53]=d[47].get("from_epoch"),d[47],d[54]=d[53].get("epoch_id"),d[53],d[55]=new c.Map(),d[55].set("anon_id",d[52]),d[55].set("epoch_id",d[54]),d[56]=d[47].get("to_epoch"),d[47],d[57]=d[56].get("epoch_anon_id"),d[56],c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(a){return d[58]!==void 0?d[59]=d[58]:d[59]="",d[60]=d[47].get("to_epoch"),d[47],d[61]=d[60].get("epoch_id"),d[60],d[62]=new c.Map(),d[62].set("anon_id",d[59]),d[62].set("epoch_id",d[61]),d[63]=d[47].get("forward_edge"),d[47],d[63]?d[64]=!1:d[64]=!0,d[64]?d[65]=!1:d[65]=!0,d[66]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[66],void 0)?d[67]=!0:d[67]=!1,d[68]=new c.Map(),d[68].set("from",d[55]),d[68].set("to",d[62]),d[68].set("has_forward_edge",d[65]),d[68].set("has_backward_edge",d[67]),d[68].set("result_code",c.i64.cast([0,8])),d[68].set("error_message",void 0),d[69]=(d[44].push(d[68]),d[44])}])}):c.resolve()},function(b){return b=[d[34],d[34],a[1],a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[44]],d[37]=b[0],d[38]=b[1],d[39]=b[2],d[40]=b[3],d[41]=b[4],d[42]=b[5],d[43]=b[6],b}]):c.sequence([function(e){return d[44]=c.createArray(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[46]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=d[47].get("from_epoch"),d[47],d[50]=d[49].get("epoch_id"),d[49],c.count(c.db.table(169).fetch([[[d[50]]]])).then(function(a){return d[51]=a})},function(a){return c.i64.le(d[51],c.i64.cast([0,1]))?c.sequence([function(a){return c.db.table(169).fetch([[[d[50]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[77]=new c.Map(),d[77].set("error_msg","Expected a nonempty query result"),d[77].set("code",c.i64.cast([0,3])),d[77].set("src_line","MEBEpochClientUtils.php:69 MEBEpochClientUtils::maybeEpoch()"),d[78]=c.createArray(),d[79]=(d[78].push(d[77]),d[78]),a=[void 0,d[78]],d[73]=a[0],d[74]=a[1],a):(e=b.item,d[77]=new c.Map(),d[77].set("epoch_id",e.epochId),d[77].set("backup_id",e.backupId),d[77].set("epoch_anon_id_blob",e.epochAnonIdBlob),d[77].set("epoch_root_key_blob",e.epochRootKeyBlob),d[77].set("epoch_status",e.epochStatus),d[77].set("authority_level",e.authorityLevel),a=[d[77],void 0],d[73]=a[0],d[74]=a[1],a)})},function(a){return d[76]=new c.Map(),d[76].set("value",d[73]),d[76].set("errors",d[74]),d[52]=d[76]}]):c.resolve((d[73]=new c.Map(),d[73].set("error_msg","Expected at most one result"),d[73].set("code",c.i64.cast([0,4])),d[73].set("src_line","MEBEpochClientUtils.php:69 MEBEpochClientUtils::maybeEpoch()"),d[74]=c.createArray(),d[76]=(d[74].push(d[73]),d[74]),d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[74]),d[52]=d[75]))},function(a){return d[53]=d[52].get("value"),d[52],d[53]!==void 0?(d[73]=d[53].get("epoch_id"),d[53],d[74]=d[53].get("backup_id"),d[53],d[75]=d[53].get("epoch_anon_id_blob"),d[53],d[76]=d[53].get("epoch_root_key_blob"),d[53],d[77]=d[53].get("epoch_status"),d[53],d[78]=d[53].get("authority_level"),d[53],d[54]=d[52]):(d[73]=d[52].get("errors"),d[52],d[74]=d[52].get("errors"),d[52],d[75]=new c.Map(),d[75].set("error_msg","EB_EPOCH_SRC_EPOCH_MISSING"),d[75].set("code",c.i64.cast([0,10003])),d[75].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:372 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge()"),d[77]=(d[73].push(d[75]),d[73]),d[76]=new c.Map(),d[76].set("value",void 0),d[76].set("errors",d[73]),d[54]=d[76]),d[55]=d[54].get("value"),d[54],d[55]!==void 0?(d[73]=d[55].get("epoch_id"),d[55],d[74]=d[55].get("backup_id"),d[55],d[75]=d[55].get("epoch_anon_id_blob"),d[55],d[76]=d[55].get("epoch_root_key_blob"),d[55],d[77]=d[55].get("epoch_status"),d[55],d[78]=d[55].get("authority_level"),d[55],d[79]=d[47].get("from_epoch"),d[47],d[80]=d[79].get("epoch_anon_id"),d[79],c.blobs.eq(d[80],d[75])?d[81]=d[54]:(d[82]=new c.Map(),d[82].set("error_msg","EB_EPOCH_DERIVATION_SRC_ANON_ID_MISMATCH"),d[82].set("code",c.i64.cast([0,10007])),d[82].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:377 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#2()"),d[83]=c.createArray(),d[85]=(d[83].push(d[82]),d[83]),d[84]=new c.Map(),d[84].set("value",void 0),d[84].set("errors",d[83]),d[81]=d[84]),d[56]=d[81]):(d[73]=d[54].get("errors"),d[54],d[74]=d[54].get("errors"),d[54],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[56]=d[75]),d[57]=d[56].get("value"),d[56],d[57]!==void 0?c.sequence([function(a){return d[73]=d[57].get("epoch_id"),d[57],d[74]=d[57].get("backup_id"),d[57],d[75]=d[57].get("epoch_anon_id_blob"),d[57],d[76]=d[57].get("epoch_root_key_blob"),d[57],d[77]=d[57].get("epoch_status"),d[57],d[78]=d[57].get("authority_level"),d[57],d[79]=d[47].get("from_epoch_fingerprint"),d[47],d[80]=c.createArray(),d[85]=(d[80].push(c.i64.cast([0,18])),d[80]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[76],d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?c.sequence([function(a){return d[85]=c.i64.of_int32(d[81].length),c.i64.ge(d[85],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[81],c.i64.cast([0,0])).then(function(a){return a=a,d[87]=a[0],d[88]=a[1],a})},function(a){return d[86]=d[87]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[87]=c.createArray(),void 0!==void 0?d[88]=(d[87].push(void 0),d[87]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[87],c.i64.cast([0,3]))},function(a){return d[86]=void 0}])},function(a){return d[82]=d[86]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[85]=c.createArray(),void 0!==void 0?d[86]=(d[85].push(void 0),d[85]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[85],c.i64.cast([0,3]))},function(a){return d[82]=void 0}])},function(a){return c.blobs.neq(d[82],void 0)?d[83]=!0:d[83]=!1,d[83]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[79],void 0)||c.blobs.eq(d[79],d[82])?d[84]=d[56]:(d[85]=new c.Map(),d[85].set("error_msg","EB_EPOCH_DERIVATION_SRC_FINGERPRINT_MISMATCH"),d[85].set("code",c.i64.cast([0,10002])),d[85].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:386 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#4()"),d[86]=c.createArray(),d[88]=(d[86].push(d[85]),d[86]),d[87]=new c.Map(),d[87].set("value",void 0),d[87].set("errors",d[86]),d[84]=d[87]),d[58]=d[84]}]):c.resolve((d[73]=d[56].get("errors"),d[56],d[74]=d[56].get("errors"),d[56],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[58]=d[75]))},function(a){return d[59]=d[47].get("forward_edge"),d[47],d[59]!==void 0?c.sequence([function(a){return d[73]=d[58].get("value"),d[58],d[73]!==void 0?c.sequence([function(a){return d[87]=d[73].get("epoch_id"),d[73],d[88]=d[73].get("backup_id"),d[73],d[89]=d[73].get("epoch_anon_id_blob"),d[73],d[90]=d[73].get("epoch_root_key_blob"),d[73],d[91]=d[73].get("epoch_status"),d[73],d[92]=d[73].get("authority_level"),d[73],c.nativeOperation(b("LSGetNextEpochAnonId.nop"),d[89]).then(function(a){return a=a,d[93]=a[0],a})},function(a){return d[94]=d[47].get("to_epoch"),d[47],d[95]=d[94].get("epoch_anon_id"),d[94],c.blobs.eq(d[93],d[95])?d[96]=d[58]:(d[97]=new c.Map(),d[97].set("error_msg","EB_EPOCH_FORWARD_EDGE_NOT_CONSECUTIVE"),d[97].set("code",c.i64.cast([0,10009])),d[97].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:104 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge()"),d[98]=c.createArray(),d[100]=(d[98].push(d[97]),d[98]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[98]),d[96]=d[99]),d[74]=d[96]}]):c.resolve((d[87]=d[58].get("errors"),d[58],d[88]=d[58].get("errors"),d[58],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[74]=d[89]))},function(a){return d[75]=d[74].get("value"),d[74],d[75]!==void 0?c.sequence([function(a){return d[87]=d[75].get("epoch_id"),d[75],d[88]=d[75].get("backup_id"),d[75],d[89]=d[75].get("epoch_anon_id_blob"),d[75],d[90]=d[75].get("epoch_root_key_blob"),d[75],d[91]=d[75].get("epoch_status"),d[75],d[92]=d[75].get("authority_level"),d[75],d[93]=d[47].get("from_epoch"),d[47],d[94]=d[93].get("epoch_anon_id"),d[93],d[95]=d[47].get("from_epoch"),d[47],d[96]=d[95].get("epoch_id"),d[95],d[97]=c.createArray(),d[106]=(d[97].push(c.i64.cast([0,32])),d[97]),d[106]=(d[97].push(c.i64.cast([0,32])),d[97]),d[98]="_",c.nativeOperation(b("LSGetBlobFromString.nop"),["epoch_chaining",d[98],c.blobs.to_string(d[94]),d[98],c.i64.to_string(d[96])].join("")).then(function(a){return a=a,d[99]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[99],void 0,d[90],d[97]).then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[100]?d[101]=!1:d[101]=!0,d[101]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key."),d[106]=c.createArray(),void 0!==void 0?d[109]=(d[106].push(void 0),d[106]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key.",d[106],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[107]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[108]=a[0],a})},function(a){return a=[d[107],d[108]],d[102]=a[0],d[103]=a[1],a}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[100],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[100],c.i64.cast([0,1])).then(function(a){return a=a,d[108]=a[0],d[109]=a[1],a})},function(a){return a=[d[106],d[108]],d[102]=a[0],d[103]=a[1],a}])},function(a){return d[104]=new c.Map(),d[104].set("epoch_chaining_key",d[102]),d[104].set("epoch_distribution_pre_shared_key",d[103]),d[105]=new c.Map(),d[105].set("value",d[104]),d[105].set("errors",void 0),d[76]=d[105]}]):c.resolve((d[87]=d[74].get("errors"),d[74],d[88]=d[74].get("errors"),d[74],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[76]=d[89]))},function(a){return d[77]=d[76].get("value"),d[76],d[77]!==void 0?c.sequence([function(a){return d[87]=d[77].get("epoch_chaining_key"),d[77],d[88]=d[77].get("epoch_distribution_pre_shared_key"),d[77],d[89]=d[59].get("psk_fingerprint"),d[59],d[90]=c.createArray(),d[95]=(d[90].push(c.i64.cast([0,18])),d[90]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkNyeXB0b1ByZVNoYXJlZEtleQ=="),void 0,d[88],d[90]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return d[91]!==void 0?c.sequence([function(a){return d[95]=c.i64.of_int32(d[91].length),c.i64.ge(d[95],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[91],c.i64.cast([0,0])).then(function(a){return a=a,d[97]=a[0],d[98]=a[1],a})},function(a){return d[96]=d[97]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[97]=c.createArray(),void 0!==void 0?d[98]=(d[97].push(void 0),d[97]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[97],c.i64.cast([0,3]))},function(a){return d[96]=void 0}])},function(a){return d[92]=d[96]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[95]=c.createArray(),void 0!==void 0?d[96]=(d[95].push(void 0),d[95]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[95],c.i64.cast([0,3]))},function(a){return d[92]=void 0}])},function(a){return c.blobs.neq(d[92],void 0)?d[93]=!0:d[93]=!1,d[93]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[89],void 0)||c.blobs.eq(d[89],d[92])?d[94]=d[76]:(d[95]=new c.Map(),d[95].set("error_msg","EB_EPOCH_DERIVATION_PSK_FINGERPRINT_MISMATCH"),d[95].set("code",c.i64.cast([0,10005])),d[95].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:130 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#4()"),d[96]=c.createArray(),d[98]=(d[96].push(d[95]),d[96]),d[97]=new c.Map(),d[97].set("value",void 0),d[97].set("errors",d[96]),d[94]=d[97]),d[78]=d[94]}]):c.resolve((d[87]=d[76].get("errors"),d[76],d[88]=d[76].get("errors"),d[76],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[78]=d[89]))},function(a){return d[79]=d[78].get("value"),d[78],d[79]!==void 0?(d[87]=d[79].get("epoch_chaining_key"),d[79],d[88]=d[79].get("epoch_distribution_pre_shared_key"),d[79],d[89]=d[59].get("epoch_storage_public_key"),d[59],c.blobs.eq(d[89],void 0)||c.blobs.eq(d[89],d[35])?d[90]=d[78]:(d[91]=new c.Map(),d[91].set("error_msg","EB_EPOCH_DERIVATION_STORAGE_KEY_MISMATCH"),d[91].set("code",c.i64.cast([0,10006])),d[91].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:144 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#7()"),d[92]=c.createArray(),d[94]=(d[92].push(d[91]),d[92]),d[93]=new c.Map(),d[93].set("value",void 0),d[93].set("errors",d[92]),d[90]=d[93]),d[80]=d[90]):(d[87]=d[78].get("errors"),d[78],d[88]=d[78].get("errors"),d[78],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[80]=d[89]),d[81]=d[80].get("value"),d[80],d[81]!==void 0?c.sequence([function(a){return d[87]=d[81].get("epoch_chaining_key"),d[81],d[88]=d[81].get("epoch_distribution_pre_shared_key"),d[81],d[89]=d[59].get("auth_public_key"),d[59],d[90]=d[47].get("to_epoch"),d[47],d[91]=d[90].get("epoch_anon_id"),d[90],d[92]=d[59].get("encrypted_entropy"),d[59],c.nativeOperation(b("LSPublicEncryptionCreateDecryptedData.nop"),d[35],f.epochStoragePrivateKeyBlob,d[89],d[88],c.blobs.of_string(["epoch_","_",c.blobs.to_string(d[91])].join("")),d[92]).then(function(a){return a=a,d[93]=a[0],a})},function(a){return c.blobs.neq(d[93],void 0)?c.resolve(d[94]=d[93]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Couldn't decrypt epoch key. Returning null entropy"),d[100]=c.createArray(),void 0!==void 0?d[101]=(d[100].push(void 0),d[100]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Couldn't decrypt epoch key. Returning null entropy",d[100],c.i64.cast([0,3]))},function(a){return d[94]=void 0}])},function(a){return c.blobs.neq(d[94],void 0)?(d[100]=new c.Map(),d[100].set("entropy",d[94]),d[101]=new c.Map(),d[101].set("value",d[100]),d[101].set("errors",void 0),d[102]=d[101].get("value"),d[101],d[103]=d[101].get("errors"),d[101],a=[d[102],d[103]],d[95]=a[0],d[96]=a[1],a):(d[100]=c.createArray(),c.blobs.eq(d[94],void 0)?d[107]=(d[100].push("entropy"),d[100]):0,d[101]=d[100].join(", "),d[102]=new c.Map(),d[102].set("error_msg",["The following required nullables are null: ","",d[101]].join("")),d[102].set("code",c.i64.cast([0,2])),d[102].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:169 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#11()"),d[103]=c.createArray(),d[107]=(d[103].push(d[102]),d[103]),d[104]=new c.Map(),d[104].set("value",void 0),d[104].set("errors",d[103]),d[105]=d[104].get("value"),d[104],d[106]=d[104].get("errors"),d[104],a=[d[105],d[106]],d[95]=a[0],d[96]=a[1],a),d[97]=new c.Map(),d[97].set("value",d[95]),d[97].set("errors",d[96]),d[98]=d[97].get("value"),d[97],d[98]!==void 0?(d[100]=d[98].get("entropy"),d[98],d[99]=d[97]):(d[100]=d[97].get("errors"),d[97],d[101]=d[97].get("errors"),d[97],d[102]=new c.Map(),d[102].set("error_msg","EB_EPOCH_FORWARD_DECRYPTION_FAILED"),d[102].set("code",c.i64.cast([0,10004])),d[102].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:171 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#10()"),d[104]=(d[100].push(d[102]),d[100]),d[103]=new c.Map(),d[103].set("value",void 0),d[103].set("errors",d[100]),d[99]=d[103]),d[82]=d[99]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[82]=d[89]))},function(a){return d[83]=d[80].get("value"),d[80],d[83]!==void 0?c.sequence([function(a){return d[87]=d[83].get("epoch_chaining_key"),d[83],d[88]=d[83].get("epoch_distribution_pre_shared_key"),d[83],d[89]=d[82].get("value"),d[82],d[89]!==void 0?c.sequence([function(a){return d[91]=d[89].get("entropy"),d[89],d[92]=c.createArray(),d[99]=(d[92].push(c.i64.cast([0,32])),d[92]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key").then(function(a){return a=a,d[93]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[93],d[87],d[91],d[92]).then(function(a){return a=a,d[94]=a[0],a})},function(a){return d[94]?d[95]=!1:d[95]=!0,d[95]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Unable to generate epoch root key."),d[99]=c.createArray(),void 0!==void 0?d[101]=(d[99].push(void 0),d[99]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Unable to generate epoch root key.",d[99],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[96]=d[100]}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[94],c.i64.cast([0,0])).then(function(a){return a=a,d[99]=a[0],d[100]=a[1],a})},function(a){return d[96]=d[99]}])},function(a){return d[97]=new c.Map(),d[97].set("root_key",d[96]),d[98]=new c.Map(),d[98].set("value",d[97]),d[98].set("errors",void 0),d[90]=d[98]}]):c.resolve((d[91]=d[82].get("errors"),d[82],d[92]=d[82].get("errors"),d[82],d[93]=new c.Map(),d[93].set("value",void 0),d[93].set("errors",d[91]),d[90]=d[93]))},function(a){return d[84]=d[90]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[84]=d[89]))},function(a){return d[85]=d[84].get("value"),d[84],d[86]=d[84].get("errors"),d[84],a=[d[85],d[86]],d[60]=a[0],d[61]=a[1],a}]):c.sequence([function(a){return d[73]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[73],void 0)?c.sequence([function(a){return d[79]=d[58].get("value"),d[58],d[79]!==void 0?c.sequence([function(a){return d[87]=d[79].get("epoch_id"),d[79],d[88]=d[79].get("backup_id"),d[79],d[89]=d[79].get("epoch_anon_id_blob"),d[79],d[90]=d[79].get("epoch_root_key_blob"),d[79],d[91]=d[79].get("epoch_status"),d[79],d[92]=d[79].get("authority_level"),d[79],d[93]=d[47].get("to_epoch"),d[47],d[94]=d[93].get("epoch_anon_id"),d[93],c.nativeOperation(b("LSGetNextEpochAnonId.nop"),d[94]).then(function(a){return a=a,d[95]=a[0],a})},function(a){return c.blobs.eq(d[95],d[89])?d[96]=d[58]:(d[97]=new c.Map(),d[97].set("error_msg","EB_EPOCH_BACKWARD_EDGE_NOT_CONSECUTIVE"),d[97].set("code",c.i64.cast([0,10010])),d[97].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:198 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge()"),d[98]=c.createArray(),d[100]=(d[98].push(d[97]),d[98]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[98]),d[96]=d[99]),d[80]=d[96]}]):c.resolve((d[87]=d[58].get("errors"),d[58],d[88]=d[58].get("errors"),d[58],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[80]=d[89]))},function(a){return d[81]=d[80].get("value"),d[80],d[81]!==void 0?c.sequence([function(a){return d[87]=d[81].get("epoch_id"),d[81],d[88]=d[81].get("backup_id"),d[81],d[89]=d[81].get("epoch_anon_id_blob"),d[81],d[90]=d[81].get("epoch_root_key_blob"),d[81],d[91]=d[81].get("epoch_status"),d[81],d[92]=d[81].get("authority_level"),d[81],d[93]=c.createArray(),d[98]=(d[93].push(c.i64.cast([0,32])),d[93]),c.nativeOperation(b("LSBase64Encode.nop"),d[89]).then(function(a){return a=a,d[94]=a[0],a})},function(a){return d[94]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blobs.of_string(["epoch_data_storage","_",d[94]].join("")),void 0,d[90],d[93]).then(function(a){return a=a,d[98]=a[0],a})},function(a){return d[98]?d[99]=!1:d[99]=!0,d[99]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),d[101]=c.createArray(),void 0!==void 0?d[103]=(d[101].push(void 0),d[101]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",d[101],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[102]=a[0],a})},function(a){return d[100]=d[102]}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[98],c.i64.cast([0,0])).then(function(a){return a=a,d[101]=a[0],d[102]=a[1],a})},function(a){return d[100]=d[101]}])},function(a){return d[95]=d[100]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),d[98]=c.createArray(),void 0!==void 0?d[100]=(d[98].push(void 0),d[98]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",d[98],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[99]=a[0],a})},function(a){return d[95]=d[99]}])},function(a){return d[96]=new c.Map(),d[96].set("epoch_data_storage_key",d[95]),d[97]=new c.Map(),d[97].set("value",d[96]),d[97].set("errors",void 0),d[82]=d[97]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[82]=d[89]))},function(a){return d[83]=d[82].get("value"),d[82],d[83]!==void 0?c.sequence([function(a){return d[87]=d[83].get("epoch_data_storage_key"),d[83],c.nativeOperation(b("LSBase64Encode.nop"),d[73]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[95]=d[88],d[95]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedString.nop"),d[87],c.blob("ZXBvY2hfZGF0YV9tZXRhZGF0YQ=="),d[95]).then(function(a){return a=a,d[96]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Decode.nop"),d[96]).then(function(a){return a=a,d[97]=a[0],a})},function(a){return d[89]=d[97]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Unable to base64 encode backward edge."),d[96]=c.createArray(),void 0!==void 0?d[97]=(d[96].push(void 0),d[96]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Unable to base64 encode backward edge.",d[96],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return c.blobs.neq(d[89],void 0)?(d[96]=new c.Map(),d[96].set("root_key",d[89]),d[97]=new c.Map(),d[97].set("value",d[96]),d[97].set("errors",void 0),d[98]=d[97].get("value"),d[97],d[99]=d[97].get("errors"),d[97],a=[d[98],d[99]],d[90]=a[0],d[91]=a[1],a):(d[96]=c.createArray(),c.blobs.eq(d[89],void 0)?d[103]=(d[96].push("root_key"),d[96]):0,d[97]=d[96].join(", "),d[98]=new c.Map(),d[98].set("error_msg",["The following required nullables are null: ","",d[97]].join("")),d[98].set("code",c.i64.cast([0,2])),d[98].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:227 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge#5()"),d[99]=c.createArray(),d[103]=(d[99].push(d[98]),d[99]),d[100]=new c.Map(),d[100].set("value",void 0),d[100].set("errors",d[99]),d[101]=d[100].get("value"),d[100],d[102]=d[100].get("errors"),d[100],a=[d[101],d[102]],d[90]=a[0],d[91]=a[1],a),d[92]=new c.Map(),d[92].set("value",d[90]),d[92].set("errors",d[91]),d[93]=d[92].get("value"),d[92],d[93]!==void 0?(d[96]=d[93].get("root_key"),d[93],d[94]=d[92]):(d[96]=d[92].get("errors"),d[92],d[97]=d[92].get("errors"),d[92],d[98]=new c.Map(),d[98].set("error_msg","EB_EPOCH_BACKWARD_DECRYPTION_FAILED"),d[98].set("code",c.i64.cast([0,10013])),d[98].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:229 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge#4()"),d[100]=(d[96].push(d[98]),d[96]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[96]),d[94]=d[99]),d[84]=d[94]}]):c.resolve((d[87]=d[82].get("errors"),d[82],d[88]=d[82].get("errors"),d[82],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[84]=d[89]))},function(a){return d[85]=d[84].get("value"),d[84],d[86]=d[84].get("errors"),d[84],a=[d[85],d[86]],d[74]=a[0],d[75]=a[1],a}]):c.resolve((d[79]=new c.Map(),d[79].set("error_msg","EB_EPOCH_EDGE_NEITHER_FORWARD_NOR_BACKWARD"),d[79].set("code",c.i64.cast([0,10008])),d[79].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:411 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#9()"),d[80]=c.createArray(),d[84]=(d[80].push(d[79]),d[80]),d[81]=new c.Map(),d[81].set("value",void 0),d[81].set("errors",d[80]),d[82]=d[81].get("value"),d[81],d[83]=d[81].get("errors"),d[81],a=[d[82],d[83]],d[74]=a[0],d[75]=a[1],a))},function(a){return d[76]=new c.Map(),d[76].set("value",d[74]),d[76].set("errors",d[75]),d[77]=d[76].get("value"),d[76],d[78]=d[76].get("errors"),d[76],a=[d[77],d[78]],d[60]=a[0],d[61]=a[1],a}])},function(a){return d[62]=new c.Map(),d[62].set("value",d[60]),d[62].set("errors",d[61]),d[63]=d[62].get("value"),d[62],d[63]!==void 0?c.sequence([function(a){return d[73]=d[63].get("root_key"),d[63],d[74]=d[47].get("to_epoch_fingerprint"),d[47],d[75]=c.createArray(),d[80]=(d[75].push(c.i64.cast([0,18])),d[75]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[73],d[75]).then(function(a){return a=a,d[76]=a[0],a})},function(a){return d[76]!==void 0?c.sequence([function(a){return d[80]=c.i64.of_int32(d[76].length),c.i64.ge(d[80],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[76],c.i64.cast([0,0])).then(function(a){return a=a,d[82]=a[0],d[83]=a[1],a})},function(a){return d[81]=d[82]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[82]=c.createArray(),void 0!==void 0?d[83]=(d[82].push(void 0),d[82]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[82],c.i64.cast([0,3]))},function(a){return d[81]=void 0}])},function(a){return d[77]=d[81]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[80]=c.createArray(),void 0!==void 0?d[81]=(d[80].push(void 0),d[80]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[80],c.i64.cast([0,3]))},function(a){return d[77]=void 0}])},function(a){return c.blobs.neq(d[77],void 0)?d[78]=!0:d[78]=!1,d[78]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[74],void 0)||c.blobs.eq(d[74],d[77])?d[79]=d[62]:(d[80]=new c.Map(),d[80].set("error_msg","EB_EPOCH_DERIVATION_DEST_FINGERPRINT_MISMATCH"),d[80].set("code",c.i64.cast([0,10001])),d[80].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:415 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#11()"),d[81]=c.createArray(),d[83]=(d[81].push(d[80]),d[81]),d[82]=new c.Map(),d[82].set("value",void 0),d[82].set("errors",d[81]),d[79]=d[82]),d[64]=d[79]}]):c.resolve((d[73]=d[62].get("errors"),d[62],d[74]=d[62].get("errors"),d[62],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[64]=d[75]))},function(a){return d[65]=d[64].get("value"),d[64],d[65]!==void 0?c.sequence([function(a){return d[73]=d[65].get("root_key"),d[65],d[74]=d[47].get("to_epoch"),d[47],d[75]=d[74].get("epoch_id"),d[74],d[76]=d[47].get("to_epoch"),d[47],d[77]=d[76].get("epoch_anon_id"),d[76],d[98]="Storing newly derived epoch ",d[99]=c.blobs.to_string(d[77]),d[100]=" authority_level:",d[101]="AUTHORITATIVE",d[102]=" status:",d[103]=c.i64.to_string(c.i64.cast([0,2])),d[78]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[78],d[98],d[78],d[99],d[78],d[100],d[78],d[101],d[78],d[102],d[78],d[103]].join("")),c.resolve()},function(a){return c.filter(c.db.table(169).fetch([[[d[75]]]]),function(a){return c.i64.eq(a.epochId,d[75])&&c.i64.gt(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(b){var a=b.done;b.value;return a?c.db.table(169).put({epochId:d[75],backupId:f.backupId,epochAnonIdBlob:d[77],epochRootKeyBlob:d[73],epochStatus:c.i64.cast([0,2]),authorityLevel:c.i64.cast([0,80])}):0})},function(a){return d[79]=d[47].get("from_epoch"),d[47],d[80]=d[79].get("epoch_anon_id"),d[79],c.nativeOperation(b("LSBase64Encode.nop"),d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?d[82]=d[81]:d[82]="",d[83]=d[47].get("from_epoch"),d[47],d[84]=d[83].get("epoch_id"),d[83],d[85]=new c.Map(),d[85].set("anon_id",d[82]),d[85].set("epoch_id",d[84]),d[86]=d[47].get("to_epoch"),d[47],d[87]=d[86].get("epoch_anon_id"),d[86],c.nativeOperation(b("LSBase64Encode.nop"),d[87]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[88]!==void 0?d[89]=d[88]:d[89]="",d[90]=d[47].get("to_epoch"),d[47],d[91]=d[90].get("epoch_id"),d[90],d[92]=new c.Map(),d[92].set("anon_id",d[89]),d[92].set("epoch_id",d[91]),d[93]=d[47].get("forward_edge"),d[47],d[93]?d[94]=!1:d[94]=!0,d[94]?d[95]=!1:d[95]=!0,d[96]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[96],void 0)?d[97]=!0:d[97]=!1,a=[d[85],d[92],d[95],d[97],void 0,c.i64.cast([0,0])],d[66]=a[0],d[67]=a[1],d[68]=a[2],d[69]=a[3],d[70]=a[4],d[71]=a[5],a}]):c.sequence([function(a){return d[73]=d[64].get("errors"),d[64],d[74]=d[64].get("errors"),d[64],d[75]=c.i64.of_int32(d[73].length),c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],c.i64.sub(d[75],c.i64.cast([0,1]))).then(function(a){return a=a,d[76]=a[0],d[77]=a[1],a})},function(a){return d[78]=d[76].get("code"),d[76],d[79]=d[76].get("src_line"),d[76],d[80]=d[76].get("error_msg"),d[76],c.i64.eq(d[78],c.i64.cast([0,10004]))?d[81]=c.i64.cast([0,3]):(c.i64.eq(d[78],c.i64.cast([0,10003]))?d[103]=c.i64.cast([0,13]):(c.i64.eq(d[78],c.i64.cast([0,10002]))?d[104]=c.i64.cast([0,9]):(c.i64.eq(d[78],c.i64.cast([0,10001]))?d[105]=c.i64.cast([0,10]):(c.i64.eq(d[78],c.i64.cast([0,10005]))?d[106]=c.i64.cast([0,12]):(c.i64.eq(d[78],c.i64.cast([0,10006]))?d[107]=c.i64.cast([0,11]):(c.i64.eq(d[78],c.i64.cast([0,10008]))?d[108]=c.i64.cast([0,2]):(c.i64.eq(d[78],c.i64.cast([0,10009]))?d[109]=c.i64.cast([0,14]):(c.i64.eq(d[78],c.i64.cast([0,10010]))?d[110]=c.i64.cast([0,15]):(c.i64.eq(d[78],c.i64.cast([0,10011]))?d[111]=c.i64.cast([0,16]):(c.i64.eq(d[78],c.i64.cast([0,10012]))?d[112]=c.i64.cast([0,17]):(c.i64.eq(d[78],c.i64.cast([0,10013]))?d[113]=c.i64.cast([0,6]):d[113]=c.i64.cast([0,1]),d[112]=d[113]),d[111]=d[112]),d[110]=d[111]),d[109]=d[110]),d[108]=d[109]),d[107]=d[108]),d[106]=d[107]),d[105]=d[106]),d[104]=d[105]),d[103]=d[104]),d[81]=d[103]),d[82]=d[47].get("from_epoch"),d[47],d[83]=d[82].get("epoch_anon_id"),d[82],c.nativeOperation(b("LSBase64Encode.nop"),d[83]).then(function(a){return a=a,d[84]=a[0],a})},function(a){return d[84]!==void 0?d[85]=d[84]:d[85]="",d[86]=d[47].get("from_epoch"),d[47],d[87]=d[86].get("epoch_id"),d[86],d[88]=new c.Map(),d[88].set("anon_id",d[85]),d[88].set("epoch_id",d[87]),d[89]=d[47].get("to_epoch"),d[47],d[90]=d[89].get("epoch_anon_id"),d[89],c.nativeOperation(b("LSBase64Encode.nop"),d[90]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return d[91]!==void 0?d[92]=d[91]:d[92]="",d[93]=d[47].get("to_epoch"),d[47],d[94]=d[93].get("epoch_id"),d[93],d[95]=new c.Map(),d[95].set("anon_id",d[92]),d[95].set("epoch_id",d[94]),d[96]=d[47].get("forward_edge"),d[47],d[96]?d[97]=!1:d[97]=!0,d[97]?d[98]=!1:d[98]=!0,d[99]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[99],void 0)?d[100]=!0:d[100]=!1,d[101]="",d[102]=c.i64.of_int32(d[73].length),c.i64.gt(d[102],c.i64.cast([0,0]))?c.loopAsync(d[102],function(a){return d[103]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],d[103]).then(function(a){return a=a,d[104]=a[0],d[105]=a[1],a})},function(a){return d[106]=d[104].get("code"),d[104],d[107]=d[104].get("src_line"),d[104],d[108]=d[104].get("error_msg"),d[104],d[109]=d[104].get("code"),d[104],d[110]=d[104].get("src_line"),d[104],d[111]=d[104].get("error_msg"),d[104],d[112]=d[104].get("code"),d[104],d[113]=d[104].get("src_line"),d[104],d[114]=d[104].get("error_msg"),d[104],d[101]=[d[101],["at ",d[107],": ","error code ",c.i64.to_string(d[109]),": ",d[114]].join(""),"\n"].join("")}])}):c.resolve()},function(a){return a=[d[88],d[95],d[98],d[100],d[101],d[81]],d[66]=a[0],d[67]=a[1],d[68]=a[2],d[69]=a[3],d[70]=a[4],d[71]=a[5],a}])},function(a){return d[72]=new c.Map(),d[72].set("from",d[66]),d[72].set("to",d[67]),d[72].set("has_forward_edge",d[68]),d[72].set("has_backward_edge",d[69]),d[72].set("error_message",d[70]),d[72].set("result_code",d[71]),d[73]=(d[44].push(d[72]),d[44])}])}):c.resolve()},function(b){return b=[d[34],d[34],a[1],a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[44]],d[37]=b[0],d[38]=b[1],d[39]=b[2],d[40]=b[3],d[41]=b[4],d[42]=b[5],d[43]=b[6],b}])},function(a){return a=[d[37],d[38],d[39],d[40],d[41],d[42],d[43]],d[25]=a[0],d[26]=a[1],d[27]=a[2],d[28]=a[3],d[29]=a[4],d[30]=a[5],d[31]=a[6],a}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Unable to load client state: 24"),d[36]=c.createArray(),void 0!==void 0?d[39]=(d[36].push(void 0),d[36]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure","Unable to load client state: 24",d[36],c.i64.cast([0,3]))},function(e){return d[37]=c.createArray(),d[38]=c.i64.of_int32(a[0].length),c.i64.gt(d[38],c.i64.cast([0,0]))?c.loopAsync(d[38],function(e){return d[39]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[39]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],a})},function(a){return d[42]=d[40].get("from_epoch"),d[40],d[43]=d[42].get("epoch_anon_id"),d[42],c.nativeOperation(b("LSBase64Encode.nop"),d[43]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]!==void 0?d[45]=d[44]:d[45]="",d[46]=d[40].get("from_epoch"),d[40],d[47]=d[46].get("epoch_id"),d[46],d[48]=new c.Map(),d[48].set("anon_id",d[45]),d[48].set("epoch_id",d[47]),d[49]=d[40].get("to_epoch"),d[40],d[50]=d[49].get("epoch_anon_id"),d[49],c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]!==void 0?d[52]=d[51]:d[52]="",d[53]=d[40].get("to_epoch"),d[40],d[54]=d[53].get("epoch_id"),d[53],d[55]=new c.Map(),d[55].set("anon_id",d[52]),d[55].set("epoch_id",d[54]),d[56]=d[40].get("forward_edge"),d[40],d[56]?d[57]=!1:d[57]=!0,d[57]?d[58]=!1:d[58]=!0,d[59]=d[40].get("backward_edge"),d[40],c.blobs.neq(d[59],void 0)?d[60]=!0:d[60]=!1,d[61]=new c.Map(),d[61].set("from",d[48]),d[61].set("to",d[55]),d[61].set("has_forward_edge",d[58]),d[61].set("has_backward_edge",d[60]),d[61].set("result_code",c.i64.cast([0,7])),d[61].set("error_message",void 0),d[62]=(d[37].push(d[61]),d[37])}])}):c.resolve()},function(b){return b=[void 0,void 0,void 0,a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[37]],d[25]=b[0],d[26]=b[1],d[27]=b[2],d[28]=b[3],d[29]=b[4],d[30]=b[5],d[31]=b[6],b}])},function(a){return a=[d[25],d[26],d[27],d[28],d[29],d[30],d[31]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],d[13]=a[4],d[14]=a[5],d[15]=a[6],a}]))})},function(a){return d[17]=c.i64.of_float(Date.now()),d[18]=new c.Map(),d[18].set("local_device_id",d[9]),d[18].set("decryption_device_id",d[10]),d[18].set("target_device_id",d[11]),d[18].set("epoch_sync_reason",d[12]),d[18].set("start_ms",d[8]),d[18].set("end_ms",d[17]),d[18].set("results",d[15]),d[19]=c.toJSON(d[18]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_record_epoch_sync",c.i64.cast([0,50039]),d[19],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],a})}]):c.resolve()},function(a){return d[2]=c.i64.of_float(Date.now()),d[3]=c.i64.random(),d[5]="Finishing execution. Execution time: ",d[6]=c.i64.to_string(c.i64.sub(d[2],d[0])),d[7]=" ms",d[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] ",d[4],d[5],d[4],d[6],d[4],d[7]].join("")),c.i64.eq(c.i64.mod_(d[3],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[8]=",",d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure",[d[5],d[8],d[6],d[8],d[7]].join(""),d[9],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure";e.exports=a}),null);
__d("LSDeriveAndStoreEpochsStoredProcedure",["LSDeriveAndStoreEpochs","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.epochEdges;d[1]=b.targetDeviceId;d[2]=b.epochSyncReason;d[3]=b.traceId;return c("LSDeriveAndStoreEpochs").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSMEBDeviceReenrollmentReason",[],(function(a,b,c,d,e,f){a=Object.freeze({UNIT_TEST:1,UPLOAD_FAILED_WITH_NO_DEVICE_FOUND:2,LOCAL_DEVICE_ID_NOT_IN_FETCH_BACKUPS_RESULT:3,RESTORE_FAILED_WITH_NO_DEVICE_FOUND:4,EPOCH_DOWNLOAD_UNRECOVERABLE_ERROR:5,OPT_OUT_DELTA_FROM_DEVICE_PRUNING:6,UPLOAD_FAILED_WITH_INCORRECT_FINGERPRINT_FROM_CORRUPT_EPOCH:7,INIT_SEV_REMEDIATION:8});f["default"]=a}),66);
__d("MEBEncryptionVersion",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,ENCRYPTION_KDF_WITH_VERSION:2,ENCRYPTION_KDF_WITH_NULL_SALT:3,ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY:4,TEST_VERSION:99});f["default"]=a}),66);
__d("MEBEpochSyncReason",[],(function(a,b,c,d,e,f){a=Object.freeze({EMPTY_RESTORE_PAYLOAD:-3,NONE_PROVIDED_BY_CLIENT:-2,NONE_PROVIDED_BY_SERVER:-1,SNAPSHOT_RESTORE:0,POINT_QUERY_RESTORE:1,RANGE_QUERY_RESTORE:2,MESSAGE_QUERY_RESTORE:3,SURROUNDING_RESTORE:4,DOWNLOAD_EPOCHS_V2:5,PREPARE_OPEN_EPOCH:6,HANDLE_OPEN_EPOCH_SUCCESS:7,HANDLE_INIT_GET_SECRETS:8,DERIVE_ONBOARDING_MATERIAL:9,DECRYPT_AND_WRITE_MESSAGES:10,RESTORE_WITH_SERIALIZER:11,FINISH_ADD_PEER_DEVICE:12});f["default"]=a}),66);
__d("handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"encryption_version",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"encrypted_protobuf_stanza",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"protobuf_timestamp_ms",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"sk_ciphertext",storageKey:null},g=[b,c];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMessage",kind:"LinkedField",name:"encrypted_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEchoDocument",kind:"LinkedField",name:"echo_document",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"echo_document_string",storageKey:null},a,b,c,{alias:null,args:null,kind:"ScalarField",name:"epoch_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"otid",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanzas",kind:"LinkedField",name:"protobuf_stanzas",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"top_level_protobuf",plural:!1,selections:[d,a,b,c,e,f],storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"supplemental_protobufs",plural:!0,selections:[d,a,b,c,e,f,{alias:null,args:null,kind:"ScalarField",name:"supplemental_key",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},{alias:null,args:null,concreteType:"XFBMessageRangeInfo",kind:"LinkedField",name:"message_range_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_more_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_more_after",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_after",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_delete_mailbox",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:g,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:g,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null}],storageKey:null}],storageKey:null}],type:"XFBEncryptedBackupMessages",abstractKey:null}}();e.exports=a}),null);
__d("handleRestoreMessagesGraphQLResponse",["EchoMessage","I64","LSAuthorityLevel","LSDecryptMessageProtobufsStoredProcedure","LSDecryptMessagesStoredProcedure","LSDeleteAndReenrollDeviceStateStoredProcedure","LSDeriveAndStoreEpochsStoredProcedure","LSDict","LSFactory","LSIntEnum","LSMEBDeviceReenrollmentReason","LSMEBTaskCreationSource","LSShape","LSVec","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MEBEncryptionVersion","MEBEpochSyncReason","ReQL","WALogger","asyncToGeneratorRuntime","handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Protobuf decryption failed in search range restore response"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to decode echo message in search response - message is null"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is not complete - cannot proceed with graphQL restore"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] backup_id is null - cannot proceed with graphQL restore"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is null - cannot proceed with graphQL restore"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web Client state is null - unable to proceed with GQL restore"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message with no echo document and no protobuf data"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] echo_document_string or echo_epoch_anon_id is null for a message in the GraphQL range restore response"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] otid is null for a message in the GraphQL range restore response"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message is null in the GraphQL range restore response"]);t=function(){return a};return a}var u=c("requireDeferred")("LSRestoreEchoBlobs.nop").__setRef("handleRestoreMessagesGraphQLResponse"),v=c("requireDeferred")("LSRestoreProtobufs.nop").__setRef("handleRestoreMessagesGraphQLResponse");function w(a){if(a==null)return c("MEBEncryptionVersion").UNKNOWN;switch(a){case"ENCRYPTION_KDF_WITH_NULL_SALT":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_NULL_SALT;case"ENCRYPTION_KDF_WITH_VERSION":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_VERSION;case"ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY;case"TEST_VERSION":return c("MEBEncryptionVersion").TEST_VERSION;default:return c("MEBEncryptionVersion").UNKNOWN}}function x(a,b){var e=[];a=(a=a==null?void 0:a.map(function(a){var f,g,h,k,l,m,n;if(a==null){d("WALogger").ERROR(t());return}var o=a.otid;if(o==null){d("WALogger").ERROR(s());return}f=(f=a.echo_document)==null?void 0:f.echo_document_string;g=(g=a.echo_document)==null?void 0:g.epoch_anon_id;h=(h=a.echo_document)==null?void 0:h.epoch_fingerprint;var p=a.protobuf_stanzas;k=p==null?void 0:(k=p.top_level_protobuf)==null?void 0:k.encrypted_protobuf_stanza;l=p==null?void 0:(l=p.top_level_protobuf)==null?void 0:l.epoch_anon_id;m=p==null?void 0:(m=p.top_level_protobuf)==null?void 0:m.epoch_id;n=p==null?void 0:(n=p.top_level_protobuf)==null?void 0:n.protobuf_timestamp_ms;var u=p==null?void 0:p.supplemental_protobufs;if(f==null||g==null){d("WALogger").ERROR(r());return}if(k==null||l==null||m==null||n==null)if(f.length===0){d("WALogger").ERROR(q());return}else{var v;e.push(d("LSShape").ofRecord({backup_id:Number(b),encryption_version:w((v=a.echo_document)==null?void 0:v.encryption_version),epoch_anon_id:new TextEncoder().encode(g).buffer,epoch_fingerprint:h!=null?new TextEncoder().encode(h).buffer:void 0,epoch_id:((v=a.echo_document)==null?void 0:v.epoch_id)!=null?(i||(i=d("I64"))).of_string(a.echo_document.epoch_id):void 0,otid:o,value:f}));return}if(p!=null){a=d("LSShape").ofRecord({backup_id:Number(b),encryption_version:(j||(j=d("LSIntEnum"))).ofNumber(w((v=a.echo_document)==null?void 0:v.encryption_version)),epoch_anon_id:new TextEncoder().encode(g).buffer,epoch_fingerprint:h!=null?new TextEncoder().encode(h).buffer:void 0,value:f});g=d("LSShape").ofRecord({encrypted_protobuf:k,encryption_version:j.ofNumber(w(p==null?void 0:(v=p.top_level_protobuf)==null?void 0:v.encryption_version)),epoch_anon_id:new TextEncoder().encode(l).buffer,epoch_id:(i||(i=d("I64"))).of_string(m),protobuf_timestamp_ms:i.of_string(n)});var x=new(c("LSDict"))();u==null?void 0:u.forEach(function(a){var b=a==null?void 0:a.supplemental_key,c=a==null?void 0:a.encrypted_protobuf_stanza,e=a.epoch_anon_id,f=a==null?void 0:a.epoch_id,g=a==null?void 0:a.protobuf_timestamp_ms;if(c==null||e==null||f==null||g==null||b==null)return;x.set(b,d("LSShape").ofRecord({encrypted_protobuf:c,encryption_version:(j||(j=d("LSIntEnum"))).ofNumber(w(a==null?void 0:a.encryption_version)),epoch_anon_id:new TextEncoder().encode(e).buffer,epoch_id:(i||(i=d("I64"))).of_string(f),protobuf_timestamp_ms:i.of_string(g),sk_ciphertext:a==null?void 0:a.sk_ciphertext}))});return d("LSShape").ofRecord({encrypted_echo_message:a,encrypted_protobufs:d("LSShape").ofRecord({supplemental_protobufs:x,toplevel_protobuf:g}),otid:o})}}).filter(Boolean))!=null?a:[];return{encryptedEchoMessages:e,encryptedMessagesWithProtobufs:a}}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupId,e=a.encryptedMessages,g=a.isPointQuery,h=a.messageRangeInfo,k=a.sortOrderMs,l=a.source,m=a.storage,n=a.threadId,o=a.traceId;a=x(e,b);var p=a.encryptedEchoMessages,q=a.encryptedMessagesWithProtobufs;b=(e=h)!=null?e:{};var r=b.has_more_after,s=b.has_more_before,t=b.next_message_timestamp_ms_after,w=b.next_message_timestamp_ms_before;if(s==null||r==null||t==null||w==null)return;if(q.length===0){a=(yield m.runInTransaction(function(a){return c("LSDecryptMessagesStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessages:c("LSVec").ofArray(p)})},"readwrite",void 0,void 0,f.id+":314"));h=a[0];if(h!=null){var y=c("LSVec").toArray(h).map(function(a){return d("LSShape").toRecord(a).value});c("promiseDone")(u.load().then(function(a){return m.runInTransaction(function(b){return a(b,0,(i||(i=d("I64"))).zero,c("LSVec").ofArray(y),s,i.of_string(w),r,i.of_string(t),g,n,o,k!=null?(i||(i=d("I64"))).to_string(k):void 0,(j||(j=d("LSIntEnum"))).ofNumber((b=l)!=null?b:c("LSMEBTaskCreationSource").UNKNOWN))},"readwrite",void 0,void 0,f.id+":330")}))}}else{var z=(yield m.runInTransaction(function(a){return c("LSDecryptMessageProtobufsStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessagesWithProtobufs:c("LSVec").ofArray(q)})},"readwrite",void 0,void 0,f.id+":352"));c("promiseDone")(v.load().then(function(a){return m.runInTransaction(function(b){return a(b,0,n,(b=z[0])!=null?b:c("LSVec").ofArray([]),s,(i||(i=d("I64"))).of_string(w),r,i.of_string(t),g,o,k!=null?(i||(i=d("I64"))).to_string(k):void 0,void 0,c("LSVec").ofArray([]),(j||(j=d("LSIntEnum"))).ofNumber((b=l)!=null?b:c("LSMEBTaskCreationSource").UNKNOWN))},"readwrite",void 0,void 0,f.id+":362")}))}});return z.apply(this,arguments)}function a(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=(yield (b=d("ReQL")).firstAsync(b.fromTableAscending(a.tables.secure_encrypted_backups_client_state)));b=(yield b.toArrayAsync(b.fromTableAscending(a.tables.secure_encrypted_backups_epochs)));a=b.filter(function(a){return a.authorityLevel!==c("LSAuthorityLevel").AUTHORITATIVE}).map(function(a){return(i||(i=d("I64"))).to_float(a.epochId)});if(e==null){d("WALogger").ERROR(p());return}b=e.deviceId;var f=e.mailboxRootKeyBlob;e=e.ocmfClientStateBlob;return{device_id:b,locally_available_epochs:a,mailboxRootKey:f,ocmfClientStateBlob:e}});return A.apply(this,arguments)}function B(a,b,c,d){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g){g!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"derive_and_store_epochs",traceId:g,type:"none"});if(a!=null){a=a.epoch_edges;var h=[],k=new TextEncoder();a!=null&&a.forEach(function(a){var b=a.from_epoch,c=a.to_epoch,e=a.forward_edge,f=e==null?void 0:e.auth_public_key,g=e==null?void 0:e.encrypted_entropy,j=e==null?void 0:e.entropy_fingerprint,l=e==null?void 0:e.epoch_storage_public_key;e=e==null?void 0:e.psk_fingerprint;var m;f!=null&&g!=null&&(m=d("LSShape").ofRecord({auth_public_key:k.encode(f).buffer,encrypted_entropy:k.encode(g).buffer,entropy_fingerprint:j!=null?k.encode(j).buffer:void 0,epoch_storage_public_key:l!=null?k.encode(l).buffer:void 0,psk_fingerprint:e!=null?k.encode(e).buffer:void 0}));f=b==null?void 0:b.epoch_anon_id;g=b==null?void 0:b.epoch_id;j=c==null?void 0:c.epoch_anon_id;l=c==null?void 0:c.epoch_id;f!=null&&g!=null&&j!=null&&l!=null&&h.push(d("LSShape").ofRecord({backward_edge:a.backward_edge!=null?k.encode(a.backward_edge).buffer:void 0,forward_edge:m,from_epoch:d("LSShape").ofRecord({epoch_anon_id:k.encode(f).buffer,epoch_id:(i||(i=d("I64"))).of_string(g)}),from_epoch_fingerprint:a.from_epoch_fingerprint!=null?k.encode(a.from_epoch_fingerprint).buffer:void 0,to_epoch:d("LSShape").ofRecord({epoch_anon_id:k.encode(j).buffer,epoch_id:i.of_string(l)}),to_epoch_fingerprint:a.to_epoch_fingerprint!=null?k.encode(a.to_epoch_fingerprint).buffer:void 0}))});yield b.runInTransaction(function(a){return c("LSDeriveAndStoreEpochsStoredProcedure")(c("LSFactory")(a),{epochEdges:c("LSVec").ofArray(h),epochSyncReason:(j||(j=d("LSIntEnum"))).ofNumber(c("MEBEpochSyncReason").DECRYPT_AND_WRITE_MESSAGES),targetDeviceId:e,traceId:g})},"readwrite",void 0,void 0,f.id+":508")}});return C.apply(this,arguments)}function e(a,b,c,d,e,f,g,h){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g,h,i,k,l){var p=a;if(p==null){i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"null_messages",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(i));return}var q=p.backup_id,r=p.encrypted_messages,s=p.epoch_derivation_set,t=p.message_range_info;p=p.should_delete_mailbox;p===!0&&(i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"delete_mailbox",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(i)),yield b.runInTransaction(function(a){return c("LSDeleteAndReenrollDeviceStateStoredProcedure")(c("LSFactory")(a),{reenrollmentReason:(j||(j=d("LSIntEnum"))).ofNumber(c("LSMEBDeviceReenrollmentReason").RESTORE_FAILED_WITH_NO_DEVICE_FOUND),targetDeviceId:g})},"readwrite",void 0,void 0,f.id+":570"));yield B(s,b,g,i);if(r.length===0){i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"no_messages",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(i));return}if(t==null){i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"message_range_info_null",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(i));d("WALogger").ERROR(o());return}if(q==null){i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"backup_id_null",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(i));d("WALogger").ERROR(n());return}p=t.has_more_after;s=t.has_more_before;var u=t.next_message_timestamp_ms_after,v=t.next_message_timestamp_ms_before;if(s==null||p==null||u==null||v==null){i!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:" message_range_info_incomplete",traceId:i,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(i));d("WALogger").ERROR(m());return}yield y({backupId:q,encryptedMessages:r,isPointQuery:l,messageRangeInfo:t,sortOrderMs:h,source:k,storage:b,threadId:e,traceId:i});return a});return D.apply(this,arguments)}h!==void 0?h:h=b("handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql");function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupId,e=a.encryptedMessages,g=a.messageRangeInfo,h=a.sortOrderMs,j=a.source,m=a.storage,n=a.threadId;a=a.traceId;e=x(e,b);var o=e.encryptedEchoMessages,p=e.encryptedMessagesWithProtobufs;e=(b=g)!=null?b:{};g=e.has_more_after;b=e.has_more_before;var q=e.next_message_timestamp_ms_after;e=e.next_message_timestamp_ms_before;if(b==null||g==null||q==null||e==null)return;if(p.length===0){var r=(yield m.runInTransaction(function(a){return c("LSDecryptMessagesStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessages:c("LSVec").ofArray(o)})},"readwrite",void 0,void 0,f.id+":755"));r=r[0];if(r!=null){r=c("LSVec").toArray(r).map(function(a){return d("LSShape").toRecord(a).value}).map(function(a){a=d("EchoMessage").decodeEchoMessage(a);if(a==null){d("WALogger").ERROR(l());return}return a}).filter(Boolean);r={echoMessages:r,hasMoreAfter:g,hasMoreBefore:b,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:(i||(i=d("I64"))).of_string(q),nextMessageTimestampMsBefore:i.of_string(e),referenceTimestamp:h!=null?(i||(i=d("I64"))).to_string(h):void 0,requestId:a,taskSource:j!=null?j:void 0};return r}}else{r=(yield m.runInTransaction(function(a){return c("LSDecryptMessageProtobufsStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessagesWithProtobufs:c("LSVec").ofArray(p)})},"readwrite",void 0,void 0,f.id+":800"));if(r[0]==null){d("WALogger").ERROR(k());return}m=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(r[0]);r={hasMoreAfter:g,hasMoreBefore:b,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:(i||(i=d("I64"))).of_string(q),nextMessageTimestampMsBefore:i.of_string(e),protobufMessages:m,referenceTimestamp:h!=null?(i||(i=d("I64"))).to_string(h):void 0,requestId:a,taskSource:j!=null?j:void 0};return r}});return F.apply(this,arguments)}g.getClientState=a;g.deriveAndStoreEpochs=B;g.handleGraphQLRestoreResponse=e;g.processEncryptedMessagesForSearch=E}),98);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQL",["EBAPIWorkerCheck","I64","LSDatabaseSingleton","MAWCurrentUser","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql","MAWJobDefinitions","WABase64","WAJids","WALogger","WAResultOrError","WorkerRelay","WorkerRelayEnvironment","asyncToGeneratorRuntime","gkx","handleRestoreMessagesGraphQLResponse"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] getMessagesFromBackup error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] mandatory params of client state are null"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory params of client state are null"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL point query incorrectly called from worker context"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL point query called from non-worker context"]);o=function(){return a};return a}var p=h!==void 0?h:h=b("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql");function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b==="GQL_WORKER"&&!d("EBAPIWorkerCheck").runningInWorker()){d("WALogger").ERROR(o());return d("WAResultOrError").makeError(null)}if(b==="GQL_MAIN_THREAD"&&d("EBAPIWorkerCheck").runningInWorker()){d("WALogger").ERROR(n());return d("WAResultOrError").makeError(null)}var c=a.messageId,e=a.sortOrderMs,f=a.source,g=a.threadId;a=a.traceId;var h=(yield (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton),k=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(h));if(k==null){a!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:a,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a));return d("WAResultOrError").makeError(null)}var l=k.device_id,q=k.locally_available_epochs,r=k.mailboxRootKey;k=k.ocmfClientStateBlob;if(l==null||r==null||k==null){a!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"mandatory_params_client_state_null",traceId:a,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a));d("WALogger").ERROR(m());return d("WAResultOrError").makeError(null)}var s=d("MAWCurrentUser").getAppID();d("MAWEBRestoreTrackingUtils").markEBRestorePoint(f,a,b);yield d("WorkerRelayEnvironment").createWorkerRelayEnvironment();b={restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(g),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(j||(j=d("I64"))).to_float(l),locally_available_epochs:q,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(r),ocmf_client_state_blob:d("WABase64").encodeB64(k)}},message_id:c}};e!=null&&(b=babelHelpers["extends"]({},b,{reference_timestamp:(j||(j=d("I64"))).to_float(e)}));r=(yield d("WorkerRelay").createWorkerQuery(p,{app_id:String((q=s)!=null?q:"0"),restore_payload_string:JSON.stringify(b),restore_type:"POINT_QUERY_RESTORE"}));if(r!=null&&(r==null?void 0:(k=r.viewer)==null?void 0:(c=k.encrypted_backup)==null?void 0:c.mailbox)!=null){a!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_point_restore_response_nonnull",traceId:a,type:"none"});k=(yield d("handleRestoreMessagesGraphQLResponse").handleGraphQLRestoreResponse(r==null?void 0:(s=r.viewer)==null?void 0:(q=s.encrypted_backup)==null?void 0:(b=q.mailbox)==null?void 0:b.messages,h,g,l,e,a,f,!0));return k==null?d("WAResultOrError").makeError(null):d("WAResultOrError").makeResult(k)}return d("WAResultOrError").makeError(null)});return q.apply(this,arguments)}function e(a,b,c,d,e,f){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h){try{var i=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(b));if(i==null){g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(g));return}var m=i.device_id,n=i.locally_available_epochs,o=i.mailboxRootKey;i=i.ocmfClientStateBlob;if(m==null||o==null||i==null){g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(g));d("WALogger").ERROR(l());return}var q=d("MAWCurrentUser").getAppID();a=d("WAJids").threadIdForChatJid(a);d("MAWEBRestoreTrackingUtils").markEBRestorePaginated(h,g,"GQL_MAIN_THREAD");yield d("WorkerRelayEnvironment").createWorkerRelayEnvironment();q=(yield d("WorkerRelay").createWorkerQuery(p,{app_id:String((q=q)!=null?q:"0"),restore_payload_string:JSON.stringify({restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(a),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(j||(j=d("I64"))).to_float(m),locally_available_epochs:n,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(o),ocmf_client_state_blob:d("WABase64").encodeB64(i)}},direction:f,include_offset:c("gkx")("5340"),reference_timestamp:j.to_float(e),server_thread_key:a}}),restore_type:"RANGE_QUERY_RESTORE"}));if(q!=null&&(q==null?void 0:(n=q.viewer)==null?void 0:(o=n.encrypted_backup)==null?void 0:o.mailbox)!=null){g!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_range_restore_response_nonnull",traceId:g,type:"none"});yield d("handleRestoreMessagesGraphQLResponse").handleGraphQLRestoreResponse(q==null?void 0:(i=q.viewer)==null?void 0:(f=i.encrypted_backup)==null?void 0:(n=f.mailbox)==null?void 0:n.messages,b,a,m,e,g,h,!1)}return q}catch(a){d("WALogger").ERROR(k(),a),g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_range_restore_exception",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(g))}});return r.apply(this,arguments)}g.query=p;g.getPointRestoreResponseFromGQL=a;g.getMessagesFromBackup=e}),98);
__d("MWRestoreMessagesFromEB",["I64","LSAppendDataTraceAddonStoredProcedure","LSDataTraceCheckPoint","LSDataTraceType","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsMessagesRangeQueryDirection","LSFactory","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsRestoreMessageOverGraphQL","MAWMainTraceUtils","MWEncryptedBackUpEBNotEnabledError","Promise","WAJids","WATagsLogger","asyncToGeneratorRuntime","err","gkx","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][","] Issuing message range query for thread: "," startSortKey: "," numMessages: ","} "]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Issuing message range query for chatJid: "," skipped. EB not enabled"]);l=function(){return a};return a}function a(a){a._threadId;var e=a.chatJid,f=a.newerNumMessages,g=a.numMessages,k=a.passedTraceId,n=a.sortOrderMs,o=a.source,p=a.storage;if(!c("gkx")("23914"))return null;var q=k!=null?k:d("MAWMainTraceUtils").createTraceId();c("promiseDone")(d("MAWEncryptedBackupUtils").getBackupTenancy(p.tables).then(function(a){if(a!=null&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return c("qex")._("1776")===!0||c("gkx")("5976")?d("MAWEncryptedBackupsRestoreMessageOverGraphQL").getMessagesFromBackup(e,p,n,(i||(i=d("I64"))).to_float(f)>0?c("LSEncryptedBackupsMessagesRangeQueryDirection").AFTER:c("LSEncryptedBackupsMessagesRangeQueryDirection").BEFORE,q,o):m({chatJid:e,newerNumMessages:f,numMessages:g,passedTraceId:k,sortOrderMs:n,source:o,storage:p,traceId:q});else{d("WATagsLogger").TAGS(["labyrinth_web","eb_restore"]).WARN(l(),e);d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(q,c("err")(d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED));return(h||(h=b("Promise"))).resolve()}}));return q}function m(a){var e=a.chatJid,g=a.newerNumMessages,h=a.numMessages,l=a.passedTraceId,m=a.sortOrderMs,n=a.source,o=a.storage,p=a.traceId;return o.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("MAWMainTraceUtils").startTraceWithTxn(a,(i||(i=d("I64"))).of_float(Date.now()),p,(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE));yield c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:j.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ISSUE_MESSAGE_RANGE_QUERY),dataTraceId:p,syncChannel:i.neg_one});d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",p]).LOG(k(),p,e,i.to_string(m),i.to_string(h));d("MAWEBRestoreTrackingUtils").markEBRestorePaginated(n,l,"LS");return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),{includeOffset:c("gkx")("5340"),isPointQuery:!1,newerNumMessages:g,numMessages:h,source:j.ofNumber((a=n)!=null?a:c("LSMEBTaskCreationSource").UNKNOWN),startSortKey:i.to_string(m),threadId:d("WAJids").threadIdForChatJid(e),traceId:p})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":131")}g["default"]=a}),98);
__d("EBLSMessageRangeQuery",["EBFormatUtils","FBLogger","I64","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MWEncryptedBackUpEBNotEnabledError","MWRestoreMessagesFromEB","Promise","WAPushSafeTypes","WAResultOrError","asyncToGeneratorRuntime","cr:10036"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(b("cr:10036")==null)return(i||(i=b("Promise"))).reject("Calling EBLS without EBLS being available for message range query");a=d("WAPushSafeTypes").unsafeNotNullable(a);var e=a.chatJid,f=a.direction,g=a.timestampMs;a=a.traceId;yield b("cr:10036").init();var j=(yield b("cr:10036").getLSStorage()),k=d("EBFormatUtils").adjustCount(20,f),l=k[0];k=k[1];e=c("MWRestoreMessagesFromEB")({chatJid:e,newerNumMessages:(h||(h=d("I64"))).of_int32(k),numMessages:h.of_int32(l),passedTraceId:a,sortOrderMs:d("EBFormatUtils").adjustTs(g,f),source:c("LSMEBTaskCreationSource").MESSENGER_MESSAGE_LIST_PAGINATION,storage:j});if(e==null)return d("WAResultOrError").makeResult({hasMoreAfter:!1,hasMoreBefore:!1,messages:[],restoreType:"none"});k=d("MAWAsyncEBPendingQueryPromise").getWaitForRestorePromiseFromTrace(e);return k.then(function(a){var b=a.hasMoreAfter,c=a.hasMoreBefore,e=a.messages;a=a.restoreType;return d("WAResultOrError").makeResult({hasMoreAfter:b,hasMoreBefore:c,messages:e,restoreType:a})})["catch"](function(a){if(a&&(a==null?void 0:a.message)===d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED)return d("WAResultOrError").makeError(d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[EBFetch] Failed to fetch");return d("WAResultOrError").makeError(null)})});return j.apply(this,arguments)}g.messageRangeQuery=a}),98);
__d("EBMessageMetadataQueryQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8744995708862431"}),null);
__d("EBMessageMetadataQueryQuery.graphql",["EBMessageMetadataQueryQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"data"}],c={alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"data",variableName:"data"}],concreteType:"XFBTDeanonMessagesResponse",kind:"LinkedField",name:"deanon_messages_metadata",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"offline_threading_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sort_order_ms",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"EBMessageMetadataQueryQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"EBMessageMetadataQueryQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("EBMessageMetadataQueryQuery_facebookRelayOperation"),metadata:{},name:"EBMessageMetadataQueryQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EBMessageMetadataQuery",["CometRelay","EBAPIQPLPoints","EBMessageMetadataQueryQuery.graphql","FBLogger","QPLUserFlow","WAHashStringToNumber","WAResultOrError","XPlatRelayEnvironment","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("EBMessageMetadataQueryQuery.graphql");function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.direction,e=a.instanceKey,f=a.numberOfMessages,g=a.referenceTimestamp;g=g===void 0?null:g;a=a.threadId;var h=e!=null?d("WAHashStringToNumber").hashStringToNumber(e):void 0;try{c("QPLUserFlow").start(c("qpl")._(521476771,"2454"),{instanceKey:h});var j=d("XPlatRelayEnvironment").getRelayEnvironment();b=b==="after"?"AFTER":"BEFORE";c("QPLUserFlow").addPoint(c("qpl")._(521476771,"2454"),d("EBAPIQPLPoints").EBMessageMetadataQPLPoints.GRAPHQL_QUERY_START,{instanceKey:h});j=(yield d("CometRelay").fetchQuery(j,i,{data:{act_thread_id:a,direction:b,reference_timestamp:g,requested_messages:f}}).toPromise());c("QPLUserFlow").addPoint(c("qpl")._(521476771,"2454"),d("EBAPIQPLPoints").EBMessageMetadataQPLPoints.GRAPHQL_QUERY_END,{instanceKey:h});j=(f=j==null?void 0:(a=j.viewer)==null?void 0:(b=a.encrypted_backup)==null?void 0:(g=b.mailbox)==null?void 0:g.deanon_messages_metadata)!=null?f:[];a=j.map(function(a){var b=a.offline_threading_id;a=a.sort_order_ms;return{offlineThreadingId:b,sortOrderMs:a}});c("QPLUserFlow").endSuccess(c("qpl")._(521476771,"2454"),{instanceKey:h});return d("WAResultOrError").makeResult({instanceKey:e,messages:a})}catch(a){c("FBLogger")("labyrinth_web").catching(a).mustfix("Error querying messaging metadata from EBMessageMetadataQuery");c("QPLUserFlow").endFailure(c("qpl")._(521476771,"2454"),"error",{error:a,instanceKey:h});return d("WAResultOrError").makeError("error",a)}});return j.apply(this,arguments)}g.messageMetadataQuery=a}),98);
__d("EBMessageRangeQueryForIndexing",["I64","LSDeleteAndReenrollDeviceStateStoredProcedure","LSFactory","LSIntEnum","LSMEBDeviceReenrollmentReason","MAWCurrentUser","MAWEncryptedBackupsRestoreMessageOverGraphQL","MAWJobDefinitions","WABase64","WAJids","WALogger","WAPushSafeTypes","WAResultOrError","WorkerRelay","asyncToGeneratorRuntime","cr:10036","gkx","handleRestoreMessagesGraphQLResponse"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] graphQL range restore error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is not complete - cannot proceed with graphQL restore"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] backup_id is null - cannot proceed with graphQL restore"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is null - cannot proceed with graphQL restore"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No messages to restore - cannot proceed with graphQL restore"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Deleting mailbox - unable to restore"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL worker range restore query returned null for message response"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory params of client state are null"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No client state found - unable to restore"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling EBLS without EBLS being available for message range query"]);s=function(){return a};return a}function a(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(b("cr:10036")==null){d("WALogger").ERROR(s());return d("WAResultOrError").makeError()}yield b("cr:10036").init();var e=(yield b("cr:10036").getLSStorage());a=d("WAPushSafeTypes").unsafeNotNullable(a);var f=a.chatJid,g=a.direction,t=a.sortOrderMs,u=a.source;a=a.traceId;try{var v=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(e));if(v==null){d("WALogger").ERROR(r());return d("WAResultOrError").makeError()}var w=v.device_id,x=v.locally_available_epochs,y=v.mailboxRootKey;v=v.ocmfClientStateBlob;if(w==null||y==null||v==null){d("WALogger").ERROR(q());return d("WAResultOrError").makeError()}var z=d("MAWCurrentUser").getAppID();f=d("WAJids").threadIdForChatJid(f);z=(yield d("WorkerRelay").createWorkerQuery(d("MAWEncryptedBackupsRestoreMessageOverGraphQL").query,{app_id:String((z=z)!=null?z:"0"),restore_payload_string:JSON.stringify({restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(f),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(h||(h=d("I64"))).to_float(w),locally_available_epochs:x,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(y),ocmf_client_state_blob:d("WABase64").encodeB64(v)}},direction:g,include_offset:c("gkx")("5340"),reference_timestamp:h.to_float(t),server_thread_key:f}}),restore_type:"RANGE_QUERY_RESTORE"}));if(z!=null&&(z==null?void 0:(x=z.viewer)==null?void 0:(y=x.encrypted_backup)==null?void 0:y.mailbox)!=null){y=z==null?void 0:(v=z.viewer)==null?void 0:(g=v.encrypted_backup)==null?void 0:(x=g.mailbox)==null?void 0:x.messages;if(y==null){d("WALogger").ERROR(p());return d("WAResultOrError").makeError()}z=y;if(z!=null){v=z.backup_id;g=z.encrypted_messages;x=z.epoch_derivation_set;y=z.message_range_info;z=z.should_delete_mailbox;z===!0&&(d("WALogger").WARN(o()),yield e.runInTransaction(function(a){return c("LSDeleteAndReenrollDeviceStateStoredProcedure")(c("LSFactory")(a),{reenrollmentReason:(i||(i=d("LSIntEnum"))).ofNumber(c("LSMEBDeviceReenrollmentReason").RESTORE_FAILED_WITH_NO_DEVICE_FOUND),targetDeviceId:w})},"readwrite"));yield d("handleRestoreMessagesGraphQLResponse").deriveAndStoreEpochs(x,e,w,a);if(g.length===0){d("WALogger").ERROR(n());return d("WAResultOrError").makeError()}if(y==null){d("WALogger").ERROR(m());return d("WAResultOrError").makeError()}if(v==null){d("WALogger").ERROR(l());return d("WAResultOrError").makeError()}z=y.has_more_after;x=y.has_more_before;var A=y.next_message_timestamp_ms_after,B=y.next_message_timestamp_ms_before;if(x==null||z==null||A==null||B==null){d("WALogger").ERROR(k());return d("WAResultOrError").makeError()}x=(yield d("handleRestoreMessagesGraphQLResponse").processEncryptedMessagesForSearch({backupId:v,encryptedMessages:g,messageRangeInfo:y,sortOrderMs:t,source:u,storage:e,threadId:f,traceId:a}));return x==null?d("WAResultOrError").makeError():d("WAResultOrError").makeResult(x)}}}catch(a){d("WALogger").ERROR(j(),a)}return d("WAResultOrError").makeError()});return t.apply(this,arguments)}g.messageRangeQueryForIndexing=a}),98);
__d("EncryptedBackupsConvertToLegacyAttachmentContext",["MAWCastToMsgrServerMediaType","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid "," media type for legacy attachment upload"]);h=function(){return a};return a}function a(a){var b=[];for(var c=0;c<a.length;c++){var e=a[c],f=d("MAWCastToMsgrServerMediaType").castMediaAttachmentTypeToServerMediaType(e.mediaType);f==null?d("WALogger").ERROR(h(),e.mediaType):b.push({mediaObjectId:e.mediaObjectId,mediaType:f})}return b}g["default"]=a}),98);
__d("EncryptedBackupsCastToAttachmentContextMediaType",["EncryptedBackupsUploadEntity","MAWDbMedia","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid AttachmentContextMediaType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.IMAGE;case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.VIDEO;case d("MAWDbMedia").MEDIA_TYPE.PTT:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.PTT;case d("MAWDbMedia").MEDIA_TYPE.GIF:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.GIF;case d("MAWDbMedia").MEDIA_TYPE.STICKER:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.STICKER;case d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.DOCUMENT;default:a;d("WALogger").ERROR(h(),a);return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.INVALID}}g["default"]=a}),98);
__d("MAWGetAllMediaIdsForXMAMsgApi",["MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({xma:d("MAWTransactionMode").READONLY},"getAllMediaIdsForXMAMsg",function(a){return function(b){var c=new Map();b=b.map(function(b){return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(a){var d,e=(d=c.get(b))!=null?d:new Set();a!=null&&(a.faviconMediaId!=null&&e.add(a.faviconMediaId),a.headerMediaId!=null&&e.add(a.headerMediaId),a.previewMediaIds!=null&&a.previewMediaIds.forEach(function(a){return e.add(a)}));c.set(b,e)})});return d("MAWDexieTable").dexieAll(b).then(function(a){return c})}});g.getAllMediaIdsForXMAMsg=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsgXMA",["EncryptedBackupsUploadEntity","MAWDbMediaTxns","MAWGetAllMediaIdsForXMAMsgApi","MAWIndexedDb","MAWTransactionMode","WAMediaUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY},"bulkGetRetroactiveMedia",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWDbMediaTxns").bulkGetMedias.apply(void 0,[a].concat(c))}});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("MAWGetAllMediaIdsForXMAMsgApi").getAllMediaIdsForXMAMsg([a]).then(function(b){b=b.get(a);return b!=null?h(Array.from(b)):[]}));return c.filter(Boolean).flatMap(function(a){var c=b.msgId!=null?a==null?void 0:a.mediaEntries.get(b.msgId):null;c=c!=null?d("WAMediaUtils").decodeMediaEntryData(c):null;var e=[];(c==null?void 0:c.objectId)!=null&&a.mediaType!=null&&e.push({mediaObjectId:c.objectId,mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA});c=c==null?void 0:(a=c.downloadableThumbnail)==null?void 0:a.objectId;c!=null&&e.push({isPreview:!0,mediaObjectId:d("WAMediaUtils").stringToDeliveryObjectId(c),mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW});return e})});return i.apply(this,arguments)}g["default"]=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsg",["EncryptedBackupsCastToAttachmentContextMediaType","EncryptedBackupsGetAttachmentContextForSentMsgXMA","EncryptedBackupsUploadEntity","WAMediaUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.dbMsg,e=a.isXMAMsg,f=a.media;a=a.protocolMsgIdFromArgs;if(e===!0){e=(yield c("EncryptedBackupsGetAttachmentContextForSentMsgXMA")(a,b));return e.filter(Boolean)}a=[];e=b.msgId!=null?f==null?void 0:f.mediaEntries.get(b.msgId):null;e=e!=null?d("WAMediaUtils").decodeMediaEntryData(e):null;if(f==null||e==null)return[];if(e.objectId!=null&&f.mediaType!=null){a.push({mediaObjectId:e.objectId,mediaType:c("EncryptedBackupsCastToAttachmentContextMediaType")(f.mediaType)});f=e.downloadableThumbnail;b.msgId!=null&&(f==null?void 0:f.objectId)!=null&&a.push({isPreview:!0,mediaObjectId:d("WAMediaUtils").stringToDeliveryObjectId(f.objectId),mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW})}return a});return h.apply(this,arguments)}g["default"]=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsgV2",["EncryptedBackupsCastToAttachmentContextMediaType","EncryptedBackupsUploadEntity","WAMediaUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f=new Map(),g=[],h=a.msgId;if(b!=null){a=h!=null?b.mediaEntries.get(h):null;a=a!=null?d("WAMediaUtils").decodeMediaEntryData(a):null;b=c("EncryptedBackupsCastToAttachmentContextMediaType")(b.mediaType);if((a==null?void 0:a.objectId)!=null&&b!=null){var i=a.objectId;f.set(i,b)}if((a==null?void 0:(i=a.downloadableThumbnail)==null?void 0:i.objectId)!=null){b=a.downloadableThumbnail.objectId;f.set(b,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW)}}if(e!=null){if(e.favicon!=null){i=e.favicon.objectId;i!=null&&f.set(i,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}if(e.header!=null){a=e.header.objectId;a!=null&&f.set(a,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}e.previews!=null&&e.previews.length>0&&e.previews.forEach(function(a){a=a.mediaEntries;a=h!=null?a.get(h):null;a=a!=null?d("WAMediaUtils").decodeMediaEntryData(a):null;if((a==null?void 0:a.objectId)!=null){a=a.objectId;f.set(a,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}})}f.forEach(function(a,b){g.push({mediaObjectId:b,mediaType:a})});return g}g["default"]=a}),98);
__d("MessageBackupSupplementalKeyGenerator",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";b=b("$InternalEnum")({REACTION:"reaction",EDIT:"edit"});var g=":";function a(a,b){return""+a+g+b}function c(a){return a.split(g)[1]}function h(a,b){b=b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");b=new RegExp("^"+b,"i");return b.test(a)}function d(a){return h(a,"reaction")}function e(a){return h(a,"edit")}function i(a){return h(a,"raven_action_message")}f.SupplementalKeyPrefix=b;f.SUPPLEMENTAL_KEY_DELIMITER=g;f.createMessageSupplementalKey=a;f.getSupplementalSenderId=c;f.isSupplementalProtobufAReaction=d;f.isSupplementalProtobufAnEdit=e;f.isSupplementalProtobufARavenAction=i}),66);
__d("MessageBackupDirectiveGenerator",["I64","MAWMsgType","MessageBackupSupplementalKeyGenerator","WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.REACTION,(h||(h=d("I64"))).to_string(b))}}function j(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.EDIT,(h||(h=d("I64"))).to_string(b))}}function k(a){if(d("WAJids").isAuthorSystem(a.author))return null;if(a.reactToExternalId!=null)return{author:a.reactToAuthor===d("WAGlobals").getMyUserJid()?"@me":a.reactToAuthor,chat:a.threadJid,externalId:a.reactToExternalId};else if(a.originalMsgExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.originalMsgExternalId};else if(a.revokedExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.revokedExternalId};return a.externalId==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}function a(a){var b=(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(a.author,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),c=k(a);if(c==null)return null;if(a.originalMsgExternalId!=null)return j(c,b);return a.reactToExternalId!=null?i(c,b):l(c,b,a.type)}function l(a,b,c){switch(c){case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return{actionType:1,originalMsgProtocolId:a};case d("MAWMsgType").MSG_TYPE.REACTION:return i(a,b);case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return j(a,b);case d("MAWMsgType").MSG_TYPE.REVOKED:return{actionType:4,originalMsgProtocolId:a};case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:return{actionType:3,originalMsgProtocolId:a};default:return{actionType:0,originalMsgProtocolId:a}}}g.createMessageBackupDirectiveFromDbMsg=a;g.createMessageBackupDirective=l}),98);
__d("EBUploadSentMessage",["EncryptedBackupsConvertToLegacyAttachmentContext","EncryptedBackupsGetAttachmentContextForSentMsg","EncryptedBackupsGetAttachmentContextForSentMsgV2","EncryptedBackupsUploadQueue","I64","LSRequestId","MAWBridge","MAWBridgeUpload","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWMsgType","MAWQplProxy","MessageBackupDirectiveGenerator","WAFrankingTypes","WAGenReportingMeta","WAGlobals","WAHashStringToNumber","WAJids","WALogger","WAResultOrError","WATimeUtils","asyncToGeneratorRuntime","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg adding message "," attachments to EB upload queue"]);i=function(){return a};return a}function j(a){if(a.reactToExternalId!=null)return d("MAWMsgType").MSG_TYPE.REACTION;else if(a.editMsgHistoryId!=null)return d("MAWMsgType").MSG_TYPE.EDIT_ACTION;else if(a.type==null)return null;else return d("MAWMsgType").isEBSupportedMsgType(a.type)?a.type:null}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.dbMsg;a.instanceKey;var e=a.isXMAMsg;e=e===void 0?!1:e;var f=a.media,g=a.messageApplication,k=a.messageApplicationBytes,l=a.protocolMsgId,m=a.serverTs;a=a.xmaPayload;try{if(d("WAJids").isAuthorSystem(b.author))return d("WAResultOrError").makeResult();var n=j(b);if(n==null)return d("WAResultOrError").makeError("Unsupported EB upload message type");var o=d("MessageBackupDirectiveGenerator").createMessageBackupDirectiveFromDbMsg(b);if(o==null)return d("WAResultOrError").makeError("Unable to create backup directive");g=g==null?void 0:g.metadata;var p=[];c("gkx")("2453")?p=c("EncryptedBackupsGetAttachmentContextForSentMsgV2")(b,f,a):p=(yield c("EncryptedBackupsGetAttachmentContextForSentMsg")({dbMsg:b,isXMAMsg:e,media:f,protocolMsgIdFromArgs:l}));d("WALogger").LOG(i(),(a=p)==null?void 0:a.length);d("MAWEBUploadTrackingUtils").addExternalIdToCache(l,n);e=(yield d("WAGenReportingMeta").genReportingMeta(k,(g==null?void 0:g.frankingKey)?d("WAFrankingTypes").castToFrankingKey(new Uint8Array(g==null?void 0:g.frankingKey)):null,g==null?void 0:g.frankingVersion));d("EncryptedBackupsUploadQueue").putMsgsToEbUpload([{attachmentContext:p,backupDirective:o,messageApplication:k,msgId:l,originalMsgProtocolId:o.originalMsgProtocolId.externalId!==l.externalId?o.originalMsgProtocolId:l,reportingMeta:e,senderId:(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(l.author,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),serverTs:m,sortOrderMs:d("WATimeUtils").castToMillisTime(d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder({externalId:l.externalId,serverTs:m,ts:m}))}]);if(p.length>0&&c("gkx")("2453")){f=c("EncryptedBackupsConvertToLegacyAttachmentContext")(p);a=f.map(function(a){return{tag:"UploadAttachment",value:d("MAWBridgeUpload").createBridgeUploadAttachment(a.mediaObjectId,a.mediaType,l.externalId,"msgr",d("WAJids").threadIdForChatJid(l.chat),b.threadJid,m,c("LSRequestId").generate())}});a.forEach(function(a){if(a.tag==="UploadAttachment"){a=a.value;var b=a.deliveryObjectId,e=a.mediaType,f=a.messageId,g=a.threadId;a=a.traceId;a=a!=null?a:c("LSRequestId").generate();d("MAWQplProxy").startQplUserFlow(c("qpl")._(521480391,"1167"),{string:{deliveryObjectId:b,flow:"old",mediaType:e,messageId:f,threadId:g,traceId:a}},d("WAHashStringToNumber").hashStringToNumber(a))}});d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:a})}return d("WAResultOrError").makeResult()}catch(a){return d("WAResultOrError").makeError("runtime-error",a)}});return k.apply(this,arguments)}g.uploadSentMessage=a}),98);
__d("EchoSerializationFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5722");b=d("FalcoLoggerInternal").create("echo_serialization_failure",a);e=b;g["default"]=e}),98);
__d("EchoSerializationSuccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5723");b=d("FalcoLoggerInternal").create("echo_serialization_success",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupTaskSkippedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5727");b=d("FalcoLoggerInternal").create("encrypted_backup_task_skipped",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYISingleton","I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Issuing next range query for thread with thread key ",", server generated next reference timestamp: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["nextTimestampMs was not supplied for thread with thread key ","."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["handling message range query for thread with thread key ",", hasMoreBefore: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread key for thread id: ",""]);l=function(){return a};return a}function a(a,b,c,e,f,g,n){var o=d("EncryptedBackupsDYISingleton").getSingleton(),p=o.getLogger();o=o.getThreadKeyForThreadId(b);if(o==null){p.WARN(l(),b);return}void p.LOG(k(),b,e);c.length>0&&g(o,b,c);if(!e||f==null){e&&f==null&&void p.ERROR(j(),b);m(o);return}g=(h||(h=d("I64"))).to_string(f);void p.LOG(i(),b,g);void n(a,g,b)}function m(a){var b=d("EncryptedBackupsDYISingleton").getSingleton();b.deleteThreadKeyFromThreadsRestoreInProgress(a)}g.handleMessageRangeQueryRestore=a}),98);
__d("EncryptedBackupsDYIMediaDownloadHandlers",["EncryptedBackupsDYIFileUtils","EncryptedBackupsDYISingleton","FBLogger","Promise","WAResultOrError","asyncToGeneratorRuntime","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){f=(yield d("EncryptedBackupsDYIFileUtils").getMediaFolderHandle());b=b.split("/")[1];b=c("uuidv4")()+"."+b;yield d("EncryptedBackupsDYIFileUtils").writeFile(f,b,e);f=d("EncryptedBackupsDYISingleton").getSingleton();f.setMediaUrlByPlainTextHash(a,d("EncryptedBackupsDYIFileUtils").DyiMediaFolder+"/"+b);f.deletePlaintextHashFromAttachmentDownloadsInProgress(a);return d("WAResultOrError").makeResult()});return function(b,c,d,e){return a.apply(this,arguments)}}();e=function(){c("FBLogger")("labyrinth_web").debug("[DYIMediaPreviewHandler] Skipping previews for DYI");return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult())};g.DYIMediaDownloadHandler=a;g.DYIMediaPreviewHandler=e}),98);
__d("LSIssueAttachmentRestoreTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSBinaryToHex.nop","LSCreateDataTrace","LSCreateDataTraceID.nop","LSCreateDerivedKeys.nop","LSFindBackup","LSFlushDataTrace.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] Beginning execution."),a[7]!==void 0?c.resolve(d[1]=a[7]):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))&&c.i64.eq(a.backupTenancy,c.i64.cast([0,2]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?d[27]=!1:(a.item,d[27]=!0)})},function(a){return d[27]?d[29]=c.i64.or_(c.i64.cast([0,82]),c.i64.cast([0,128])):d[29]=c.i64.cast([0,82]),c.sequence([function(a){return c.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,d[31]=a[0],a})},function(a){return c.sequence([function(a){return d[35]="EncryptedBackups MCD Trace ID",d[36]=c.i64.to_string(d[29]),d[34]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",d[34],d[35],d[34],d[36]].join("")),c.resolve()},function(a){return c.storedProcedure(b("LSCreateDataTrace"),d[31],void 0,void 0,"media_restore",d[29])}])},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()},function(a){return d[30]=d[31]}])},function(a){return d[1]=d[30]}])},function(a){return c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,1829]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[27]?d[28]=!0:d[28]=!1,d[28]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[29],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,e){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,20]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],d[9]=f[7],d[10]=f[8],d[11]=f[9],d[12]=f[10],d[13]=f[11],d[14]=f[12],d[15]=f[13],d[16]=f[14],d[17]=f[15],d[18]=f[16],f):(e=a.item,c.sequence([function(a){return d[32]=e.backupTenancy,d[31]=e.encryptionVersion,d[27]=void 0,c.i64.neq(d[27],void 0)?c.resolve(d[28]=d[27]):c.sequence([function(a){return d[33]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[34]=a[0],a})},function(a){return d[34]?d[43]=(d[33].push(c.i64.cast([0,0])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[43]=(d[33].push(c.i64.cast([0,2])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[43]=(d[33].push(c.i64.cast([0,3])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[43]=(d[33].push(c.i64.cast([0,4])),d[33]):0,d[38]=c.createArray(),d[39]=c.i64.of_int32(d[33].length),c.i64.gt(d[39],c.i64.cast([0,0]))?c.loopAsync(d[39],function(a){return d[43]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],d[43]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],a})},function(a){return d[46]=(d[38].push(d[44]),d[38])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[43]=c.createArray(),d[44]=c.i64.of_int32(d[38].length),c.i64.gt(d[44],c.i64.cast([0,0]))?c.loopAsync(d[44],function(a){return d[46]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[38],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=(d[43].push(c.i64.to_string(d[47])),d[43])}])}):c.resolve()},function(a){return d[45]=d[43].join(","),d[40]=d[45]}])},function(a){return d[38].some(function(a){return c.i64.eq(d[31],a)})?d[41]=d[31]:d[41]=void 0,c.i64.neq(d[41],void 0)?d[42]=d[41]:d[42]=void 0,d[28]=d[42]}])},function(a){return c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=c.i64.cast([0,0]),c.i64.neq(d[32],void 0)?d[30]=d[32]:d[30]=c.i64.cast([0,1]),a=[e.backupId,e.deviceId,e.mailboxRootKeyBlob,e.ocmfClientStateBlob,void 0,void 0,d[29],d[30],e.epochAuthPublicKeyBlob,e.epochAuthPrivateKeyBlob,e.devicePublicKeyBlob,e.devicePrivateKeyBlob,e.epochStoragePublicKeyBlob,e.epochStoragePrivateKeyBlob,e.obliviousValidationTokenBlob,e.authorityLevel,void 0],d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],d[6]=a[4],d[7]=a[5],d[8]=a[6],d[9]=a[7],d[10]=a[8],d[11]=a[9],d[12]=a[10],d[13]=a[11],d[14]=a[12],d[15]=a[13],d[16]=a[14],d[17]=a[15],d[18]=a[16],a}]))})},function(a){return c.storedProcedure(b("LSFindBackup")).then(function(a){return a=a,d[20]=a[0],a})},function(e){return c.blobs.neq(d[5],void 0)?c.i64.neq(d[3],void 0)?d[20]!==void 0?c.blobs.neq(d[4],void 0)?c.sequence([function(e){return d[27]=c.createArray(),d[34]=(d[27].push(d[20]),d[27]),d[34]=(d[27].push(a[1]),d[27]),d[28]=c.toJSON(d[27]),d[29]=c.createArray(),d[34]=(d[29].push(c.i64.cast([0,32])),d[29]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",a[5]].join("")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[30],void 0,d[4],d[29]).then(function(a){return a=a,d[31]=a[0],a})},function(a){return d[31]?d[32]=!1:d[32]=!0,d[32]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[34],c.i64.cast([0,3]))},function(a){return d[33]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[31],c.i64.cast([0,0])).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[33]=d[34]}])},function(e){return c.blobs.neq(d[33],void 0)?c.sequence([function(e){return c.i64.neq(a[9],void 0)?d[34]=a[9]:d[34]=c.i64.cast([-1,4294967295]),c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[6]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[33],d[36],c.i64.cast([0,16])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[37]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[28]).then(function(a){return a=a,d[39]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2NvcGU="),d[39]).then(function(a){return a=a,d[40]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[40]).then(function(a){return a=a,d[41]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[20]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[43]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[44]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[47]).then(function(a){return a=a,d[48]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[48]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[49]).then(function(a){return a=a,d[50]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[51]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[53]).then(function(a){return a=a,d[54]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[55]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[56]).then(function(a){return a=a,d[57]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(e){return d[59]=new c.Map(),d[59].set("attachment_index_key",d[42]==null?"":d[42]),d[59].set("backup_ent_fbid",a[0]),d[59].set("delivery_object_id",a[1]),d[59].set("device_id",d[3]),d[59].set("mailbox_partial_id",d[46]==null?"":d[46]),d[59].set("media_type",a[3]),d[59].set("message_partial_id",d[50]==null?"":d[50]),d[59].set("product_type",a[2]),d[59].set("salt_partial_id",d[54]==null?"":d[54]),d[59].set("sort_key",d[38]==null?"":d[38]),d[59].set("thread_partial_id",d[58]==null?"":d[58]),d[59].set("trace_id",d[1]),d[59].set("source",d[34]),d[60]=new c.Map(),d[60].set("otid",a[4]),d[60].set("server_thread_key",a[8]),d[60].set("timestamp",c.i64.to_string(a[6])),c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[61]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[62]=a[0],a})},function(e){return d[63]=new c.Map(),d[63].set("ocmf_client_state_blob",d[61]==null?"":d[61]),d[63].set("mailbox_root_key",d[62]==null?"":d[62]),d[64]=c.createArray(),d[76]=(d[64].push(a[4]),d[64]),d[76]=(d[64].push(a[1]),d[64]),d[65]=c.toJSON(d[64]),d[59].set("raw_identifiers",d[60]),d[59].set("backup_id",d[20]),d[59].set("thread_id",a[5]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[66]).then(function(a){return a=a,d[67]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[67]).then(function(a){return a=a,d[68]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[68]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[59].set("salt_partial_access_token",d[69]==null?"":d[69]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[28]).then(function(a){return a=a,d[70]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2FsdF9zY29wZQ=="),d[70]).then(function(a){return a=a,d[71]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[72]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[59].set("salt_partial_attachment_index_key",d[73]==null?"":d[73]),d[59].set("raw_tokens",d[63]),d[74]=c.toJSON(d[59]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_attachment_restore",c.i64.cast([0,50020]),d[74],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),d[1],c.i64.cast([0,0])).then(function(a){return a=a,d[75]=a[0],a})}]):(d[34]="OPE key is null for IssueAttachmentRestoreTask",d[34]!==void 0?c.sequence([function(a){return d[36]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[34]].join(""),function(a){c.logger(a).mustfix(a)}(d[36]),d[35]=c.createArray(),d[1]!==void 0?d[37]=(d[35].push(d[1]),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[34],d[35],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[36],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[40]=!0:d[40]=!1,d[40]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[41]=c.createArray(),void 0!==void 0?d[42]=(d[41].push(void 0),d[41]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[41],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[38]=!0:d[38]=!1,d[38]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[39]=c.createArray(),void 0!==void 0?d[40]=(d[39].push(void 0),d[39]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[39],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[38]=!0:d[38]=!1,d[38]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[39]=c.createArray(),void 0!==void 0?d[40]=(d[39].push(void 0),d[39]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[39],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[36]=!0:d[36]=!1,d[36]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[37]=c.createArray(),void 0!==void 0?d[38]=(d[37].push(void 0),d[37]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[37],c.i64.cast([0,3]))):c.resolve()}]))}]):(d[27]="Missing mailbox_root_key for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing backup_id for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing device_id for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing ocmf_client_state_blob for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}]))},function(a){return d[21]=c.i64.of_float(Date.now()),d[22]=c.i64.random(),d[24]="Finishing execution. Execution time: ",d[25]=c.i64.to_string(c.i64.sub(d[21],d[0])),d[26]=" ms",d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ",d[23],d[24],d[23],d[25],d[23],d[26]].join("")),c.i64.eq(c.i64.mod_(d[22],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[27]=",",d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",[d[24],d[27],d[25],d[27],d[26]].join(""),d[28],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueAttachmentRestoreTaskStoredProcedure",["LSIssueAttachmentRestoreTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.backupEntFbid;d[1]=b.deliveryObjectId;d[2]=b.productType;d[3]=b.mediaType;d[4]=b.messageId;d[5]=b.threadId;d[6]=b.sortOrder;d[7]=b.traceId;d[8]=b.serverThreadKey;d[9]=b.source;return c("LSIssueAttachmentRestoreTask").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWMIMediaDownloader",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSIntEnum","LSIssueAttachmentRestoreTaskStoredProcedure","LSMEBTaskCreationSource","MAWCastToMsgrServerMediaType","MAWThreadKeyUtils","MebMIMediaDownloader","MediaDownloadMediator","WAMediaUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;a=function(a){babelHelpers.inheritsLoose(e,a);function e(){return a.apply(this,arguments)||this}var g=e.prototype;g.handle=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,b=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);d("MediaDownloadMediator").mapDeliveryObjectIdToMediaDownloader(d("WAMediaUtils").stringToDeliveryObjectId(this.mediaDownloadMetadata.deliveryObjectId),this);var e=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(this.mediaDownloadMetadata.mediaType);if(e==null)throw c("FBLogger")("labyrinth_web").mustfixThrow("Unsupported media type");var g=d("MAWThreadKeyUtils").stringThreadKeyToString(this.mediaDownloadMetadata.threadKey);yield b.runInTransaction(function(b){return c("LSIssueAttachmentRestoreTaskStoredProcedure")(c("LSFactory")(b),{backupEntFbid:(i||(i=d("I64"))).of_string(a.mediaDownloadMetadata.backupEntFbid),deliveryObjectId:a.mediaDownloadMetadata.deliveryObjectId,mediaType:e,messageId:a.mediaDownloadMetadata.messageId,productType:a.mediaDownloadMetadata.productType,serverThreadKey:g,sortOrder:i.of_float(a.mediaDownloadMetadata.sortOrder),source:(j||(j=d("LSIntEnum"))).ofNumber(c("LSMEBTaskCreationSource").MSGR_DYI),threadId:a.mediaDownloadMetadata.threadId})},"readwrite",void 0,void 0,f.id+":49")});function e(){return a.apply(this,arguments)}return e}();return e}(c("MebMIMediaDownloader"));g.MAWMIMediaDownloader=a}),98);
__d("EncryptedBackupsDYIMessageProcessingUtils",["EncryptedBackupsDYIMediaDownloadHandlers","EncryptedBackupsDYISingleton","IGDMIMediaDownloader","MAWMIMediaDownloader","MebWAMediaDownloader","Promise","WAJids","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Failed to resign CDN URL: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Media CDN URL has expired and should be renewed"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Successfully downloaded media"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Failed to download media"]);l=function(){return a};return a}function a(a,b){return{isUnsent:!1,media:new Set(),reactions:[],senderName:m(a),text:"",timestamp:(a=b)!=null?a:0,type:""}}function m(a){var b=d("EncryptedBackupsDYISingleton").getSingleton(),c="Unknown User";if(a!=null){b=b.getContactNameForContactId(a);b!=null&&(c=b)}return c}function c(a,c,e,f,g,m,n,o,p,q){var r=d("EncryptedBackupsDYISingleton").getSingleton(),s=r.getLogger(),t={author:d("WAJids").toMsgrUserJid(n),chat:d("WAJids").toMsgrUserJid(g),externalId:o},u={hash:p,isUrlRenewed:!1,mediaEntry:f,protocolMsgId:t,sortOrderMs:q};n={onDownloadError:function(){void s.ERROR(l(),u.hash);r.deletePlaintextHashFromAttachmentDownloadsInProgress(u.hash);return(h||(h=b("Promise"))).resolve()},onDownloadSuccess:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){void s.LOG(k(),u.hash);var b=a.mimeType;a=a.plaintext;yield d("EncryptedBackupsDYIMediaDownloadHandlers").DYIMediaDownloadHandler(u.hash,b,a,t)});function c(b){return a.apply(this,arguments)}return c}(),onUrlExpired:function(){void s.LOG(j(),u.hash);return(h||(h=b("Promise"))).resolve()}};var v=new(d("MebWAMediaDownloader").MebWAMediaDownloader)(u,n,a),w=f.serverMediaType;f=f.objectId;if(w!=null&&f!=null&&typeof q==="number"){c={backupEntFbid:c,deliveryObjectId:f,hash:p,mediaType:w,messageId:o,productType:e,sortOrder:q,threadId:g,threadKey:m};f={onResignCdnUrlFailure:function(a){void s.ERROR(i(),u.hash,a.message);r.deletePlaintextHashFromAttachmentDownloadsInProgress(u.hash);return(h||(h=b("Promise"))).resolve()},onResignCdnUrlSuccess:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()};p=e==="msgr"?new(d("MAWMIMediaDownloader").MAWMIMediaDownloader)(c,f):new(d("IGDMIMediaDownloader").IGDMIMediaDownloader)(c,f);v.setNextHandler(p);p.setNextHandler(new(d("MebWAMediaDownloader").MebWAMediaDownloader)(u,n,a))}void v.handle()}g.buildBaseDyiMessage=a;g.getSenderName=m;g.startMediaDownloadChain=c}),98);
__d("MAWEncryptedBackupsDYIProcessEchoMessages",["EchoMessage","EncryptedBackupsDYIMessageProcessingUtils","EncryptedBackupsDYISingleton","MAWFrontendMediaUtils","MAWHandleEchoMediaMsgsRestoreV2","MebWAMediaDownloader","WAHashUtils","WAMediaUtils","WAStanzaUtils","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media message is missing media data"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Explicitly dropping "," message type"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported message content subtype for placeholder: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bump message is not supported in DYI"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered message edits: ","\n. Edit count: ","\n. Original message content: ",""],["Encountered message edits: ","\\n. Edit count: ","\\n. Original message content: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping tombstoned message"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing Echo document. Dropping the message: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot convert Echo message to DYI format. Dropping the message"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing "," echo messages for thread ",""]);p=function(){return a};return a}function a(a,b,c){var e=d("EncryptedBackupsDYISingleton").getSingleton(),f=e.getLogger();void f.LOG(p(),c.length,a);c.forEach(function(c){try{var g=q(a,b,c);if(g==null){void f.WARN(o());return}e.setMessagesByThreadKey(a,d("WAStanzaUtils").toStanzaId(c.messageId),g);return}catch(a){void f.ERROR(n(),a);return}})}function q(a,b,e){var f,g=d("EncryptedBackupsDYISingleton").getSingleton(),h=g.getLogger();if(e.isTombstoned!=null&&e.isTombstoned===!0){void h.LOG(m());return}f=d("EncryptedBackupsDYIMessageProcessingUtils").buildBaseDyiMessage((f=e.from)==null?void 0:f.localKey,e.sortOrderMs);(e.editCount>0||e.editHistory.length>0)&&void h.LOG(l(),JSON.stringify(e.editHistory,null,2),e.editCount,e.text);e.reactions!=null&&e.reactions.length>0&&(f.reactions=e.reactions.map(function(a){var b=a.displayName;a=a.localKey;return{actor:(a=g.getContactNameForContactId(a))!=null?a:"unknown",reaction:(a=b)!=null?a:"unknown"}}));var n=c("qex")._("172")||!1;switch(e.contentType){case d("EchoMessage").EchoMessageContentType.TEXT:if(n&&e.xContentType===d("EchoMessage").EchoXMessageContentType.BUMP){void h.WARN(k());return void 0}else f.type="text",f.text=e.text||"";break;case d("EchoMessage").EchoMessageContentType.MEDIA:f.type="media";f=r(a,b,e,f);break;case d("EchoMessage").EchoMessageContentType.PLACEHOLDER:e.contentSubtype===d("EchoMessage").EchoMessageContentSubtype.UNSEND&&(f.type="placeholder",f.isUnsent=!0,f.text="User unsent a message");void h.WARN(j(),d("EchoMessage").EchoMessageContentSubtype.getName(e.contentSubtype));return void 0;case d("EchoMessage").EchoMessageContentType.XMA:f.type="link";e.xmaData!=null&&e.xmaData.xmaDefaultCTA!=null?f.text=e.xmaData.xmaDefaultCTA:f.text=e.text||"";break;case d("EchoMessage").EchoMessageContentType.ADMIN_MESSAGE:case d("EchoMessage").EchoMessageContentType.DECRYPTION_FAILURE:case d("EchoMessage").EchoMessageContentType.NULL_STATE:case d("EchoMessage").EchoMessageContentType.UNSUPPORTED_NEEDS_UPDATE:void h.LOG(i(),e.contentType);return void 0}return f}function r(a,b,c,e){var f=d("EncryptedBackupsDYISingleton").getSingleton(),g=f.getLogger();if(c.mediaData==null){void g.WARN(h());return e}g=c.from;var i=c.xOfflineThreadingId,j=c.mediaData,k=j.attachmentObjectId,l=j.backupEntFbid,m=j.directPath,n=j.encryptedHash,o=j.filename,p=j.mediaContentType,q=j.mediaKey,r=j.mediaKeyTimestamp,s=j.plaintextHash;j=j.size;g=(g=g==null?void 0:g.localKey)!=null?g:"0";i=d("WAStanzaUtils").toStanzaId((i=i)!=null?i:"0");p=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(p||"");p=p.serverMediaType;s=d("WAHashUtils").stringToPlaintextHash(d("MAWHandleEchoMediaMsgsRestoreV2").getBase64WithoutPadding(s));e.media.add(s);if(!f.isAttachmentDownloadInProgressForPlaintextHash(s)&&!f.isAttachmentDownloadCompleteForPlaintextHash(s)){f.addPlaintextHashToAttachmentDownloadsInProgress(s);n=d("MAWHandleEchoMediaMsgsRestoreV2").constructMediaEntry(s,(f=n)!=null?f:"",q,m,r,p,o,l,k,null,j);f=d("WAMediaUtils").decodeMediaEntryData(n);void d("EncryptedBackupsDYIMessageProcessingUtils").startMediaDownloadChain(d("MebWAMediaDownloader").MebWADownloadMediaThroughTheBridge,"-8","msgr",f,b,a,g,i,s,c.sortOrderMs)}return e}g.processEBEchoMessagesForDYI=a}),98);
__d("MAWWriteReactionTxns",["MAWAuthor","MAWDbMsg","MAWDbReaction","MAWDbReactionUtils","MAWDbReactionsTxns","MAWDexieTable","qex"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){var g=b.author,h=b.externalId,i=b.groupingKey,j=b.reaction,k=b.reactToAuthor,l=b.reactToExternalId,m=b.senderTimestampMs,n=b.ts;return d("MAWDexieTable").dexieAll([a.messages.where("externalId").equals(l).toArray(),a.reactions.where("reactToExternalId").equals(l).toArray(),d("MAWDbReactionsTxns").getNextReactionIdNumberForThread(a,e)]).then(function(b){var o=b[0],p=b[1];b=b[2];p=d("MAWDbReaction").findMatchingReaction(p,e.jid,g);var q=d("MAWAuthor").getAuthorUserJid(k);o=o.find(function(a){return a.threadJid===e.jid&&q===d("MAWAuthor").getAuthorUserJid(a.author)});var r=d("MAWDbReaction").formatReactionForDb(e.jid,h,d("MAWDbMsg").craftReactionId(e.chatId,b),l,j,i,k,o==null?void 0:o.msgId,n,g,p==null?void 0:p.rowId,void 0,m);return d("MAWDbReactionsTxns").putReaction(a,r).then(function(a){a=babelHelpers["extends"]({},r,{rowId:a});c("qex")._("1016")!==!0&&f!==!0&&d("MAWDbReactionUtils").dispatchReaction(a);return a})})}g.writeReaction=a}),98);
__d("MAWWriteReactionMsgApi",["MAWDexieTable","MAWIndexedDb","MAWTransactionMode","MAWWriteReactionTxns","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c,e,f,g,h){g===void 0&&(g=d("WAJids").AUTHOR_ME);var i=e.groupingKey,j=e.reaction,k=e.reactToAuthor,l=e.reactToExternalId;e=e.senderTimestampMs;var m={author:g,externalId:b,groupingKey:i,reaction:j,reactToAuthor:k,reactToExternalId:l,senderTimestampMs:e,ts:f};return a.threads.get({jid:c}).then(function(b){return b==null?"missing_thread":d("MAWWriteReactionTxns").writeReaction(a,m,b,h)}).then(function(a){return a==="missing_thread"?{type:"missing_thread"}:{msgId:a.reactionId,protocolMsgId:{author:g,chat:c,externalId:a.externalId},type:"not_sent"}})};b=d("MAWIndexedDb").makeMsgrTransactor({messages:(a=d("MAWTransactionMode")).READONLY,reactions:a.READWRITE,threads:a.READONLY},"writeReactionMsg",function(a){return function(b,c,e,f,g,i){g===void 0&&(g=d("WAJids").AUTHOR_ME);return h(a,b,c,e,f,g,i)}});c=d("MAWIndexedDb").makeMsgrTransactor({messages:a.READONLY,reactions:a.READWRITE,threads:a.READONLY},"bulkWriteReactionMsg",function(a){return function(b,c){return d("MAWDexieTable").dexieAll(b.map(function(b){return h(a,b.externalId,b.chatJid,b.args,b.ts,b.author,c)}))}});g.writeReactionMsg=b;g.bulkWriteReactionMsg=c}),98);
__d("MAWHandleEchoProtobufsRestoreApi",["EchoMessageMediaFieldUtils","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWBridge","MAWBridgeEventTransmitter","MAWBridgeMsg","MAWBridgeXMA","MAWDbEditMsgHistoryTxns","MAWDbMsg","MAWDbRavenActionTxns","MAWDexieTable","MAWEBRestoreTrackingUtils","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoMsgsRestoreApiUtils","MAWHandleEchoMsgsRestoreApiV2","MAWHandleEchoXMARestoreV2","MAWHandleXmaTransactionUtil","MAWIndexedDb","MAWJids","MAWLoadReplyMediaTxns","MAWMediaManagementTxns","MAWMsg","MAWMsgType","MAWQplProxy","MAWRestoreMsgsTxns","MAWRestoreValidationUtils","MAWTraceUtils","MAWTransactionMode","MAWUnstoredContentToUnstoredDbContentUtils","MAWUpdateQuotedMsgTxns","MAWWriteReactionMsgApi","MAWWriteReceiverFetchTxns","MessageBackupSupplementalKeyGenerator","Promise","WAAckLevel","WAArmadilloApplication.pb","WAArmadilloBackupMessage.pb","WABase64","WAConsumerApplication.pb","WAGlobals","WAHashUtils","WAJids","WALogger","WAMediaTransport.pb","WAMediaUtils","WAMsgApplication.pb","WAMsgType","WAParseConsumerMessageProtocol","WAParseMediaTransportProtocol","WAParseMessageApplication","WAStanzaUtils","WATimeUtils","asyncToGeneratorRuntime","decodeProtobuf","emptyFunction","gkx","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Cannot download media - timestamp cannot be null"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] cannot support message type for protobuf restore - reverting to echo restore"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Protobuf restore initiated for "," messages. isPointRestore: "," referenceTimestamp: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No text content found in edit msg"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Unable to parse edit msg, missing either timestamp or msg id"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Message contains unparseable message application - unable to restore message"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Unable to retrieve decoded protobuf from backup message - unsupported message type"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Decoded raven video unstored message is null - unable to restore"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No author found for original message that was bumped - unable to restore"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Unable to retrieve revoked message external id"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWHandleEchoProtobufsRestoreApi] consumerMessage has no sticker receiver fetch info"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Invalid attachment type, cannot restore attachment"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Unsupported media type, cannot get mimetype for attachment"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Failed to create db msg from protobuf"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required fields, unable to create db msg from protobuf for thread jid "," and otid ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required author, unable to create db msg from protobuf"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required message id, unable to create db msg from protobuf"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required msg type, unable to create db msg from protobuf"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] Missing required metadata, unable to create db msg from protobuf"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No target type found for XMA - unable to extract XMA content for message"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] XMA data is null - unable to extract XMA content for message"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No raven msg media type found for raven msg"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No raven msg ephemeral type found for raven msg"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] No revoked msg external id found for revoked msg"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] text content cannot be null for msg type text - unable to restore msg"]);H=function(){return a};return a}var I=(e=d("MAWIndexedDb")).makeMsgrTransactor({chunk:(f=d("MAWTransactionMode")).READONLY,media:f.READONLY,messages:f.READWRITE,receiverFetchInfo:f.READONLY,xma:f.READONLY},"associateQuotedMessagesForRestoredDbMsgs",function(a){return function(b,c,e){var f=0;return d("MAWDexieTable").dexieAll(b.map(function(b){return d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,c,b,!0).then(function(b){b!=null&&b.length>0&&(f+=b.length,b.forEach(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(b,void 0,a)})})}))})})).then(function(){e==null?void 0:e.addPoint("replies_restore_end",{"int":{replies:f}});return d("MAWDexieTable").dexieResolve()})}});function J(a,b,c){c={author:c,chat:b,externalId:a};return c}function K(a,b,c){var e=new Map(),f=a.metadata;a=a.reactionData;if(f!=null&&a!=null){var g=f.senderId,h=f.messageId;if(g!=null&&h!=null){a.forEach(function(a){var f=a.ts,i=a.senderId,j=a.reactionExternalId,k=d("WAStanzaUtils").toStanzaId(h);if(i==null||j==null)return;j=d("WAStanzaUtils").toStanzaId(j);i=d("MAWJids").toUserJid(i);var l=d("MAWJids").toUserJid(g);i=i===c?d("WAJids").AUTHOR_ME:i;l=l===c?d("WAJids").AUTHOR_ME:l;var m=i===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED;m={ack:m,chatJid:b,reaction:a.reaction,reactionAuthor:i,reactionExternalId:j,reactToExternalId:k,reactToMsgAuthor:l,ts:f};e.set(j,m)});return e}}}function L(a,b,c,e,f,g,h,i,j,k,l,m){if(a===d("MAWMsgType").MSG_TYPE.TEXT)if(h==null){d("WALogger").ERROR(H());return}else{h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,msgContent:{content:h,mentionedJids:i!=null?i.map(d("WAJids").validateUserJid).filter(Boolean):void 0},ts:b,type:d("MAWMsgType").MSG_TYPE.TEXT};return h}else if(a===d("MAWMsgType").MSG_TYPE.VIDEO){i={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.VIDEO};return i}else if(a===d("MAWMsgType").MSG_TYPE.GIF){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.GIF};return h}else if(a===d("MAWMsgType").MSG_TYPE.IMAGE){i={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.IMAGE};return i}else if(a===d("MAWMsgType").MSG_TYPE.STICKER){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.STICKER};return h}else if(a===d("MAWMsgType").MSG_TYPE.PTT){i={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.PTT};return i}else if(a===d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE};return h}else if(a===d("MAWMsgType").MSG_TYPE.XMA){i={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,ts:b,type:d("MAWMsgType").MSG_TYPE.XMA};return i}else if(a===d("MAWMsgType").MSG_TYPE.REVOKED){if(j==null){d("WALogger").ERROR(G());return}h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,ebTimestampMs:null,id:e,msgContent:void 0,revokedExternalId:j,ts:b,type:d("MAWMsgType").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:b};return h}else if(a===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE){i={ack:d("WAAckLevel").ACK.SENT,id:e,ts:b,type:d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE};return i}else if(a===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH){j={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,ts:b,type:d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH};return j}else if(a===d("MAWMsgType").MSG_TYPE.RAVEN){if(k==null){d("WALogger").ERROR(F());return}if(l==null){d("WALogger").ERROR(E());return}h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,id:e,mediaId:m,ravenEphemeralMediaState:d("MAWMsg").MAWRavenMsgEphemeralMediaState.UNSEEN,ravenEphemeralType:k,ravenMediaType:l,ts:b,type:d("MAWMsgType").MSG_TYPE.RAVEN};return h}}function M(a,b,c,e,f){if(f==null){d("WALogger").ERROR(D());return}var g=f==null?void 0:f.ctas.map(function(a){return{actionUrl:a.actionUrl,buttonType:a.buttonType,ctaType:a.ctaType,nativeUrl:a.nativeUrl,title:a.title}}),h=f.targetType;if(h==null){d("WALogger").ERROR(C());return}var i;f.targetExpiringAtSec!=null&&typeof f.targetExpiringAtSec==="number"&&(i=d("WATimeUtils").castToUnixTime(f.targetExpiringAtSec));a={author:a,contentRef:f.contentRef,ctas:g,defaultCTA:g.length>0?g[0]:void 0,externalId:b,headerTitle:f.headerTitle,maxSubtitleNumOfLines:f.maxSubtitleNumOfLines,maxTitleNumOfLines:f.maxTitleNumOfLines,msgId:c,overlayDescription:f.overlayDescription,overlayIconGlyph:f.overlayIconGlyph,overlayTitle:f.overlayTitle,subtitleText:f.subtitleText,targetExpiringAtSec:i,targetId:f.targetId,targetType:h,targetUsername:f.targetUsername,threadJid:e,titleText:f.titleText,xmaLayoutType:f.xmaLayoutType};return a}function N(a,b,c,e,f){var g,h,i=a.metadata,j=a.msgType;if(i==null){d("WALogger").ERROR(B());return}if(j==null){d("WALogger").ERROR(A());return}var k=i.messageId;i=i.senderId;g=(g=a.decodedPayload)==null?void 0:g.text;h=(h=a.decodedPayload)==null?void 0:h.mentionedJid;if(k==null){d("WALogger").ERROR(z());return}if(i==null){d("WALogger").ERROR(y());return}var l=d("WATimeUtils").castMilliSecondsToUnixTime(a.sortOrderMs);i=d("MAWJids").toUserJid(i);var m=d("WAStanzaUtils").toStanzaId(k),n=i===c?d("WAJids").AUTHOR_ME:i,o=J(m,b,i);if(a.editMsgData.length>0){var p=l;a.editMsgData.forEach(function(a){var b;if(a.ts>p&&((b=a.editMsgContent.message)==null?void 0:b.text)!=null){p=a.ts;g=(b=a.editMsgContent.message)==null?void 0:b.text;h=(b=a.editMsgContent.message)==null?void 0:b.mentionedJid}})}n=L(j,l,n,o,a.isForwarded,a.forwardingScore,g,h,a.revokedMsgExternalId,a.ravenMsgEphemeralType,a.ravenMsgMediaType,(l=a.ravenUnstoredMedia)==null?void 0:l.plaintextHash);if(n==null){d("WALogger").ERROR(x(),b,m);return}var q;if(a.xmaData!=null&&((o=a.xmaData)==null?void 0:o.targetType)!=null){o={author:i,externalId:m,targetType:(l=a.xmaData)==null?void 0:l.targetType,threadJid:b};q={unstoredAssociatedMedia:void 0,unstoredAssociatedMsg:void 0,unstoredFavicon:void 0,unstoredHeaderMedia:void 0,unstoredPreviews:void 0,xma:o}}i={unstoredMedia:void 0,unstoredMsg:n,unstoredQuotedMedia:void 0,unstoredReceiverFetchInfo:a.receiverFetchInfo,unstoredXMA:q};n.type===d("MAWMsgType").MSG_TYPE.RAVEN&&a.ravenUnstoredMedia!=null&&(i.unstoredMedia=a.ravenUnstoredMedia);l=d("MAWUnstoredContentToUnstoredDbContentUtils").unstoredContentToUnstoredDbContent(i);if(l.unstoredDbMsg!=null){b=l.unstoredDbMsg;b.sortOrderMs=a.sortOrderMs;b.serverTs=d("WATimeUtils").castToUnixTime(a.sortOrderMs/1e3);a.noteReply!=null&&(b.quote={content:a.noteReply,remoteJid:void 0});o=e.get(k);b.author!=null&&c===b.author&&b.author!==d("WAJids").AUTHOR_SYSTEM&&(b.author=d("WAJids").AUTHOR_ME);o!=null&&(b.quoteExternalId=d("WAStanzaUtils").toStanzaId(o));j===d("MAWMsgType").MSG_TYPE.TEXT&&(b.editCount=a.editMsgData.length);n={author:b.author,stanzaId:m,unstoredDbContent:l};l.unstoredDbMedia!=null&&f!=null&&f.set(m,l.unstoredDbMedia);return n}d("WALogger").ERROR(w())}function O(a){switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;default:return null}}function P(a){switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:return d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:return d("EchoMessageMediaFieldUtils").AttachmentType.GIF;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:return d("EchoMessageMediaFieldUtils").AttachmentType.STICKER;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:return d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:return d("EchoMessageMediaFieldUtils").AttachmentType.PTT;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:return d("EchoMessageMediaFieldUtils").AttachmentType.XMA;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT:return d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT;default:return null}}function Q(){try{return WorkerGlobalScope!==void 0&&self instanceof WorkerGlobalScope}catch(a){return!1}}function aa(a){var b,e=Q()?d("WAGlobals").getConfig().isOctetStreamAttachmentMimeTypeEnabled():c("gkx")("4644");switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:b="image/jpeg";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:b="audio/wav";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:b="video/mp4";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:b="image/gif";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:b="image/webp";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:b="image/jpeg";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT:b=e?"application/octet-stream":"application/pdf";break;default:d("WALogger").ERROR(v())}return b}function R(a,b,c){var e,f,g,h,i,j;b=b;var k=a.ancillary;a=a.integral;e=a==null?void 0:(e=a.transport)==null?void 0:(e=e.integral)==null?void 0:e.fileSha256;f=a==null?void 0:(f=a.transport)==null?void 0:(f=f.integral)==null?void 0:f.fileEncSha256;g=a==null?void 0:(g=a.transport)==null?void 0:(g=g.integral)==null?void 0:g.mediaKey;h=(a==null?void 0:(h=a.transport)==null?void 0:(h=h.integral)==null?void 0:h.mediaKeyTimestamp)!=null?typeof (a==null?void 0:(h=a.transport)==null?void 0:h.integral.mediaKeyTimestamp)==="number"?a==null?void 0:(h=a.transport)==null?void 0:h.integral.mediaKeyTimestamp:void 0:void 0;var l=k==null?void 0:k.gifPlayback;l!=null&&l&&(b=d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF);l=a==null?void 0:(l=a.transport)==null?void 0:(l=l.ancillary)==null?void 0:(l=l.thumbnail)==null?void 0:l.thumbnailHeight;i=a==null?void 0:(i=a.transport)==null?void 0:(i=i.ancillary)==null?void 0:(i=i.thumbnail)==null?void 0:i.thumbnailWidth;var m=O(b),n=P(b);if(n===null){d("WALogger").ERROR(u());return}a={attachmentObjectId:a==null?void 0:(j=a.transport)==null?void 0:(j=j.ancillary)==null?void 0:j.objectId,attachmentType:n,directPath:a==null?void 0:(j=a.transport)==null?void 0:(n=j.integral)==null?void 0:n.directPath,encryptedHash:f!=null?d("WAHashUtils").toPlaintextHash(f):void 0,filename:c,height:k==null?void 0:k.height,mediaKey:g!=null?d("WABase64").encodeB64UrlSafe(g):void 0,mediaKeyTimestamp:h,mediaPlayableDuration:k==null?void 0:k.seconds,plaintextHash:e!=null?d("WAHashUtils").toPlaintextHash(e):void 0,width:k==null?void 0:k.width,xAttachmentType:b,xContentType:"full"};j=aa(b);j!=null&&(a.mediaContentType=j);m!=null&&(a.previewContentType=m,a.previewContentHeight=l,a.previewContentWidth=i);return d("EchoMessageMediaFieldUtils").convertMediaMetadataDetailsToMediaMetadata(a,"protobuf")}function S(a,b,e){b=R(a,b,e);if(b==null)return{mediaMetadata:void 0,previewMetadata:null};e=a.integral;a=null;e=e==null?void 0:(e=e.transport)==null?void 0:(e=e.ancillary)==null?void 0:(e=e.thumbnail)==null?void 0:e.downloadableThumbnail;if(e!=null&&c("gkx")("6038")){var f=e.fileSha256,g=e.fileEncSha256,h=e.mediaKey,i=typeof e.mediaKeyTimestamp==="number"?e.mediaKeyTimestamp:void 0;a={attachmentObjectId:e.objectId,attachmentType:d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,directPath:e.directPath,encryptedHash:g!=null?d("WAHashUtils").toPlaintextHash(g):void 0,filename:void 0,height:void 0,mediaKey:h!=null?d("WABase64").encodeB64UrlSafe(h):void 0,mediaKeyTimestamp:i,mediaPlayableDuration:void 0,plaintextHash:f!=null?d("WAHashUtils").toPlaintextHash(f):void 0,width:void 0,xAttachmentType:d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.MESSENGER_PREVIEW,xContentType:"preview"};return{mediaMetadata:b,previewMetadata:d("EchoMessageMediaFieldUtils").convertMediaMetadataDetailsToMediaMetadata(a,"protobuf")}}return{mediaMetadata:b,previewMetadata:null}}function T(a,b,c,e,f,g){g===void 0&&(g=null),b!=null&&a!=null&&(c.push({mediaMetadata:b,mediaRestoreType:e,previewMetadata:g}),f.set(d("WAStanzaUtils").toStanzaId(a),c))}function ba(a){switch(a){case 0:return d("MAWMsg").MAWRavenMsgEphemeralType.VIEW_ONCE;case 1:return d("MAWMsg").MAWRavenMsgEphemeralType.ALLOW_REPLAY;case 2:return d("MAWMsg").MAWRavenMsgEphemeralType.KEEP_IN_CHAT;default:return void 0}}function ca(a,b,c,e,f,g,h,i,j,k,l){var m,n,o=U(a,g,h,i);m=o==null?void 0:(m=o.obj.payload)==null?void 0:m.content;var u={editMsgData:[],externalId:e,forwardingScore:(n=o==null?void 0:(n=o.metadata)==null?void 0:n.forwardingScore)!=null?n:0,isForwarded:(n=o==null?void 0:(n=o.metadata)==null?void 0:n.isForwarded)!=null?n:!1,metadata:a.metadata,reactionData:[],sortOrderMs:b,unknownFieldCount:a.$$unknownFieldCount},v=[];if(m!=null){if(m.messageText!=null){u.msgType=d("MAWMsgType").MSG_TYPE.TEXT;u.decodedPayload=m.messageText;return u}else if(m.extendedContentMessage!=null){u.msgType=d("MAWMsgType").MSG_TYPE.XMA;u.xmaData=m.extendedContentMessage;if(((n=m.extendedContentMessage)==null?void 0:n.headerImage)!=null){n=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,(b=m.extendedContentMessage)==null?void 0:b.headerImage.payload);b=R(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);T(e,b,v,"xma_header",j)}if(((n=m.extendedContentMessage)==null?void 0:n.favicon)!=null){n=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,(b=m.extendedContentMessage)==null?void 0:b.favicon.payload);b=R(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);T(e,b,v,"xma_favicon",j)}if(((n=m.extendedContentMessage)==null?void 0:n.previews)!=null){(b=m.extendedContentMessage)==null?void 0:b.previews.forEach(function(a){a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,a.payload);a=R(a,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);u.mediaMetadata=a;T(e,a,v,"xma_preview",j)})}return u}else if(m.audioMessage!=null){n=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").AudioTransportSpec,(n=m.audioMessage)==null?void 0:(b=n.audio)==null?void 0:b.payload);b=R(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO);u.msgType=d("MAWMsgType").MSG_TYPE.PTT;u.mediaMetadata=b;T(e,b,v,"attachment",j);return u}else if(m.videoMessage!=null){n=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").VideoTransportSpec,(n=m.videoMessage)==null?void 0:(n=n.video)==null?void 0:n.payload);n=S(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO);var w=n.mediaMetadata;n=n.previewMetadata;b=w;b!=null&&b.xAttachmentType===d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF?u.msgType=d("MAWMsgType").MSG_TYPE.GIF:u.msgType=d("MAWMsgType").MSG_TYPE.VIDEO;u.mediaMetadata=b;T(e,b,v,"attachment",j,n);return u}else if(m.imageMessage!=null){w=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").ImageTransportSpec,(w=m.imageMessage)==null?void 0:(n=w.image)==null?void 0:n.payload);n=S(w,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);w=n.mediaMetadata;n=n.previewMetadata;b=w;u.msgType=d("MAWMsgType").MSG_TYPE.IMAGE;u.mediaMetadata=b;T(e,b,v,"attachment",j,n);return u}else if(m.stickerMessage!=null){w=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").StickerTransportSpec,(w=m.stickerMessage)==null?void 0:(n=w.sticker)==null?void 0:n.payload);if(((n=w.integral)==null?void 0:n.receiverFetchId)!=null){n=d("WAParseMediaTransportProtocol").parseStickerReceiverFetchInfo(w);if(n==null){d("WALogger").ERROR(t());return u}u.msgType=d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH;u.receiverFetchInfo=n;return u}b=R(w,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER);u.msgType=d("MAWMsgType").MSG_TYPE.STICKER;u.mediaMetadata=b;T(e,b,v,"attachment",j);return u}else if(m.documentMessage!=null){n=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").DocumentTransportSpec,(n=m.documentMessage)==null?void 0:(w=n.document)==null?void 0:w.payload);b=R(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT,(w=m.documentMessage)==null?void 0:w.fileName);u.msgType=d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE;u.mediaMetadata=b;T(e,b,v,"attachment",j);return u}}else if((o==null?void 0:(n=o.obj.payload)==null?void 0:(m=n.applicationData)==null?void 0:m.revoke)!=null){n=o==null?void 0:(w=o.obj.payload)==null?void 0:(n=w.applicationData)==null?void 0:(m=n.revoke)==null?void 0:(w=m.key)==null?void 0:w.id;if(n==null)d("WALogger").ERROR(s());else{u.revokedMsgExternalId=d("WAStanzaUtils").toStanzaId(n);u.msgType=d("MAWMsgType").MSG_TYPE.REVOKED;return u}}if((o==null?void 0:(m=o.obj.payload)==null?void 0:(w=m.content)==null?void 0:w.bumpExistingMessage)!=null){w=o==null?void 0:(n=o.obj.payload)==null?void 0:(m=n.content)==null?void 0:m.bumpExistingMessage;m=(n=w.key)==null?void 0:n.id;m!=null&&(h.has(m)||g.add(m),i.set(e,m));h=(n=w.key)==null?void 0:n.participant;if(h==null){h=(g=w.key)==null?void 0:g.remoteJid}if(h==null)d("WALogger").ERROR(r());else{i=d("WAJids").unsafeCoerceToUserJid(h);m=i===c?d("WAJids").AUTHOR_ME:i;k.set(d("WAStanzaUtils").toStanzaId(e),m);u.msgType=d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE;return u}}if((o==null?void 0:(n=o.obj)==null?void 0:(w=n.payload)==null?void 0:(g=w.content)==null?void 0:g.noteReplyMessage)!=null){m=o==null?void 0:(h=o.obj)==null?void 0:(i=h.payload)==null?void 0:(k=i.content)==null?void 0:k.noteReplyMessage;n=m.noteTimestampMs;w=m.noteText;h=(g=a.metadata)==null?void 0:g.senderId;if(n!=null&&typeof n==="number"&&h!=null&&f!=null){i=d("MAWJids").toUserJid(h);k=d("MAWJids").toUserJid(f);a=k===i?c:k;g={author:a===c?d("WAJids").AUTHOR_ME:a,externalId:d("WAStanzaUtils").toStanzaId(e),ts:d("WATimeUtils").castMilliSecondsToUnixTime(n),type:d("WAMsgType").NOTE_REPLY};if((w==null?void 0:w.text)!=null){h={content:w==null?void 0:w.text,mentionedJids:w==null?void 0:w.mentionedJid.map(function(a){return d("MAWJids").toUserJid(a)})};g.msgContent=h}u.noteReply=g}if(m.textContent!=null){u.msgType=d("MAWMsgType").MSG_TYPE.TEXT;u.decodedPayload=m.textContent;return u}else if(m.stickerContent!=null){f=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").StickerTransportSpec,m.stickerContent.payload);b=R(f,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER);u.msgType=d("MAWMsgType").MSG_TYPE.STICKER;u.mediaMetadata=b;T(e,b,v,"attachment",j);return u}else if(m.videoContent!=null){i=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").VideoTransportSpec,m.videoContent.payload);b=R(i,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO);b!=null&&b.xAttachmentType===d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF?u.msgType=d("MAWMsgType").MSG_TYPE.GIF:u.msgType=d("MAWMsgType").MSG_TYPE.VIDEO;u.mediaMetadata=b;T(e,b,v,"attachment",j);return u}}if((o==null?void 0:(k=o.obj)==null?void 0:(c=k.payload)==null?void 0:(a=c.content)==null?void 0:a.ravenMessageMsgr)!=null){u.ravenMsgEphemeralType=ba(o==null?void 0:(n=o.obj)==null?void 0:(w=n.payload)==null?void 0:(h=w.content)==null?void 0:(g=h.ravenMessageMsgr)==null?void 0:g.ephemeralType);if((o==null?void 0:(f=o.obj)==null?void 0:(m=f.payload)==null?void 0:(i=m.content)==null?void 0:(b=i.ravenMessageMsgr)==null?void 0:b.imageMessage)!=null){if(l==null||!l){u.ravenUnstoredMedia=d("WAParseMediaTransportProtocol").decodeImageTransport(o==null?void 0:(k=o.obj)==null?void 0:(c=k.payload)==null?void 0:(a=c.content)==null?void 0:(n=a.ravenMessageMsgr)==null?void 0:(w=n.imageMessage)==null?void 0:w.payload,d("WATimeUtils").castMilliSecondsToUnixTime(u.sortOrderMs))}u.ravenMsgMediaType=d("MAWMsg").MAWRavenMsgMediaType.IMAGE}else if((o==null?void 0:(h=o.obj)==null?void 0:(g=h.payload)==null?void 0:(f=g.content)==null?void 0:(m=f.ravenMessageMsgr)==null?void 0:m.videoMessage)!=null){if(l==null||!l){n=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").VideoTransportSpec,o==null?void 0:(i=o.obj)==null?void 0:(b=i.payload)==null?void 0:(k=b.content)==null?void 0:(c=k.ravenMessageMsgr)==null?void 0:(a=c.videoMessage)==null?void 0:a.payload);w=d("WAParseMediaTransportProtocol").parseVideoMsg(n,d("WATimeUtils").castMilliSecondsToUnixTime(u.sortOrderMs),!1);w!=null?u.ravenUnstoredMedia=w:d("WALogger").ERROR(q())}u.ravenMsgMediaType=d("MAWMsg").MAWRavenMsgMediaType.VIDEO}u.msgType=d("MAWMsgType").MSG_TYPE.RAVEN;return u}o!=null&&da(u,o.obj);d("WALogger").ERROR(p());return u}function da(a,b){var c;(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.locationMessage)!=null&&(a.futureProofMessageType="locationMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.liveLocationMessage)!=null&&(a.futureProofMessageType="liveLocationMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.pollCreationMessage)!=null&&(a.futureProofMessageType="pollCreationMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.pollUpdateMessage)!=null&&(a.futureProofMessageType="pollUpdateMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.viewOnceMessage)!=null&&(a.futureProofMessageType="viewOnceMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.contactMessage)!=null&&(a.futureProofMessageType="contactMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.extendedTextMessage)!=null&&(a.futureProofMessageType="extendedTextMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.groupInviteMessage)!=null&&(a.futureProofMessageType="groupInviteMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.commonSticker)!=null&&(a.futureProofMessageType="commonSticker");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.screenshotAction)!=null&&(a.futureProofMessageType="screenshotAction");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.extendedMessageContentWithSear)!=null&&(a.futureProofMessageType="extendedMessageContentWithSear");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.imageGalleryMessage)!=null&&(a.futureProofMessageType="imageGalleryMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.content)==null?void 0:c.paymentsTransactionMessage)!=null&&(a.futureProofMessageType="paymentsTransactionMessage");(b==null?void 0:(c=b.payload)==null?void 0:(c=c.applicationData)==null?void 0:c.metadataSync)!=null&&(a.futureProofMessageType="metadataSync");(b==null?void 0:(c=b.payload)==null?void 0:(b=c.applicationData)==null?void 0:b.aiBotResponse)!=null&&(a.futureProofMessageType="aiBotResponse")}function U(a,b,c,e){var f;f=(f=a.metadata)==null?void 0:f.messageId;a=d("decodeProtobuf").decodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,a.payload);var g=d("WAParseMessageApplication").parseMessageApplication(a);if(g.type==="error"){d("WALogger").ERROR(o());return}a=a.metadata;var h=a==null?void 0:a.quotedMessage;h=h==null?void 0:h.stanzaId;f!=null&&h!=null&&(c.has(h)||b.add(h),e.set(f,h));if(g.subprotocolType==="armadillo"){c=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAArmadilloApplication.pb").ArmadilloSpec,g.payload);return{metadata:a,obj:c}}else if(g.subprotocolType==="consumerMessage")return{metadata:a,obj:d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,g.payload)}}function V(a,b,c,d,e,f,g,h,i){return a.map(function(a){return W(a,b,c,d,e,f,g,h,i)})}function W(a,b,c,e,f,g,h,i,j){g===void 0&&(g=new Map());var k=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,a.toplevelProtobuf.decryptedProtobuf);k=ca(k,a.toplevelProtobuf.protobufTimestampMS,b,a.otid,c,e,f,g,h,i,j);c=a.supplementalProtobufs;for(h of c){i=h[0];j=h[1];c=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,j.decryptedProtobuf);if(!d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufAReaction(i)&&!d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufAnEdit(i)&&!d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufARavenAction(i))continue;if(d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufARavenAction(i)&&c.payload!=null){var l=U(c,e,f,g),m=i.split(":")[1];m=d("MAWJids").toUserJid(m);m=m===b?d("WAJids").AUTHOR_ME:m;if(l!=null){var o,p,q;l=l.obj;o=(o=l.payload)==null?void 0:(o=o.content)==null?void 0:(o=o.ravenActionNotifMessage)==null?void 0:o.actionTimestamp;p=(p=l.payload)==null?void 0:(p=p.content)==null?void 0:(p=p.ravenActionNotifMessage)==null?void 0:p.actionType;if(o!=null&&p!=null&&typeof o==="number"&&((q=l.payload)==null?void 0:(q=q.content)==null?void 0:(q=q.ravenActionNotifMessage)==null?void 0:(q=q.key)==null?void 0:q.id)!=null){q=d("WAStanzaUtils").toStanzaId((q=l.payload)==null?void 0:(l=q.content)==null?void 0:(q=l.ravenActionNotifMessage)==null?void 0:(l=q.key)==null?void 0:l.id);if(((l=c.metadata)==null?void 0:l.timestampMs)!=null&&typeof ((l=c.metadata)==null?void 0:l.timestampMs)==="number"&&((l=c.metadata)==null?void 0:l.messageId)!=null){var r;l=(l=c.metadata)==null?void 0:l.messageId;r=d("WATimeUtils").castMilliSecondsToUnixTime((r=c.metadata)==null?void 0:r.timestampMs);l=d("WAStanzaUtils").toStanzaId(l);p=p===0?d("MAWMsg").MAWRavenActionNotifType.PLAYED:p===1?d("MAWMsg").MAWRavenActionNotifType.SCREENSHOTTED:d("MAWMsg").MAWRavenActionNotifType.FORCE_DISABLED;o={ack:d("WAAckLevel").ACK.RECEIVED,actionTimestamp:d("WATimeUtils").castMilliSecondsToUnixTime(o),actionType:p,author:m,externalId:l,ravenActionToMsgExternalId:q,ts:r,type:d("MAWMsgType").MSG_TYPE.RAVEN_ACTION};k.ravenActionUnstoredMsg=o}}}}if(d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufAReaction(i)&&c.payload!=null){m=(p=c.metadata)==null?void 0:p.messageId;o=(l=U(c,e,f,g))==null?void 0:(q=l.obj.payload)==null?void 0:(r=q.content)==null?void 0:r.reactionMessage;p=d("MessageBackupSupplementalKeyGenerator").getSupplementalSenderId(i);o!=null&&p!=null&&k.reactionData.push({reaction:o,reactionExternalId:m,senderId:p,ts:d("WATimeUtils").castMilliSecondsToUnixTime(j.protobufTimestampMS)})}else if(d("MessageBackupSupplementalKeyGenerator").isSupplementalProtobufAnEdit(i)&&c.payload!=null){l=i.split(":");l.length!==3&&d("WALogger").ERROR(n());q=d("WAStanzaUtils").toStanzaId(l[1]);p=(r=U(c,e,f,g))==null?void 0:(o=r.obj.payload)==null?void 0:(m=o.content)==null?void 0:m.editMessage;i=(j=c.metadata)==null?void 0:j.senderId;if(p!=null){r=(l=p.key)==null?void 0:l.id;o=p.timestampMs;if(r!=null&&o!=null&&i!=null&&typeof o==="number"){m=d("MAWJids").toUserJid(i);c=m===b?d("WAJids").AUTHOR_ME:m;k.editMsgData.push({author:c,editMsgContent:p,externalId:q,originalMsgExternalId:d("WAStanzaUtils").toStanzaId(r),ts:d("WATimeUtils").castMilliSecondsToUnixTime(o)})}}}}f.add(a.otid);return k}function ea(a,b,e,f,g,h){g==null?void 0:g.addPoint("replies_restore_start");return I(a,f,g).then(function(){b!=null&&(h.forEach(function(a){d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(a,b,void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT,f)}),h.clear())})}function fa(a,e,f,g){f==null?void 0:f.addPoint("xma_restore_start");var h=[],j=new Map();return(i||(i=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("MAWDbMsg").isXMAMsg(a)){var b=a.externalId,c=e.get(b);if(c!=null&&c.xmaData!=null){c=M(a.author,a.externalId,a.msgId,a.threadJid,c.xmaData);if(c!=null){var f,i,k=[],l=[],m=[],n=new Map();b=g.get(b);b!=null&&b.forEach(function(b){var c=d("WAMediaUtils").stringToDeliveryObjectId(b.mediaMetadata.attachmentObjectId),e=d("WAHashUtils").stringToPlaintextHash(d("MAWHandleEchoMediaMsgsRestoreV2").getBase64WithoutPadding(b.mediaMetadata.plaintextHash)),g=n.get(e);n.set(e,g!=null?[].concat(g,[a.msgId]):[a.msgId]);m.push(c);b.mediaRestoreType==="xma_header"&&(f=c);b.mediaRestoreType==="xma_favicon"&&(i=c);b.mediaRestoreType==="xma_preview"&&k.push(c)});var o=(yield d("MAWHandleEchoXMARestoreV2").getMediaForXMAByObjectIds(m,n));o.forEach(function(a,b){j.set(a.mediaId,a)});if(f!=null){c.headerMediaId=(b=o.get(f))==null?void 0:b.mediaId}if(i!=null){c.faviconMediaId=(b=o.get(i))==null?void 0:b.mediaId}k.forEach(function(a){a=(a=o.get(a))==null?void 0:a.mediaId;a!=null&&l.push(a)});c.previewMediaIds=l;l.length>0&&(c.defaultPreviewMediaId=l[0]);h.push(c)}}}});return function(b){return a.apply(this,arguments)}}())).then(function(){return d("MAWHandleEchoXMARestoreV2").writeXMAsToDb(h).then(function(a){a.forEach(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a.previewMediaIds!=null&&a.previewMediaIds.length>0&&(b=j.get(a.previewMediaIds[0]));var e;c("gkx")("821")?e=(yield d("MAWHandleXmaTransactionUtil").checkMediaChunkTransactionAndCreatedBridgeXma(b,a)):e=d("MAWBridgeXMA").createBridgeXMA(b,a,!1);d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewXMA",value:e}]})});return function(b){return a.apply(this,arguments)}}()),f==null?void 0:f.addPoint("xma_restore_end",{"int":{xma:a.length}})})})}function a(a){return X.apply(this,arguments)}function X(){X=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.currentUserJid,f=a.deanonApiPayload,g=a.decryptedMessagesProtobufs,m=a.echoMessages,n=a.hasMoreAfter,o=a.hasMoreBefore,p=a.instanceKey,q=a.isPointRestore,r=a.minMsgId,s=a.referenceTimestamp,t=a.requestId,u=a.skipMediaDownload,v=a.threadJidPrimaryId;a=a.uploadedFromEbQueue;if(g.length===0)return(i||(i=b("Promise"))).resolve();d("WALogger").LOG(l(),g.length,q,s);var w=new Set(),x=new Set(),y=new Map(),z=new Map(),A=new Map(),B=v,C=(yield d("MAWHandleEchoMsgsRestoreApiV2").getThread(v,t));s=q?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.POINT_RESTORE:s!=null?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.PAGINATED_RESTORE:d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.INITIAL_RESTORE;s=s;var D=d("MAWQplProxy").startQplUserFlow(c("qpl")._(521486220,"827"),{bool:{isPointRestore:q,uploadedFromEbQueue:a},"int":{messages:g.length},string:{message_backup_type:"protobuf",restore_type:s}},void 0,3e5);d("MAWEBRestoreTrackingUtils").addQPLRestorePointWithAnnotationsWorker({annotations:{bool:{isPointRestore:q,uploadedFromEbQueue:a},"int":{messages:g.length},string:{message_backup_type:"protobuf",restore_type:s}},pointName:"restore_maw_job_start",traceId:t});d("MAWTraceUtils").recordCheckpointForTrace(t,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_RESTORE_BEGIN),[],!1);try{if(C){s=V(g,e,v,w,x,y,A,z);D==null?void 0:D.addPoint("restore_protobuf_decode_done",{"int":{decoded_count:s.length,input_decode_gap:g.length-s.length}});var E=C.jid,F=new Set(),G=new Map(),H=new Map(),I=s.map(function(a){G.set(d("WAStanzaUtils").toStanzaId(a.externalId),a);var b=N(a,E,e,y,H);b==null&&F.add(a.externalId);return b}).filter(Boolean),J=s.filter(function(a){return F.has(a==null?void 0:a.externalId)});m!=null&&m.length>0&&m.length!==g.length&&(D==null?void 0:D.addPoint("mismatch_between_echo_and_protobuf_payload_from_server",{"int":{echoMessagesLength:m.length,protobufMessagesLength:g.length}}));if(J.length>0){var K=new Map();J.forEach(function(a){var b="unknown";a.msgType!=null?b=a.msgType:a.futureProofMessageType!=null&&(b=a.futureProofMessageType);a=K.get(b);a!=null?K.set(b,a+1):K.set(b,1)});var L={};K.forEach(function(a,b){b="protobuf_restore_failure_"+b;L[b]=a});D==null?void 0:D.addPoint("protobuf_restore_failed_count_by_msg_type",{"int":L});if(m!=null&&m.length===g.length){d("WALogger").LOG(k());x.clear();D==null?void 0:D.addPoint("reverting_to_echo_restore");yield d("MAWHandleEchoMsgsRestoreApiV2").handleEchoMsgsBulkRestore(v,m,!1,o,n,r,void 0,void 0,p,void 0,void 0,D,void 0,a,c("justknobx")._("3060")&&u);return}}J=I.map(function(a){return{author:a.author,chat:C.jid,externalId:a.stanzaId}});var M=new Set();m=I.map(function(a){M.add(a.stanzaId);return babelHelpers["extends"]({},babelHelpers["extends"]({},a.unstoredDbContent.unstoredDbMsg,{threadJid:C.jid}))});var O=new Map();f!=null&&f.forEach(function(a){O.set(a.externalId,a.sortOrderMs)});s.forEach(function(a){var b=a.sortOrderMs;a=a.externalId;if(O.size>0&&b!=null){a=O.get(a);a!=null&&(a!==b&&(D==null?void 0:D.addPoint("protobuf_restore_toplevel_ts_mismatch")))}});m.sort(function(a,b){return((a=a.sortOrderMs)!=null?a:0)-((a=b.sortOrderMs)!=null?a:0)});n=(yield (i||(i=b("Promise"))).all([d("MAWRestoreMsgsTxns").maybeGetThreadNewestMessage(C),d("MAWRestoreMsgsTxns").maybeGetOldestNonAdminMessage(C),d("MAWRestoreMsgsTxns").getMsgsByProtocolMsgIds(J)]));a=n[0];I=n[1];s=I.maybeOldestAdminMsg;J=I.maybeOldestMsg;I=n[2];var P=new Set(I.filter(function(a){return!c("gkx")("1689")||a.type!==d("MAWMsgType").MSG_TYPE.CIPHERTEXT}).map(function(a){return a.externalId}));n=m.filter(function(a){return!P.has(a.externalId)});m=q||o;z={bumpMessageAuthorMap:z,existingMsgs:I,hasMoreBefore:(o=m)!=null?o:!0,instanceKey:p,isPointRestore:q,maybeNewestMsg:a,maybeOldestAdminMsg:s,maybeOldestMsg:J,minMsgId:r,newMsgs:n,shouldSkipSyncToUI:c("justknobx")._("3060")&&u,thread:C};D==null?void 0:D.addPoint("message_restore_start");I=(yield d("MAWRestoreMsgsTxns").restoreMsgsForThread(z));m=0;o=0;D==null?void 0:D.addPoint("message_restore_end");p=[];(I==null?void 0:I.existingMsgs)!=null&&(p=p.concat(I==null?void 0:I.existingMsgs),m=I==null?void 0:I.existingMsgs.length);(I==null?void 0:I.newlyAddedMsgs)!=null&&(p=p.concat(I==null?void 0:I.newlyAddedMsgs),o=I==null?void 0:I.newlyAddedMsgs.length);d("MAWRestoreValidationUtils").compareRestoredMsgstoDeanonData({dbMsgArray:p,deanonData:f,echoMsgExternalIds:void 0,protobufMsgs:g,restoreQplFlow:D,traceId:t});var Q=[];yield i.all(p.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a!=null)if(A.has(a.externalId)){var b=a.sortOrderMs,c=d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(a.author),e=A.get(a.externalId);b==null?d("WALogger").ERROR(j()):e!=null&&a.mediaId==null&&e.map(function(e){e={author:c,echoMsg:void 0,externalId:a.externalId,isXMA:d("MAWDbMsg").isXMAMsg(a),mediaData:e.mediaMetadata,messageTimestamp:b,msgId:a.msgId,previewMediaData:e.previewMetadata,threadJId:a.threadJid};Q.push(e)})}else if(a.type===d("MAWMsgType").MSG_TYPE.RAVEN){e=H.get(a.externalId);e!=null&&(yield ja(a,e))}});return function(b){return a.apply(this,arguments)}}()));a=d("MAWHandleEchoMediaMsgsRestoreV2").downloadMediaAndWriteToMediaStore(Q,E,u);s=i.all(p.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=G.get(a.externalId);a!=null&&(yield ga(a,E,D,e,c("justknobx")._("3060")&&u),yield ha(a,E,e,D,c("justknobx")._("3060")&&u),a.ravenActionUnstoredMsg!=null&&(yield ka(a.ravenActionUnstoredMsg,C)))});return function(b){return a.apply(this,arguments)}}()));D==null?void 0:D.addPoint("media_restore_start");yield i.all([a,s]);D==null?void 0:D.addPoint("media_restore_end",{"int":{media:Q.length}});yield fa(p,G,D,A);yield la(p,G,D);yield ea(p,B,q,E,D,w);D.endSuccess({"int":{existingMsgs:m,messages_lost:g.length-m-o,newlyAddedMsgs:o,restoredMsgs:m+o,totalMsgsToRestore:g.length},string:{threadJidPrimaryId:v}});d("MAWTraceUtils").recordCheckpointForTrace(t,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_RESTORE_MESSAGES_SUCCESS),[],!1);d("MAWTraceUtils").recordCheckpointForTrace(t,h.ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),[],!0)}}finally{A.clear(),x.clear()}});return X.apply(this,arguments)}function ga(a,b,c,d,e){return Y.apply(this,arguments)}function Y(){Y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){c.addPoint("msg_history_start");if(a.editMsgData.length>0){var g,h,i,j=[],k=a.sortOrderMs;g=(g=a.metadata)==null?void 0:g.messageId;h=(h=a.metadata)==null?void 0:h.senderId;i=(i=a.decodedPayload)==null?void 0:i.text;if(g!=null&&h!=null){k=d("WATimeUtils").castMilliSecondsToUnixTime(k);h=d("MAWJids").toUserJid(h);g=d("WAStanzaUtils").toStanzaId(g);e=h===e?d("WAJids").AUTHOR_ME:h;h=Z(e,i,g,g,k,b);h!=null&&j.push(h);a.editMsgData.forEach(function(a){var c;c=Z(a.author,(c=a.editMsgContent.message)==null?void 0:c.text,a.externalId,a.originalMsgExternalId,a.ts,b);c!=null&&j.push(c)});yield ia(j,f);c.addPoint("msg_history_end")}}});return Y.apply(this,arguments)}function Z(a,b,c,e,f,g){var h=a===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED;if(b!=null)return{author:a,editExternalId:c,editTs:f,msgContent:{content:b},originalMsgExternalId:e,sendStatus:h,threadJid:g};d("WALogger").ERROR(m());return void 0}function ha(a,b,c,d,e){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){f=K(a,e,f);a=a.metadata;if(f!=null&&a!=null){g.addPoint("reactions_restore_start");var j=a.messageId,k=[];f.forEach(function(a,b){return k.push({stanzaId:b,waReactionMsg:a})});if(c("gkx")("4219")){a=k.filter(function(a){a=a.waReactionMsg;return j!=null&&a.ts!=null}).map(function(a){var b=a.stanzaId;a=a.waReactionMsg;return{args:{groupingKey:a.reaction.groupingKey,reaction:a.reaction.text,reactToAuthor:d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(a.reactToMsgAuthor),reactToExternalId:a.reactToExternalId,senderTimestampMs:a.reaction.senderTimestampMs},author:d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(a.reactionAuthor),chatJid:e,externalId:b,ts:a.ts}});yield d("MAWWriteReactionMsgApi").bulkWriteReactionMsg(a,h)}else{f=(i||(i=b("Promise"))).all(k.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.waReactionMsg,c=b.ts;c!=null&&j!=null&&(yield d("MAWWriteReactionMsgApi").writeReactionMsg(a.stanzaId,e,{groupingKey:b.reaction.groupingKey,reaction:b.reaction.text,reactToAuthor:d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(b.reactToMsgAuthor),reactToExternalId:b.reactToExternalId,senderTimestampMs:b.reaction.senderTimestampMs},c,d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(b.reactionAuthor),h))});return function(b){return a.apply(this,arguments)}}()));yield f}g.addPoint("reactions_restore_end")}});return $.apply(this,arguments)}var ia=e.makeMsgrTransactor({editMsgHistory:f.READWRITE,messages:f.READWRITE},"bulkAddEditMsgHistory",function(a){return function(b,e){return d("MAWDbEditMsgHistoryTxns").bulkAddEditMsgHistory(a,b,!e).then(c("emptyFunction"))}}),ja=e.makeMsgrTransactor({chunk:f.READWRITE,media:f.READWRITE,mediaBackup:f.READWRITE,messages:f.READWRITE},"handleUnstoredMedia",function(a){return function(b,c){return d("MAWMediaManagementTxns").handleUnstoredDbMedia(a,c,b,"ebrestore",!1,!1,"EncryptedBackups")}}),ka=e.makeMsgrTransactor({messages:f.READWRITE,unrenderedMessages:f.READWRITE},"writeRavenActinomsg",function(a){return function(b,c){return d("MAWDbRavenActionTxns").writeRavenActionMsg(a,b,c)}});function la(a,b,e){if(!c("gkx")("5624"))return;e==null?void 0:e.addPoint("receiver_fetch_restore_start");var f=[];a.forEach(function(a){if(a.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH&&a.receiverFetchId!=null){var c=b.get(a.externalId);if(c!=null&&c.receiverFetchInfo!=null){c=babelHelpers["extends"]({},c.receiverFetchInfo,{type:"sticker"});f.push({dbMsg:a,unstoredDbReceiverFetchInfo:c})}}});return ma(f).then(function(){e==null?void 0:e.addPoint("receiver_fetch_restore_end")})["catch"](function(a){e==null?void 0:e.addPoint("receiver_fetch_restore_failure")})}var ma=e.makeMsgrTransactor({receiverFetchInfo:f.READWRITE},"restoreWriteReceiverFetchInfosToTb",function(a){return function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.unstoredDbReceiverFetchInfo;return d("MAWWriteReceiverFetchTxns").handleUnstoredReceiverFetchInfo(a,c,b)}))}});g.associateQuotedMessagesForRestoredDbMsgsTransactor=I;g.createUnstoredDbContentFromProtobufObject=N;g.decodeProtobufArray=V;g.decodeDecryptedMessageProtobuf=W;g.handleProtobufsRestore=a;g.writeReceiverFetchInfosToTb=ma}),98);
__d("MAWEncryptedBackupsDYIProcessProtobufMessages",["CurrentUser","EncryptedBackupsDYIMessageProcessingUtils","EncryptedBackupsDYISingleton","MAWEBUploadMessageUtils","MAWFrontendMediaUtils","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWMsgType","MebWAMediaDownloader","WAHashUtils","WAJids","WAMediaUtils","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Starting DYI media download for attachemnt with hash ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Media message is missing media data"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Explicitly dropping "," message type"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bump message is not supported in DYI"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] XMA message doesn't have xmaData"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Documents are not supported in DYI"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to calculate sortOrder for protobuf message"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: ts or messageId or senderId is null"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: metadata or message type is null"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf. Dropping the message: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Decoded protobuf is empty"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing "," protobuf messages for thread ",""]);u=function(){return a};return a}function a(a,b,e){var f=d("EncryptedBackupsDYISingleton").getSingleton(),g=f.getLogger();void g.LOG(u(),e.length,b);var h=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());e.forEach(function(c){try{c=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(c,h,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);if(c==null){void g.WARN(t());return}if(c!=null&&c.metadata!=null&&c.metadata.messageId!=null){var e=d("WAStanzaUtils").toStanzaId(c.metadata.messageId);c=v(a,b,c);if(c==null){void g.WARN(s());return}f.setMessagesByThreadKey(a,e,c)}else{void g.WARN(r());return}}catch(a){void g.ERROR(q(),a);return}})}function v(a,b,e){var f,g=d("EncryptedBackupsDYISingleton").getSingleton(),h=g.getLogger(),i=e.metadata,q=e.msgType;if(i==null||q==null){void h.WARN(p());return}q=i.messageId;var r=i.senderId;i=i.timestampMs;if(i==null||typeof i!=="number"||q==null||r==null){void h.WARN(o());return}q=d("WATimeUtils").castMilliSecondsToUnixTime(i);i=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());i=d("MAWHandleEchoProtobufsRestoreApi").createUnstoredDbContentFromProtobufObject(e,d("WAJids").unsafeCoerceToChatJid(b),i,new Map(),void 0);if((i==null?void 0:i.unstoredDbContent.unstoredDbMsg)==null){void h.WARN(n());return}i=d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(i.unstoredDbContent.unstoredDbMsg);r=d("EncryptedBackupsDYIMessageProcessingUtils").buildBaseDyiMessage(r,i);f=(f=e.decodedPayload)==null?void 0:f.text;if(e.editMsgData.length>0){var s=q;e.editMsgData.forEach(function(a){var b;if(a.ts>s&&((b=a.editMsgContent.message)==null?void 0:b.text)!=null){s=a.ts;f=(b=a.editMsgContent.message)==null?void 0:b.text}})}e.reactionData.length>0&&(r.reactions=e.reactionData.map(function(a){var b=a.reaction;a=a.senderId;return{actor:(a=g.getContactNameForContactId(a))!=null?a:"unknown",reaction:(a=b.text)!=null?a:"unknown"}}));switch(e.msgType){case d("MAWMsgType").MSG_TYPE.TEXT:r.type="text";r.text=f||"";break;case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.PTT:r.type="media";r.text=f||"";r=w(a,b,e,i,r);break;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:void h.WARN(m());return;case d("MAWMsgType").MSG_TYPE.XMA:r.type="link";if(e.xmaData==null){void h.WARN(l());return}r.text=((q=e.xmaData)==null?void 0:q.ctas.map(function(a){return a.nativeUrl}).filter(Boolean).join("\n"))||"";break;case d("MAWMsgType").MSG_TYPE.REVOKED:r.type="placeholder";r.isUnsent=!0;r.text="User unsent a message";break;case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:void h.WARN(k());return;default:void h.LOG(j(),e.msgType);return}return r}function w(a,b,c,e,f){var g,j=d("EncryptedBackupsDYISingleton").getSingleton(),k=j.getLogger();if(c.mediaMetadata==null){void k.WARN(i());return f}var l=c.mediaMetadata,m=l.attachmentObjectId,n=l.backupEntFbid,o=l.directPath,p=l.encryptedHash,q=l.filename,r=l.mediaContentType,s=l.mediaKey,t=l.mediaKeyTimestamp,u=l.plaintextHash;l=l.size;g=(g=(g=c.metadata)==null?void 0:g.senderId)!=null?g:"0";c=d("WAStanzaUtils").toStanzaId(c.externalId);u=d("WAHashUtils").stringToPlaintextHash(u);r=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(r||"");r=r.serverMediaType;f.media.add(u);if(!j.isAttachmentDownloadInProgressForPlaintextHash(u)&&!j.isAttachmentDownloadCompleteForPlaintextHash(u)){void k.LOG(h(),d("WAHashUtils").sanitisePlaintextHash(u));j.addPlaintextHashToAttachmentDownloadsInProgress(u);j=d("MAWHandleEchoMediaMsgsRestoreV2").constructMediaEntry(u,(k=p)!=null?k:"",s,o,t,r,q,n,m,null,l);p=d("WAMediaUtils").decodeMediaEntryData(j);void d("EncryptedBackupsDYIMessageProcessingUtils").startMediaDownloadChain(d("MebWAMediaDownloader").MebWADownloadMediaThroughTheBridge,"-8","msgr",p,b,a,g,c,u,e)}return f}g.processEBProtobufMessagesForDYI=a}),98);
__d("MAWEncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYIHandleMessageRestore","I64","LSDatabaseSingleton","LSFactory","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsDYIProcessEchoMessages","MAWEncryptedBackupsDYIProcessProtobufMessages","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h||d("LSIntEnum")).ofNumber(c("LSMEBTaskCreationSource").MSGR_DYI),l=c("justknobx")._("467"),m=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("MAWEBRestoreTrackingUtils").markEBRestoreDYI(c("LSMEBTaskCreationSource").MSGR_DYI),yield a.runInTransaction(function(a){return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),{isPointQuery:!1,newerNumMessages:(i||(i=d("I64"))).zero,numMessages:i.of_int32(l),source:k,startSortKey:b,threadId:e})},"readwrite",void 0,void 0,f.id+":41")});return function(b,c,d){return a.apply(this,arguments)}}();function a(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton);void d("EncryptedBackupsDYIHandleMessageRestore").handleMessageRangeQueryRestore(f,a,b,c,e,d("MAWEncryptedBackupsDYIProcessEchoMessages").processEBEchoMessagesForDYI,m)});return n.apply(this,arguments)}function e(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton);void d("EncryptedBackupsDYIHandleMessageRestore").handleMessageRangeQueryRestore(f,a,b,c,e,d("MAWEncryptedBackupsDYIProcessProtobufMessages").processEBProtobufMessagesForDYI,m)});return o.apply(this,arguments)}g.taskCreationSource=k;g.MESSENGER_DYI_BATCH_SIZE=l;g.handleMAWEchoMessageRangeQueryRestore=a;g.handleMAWProtobufMessageRangeQueryRestore=e}),98);
__d("MAWHandleEBRestoreWithHIM",["EchoMessage","EncryptedBackupsUploadEntity","FBLogger","MAWAckLevel","MAWAsMessageApplication","MAWBulkEditMsgsTxns","MAWConvertXMAGatingTypeToExtendedContentOverlayIconGlyph","MAWConvertXMALayoutTypeToExtendedContentXMLLayoutType","MAWConvertXMATargetTypeToExtendedContentTargetType","MAWDbMsgUtil","MAWFrontendMediaUtils","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoMsgsRestoreApiUtils","MAWHandleEchoReactionsRestore","MAWHandleEchoXMARestoreV2","MAWJids","MAWMsgType","MAWParseXMAProtocol","MAWUnsafeCoerce","MessageBackupSupplementalKeyGenerator","WAHashUtils","WAJids","WALogger","WALongInt","WAProtocolQueue","WASortedLists","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to convert Echo Message to ProtocolMsgId"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to convert Echo Message to UnstoredDbMsg"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] One of the mandatory fields is null for Echo message"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid field is not present in the restoredMsg. Echo message origin ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] xmaTargetType field is not present in the echo doc. Echo message origin ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to construct downloadableThumbnail from previewMediaData: ",", msg id: ",""]);m=function(){return a};return a}function n(a,b){if(a==="@me"||a==="@system")return b;else return a}function o(a,b,c,e,f){var g=[];if(a.reactionXOfflineThreadingIds!=null)for(var h=0;h<a.reactionXOfflineThreadingIds.length;++h){var i=d("MAWHandleEchoReactionsRestore").getReactionsForReactionStore(b,c,e,null,f,a);i=i.map(function(a){return{decodedMsg:{unstoredDbMedia:void 0,unstoredDbMsg:void 0,unstoredDbReaction:a,unstoredDbReceiverFetchInfo:void 0},stanza:q(a.externalId,a.ts,n(a.author,c),b,"reaction")}});g.push.apply(g,i)}return g}function p(a,b,c,e){return e?e.map(function(e){var f=e.messageId;return f!=null?{decodedMsg:{unstoredDbEditActionMsg:{ack:d("MAWAckLevel").ACK.sent,author:c,editMsgContent:{content:e.text},externalId:d("WAStanzaUtils").toStanzaId(f),originalMsgExternalId:a,serverTs:d("WATimeUtils").castToUnixTime(e.timestamp),ts:d("WATimeUtils").castToUnixTime(e.timestamp),type:d("MAWMsgType").MSG_TYPE.EDIT_ACTION},unstoredDbMedia:void 0,unstoredDbMsg:void 0,unstoredDbReaction:void 0},stanza:q(d("WAStanzaUtils").toStanzaId(f),d("WATimeUtils").castToUnixTime(e.timestamp),c,b,"text")}:null}).filter(Boolean):[]}function a(a,b,e){var f,g=a.from,h=d("MAWHandleEchoMsgsRestoreApiUtils").getDbMsgTypeFromEchoMessage(a);if(g==null||h==null)return null;h=a.xOfflineThreadingId;if(h==null){c("FBLogger")("labyrinth_web").warn("xOfflineThreadingId is null for Echo message");return null}h=d("WAStanzaUtils").toStanzaId(h);f=d("WATimeUtils").castToUnixTime(((f=a.authoritativeTimestampMs)!=null?f:a.sortOrderMs)/1e3);g=d("MAWJids").toUserJid(g.localKey);var i=t(a,b,e,h);if(i==null)return null;e=o(a,b,e,h,g);var j=a.contentType===d("EchoMessage").EchoMessageContentType.TEXT||a.contentType===d("EchoMessage").EchoMessageContentType.PLACEHOLDER?"text":"media";a=p(h,b,g,a.editHistory);return[{decodedMsg:i,stanza:q(h,f,g,b,j)}].concat(e,a)}function q(a,b,c,e,f){var g={icdc:null,metadata:null,protobuf:new Uint8Array(0),subprotocol:new Uint8Array(0),subprotocolType:"consumerMessage",type:"subprotocol",version:"v3"};g={device:{id:d("WAJids").DEFAULT_DEVICE_ID,identity:null},folder:null,id:{author:c,chat:e,externalId:a},msg:g,recipientsCount:null,reportingMeta:null,ts:b,type:"IncomingMsg"};return{incomingType:"ebrestore",jid:e,message:{decrypted:g,details:{count:0,externalId:a,folder:void 0,from:d("WAJids").switchOnMsgrChatJidType(e,{group:function(a){return{author:d("WAJids").defaultDeviceJidForUser(c),chat:a,groupJid:a,type:"group"}},user:function(a){return{author:d("WAJids").defaultDeviceJidForUser(c),chat:a,deviceJid:d("WAJids").defaultDeviceJidForUser(c),type:"device"}}}),hideDecryptionFailure:!0,isInstamadillo:!1,offline:null,recipient:null,reportingMeta:null,retryCount:0,ts:b,type:f}},priority:d("WAProtocolQueue").WAProtocolQueuePriorityLow,stanzaId:a,stanzaQueueId:d("MAWUnsafeCoerce").unsafeCoerce(-1),type:"message"}}function r(a,b){if(a.mediaData==null)return null;b=a.previewMediaData;var c=a.sortOrderMs,e=a.xOfflineThreadingId;a=a.mediaData;var f=a.attachmentObjectId,g=a.backupEntFbid,h=a.directPath,i=a.encryptedHash,j=a.filename,k=a.height,l=a.mediaContentType,n=a.mediaKey,o=a.mediaKeyTimestamp,p=a.mediaPlayableDuration,q=a.plaintextHash,r=a.previewContentHeight,s=a.previewContentWidth,t=a.size;a=a.width;l=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(l||"");var u=l.mediaType;l=l.serverMediaType;var v=d("WAHashUtils").stringToPlaintextHash(d("MAWHandleEchoMediaMsgsRestoreV2").getBase64WithoutPadding(q)),w=null;if(b!=null)try{w=d("MAWHandleEchoMediaMsgsRestoreV2").constructRawDownloadableThumbnail(b)}catch(a){d("WALogger").WARN(m(),a,e)}e=d("MAWHandleEchoMediaMsgsRestoreV2").constructMediaEntry(v,(b=i)!=null?b:"",n,h,o,l,j,g,f,w,t);v=d("MAWHandleEchoMediaMsgsRestoreV2").getMediaInfo({filename:j,height:k,mediaPlayableDuration:p,mediaType:u,previewContentHeight:r,previewContentWidth:s,width:a});i=v.validatedAudioInfo;b=v.validatedDocumentFileInfo;n=v.validatedImageInfo;h=v.validatedVideoInfo;return{mediaEntry:e,mediaType:u,msgIds:d("WASortedLists").asSortedSet(new Set()),plaintextHash:d("WAHashUtils").stringToPlaintextHash(q),size:t||0,ts:o!=null?d("WATimeUtils").castToUnixTime(o):d("WATimeUtils").castMilliSecondsToUnixTime(c),validatedAudioInfo:i,validatedDocumentFileInfo:b,validatedImageInfo:n,validatedVideoInfo:h}}function s(a,b){if(a.xmaData==null||a.from==null||a.xOfflineThreadingId==null)return null;var c=a.from,e=a.serializationOrigin,f=a.xmaData;a=a.xOfflineThreadingId;if(f.xmaTargetType==null)return null;var g=f.xmaContentRef,h=f.xmaDefaultCTA,i=f.xmaGatingType,j=f.xmaHeaderSubtitle,m=f.xmaHeaderTitle,n=f.xmaIsTombstoned,o=f.xmaLayoutType,p=f.xmaMaxSubtitleNumLines,q=f.xmaMaxTitleNumLines,r=f.xmaSubtitleText,s=f.xmaTargetExpiry,t=f.xmaTargetId,u=f.xmaTargetType,v=f.xmaTargetUsername;f=f.xmaTitleText;if(u!=null)u=d("MAWConvertXMATargetTypeToExtendedContentTargetType").convertXMATargetTypeToExtendedContentTargetType(u);else{d("WALogger").ERROR(l(),e);return null}var w;h!=null&&(w=d("MAWHandleEchoXMARestoreV2").getDefaultCTA(h));if(w!=null&&!d("MAWParseXMAProtocol").isValidCTA(w,u,!0)){d("WALogger").ERROR(k(),e);return null}var x;i!=null&&(x=d("MAWConvertXMAGatingTypeToExtendedContentOverlayIconGlyph").convertXMAGatingTypeToExtendedContentOverlayIconGlyph(i));var y;s!=null&&(y=d("WATimeUtils").castToUnixTime(s));var z;o!=null&&(z=d("MAWConvertXMALayoutTypeToExtendedContentXMLLayoutType").convertXMALayoutTypeToExtendedContentXMLLayoutType(o));return{unstoredDbXMA:{author:d("MAWJids").toUserJid(c.localKey),contentRef:g,ctas:[],defaultCTA:w,externalId:d("WAStanzaUtils").toStanzaId(a),headerTitle:m,isTombstoned:n,maxSubtitleNumOfLines:p,maxTitleNumOfLines:q,overlayDescription:j,overlayIconGlyph:x,overlayTitle:m,subtitleText:r,targetExpiringAtSec:y,targetId:t,targetType:u,targetUsername:v,threadJid:b,titleText:f,xmaLayoutType:z}}}function t(a,b,c,e){c=d("MAWHandleEchoMsgsRestoreApiUtils").getUnstoredDbMessageFromEchoMessage(a,b,c,e);if(c==null)return null;c.originalTs;c.threadJid;c.unsendMsgContentDeleteTs;e=babelHelpers.objectWithoutPropertiesLoose(c,["originalTs","threadJid","unsendMsgContentDeleteTs"]);c={unstoredDbMedia:r(a,b),unstoredDbMsg:e,unstoredDbReaction:void 0,unstoredDbReceiverFetchInfo:void 0};e=s(a,b);return e==null?c:babelHelpers["extends"]({},c,{unstoredXMA:e})}function b(a,b,c){var e=a.from,f=a.sortOrderMs,g=a.xOfflineThreadingId;f=d("WATimeUtils").castToMillisTime(f);if(g==null||e==null){d("WALogger").WARN(j());return null}var k=d("MAWJids").toUserJid(e.localKey),l=d("WAStanzaUtils").toStanzaId(g);e=t(a,b,c,l);if((e==null?void 0:e.unstoredDbMsg)==null){d("WALogger").WARN(i());return null}g=e.unstoredDbMedia;var m=e.unstoredDbMsg;e=e.unstoredXMA;var n=d("MAWDbMsgUtil").getProtocolMsgIdFromDbMsg(m);if(n==null){d("WALogger").WARN(h());return null}var q;(e==null?void 0:e.unstoredDbXMA)!=null&&(q={associatedMessage:null,defaultPreview:null,favicon:null,header:null,previews:null,xma:e.unstoredDbXMA});var r={frankingKey:null,frankingTag:null,frankingVersion:null,reportingContent:null,reportingTag:null};e={decryptedProtobuf:d("EncryptedBackupsUploadEntity").ebBackupMessageBytesToArrayBuffer(d("EncryptedBackupsUploadEntity").encodeBackupMessage({messageApplication:d("MAWAsMessageApplication").encodeMessageApplication(m,g,null,q),msgId:n,reportingMeta:r,sortOrderMs:f})),protobufTimestampMS:f};var s=new Map();p(l,b,k,a.editHistory).map(function(a){return(a=a.decodedMsg)==null?void 0:a.unstoredDbEditActionMsg}).filter(Boolean).map(function(a){return d("MAWBulkEditMsgsTxns").getMessageHistory(a,b)}).forEach(function(a,c){var e=a.editExternalId,f=a.editTs;e=((e=e)!=null?e:c)+":"+f.toString();s.set(d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.EDIT,e),{decryptedProtobuf:d("EncryptedBackupsUploadEntity").ebBackupMessageBytesToArrayBuffer(d("EncryptedBackupsUploadEntity").encodeBackupMessage({messageApplication:d("MAWAsMessageApplication").encodeEditMessageApplication(a),msgId:{author:k,chat:b,externalId:l},reportingMeta:r,sortOrderMs:d("WATimeUtils").castUnixTimeToMillisTime(a.editTs)})),protobufTimestampMS:d("WATimeUtils").castUnixTimeToMillisTime(f)})});o(a,b,c,l,k).map(function(a){return(a=a.decodedMsg)==null?void 0:a.unstoredDbReaction}).filter(Boolean).forEach(function(a){var c=a.externalId,e=a.senderTimestampMs,f=a.ts;e=e!=null?d("WATimeUtils").castToMillisTime(d("WALongInt").numberOrThrowIfTooLarge(e)):d("WATimeUtils").castUnixTimeToMillisTime(f);c=c+":"+f.toString();s.set(d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.REACTION,c),{decryptedProtobuf:d("EncryptedBackupsUploadEntity").ebBackupMessageBytesToArrayBuffer(d("EncryptedBackupsUploadEntity").encodeBackupMessage({messageApplication:d("MAWAsMessageApplication").encodeReactionMessageApplication(a),msgId:{author:k,chat:b,externalId:l},reportingMeta:r,sortOrderMs:e})),protobufTimestampMS:e})});return{otid:l,supplementalProtobufs:s,toplevelProtobuf:e}}g.convertEchoMessage=a;g.convertEchoMessageToEBProtobuf=b}),98);
__d("MAWRestoreMessagesFromEncryptedBackupsDeferred",["ExecutionEnvironment","LSDatabaseSingleton","LSVec","MAWEncryptedBackupUtils","Promise","asyncToGeneratorRuntime","cr:10036","gkx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("requireDeferred")("MAWRestoreMessagesFromEncryptedBackupsNOP").__setRef("MAWRestoreMessagesFromEncryptedBackupsDeferred");function a(a,e,f,g,l,m,n,o,p,q,r,s){return k.load().then(function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(k){var t=q!=null?Number(q):void 0;t=c("gkx")("201")?d("MAWEncryptedBackupUtils").getMessageMetadataFromDeanonAPI(e,f.length,t):(j||(j=b("Promise"))).resolve();var u,v;(i||(i=c("ExecutionEnvironment"))).isInWorker&&b("cr:10036")!=null?(yield b("cr:10036").init(),u=(yield b("cr:10036").getLSStorage())):(u=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton),v=(yield t));return u.runInTransaction(function(b){return k.call(b,a,e,f,g,l,m,n,o,p,q,r,v,s)},"readwrite").then(function(){return[c("LSVec").ofArray([]),c("LSVec").ofArray([]),!1]})["catch"](function(){return[c("LSVec").ofArray([]),c("LSVec").ofArray([]),!1]})});return function(a){return k.apply(this,arguments)}}())}g.call=a}),98);
__d("LSRestoreEchoBlobs.nop",["CurrentUser","EchoMessage","I64","LSIntEnum","LSMEBTaskCreationSource","LSVec","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWHandleEBRestoreWithHIM","MAWJidUtils","MAWJids","MAWJobDefinitions","MAWRestoreMessagesFromEncryptedBackupsDeferred","Promise","ReQL","WALogger","WATagsLogger","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["LSRestoreEchoBlobs error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["LSRestoreEchoBlobs error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - no messages returned but hasMoreBefore is true"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - Failed to decode echo message, with error: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - Failed to decode echo message, with error: cannot generate ChatJid"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - cannot generate ChatJid from threadKey"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - cannot find thread with serverThreadKey ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - cannot find MI ACT mapping table entry for threadId ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - "," "," ",""]);t=function(){return a};return a}var u=new Map();a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,v,w,x,y,z,A,B,C,D){var E=d("WATagsLogger").TAGS(["labyrinth_web","echo_restore",(e=B)!=null?e:"no_request_id"]);try{if(B!=null){E.LOG(t(),B,A,(f=C)!=null?f:"");d("MAWEBRestoreTrackingUtils").markEBRestoreEcho(D);e=c("LSVec").toArray(g);if(!u.has(A)){f=d("MAWAsyncEBPendingQueryPromise").getJidFromThreadId(A);if(f!=null)u.set(A,f);else{f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table.index("jid")).getKeyRange((j||(j=d("I64"))).of_string(A))));if(f==null){E.ERROR(s(),A);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}var F=f.serverThreadKey;f=f.jid;a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(F)));if(a==null){E.ERROR(r(),F);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}F=d("MAWJidUtils").LSJidtoChatJid(f,a.threadType);if(F!=null)u.set(A,F);else{E.ERROR(q());return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}}}d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start",traceId:B,type:"echo"});d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(B,{echoMessages:e.map(d("MAWJobDefinitions").toEncodedEchoMessage),hasMoreAfter:x,hasMoreBefore:v,isPointQuery:z,messages:e.map(function(a){try{a=d("EchoMessage").decodeEchoMessage(a);if(a==null)return null;var b=d("MAWJids").toUserJid(c("CurrentUser").getAccountID()),e=u.get(A);if(e==null){E.ERROR(p());return null}e=d("MAWHandleEBRestoreWithHIM").convertEchoMessage(a,e,b);if(e==null||e.length===0)return null;e=(b=e[0].decodedMsg)==null?void 0:b.unstoredDbMsg;if(e==null)return null;e.sortOrderMs=a.sortOrderMs;return e}catch(a){E.ERROR(o(),a.message);return null}}).filter(Boolean),nextMessageTimestampMsBefore:w,referenceTimestamp:C,requestId:B,restoreType:"echo",threadId:A})}f=c("LSVec").toArray(g);d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(f,"echo_restore");v===!0&&f.length===0&&E.ERROR(n());a=D!=null&&(i||(i=d("LSIntEnum"))).toNumber(D)===c("LSMEBTaskCreationSource").BULK_QUERY_FOR_SEARCH_RESULT;if(a)return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])]);F=D!=null&&(i||(i=d("LSIntEnum"))).toNumber(D)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(F){d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(B);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}e=D!=null&&(i||(i=d("LSIntEnum"))).toNumber(D)===c("LSMEBTaskCreationSource").MSGR_DYI;if(e){E.LOG(m());g=f.map(d("EchoMessage").decodeEchoMessage).filter(Boolean);void d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWEchoMessageRangeQueryRestore(A,g,v,w);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}c("promiseDone")(d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(A),f.map(d("MAWJobDefinitions").toEncodedEchoMessage),v,w==null?void 0:(j||(j=d("I64"))).to_int32(w),x,y==null?void 0:(j||(j=d("I64"))).to_int32(y),z,B,C,D!=null?(i||(i=d("LSIntEnum"))).unwrapIntEnum(D):-1)["catch"](function(a){d("WALogger").ERROR(l(),a)}));return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}catch(a){d("WALogger").ERROR(k(),a);B!=null&&d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(B,a);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}});function e(b,c,d,e,f,g,h,i,j,k,l,m,n){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("MAWRestoreProtobufsFromEncryptedBackupsDeferred",["ExecutionEnvironment","I64","LSDatabaseSingleton","asyncToGeneratorRuntime","cr:10036","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("requireDeferred")("MAWRestoreProtobufsFromEncryptedBackupsNOP").__setRef("MAWRestoreProtobufsFromEncryptedBackupsDeferred");function a(a,e,f,g,l,m,n,o,p,q,r,s,t,u){return k.load().then(function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(k){var v;(j||(j=c("ExecutionEnvironment"))).isInWorker&&b("cr:10036")!=null?(yield b("cr:10036").init(),v=(yield b("cr:10036").getLSStorage())):v=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return v.runInTransaction(function(b){return k.call(b,a,e,f,g,l!=null?(i||(i=d("I64"))).to_float(l):0,m,n!=null?(i||(i=d("I64"))).to_float(n):(i||(i=d("I64"))).to_float((i||(i=d("I64"))).max_int),o,p,q,r,s,t,u)},"readwrite")});return function(a){return k.apply(this,arguments)}}())}g.call=a}),98);
__d("LSRestoreProtobufs.nop",["CurrentUser","LSIntEnum","LSMEBTaskCreationSource","LSVec","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEBUploadMessageUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWJobDefinitions","MAWRestoreProtobufsFromEncryptedBackupsDeferred","Promise","WAJids","WATagsLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no messages but hasMoreBefore is true"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to decode protobufs, with error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no decoded messages but hasMoreBefore is true"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - ",""]);n=function(){return a};return a}a=function(a,e,f,g,p,q,r,s,t,u,v,w,x,y){a=null;x!=null&&(a=o(x));d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(e=u)!=null?e:"no_request_id"]).LOG(n(),(x=u)!=null?x:"no_request_id");d("MAWEBRestoreTrackingUtils").markEBRestoreProtobuf(y);e=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(g);d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(e,"protobuf_restore");if(u!=null)try{d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start",traceId:u,type:"protobuf"});var z=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());x=d("MAWHandleEchoProtobufsRestoreApi").decodeProtobufArray(e,z,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0).map(function(a){var b;if((a==null?void 0:(b=a.metadata)==null?void 0:b.messageId)!=null){b=d("MAWHandleEchoProtobufsRestoreApi").createUnstoredDbContentFromProtobufObject(a,d("WAJids").unsafeCoerceToChatJid(f),z,new Map(),void 0);if(b!=null&&b.unstoredDbContent.unstoredDbMsg!=null){a=b.unstoredDbContent.unstoredDbMsg;b=d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(a);a.sortOrderMs=b;return a}return null}return null}).filter(Boolean);if(p===!0&&x.length===0){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(g=u)!=null?g:"no_request_id"]).ERROR(m())}d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(u,{echoMessages:a,hasMoreAfter:r,hasMoreBefore:p,isPointQuery:t,messages:x,nextMessageTimestampMsBefore:q,protobufMessages:e,referenceTimestamp:v,requestId:u,restoreType:"protobuf",threadId:f})}catch(a){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(g=u)!=null?g:"no_request_id"]).ERROR(l(),a.message)}if(p===!0&&e.length===0){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(x=u)!=null?x:"no_request_id"]).ERROR(k())}g=y!=null&&(i||(i=d("LSIntEnum"))).unwrapIntEnum(y)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(g){d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(u);return(h||(h=b("Promise"))).resolve()}x=y!=null&&(i||(i=d("LSIntEnum"))).unwrapIntEnum(y)===c("LSMEBTaskCreationSource").MSGR_DYI;if(x){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(g=u)!=null?g:"no_request_id"]).LOG(j());void d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWProtobufMessageRangeQueryRestore(f,e,p,q);return(h||(h=b("Promise"))).resolve()}c("promiseDone")(d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(f),e,p,q,r,s,t,u,v,w,a,y));return(h||(h=b("Promise"))).resolve()};function o(a){return c("LSVec").toArray(a).map(function(a){return d("MAWJobDefinitions").toEncodedEchoMessage(a)})}g["default"]=a}),98);
__d("MAWBridgeTraceRecordCheckpointHandler",["I64","LSAppendDataTraceAddonStoredProcedure","LSFactory","LSFlushDataTrace.nop"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=b.checkPointId,f=b.dataTraceId,g=b.errorMessage,i=b.tags;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:e,dataTraceId:f,errorMessage:g,syncChannel:(h||(h=d("I64"))).neg_one,tags:i}).then(function(){if(b.shouldFlush)return c("LSFlushDataTrace.nop")(a,0,f)})}g.call=a}),98);
__d("MAWOfflineQueueStatus",["FBLogger","MAWSharedProtocolQueueConst"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map(),i=!1;function j(a,b){h.set(a,b),h.size>5e3&&c("FBLogger")("labyrinth_web").warn("Offline queue status map size (%s) is too large",h.size)}function k(a){return h.get(a)}function a(){h=new Map(),i=!1}function b(){return i}function e(){i=!0}function f(a,b){a=Object.keys(a);a.map(function(a){j(a,b)})}function l(a){return k(a)===d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete}function m(){return Array.from(h.entries()).filter(function(a){a[0];a=a[1];return a!==d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete&&a!==d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Failed}).map(function(a){a=a[0];return a})}g.setOfflineQueueStatus=j;g.getOfflineQueueStatus=k;g.resetOfflineQueueState=a;g.isOfflineQueueComplete=b;g.markOfflineQueueComplete=e;g.markThreadWithOfflineQueueStatus=f;g.isOfflineQueueDoneForThread=l;g.getAllThreadsWithOfflineQueueIncomplete=m}),98);
__d("MAWRestoreMessagesFromEncryptedBackupsNOP",["ExecutionEnvironment","I64","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWBridgeTraceRecordCheckpointHandler","MAWBridgeUpdateClientRestoreStatus","MAWChatJid","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsUpdateGlobalRestoreStatus","MAWJobDefinitions","MAWJobManager","MAWMIC","MAWOfflineQueueStatus","MAWTimedJob","MAWUpdateClientRestoreStatusOperationType","Promise","ReQL","WAJobOrchestratorTypes","WALoggerDeferred","WATagsLogger","asyncToGeneratorRuntime","cr:4992","err","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling worker job for thread "," StartSortKey: "," messagesCount: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling prefetch for thread ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to get thread key for "," when calling restoreMessagesFromEncryptedBackup"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][","] Received echo documents for thread: "," startSortKey: "," messagesCount: ",""]);o=function(){return a};return a}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{c=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(c)));if(c!=null){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(c)));if(a!=null)return a.minMessageId}}catch(a){return(i||(i=b("Promise"))).reject(a)}return});return q.apply(this,arguments)}function r(a,b,c){if(b===0){d("MAWMIC").markEvent("eb_restore_start");c&&d("MAWMIC").markEvent("eb_prefetch_start");return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table)).then(function(a){a.forEach(function(a){a=d("MAWJobDefinitions").toThreadJidPrimaryId((k||(k=d("I64"))).to_string(a.jid));d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").addThreadIdToStatusArray(a,"restore");c&&d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").addThreadIdToStatusArray(a,"ebprefetch")})})}}function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,q,s,u,v,w,x,y,z,A){var B;d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",(B=w)!=null?B:""]).LOG(o(),(B=w)!=null?B:"",f,x,g.length);B=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(f)));B==null&&void d("WALoggerDeferred").ERROR(n(),f);B=!d("MAWOfflineQueueStatus").isOfflineQueueComplete()&&b("cr:4992")!=null&&x==null&&f!=null;var C=d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").getCurrentGlobalRestoreStatusArrayLength("restore");yield r(a,C,B);try{C=(yield p(a,f));if(B&&b("cr:4992")!=null){d("WATagsLogger").TAGS(["labyrinth_web","eb_prefetch",(B=w)!=null?B:""]).LOG(m(),f);d("MAWEBRestoreTrackingUtils").markEBRestoreFrontloaded(y,w);B={action:d("MAWUpdateClientRestoreStatusOperationType").upsertClientRestoreStatus,threadId:f};yield d("MAWBridgeUpdateClientRestoreStatus").call(a,B);yield b("cr:4992")(a,e,f,g,h,q,s,u,v,w,x,C,y,z,A)}else{d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",(B=w)!=null?B:""]).LOG(l(),f,x,g.length);return t(e,f,g,C,h,s,v,w,x,y,z,A).then(function(){w!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end",traceId:w,type:"echo"})})}}catch(e){if(w!=null)return d("MAWBridgeTraceRecordCheckpointHandler").call(a,{checkPointId:(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE),dataTraceId:w,errorMessage:e,shouldFlush:!0,syncChannel:-1,tags:void 0}).then(function(){return(i||(i=b("Promise"))).reject(e)})}});return s.apply(this,arguments)}function t(a,e,f,g,j,k,l,m,n,o,p,q){var r=(h||(h=c("ExecutionEnvironment"))).isInWorker?d("MAWJobManager").getJobManager():d("MAWTimedJob").TimedUIJobStarters;if(m!=null&&o===c("LSMEBTaskCreationSource").MESSENGER_MESSAGE_LIST_PAGINATION){var s;return r.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(s=g)!=null?s:void 0,(s=m)!=null?s:void 0,(s=n)!=null?s:void 0,void 0,void 0,o,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},p,q)).then(function(a){if(!c("gkx")("23935"))if(a.success===!0)d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(m);else{var b;d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(m,(b=a.payload)!=null?b:c("err")(a.error))}})}if(q===!0&&c("justknobx")._("3060")){return r.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(s=g)!=null?s:void 0,(s=m)!=null?s:void 0,(s=n)!=null?s:void 0,void 0,void 0,o,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},p,q)).then(function(){return(i||(i=b("Promise"))).resolve()})}return(i||(i=b("Promise"))).resolve(r.fireAndForget(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(s=g)!=null?s:void 0,(r=m)!=null?r:void 0,(a=n)!=null?a:void 0,void 0,void 0,o,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},p,q)))}g.call=a}),98);
__d("MAWRestoreProtobufsFromEncryptedBackupsNOP",["ExecutionEnvironment","I64","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWBridgeTraceRecordCheckpointHandler","MAWChatJid","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWJobDefinitions","MAWJobManager","MAWTimedJob","Promise","Random","ReQL","WAJobOrchestratorTypes","WALoggerDeferred","asyncToGeneratorRuntime","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to get thread key for "," when calling restoreProtobufsFromEncryptedBackups"]);l=function(){return a};return a}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{c=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(c)));if(c!=null){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(c)));if(a!=null)return a.minMessageId}}catch(a){return(i||(i=b("Promise"))).reject(a)}return});return n.apply(this,arguments)}function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,p){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,n,o,q,r,s,t,u,v,w,x){try{var y=(yield m(a,f));n=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(f)));n==null&&void d("WALoggerDeferred").ERROR(l(),f);q=t!=null?Number(t):void 0;u=c("justknobx")._("2620");n=d("Random").coinflip(u);u=n?d("MAWEncryptedBackupUtils").getMessageMetadataFromDeanonAPI(f,g.length,q):(i||(i=b("Promise"))).resolve();return u.then(function(a){return p(e,f,v,g,y,h,o,r,s,t,w==null?void 0:w,a,x).then(function(){s!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end",traceId:s,type:"protobuf"})})})}catch(e){if(s!=null)return d("MAWBridgeTraceRecordCheckpointHandler").call(a,{checkPointId:(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE),dataTraceId:s,errorMessage:e,shouldFlush:!0,syncChannel:-1,tags:void 0}).then(function(){return(i||(i=b("Promise"))).reject(e)})}return(i||(i=b("Promise"))).resolve()});return o.apply(this,arguments)}function p(a,e,f,g,k,l,m,n,o,p,q,r,s){var t=(h||(h=c("ExecutionEnvironment"))).isInWorker?d("MAWJobManager").getJobManager():d("MAWTimedJob").TimedUIJobStarters;if(o!=null&&q!=null&&(j||(j=d("LSIntEnum"))).unwrapIntEnum(q)===c("LSMEBTaskCreationSource").MESSENGER_MESSAGE_LIST_PAGINATION){var u;return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(u=k)!=null?u:void 0,(u=o)!=null?u:void 0,(u=p)!=null?u:void 0,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},q,r,s)).then(function(){c("gkx")("23935")||d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(o)})}if(s===!0&&c("justknobx")._("3060")){return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(u=k)!=null?u:void 0,(u=o)!=null?u:void 0,(u=p)!=null?u:void 0,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},q,r,s))}return(i||(i=b("Promise"))).resolve(t.fireAndForget(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(u=k)!=null?u:void 0,(t=o)!=null?t:void 0,(f=p)!=null?f:void 0,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},q,r,s)))}g.call=a}),98);
__d("X25519",["$InternalEnum","Promise","WACryptoCurve25519Dependencies","WASignalKeys","WASignalOther","WASignalSignatures"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum").Mirrored(["Encryption","Signing"]),j=b("$InternalEnum")({PublicKey:0,PrivateKey:1,Signature:2});function k(a,b){if(b===i.Encryption)return[];b=1;switch(a){case j.PublicKey:b=1;break;case j.PrivateKey:b=2;break;case j.Signature:b=3;break}return[255,b]}function l(a,b,c){b=k(b,c);c=b.length;if(c<=0)return a;var d=new Uint8Array(c+a.byteLength);d.set(Array.from(b));d.set(a,c);return d}function m(a,b,c){b=k(b,c).length;return a.slice(b)}function n(a,b){return{privateKey:l(a.privateKey,j.PrivateKey,b),publicKey:l(a.publicKey,j.PublicKey,b)}}function a(a){a=n(d("WASignalKeys").makeKeyPair(),a);return{pk:a.publicKey,sk:a.privateKey}}function o(a,b){if(b===i.Encryption)return 32;switch(a){case j.PublicKey:case j.PrivateKey:return 32;case j.Signature:return 64}}function p(a,b,c){var d=k(b,c),e=d.length;b=o(b,c);c=b!=null?e+b:0;if(a.length!==c)return!1;var f=a.subarray(0,e);b=new Uint8Array(d);return b.length===f.length&&b.every(function(a,b){return a===f[b]})}function q(a,b){if(p(a,j.PublicKey,b))return a;return}function r(a,b){if(p(a,j.PrivateKey,b))return a;return}function c(a,b){var c=q(a.pkBytes,b);a=r(a.skBytes,b);if(c!=null&&a!=null)return{pk:c,sk:a}}function e(a,c){a=m(a,j.PrivateKey,i.Signing);return d("WASignalSignatures").signMsg(d("WASignalKeys").makeKeyPairFrom(d("WASignalOther").ensureSize(a,32)),c).then(function(a){a=l(a,j.Signature,i.Signing);return(h||(h=b("Promise"))).resolve(a)})}function f(a){if(p(a,j.Signature,i.Signing))return a}function s(a,b,c){b=m(b,j.PublicKey,i.Signing);return d("WASignalSignatures").verifyMsgSignalVariant(d("WASignalKeys").serializeIdentity(b),c,d("WASignalOther").ensureSize(m(a,j.Signature,i.Signing),64))}function t(a,c){c=c;a=a;return!p(a,j.PublicKey,i.Encryption)||!p(c,j.PrivateKey,i.Encryption)?(h||(h=b("Promise"))).resolve():d("WACryptoCurve25519Dependencies").calculateAgreement(a,c).then(function(a){return(h||(h=b("Promise"))).resolve(new Uint8Array(a))})}g.KeyPurpose=i;g.generateKeys=a;g.publicKeyFromBytes=q;g.secretKeyFromBytes=r;g.keysFromBytes=c;g.sign=e;g.signatureFromBytes=f;g.verify=s;g.exchangeKeys=t}),98);
__d("PublicKeyCrypto",["Promise","UInt8Array","X25519"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,c){return(h||(h=b("Promise"))).all([a,c]).then(function(a){return(h||(h=b("Promise"))).resolve(a[0]!=null&&a[1]!=null?d("UInt8Array").concatBytes([a[0],a[1]]):void 0)})}function a(a,b,c){return i(d("X25519").exchangeKeys(c,a),d("X25519").exchangeKeys(c,b))}function c(a,b,c){return i(d("X25519").exchangeKeys(c,a),d("X25519").exchangeKeys(b,a))}g.senderDeriveSharedSecret=a;g.receiverDeriveSharedSecret=c}),98);/*FB_PKG_DELIM*/
__d("GHLGating",["Random","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return c("gkx")("23201")};b=function(){return c("gkx")("23202")};e=function(){return c("gkx")("23203")};f=function(){return c("gkx")("23175")};var h=function(){return c("gkx")("23204")},i=function(){return c("gkx")("23208")},j=function(){return c("gkx")("23209")},k=function(){return c("gkx")("23211")},l=function(){return c("gkx")("23181")},m=function(){return c("gkx")("23182")},n=function(){return c("gkx")("23210")},o=function(){return c("gkx")("23174")},p=function(){return c("gkx")("21000")},q=function(){return c("gkx")("23176")},r=function(){return c("gkx")("23177")},s=function(){return c("gkx")("23178")},t=function(){return c("gkx")("23179")},u=function(){return c("gkx")("23180")},v=function(){return d("Random").intBetween(c("justknobx")._("2436"),c("justknobx")._("2437"))},w=function(){return c("justknobx")._("1731")},x=function(){return c("justknobx")._("592")},y=function(){return c("justknobx")._("593")};g.getSvgTextRandomElementWrapper=a;g.getSvgTextRandomElementWrapperWc=b;g.getSvgTextRandomElementWrapperDiv=e;g.getStoryChunkerDebugMode=f;g.getSvgTextFontSizeFix=h;g.getCometFooterDisplayCheck=i;g.getCometAriaLabelledBysOnRHC=j;g.getCometDeferDOMRhcLink=k;g.getCometDeferDOMAriaLabel=l;g.getCometAriaLabelledBys=m;g.getCometDeferDOMLink=n;g.getCometDebugAdvanced=o;g.getCometGhlContentVisibility=p;g.getUseInjectedStylexLikeCSS=q;g.getScramblerOrderStylesInClass=r;g.getScramblerDisplayFlex=s;g.getScramblerTinyPositionPush=t;g.getScramblerNodeRandomizePlaceholderClasses=u;g.getWidthRandomizerInPx=v;g.getSvgExtraLayersNumofLayers=w;g.getFakeElementBeforeElementCount=x;g.getFakeElementAfterElementCount=y}),98);
__d("GHLMitigationsCounter",["ODS"],(function(a,b,c,d,e,f,g){"use strict";var h,i="ghl_mitigation_counter";function a(a,b){b&&(h||(h=d("ODS"))).bumpEntityKey(4294,i,a);return b}g.incrementMitigationCounterAndReturn=a}),98);
__d("GHLMitigationsGating",["GHLMitigationsCounter","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("shim_randomize_placeholder",c("justknobx")._("684")&&c("gkx")("23184"))};b=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("random_element_wrapper_for_links",c("justknobx")._("922")&&c("gkx")("23185"))};e=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_style_margin_right",c("justknobx")._("222")&&c("gkx")("23186"))};f=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("insert_empty_a_element",c("justknobx")._("1028")&&c("gkx")("23187"))};var h=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("insert_empty_div_element_after_h3",c("justknobx")._("669")&&c("gkx")("23188"))},i=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_style_margin_left",c("justknobx")._("1051")&&c("gkx")("23189"))},j=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("random_el_wrapper_for_story_title",c("justknobx")._("706")&&c("gkx")("23190"))},k=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_style_margin_right_with_div",c("justknobx")._("1175")&&c("gkx")("23191"))},l=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_style_margin_left_with_div",c("justknobx")._("1211")&&c("gkx")("23192"))},m=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_style_width_with_div",c("justknobx")._("1212")&&c("gkx")("23193"))},n=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("chunker",c("justknobx")._("1301")&&c("gkx")("23194"))},o=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_extra_layer",c("justknobx")._("794")&&c("gkx")("23195"))},p=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_multiple_layers",c("justknobx")._("843")&&c("gkx")("23196"))},q=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_text_segments",c("justknobx")._("1070")&&c("gkx")("23197"))},r=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_text",!c("justknobx")._("182")&&c("gkx")("23198"))},s=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("canvas_text",c("justknobx")._("1749")&&c("gkx")("23199"))},t=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("parent_style_randomizer",c("justknobx")._("2217")&&c("gkx")("2750"))},u=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("svg_text_use_tspan",c("justknobx")._("1141")&&c("gkx")("23200"))},v=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("mock_footer_rel_attribute",c("justknobx")._("2382")&&c("gkx")("3356"))},w=function(){return d("GHLMitigationsCounter").incrementMitigationCounterAndReturn("fake_elements_hidden_by_position",c("justknobx")._("2644")&&c("gkx")("4192"))};g.getIsGHLShimRandomizePlaceholderEnabled=a;g.getIsGHLRandomElementWrapperForLinksEnabled=b;g.getIsGHLRandomElementWrapperForStoryTitleEnabled=j;g.getIsGHLEmptyAElementEnabled=f;g.getIsGHLEmptyDivElementAfterH3Enabled=h;g.getIsGHLParentStyleRandomizationEnabled=t;g.getIsGHLSVGStyleMarginRightEnabled=e;g.getIsGHLSVGStyleMarginLeftEnabled=i;g.getIsGHLSVGStyleMarginRightWithDivEnabled=k;g.getIsGHLSVGStyleMarginLeftWithDivEnabled=l;g.getIsGHLSVGStyleWidthtWithDivEnabled=m;g.getIsGHLChunkerEnabled=n;g.getIsGHLSVGExtraLayerEnabled=o;g.getIsGHLSVGMultipleLayersEnabled=p;g.getIsGHLSVGTextSegmentsEnabled=q;g.getIsGHLSVGTextEnabled=r;g.getIsGHLCanvasTextEnabled=s;g.getIsGHLSVGTextUseTspanEnabled=u;g.getIsGHLMockFooterRelAttributeEnabled=v;g.getIsGHLFakeElementHiddenByPositionEnabled=w}),98);
__d("GHLRandomElementWrapper",["Random","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={noop:{boxSizing:"x9f619",display:"xt0psk2",fontFamily:"xjb2p0i",fontSize:"x1qlqyl8",lineHeight:"x15bjb6t",$$css:!0}},l=[[1,0],[1,1],[0,1],[0,2],[1,2],[2,2],[2,1],[1,1]],m=Math.floor(Date.now()/(1e3*60*60*24));b=function(a){var b;return(b={},b[a]=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(HTMLSpanElement)),b)[a]};e=function(){return String.fromCharCode(97+c("Random").random()*25)};d=m%10+5;var n=Array(d).fill().map(e).join("");d=Array(d).fill().map(e).join("");var o=n+"-"+d;window.customElements&&window.customElements.define(o,b(n),{"extends":"span"});function a(a){var b=a.children,d=a.elementTag,e=a.useClassStyles;e=e===void 0?!1:e;a=a.useInlineStyles;a=a===void 0?!1:a;b=b;var f=l[m%l.length],g=a?{display:"inline"}:null,i=(h||(h=c("stylex")))(e?k.noop:null);d==="div"&&!e&&!a&&(i="x9f619 xt0psk2 xjb2p0i x1qlqyl8 x15bjb6t");d==="randomSpan"?window.customElements?e=o:e="span":e=d;a=f[1];for(d=0;d<a;d++)b=j.jsx(e,{className:i,style:g,children:b});b=j.jsx(e,{children:b});d=f[0];for(a=0;a<d;a++)b=j.jsx(e,{className:i,style:g,children:b});return b}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("GHLSVGTextUtils",["GHLGating","GHLMitigationsGating"],(function(a,b,c,d,e,f,g){"use strict";a=d("GHLMitigationsGating").getIsGHLSVGStyleMarginLeftEnabled()||d("GHLMitigationsGating").getIsGHLSVGStyleMarginLeftWithDivEnabled();b=d("GHLMitigationsGating").getIsGHLSVGStyleMarginRightEnabled()||d("GHLMitigationsGating").getIsGHLSVGStyleMarginRightWithDivEnabled();c=function(a){switch(a){case"14px":return 4;case"15px":return 6;default:return 0}};e=function(a){var b=d("GHLGating").getSvgTextFontSizeFix();return b?["13px",a-2]:["12px",a-3]};f=function(a){switch(a){case"14px":case"15px":return!0;default:return!1}};g.anyMarginLeftStylingEnabled=a;g.anyMarginRightStylingEnabled=b;g.getCTAExtraWidth=c;g.getFixedFontSize=e;g.getIsCTAText=f}),98);
__d("GHLSVGElementContainer.react",["GHLMitigationsGating","GHLSVGTextUtils","filterObject","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");b=[d("GHLMitigationsGating").getIsGHLSVGStyleMarginRightEnabled(),d("GHLMitigationsGating").getIsGHLSVGStyleMarginRightWithDivEnabled(),d("GHLMitigationsGating").getIsGHLSVGStyleMarginLeftEnabled(),d("GHLMitigationsGating").getIsGHLSVGStyleMarginLeftWithDivEnabled(),d("GHLMitigationsGating").getIsGHLSVGStyleWidthtWithDivEnabled()];var j=b[0],k=b[1],l=b[2],m=b[3],n=b[4];function a(a){var b=a.domID,e=a.fontSize,f=a.height,g=a.randomizedWidth,h=a.width;f=c("filterObject")({height:f+(e==="15px"?1:0)+"px",overflow:"visible",paddingLeft:e==="15px"?"4px":null,paddingTop:e==="15px"?"1px":null},Boolean);var o={marginRight:"-"+(g-h)+"px",width:g+d("GHLSVGTextUtils").getCTAExtraWidth(e)+"px"};g={marginLeft:"-"+(g-h)+"px",width:h+(g-h)+d("GHLSVGTextUtils").getCTAExtraWidth(e)+"px"};e=j?[null,o]:k?[o,null]:l?[null,g]:m?[g,null]:n?[{width:h+d("GHLSVGTextUtils").getCTAExtraWidth(a.fontSize)+"px"},null]:[null,{width:h+d("GHLSVGTextUtils").getCTAExtraWidth(a.fontSize)+"px"}];o=e[0];g=e[1];h=i.jsx("svg",{style:babelHelpers["extends"]({},f,g),children:i.jsx("use",{xlinkHref:"#"+b,xmlnsXlink:"http://www.w3.org/1999/xlink"})});return o==null?h:i.jsx("div",{style:o,children:h})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("GHLSVGText.react",["BasePortal.react","ExecutionEnvironment","GHLGating","GHLMitigationsGating","GHLRandomElementWrapper","GHLSVGElementContainer.react","GHLSVGTextUtils","cr:6269","react","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));e=i;var k=e.useLayoutEffect,l=e.useRef,m=e.useState,n=null,o=function(){(h||(h=c("ExecutionEnvironment"))).canUseDOM&&n===null&&(n=document.createElement("div"),n.setAttribute("style","position: absolute; top: -10000px;"),document.body&&document.body.appendChild(n));return n},p=1,q="SvgT";function a(a){var e=a.fontSize,f=a.setGhlRandomizers;a=a.text;var g=m(0),h=g[0],i=g[1];g=m(0);var n=g[0],r=g[1],s=c("useStable")(function(){return d("GHLGating").getWidthRandomizerInPx()});g=c("useStable")(function(){return q+p++});var t=c("useStable")(function(){return q+p++}),u=l(null);k(function(){var a;a=(a=u.current)==null?void 0:a.getBoundingClientRect();(a==null?void 0:a.height)!=null&&(a==null?void 0:a.width)!=null&&(i(a.height),r(a.width),f&&f({display:"inline-block",marginRight:-s+"px",width:a.width+s+"px"}))},[e,f,a,s]);var v=n+s,w=d("GHLGating").getSvgTextRandomElementWrapper()?j.jsx(c("GHLRandomElementWrapper"),{elementTag:d("GHLGating").getSvgTextRandomElementWrapperWc()?"randomSpan":d("GHLGating").getSvgTextRandomElementWrapperDiv()?"div":"span",children:j.jsx(c("GHLSVGElementContainer.react"),{domID:g,fontSize:e,height:h,randomizedWidth:v,width:n})}):j.jsx(c("GHLSVGElementContainer.react"),{domID:g,fontSize:e,height:h,randomizedWidth:v,width:n});h=d("GHLSVGTextUtils").getFixedFontSize(h);var x=h[0];h=h[1];var y=""+(d("GHLMitigationsGating").getIsGHLSVGExtraLayerEnabled()?t:g);e={fill:"currentColor",fontSize:(e=e)!=null?e:x,overflow:"visible"};x={x:d("GHLSVGTextUtils").anyMarginLeftStylingEnabled&&!d("GHLSVGTextUtils").anyMarginRightStylingEnabled?v-n:void 0,y:h};return j.jsxs(j.Fragment,{children:[j.jsxs(c("BasePortal.react"),{target:o(),children:[d("GHLMitigationsGating").getIsGHLSVGExtraLayerEnabled()&&j.jsx("svg",{id:g,children:j.jsx("use",{xlinkHref:"#"+t,xmlnsXlink:"http://www.w3.org/1999/xlink"})}),j.jsx("svg",{style:{overflow:"visible"},children:d("GHLMitigationsGating").getIsGHLSVGTextUseTspanEnabled()&&b("cr:6269")?j.jsx(b("cr:6269"),{originalText:a,textElementID:y,textRef:u,textStyle:e,xPosition:x.x,yPosition:x.y}):j.jsx("text",{id:y,ref:u,style:e,x:x.x,y:x.y,children:a})})]}),w]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("IGDSMetaGenAiPanoFilled24Icon.react",["IGDSSVGIconBase.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(3),d;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d=j.jsx("path",{d:"m15.795 5.206 1.897.854c.11.05.199.138.248.248l.854 1.897a.5.5 0 0 0 .912 0l.854-1.897a.494.494 0 0 1 .248-.248l1.897-.854a.5.5 0 0 0 0-.912l-1.897-.854a.494.494 0 0 1-.248-.248l-.854-1.897a.5.5 0 0 0-.912 0l-.853 1.896a.5.5 0 0 1-.25.25l-1.896.853a.5.5 0 0 0 0 .912Zm7.643 5.596a1.504 1.504 0 0 0-1.644-1.34 1.5 1.5 0 0 0-1.34 1.644A8.8 8.8 0 0 1 20.5 12c0 4.687-3.813 8.5-8.5 8.5S3.5 16.687 3.5 12 7.313 3.5 12 3.5c.302 0 .6.016.895.046a1.5 1.5 0 0 0 .304-2.984C12.805.522 12.405.5 12 .5 5.66.5.5 5.66.5 12S5.66 23.5 12 23.5 23.5 18.34 23.5 12c0-.405-.021-.805-.062-1.198Z"}),b[0]=d):d=b[0];b[1]!==a?(d=j.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:d})),b[1]=a,b[2]=d):d=b[2];return d}b=j.memo(a);g["default"]=b}),98);
__d("IGDSVolumeNonePanoFilledIcon.react",["IGDSSVGIconBase.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(3),d;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d=j.jsx("path",{d:"M11.403 1.083a1.001 1.001 0 0 0-1.082.187L5.265 6H2a1 1 0 0 0-1 1v10.003a1 1 0 0 0 1 1h3.265l5.01 4.682.02.021a1 1 0 0 0 1.704-.814L12.005 2a1 1 0 0 0-.602-.917ZM20.704 12l1.94-1.94a1.5 1.5 0 0 0-2.122-2.12l-1.939 1.939-1.94-1.94a1.5 1.5 0 1 0-2.12 2.122L16.461 12l-1.94 1.94a1.5 1.5 0 1 0 2.122 2.12l1.939-1.939 1.94 1.94a1.5 1.5 0 0 0 2.12-2.122Z"}),b[0]=d):d=b[0];b[1]!==a?(d=j.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:d})),b[1]=a,b[2]=d):d=b[2];return d}b=j.memo(a);g["default"]=b}),98);
__d("IGDSVolumeOffFilledIcon.react",["IGDSSVGIconBase.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(3),d;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d=j.jsx("path",{clipRule:"evenodd",d:"M1.5 13.3c-.8 0-1.5.7-1.5 1.5v18.4c0 .8.7 1.5 1.5 1.5h8.7l12.9 12.9c.9.9 2.5.3 2.5-1v-9.8c0-.4-.2-.8-.4-1.1l-22-22c-.3-.3-.7-.4-1.1-.4h-.6zm46.8 31.4-5.5-5.5C44.9 36.6 48 31.4 48 24c0-11.4-7.2-17.4-7.2-17.4-.6-.6-1.6-.6-2.2 0L37.2 8c-.6.6-.6 1.6 0 2.2 0 0 5.7 5 5.7 13.8 0 5.4-2.1 9.3-3.8 11.6L35.5 32c1.1-1.7 2.3-4.4 2.3-8 0-6.8-4.1-10.3-4.1-10.3-.6-.6-1.6-.6-2.2 0l-1.4 1.4c-.6.6-.6 1.6 0 2.2 0 0 2.6 2 2.6 6.7 0 1.8-.4 3.2-.9 4.3L25.5 22V1.4c0-1.3-1.6-1.9-2.5-1L13.5 10 3.3-.3c-.6-.6-1.5-.6-2.1 0L-.2 1.1c-.6.6-.6 1.5 0 2.1L4 7.6l26.8 26.8 13.9 13.9c.6.6 1.5.6 2.1 0l1.4-1.4c.7-.6.7-1.6.1-2.2z",fillRule:"evenodd"}),b[0]=d):d=b[0];b[1]!==a?(d=j.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 48 48",children:d})),b[1]=a,b[2]=d):d=b[2];return d}b=j.memo(a);g["default"]=b}),98);
__d("IGDSVolumePanoFilledIcon.react",["IGDSSVGIconBase.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(3),d;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d=j.jsx("path",{d:"M16.636 7.028a1.5 1.5 0 1 0-2.395 1.807 5.365 5.365 0 0 1 1.103 3.17 5.378 5.378 0 0 1-1.105 3.176 1.5 1.5 0 1 0 2.395 1.806 8.396 8.396 0 0 0 1.71-4.981 8.39 8.39 0 0 0-1.708-4.978Zm3.73-2.332A1.5 1.5 0 1 0 18.04 6.59 8.823 8.823 0 0 1 20 12.007a8.798 8.798 0 0 1-1.96 5.415 1.5 1.5 0 0 0 2.326 1.894 11.672 11.672 0 0 0 2.635-7.31 11.682 11.682 0 0 0-2.635-7.31Zm-8.963-3.613a1.001 1.001 0 0 0-1.082.187L5.265 6H2a1 1 0 0 0-1 1v10.003a1 1 0 0 0 1 1h3.265l5.01 4.682.02.021a1 1 0 0 0 1.704-.814L12.005 2a1 1 0 0 0-.602-.917Z"}),b[0]=d):d=b[0];b[1]!==a?(d=j.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:d})),b[1]=a,b[2]=d):d=b[2];return d}b=j.memo(a);g["default"]=b}),98);
__d("IGDSecureShareSheetHeader.react",["IGDSBox.react","IGDSDialogHeader.react","IGDSIconButton.react","IGDSText.react","IGDSXFilledIcon.react","PolarisDirectStrings","PolarisGenericStrings","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(5);a=a.onCloseClick;var e;b[0]!==a?(e=a?j.jsx(c("IGDSBox.react"),{padding:4,children:j.jsx(c("IGDSIconButton.react"),{onClick:a,children:j.jsx(c("IGDSXFilledIcon.react"),{alt:d("PolarisGenericStrings").CLOSE_TEXT,size:18})})}):void 0,b[0]=a,b[1]=e):e=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("IGDSText.react").LabelEmphasized,{children:d("PolarisDirectStrings").SHARE_TITLE}),b[2]=a):a=b[2];b[3]!==e?(a=j.jsx(c("IGDSDialogHeader.react"),{endAdornment:e,truncateText:!0,children:a}),b[3]=e,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("IGDSecureShareSheetDialogPlaceholder.react",["IGDSBox.react","IGDSDialogPlaceholder.react","IGDSListItemPlaceholder.react","IGDSecureShareSheetHeader.react","react","useMatchMedia"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k={dialogContainer:{display:"x78zum5",flexDirection:"xdt5ytf",$$css:!0}};function a(a){var b=i(5);a=a.onClose;var d=c("useMatchMedia")("(max-width: 736px)");d=d?"fullscreen":"large";var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("IGDSecureShareSheetHeader.react"),{}),b[0]=e):e=b[0];var f;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(f=j.jsx(c("IGDSBox.react"),{marginTop:4,children:Array(3).fill(null).map(l)}),b[1]=f):f=b[1];b[2]!==a||b[3]!==d?(e=j.jsxs(c("IGDSDialogPlaceholder.react"),{fixedHeight:!0,fixedWidth:!0,innerContentXStyle:k.dialogContainer,onClose:a,size:d,children:[e,f]}),b[2]=a,b[3]=d,b[4]=e):e=b[4];return e}function l(a,b){return j.jsx(c("IGDSListItemPlaceholder.react"),{color:"elevatedHighlightBackground",fullWidth:!0,index:b,paddingX:6,paddingY:2,size:"medium"},"igd_secure_sharesheet_dialog_placeholder_"+b)}l.displayName=l.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("InstagramAdActionMenuFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("3374");b=d("FalcoLoggerInternal").create("instagram_ad_action_menu",a);e=b;g["default"]=e}),98);
__d("InstagramMediaMetricsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2312");b=d("FalcoLoggerInternal").create("instagram_media_metrics",a);e=b;g["default"]=e}),98);
__d("InstagramOrganicCarouselImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4535");b=d("FalcoLoggerInternal").create("instagram_organic_carousel_impression",a);e=b;g["default"]=e}),98);
__d("InstagramOrganicImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1115");b=d("FalcoLoggerInternal").create("instagram_organic_impression",a);e=b;g["default"]=e}),98);
__d("InstagramUpcomingEventActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2258");b=d("FalcoLoggerInternal").create("instagram_upcoming_event_action",a);e=b;g["default"]=e}),98);
__d("PolarisAPISetUpcomingEventReminder",["PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return c?d("PolarisInstapi").apiPost("/api/v1/upcoming_events/set_reminder/{event_id}/",{body:{media_pk:b},path:{event_id:a}}):d("PolarisInstapi").apiPost("/api/v1/upcoming_events/unset_reminder/{event_id}/",{path:{event_id:a}})}g.setUpcomingEventReminder=a}),98);
__d("PolarisAdBlockerMitigationGatingHelpers",["gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("25304")&&c("justknobx")._("931")}function b(){return c("justknobx")._("1118")}g.shouldUseSVGTextMitigation=a;g.shouldUseRandomElementWrapper=b}),98);
__d("PolarisAppAttributionText.react",["fbt","IGDSExternalLinkPanoOutline24Icon.react","IGDSText.react","PolarisFastLink.react","PolarisLinkBuilder","PolarisViewpointReact.react","polarisLogAction","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useMemo;var k=b.useRef,l=b.c,m=h._("__JHASH__mrLy4FGHzkL__JHASH__");function a(a){var b=l(13),e=a.appId,f=a.appName,g=a.mediaId;a=a.showIcon;var h=a===void 0?!1:a,i=k(!1);b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=[function(a){a.percentVisible>=1&&!i.current&&(c("polarisLogAction")("thirdPartyAppAttributionImpression"),i.current=!0)}],b[0]=a):a=b[0];a=a;a=a;var o;b[1]!==e||b[2]!==g?(o=d("PolarisLinkBuilder").buildClipsAppPageLink(e,g),b[1]=e,b[2]=g,b[3]=o):o=b[3];b[4]!==h||b[5]!==f?(g=function(a){return j.jsxs("div",{className:"x6s0dn4 x78zum5 x1q0g3np",ref:a,children:[h===!0&&j.jsx("div",{className:"xw3qccf",children:j.jsx(c("IGDSExternalLinkPanoOutline24Icon.react"),{alt:m,size:12})}),j.jsx(c("IGDSText.react").Body2,{breakWord:!0,zeroMargin:!0,children:j.jsx("div",{className:"x1lliihq x6ikm8r x10wlt62 xlyipyv xuxw1ft","data-testid":void 0,children:j.jsx("span",{children:f})})})]})},b[4]=h,b[5]=f,b[6]=g):g=b[6];b[7]!==e||b[8]!==g?(a=j.jsx(d("PolarisViewpointReact.react").Viewpoint,{action:a,id:e,children:g}),b[7]=e,b[8]=g,b[9]=a):a=b[9];b[10]!==o||b[11]!==a?(e=j.jsx(c("PolarisFastLink.react"),{href:o,onClick:n,children:a}),b[10]=o,b[11]=a,b[12]=e):e=b[12];return e}function n(){c("polarisLogAction")("thirdPartyAppAttributionClick")}g["default"]=a}),226);
__d("PolarisPostContextFragment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostContextFragment",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalContext_media"}],type:"XDTMediaDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostContextFragment_ad.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostContextFragment_ad",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalContext_ad"}],type:"XDTAdInsertionItemClientDict",abstractKey:null};e.exports=a}),null);
__d("PolarisLoadingSheet.react",["IGDSBox.react","IGDSSpinner.react","PolarisIGCoreSheetOrModal","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(){var a=i(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{children:j.jsx(c("IGDSBox.react"),{alignItems:"center",paddingY:8,position:"relative",children:j.jsx(c("IGDSSpinner.react"),{})})}),a[0]=b):b=a[0];return b}g["default"]=a}),98);
__d("PolarisPostModalContextImpl_ad.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalContextImpl_ad",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalEntrypointLazy_ad"}],type:"XDTAdInsertionItemClientDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalContextImpl_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalContextImpl_media",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalEntrypointLazy_media"}],type:"XDTMediaDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalEntrypointLazyComponent_ad.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalEntrypointLazyComponent_ad",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostFastOptionsModal_ad"}],type:"XDTAdInsertionItemClientDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalEntrypointLazyComponent_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalEntrypointLazyComponent_media",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostFastAboutThisAccountModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastAdDebugToolModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastAdRemovedModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastAllowCommentsModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastCopyModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastDeleteModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastEmbedModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastGenAITransparencyModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastGenAITransparencyZeroClickModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastHideAdModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastOptionsModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastReportModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastReportAdModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastShareSheet_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastTaggedModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastTagOptionsModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastUnfollowModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastViewAccountModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastWAISTModal_media"}],type:"XDTMediaDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalEntrypointLazy_ad.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalEntrypointLazy_ad",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalEntrypointLazyComponent_ad"}],type:"XDTAdInsertionItemClientDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalEntrypointLazy_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalEntrypointLazy_media",selections:[{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"pk",storageKey:null},action:"THROW",path:"pk"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastAboutThisAccountModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastAllowCommentsModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostModalEntrypointLazyComponent_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastCopyModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastDeleteModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastEmbedModal_media"},{args:null,kind:"FragmentSpread",name:"PolarisPostFastOptionsModal_media"}],type:"XDTMediaDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalEntrypointLazy.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","FBLogger","IGRouter_DO_NOT_USE.react","JSResourceForInteraction","PolarisPostModalEntrypointLazyComponent_ad.graphql","PolarisPostModalEntrypointLazyComponent_media.graphql","PolarisPostModalEntrypointLazy_ad.graphql","PolarisPostModalEntrypointLazy_media.graphql","hero-tracing","lazyLoadComponent","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=(l||(l=d("react"))).c,n=l;e=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAboutThisAccountModal.react").__setRef("PolarisPostModalEntrypointLazy.react"));f=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAboutThisAccountModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react"));var o=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAllowCommentsModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),p=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAdRemovalErrorModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),q=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAdRemovedModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),r=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAdRemovedModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),s=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastCopyModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),t=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastCopyModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),u=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastDeleteModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),v=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastDeleteModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),w=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastEmbedModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),x=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastEmbedModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),y=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFavoritesModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),z=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastHideAdModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),A=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastHideAdModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),B=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastLoadingModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),C=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastOptionsModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),D=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastOptionsModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),E=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastReportModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),F=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastReportModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),G=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastReportAdModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),H=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastReportAdModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),I=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastShareSheet.react").__setRef("PolarisPostModalEntrypointLazy.react")),J=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastShareSheet.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),K=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastTaggedModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),L=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastTaggedModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),M=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastTagOptionsModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),N=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastTagOptionsModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),O=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastUnfollowModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),P=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastUnfollowModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),Q=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastViewAccountModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),R=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastViewAccountModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),S=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAdDebugToolModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),T=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastAdDebugToolModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),U=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastWAISTModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),V=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastWAISTModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),W=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastGenAITransparencyModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),X=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastGenAITransparencyModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),Y=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastGenAITransparencyModal.react").__setRef("PolarisPostModalEntrypointLazy.react")),Z=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisPostFastGenAITransparencyZeroClickModal.next.react").__setRef("PolarisPostModalEntrypointLazy.react")),$=new Map([["aboutThisAccount",e],["copy",s],["delete",u],["embed",w],["genAITransparency",W],["genAITransparencyZeroClick",Y],["hideAd",z],["options",C],["removeAd",q],["report",E],["reportAd",G],["share",I],["tagged",K],["tagOptions",M],["unfollow",O],["viewAccount",Q],["viewAdDebugTool",S],["whyAmISeeingThisAd",U]]),aa=new Map([["aboutThisAccount",f],["allowComments",o],["copy",t],["delete",v],["embed",x],["genAITransparency",X],["genAITransparencyZeroClick",Z],["hideAd",A],["removeAd",r],["report",F],["reportAd",H],["share",J],["tagged",L],["tagOptions",N],["unfollow",P],["viewAccount",R],["viewAdDebugTool",T],["whyAmISeeingThisAd",V]]),ba=new Map([["favorites",y],["loading",B],["removeAdError",p]]),ca=new Map([["optionsV2",D]]);function a(a){var e,f=m(14),g=a.ad,j=a.interactionUUID,k=a.media,l=a.location,o=a.onClose,p=a.openModal;a=a.post;k=d("CometRelay").useFragment(h!==void 0?h:h=b("PolarisPostModalEntrypointLazy_media.graphql"),k);g=d("CometRelay").useFragment(i!==void 0?i:i=b("PolarisPostModalEntrypointLazy_ad.graphql"),g);e=(e=k==null?void 0:k.pk)!=null?e:a==null?void 0:a.id;if(e==null)throw c("FBLogger")("instagram_web").mustfixThrow("Both media fragment and post cannot be null");var q="PostModalEntrypoint: Open "+p+" Modal";e=p+"-"+e;var r;f[0]!==g||f[1]!==l||f[2]!==k||f[3]!==o||f[4]!==p||f[5]!==a?(r=n.jsx(c("CometPlaceholder.react"),{fallback:null,children:n.jsx(da,{ad:g,location:l,media:k,onClose:o,openModal:p,post:a})}),f[0]=g,f[1]=l,f[2]=k,f[3]=o,f[4]=p,f[5]=a,f[6]=r):r=f[6];f[7]!==e||f[8]!==r?(g=n.jsx(c("CometErrorBoundary.react"),{children:r},e),f[7]=e,f[8]=r,f[9]=g):g=f[9];f[10]!==q||f[11]!==j||f[12]!==g?(l=n.jsx(d("hero-tracing").HeroInteraction,{interactionDesc:q,interactionUUID:j,children:g}),f[10]=q,f[11]=j,f[12]=g,f[13]=l):l=f[13];return l}function da(a){var e=m(25),f=a.ad,g=a.media,h=a.location,i=a.onClose,l=a.openModal;a=a.post;f=d("CometRelay").useFragment(j!==void 0?j:j=b("PolarisPostModalEntrypointLazyComponent_ad.graphql"),f);g=d("CometRelay").useFragment(k!==void 0?k:k=b("PolarisPostModalEntrypointLazyComponent_media.graphql"),g);var o;e[0]!==l?(o=ba.get(l),e[0]=l,e[1]=o):o=e[1];o=o;if(o){var p;e[2]!==o||e[3]!==i?(p=n.jsx(o,{onClose:i}),e[2]=o,e[3]=i,e[4]=p):p=e[4];return p}e[5]!==l?(o=aa.get(l),e[5]=l,e[6]=o):o=e[6];p=o;if(p&&g){e[7]!==p||e[8]!==g||e[9]!==i?(o=n.jsx(p,{media:g,onClose:i}),e[7]=p,e[8]=g,e[9]=i,e[10]=o):o=e[10];return o}e[11]!==l?(p=ca.get(l),e[11]=l,e[12]=p):p=e[12];o=p;if(o&&g){e[13]!==o||e[14]!==f||e[15]!==g||e[16]!==i?(p=n.jsx(o,{ad:f,media:g,onClose:i}),e[13]=o,e[14]=f,e[15]=g,e[16]=i,e[17]=p):p=e[17];return p}e[18]!==l?(o=$.get(l),e[18]=l,e[19]=o):o=e[19];f=o;if(!f||a==null)throw c("FBLogger")("instagram_web").mustfixThrow('Failed to find a modal for "%s"',l);e[20]!==f||e[21]!==h||e[22]!==i||e[23]!==a?(g=n.jsx(f,{location:h,onClose:i,post:a}),e[20]=f,e[21]=h,e[22]=i,e[23]=a,e[24]=g):g=e[24];return g}e=d("IGRouter_DO_NOT_USE.react").withIGRouter(a);g["default"]=e}),98);
__d("PolarisPostModalContext.react",["CometPlaceholder.react","CometRelay","InteractionTracing","PolarisLoadingModal.react","PolarisLoadingSheet.react","PolarisPostModalContextImpl_ad.graphql","PolarisPostModalContextImpl_media.graphql","PolarisPostModalEntrypointLazy.react","PolarisUA","emptyFunction","qpl","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||(j=d("react")),l=j,m=l.createContext,n=l.useContext;l.useMemo;var o=l.useState,p=l.c;function q(a){if(d("PolarisUA").isMobile())return null;switch(a){case"share":return k.jsx(c("PolarisLoadingSheet.react"),{});default:return k.jsx(c("PolarisLoadingModal.react"),{})}}var r=m({openModal:null,setOpenModal:null});function a(a){var e=p(13),f=a.ad,g=a.children,j=a.media;a=a.post;f=d("CometRelay").useFragment(h!==void 0?h:h=b("PolarisPostModalContextImpl_ad.graphql"),f);j=d("CometRelay").useFragment(i!==void 0?i:i=b("PolarisPostModalContextImpl_media.graphql"),j);var l=o(null),m=l[0],s=l[1];l=o(null);var t=l[0],u=l[1];e[0]===Symbol["for"]("react.memo_cache_sentinel")?(l=function(a){a!=null&&s(c("InteractionTracing").startInteraction({interactionClass:"fluid",qplEvent:c("qpl")._(27465367,"758"),tracePolicy:"polaris.post_fast."+a.toLowerCase(),traceType:"INTERACTION"})),u(a)},e[0]=l):l=e[0];var v=l;e[1]!==t?(l={openModal:t,setOpenModal:v},e[1]=t,e[2]=l):l=e[2];l=l;l=l;var w=!!n(r).setOpenModal;if(w)return g;e[3]!==t||e[4]!==f||e[5]!==m||e[6]!==j||e[7]!==a?(w=t&&k.jsx(c("CometPlaceholder.react"),{fallback:q(t),children:k.jsx(c("PolarisPostModalEntrypointLazy.react"),{ad:f,interactionUUID:m,media:j,onClose:function(){return v(null)},openModal:t,post:a})}),e[3]=t,e[4]=f,e[5]=m,e[6]=j,e[7]=a,e[8]=w):w=e[8];e[9]!==l||e[10]!==g||e[11]!==w?(t=k.jsxs(r.Provider,{value:l,children:[g,w]}),e[9]=l,e[10]=g,e[11]=w,e[12]=t):t=e[12];return t}function e(){return n(r).setOpenModal||c("emptyFunction")}function f(){return n(r).openModal}g.PostModalContext=a;g.useSetPostModal=e;g.useCurrentlyOpenModal=f}),98);
__d("PolarisPostModalContext_ad.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalContext_ad",selections:[{args:null,kind:"FragmentSpread",name:"PolarisPostModalContextImpl_ad"}],type:"XDTAdInsertionItemClientDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalContext_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisPostModalContext_media",selections:[{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"pk",storageKey:null},action:"THROW",path:"pk"},{args:null,kind:"FragmentSpread",name:"PolarisPostModalContextImpl_media"}],type:"XDTMediaDict",abstractKey:null};e.exports=a}),null);
__d("PolarisPostModalContext.next.react",["CometRelay","PolarisPostModalContext.react","PolarisPostModalContext_ad.graphql","PolarisPostModalContext_media.graphql","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(j||(j=d("react"))).c,l=j;function a(a){var c=k(4),e=a.ad,f=a.children;a=a.queryReference;e=d("CometRelay").useFragment(h!==void 0?h:h=b("PolarisPostModalContext_ad.graphql"),e);a=d("CometRelay").useFragment(i!==void 0?i:i=b("PolarisPostModalContext_media.graphql"),a);var g;c[0]!==e||c[1]!==a||c[2]!==f?(g=l.jsx(d("PolarisPostModalContext.react").PostModalContext,{ad:e,media:a,children:f},a.pk),c[0]=e,c[1]=a,c[2]=f,c[3]=g):g=c[3];return g}g["default"]=a}),98);
__d("usePolarisIsOnPostPage",["useCurrentRouteEntityKey"],(function(a,b,c,d,e,f,g){"use strict";var h="post";function a(){var a=c("useCurrentRouteEntityKey")();a=a==null?void 0:a.entity_type;return a===h}g["default"]=a}),98);
__d("PolarisPostContext.react",["CometRelay","PolarisPostContextFragment.graphql","PolarisPostContextFragment_ad.graphql","PolarisPostModalContext.next.react","PolarisUA","react","usePolarisIsOnFeedPage","usePolarisIsOnPostPage"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||(j=d("react"));e=j;e.useMemo;var l=e.useState,m=e.c,n=k.createContext({analyticsContext:"postPage",availableAudioTracks:[],controller:null,setAvailableAudioTracks:function(a){},setController:function(a){},setTargetAudioTrack:function(a){},shouldCapHeight:!0,targetAudioTrack:null});function a(a){var e=m(18),f=a.ad,g=a.analyticsContext,j=a.children,o=a.currentSidecarIndex;a=a.queryReference;f=d("CometRelay").useFragment(h!==void 0?h:h=b("PolarisPostContextFragment_ad.graphql"),f);a=d("CometRelay").useFragment(i!==void 0?i:i=b("PolarisPostContextFragment.graphql"),a);var p=c("usePolarisIsOnFeedPage")(),q=c("usePolarisIsOnPostPage")(),r;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];r=l(r);var s=r[0];r=r[1];var t=l(null),u=t[0];t=t[1];var v=l(null),w=v[0];v=v[1];var x;e[1]!==p||e[2]!==q?(x=p||q&&d("PolarisUA").isMobile(),e[1]=p,e[2]=q,e[3]=x):x=e[3];e[4]!==g||e[5]!==s||e[6]!==w||e[7]!==o||e[8]!==x||e[9]!==u?(p={analyticsContext:g,availableAudioTracks:s,controller:w,currentSidecarIndex:o,setAvailableAudioTracks:r,setController:v,setTargetAudioTrack:t,shouldCapHeight:x,targetAudioTrack:u},e[4]=g,e[5]=s,e[6]=w,e[7]=o,e[8]=x,e[9]=u,e[10]=p):p=e[10];q=p;r=q;e[11]!==f||e[12]!==a||e[13]!==j?(v=k.jsx(c("PolarisPostModalContext.next.react"),{ad:f,queryReference:a,children:j}),e[11]=f,e[12]=a,e[13]=j,e[14]=v):v=e[14];e[15]!==r||e[16]!==v?(t=k.jsx(n.Provider,{value:r,children:v}),e[15]=r,e[16]=v,e[17]=t):t=e[17];return t}g.PolarisPostContext=n;g.PolarisPostContextProvider=a}),98);
__d("PolarisAudioAttributionText.react",["fbt","IGDSMetaGenAiPanoFilled24Icon.react","IGDSMiddleDot.react","IGDSText.react","JSResourceForInteraction","PolarisClipsConstants","PolarisClipsHelpers","PolarisFastLink.react","PolarisIGCorePressable.react","PolarisLinkBuilder","PolarisPostContext.react","gkx","react","useCometLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useEffect,m=c("JSResourceForInteraction")("PolarisVideoVariantSelector.react").__setRef("PolarisAudioAttributionText.react");function a(a){var b=a.audioArtist,e=a.audioID,f=a.audioName,g=a.isMediaOwnerOriginalSound,i=a.isMutedAudio,n=a.isOverMedia;n=n===void 0?!1:n;var o=a.isOwnerPrivate,p=a.muteAudioReason,q=a.onDisabledClipsAudioAttributionClick;a=k(d("PolarisPostContext.react").PolarisPostContext);var r=a.availableAudioTracks,s=a.controller,t=a.targetAudioTrack,u=c("gkx")("2602")&&r.some(function(a){return a.lang!==null&&a.role==="dub"})&&s!=null;a=c("useCometLazyDialog")(m);var v=a[0],w=a[1];l(function(){u&&w()},[v,w,u]);if(!d("PolarisClipsHelpers").hasAudioAttributionText({audioArtist:b,audioName:f,isMediaOwnerOriginalSound:g}))return null;if(u&&s!=null){a=h._("__JHASH__e0zGfKpE6GF__JHASH__");a=j.jsxs("div",{style:{alignItems:"center",display:"flex"},children:[g===!0?j.jsx("div",{style:{paddingRight:6},children:j.jsx(c("IGDSMetaGenAiPanoFilled24Icon.react"),{alt:a,size:12})}):null,j.jsx(c("IGDSText.react").Body2,{color:n?"textOnMedia":"primaryText",children:g===!0?j.jsx("span",{children:a}):j.jsxs("span",{children:[b,j.jsx(c("IGDSMiddleDot.react"),{color:n?"textOnMedia":"primaryText"}),a]})})]});var x=function(){v({availableAudioTracks:r,controller:s,targetAudioTrack:t})};return j.jsx(c("PolarisIGCorePressable.react"),{onPress:x,children:a})}x=j.jsx(c("IGDSText.react").Body2,{color:n?"textOnMedia":"primaryText",zeroMargin:!0,children:j.jsx("div",{className:"x78zum5 xh8yej3","data-testid":void 0,children:g===!0?j.jsx("span",{className:"x6ikm8r x10wlt62 xlyipyv xuxw1ft",children:f}):j.jsxs("span",{className:"x6ikm8r x10wlt62 xlyipyv xuxw1ft",children:[b,j.jsx(c("IGDSMiddleDot.react"),{color:n?"textOnMedia":"primaryText"}),f]})})});var y=g===!0&&o===!0;a=function(){q&&q(y?d("PolarisClipsConstants").AUDIO_PAGE_DOES_NOT_EXIST_PRIVATE_USER:String(p))};return e!=null&&c("gkx")("3610")?y||i?j.jsx(c("PolarisIGCorePressable.react"),{onPress:a,children:x}):j.jsx(c("PolarisFastLink.react"),{className:"xh8yej3",href:d("PolarisLinkBuilder").buildClipsAudioPageLink(e),children:x}):x}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("PolarisBoostCanSkipPro2ProQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="6844670978909501"}),null);
__d("PolarisBoostCanSkipPro2ProQuery.graphql",["PolarisBoostCanSkipPro2ProQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"entrypoint"},c={defaultValue:null,kind:"LocalArgument",name:"platform"},d=[{kind:"Variable",name:"entrypoint",variableName:"entrypoint"},{kind:"Variable",name:"platform",variableName:"platform"}],e={alias:null,args:null,kind:"ScalarField",name:"can_user_skip_pro_identity_setup",storageKey:null};return{fragment:{argumentDefinitions:[a,c],kind:"Fragment",metadata:null,name:"PolarisBoostCanSkipPro2ProQuery",selections:[{alias:null,args:d,concreteType:"IGProfessionalIdentityCacheGQL",kind:"LinkedField",name:"ig_professional_cache",plural:!1,selections:[e],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,a],kind:"Operation",name:"PolarisBoostCanSkipPro2ProQuery",selections:[{alias:null,args:d,concreteType:"IGProfessionalIdentityCacheGQL",kind:"LinkedField",name:"ig_professional_cache",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:b("PolarisBoostCanSkipPro2ProQuery_instagramRelayOperation"),metadata:{},name:"PolarisBoostCanSkipPro2ProQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PolarisBoostCanSkipPro2Pro",["CometRelay","PolarisBoostCanSkipPro2ProQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("PolarisBoostCanSkipPro2ProQuery.graphql");function a(a,b,c){return d("CometRelay").fetchQuery(a,i,{entrypoint:b,platform:"WEB"},{fetchPolicy:"network-only"}).toPromise().then(function(a){a=(a=a==null?void 0:(a=a.ig_professional_cache)==null?void 0:a.can_user_skip_pro_identity_setup)!=null?a:!1;c.logIpiCacheEvent(a?"client_should_skip_boost_onboarding":"client_should_not_skip_boost_onboarding_on_cache_fetch_success");return a})["catch"](function(a){c.logIpiCacheEvent("client_should_not_skip_boost_onboarding_on_cache_fetch_failure",a.message);return!1})}g.getCanSkipPro2Pro=a}),98);
__d("PolarisBoostOkDialog.react",["fbt","IGCoreDialog.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(7),c=a.body,e=a.onPress;a=a.title;var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._("__JHASH__A3AENjyzsZ1__JHASH__"),b[0]=f):f=b[0];b[1]!==e?(f=k.jsx(d("IGCoreDialog.react").IGCoreDialogItem,{children:f,color:"ig-error-or-destructive",onClick:e}),b[1]=e,b[2]=f):f=b[2];b[3]!==c||b[4]!==a||b[5]!==f?(e=k.jsx(d("IGCoreDialog.react").IGCoreDialog,{body:c,title:a,children:f}),b[3]=c,b[4]=a,b[5]=f,b[6]=e):e=b[6];return e}g["default"]=a}),226);
__d("PolarisBoostQPLUtils",["QPLJoinUtils","QuickPerformanceLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=c("qpl")._(467537745,"2144");(h||(h=c("QuickPerformanceLogger"))).markerStart(b);d("QPLJoinUtils").setJoinId(h,b,a)}function b(a){var b=c("qpl")._(467537745,"2144");(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(b,{});h.markerEnd(b,2);d("QPLJoinUtils").setJoinId(h,b,a)}g.markBoostEnterFlowStart=a;g.markBoostEnterFlowEnd=b}),98);
__d("PolarisClickEventLoggerProvider.react",["InstagramMediaMetricsFalcoEvent","InstagramWebAdEventsAuditFalcoEvent","PolarisClickEventLoggerContext.react","PolarisContainerModuleUtils","justknobx","polarisOnlyHandleSingleClick","react","usePolarisAnalyticsContext","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.c,k=d("polarisOnlyHandleSingleClick").onlyHandleSingleClick(function(a,b,c,d,e,f){l(a,b,c,d,e,f)});function l(a,b,d,e,f,g){var h={dest_uri:a,event_trace_id:(a=e)!=null?a:c("uuidv4")(),gesture_type:f,pigeon_reserved_keyword_module:g,tracking:d,tracking_nodes:b};if(c("justknobx")._("1564")){e=b.some(function(a){return a.type===10||a.type===69});if(e&&d.length>0&&d[0]!=null){var i=JSON.parse(d[0]);c("InstagramWebAdEventsAuditFalcoEvent").log(function(){return{client_token:i.tracking_token,event:"media_metrics_profile"}})}}c("InstagramMediaMetricsFalcoEvent").logImmediately(function(){return h})}function a(a){var b=j(8),e=a.children;a=a.ignoreDoubleClick;var f=a===void 0?!1:a;a=c("usePolarisAnalyticsContext")();var g;b[0]!==a?(g=d("PolarisContainerModuleUtils").getContainerModule(a),b[0]=a,b[1]=g):g=b[1];var h=g;b[2]!==f||b[3]!==h?(a=function(a,b,c,d,e){f?k(a,b,c,d,e,h):l(a,b,c,d,e,h)},b[2]=f,b[3]=h,b[4]=a):a=b[4];g=a;b[5]!==g||b[6]!==e?(a=i.jsx(c("PolarisClickEventLoggerContext.react").Provider,{value:g,children:e}),b[5]=g,b[6]=e,b[7]=a):a=b[7];return a}g["default"]=a}),98);
__d("PolarisStoriesStrings",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";f=h._("__JHASH___j-DprdudOH__JHASH__");var i=h._("__JHASH___ztvnt9tTxg__JHASH__"),j=h._("__JHASH__8DAexP_HOx0__JHASH__");function a(a){return h._("__JHASH__8rWCPZozAZA__JHASH__",[h._param("story viewer username",a)])}function b(a){return h._("__JHASH__dKUhJZCDnYl__JHASH__",[h._param("story owner username",a)])}var k=h._("__JHASH__BpPRLSL4Bpb__JHASH__"),l=h._("__JHASH__dCJnEZ5Vr6J__JHASH__"),m=h._("__JHASH__lNOnxnFpKxw__JHASH__");function c(a){return h._("__JHASH__XmQtBTlfipU__JHASH__",[h._param("story owner username",a)])}function d(a){return h._("__JHASH__LhZDUxXvBgd__JHASH__",[h._param("story owner username",a)])}var n=h._("__JHASH__7ts6Xi8PVlb__JHASH__"),o=h._("__JHASH__XPEpRY13fLK__JHASH__");function e(a){return h._("__JHASH__3Jw1BgpFmKY__JHASH__",[h._param("story owner username",a)])}var p=h._("__JHASH__v5WZAKW-Me8__JHASH__"),q=h._("__JHASH__8ZZ20CthyT___JHASH__");g.YOUR_STORY_TEXT=f;g.STORIES_TEXT=i;g.TAP_TO_PLAY_TEXT=j;g.viewStoryTitleText=a;g.viewStorySubtitleText=b;g.VIEW_STORY=k;g.CLOSE_FRIENDS=l;g.CLOSE_FRIENDS_ONLY=m;g.CLOSE_FRIENDS_INFO_PHOTO=c;g.CLOSE_FRIENDS_INFO_VIDEO=d;g.EXCLUSIVE_STORY=n;g.EXCLUSIVE_STORY_ONLY=o;g.EXCLUSIVE_STORY_INFO=e;g.ALT_TEXT_CLOSE_ICON=p;g.STORY_EXPIRED_TEXT=q}),226);
__d("PolarisCloseFriendsLabel.react",["IGDSBox.react","IGDSStarPanoFilledIcon.react","IGDSText.react","PolarisIGCoreButton.react","PolarisStoriesStrings","PolarisWebStorage","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useRef,l=b.useState,m=b.c,n="close_friends_expanded_count";function a(a){var b=m(22),e=a.onClick;a=a.textSize;a=a===void 0?"small":a;var f;if(b[0]===Symbol["for"]("react.memo_cache_sentinel")){var g;f=c("PolarisWebStorage").getLocalStorage();g=parseInt((g=(g=f)==null?void 0:g.getItem(n))!=null?g:0,10);b[0]=g;b[1]=f}else g=b[0],f=b[1];var h=g;g=l(!1);var o=g[0],p=g[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=function(){return h<3},b[2]=g):g=b[2];g=l(g);var q=g[0],r=g[1],s=k(null);b[3]===Symbol["for"]("react.memo_cache_sentinel")?(g=function(){p(!0),r(!0),window.clearTimeout(s.current)},b[3]=g):g=b[3];g=g;var t;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(t=function(){p(!1)},b[4]=t):t=b[4];t=t;var u,v;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(u=function(){var a,b=h+1;(a=f)==null?void 0:a.setItem(n,String(b))},v=[h,f],b[5]=u,b[6]=v):(u=b[5],v=b[6]);j(u,v);b[7]!==o?(u=function(){s.current=window.setTimeout(function(){o||r(!1)},1500)},v=[o],b[7]=o,b[8]=u,b[9]=v):(u=b[8],v=b[9]);j(u,v);b[10]!==a?(u=a==="small"?i.jsx(c("IGDSText.react").Body2Emphasized,{color:"webAlwaysWhite",maxLines:1,children:d("PolarisStoriesStrings").CLOSE_FRIENDS}):i.jsx(c("IGDSText.react").BodyEmphasized,{color:"webAlwaysWhite",maxLines:1,children:d("PolarisStoriesStrings").CLOSE_FRIENDS}),b[10]=a,b[11]=u):u=b[11];v=u;b[12]===Symbol["for"]("react.memo_cache_sentinel")?(a="x1wyv8x2 x1lcm9me x1yr5g0i xrt01vj x10y3i5r",b[12]=a):a=b[12];b[13]===Symbol["for"]("react.memo_cache_sentinel")?(u=i.jsx(c("IGDSStarPanoFilledIcon.react"),{alt:"Close Friends Icon",color:"web-always-white",size:12}),b[13]=u):u=b[13];var w;b[14]!==q||b[15]!==v?(w=q&&i.jsx("span",{className:"x12mruv9",children:v}),b[14]=q,b[15]=v,b[16]=w):w=b[16];b[17]!==w?(q=i.jsx("div",{className:a,children:i.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",height:"100%",paddingX:2,paddingY:2,position:"relative",width:"100%",children:[u,w]})}),b[17]=w,b[18]=q):q=b[18];b[19]!==e||b[20]!==q?(v=i.jsx("div",{onMouseEnter:g,onMouseLeave:t,children:i.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:e,children:q})}),b[19]=e,b[20]=q,b[21]=v):v=b[21];return v}g["default"]=a}),98);
__d("PolarisCoauthorSheet.react",["IGDSBox.react","IGDSListItem.react","IGDSText.react","IGDSVerifiedBadge.react","PolarisFastLink.react","PolarisFollowButtonContainer.react","PolarisIGCoreConstants","PolarisIGCoreSheetOrModal","PolarisLinkBuilder","PolarisUA","PolarisUserAvatar.react","nullthrows","polarisLogAction","qex","react","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){var b=i(4);a=a.user;var d;b[0]!==a.relationship||b[1]!==a.id||b[2]!==a.username?(d=j.jsx(c("PolarisFollowButtonContainer.react"),{analyticsContext:"UNKNOWN__POLARIS_USER_BUTTON_SECTION",borderless:!1,isFollowing:a.relationship,isInline:!0,userId:a.id,username:a.username,useSmallText:!1}),b[0]=a.relationship,b[1]=a.id,b[2]=a.username,b[3]=d):d=b[3];return d}function l(a){var b=i(9);a=a.user;var d=a.isVerified;a=a.username;if(a===void 0)return null;var e;b[0]!==a?(e=j.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:a}),b[0]=a,b[1]=e):e=b[1];b[2]!==d?(a=d&&j.jsx(c("IGDSVerifiedBadge.react"),{size:"small"}),b[2]=d,b[3]=a):a=b[3];b[4]!==a?(d=j.jsx(c("IGDSBox.react"),{marginStart:2,children:a}),b[4]=a,b[5]=d):d=b[5];b[6]!==e||b[7]!==d?(a=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:[e,d]}),b[6]=e,b[7]=d,b[8]=a):a=b[8];return a}function m(a){var b=i(2);a=a.user;a=a.fullName;if(a==null)return null;var d;b[0]!==a?(d=j.jsx(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:j.jsx(c("IGDSText.react").Body,{color:"secondaryText",zeroMargin:!0,children:a})}),b[0]=a,b[1]=d):d=b[1];return d}function n(a){var b,e=i(28),f=a.onClick;a=a.user;var g=a.profilePictureUrl,h=a.username;b=((b=c("usePolarisViewer")())==null?void 0:b.id)===a.id;var n;e[0]!==b||e[1]!==a?(n=!b&&c("qex")._("384")?j.jsx(k,{user:a}):null,e[0]=b,e[1]=a,e[2]=n):n=e[2];e[3]!==g||e[4]!==h?(b=j.jsx(c("PolarisUserAvatar.react"),{isLink:!0,profilePictureUrl:g,size:c("PolarisIGCoreConstants").AVATAR_SIZES.medium,username:h}),e[3]=g,e[4]=h,e[5]=b):b=e[5];e[6]!==f?(g=function(){f()},e[6]=f,e[7]=g):g=e[7];var o;e[8]!==h?(o=d("PolarisLinkBuilder").buildUserLink(h),e[8]=h,e[9]=o):o=e[9];var p;e[10]!==a?(p=j.jsx(m,{user:a}),e[10]=a,e[11]=p):p=e[11];var q;e[12]!==o||e[13]!==p?(q=j.jsx(c("PolarisFastLink.react"),{href:o,children:p}),e[12]=o,e[13]=p,e[14]=q):q=e[14];e[15]!==h?(o=d("PolarisLinkBuilder").buildUserLink(h),e[15]=h,e[16]=o):o=e[16];e[17]!==a?(p=j.jsx(l,{user:a}),e[17]=a,e[18]=p):p=e[18];e[19]!==o||e[20]!==p?(h=j.jsx(c("PolarisFastLink.react"),{href:o,children:p}),e[19]=o,e[20]=p,e[21]=h):h=e[21];e[22]!==n||e[23]!==b||e[24]!==g||e[25]!==q||e[26]!==h?(a=j.jsx(c("IGDSListItem.react"),{addOnEnd:n,addOnStart:b,onPress:g,subtitle:q,testid:void 0,title:h}),e[22]=n,e[23]=b,e[24]=g,e[25]=q,e[26]=h,e[27]=a):a=e[27];return a}function o(a){var b=i(6),d=a.coauthors,e=a.mediaId;a=a.mediaOwner;var f;b[0]!==e?(f=function(){c("polarisLogAction")("coauthorSheetItemClick",{mediaId:e,source:"CoauthorSheetItems"})},b[0]=e,b[1]=f):f=b[1];var g=f;if(b[2]!==d||b[3]!==a||b[4]!==g){f=[].concat(d);f.unshift(a);f=f.map(function(a){a=c("nullthrows")(a);a=a.user;return j.jsx(n,{onClick:g,user:a},a.id)});b[2]=d;b[3]=a;b[4]=g;b[5]=f}else f=b[5];return f}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.componentDidMount=function(){c("polarisLogAction")("coauthorSheetImpression",{mediaId:this.props.mediaId,numCoauthors:this.props.coauthors.length,source:"CoauthorSheet"})};e.render=function(){var a=this.props,b=a.coauthors,e=a.mediaId,f=a.mediaOwner,g=a.onClose;a=a.title;return j.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{onClose:g,title:a,children:j.jsx(c("IGDSBox.react"),{flex:"grow",marginBottom:d("PolarisUA").isMobile()?6:void 0,overflow:"auto",children:j.jsx(o,{coauthors:b,mediaId:e,mediaOwner:f})})})};return b}(j.PureComponent);g.Username=l;g.CoauthorSheetItem=n;g.CoauthorSheetItems=o;g.CoauthorSheet=a}),98);
__d("PolarisCoauthorCountWithSheet.react",["fbt","IGDSText.react","PolarisCoauthorSheet.react","PolarisFastLink.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._("__JHASH__knipFRoxAOv__JHASH__");function l(a){return h._("__JHASH__gVvWvw7eP27__JHASH__",[h._param("num_coauthors",a)])}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={isCoauthorSheetOpen:!1},c.$1=function(){c.props.onClick!=null&&c.props.onClick(),c.props.disableSheet!==!0&&c.setState({isCoauthorSheetOpen:!0})},c.$2=function(){c.setState({isCoauthorSheetOpen:!1})},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.render=function(){return j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisFastLink.react"),{onClick:this.$1,children:j.jsx(c("IGDSText.react").BodyEmphasized,{color:"primaryText",children:l(this.props.coauthors.length)})}),this.state.isCoauthorSheetOpen&&j.jsx(d("PolarisCoauthorSheet.react").CoauthorSheet,{coauthors:this.props.coauthors,mediaId:this.props.mediaId,mediaOwner:this.props.mediaOwner,onClose:this.$2,title:k})]})};return b}(j.PureComponent);g["default"]=a}),226);
__d("PolarisCoauthorUtils.react",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("156")===!0}g.isCoauthorAcceptanceEnabled=a}),98);
__d("PolarisCommentButton.react",["fbt","IGDSCommentPanoOutlineIcon.react","IGDSIconButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=h._("__JHASH__DRKjP2-nYQr__JHASH__");function a(a){var b=j(10),d=a.className,e=a["data-testid"],f=a.onClick;b[0]!==f?(a=function(a){a.preventDefault(),f(a)},b[0]=f,b[1]=a):a=b[1];a=a;var g;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("IGDSCommentPanoOutlineIcon.react"),{alt:l,color:"ig-secondary-text",size:24}),b[2]=g):g=b[2];var h;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("IGDSCommentPanoOutlineIcon.react"),{alt:l,color:"ig-primary-text",size:24}),b[3]=h):h=b[3];b[4]!==a?(g=k.jsx(c("IGDSIconButton.react"),{hover:g,onClick:a,children:h}),b[4]=a,b[5]=g):g=b[5];b[6]!==d||b[7]!==e||b[8]!==g?(h=k.jsx("span",{className:d,"data-testid":void 0,children:g}),b[6]=d,b[7]=e,b[8]=g,b[9]=h):h=b[9];return h}g["default"]=a}),226);
__d("PolarisEligibleForCommissionUnit.react",["fbt","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=(j||(j=d("react"))).c,l=j,m={root:{color:"x5n08af",fontSize:"x1pg5gke",lineHeight:"x152skdk",overflowX:"x6ikm8r",overflowY:"x10wlt62",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0}};function a(a){var b=k(5);a=a.xstyle;var d;b[0]!==a?(d=(i||(i=c("stylex")))(m.root,a),b[0]=a,b[1]=d):d=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._("__JHASH__uyE_M_Juw1O__JHASH__"),b[2]=a):a=b[2];b[3]!==d?(a=l.jsx("span",{className:d,children:a}),b[3]=d,b[4]=a):a=b[4];return a}g["default"]=a}),226);
__d("PolarisFacepile.next.react",["CometErrorBoundary.react","CometPressable.react","IGDSBox.react","IGDSConstants","Locale","PolarisUserAvatar.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k={avatar:{boxSizing:"x1afcbsf",$$css:!0},avatarContainer:{alignItems:"x6s0dn4",borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",display:"x78zum5",justifyContent:"xl56j7k",$$css:!0},opaqueBorder:{borderTopColor:"x1yhmmig",borderEndColor:"xeqyd3i",borderBottomColor:"xyb01ml",borderStartColor:"xdn568n",borderTopStyle:"x13fuv20",borderEndStyle:"xu3j5b3",borderBottomStyle:"x1q0q8m5",borderStartStyle:"x26u7qi",borderTopWidth:"xamhcws",borderEndWidth:"xol2nv",borderBottomWidth:"xlxy82",borderStartWidth:"x19p7ews",$$css:!0},overlapRight:{marginEnd:"x6zhf5e",$$css:!0},transparentBorder:{backgroundColor:"x1k74hu9",borderTopColor:"x1v8p93f",borderEndColor:"xogb00i",borderBottomColor:"x16stqrj",borderStartColor:"x1ftr3km",borderTopStyle:"x13fuv20",borderEndStyle:"xu3j5b3",borderBottomStyle:"x1q0q8m5",borderStartStyle:"x26u7qi",borderTopWidth:"xamhcws",borderEndWidth:"xol2nv",borderBottomWidth:"xlxy82",borderStartWidth:"x19p7ews",$$css:!0}};function a(a){var b=i(12),d=a.avatarSize,e=a.border,f=a.onClick,g=a.userProfilePicUrls;a=d===void 0?"extraSmall":d;var h=e===void 0?"opaque":e;if(g.length===0)return null;var l=c("IGDSConstants").AVATAR_SIZES[a];if(b[0]!==g||b[1]!==l||b[2]!==f||b[3]!==h){b[5]!==l||b[6]!==g.length||b[7]!==f||b[8]!==h?(d=function(a,b){var d={height:l+"px",order:String(c("Locale").isRTL()?b+1:g.length-(b+1)),width:l+"px"};return j.jsx(c("CometPressable.react"),{onPress:f,style:d,xstyle:[k.avatarContainer,b>0&&k.overlapRight],children:j.jsx(c("CometErrorBoundary.react"),{fallback:function(a){return null},children:j.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:a,size:l,xstyle:[k.avatar,h==="opaque"&&k.opaqueBorder,h==="transparent"&&k.transparentBorder]})})},a)},b[5]=l,b[6]=g.length,b[7]=f,b[8]=h,b[9]=d):d=b[9];e=[].concat(g).reverse().map(d);b[0]=g;b[1]=l;b[2]=f;b[3]=h;b[4]=e}else e=b[4];b[10]!==e?(a=j.jsx(c("IGDSBox.react"),{alignItems:"center",direction:"row",justifyContent:"end",children:e}),b[10]=e,b[11]=a):a=b[11];return a}g["default"]=a}),98);
__d("PolarisFeedCardProvider.react",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.useState,k=b.c,l=i.createContext({isCaptionMoreClicked:!1,isCarouselCardVisible:!1,isMediaRendered:null,setIsCaptionMoreClicked:c("emptyFunction"),setIsCarouselCardVisible:c("emptyFunction"),setIsMediaRendered:null});function a(a){var b=k(7);a=a.children;var c=j(null),d=c[0];c=c[1];var e=j(!1),f=e[0];e=e[1];var g=j(!0),h=g[0];g=g[1];b[0]!==f||b[1]!==h||b[2]!==d?(e={isCaptionMoreClicked:f,isCarouselCardVisible:h,isMediaRendered:d,setIsCaptionMoreClicked:e,setIsCarouselCardVisible:g,setIsMediaRendered:c},b[0]=f,b[1]=h,b[2]=d,b[3]=e):e=b[3];g=e;c=g;b[4]!==c||b[5]!==a?(f=i.jsx(l.Provider,{value:c,children:a}),b[4]=c,b[5]=a,b[6]=f):f=b[6];return f}g.PolarisFeedCardContext=l;g.PolarisFeedCardProvider=a}),98);
__d("PolarisFeedLikeHeart.react",["PolarisInteractionsStrings","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(){var a=i(2),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx("title",{children:d("PolarisInteractionsStrings").LIKE_TEXT}),a[0]=b):b=a[0];a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsxs("svg",{"aria-label":d("PolarisInteractionsStrings").LIKE_TEXT,viewBox:"0 0 48 48",width:128,children:[b,j.jsx("defs",{children:j.jsxs("linearGradient",{gradientTransform:"rotate(35)",id:"ig_heart_gradient",children:[j.jsx("stop",{offset:"0%",stopColor:"#FF7A00"}),j.jsx("stop",{offset:"40%",stopColor:"#FF0169"}),j.jsx("stop",{offset:"100%",stopColor:"#D300C5"})]})}),j.jsx("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z",fill:"url(#ig_heart_gradient)"})]}),a[1]=b):b=a[1];return b}g["default"]=a}),98);
__d("PolarisInformTreatmentBanner.react",["fbt","IGDSBox.react","IGDSChevronIcon.react","IGDSInfoOutlineIcon.react","IGDSText.react","PolarisExternalLink.react","PolarisGenericStrings","PolarisIGCoreButton.react","isStringNullOrEmpty","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l={reel:{backgroundColor:"x68m4m9",$$css:!0},story:{backgroundColor:"x68m4m9",bottom:"x1ey2m1c",end:"xds687c",left:null,right:null,start:"x17qophe",position:"x10l6tqk",$$css:!0},storyBottomMargin:{marginBottom:"xrqrgcu",$$css:!0}},m=16,n=20;function a(a){var b=j(45),e=a.analyticsContext,f=a.externalURL,g=a.isStory,i=a.onClick,o=a.secondaryText,p=a.text;a=a.viewerIsOwner;var q=e==="reelsTab",r=q||g,s;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(s=h._("__JHASH__Mxa_PN2OIt9__JHASH__"),b[0]=s):s=b[0];var t=r?n:m,u;b[1]!==r?(u=r&&{color:"web-always-white"},b[1]=r,b[2]=u):u=b[2];b[3]!==t||b[4]!==u?(s=k.jsx(c("IGDSBox.react"),{"data-testid":void 0,flex:"none",marginEnd:3,position:"relative",children:k.jsx(c("IGDSInfoOutlineIcon.react"),babelHelpers["extends"]({alt:s,size:t},u))}),b[3]=t,b[4]=u,b[5]=s):s=b[5];t=s;u=g?n:m;b[6]!==r?(s=r&&{color:"ig-secondary-icon"},b[6]=r,b[7]=s):s=b[7];var v;b[8]!==u||b[9]!==s?(v=k.jsx(c("IGDSChevronIcon.react"),babelHelpers["extends"]({alt:d("PolarisGenericStrings").RIGHT_CHEVRON,"data-testid":void 0,direction:"next",size:u},s)),b[8]=u,b[9]=s,b[10]=v):v=b[10];u=v;s=null;if(!c("isStringNullOrEmpty")(o)){b[11]!==o?(v=k.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:k.jsx(c("IGDSText.react"),{color:"secondaryText",textAlign:"start",children:o})}),b[11]=o,b[12]=v):v=b[12];s=v}b[13]!==g?(o=!g&&{color:"primaryBackground"},b[13]=g,b[14]=o):o=b[14];v=e==="selfProfilePageModal"?2:3;b[15]!==g||b[16]!==a||b[17]!==q?(e=g?[l.story,a!=null&&!a&&l.storyBottomMargin]:q&&l.reel,b[15]=g,b[16]=a,b[17]=q,b[18]=e):e=b[18];b[19]!==r?(g=r&&{color:"webAlwaysWhite"},b[19]=r,b[20]=g):g=b[20];b[21]!==g||b[22]!==p?(a=k.jsx(c("IGDSText.react").BodyEmphasized,babelHelpers["extends"]({textAlign:"start",zeroMargin:!0},g,{children:p})),b[21]=g,b[22]=p,b[23]=a):a=b[23];b[24]!==a||b[25]!==s?(q=k.jsxs(c("IGDSBox.react"),{flex:"grow",margin:1,position:"relative",children:[a,s]}),b[24]=a,b[25]=s,b[26]=q):q=b[26];b[27]!==o||b[28]!==v||b[29]!==e||b[30]!==t||b[31]!==q||b[32]!==u?(r=k.jsxs(c("IGDSBox.react"),babelHelpers["extends"]({alignItems:"center"},o,{direction:"row",padding:v,position:"relative",width:"100%",xstyle:e,children:[t,q,u]})),b[27]=o,b[28]=v,b[29]=e,b[30]=t,b[31]=q,b[32]=u,b[33]=r):r=b[33];g=r;if(f!=null){b[34]!==f||b[35]!==i||b[36]!==g?(p=k.jsx(c("PolarisExternalLink.react"),{href:f,onClick:i,children:g}),b[34]=f,b[35]=i,b[36]=g,b[37]=p):p=b[37];g=p}else if(i!=null){b[38]!==i?(a=function(){return i()},b[38]=i,b[39]=a):a=b[39];b[40]!==a||b[41]!==g?(s=k.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:a,children:g}),b[40]=a,b[41]=g,b[42]=s):s=b[42];g=s}b[43]!==g?(o=k.jsx(c("IGDSBox.react"),{children:g}),b[43]=g,b[44]=o):o=b[44];v=o;return v}g["default"]=a}),226);
__d("PolarisInsightsUtils",["PolarisBoostedStatusEnum","polarisGetPostFromGraphMediaInterface"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a!==c("PolarisBoostedStatusEnum").NOT_BOOSTED&&a!==c("PolarisBoostedStatusEnum").UNAVAILABLE?!0:!1}function i(a){return a!=null?{bloksAppId:h(a)?"com.instagram.insights.media_refresh.clips.ad_bottom_sheet.action":"com.instagram.insights.media_refresh.clips.bottom_sheet.action",hasViewInsights:!0}:{bloksAppId:"",hasViewInsights:!1}}function j(a){return a!=null?{bloksAppId:h(a)?"com.instagram.insights.media_refresh.videos.ad_bottom_sheet.action":"com.instagram.insights.media_refresh.videos.bottom_sheet.action",hasViewInsights:!0}:{bloksAppId:"com.instagram.insights.media.videos.bottom_sheet.action",hasViewInsights:!1}}function k(a){return a!=null?{bloksAppId:h(a)?"com.instagram.insights.media_refresh.posts.ad_bottom_sheet.action":"com.instagram.insights.media_refresh.posts.bottom_sheet.action",hasViewInsights:!0}:{bloksAppId:"com.instagram.insights.media.posts.bottom_sheet.action",hasViewInsights:!0}}function l(a){return a!=null?{bloksAppId:h(a)?"com.instagram.insights.media_refresh.stories.ad_bottom_sheet.action":"com.instagram.insights.media_refresh.stories.bottom_sheet.action",hasViewInsights:!0}:{bloksAppId:"com.instagram.insights.media.stories.bottom_sheet.action",hasViewInsights:!0}}function a(a,b,c,d,e){if(a==null||b==null||c==null)return{bloksAppId:"",hasViewInsights:!1};return a.id===b&&e||d?m(c.productType,c.boostedStatus):{bloksAppId:"",hasViewInsights:!1}}function m(a,b){if(d("polarisGetPostFromGraphMediaInterface").isClipsProductType(a))return i(b);if(a===d("polarisGetPostFromGraphMediaInterface").PRODUCT_TYPE_IGTV)return j(b);return a===d("polarisGetPostFromGraphMediaInterface").PRODUCT_TYPE_STORY?l(b):k(b)}g.showAdInsightsForMedia=h;g.getViewInsightsForClip=i;g.getViewInsightsForIGTV=j;g.getViewInsightsForPost=k;g.getViewInsightsForStory=l;g.getViewInsightsInfo=a;g.getViewInsightsInfoForMedia=m}),98);
__d("PolarisInvitedCoauthorsSheet.react",["IGDSBox.react","IGDSListItem.react","IGDSText.react","IGDSVerifiedBadge.react","PolarisFastLink.react","PolarisIGCoreConstants","PolarisIGCoreSheetOrModal","PolarisLinkBuilder","PolarisUA","PolarisUserAvatar.react","nullthrows","polarisLogAction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){var b=i(9);a=a.user;var d=a.isVerified;a=a.username;if(a===void 0)return null;var e;b[0]!==a?(e=j.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:a}),b[0]=a,b[1]=e):e=b[1];b[2]!==d?(a=d&&j.jsx(c("IGDSVerifiedBadge.react"),{size:"small"}),b[2]=d,b[3]=a):a=b[3];b[4]!==a?(d=j.jsx(c("IGDSBox.react"),{marginStart:2,children:a}),b[4]=a,b[5]=d):d=b[5];b[6]!==e||b[7]!==d?(a=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:[e,d]}),b[6]=e,b[7]=d,b[8]=a):a=b[8];return a}function l(a){var b=i(2);a=a.user;a=a.fullName;if(a==null)return null;var d;b[0]!==a?(d=j.jsx(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:j.jsx(c("IGDSText.react").Body,{color:"secondaryText",zeroMargin:!0,children:a})}),b[0]=a,b[1]=d):d=b[1];return d}function m(a){var b=i(29),e=a.onClick;a=a.user;var f=a.profilePictureUrl,g=a.username,h;b[0]!==f||b[1]!==g?(h=j.jsx(c("PolarisUserAvatar.react"),{isLink:!0,profilePictureUrl:f,size:c("PolarisIGCoreConstants").AVATAR_SIZES.medium,username:g}),b[0]=f,b[1]=g,b[2]=h):h=b[2];b[3]!==g?(f=d("PolarisLinkBuilder").buildUserLink(g),b[3]=g,b[4]=f):f=b[4];var m;b[5]!==f?(m={url:f},b[5]=f,b[6]=m):m=b[6];b[7]!==e?(f=function(){e()},b[7]=e,b[8]=f):f=b[8];var n;b[9]!==g?(n=d("PolarisLinkBuilder").buildUserLink(g),b[9]=g,b[10]=n):n=b[10];var o;b[11]!==a?(o=j.jsx(l,{user:a}),b[11]=a,b[12]=o):o=b[12];var p;b[13]!==n||b[14]!==o?(p=j.jsx(c("PolarisFastLink.react"),{href:n,children:o}),b[13]=n,b[14]=o,b[15]=p):p=b[15];b[16]!==g?(n=d("PolarisLinkBuilder").buildUserLink(g),b[16]=g,b[17]=n):n=b[17];b[18]!==a?(o=j.jsx(k,{user:a}),b[18]=a,b[19]=o):o=b[19];b[20]!==n||b[21]!==o?(g=j.jsx(c("PolarisFastLink.react"),{href:n,children:o}),b[20]=n,b[21]=o,b[22]=g):g=b[22];b[23]!==h||b[24]!==m||b[25]!==f||b[26]!==p||b[27]!==g?(a=j.jsx(c("IGDSListItem.react"),{addOnStart:h,linkProps:m,onPress:f,subtitle:p,title:g}),b[23]=h,b[24]=m,b[25]=f,b[26]=p,b[27]=g,b[28]=a):a=b[28];return a}function n(a){var b=i(5),d=a.invitedCoauthors,e=a.mediaId;b[0]!==e?(a=function(){c("polarisLogAction")("invitedCoauthorsSheetItemClick",{mediaId:e,source:"InvitedCoauthorsSheetItems"})},b[0]=e,b[1]=a):a=b[1];var f=a;if(b[2]!==d||b[3]!==f){a=[].concat(d);a=a.map(function(a){a=c("nullthrows")(a);a=a.user;return j.jsx(m,{onClick:f,user:a},a.id)});b[2]=d;b[3]=f;b[4]=a}else a=b[4];return a}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.componentDidMount=function(){c("polarisLogAction")("invitedCoauthorsSheetImpression",{mediaId:this.props.mediaId,numCoauthors:this.props.invitedCoauthors.length,source:"InvitedCoauthorsSheet"})};e.render=function(){var a=this.props,b=a.invitedCoauthors,e=a.mediaId,f=a.onClose;a=a.title;return j.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{onClose:f,title:a,children:j.jsx(c("IGDSBox.react"),{flex:"grow",marginBottom:d("PolarisUA").isMobile()?6:void 0,overflow:"auto",children:j.jsx(n,{invitedCoauthors:b,mediaId:e})})})};return b}(j.PureComponent);g.Username=k;g.InvitedCoauthorsSheetItem=m;g.InvitedCoauthorsSheetItems=n;g.InvitedCoauthorsSheet=a}),98);
__d("PolarisInvitedCoauthorsCountWithSheet.react",["fbt","IGDSText.react","PolarisFastLink.react","PolarisInvitedCoauthorsSheet.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._("__JHASH__wNd7B5voz_d__JHASH__");function l(a){return h._("__JHASH__jbBHibgQP0s__JHASH__",[h._param("num_coauthors",a)])}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={isCoauthorSheetOpen:!1},c.$1=function(){c.props.onClick!=null&&c.props.onClick(),c.props.disableSheet!==!0&&c.setState({isCoauthorSheetOpen:!0})},c.$2=function(){c.setState({isCoauthorSheetOpen:!1})},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.render=function(){return j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisFastLink.react"),{onClick:this.$1,children:j.jsx(c("IGDSText.react").BodyEmphasized,{color:"primaryText",children:l(this.props.coauthors.length-1)})}),this.state.isCoauthorSheetOpen&&j.jsx(d("PolarisInvitedCoauthorsSheet.react").InvitedCoauthorsSheet,{invitedCoauthors:this.props.coauthors,mediaId:this.props.mediaId,onClose:this.$2,title:k})]})};return b}(j.PureComponent);g["default"]=a}),226);
__d("PolarisIsLoggedInDesktop",["PolarisConfig","PolarisUA"],(function(a,b,c,d,e,f,g){"use strict";function a(){return!d("PolarisUA").isMobile()&&d("PolarisConfig").isLoggedIn()}g.isLoggedInDesktop=a}),98);
__d("PolarisLikeAnimation.react",["cx","PolarisFeedLikeHeart.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=30,m=-30;function a(a){var b=j(1);a=a.likeEventCount;var d=Math.floor(Math.random()*(l-m+1))+m;if(a>0){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",{className:"_aa7p",children:k.jsx("span",{className:"x1q3qbx4 xqz12i x4hg4is x972fbf xcfux6l x1qhh985 xm0m39n xln7xf2 xk390pu xdj266r xkrivgy xat24cr x1gryazu xg01cxk xexx8yu x4uap5 x18d9i69 xkhd6sd x47corl x1f85oc2 x11njtxf x1q1rmc8",style:{"--random-rotation-deg":d+"deg"},children:k.jsx(c("PolarisFeedLikeHeart.react"),{})})}),b[0]=a):a=b[0];return a}return null}g["default"]=a}),98);
__d("PolarisLikeButton.react",["invariant","IGDSHeartFilledIcon.react","IGDSHeartPanoOutlineIcon.react","IGDSIconButton.react","PolarisInteractionsStrings","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l={animation:{animationDuration:"x1ykxiw6",animationName:"x1ahuga",animationTimingFunction:"x4hg4is",transform:"x3oybdh",$$css:!0}};function m(a){var b=a.color;b=b===void 0?"ig-primary-icon":b;var e=a.handleClick,f=a.isHovered,g=a.isLiked,h=a.likeChangeCount,j=a.padding,m=a.setIsHovered,n=a.shadow;n=n===void 0?!1:n;a=a.size;return k.jsx(c("IGDSIconButton.react"),{hover:g?null:k.jsx(c("IGDSHeartPanoOutlineIcon.react"),{alt:d("PolarisInteractionsStrings").LIKE_TEXT,color:b==="ig-secondary-icon"?"ig-stroke":"ig-secondary-icon",shadow:n,size:a}),onClick:e,padding:j,children:k.jsx("span",{className:(i||(i=c("stylex")))(h>0&&l.animation),onMouseEnter:function(){m!=null&&m(!0)},onMouseLeave:function(){m!=null&&m(!1)},children:g?k.jsx(c("IGDSHeartFilledIcon.react"),{alt:d("PolarisInteractionsStrings").UNLIKE_TEXT,color:"ig-badge",shadow:n,size:a}):k.jsx(c("IGDSHeartPanoOutlineIcon.react"),{alt:d("PolarisInteractionsStrings").LIKE_TEXT,color:f===!0?"ig-secondary-icon":b,shadow:n,size:a})},h)})}m.displayName=m.name+" [from "+f.id+"]";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={likeChangeCount:-1,prevIsLiked:null},c.$2=function(a){a.preventDefault(),c.props.onChange(!c.props.isLiked)},b)||babelHelpers.assertThisInitialized(c)}b.getDerivedStateFromProps=function(a,b){return a.isLiked!==b.prevIsLiked?{likeChangeCount:b.likeChangeCount+1,prevIsLiked:a.isLiked}:null};var c=b.prototype;c.focus=function(){this.$1||h(0,51544),this.$1.focus()};c.render=function(){var a=this.props,b=a.className,c=a.color,d=a["data-testid"];d=a.isHovered;var e=a.isLiked,f=a.padding;f=f===void 0?8:f;var g=a.setIsHovered,h=a.shadow;a=a.size;a=a===void 0?24:a;return k.jsx("span",{className:b,"data-testid":void 0,onMouseEnter:function(){g!=null&&g(!0)},onMouseLeave:function(){g!=null&&g(!1)},children:k.jsx("div",{className:"x1ypdohk",children:k.jsx(m,{color:c,handleClick:this.$2,isHovered:d,isLiked:e,likeChangeCount:this.state.likeChangeCount,padding:(b=f)!=null?b:0,shadow:h,size:a})})})};return b}(k.Component);g["default"]=a}),98);
__d("PolarisLikedByListActions",["FBLogger","PolarisInstapi","PolarisRelationshipActionGetRelationshipInfoForUserIds","PolarisUserModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return{searchInput:b,shortcode:a,type:"LIKED_BY_LIST_SEARCH_INPUT_SET"}}function e(a){return function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){try{e=(yield d("PolarisInstapi").apiGet("/api/v1/media/{media_id}/likers/",{path:{media_id:a}}));e=(e=(e=e.data.users)==null?void 0:e.map(function(a){return c("PolarisUserModel").fromNativeResponse(a).toReduxStore()}))!=null?e:[];var f=e.map(function(a){return a.id});yield b(d("PolarisRelationshipActionGetRelationshipInfoForUserIds").getRelationshipInfoForUserIds(f));b({mediaId:a,type:"LIKED_BY_LIST_NATIVE_REQUEST_UPDATED",users:e})}catch(a){c("FBLogger")("ig_web").catching(a)}});return function(a,b){return e.apply(this,arguments)}}()}g.setSearchInput=a;g.requestNativeLikedByList=e}),98);
__d("PolarisLikedByListButton.react",["IGDSText.react","PolarisFastLink.react","PolarisUA","react","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(10),e=a.children,f=a.code,g=a.inModal;a=a.onClick;var h=c("usePolarisViewer")();f="/p/"+f+"/liked_by/";var k;b[0]!==h||b[1]!==g?(k=!h&&g!==!0||d("PolarisUA").isDesktop(),b[0]=h,b[1]=g,b[2]=k):k=b[2];b[3]!==e?(h=j.jsx(c("IGDSText.react"),{weight:"semibold",zeroMargin:!0,children:e}),b[3]=e,b[4]=h):h=b[4];b[5]!==f||b[6]!==a||b[7]!==k||b[8]!==h?(g=j.jsx(c("PolarisFastLink.react"),{href:f,onClick:a,shouldOpenModal:k,children:h}),b[5]=f,b[6]=a,b[7]=k,b[8]=h,b[9]=g):g=b[9];return g}g["default"]=a}),98);
__d("PolarisLikedByText.react",["fbt","IGDSButton.react","IGDSText.react","PolarisBigNumber.react","PolarisFastLink.react","PolarisLikedByListButton.react","PolarisLinkBuilder","PolarisPostUtils","PolarisUserLink.react","PolarisUserLinkWithHoverCard.react","nullthrows","polarisLogAction","react","useCurrentRoute","usePolarisViewer"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function l(a){var b=j(5);a=a.user;var d=a.id,e;b[0]!==a.username?(e=c("nullthrows")(a.username),b[0]=a.username,b[1]=e):e=b[1];b[2]!==a.id||b[3]!==e?(d=k.jsx(c("PolarisUserLinkWithHoverCard.react"),{userId:d,username:e}),b[2]=a.id,b[3]=e,b[4]=d):d=b[4];return d}var m=function(){c("polarisLogAction")("likeCountClick")};function a(a){var b=j(61),e=a.code,f=a.hideCounts,g=a.inModal,i=a.onClick,n=a.onLike,o=a.topLikers,p=a.totalCount;a=a.users;var q=c("usePolarisViewer")(),r=c("useCurrentRoute")();r=r==null?void 0:r.url;var s;b[0]!==a||b[1]!==q?(s=d("PolarisPostUtils").getOrderedUsersForLikedByList(a,q),b[0]=a,b[1]=q,b[2]=s):s=b[2];s=s;if(p===1){var t;b[3]!==p?(t=h._("__JHASH__zesVpNWdLc7__JHASH__",[h._param("count",p)]),b[3]=p,b[4]=t):t=b[4];t=t}else if(f){var u;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(u=h._("__JHASH__NVsWra1TrS4__JHASH__"),b[5]=u):u=b[5];t=u}else{b[6]!==p?(u=h._("__JHASH__yx6RcYfWPfd__JHASH__",[h._param("count",k.jsx(c("PolarisBigNumber.react"),{value:p}))]),b[6]=p,b[7]=u):u=b[7];t=u}u=p!==0&&a.length===0&&!f;if(u){b[8]!==e||b[9]!==g||b[10]!==i||b[11]!==t?(a=k.jsx(c("PolarisLikedByListButton.react"),{code:e,inModal:g,onClick:i,children:t}),b[8]=e,b[9]=g,b[10]=i,b[11]=t,b[12]=a):a=b[12];return a}else if(p===0){if(q){b[13]!==n?(u=h._("__JHASH__zPcIHFAljfW__JHASH__",[h._param("like this",k.jsx(c("IGDSButton.react"),{display:"block",label:h._("__JHASH__W_f8r2RdLZ8__JHASH__"),onClick:n,variant:"secondary_link"}))]),b[13]=n,b[14]=u):u=b[14];return u}b[15]!==r?(a=d("PolarisLinkBuilder").buildLoginLink(r,{source:"post_likers"}),b[15]=r,b[16]=a):a=b[16];b[17]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._("__JHASH__rkOqXU3D6LE__JHASH__"),b[17]=q):q=b[17];b[18]!==a?(n=k.jsx(c("PolarisFastLink.react"),{href:a,children:q}),b[18]=a,b[19]=n):n=b[19];u=n;b[20]!==u?(r=h._("__JHASH__VVvwm-KPzHp__JHASH__",[h._param("Log in",u)]),b[20]=u,b[21]=r):r=b[21];return r}else if(p===1&&f){if(o!=null&&o.length===1){q=o[0];b[22]!==q?(a=k.jsx(c("IGDSText.react"),{weight:"semibold",children:q}),b[22]=q,b[23]=a):a=b[23];b[24]!==q||b[25]!==a?(n=k.jsx(c("PolarisUserLink.react"),{color:"ig-primary-text",username:q,children:a}),b[24]=q,b[25]=a,b[26]=n):n=b[26];u=n;b[27]!==u?(r=h._("__JHASH__q4wDyrHVOdd__JHASH__",[h._param("username",u)]),b[27]=u,b[28]=r):r=b[28];return r}else if(s.length===1){b[29]!==s?(q=h._("__JHASH__q4wDyrHVOdd__JHASH__",[h._param("username",k.jsx(l,{user:s[0]}))]),b[29]=s,b[30]=q):q=b[30];return q}}else if((s.length>=1||f&&o!=null&&o.length>=1)&&(p>=2||p===-1)){if(f)if(s.length===2&&p===2){a=s[0];b[31]!==a?(n=k.jsx(l,{user:a}),b[31]=a,b[32]=n):n=b[32];u=n;r=s[1];b[33]!==r?(q=k.jsx(l,{user:r}),b[33]=r,b[34]=q):q=b[34];a=q}else{b[35]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._("__JHASH__qkGZoir7PES__JHASH__"),b[35]=n):n=b[35];r=n;b[36]!==e||b[37]!==g||b[38]!==i?(q=k.jsx(c("PolarisLikedByListButton.react"),{code:e,inModal:g,onClick:i,children:r}),b[36]=e,b[37]=g,b[38]=i,b[39]=q):q=b[39];a=q;if(o!=null&&o.length>=1){n=o[0];b[40]!==n?(q=k.jsx(c("IGDSText.react"),{weight:"semibold",children:n}),b[40]=n,b[41]=q):q=b[41];b[42]!==n||b[43]!==q?(o=k.jsx(c("PolarisUserLink.react"),{color:"ig-primary-text",username:n,children:q}),b[42]=n,b[43]=q,b[44]=o):o=b[44];u=o}else{n=s[0];b[45]!==n?(q=k.jsx(l,{user:n}),b[45]=n,b[46]=q):q=b[46];u=q}}else{b[47]!==p?(o=p>2?h._("__JHASH__TqguRNzb8Vy__JHASH__",[h._param("count",k.jsx(c("PolarisBigNumber.react"),{value:p-1}))]):h._("__JHASH__FHgoDdBvGlx__JHASH__"),b[47]=p,b[48]=o):o=b[48];r=o;b[49]!==e||b[50]!==g||b[51]!==i||b[52]!==r?(n=k.jsx(c("PolarisLikedByListButton.react"),{code:e,inModal:g,onClick:i,children:r}),b[49]=e,b[50]=g,b[51]=i,b[52]=r,b[53]=n):n=b[53];a=n;q=s[0];b[54]!==q?(p=k.jsx(l,{user:q}),b[54]=q,b[55]=p):p=b[55];u=p}b[56]!==u||b[57]!==a?(o=h._("__JHASH__ULbzii5uqUI__JHASH__",[h._param("username",u),h._param("other users",a)]),b[56]=u,b[57]=a,b[58]=o):o=b[58];return o}if(f)return null;b[59]!==t?(e=k.jsx(c("IGDSButton.react"),{display:"block",label:t,onClick:m,variant:"secondary_link"}),b[59]=t,b[60]=e):e=b[60];return e}g["default"]=a}),226);
__d("PolarisLineClampText.react",["fbt","CometLineClamp.react","IGDSText.react","PolarisIGCorePressable.react","PolarisIGCoreText","PolarisUserText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useState,l=b.c,m=2,n=1e4;function a(a){var b=l(27),d,e,f,g,i;b[0]!==a?(d=a.lines,i=a.prependElement,f=a.color,g=a.value,e=babelHelpers.objectWithoutPropertiesLoose(a,["lines","prependElement","color","value"]),b[0]=a,b[1]=d,b[2]=e,b[3]=f,b[4]=g,b[5]=i):(d=b[1],e=b[2],f=b[3],g=b[4],i=b[5]);a=d===void 0?m:d;d=k(!1);var o=d[0],p=d[1];b[6]!==e||b[7]!==f||b[8]!==g?(d=j.jsx(c("PolarisUserText.react"),babelHelpers["extends"]({},e,{color:f,display:"inline",headlineTag:"h1",size:"body",value:g})),b[6]=e,b[7]=f,b[8]=g,b[9]=d):d=b[9];e=d;g=f==="ig-text-on-media"?"textOnMedia":"secondaryText";b[10]!==o?(d=function(){return p(!o)},b[10]=o,b[11]=d):d=b[11];var q;b[12]===Symbol["for"]("react.memo_cache_sentinel")?(q={display:"inline"},b[12]=q):q=b[12];a=o?n:a;var r;b[13]!==a||b[14]!==i||b[15]!==e?(r=j.jsxs(c("CometLineClamp.react"),{lines:a,children:[i,e]}),b[13]=a,b[14]=i,b[15]=e,b[16]=r):r=b[16];b[17]!==o||b[18]!==g?(a=!o&&j.jsx(c("IGDSText.react"),{color:g,textAlign:"start",zeroMargin:!0,children:h._("__JHASH__o8KDH-tdLwt__JHASH__")}),b[17]=o,b[18]=g,b[19]=a):a=b[19];b[20]!==d||b[21]!==r||b[22]!==a?(i=j.jsxs(c("PolarisIGCorePressable.react"),{onPress:d,style:q,children:[r,a]}),b[20]=d,b[21]=r,b[22]=a,b[23]=i):i=b[23];b[24]!==f||b[25]!==i?(e=j.jsx(c("PolarisIGCoreText"),{color:f,display:"inline",zeroMargin:!0,children:i}),b[24]=f,b[25]=i,b[26]=e):e=b[26];return e}g["default"]=a}),226);
__d("PolarisUserTagIndicator.react",["IGDSBox.react","IGDSUserPanoFilledIcon.react","PolarisGenericStrings","PolarisIGCoreButton.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l={absolute:{bottom:"x1ey2m1c",start:"x17qophe",position:"x10l6tqk",$$css:!0},root:{background:"x1ym3s0w",borderTopStartRadius:"x107yiy2",borderTopEndRadius:"xv8uw2v",borderBottomEndRadius:"x1tfwpuw",borderBottomStartRadius:"x2g32xy",borderTopWidth:"x972fbf",borderEndWidth:"xcfux6l",borderBottomWidth:"x1qhh985",borderStartWidth:"xm0m39n",cursor:"x1ypdohk",marginTop:"x14vqqas",marginEnd:"xq8finb",marginBottom:"xod5an3",marginStart:"x16n37ib",opacity:"xg01cxk",position:"x1n2onr6",transitionDuration:"x13dflua",transitionProperty:"x19991ni",$$css:!0},visible:{opacity:"x1hc1fzr",$$css:!0}};function a(a){var b=j(13),e=a.absolute,f=a.endAndornment,g=a.onClick;a=a.visible;e=e===void 0?!1:e;a=a===void 0?!0:a;var i;b[0]!==e||b[1]!==a?(i=(h||(h=c("stylex"))).props(l.root,e&&l.absolute,a&&l.visible),b[0]=e,b[1]=a,b[2]=i):i=b[2];e=f!=null?3:2;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("IGDSUserPanoFilledIcon.react"),{alt:d("PolarisGenericStrings").TAG_TEXT,color:"web-always-white",size:12}),b[3]=a):a=b[3];b[4]!==e||b[5]!==f?(a=k.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",justifyContent:"center",paddingX:e,paddingY:2,position:"relative",children:[a,f]}),b[4]=e,b[5]=f,b[6]=a):a=b[6];b[7]!==g||b[8]!==a?(e=k.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:g,children:a}),b[7]=g,b[8]=a,b[9]=e):e=b[9];b[10]!==i||b[11]!==e?(f=k.jsx("div",babelHelpers["extends"]({},i,{children:e})),b[10]=i,b[11]=e,b[12]=f):f=b[12];return f}g["default"]=a}),98);
__d("PolarisLoggedOutUserTagIndicator.react",["PolarisConfig","PolarisLoggedOutCtaLogger","PolarisNavigationActions","PolarisReactRedux.react","PolarisUA","PolarisUserTagIndicator.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.c;function a(a){var b=j(7),e=a.analyticsContext,f=a.defaultOnClick;a=a.visible;a=a===void 0?!0:a;var g=d("PolarisReactRedux.react").useDispatch(),h;b[0]!==e||b[1]!==g||b[2]!==f?(h=function(){d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"user_action",ctaVersion:"",eventName:"tagged_icon_click",module:e||""}),d("PolarisUA").isDesktop()&&!d("PolarisConfig").isLoggedOutFRXEligible()?g(d("PolarisNavigationActions").openLoginModal("feature_wall",window.location.href,"post_tagged")):f!=null&&f()},b[0]=e,b[1]=g,b[2]=f,b[3]=h):h=b[3];h=h;var k;b[4]!==h||b[5]!==a?(k=i.jsx(c("PolarisUserTagIndicator.react"),{absolute:!0,onClick:h,visible:a}),b[4]=h,b[5]=a,b[6]=k):k=b[6];return k}g["default"]=a}),98);
__d("PolarisMediaVideo.react",["cr:6866","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");g["default"]=b("cr:6866")}),98);
__d("PolarisOzConfigMobileDefault",[],(function(a,b,c,d,e,f){"use strict";a={abr_use_download_time:!1,allow_queueing_end_of_stream_when_update:!1,back_off_pdash_504_retry:!1,bandwidth_ignore_on_stream_write_samples:!1,bandwidth_use_response_time_adjustment:!1,buffer_when_waiting:!1,call_end_of_stream_in_quick_starter:!1,check_buffer_range_once_for_playhead_update:!1,cleanup_video_node_on_destroy:!1,clear_buffer_when_switch_representation_initiator_is_user:!1,clear_prepended_segments_count_on_append:!1,copy_new_manifest:!1,detach_media_source_manager:!1,disable_audio_scheduler:!1,enable_abr_for_first_request:!1,enable_adaptation:!0,enable_appends_on_wait_update_end_failure:!1,enable_network_manager_error:!1,enable_quickdashv2:!1,estimate_video_bandwidth_only:!1,exclude_prefetch_bandwidth_samples:!0,fallback_on_append_error:!1,fix_abr_default_representation:!1,fix_quick_starter_overhead:!0,fix_seek_performance:!1,fix_template_duration_artifact_in_manifest:!1,generate_mos_segment_appended_secs:!1,ignore_time_to_response_start:!1,lazy_parse_sidx:!1,live_audio_ibr:!0,live_catch_up_only_when_paused:!1,live_disable_mpd_updates_when_paused:!1,live_gracefully_handle_mpd_errors:!1,live_gracefully_handle_no_network:!1,live_no_segment_when_playhead_is_before_first_segment:!1,live_playhead_catch_up:!1,live_query_time_in_range:!1,log_appended_secs:!1,maybe_end_stream_if_prepended_segments:!1,no_new_loop_body_promise_when_stream_ongoing:!1,pausable_stream_throws_error_when_aborted:!1,pdash_continue_interrupt_from_error:!1,queue_data_with_error_handling:!1,reach_end_only_when_video_ended:!1,remove_src_attr_on_unload:!1,retry_fetch_on_prefetch_error:!1,sbm_recursively_waits_for_update_end:!1,sbm_waits_for_update_end:!0,seek_ahead_use_native_current_time:!1,seek_to_start_quick_starter:!1,set_source_buffer_append_window_end:!1,skip_videobuffer_gaps:!0,stop_manifest_update_when_static:!1,suppress_playing_event_while_buffering:!1,throw_network_error_during_stream:!1,throw_on_non_zero_r_d_mismatch:!1,touch_cb_key:!1,update_bandwidth_cache_on_sample:!1,update_duration_when_init_appended:!1,update_media_source_duration:!0,use_abr_for_missing_default_representation:!1,use_deferred_streaming_task:!1,use_loose_manifest_updates:!1,use_performance_entry_on_stream_close:!1,use_sc_timebased_segments:!1,use_scf_timebased_segments:!1,use_scheduler:!0,use_segment_request_cache:!1,use_stream_end_time_in_segment_locator:!1};b={abr_confidence_threshold:.9,abr_eval_buffer_threshold:0,abr_min_bandwidth_samples:0,abr_prevent_down_switch_buffer_threshold:11,abr_restrict_from_index:0,abr_restrict_to_index:0,append_byte_target_without_range:0,appends_per_segment:3,auto_seek_playhead_slack:0,bandwidth_boundary_standard_deviation_factor:1,bandwidth_estimator_half_life:6,bandwidth_estimator_outlier_exclusion_factor:50,bandwidth_estimator_std_dev_penalty_factor:0,bandwidth_estimator_variance_penalty_down_factor:0,bandwidth_estimator_variance_penalty_half_life:0,bandwidth_estimator_variance_penalty_up_factor:0,bandwidth_penalty_additional_video_start:0,bandwidth_penalty_per_additional_video:0,bandwidth_response_time_handicap:0,buffer_ahead_target:19,byte_count_per_sample:6e4,default_bandwidth_estimate:5e5,download_time_buffer_delta_penalty_factor:0,in_play_buffer_overflow_target:1,in_play_buffer_underflow_target:.1,initial_switch_interval:0,live_audio_ibr_bandwidth_percentage:.05,live_catch_up_fall_behind_threshold:20,live_catch_up_live_head_delta:6,live_max_try_attempts_on_404:1,live_numerical_error_epsilon:0,low_buffer_bandwidth_target_increase_factor:0,low_buffer_bandwidth_target_threshold:10,low_segment_stream_playhead_threshold:0,max_bandwidth_sample_count:30,maximum_bandwidth_sample_bandwidth:2e6,min_eval_interval:1e3,min_switch_interval:5e3,minimum_bandwidth_sample_duration:30,minimum_bytes_to_sample_on_close:25e3,minimum_download_additional_buffer_ms:0,network_seg_timeout_ms:0,paused_stream_segments_count:2,per_stream_duration_target:0,playhead_nudge_slack:0,pre_start_buffer_ahead_target:10,resolution_constraint_factor:2,seconds_to_stream:0,seconds_to_stream_near_bandwidth_boundary:0,seek_ahead_epsilon:0,segments_to_stream:5,segments_to_stream_near_bandwidth_boundary:5,segments_to_stream_under_playhead_threshold:0,start_buffer_underflow_target:.1,stream_interrupt_check_mpd_stale_count_threshold:0,time_to_first_byte_estimate_half_life_ms:500,timeline_offset_threshold:0};c={bandwidth_cache_key:"bandwidthEstimate",network_end_broadcasts_json:"[]",network_reload_mpd_json:"[]",network_retry_intervals_json:'{"0": 1000, "404": 2000, "502": 1000, "503": 1000, "504": 1000}',network_skip_json:"[]"};f.defaultBools=a;f.defaultNumbers=b;f.defaultStrings=c}),66);
__d("PolarisPCManagerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext(null);g["default"]=b}),98);
__d("PolarisProfileClickEventLoggerProvider.react",["PolarisProfileClickEventLoggerContext.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(3),d=a.children;a=a.onProfileClick;var e;b[0]!==a||b[1]!==d?(e=j.jsx(c("PolarisProfileClickEventLoggerContext.react").Provider,{value:a,children:d}),b[0]=a,b[1]=d,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("PolarisPartnershipAdAvatar.react",["IGDSBox.react","PolarisClickEventLoggerProvider.react","PolarisProfileClickEventLoggerProvider.react","PolarisSponsoredPostContext.react","PolarisUserAvatar.react","PolarisUserHoverCard.react","react","react-forget-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useContext;var j=b.c;function a(a){var b,e,f,g=j(25),h=a.firstIdentity;a=a.secondIdentity;var l=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,k);l=l.onSecondaryProfileClick;var m=!a.is_unpublished;b=(b=a.id)!=null?b:"";e=(e=a.username)!=null?e:"";var n=!a.is_unpublished;f=(f=a.profile_pic_url)!=null?f:"";a=(a=a.username)!=null?a:"";var o;g[0]!==n||g[1]!==f||g[2]!==a?(o=i.jsx(c("PolarisUserAvatar.react"),{isLink:n,profilePictureUrl:f,size:24,username:a}),g[0]=n,g[1]=f,g[2]=a,g[3]=o):o=g[3];g[4]!==m||g[5]!==b||g[6]!==e||g[7]!==o?(n=i.jsx(c("PolarisUserHoverCard.react"),{display:"block",isUserAvailable:m,userId:b,username:e,children:o}),g[4]=m,g[5]=b,g[6]=e,g[7]=o,g[8]=n):n=g[8];g[9]===Symbol["for"]("react.memo_cache_sentinel")?(f="x1qjc9v5 xvbhtw8 x14yjl9h xudhj91 x18nykt9 xww2gxu x972fbf xcfux6l x1qhh985 xm0m39n x9f619 x78zum5 xdt5ytf x2lah0s xk390pu x1923su1 xdj266r x11i5rnm xat24cr x1mh8g0r x4p5aij x19um543 x1j85h84 x1m6msm x10l6tqk xfr5jun x11njtxf",g[9]=f):f=g[9];a=!h.is_unpublished;b=(m=h.username)!=null?m:"";e=!h.is_unpublished;m=(o=h.profile_pic_url)!=null?o:"";o=(o=h.username)!=null?o:"";var p;g[10]!==e||g[11]!==m||g[12]!==o?(p=i.jsx(c("PolarisUserAvatar.react"),{isLink:e,profilePictureUrl:m,size:24,username:o}),g[10]=e,g[11]=m,g[12]=o,g[13]=p):p=g[13];g[14]!==a||g[15]!==h.id||g[16]!==b||g[17]!==p?(e=i.jsx(c("PolarisUserHoverCard.react"),{display:"block",isUserAvailable:a,userId:h.id,username:b,children:p}),g[14]=a,g[15]=h.id,g[16]=b,g[17]=p,g[18]=e):e=g[18];g[19]!==l||g[20]!==e?(m=i.jsx("div",{className:f,children:i.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",justifyContent:"start",children:i.jsx(c("PolarisClickEventLoggerProvider.react"),{children:i.jsx(c("PolarisProfileClickEventLoggerProvider.react"),{onProfileClick:l,children:e})})})}),g[19]=l,g[20]=e,g[21]=m):m=g[21];g[22]!==n||g[23]!==m?(o=i.jsxs(c("IGDSBox.react"),{alignItems:"end",height:32,position:"relative",width:32,children:[n,m]}),g[22]=n,g[23]=m,g[24]=o):o=g[24];return o}function k(a){return[a.onSecondaryProfileClick]}g["default"]=a}),98);
__d("PolarisPartnershipAdHeader.react",["cx","fbt","IGDSText.react","PolarisClickEventLoggerProvider.react","PolarisProfileClickEventLoggerProvider.react","PolarisSponsoredPostContext.react","PolarisUserHoverCard.react","PolarisUserLink.react","react","react-forget-runtime"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;b.useContext;var l=b.c;function a(a){var b=l(4),e=a.firstIdentity;a=a.secondIdentity;var f=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,m);f=f.onSecondaryProfileClick;var g;b[0]!==e||b[1]!==f||b[2]!==a?(g=k.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:i._("__JHASH__EDvwZGAvckz__JHASH__",[i._param("primary identity name",k.jsx(c("PolarisClickEventLoggerProvider.react"),{children:k.jsx(c("PolarisProfileClickEventLoggerProvider.react"),{onProfileClick:f,children:k.jsx(n,{identity:e})})})),i._param("secondary identity name",k.jsx(n,{identity:a})),i._implicitParam("=m2",k.jsx(c("IGDSText.react").Body,{children:i._("__JHASH__eE_Jo8cJd7w__JHASH__")}))])}),b[0]=e,b[1]=f,b[2]=a,b[3]=g):g=b[3];return g}function m(a){return[a.onSecondaryProfileClick]}function n(a){var b=l(2);a=a.identity;var d;b[0]!==a?(d=a.is_unpublished===!0?k.jsx(c("IGDSText.react").BodyEmphasized,{color:"secondaryText",zeroMargin:!0,children:k.jsx("span",{className:"_aaqs",children:a.full_name})}):k.jsx(c("PolarisUserHoverCard.react"),{display:"inline-block",isUserAvailable:!a.is_unpublished,userId:a.id,username:a.username,children:k.jsx(c("PolarisUserLink.react"),{username:a.username})}),b[0]=a,b[1]=d):d=b[1];return d}g["default"]=a}),226);
__d("PolarisUpcomingEventIndicator.react",["cx","IGDSBox.react","IGDSCalendarPanoFilledIcon.react","PolarisGenericStrings","PolarisIGCoreButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(a){var b=j(3);a=a.onClick;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=k.jsx(c("IGDSBox.react"),{alignItems:"center",direction:"row",justifyContent:"center",paddingX:2,paddingY:2,position:"relative",children:k.jsx(c("IGDSCalendarPanoFilledIcon.react"),{alt:d("PolarisGenericStrings").UPCOMING_EVENT_ICON_ALT,color:"web-always-white",size:12})}),b[0]=e):e=b[0];b[1]!==a?(e=k.jsx("div",{className:"_a9-2 _a9-3 _a9-4",children:k.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:a,children:e})}),b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("PolarisPostActionSetUpcomingEventReminder",["InstagramUpcomingEventActionFalcoEvent","PolarisAPISetUpcomingEventReminder","PolarisContainerModuleUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f,g,h){c("InstagramUpcomingEventActionFalcoEvent").log(function(){return{action:"upcoming_event_reminder_on",pigeon_reserved_keyword_module:d("PolarisContainerModuleUtils").getContainerModule(g),source_of_action:h,upcoming_event_id:a}});return function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield d("PolarisAPISetUpcomingEventReminder").setUpcomingEventReminder(a,e,!0));c.status==="ok"&&(yield b({eventId:a,reminderEnabled:!0,type:"UPCOMING_EVENT_REMINDER_SET"}),f(!1))});return function(a){return c.apply(this,arguments)}}()}g.setUpcomingEventReminder=a}),98);
__d("PolarisPostActionUnsetUpcomingEventReminder",["InstagramUpcomingEventActionFalcoEvent","PolarisAPISetUpcomingEventReminder","PolarisContainerModuleUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f,g){c("InstagramUpcomingEventActionFalcoEvent").log(function(){return{action:"upcoming_event_reminder_off",pigeon_reserved_keyword_module:d("PolarisContainerModuleUtils").getContainerModule(f),source_of_action:g,upcoming_event_id:a}});return function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield d("PolarisAPISetUpcomingEventReminder").setUpcomingEventReminder(a,null,!1));c.status==="ok"&&(yield b({eventId:a,reminderEnabled:!1,type:"UPCOMING_EVENT_REMINDER_UNSET"}),e(!1))});return function(a){return c.apply(this,arguments)}}()}g.unsetUpcomingEventReminder=a}),98);
__d("PolarisUpcomingEventStrings",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a=h._("__JHASH__6l0c6O_mEEs__JHASH__");b=h._("__JHASH__rV1x4VLA-xS__JHASH__");c=h._("__JHASH__wffskxZPcq7__JHASH__");d=h._("__JHASH__dmPXhvuUXZ2__JHASH__");e=h._("__JHASH__QEHopTzhoM2__JHASH__");f=h._("__JHASH__8VmaTNZNFR2__JHASH__");h=h._("__JHASH__tBYM5KMeEH4__JHASH__");g.IN_THIS_PHOTO_TITLE_TEXT=a;g.IN_THIS_VIDEO_TITLE_TEXT=b;g.UPCOMING_EVENT_TITLE_TEXT=c;g.ACCOUNTS_TITLE_TEXT=d;g.GET_REMINDER_TEXT=e;g.CANCEL_REMINDER_TEXT=f;g.UPCOMING_EVENT_NOTIFICATION_INFO_TEXT=h}),226);
__d("PolarisUpcomingEventContainerFooter.react",["IGDSBox.react","IGDSDivider.react","PolarisIGCoreButton.react","PolarisIGCoreText","PolarisPostActionSetUpcomingEventReminder","PolarisPostActionUnsetUpcomingEventReminder","PolarisReactRedux.react","PolarisUA","PolarisUpcomingEventStrings","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useState,k=b.c;function a(a){var b=k(12),e=a.analyticsContext,f=a.eventId,g=a.mediaId,h=a.reminderEnabled;a=j(!1);var l=a[0],m=a[1],n=d("PolarisReactRedux.react").useDispatch();b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("PolarisIGCoreText"),{color:"ig-secondary-text",size:"footnote",textAlign:d("PolarisUA").isDesktop()?"left":"center",weight:"light",children:d("PolarisUpcomingEventStrings").UPCOMING_EVENT_NOTIFICATION_INFO_TEXT}),b[0]=a):a=b[0];a=a;var o=h?"ig-secondary-button":"ig-primary-button",p=h?d("PolarisUpcomingEventStrings").CANCEL_REMINDER_TEXT:d("PolarisUpcomingEventStrings").GET_REMINDER_TEXT,q;b[1]!==h||b[2]!==n||b[3]!==f||b[4]!==e||b[5]!==g?(q=function(){m(!0),h?n(d("PolarisPostActionUnsetUpcomingEventReminder").unsetUpcomingEventReminder(f,m,e,"tag_indicator")):n(d("PolarisPostActionSetUpcomingEventReminder").setUpcomingEventReminder(f,g,m,e,"tag_indicator"))},b[1]=h,b[2]=n,b[3]=f,b[4]=e,b[5]=g,b[6]=q):q=b[6];q=q;b[7]!==p||b[8]!==o||b[9]!==l||b[10]!==q?(a=d("PolarisUA").isDesktop()?i.jsxs(i.Fragment,{children:[i.jsx(c("IGDSBox.react"),{marginBottom:6,marginTop:2,paddingX:3,position:"relative",children:a}),i.jsx(c("IGDSDivider.react"),{}),i.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,color:o,loading:l,onClick:q,children:i.jsx(c("IGDSBox.react"),{padding:4,position:"relative",children:p})})]}):i.jsxs(i.Fragment,{children:[i.jsx(c("IGDSBox.react"),{marginTop:1,paddingX:4,position:"relative",children:i.jsx(c("PolarisIGCoreButton.react"),{color:o,large:!0,loading:l,onClick:q,children:p})}),i.jsx(c("IGDSBox.react"),{marginBottom:4,marginTop:3,paddingX:5,position:"relative",children:a})]}),b[7]=p,b[8]=o,b[9]=l,b[10]=q,b[11]=a):a=b[11];return a}g["default"]=a}),98);
__d("PolarisUpcomingEventUtils",["fbt","PolarisLocales"],(function(a,b,c,d,e,f,g,h){"use strict";var i={day:"numeric",month:"short",weekday:"short"},j={hour:"numeric",minute:"2-digit"};function a(a){if(a==null)return"Unknown time";a=new Date(a*1e3);var b=c("PolarisLocales").locale.replace("_","-"),d=a.toLocaleDateString(b,i);a=a.toLocaleTimeString(b,j);return h._("__JHASH__U_fK7-Pg0rr__JHASH__",[h._param("dateString",d),h._param("timeString",a)])}function b(a){return a>Math.floor(Date.now()/1e3)}g.getUpcomingEventDateString=a;g.getUpcomingEventIsActive=b}),226);
__d("PolarisUpcomingEventContainer.react",["fbt","IGDSBox.react","IGDSText.react","InstagramUpcomingEventActionFalcoEvent","PolarisContainerModuleUtils","PolarisThumbnail.react","PolarisUpcomingEventContainerFooter.react","PolarisUpcomingEventUtils","PolarisViewpointReact.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useMemo,m=b.useState,n=h._("__JHASH__LNT7mjfpcW-__JHASH__");function a(a){var b=a.analyticsContext,e=a.mediaId,f=a.upcomingEvent;a=a.upcomingEventThumbnailSrc;f=(f=f)!=null?f:{};var g=f.eventId,h=f.reminderEnabled,i=f.startTime;f=f.title;var o=m(d("PolarisUpcomingEventUtils").getUpcomingEventIsActive(i)),p=o[0],q=o[1];o=l(function(){return d("PolarisUpcomingEventUtils").getUpcomingEventDateString(i)},[i]);k(function(){var a=window.setInterval(function(){q(d("PolarisUpcomingEventUtils").getUpcomingEventIsActive(i))},15e3);return function(){return window.clearInterval(a)}},[]);var r=function(a){switch(a.state){case"exited":c("InstagramUpcomingEventActionFalcoEvent").log(function(){return{action:"upcoming_event_sheet_time_spent",event_sheet_time_spent:a.getTimeSpent()/1e3,pigeon_reserved_keyword_module:d("PolarisContainerModuleUtils").getContainerModule(b),source_of_action:"tag_indicator",upcoming_event_id:g}});break}};r=d("PolarisViewpointReact.react").useViewpoint({action:r,id:e});return j.jsxs(c("IGDSBox.react"),{containerRef:r,position:"relative",children:[j.jsxs(c("IGDSBox.react"),{direction:"row",position:"relative",children:[j.jsx(c("IGDSBox.react"),{padding:4,position:"relative",children:j.jsx(c("PolarisThumbnail.react"),{alt:n,dimension:88,src:a})}),j.jsxs(c("IGDSBox.react"),{alignSelf:"center",flex:"grow",position:"relative",children:[j.jsx(c("IGDSText.react").Title,{children:f}),j.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"body",weight:"light",children:o})})]})]}),p&&j.jsx(c("PolarisUpcomingEventContainerFooter.react"),{analyticsContext:b,eventId:g,mediaId:e,reminderEnabled:h})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("PolarisUpcomingEventSheetOrModal.react",["fbt","PolarisIGCoreSheetOrModal","PolarisUA","PolarisUpcomingEventContainer.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=h._("__JHASH__Tnjj3OQWZIp__JHASH__");function a(a){var b=j(8),e=a.analyticsContext,f=a.mediaId,g=a.onClose,h=a.upcomingEvent;a=a.upcomingEventThumbnailSrc;var i;b[0]!==e||b[1]!==f||b[2]!==h||b[3]!==a?(i=k.jsx(c("PolarisUpcomingEventContainer.react"),{analyticsContext:e,mediaId:f,upcomingEvent:h,upcomingEventThumbnailSrc:a}),b[0]=e,b[1]=f,b[2]=h,b[3]=a,b[4]=i):i=b[4];b[5]!==g||b[6]!==i?(e=k.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{onClose:g,title:d("PolarisUA").isDesktop()?l:null,children:i}),b[5]=g,b[6]=i,b[7]=e):e=b[7];return e}g["default"]=a}),226);
__d("PolarisUserTagSheet.react",["IGDSBox.react","IGDSListItem.react","IGDSText.react","IGDSVerifiedBadge.react","PolarisIGCoreConstants","PolarisIGCoreSheetOrModal","PolarisLinkBuilder","PolarisUA","PolarisUserAvatar.react","nullthrows","polarisLogAction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){var b=i(9);a=a.user;var d=a.isVerified;a=a.username;if(a===void 0)return null;var e;b[0]!==a?(e=j.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:a}),b[0]=a,b[1]=e):e=b[1];b[2]!==d?(a=d&&j.jsx(c("IGDSVerifiedBadge.react"),{size:"small"}),b[2]=d,b[3]=a):a=b[3];b[4]!==a?(d=j.jsx(c("IGDSBox.react"),{marginStart:2,children:a}),b[4]=a,b[5]=d):d=b[5];b[6]!==e||b[7]!==d?(a=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:[e,d]}),b[6]=e,b[7]=d,b[8]=a):a=b[8];return a}function l(a){var b=i(17),e=a.onClick;a=a.user;var f=a.fullName,g=a.profilePictureUrl,h=a.username,l;b[0]!==g||b[1]!==h?(l=j.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:g,size:c("PolarisIGCoreConstants").AVATAR_SIZES.medium,username:h}),b[0]=g,b[1]=h,b[2]=l):l=b[2];b[3]!==h?(g=d("PolarisLinkBuilder").buildUserLink(h),b[3]=h,b[4]=g):g=b[4];b[5]!==g?(h={url:g},b[5]=g,b[6]=h):h=b[6];b[7]!==e?(g=function(){e()},b[7]=e,b[8]=g):g=b[8];var m;b[9]!==a?(m=j.jsx(k,{user:a}),b[9]=a,b[10]=m):m=b[10];b[11]!==l||b[12]!==h||b[13]!==g||b[14]!==f||b[15]!==m?(a=j.jsx(c("IGDSListItem.react"),{addOnStart:l,linkProps:h,onPress:g,subtitle:f,testid:void 0,title:m}),b[11]=l,b[12]=h,b[13]=g,b[14]=f,b[15]=m,b[16]=a):a=b[16];return a}function m(a){var b=i(7),d=a.mediaId;a=a.usertags;var e;b[0]!==d?(e=function(){c("polarisLogAction")("userTagSheetItemClick",{mediaId:d,source:"UserTagSheetItems"})},b[0]=d,b[1]=e):e=b[1];var f=e;if(b[2]!==f||b[3]!==a){b[5]!==f?(e=function(a){a=c("nullthrows")(a);a=a.user;return j.jsx(l,{onClick:f,user:a},a.id)},b[5]=f,b[6]=e):e=b[6];e=a.map(e);b[2]=f;b[3]=a;b[4]=e}else e=b[4];return e}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.componentDidMount=function(){c("polarisLogAction")("userTagSheetImpression",{mediaId:this.props.mediaId,numUsertags:this.props.usertags.length,source:"UserTagSheet"})};e.render=function(){var a=this.props,b=a.mediaId,e=a.onClose,f=a.title;a=a.usertags;return j.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{onClose:e,title:f,children:j.jsx(c("IGDSBox.react"),{flex:"grow",marginBottom:d("PolarisUA").isMobile()?6:void 0,overflow:"auto",children:j.jsx(m,{mediaId:b,usertags:a})})})};return b}(j.PureComponent);g.Username=k;g.UserTagSheetItem=l;g.UserTagSheetItems=m;g.UserTagSheet=a}),98);
__d("PolarisUpcomingEventWithUserTagsSheetOrModal.react",["PolarisIGCoreSheetOrModal","PolarisIGCoreTabV2.react","PolarisIGCoreTabsV2.react","PolarisUpcomingEventContainer.react","PolarisUpcomingEventStrings","PolarisUserTagSheet.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(15),e=a.analyticsContext,f=a.isVideo,g=a.mediaId,h=a.onClose,k=a.upcomingEvent,l=a.upcomingEventThumbnailSrc;a=a.usertags;f=f?d("PolarisUpcomingEventStrings").IN_THIS_VIDEO_TITLE_TEXT:d("PolarisUpcomingEventStrings").IN_THIS_PHOTO_TITLE_TEXT;var m;b[0]!==k||b[1]!==l||b[2]!==e||b[3]!==g?(m=k!=null&&l!=null&&j.jsx(c("PolarisIGCoreTabV2.react"),{node:j.jsx(c("PolarisUpcomingEventContainer.react"),{analyticsContext:e,mediaId:g,upcomingEvent:k,upcomingEventThumbnailSrc:l}),children:d("PolarisUpcomingEventStrings").UPCOMING_EVENT_TITLE_TEXT}),b[0]=k,b[1]=l,b[2]=e,b[3]=g,b[4]=m):m=b[4];b[5]!==a||b[6]!==g?(k=a!=null&&j.jsx(c("PolarisIGCoreTabV2.react"),{node:j.jsx(d("PolarisUserTagSheet.react").UserTagSheetItems,{mediaId:g,usertags:a}),children:d("PolarisUpcomingEventStrings").ACCOUNTS_TITLE_TEXT}),b[5]=a,b[6]=g,b[7]=k):k=b[7];b[8]!==m||b[9]!==k?(l=j.jsxs(c("PolarisIGCoreTabsV2.react"),{children:[m,k]}),b[8]=m,b[9]=k,b[10]=l):l=b[10];b[11]!==h||b[12]!==f||b[13]!==l?(e=j.jsx(d("PolarisIGCoreSheetOrModal").IGCoreSheetOrModal,{onClose:h,title:f,children:l}),b[11]=h,b[12]=f,b[13]=l,b[14]=e):e=b[14];return e}g["default"]=a}),98);
__d("PolarisUpcomingEventIndicatorWithSheetOrModal.react",["InstagramUpcomingEventActionFalcoEvent","PolarisContainerModuleUtils","PolarisUpcomingEventIndicator.react","PolarisUpcomingEventSheetOrModal.react","PolarisUpcomingEventWithUserTagsSheetOrModal.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useState,k=b.c;function a(a){var b=k(17),e=a.analyticsContext,f=a.isVideo,g=a.mediaId,h=a.upcomingEvent,l=a.upcomingEventThumbnailSrc;a=a.usertags;var m=j(!1),n=m[0],o=m[1];m=a!=null&&a.length>0;var p;b[0]!==e||b[1]!==h.eventId?(p=function(){c("InstagramUpcomingEventActionFalcoEvent").log(function(){return{action:"upcoming_event_tag_indicator_click",pigeon_reserved_keyword_module:d("PolarisContainerModuleUtils").getContainerModule(e),source_of_action:"tag_indicator",upcoming_event_id:h.eventId}}),o(!0)},b[0]=e,b[1]=h.eventId,b[2]=p):p=b[2];p=p;var q;b[3]!==p?(q=i.jsx(c("PolarisUpcomingEventIndicator.react"),{onClick:p}),b[3]=p,b[4]=q):q=b[4];b[5]!==n||b[6]!==m||b[7]!==e||b[8]!==f||b[9]!==g||b[10]!==h||b[11]!==l||b[12]!==a?(p=n&&(m?i.jsx(c("PolarisUpcomingEventWithUserTagsSheetOrModal.react"),{analyticsContext:e,isVideo:f,mediaId:g,onClose:function(){return o(!1)},upcomingEvent:h,upcomingEventThumbnailSrc:l,usertags:a}):i.jsx(c("PolarisUpcomingEventSheetOrModal.react"),{analyticsContext:e,mediaId:g,onClose:function(){return o(!1)},upcomingEvent:h,upcomingEventThumbnailSrc:l})),b[5]=n,b[6]=m,b[7]=e,b[8]=f,b[9]=g,b[10]=h,b[11]=l,b[12]=a,b[13]=p):p=b[13];b[14]!==q||b[15]!==p?(n=i.jsxs(i.Fragment,{children:[q,p]}),b[14]=q,b[15]=p,b[16]=n):n=b[16];return n}g["default"]=a}),98);
__d("PolarisUserTagInner.react",["react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={pointer:{borderTopStyle:"x13fuv20",borderEndStyle:"xu3j5b3",borderBottomStyle:"x1q0q8m5",borderStartStyle:"x26u7qi",height:"xqtp20y",start:"xtzzx4i",marginStart:"xbmpl8g",position:"x10l6tqk",width:"xnalus7",$$css:!0},pointerDown:{borderBottomWidth:"x1qhh985",borderEndColor:"xogb00i",borderEndStyle:"xu3j5b3",borderEndWidth:"x1e7kja",borderStartColor:"x1ftr3km",borderStartStyle:"x26u7qi",borderStartWidth:"x19d7kov",borderTopColor:"xccvetk",borderTopStyle:"x13fuv20",borderTopWidth:"x1kr8tdy",top:"xdsb8wn",$$css:!0},pointerUp:{borderBottomColor:"x17nu0il",borderBottomStyle:"x1q0q8m5",borderBottomWidth:"xqm4iv",borderEndColor:"xogb00i",borderEndStyle:"xu3j5b3",borderEndWidth:"x1e7kja",borderStartColor:"x1ftr3km",borderStartStyle:"x26u7qi",borderStartWidth:"x19d7kov",borderTopWidth:"x972fbf",top:"xjibb99",$$css:!0}};a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var d=b.prototype;d.render=function(){var a=this.props,b=a.isPointingUp,d=a.pointerStyle;a=a.username;return j.jsxs(j.Fragment,{children:[j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props(b&&k.pointerUp,!b&&k.pointerDown,k.pointer),{style:d})),j.jsx("span",babelHelpers["extends"]({className:"x972fbf xcfux6l x1qhh985 xm0m39n xln7xf2 xk390pu xdj266r xq8finb xat24cr x16n37ib xexx8yu x4uap5 x18d9i69 xkhd6sd x11njtxf"},{children:a}))]})};return b}(j.Component);g["default"]=a}),98);
__d("PolarisUserTag.react",["cx","PolarisFastLink.react","PolarisUserTagInner.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function l(a){var b=j(23),d=a.action,e=a.className,f=a.forwardedRef,g=a.isPointingUp,h=a.isShowingTags,i=a.pointerStyle,l=a.style;a=a.user;var n=m;a=a.username;if(d!=null){var o;b[0]!==g||b[1]!==i||b[2]!==a||b[3]!==d?(o=k.jsx("div",{className:"_aa1q",children:n(g,i,a,d)}),b[0]=g,b[1]=i,b[2]=a,b[3]=d,b[4]=o):o=b[4];b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==o?(d=k.jsx("div",{className:e,ref:f,style:l,children:o}),b[5]=e,b[6]=f,b[7]=l,b[8]=o,b[9]=d):d=b[9];return d}o="_aa1q";d="/"+a+"/";b[10]!==g||b[11]!==i||b[12]!==a?(n=n(g,i,a),b[10]=g,b[11]=i,b[12]=a,b[13]=n):n=b[13];b[14]!==h||b[15]!==d||b[16]!==n?(g=k.jsx(c("PolarisFastLink.react"),{canTabFocus:h,className:o,href:d,children:n}),b[14]=h,b[15]=d,b[16]=n,b[17]=g):g=b[17];b[18]!==e||b[19]!==f||b[20]!==l||b[21]!==g?(i=k.jsx("div",{className:e,ref:f,style:l,children:g}),b[18]=e,b[19]=f,b[20]=l,b[21]=g,b[22]=i):i=b[22];return i}function m(a,b,d,e){return k.jsxs("span",{className:"_aa1p",children:[k.jsx(c("PolarisUserTagInner.react"),{isPointingUp:a,pointerStyle:b,username:d}),e]})}m.displayName=m.name+" [from "+f.id+"]";a=k.forwardRef(function(a,b){return k.jsx(l,babelHelpers["extends"]({},a,{forwardedRef:b}))});g["default"]=a}),98);
__d("PolarisPhotoWithIndicator.react",["cx","PolarisBatchDOM","PolarisConfig","PolarisEventLoop","PolarisLoggedOutCtaLogger","PolarisLoggedOutUserTagIndicator.react","PolarisNavigationActions","PolarisPhoto.react","PolarisReactRedux.react","PolarisUA","PolarisUpcomingEventIndicatorWithSheetOrModal.react","PolarisUserTag.react","PolarisUserTagIndicator.react","joinClasses","polarisOnlyHandleSingleClick","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=.04,l=2e3,m=-50,n={horizontalOffset:m,isPointingUp:!0},o=.85,p=6;function q(a,b){b=b+k/2;var c=b>a,d=b>1-a;c=c||d;return c?d?m+(m-100*k)*(1-(1-a)/b):m-(m-100*k)*(1-a/b):m}b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.state={isShowingIndicator:!0,isShowingTags:!1,tagAdjustments:new Map()},c.$3=new Map(),c.$11=function(){c.setState({isShowingIndicator:!1}),c.$8()},c.$7=d("polarisOnlyHandleSingleClick").onlyHandleSingleClick(function(){if(!d("PolarisConfig").isLoggedIn()&&d("PolarisUA").isDesktop()){c.$12();return}var a=c.props,b=a.alwaysShowIndicator;a=a.usertags;var e=c.state.isShowingTags;if(a&&a.length>0){a=!e;c.$8();c.setState({isShowingIndicator:a||b,isShowingTags:a})}}),b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.componentDidUpdate=function(a){a.isVisible&&!this.props.isVisible?this.$4():!a.isVisible&&this.props.isVisible&&this.$5()};e.componentDidMount=function(){this.$6()};e.componentWillUnmount=function(){this.$7.cancel(),this.$8()};e.$9=function(a){return{height:a.offsetHeight,left:a.offsetLeft,top:a.offsetTop,width:a.offsetWidth}};e.$6=function(){var a=this;d("PolarisBatchDOM").mutate(function(){if(!a.$2)return;var b=a.$9(a.$2),c=new Map();a.$3.forEach(function(d,e){d=a.$9(d);var f=d.top/b.height<=o,g=d.width/b.width/2;d=d.left/b.width;d=q(d,g);c.set(e,{horizontalOffset:d,isPointingUp:f})});a.setState({tagAdjustments:c})})};e.$10=function(){this.$1||(this.$1=c("PolarisEventLoop").setTimeout(this.$11,l))};e.$8=function(){this.$1&&(c("PolarisEventLoop").clearTimeout(this.$1),this.$1=null)};e.$12=function(){var a=this.props,b=a.analyticsContext;a=a.onLoggedOutIntentClickLoginModal;d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"user_action",ctaVersion:"",eventName:"tagged_icon_click",module:b||""});a("post_tagged")};e.$5=function(){!this.state.isShowingTags&&!this.props.alwaysShowIndicator&&this.$10()};e.$4=function(){this.state.isShowingTags||(this.$8(),this.setState({isShowingIndicator:!0}))};e.$13=function(){var a=this;return!this.props.usertags?null:this.props.usertags.map(function(b){var d=r(b),e=a.state.tagAdjustments.get(d)||n,f={left:b.x*100+"%",marginTop:(e.isPointingUp?p:-p)+"px",top:b.y*100+"%",transform:"translate(\n          "+e.horizontalOffset+"%,\n          "+(e.isPointingUp?0:-100)+"%\n        ) scale("+(a.state.isShowingTags?1:0)+")"},g={left:-e.horizontalOffset+"%"};return j.jsx(c("PolarisUserTag.react"),{className:"_aa1y",isPointingUp:e.isPointingUp,isShowingTags:a.state.isShowingTags,pointerStyle:g,ref:function(b){b!=null&&a.$3.set(d,b)},style:f,user:b.user},d)})};e.$14=function(){var a=this.props,b=a.analyticsContext,e=a.isFocused,f=a.upcomingEvent,g=a.upcomingEventMediaId,h=a.upcomingEventThumbnailSrc;a=a.usertags;var i=this.state.isShowingIndicator;return f?j.jsx(c("PolarisUpcomingEventIndicatorWithSheetOrModal.react"),{analyticsContext:b,isVideo:!1,mediaId:g,upcomingEvent:f,upcomingEventThumbnailSrc:h,usertags:a}):d("PolarisConfig").isLoggedIn()?j.jsx(c("PolarisUserTagIndicator.react"),{absolute:!0,onClick:this.$7,visible:i||e}):j.jsx(c("PolarisLoggedOutUserTagIndicator.react"),{analyticsContext:b,defaultOnClick:this.$7,visible:i||e})};e.render=function(){var a=this,b=this.props,d=b.accessibilityCaption,e=b.className,f=b.onPhotoRendered,g=b.rich,h=b.src;b=b.srcSet;var i=this.state,k=i.isShowingIndicator;i=i.isShowingTags;d={accessibilityCaption:d,dimensions:this.props.dimensions,imgXstyle:this.props.imgXstyle,likeEventCount:this.props.likeEventCount,postId:this.props.postId};return j.jsxs("div",{className:c("joinClasses")(e,"_aa1z"+(i?" _aa1-":"")+(k?" _aa1_":"")),ref:function(b){return a.$2=b},children:[j.jsx(c("PolarisPhoto.react"),babelHelpers["extends"]({},d,{className:c("joinClasses")("_aa20",e),onClick:this.$7,onPhotoRendered:f,rich:g,src:h,srcSet:b})),this.$14(),this.$13()]})};return b}(j.Component);b.defaultProps={alwaysShowIndicator:!1};function r(a){return"usertag-"+(a&&a.user&&a.user.username)}function a(a){return{onLoggedOutIntentClickLoginModal:function(b){a(d("PolarisNavigationActions").openLoginModal("feature_wall",window.location.href,b))}}}e=d("PolarisReactRedux.react").connect(null,a)(b);g.EDGE_THRESHOLD=k;g.TAG_ORIENTATION_CHANGE_POINT=o;g.TAG_POINTER_HEIGHT=p;g.getHorizontalOffset=q;g.PhotoWithIndicator=e}),98);
__d("PolarisPoliticalContextButton.react",["IGDSBox.react","PolarisIGCoreText","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(6),d=a.className,e=a.text;a=a.textColor;var f;b[0]!==a||b[1]!==e?(f=j.jsx(c("IGDSBox.react"),{position:"relative",children:j.jsx(c("PolarisIGCoreText").BodyEmphasized,{color:a,display:"inline",zeroMargin:!0,children:e})}),b[0]=a,b[1]=e,b[2]=f):f=b[2];b[3]!==d||b[4]!==f?(a=j.jsx("div",{className:d,children:f}),b[3]=d,b[4]=f,b[5]=a):a=b[5];return a}g["default"]=a}),98);
__d("PolarisPostActionRequestSavedCollectionsForPost",["PolarisGenericStrings","PolarisInstapi"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.postId;return function(a){a({postId:b,type:"COLLECTION_IDS_FOR_POST_REQUESTED"}),d("PolarisInstapi").apiGet("/api/v1/save/media/{media_id}/saved_collections_for_media/",{path:{media_id:b}}).then(function(c){c=c.data;c=c.collection_ids;a({collectionIds:(c=c==null?void 0:c.map(function(a){return a.toString()}))!=null?c:[],postId:b,type:"COLLECTION_IDS_FOR_POST_SUCCEEDED"})})["catch"](function(){a({postId:b,toast:{text:d("PolarisGenericStrings").GENERIC_ERROR_MESSAGE},type:"COLLECTION_IDS_FOR_POST_FAILED"})})}}g.requestSavedCollectionsForPost=a}),98);
__d("XPolarisBoostControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/b/{media_id}/",Object.freeze({context:"boost_unknown"}),void 0);b=a;g["default"]=b}),98);
__d("usePolarisBoostOpenBoostFlow",["CometRelay","JSResourceForInteraction","PolarisBoostCanSkipPro2Pro","PolarisBoostQPLUtils","PolarisBoostUtils.react","PolarisNavigationUtils","PolarisPromotedPostsLogger","XPolarisBoostControllerRouteBuilder","browserHistory_DO_NOT_USE","react","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c,j=c("JSResourceForInteraction")("IGDSPro2ProDialog.react").__setRef("usePolarisBoostOpenBoostFlow");function a(){var a=i(3),b=c("useIGDSLazyDialog")(j),e=b[0],f=d("CometRelay").useRelayEnvironment();a[0]!==e||a[1]!==f?(b=function(a){var b=a.abTestingMediaIds,g=a.analyticsContext,h=a.audioSpec,i=a.boostedStatus,j=a.defaultsOverride,k=a.flowID,l=a.mediaID,m=a.overrideReturnPath,n=a.returnPathOverride;a=a.shouldLogTapEntrypoint;m=m===void 0?!1:m;a=a===void 0?!0:a;d("PolarisBoostQPLUtils").markBoostEnterFlowStart(k);var o=d("PolarisPromotedPostsLogger").getPolarisBoostEntryPointType(g),p=new(d("PolarisPromotedPostsLogger").PolarisPromotedPostsLogger)({entry_point:o,m_pk:l,promote_flow_type:d("PolarisBoostUtils.react").getIGBoostFlowTypeFromBoostedStatus(i),waterfall_id:k});a&&p.logTapEntryPoint();i=m?n:d("browserHistory_DO_NOT_USE").getURL(d("browserHistory_DO_NOT_USE").browserHistory);var q=c("XPolarisBoostControllerRouteBuilder").buildURL({ab_test_media_ids:b,audio_asset_id:(a=h==null?void 0:h.audio_asset_id)!=null?a:void 0,audio_asset_start_time_in_ms:(m=h==null?void 0:h.audio_asset_start_time_in_ms)!=null?m:void 0,audio_cluster_id:(n=h==null?void 0:h.audio_cluster_id)!=null?n:void 0,context:g,defaults_override:j,flow_id:k,media_id:l,return_path:i}).toString(),r=function(){return e({boostUri:q,entryPoint:o,flowID:k})};d("PolarisBoostCanSkipPro2Pro").getCanSkipPro2Pro(f,o,p).then(function(a){a?(p.logIpiCacheEvent("pro_identity_boost_onboarding_complete"),d("PolarisNavigationUtils").openURL(q)):r()})["catch"](r)},a[0]=e,a[1]=f,a[2]=b):b=a[2];return b}g["default"]=a}),98);
__d("PolarisPostBoostButton.react",["IGDSBox.react","IGDSButton.react","IGDSText.react","JSResourceForInteraction","PolarisBoostOkDialog.react","PolarisBoostUtils.react","PolarisBoostedStatusEnum","PolarisIGCorePressable.react","PolarisIGTheme.react","PolarisLoadingModal.react","PolarisPromotedPostsLogger","PolarisUA","qex","react","stringIsNotNullAndNotWhitespaceOnly","stylex","useIGDSLazyDialog","usePolarisBoostOpenBoostFlow","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useMemo,l=b.useState,m=c("JSResourceForInteraction")("PolarisBoostNotDeliveringDialog.react").__setRef("PolarisPostBoostButton.react"),n=c("JSResourceForInteraction")("PolarisBoostMusicErrorDialog.react").__setRef("PolarisPostBoostButton.react"),o=c("JSResourceForInteraction")("PolarisBoostMediaIneligibleErrorDialog.react").__setRef("PolarisPostBoostButton.react"),p={boostButton:{backgroundColor:"xz3rzyy",borderTopStartRadius:"xfh8nwu",borderTopEndRadius:"xoqspk4",borderBottomEndRadius:"x12v9rci",borderBottomStartRadius:"x138vmkv",bottom:"xy58vm5",paddingTop:"x1y1aw1k",paddingEnd:"x1pi30zi",paddingBottom:"xwib8y2",paddingStart:"x1swvt13",position:"x10l6tqk",":hover_backgroundColor":"xcls6s",$$css:!0},grayedOutButton:{opacity:"xbyyjgo",$$css:!0}};function a(a){var b=a.analyticsContext,e=a.boostedStatus,f=a.boostUnavailableIdentifier,g=a.boostUnavailableReason,i=a.fullWidth;i=i===void 0?!1:i;var q=a.isLink;q=q===void 0?!1:q;var r=a.isOrganicMediaArchived;r=r===void 0?!1:r;var s=a.isOverlay;s=s===void 0?!1:s;var t=a.mediaId,u=a.productType,v=a.refetch;a=l(!1);var w=a[0],x=a[1];a=c("useIGDSLazyDialog")(m,function(){return j.jsx(c("PolarisLoadingModal.react"),{})});var y=a[0];a=c("useIGDSLazyDialog")(n,function(){return j.jsx(c("PolarisLoadingModal.react"),{})});var z=a[0];a=c("useIGDSLazyDialog")(o,function(){return j.jsx(c("PolarisLoadingModal.react"),{})});var A=a[0];a=d("PolarisBoostUtils.react").getIsBoostButtonDisabledFromBoostedStatus(e);var B=c("stringIsNotNullAndNotWhitespaceOnly")(g),C=["carousel_or_image_has_non_copyright_music_eligible_by_removing","carousel_or_image_has_copyright_music_eligible_by_removing"],D=C.includes(f),E=f==="clips_has_music_with_copyright",F=function(){return E&&(c("qex")._("1445")===!0||c("qex")._("184")===!0)},G=function(){return E&&d("PolarisUA").isMobile()&&c("qex")._("1556")===!0},H=f==="low_resolution_video_eligible_for_sr",I=d("PolarisPromotedPostsLogger").getPolarisBoostEntryPointType(b),J=c("uuidv4")(),K=k(function(){return new(d("PolarisPromotedPostsLogger").PolarisPromotedPostsLogger)({entry_point:I,m_pk:t,promote_flow_type:d("PolarisBoostUtils.react").getIGBoostFlowTypeFromBoostedStatus(e),waterfall_id:J})},[e,I,t,J]),L=e===c("PolarisBoostedStatusEnum").FINISHED,M=function(){z({analyticsContext:b,flowID:J,isBoostAgain:L,logger:K,mediaId:t,musicFlow:"removeMusic",openBoostFlow:R})},N=function(){z({analyticsContext:b,flowID:J,isBoostAgain:L,logger:K,mediaId:t,musicFlow:"removeOrSwapMusic",openBoostFlow:R})},O=function(){z({analyticsContext:b,flowID:J,isBoostAgain:L,logger:K,mediaId:t,musicFlow:"swapMusic",openBoostFlow:R})},P=function(){A({analyticsContext:b,boostUnavailableReason:g,flowID:J,logger:K,productType:u})},Q=c("usePolarisBoostOpenBoostFlow")(),R=function(a){if(e===c("PolarisBoostedStatusEnum").NOT_APPROVED||e===c("PolarisBoostedStatusEnum").SCHEDULED||e===c("PolarisBoostedStatusEnum").PAUSED)d("PolarisBoostUtils.react").handleAdToolsButtonClickWithLogging(J,b);else if(e===c("PolarisBoostedStatusEnum").NOT_DELIVERING&&c("qex")._("393")===!0)y({analyticsContext:b,flowID:J,igID:t,logger:K,refetch:v});else{Q({analyticsContext:b,audioSpec:(a=a)!=null?a:void 0,boostedStatus:e,flowID:J,mediaID:t})}},S=function(){if(B)if(D)c("qex")._("563")===!0?O():c("qex")._("577")===!0?N():M();else if(G())O();else if(F())O();else if(H)R();else{var a;c("qex")._("334")===!0?P():x(!0);K.logEnterError((a=f)!=null?a:"",(a=g)!=null?a:"","no_permission")}else R()};C=B&&!D&&!E&&!H;var T=d("PolarisIGTheme.react").useTheme().getTheme()===d("PolarisIGTheme.react").IGTheme.Dark;r=d("PolarisBoostUtils.react").getBoostButtonCTAFromBoostedStatus(e,r,u);w=w&&g!=null&&j.jsx(c("PolarisBoostOkDialog.react"),{body:g,onPress:function(){x(!1)},title:d("PolarisBoostUtils.react").BOOST_UNAVAILABLE_TEXT});return j.jsx(j.Fragment,{children:s?j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisIGCorePressable.react"),{disabled:a||C,onPress:function(a){S(),a.stopPropagation(),a.preventDefault()},children:j.jsx(c("IGDSBox.react"),{alignItems:"center",justifyContent:"center",width:"100%",children:j.jsx("div",{className:(h||(h=c("stylex")))([p.boostButton,C&&p.grayedOutButton]),children:j.jsx(c("IGDSText.react"),{color:"webAlwaysBlack",size:"label",weight:"semibold",zeroMargin:!0,children:r})})})}),w]}):j.jsxs(c("IGDSBox.react"),{alignItems:"end",direction:"column",width:i?"100%":void 0,children:[j.jsx(c("IGDSButton.react"),{"data-testid":void 0,fullWidth:i,isDisabled:a,label:r,onClick:S,variant:d("PolarisBoostUtils.react").getBoostButtonVariantFromBoostedStatus(e,q,T),xstyle:C?p.grayedOutButton:void 0}),w]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PolarisPostFastCommentPrimitive.react",["IGDSBox.react","IGDSVerifiedBadge.react","PolarisConfig","PolarisIGCoreText","PolarisTruncatedText.react","PolarisUserLinkWithHoverCard.react","react","usePolarisAnalyticsContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(13),e=a.isAuthorUnpublished,f=a.isAuthorVerified,g=a.isCaption,h=a.onMoreClick,k=a.text,l=a.userId;a=a.username;e=e===void 0?!1:e;f=f===void 0?!1:f;g=g===void 0?!1:g;var m=c("usePolarisAnalyticsContext")(),n;b[0]!==e||b[1]!==l||b[2]!==a||b[3]!==f?(n=e===!0?null:j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisUserLinkWithHoverCard.react"),{color:"ig-primary-text",userId:l,username:a}),f&&j.jsx(c("IGDSBox.react"),{display:"inlineBlock",marginStart:1,position:"relative",children:j.jsx(c("IGDSVerifiedBadge.react"),{size:"small"})}),j.jsx(c("PolarisIGCoreText"),{display:"inline",zeroMargin:!0,children:"\xa0"})]}),b[0]=e,b[1]=l,b[2]=a,b[3]=f,b[4]=n):n=b[4];e=n;b[5]!==g||b[6]!==m||b[7]!==k||b[8]!==h?(l=!d("PolarisConfig").isLoggedIn()&&g===!1?j.jsx(c("PolarisTruncatedText.react"),{analyticsContext:m,isCaption:g,limit:40,value:k}):j.jsx(c("PolarisTruncatedText.react"),{analyticsContext:m,isCaption:g,onMoreClick:h,value:k}),b[5]=g,b[6]=m,b[7]=k,b[8]=h,b[9]=l):l=b[9];b[10]!==e||b[11]!==l?(a=j.jsxs(c("IGDSBox.react"),{"data-testid":void 0,display:"block",flex:"grow",position:"relative",children:[e,l]}),b[10]=e,b[11]=l,b[12]=a):a=b[12];return a}g["default"]=a}),98);
__d("PolarisPostFastCrawlerComment.react",["IGDSBox.react","IGDSVerifiedBadge.react","PolarisIGCoreText","PolarisLineClampText.react","PolarisUserLinkWithHoverCard.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(8),d=a.isAuthorUnpublished,e=a.isAuthorVerified,f=a.text,g=a.userId;a=a.username;d=d===void 0?!1:d;e=e===void 0?!1:e;var h;b[0]!==d||b[1]!==g||b[2]!==a||b[3]!==e?(h=d===!0?null:j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisUserLinkWithHoverCard.react"),{color:"ig-primary-text",userId:g,username:a}),e&&j.jsx(c("IGDSBox.react"),{display:"inlineBlock",marginStart:1,position:"relative",children:j.jsx(c("IGDSVerifiedBadge.react"),{size:"small"})}),j.jsx(c("PolarisIGCoreText"),{display:"inline",zeroMargin:!0,children:"\xa0"})]}),b[0]=d,b[1]=g,b[2]=a,b[3]=e,b[4]=h):h=b[4];d=h;b[5]!==d||b[6]!==f?(g=j.jsx(c("IGDSBox.react"),{"data-testid":void 0,display:"block",flex:"grow",position:"relative",children:j.jsx(c("PolarisLineClampText.react"),{prependElement:d,value:f})}),b[5]=d,b[6]=f,b[7]=g):g=b[7];return g}g["default"]=a}),98);
__d("PolarisPostImpressionTrackingNode.react",["PolarisPCManagerContext.react","react","usePartialViewImpression"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.c,l=4;function m(a){return("0"+parseInt(a,16).toString()).slice(-2)}function n(a){if(a.charAt(0)==="#")return a;a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return a===null?null:"#"+m(a[1])+m(a[2])+m(a[3])}function a(a){var b=k(11),d=a.carouselInfo,e=a.children,f=a.childrenRef,g=a.componentType,h=a.elementId,m=a.numCarouselCards,o=a.trackingNode,p=j(c("PolarisPCManagerContext.react"));b[0]!==p||b[1]!==f.current||b[2]!==g||b[3]!==o||b[4]!==d||b[5]!==m||b[6]!==h?(a={onImpressionStart:function(){if(p==null||f.current==null)return;var a=f.current.getBoundingClientRect(),b=a.height,c=a.width,e=a.x;a=a.y;b={component_type:g,height:b,view_rendering_component_type:"react",view_tracking_node_name:o,width:c,x_pos:e,y_pos:a};if(g==="image"){e=(c=f.current)==null?void 0:c.querySelector("img");a=e==null?void 0:e.src;c=e==null?void 0:e.complete;d!=null&&(b=babelHelpers["extends"]({},b,d));b=babelHelpers["extends"]({},b,{has_fully_rendered:c,media_urls:a})}else if(g==="video"){c=(e=f.current)==null?void 0:e.querySelector("video");a=c==null?void 0:c.src;e=c==null?void 0:c.duration;c=(c==null?void 0:c.readyState)===l;d!=null&&(b=babelHelpers["extends"]({},b,d));b=babelHelpers["extends"]({},b,{has_fully_rendered:c,media_urls:a,video_duration_sec:e})}else if(g==="text"){c=window.getComputedStyle(f.current,null);a=parseInt(c.getPropertyValue("font-size"),10).toString();e=(e=f.current)==null?void 0:e.innerText;var i=parseInt(c.getPropertyValue("line-height"),10);c=n(c.getPropertyValue("color"));b=babelHelpers["extends"]({},b,{font_line_height:i,font_size:a,text_color:c,text_string:e})}else g==="carousel"&&(b=babelHelpers["extends"]({},b,{number_of_cards:String(m)}));p.setComponentData(o,h,b)}},b[0]=p,b[1]=f.current,b[2]=g,b[3]=o,b[4]=d,b[5]=m,b[6]=h,b[7]=a):a=b[7];a=c("usePartialViewImpression")(a);var q;b[8]!==a||b[9]!==e?(q=i.jsx("div",{ref:a,children:e}),b[8]=a,b[9]=e,b[10]=q):q=b[10];return q}g["default"]=a}),98);
__d("usePolarisTrackingDataURLParams",["PolarisTrackingCodeContext","PolarisTrackingConstants","PolarisTrackingNodesContext","encodeTrackingNode","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.c;function a(){var a=j(8),b=i(c("PolarisTrackingCodeContext")),e=i(c("PolarisTrackingNodesContext"));if(b.length===0||e.length===0){var f;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={},a[0]=f):f=a[0];return f}a[1]!==e?(f=e.map(l).join(""),a[1]=e,a[2]=f):f=a[2];e=f;a[3]!==b?(f=b.map(k),a[3]=b,a[4]=f):f=a[4];b=f;if(a[5]!==b||a[6]!==e){f=(f={},f[d("PolarisTrackingConstants").TRACKING_CODE_PARAM]=b,f[d("PolarisTrackingConstants").TRACKING_NODE_PARAM]=e,f);a[5]=b;a[6]=e;a[7]=f}else f=a[7];return f}function k(a){return(a=a==null?void 0:a.trackingToken)!=null?a:""}function l(a){return c("encodeTrackingNode")(a.type)}g["default"]=a}),98);
__d("usePolarisOffsiteTrackingDataURLParams",["isPolarisAdLink","react","usePolarisTrackingDataURLParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a){var b=i(1),d=c("usePolarisTrackingDataURLParams")();if(a==null||!c("isPolarisAdLink")(a)){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={},b[0]=a):a=b[0];return a}return d}g["default"]=a}),98);
__d("PolarisPostFooterCTA.react",["cx","IGDSBox.react","IGDSChevronIcon.react","PolarisAdsGatingHelpers","PolarisExternalLink.react","PolarisGenericStrings","PolarisIGCoreButton.react","PolarisIGCoreText","PolarisIGTheme.react","PolarisPostImpressionTrackingNode.react","PolarisPostUtils","PolarisUA","isStringNullOrEmpty","react","useMergeRefs","usePolarisOffsiteTrackingDataURLParams"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useRef,l=b.c;e=j.forwardRef(a);function a(a,b){var e=l(69),f=a.ctaAdditionalAnimation,g=a.ctaDominantColor,h=a["data-testid"],i=a.disableAnimation,m=a.externalURL,n=a.forceBottomBorder,o=a.fullWidth,p=a.height,q=a.icon,r=a.isActive,s=a.isForAd,t=a.isForPersistentCta,u=a.isForSidecar,v=a.leadGenFormID,w=a.onClick,x=a.secondaryText,y=a.showChevron,z=a.showRoundedBorder,A=a.text,B=a.textAlign;a=a.textThemedColor;f=f===void 0?d("PolarisPostUtils").PostFooterCTAAnimationStyle.NONE:f;y=y===void 0?!1:y;z=z===void 0?!1:z;B=B===void 0?"center":B;var C=d("PolarisIGTheme.react").useTheme(),D;e[0]!==g?(D=g!=null&&d("PolarisAdsGatingHelpers").allowWebAds(),e[0]=g,e[1]=D):D=e[1];D=D;var E;e[2]!==q?(E=q!=null?j.jsxs(j.Fragment,{children:[j.jsx(c("IGDSBox.react"),{"data-testid":void 0,flex:"none",position:"relative",children:q}),j.jsx(c("IGDSBox.react"),{marginEnd:3,position:"relative"})]}):null,e[2]=q,e[3]=E):E=e[3];q=E;e[4]!==D||e[5]!==A?(E=D?j.jsx("span",{className:"x9bdzbf",children:A}):j.jsx(j.Fragment,{children:A}),e[4]=D,e[5]=A,e[6]=E):E=e[6];A=E;E=D?"web-always-white":(E=a)!=null?E:"ig-primary-text";var F;e[7]!==y||e[8]!==E?(F=y?j.jsxs(j.Fragment,{children:[j.jsx(c("IGDSBox.react"),{flex:"grow",height:"100%",marginEnd:7,position:"relative",right:!0}),j.jsx(c("IGDSChevronIcon.react"),{alt:d("PolarisGenericStrings").RIGHT_CHEVRON,color:E,"data-testid":void 0,direction:"next",size:16})]}):null,e[7]=y,e[8]=E,e[9]=F):F=e[9];y=F;E=C.getTheme()===d("PolarisIGTheme.react").IGTheme.Dark?a==null?void 0:a.dark:a==null?void 0:a.light;if(E!=null){e[10]!==E?(F={color:E},e[10]=E,e[11]=F):F=e[11];e[12]!==F||e[13]!==A?(C=j.jsx("span",{style:F,children:A}),e[12]=F,e[13]=A,e[14]=C):C=e[14];A=C}a=null;if(!c("isStringNullOrEmpty")(x)){e[15]!==B||e[16]!==x?(E=j.jsx(c("IGDSBox.react"),{marginTop:2,position:"relative",children:j.jsx(c("PolarisIGCoreText").Body2,{color:"ig-secondary-text",textAlign:B,children:x})}),e[15]=B,e[16]=x,e[17]=E):E=e[17];a=E}F="_aarz"+(r&&!t?" _aar-":"")+(t?" _alv8":"")+(i?"":" _aar_")+(D?" _aceq":"");e[18]!==D||e[19]!==g?(C=D?{background:g}:null,e[18]=D,e[19]=g,e[20]=C):C=e[20];e[21]!==B||e[22]!==A?(x=j.jsx(c("PolarisIGCoreText"),{size:"body",textAlign:B,weight:"semibold",children:A}),e[21]=B,e[22]=A,e[23]=x):x=e[23];e[24]!==x||e[25]!==a?(E=j.jsxs(c("IGDSBox.react"),{flex:"shrink",position:"relative",children:[x,a]}),e[24]=x,e[25]=a,e[26]=E):E=e[26];e[27]!==q||e[28]!==E||e[29]!==y?(i=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",justifyContent:"start",position:"relative",width:"100%",children:[q,E,y]}),e[27]=q,e[28]=E,e[29]=y,e[30]=i):i=e[30];e[31]!==F||e[32]!==C||e[33]!==i?(g=j.jsx("div",{className:F,"data-testid":void 0,style:C,children:i}),e[31]=F,e[32]=C,e[33]=i,e[34]=g):g=e[34];B=g;A=c("usePolarisOffsiteTrackingDataURLParams")(m);if(m!=null){e[35]!==m||e[36]!==v||e[37]!==w||e[38]!==A||e[39]!==B?(x=j.jsx(c("PolarisExternalLink.react"),{className:"_ad63","data-testid":void 0,href:m,leadGenFormID:v,onClick:w,queryParams:A,children:B}),e[35]=m,e[36]=v,e[37]=w,e[38]=A,e[39]=B,e[40]=x):x=e[40];B=x}else if(w!=null){e[41]===Symbol["for"]("react.memo_cache_sentinel")?(a={__className:"_ad63"},e[41]=a):a=e[41];e[42]!==w?(q=function(){return w()},e[42]=w,e[43]=q):q=e[43];e[44]!==q||e[45]!==B?(E=j.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,dangerouslySetClassName:a,onClick:q,children:B}),e[44]=q,e[45]=B,e[46]=E):E=e[46];B=E}y=u!==!0&&s!==!0;e[47]===Symbol["for"]("react.memo_cache_sentinel")?(F=d("PolarisUA").isDesktop(),e[47]=F):F=e[47];C=F;e[48]!==n?(i=(n===!0||d("PolarisUA").isMobile())&&!C,e[48]=n,e[49]=i):i=e[49];g=i;m=k(null);v=c("useMergeRefs")(b,m);A="_aart"+(r?" _aaru":"")+(t?" _alv9":"")+(u===!0?" _aarv":"")+(o===!0?" _aarw":"")+(o===!0&&n===!0?" _aarx":"")+(C&&!D?" _ai7q":"")+(z?" _alva":"")+(z&&!t?" _aikk":"")+(f===d("PolarisPostUtils").PostFooterCTAAnimationStyle.POP_IN?" _alwd":"")+(f===d("PolarisPostUtils").PostFooterCTAAnimationStyle.SLIDE_UP?" _al_y":"");e[50]!==p?(x=p!=null?{height:p+"px"}:{},e[50]=p,e[51]=x):x=e[51];a=r&&y?"_aary":"";e[52]!==a?(q=j.jsx("div",{className:a}),e[52]=a,e[53]=q):q=e[53];e[54]!==g||e[55]!==n||e[56]!==o||e[57]!==r?(E=g&&j.jsx("div",{className:"_aas0"+(n===!0&&o===!0?" _aas1":""),children:j.jsx("div",{className:r?"_aary":""})}),e[54]=g,e[55]=n,e[56]=o,e[57]=r,e[58]=E):E=e[58];e[59]!==A||e[60]!==h||e[61]!==v||e[62]!==x||e[63]!==q||e[64]!==B||e[65]!==E?(s=j.jsxs("div",{className:A,"data-testid":void 0,ref:v,style:x,children:[q,B,E]}),e[59]=A,e[60]=h,e[61]=v,e[62]=x,e[63]=q,e[64]=B,e[65]=E,e[66]=s):s=e[66];F=s;if(d("PolarisAdsGatingHelpers").enableFeedPostImpressionLogging()){e[67]!==F?(i=j.jsx(c("PolarisPostImpressionTrackingNode.react"),{childrenRef:m,componentType:"text",elementId:"ctaText",trackingNode:"CTA",children:F}),e[67]=F,e[68]=i):i=e[68];return i}return F}f=e;g["default"]=f}),98);
__d("PolarisSponsoredLabel.react",["GHLRandomElementWrapper","GHLSVGText.react","PolarisAdBlockerMitigationGatingHelpers","PolarisAdsGatingHelpers","PolarisPostImpressionTrackingNode.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useRef,l=b.c,m={root:{color:"x5n08af",fontSize:"x1fhwpqd",lineHeight:"x132q4wb",$$css:!0}};function a(a){var b=l(14),e=a["data-testid"],f=a.label;a=a.xstyle;var g;b[0]!==f?(g=d("PolarisAdBlockerMitigationGatingHelpers").shouldUseSVGTextMitigation()===!0?j.jsx(c("GHLSVGText.react"),{fontSize:"12",text:f.toString()}):f,b[0]=f,b[1]=g):g=b[1];b[2]!==g?(f=j.jsx(j.Fragment,{children:g}),b[2]=g,b[3]=f):f=b[3];g=f;f=k(null);var i;b[4]!==a?(i=(h||(h=c("stylex")))(m.root,a),b[4]=a,b[5]=i):i=b[5];e=(a=e)!=null?a:"sponsored-label";b[6]!==g?(a=d("PolarisAdBlockerMitigationGatingHelpers").shouldUseRandomElementWrapper()===!0?j.jsx(c("GHLRandomElementWrapper"),{elementTag:"randomSpan",children:g}):g,b[6]=g,b[7]=a):a=b[7];b[8]!==i||b[9]!==e||b[10]!==a?(g=j.jsx("span",{className:i,"data-testid":void 0,children:a}),b[8]=i,b[9]=e,b[10]=a,b[11]=g):g=b[11];i=g;if(d("PolarisAdsGatingHelpers").enableFeedPostImpressionLogging()){b[12]!==i?(e=j.jsx(c("PolarisPostImpressionTrackingNode.react"),{childrenRef:f,componentType:"text",elementId:"sponsoredLabel",trackingNode:"SPONSORED_LABEL",children:j.jsx("div",{ref:f,children:i})}),b[12]=i,b[13]=e):e=b[13];return e}return i}g["default"]=a}),98);
__d("PolarisSponsorsUnit.react",["fbt","IGDSText.react","IgBrandedContentEventFalcoEvent","PolarisEngagementLogger","PolarisUserLink.react","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useEffect,m=b.c,n={white:{color:"x1mzvbuk",fontSize:"x1pg5gke",lineHeight:"x152skdk",":visited_color":"x1dorbz4",":visited_fontSize":"x1tb0csp",":visited_lineHeight":"x19wia3t",$$css:!0}};function a(a){var b=a.color,d=b===void 0?"primary":b,e=a.loggingData;b=a.maxLines;var f=a.size,g=f===void 0?"body":f,i=a.source,j=a.sponsors;f=j.map(function(a){return k.jsx(o,{color:d,loggingData:e,size:g,sponsor:a},a.id)});l(function(){c("IgBrandedContentEventFalcoEvent").log(function(){var a;return{event_name:"paid_partnership_label_impression",event_source:i,media_id:e==null?void 0:e.mediaId,sponsor_ig_id:(a=j[0])==null?void 0:a.id}})},[]);var m;switch(f.length){case 0:m=h._("__JHASH__VPqAlnaM-JA__JHASH__");break;case 1:m=h._("__JHASH__j3UmEJ9LLZf__JHASH__",[h._param("username of sponsor",f[0])]);break;case 2:default:m=h._("__JHASH__o5bPUTVBTId__JHASH__",[h._param("username of sponsor 1",f[0]),h._param("username of sponsor 2",f[1])]);break}return k.jsx(c("IGDSText.react"),{color:d==="white"?"textOnMedia":"primaryText",maxLines:b,size:g,testid:void 0,children:m})}a.displayName=a.name+" [from "+f.id+"]";function o(a){var b=m(8),d=a.color,e=a.loggingData,f=a.size;a=a.sponsor;var g=d==="white"&&n.white,h;b[0]!==g?(h=(i||(i=c("stylex")))(g),b[0]=g,b[1]=h):h=b[1];g=d==="white"?"ig-text-on-media":void 0;d=e!=null?p:void 0;b[2]!==h||b[3]!==g||b[4]!==d||b[5]!==f||b[6]!==a.username?(e=k.jsx(c("PolarisUserLink.react"),{className:h,color:g,onClick:d,size:f,username:a.username}),b[2]=h,b[3]=g,b[4]=d,b[5]=f,b[6]=a.username,b[7]=e):e=b[7];return e}function p(){return d("PolarisEngagementLogger").logOrganicBrandProfile()}g["default"]=a}),226);
__d("PolarisPostHeader.react",["cx","fbt","IGDSBox.react","IGDSMiddleDot.react","IGDSText.react","IGDSVerifiedBadge.react","PolarisAppAttributionText.react","PolarisAudioAttributionText.react","PolarisAvatarWithStoriesContainer.react","PolarisClickEventLoggerProvider.react","PolarisClipsHelpers","PolarisCloseFriendsLabel.react","PolarisCoauthorCountWithSheet.react","PolarisEligibleForCommissionUnit.react","PolarisFeedPageConstants","PolarisFollowButtonContainer.react","PolarisHashtagLink.react","PolarisIGCoreButton.react","PolarisIGCoreText","PolarisLinkBuilder","PolarisLocationLink.react","PolarisPanavisionQEHelpers","PolarisPartnershipAdAvatar.react","PolarisPartnershipAdHeader.react","PolarisProfileClickEventLoggerProvider.react","PolarisReactRedux.react","PolarisSponsoredLabel.react","PolarisSponsoredPostContext.react","PolarisSponsorsUnit.react","PolarisTagAvatar.react","PolarisTimestamp.react","PolarisTrackingNodeProvider.react","PolarisTransparencyLabel.react","PolarisTransparencyUtils.react","PolarisUA","PolarisUserAvatar.react","PolarisUserAvatarWithStories.react","PolarisUserHoverCard.react","PolarisUserLink.react","URI","err","gkx","nullthrows","qex","react","react-forget-runtime","usePolarisIsOnAdsActivityPage","usePolarisIsOnFeedPage","usePolarisTrackingDataProfileURLParams"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l=k||(k=d("react"));b=k;var m=b.useContext,n=b.useEffect,o=b.useState,p=b.c,q=i._("__JHASH__OMxqSO8Gxcr__JHASH__");function r(a,b){a=a;var c=a==null?void 0:a.song_name,d=a==null?void 0:a.artist_name;b=(a==null?void 0:a.uses_original_audio)&&b===a.artist_name;return{audioArtist:d,audioName:c,isMediaOwnerOriginalSound:b}}function s(a){var b=p(8);a=a.owner;var e=d("usePolarisTrackingDataProfileURLParams").usePolarisTrackingDataProfileURLParams(m(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext).canUserSeePersistentCta),f;b[0]!==a.username||b[1]!==e?(f=new(j||(j=c("URI")))(d("PolarisLinkBuilder").buildUserLink(c("nullthrows")(a.username))).setQueryData(e).toString(),b[0]=a.username,b[1]=e,b[2]=f):f=b[2];e=f;b[3]!==a.username?(f=c("nullthrows")(a.username),b[3]=a.username,b[4]=f):f=b[4];b[5]!==e||b[6]!==f?(a=l.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,color:"ig-secondary-button",href:e,children:f}),b[5]=e,b[6]=f,b[7]=a):a=b[7];return a}function t(a){var b=p(12),d=a.clipsAudioAttributionInfo,e=a.onDisabledClipsAudioAttributionClick;a=a.owner;d=d;var f;b[0]!==d||b[1]!==a.username?(f=r(d,a.username),b[0]=d,b[1]=a.username,b[2]=f):f=b[2];f=f;var g=f.audioArtist,h=f.audioName;f=f.isMediaOwnerOriginalSound;var i=d==null?void 0:d.audio_id;a=a.isPrivate===!0;var j=(d==null?void 0:d.should_mute_audio)===!0;d=d==null?void 0:d.should_mute_audio_reason;var k;b[3]!==g||b[4]!==i||b[5]!==h||b[6]!==f||b[7]!==j||b[8]!==a||b[9]!==d||b[10]!==e?(k=l.jsx(c("PolarisAudioAttributionText.react"),{audioArtist:g,audioID:i,audioName:h,isMediaOwnerOriginalSound:f,isMutedAudio:j,isOwnerPrivate:a,muteAudioReason:d,onDisabledClipsAudioAttributionClick:e}),b[3]=g,b[4]=i,b[5]=h,b[6]=f,b[7]=j,b[8]=a,b[9]=d,b[10]=e,b[11]=k):k=b[11];return k}function u(a){var b=p(6),d=a.clipsAttributionInfo;a=a.mediaID;d=d;var e=d==null?void 0:d.attribution_app_name;d=d==null?void 0:d.attribution_app_id;if(e!=null&&d!=null){var f;b[0]!==d?(f=d.toString(),b[0]=d,b[1]=f):f=b[1];b[2]!==f||b[3]!==e||b[4]!==a?(d=l.jsx(c("PolarisAppAttributionText.react"),{appId:f,appName:e,mediaId:a}),b[2]=f,b[3]=e,b[4]=a,b[5]=d):d=b[5];return d}return null}function v(a){var b=p(56),e=a.audioAttributionText,f=a.clipsAttributionInfo,g=a.clipsAudioAttributionInfo,h=a.followHashtagInfo,i=a.isSponsored,j=a.location,k=a.mediaId,m=a.owner,n=a.showEligibleForCommissions,o=a.showOrganicPPL,q=a.sponsoredLabel,s=a.sponsors;a=a.transparencyLabelOwner;var t=c("usePolarisIsOnAdsActivityPage")(),v;b[0]!==a||b[1]!==k?(v=a!=null&&d("PolarisTransparencyUtils.react").shouldShowTransparencyLabel(a)&&a.transparencyProductEnabled===!0&&l.jsx(c("PolarisTransparencyLabel.react"),{mediaId:k,screen:"feed",user:a}),b[0]=a,b[1]=k,b[2]=v):v=b[2];a=v;b[3]!==o||b[4]!==k||b[5]!==s?(v=o&&l.jsx(c("PolarisSponsorsUnit.react"),{loggingData:{mediaId:k},source:"feed_timeline",sponsors:s||[]}),b[3]=o,b[4]=k,b[5]=s,b[6]=v):v=b[6];o=v;b[7]!==h||b[8]!==m?(s=h&&l.jsx(c("PolarisUserLink.react"),{className:"_adkn",username:c("nullthrows")(m.username)}),b[7]=h,b[8]=m,b[9]=s):s=b[9];v=s;b[10]!==n?(h=n&&l.jsx(c("PolarisEligibleForCommissionUnit.react"),{}),b[10]=n,b[11]=h):h=b[11];s=h;b[12]!==j?(n=j&&l.jsx(c("PolarisIGCoreText").Body2,{color:"ig-secondary-text",display:"truncated",zeroMargin:!0,children:l.jsx(c("PolarisLocationLink.react"),{className:"_aaqk",location:c("nullthrows")(j)})}),b[12]=j,b[13]=n):n=b[13];h=n;var w;if(b[14]!==g||b[15]!==m.username||b[16]!==f||b[17]!==k||b[18]!==i||b[19]!==q||b[20]!==t||b[21]!==a||b[22]!==o||b[23]!==s||b[24]!==v||b[25]!==e||b[26]!==h){j=r(g,m.username);b[32]!==f||b[33]!==k?(n=l.jsx(u,{clipsAttributionInfo:f,mediaID:k}),b[32]=f,b[33]=k,b[34]=n):n=b[34];n=n;if(i===!0&&q==null&&!t)throw c("err")("Unexpected: a feed ad is being rendered without a sponsored label");w="_aaql";var x;b[35]===Symbol["for"]("react.memo_cache_sentinel")?(x="x78zum5 xdt5ytf",b[35]=x):x=b[35];var y;b[36]!==q?(y=q!=null&&l.jsx(c("PolarisSponsoredLabel.react"),{label:q}),b[36]=q,b[37]=y):y=b[37];b[38]!==a||b[39]!==o||b[40]!==y||b[41]!==s||b[42]!==v?(x=l.jsx(c("IGDSText.react").Body2,{zeroMargin:!0,children:l.jsxs("div",{className:x,children:[a,o,y,s,v]})}),b[38]=a,b[39]=o,b[40]=y,b[41]=s,b[42]=v,b[43]=x):x=b[43];b[44]===Symbol["for"]("react.memo_cache_sentinel")?(y="x78zum5",b[44]=y):y=b[44];j=d("PolarisClipsHelpers").hasAudioAttributionText(j)?e:l.jsx("div",{className:"_aaqm",children:h});b[14]=g;b[15]=m.username;b[16]=f;b[17]=k;b[18]=i;b[19]=q;b[20]=t;b[21]=a;b[22]=o;b[23]=s;b[24]=v;b[25]=e;b[26]=h;b[27]=y;b[28]=j;b[29]=n;b[30]=w;b[31]=x}else y=b[27],j=b[28],n=b[29],w=b[30],x=b[31];b[45]!==f?(g=f!=null&&l.jsx(c("IGDSMiddleDot.react"),{color:"primaryText"}),b[45]=f,b[46]=g):g=b[46];b[47]!==y||b[48]!==j||b[49]!==g||b[50]!==n?(m=l.jsxs("div",{className:y,children:[j,g,n]}),b[47]=y,b[48]=j,b[49]=g,b[50]=n,b[51]=m):m=b[51];b[52]!==w||b[53]!==x||b[54]!==m?(k=l.jsxs("div",{className:w,children:[x,m]}),b[52]=w,b[53]=x,b[54]=m,b[55]=k):k=b[55];return k}function w(a){var b=p(44),e=a.analyticsContext,f=a.coauthorProducers,g=a.followHashtagInfo,h=a.headerAvatarSize,i=a.isPartnershipAd,j=a.isTagAvatarLink,k=a.onTagAvatarShowRing,m=a.owner;a=a.sponsors;var n;b[0]!==e?(n=function(){return e===d("PolarisFeedPageConstants").FEED_PAGE_ANALYTICS_CONTEXT?"reel_feed_timeline_item_header":"reel_feed_timeline"},b[0]=e,b[1]=n):n=b[1];n=n;if(g){var o=g.name;g=g.profile_pic_url;var q;b[2]!==g||b[3]!==j||b[4]!==o?(q=g!=null&&g.length>0&&l.jsx(c("PolarisTagAvatar.react"),{isLink:j,profilePictureUrl:g,tagName:o}),b[2]=g,b[3]=j,b[4]=o,b[5]=q):q=b[5];b[6]===Symbol["for"]("react.memo_cache_sentinel")?(g=l.jsx("div",{className:"_aaqo",children:"#"}),b[6]=g):g=b[6];b[7]!==q?(j=l.jsxs(l.Fragment,{children:[q,g]}),b[7]=q,b[8]=j):j=b[8];b[9]!==k||b[10]!==o||b[11]!==j?(g=l.jsx(c("PolarisAvatarWithStoriesContainer.react"),{animateOnLoad:!0,entrypoint:"reel_feed_timeline",onShowRing:k,size:30,tagName:o,children:j}),b[9]=k,b[10]=o,b[11]=j,b[12]=g):g=b[12];return g}if(f==null?void 0:f.length){q=f[0];b[13]!==q.profilePictureUrl||b[14]!==q.username?(k=l.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:q.profilePictureUrl,size:24,username:q.username}),b[13]=q.profilePictureUrl,b[14]=q.username,b[15]=k):k=b[15];b[16]===Symbol["for"]("react.memo_cache_sentinel")?(o="x1qjc9v5 xvbhtw8 x14yjl9h xudhj91 x18nykt9 xww2gxu x972fbf xcfux6l x1qhh985 xm0m39n x9f619 x78zum5 xdt5ytf x2lah0s xk390pu x1923su1 xdj266r x11i5rnm xat24cr x1mh8g0r x4p5aij x19um543 x1j85h84 x1m6msm x10l6tqk xfr5jun x11njtxf",b[16]=o):o=b[16];b[17]!==m.profilePictureUrl||b[18]!==m.username?(j=l.jsx("div",{className:o,children:l.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",justifyContent:"start",children:l.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:m.profilePictureUrl,size:24,username:m.username})})}),b[17]=m.profilePictureUrl,b[18]=m.username,b[19]=j):j=b[19];b[20]!==k||b[21]!==j?(g=l.jsxs(c("IGDSBox.react"),{alignItems:"end",height:32,position:"relative",width:32,children:[k,j]}),b[20]=k,b[21]=j,b[22]=g):g=b[22];return g}if(c("gkx")("5712")&&i&&(a==null?void 0:a.length)===1){f=m.fullName||"";q=m.isUnpublished||!1;o=m.profilePictureUrl||"";k=m.username||"";b[23]!==f||b[24]!==m.id||b[25]!==q||b[26]!==o||b[27]!==k?(j={full_name:f,id:m.id,is_unpublished:q,profile_pic_url:o,username:k},b[23]=f,b[24]=m.id,b[25]=q,b[26]=o,b[27]=k,b[28]=j):j=b[28];g=j;i=a[0];b[29]!==g||b[30]!==i?(f=l.jsx(c("PolarisPartnershipAdAvatar.react"),{firstIdentity:g,secondIdentity:i}),b[29]=g,b[30]=i,b[31]=f):f=b[31];return f}q=!m.isUnpublished;o=m.id;j=(k=m.username)!=null?k:"";a="_aaqq";g=!m.isUnpublished;i=m.profilePictureUrl;f=n();b[32]!==g||b[33]!==m.profilePictureUrl||b[34]!==m.id||b[35]!==m.username||b[36]!==h||b[37]!==f?(k=l.jsx(c("PolarisUserAvatarWithStories.react"),{className:a,isLink:g,profilePictureUrl:i,showRingWhenSeen:!1,size:h,storyEntrypoint:f,userId:m.id,username:m.username}),b[32]=g,b[33]=m.profilePictureUrl,b[34]=m.id,b[35]=m.username,b[36]=h,b[37]=f,b[38]=k):k=b[38];b[39]!==q||b[40]!==m.id||b[41]!==j||b[42]!==k?(n=l.jsx(c("PolarisUserHoverCard.react"),{display:"block",isUserAvailable:q,userId:o,username:j,children:k}),b[39]=q,b[40]=m.id,b[41]=j,b[42]=k,b[43]=n):n=b[43];return n}function x(a){var b=p(63),e=a.adTitle,f=a.analyticsContext,g=a.coauthorProducers,h=a.followHashtagInfo,i=a.mediaId,j=a.owner,k=a.postHeaderMode,m=a.showVerifiedBadge;a=a.sponsors;var o=d("PolarisReactRedux.react").useDispatch(),r,t;b[0]!==g||b[1]!==o?(r=function(){var a;a=[].concat((a=g)!=null?a:[]);o({type:"PROFILE_PAGE_USERS_LOADED",users:a})},t=[o,g],b[0]=g,b[1]=o,b[2]=r,b[3]=t):(r=b[2],t=b[3]);n(r,t);if(h){b[4]!==h.name?(r=l.jsx(c("IGDSText.react").Body,{zeroMargin:!0,children:l.jsx(c("PolarisHashtagLink.react"),{className:"_aaqr",tag:h.name})}),b[4]=h.name,b[5]=r):r=b[5];return r}if(c("gkx")("5712")&&k.PartnershipAd){if((a==null?void 0:a.length)!==1)return null;t=j.fullName||"";h=j.isUnpublished||!1;r=j.profilePictureUrl||"";var u=j.username||"",v;b[6]!==t||b[7]!==j.id||b[8]!==h||b[9]!==r||b[10]!==u?(v={full_name:t,id:j.id,is_unpublished:h,profile_pic_url:r,username:u},b[6]=t,b[7]=j.id,b[8]=h,b[9]=r,b[10]=u,b[11]=v):v=b[11];t=v;h=a[0];b[12]!==t||b[13]!==h?(r=l.jsx(c("PolarisPartnershipAdHeader.react"),{firstIdentity:t,secondIdentity:h}),b[12]=t,b[13]=h,b[14]=r):r=b[14];return r}if(j.isUnpublished===!0){if(e!=null&&e.trim().length!==0){b[15]!==e?(u=l.jsx(c("IGDSText.react").BodyEmphasized,{color:"secondaryText",zeroMargin:!0,children:l.jsx("span",{className:"_aaqs",children:e})}),b[15]=e,b[16]=u):u=b[16];return u}v=j.fullName!=null&&j.fullName!==""?j.fullName:j.username;b[17]!==v?(a=l.jsx(c("IGDSText.react").BodyEmphasized,{color:"secondaryText",zeroMargin:!0,children:l.jsx("span",{className:"_aaqs",children:v})}),b[17]=v,b[18]=a):a=b[18];return a}if(k.DisplayFBPage===!0&&(e!=null&&e.trim().length!==0)){b[19]!==e?(t=l.jsx(c("IGDSText.react").BodyEmphasized,{color:"secondaryText",zeroMargin:!0,children:l.jsx("span",{className:"_aaqs",children:e})}),b[19]=e,b[20]=t):t=b[20];return t}if(g==null?void 0:g.length){if(b[21]!==g){r=(h=g)!=null?h:[];b[21]=g;b[22]=r}else r=b[22];b[23]!==r?(u=r.map(y),b[23]=r,b[24]=u):u=b[24];v=u;k=(a=j.fullName)!=null?a:"";t=(e=j.isVerified)!=null?e:!1;r=(h=j.profilePictureUrl)!=null?h:"";a=(u=j.username)!=null?u:"";b[25]!==k||b[26]!==j.id||b[27]!==t||b[28]!==r||b[29]!==a?(e={user:{fullName:k,id:j.id,isVerified:t,profilePictureUrl:r,username:a}},b[25]=k,b[26]=j.id,b[27]=t,b[28]=r,b[29]=a,b[30]=e):e=b[30];h=e;u=g[0];k=!j.isUnpublished;r=(t=j.username)!=null?t:"";b[31]!==j?(a=l.jsx(s,{owner:j}),b[31]=j,b[32]=a):a=b[32];b[33]!==k||b[34]!==j.id||b[35]!==r||b[36]!==a?(e=l.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",display:"flex",children:l.jsx(c("PolarisUserHoverCard.react"),{display:"inline",isUserAvailable:k,userId:j.id,username:r,children:a})}),b[33]=k,b[34]=j.id,b[35]=r,b[36]=a,b[37]=e):e=b[37];b[38]===Symbol["for"]("react.memo_cache_sentinel")?(t=l.jsx("span",{className:"_aaqv"}),b[38]=t):t=b[38];b[39]===Symbol["for"]("react.memo_cache_sentinel")?(k=l.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",display:"flex",children:l.jsxs(c("IGDSText.react").Body,{children:[t,q,l.jsx("span",{className:"_aaqv"})]})}),b[39]=k):k=b[39];if(b[40]!==g.length||b[41]!==f||b[42]!==v||b[43]!==i||b[44]!==h||b[45]!==u){a=g.length>1&&c("qex")._("280")?l.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",display:"flex",children:l.jsx(c("IGDSText.react").Body,{children:l.jsx(c("PolarisCoauthorCountWithSheet.react"),{analyticsContext:f,coauthors:v,mediaId:i,mediaOwner:h})})}):l.jsx(c("IGDSBox.react"),{alignItems:"start",direction:"row",display:"flex",children:l.jsx(c("PolarisUserHoverCard.react"),{display:"inline",isUserAvailable:!u.isUnpublished,userId:u.id,username:(r=u.username)!=null?r:"",children:l.jsx(s,{owner:u})})});b[40]=g.length;b[41]=f;b[42]=v;b[43]=i;b[44]=h;b[45]=u;b[46]=a}else a=b[46];b[47]!==e||b[48]!==a?(t=l.jsx("div",{className:"_aaqt _aaqu",children:l.jsx(c("IGDSText.react").BodyEmphasized,{textAlign:"start",zeroMargin:!0,children:l.jsxs(c("IGDSBox.react"),{alignItems:"start",direction:"row",display:"flex",children:[e,k,a]})})}),b[47]=e,b[48]=a,b[49]=t):t=b[49];return t}r=!j.isUnpublished;v=(f=j.username)!=null?f:"";b[50]!==j?(i=l.jsx(s,{owner:j}),b[50]=j,b[51]=i):i=b[51];b[52]!==r||b[53]!==j.id||b[54]!==v||b[55]!==i?(h=l.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:l.jsx(c("PolarisUserHoverCard.react"),{display:"inline",isUserAvailable:r,userId:j.id,username:v,children:i})}),b[52]=r,b[53]=j.id,b[54]=v,b[55]=i,b[56]=h):h=b[56];b[57]!==m||b[58]!==j?(u=m===!0&&j.isVerified===!0&&l.jsx(c("IGDSBox.react"),{marginStart:1,position:"relative",children:l.jsx(c("IGDSVerifiedBadge.react"),{size:"small"})}),b[57]=m,b[58]=j,b[59]=u):u=b[59];b[60]!==h||b[61]!==u?(k=l.jsx("div",{className:"_aaqt",children:l.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",display:"flex",position:"relative",children:[h,u]})}),b[60]=h,b[61]=u,b[62]=k):k=b[62];return k}function y(a){var b;return{user:{fullName:(b=a.fullName)!=null?b:"",id:a.id,isVerified:(b=a.isVerified)!=null?b:!1,profilePictureUrl:(b=a.profilePictureUrl)!=null?b:"",username:(b=a.username)!=null?b:""}}}function a(a){var b=p(44),e=a.adTitle,f=a.analyticsContext,g=a.clipsAttributionInfo,h=a.clipsAudioAttributionInfo,i=a.coauthorProducers,j=a.displayFBPageName,k=a.followHashtagInfo,m=a.headerAvatarSize,n=a.inModal,q=a.isAffiliate,r=a.isPaidPartnership,s=a.isSharedToCloseFriends,u=a.isSponsored,y=a.location,A=a.mediaId,B=a.onDisabledClipsAudioAttributionClick,C=a.owner,D=a.postedAt,E=a.reducedAvatarMargin,F=a.shouldShowFollowButton,G=a.showVerifiedBadge,H=a.sidebarVariantOptionsButton,I=a.sponsoredLabel,J=a.sponsors,K=a.transparencyLabelOwner;a=o(!0);var L=a[0],M=a[1],N=!k&&r&&I==null,O=J!=null&&J.length>0&&I!=null,P=!k&&!r&&q;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){M(!1)},b[0]=a):a=b[0];var Q=a;b[1]!==h||b[2]!==B||b[3]!==C?(r=l.jsx(t,{clipsAudioAttributionInfo:h,onDisabledClipsAudioAttributionClick:B,owner:C}),b[1]=h,b[2]=B,b[3]=C,b[4]=r):r=b[4];var R=r;q=c("usePolarisIsOnFeedPage")();a=c("usePolarisIsOnAdsActivityPage")();b[5]!==q||b[6]!==a||b[7]!==n?(B=(q||a)&&n!==!0&&d("PolarisUA").isDesktop(),b[5]=q,b[6]=a,b[7]=n,b[8]=B):B=b[8];var S=B,T=S;r=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("PolarisSponsoredPostContext.react").PolarisSponsoredPostContext,z);q=r.onProfileClick;b[9]!==j||b[10]!==O?(a={DisplayFBPage:j,PartnershipAd:O},b[9]=j,b[10]=O,b[11]=a):a=b[11];var U=a;b[12]!==S||b[13]!==T||b[14]!==f||b[15]!==i||b[16]!==k||b[17]!==m||b[18]!==O||b[19]!==L||b[20]!==C||b[21]!==J||b[22]!==H||b[23]!==E||b[24]!==F||b[25]!==e||b[26]!==A||b[27]!==U||b[28]!==G||b[29]!==u||b[30]!==D||b[31]!==s||b[32]!==R||b[33]!==g||b[34]!==h||b[35]!==y||b[36]!==P||b[37]!==N||b[38]!==I||b[39]!==K?(n=l.jsx(c("PolarisTrackingNodeProvider.react"),{trackingNode:230,children:function(a){return l.jsxs("header",{className:"_aaqw"+(S?" _aaqx":"")+(T?" _aggb":"")+(d("PolarisPanavisionQEHelpers").hasDenserMobileWebFeed()?" _ap5a":""),"data-testid":void 0,ref:a,children:[l.jsx(c("PolarisTrackingNodeProvider.react"),{trackingNode:69,children:function(a){return l.jsx("div",{ref:a,children:l.jsx(w,{analyticsContext:f,coauthorProducers:i,followHashtagInfo:k,headerAvatarSize:m,isPartnershipAd:O,isTagAvatarLink:L,onTagAvatarShowRing:Q,owner:C,sponsors:J})})}}),l.jsxs("div",{className:"_aaqy"+(H&&!S?" _aaqz":"")+(H&&S?" _aaq-":"")+(E===!0?" _aaq_":"")+(d("PolarisPanavisionQEHelpers").hasDenserMobileWebFeed()?" _ap5c":""),children:[l.jsxs("div",{className:"_aar0"+(F?" _ad95":"")+(H?" _aar1":""),children:[l.jsx(c("PolarisTrackingNodeProvider.react"),{trackingNode:10,children:function(a){return l.jsx("div",{className:"x78zum5",ref:a,children:l.jsx(x,{adTitle:e,analyticsContext:f,coauthorProducers:i,followHashtagInfo:k,mediaId:A,owner:C,postHeaderMode:U,showVerifiedBadge:G,sponsors:J})})}}),!u&&D!=null&&T&&l.jsx(c("IGDSBox.react"),{alignItems:"center",direction:"row",display:"flex",position:"relative",children:l.jsx("div",{className:"_ajqd",children:l.jsxs(c("IGDSText.react"),{color:"secondaryText",size:"body",zeroMargin:!0,children:[l.jsx(c("IGDSMiddleDot.react"),{color:"secondaryText"}),l.jsx(c("PolarisTimestamp.react"),{isLong:!1,value:D})]})})}),F&&!s&&l.jsxs("div",{className:"_aar2",children:[l.jsx("div",{className:"_aar3",children:l.jsx(c("IGDSMiddleDot.react"),{color:T?"secondaryText":void 0})}),l.jsx(c("PolarisFollowButtonContainer.react"),{analyticsContext:f,borderless:!0,"data-testid":void 0,isInline:!0,userId:C.id,username:(a=C.username)!=null?a:""})]})]}),l.jsx(v,{audioAttributionText:R,clipsAttributionInfo:g,clipsAudioAttributionInfo:h,followHashtagInfo:k,isSponsored:u,location:y,mediaId:A,owner:C,postId:A,showEligibleForCommissions:P,showOrganicPPL:N,sponsoredLabel:I,sponsors:J,transparencyLabelOwner:K})]}),s&&l.jsx(c("PolarisCloseFriendsLabel.react"),{onClick:function(){}})]})}}),b[12]=S,b[13]=T,b[14]=f,b[15]=i,b[16]=k,b[17]=m,b[18]=O,b[19]=L,b[20]=C,b[21]=J,b[22]=H,b[23]=E,b[24]=F,b[25]=e,b[26]=A,b[27]=U,b[28]=G,b[29]=u,b[30]=D,b[31]=s,b[32]=R,b[33]=g,b[34]=h,b[35]=y,b[36]=P,b[37]=N,b[38]=I,b[39]=K,b[40]=n):n=b[40];b[41]!==q||b[42]!==n?(B=l.jsx(c("PolarisClickEventLoggerProvider.react"),{children:l.jsx(c("PolarisProfileClickEventLoggerProvider.react"),{onProfileClick:q,children:n})}),b[41]=q,b[42]=n,b[43]=B):B=b[43];return B}function z(a){return[a.onProfileClick]}g["default"]=a}),226);
__d("PolarisPostMediaOverlayInfoFooterCTA.react",["fbt","CometPlaceholder.react","IGDSInfoPanoOutlineIcon.react","JSResourceForInteraction","PolarisAssetManagerGlyphMapping","PolarisIGCoreIcon.react","PolarisInformTreatmentBanner.react","PolarisInformTreatmentDialogRootEntrypoint.entrypoint","PolarisInformTreatmentSensitivityType","PolarisInstagramMediaOverlayFalcoEvent","PolarisMediaOverlayInfoTypes","PolarisMisinformationConstants","PolarisPostFooterCTA.react","gkx","lazyLoadComponent","react","useIGDSEntryPointDialog","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useEffect;b.useMemo;var l=b.useRef,m=b.useState,n=b.c,o=c("lazyLoadComponent")(c("JSResourceForInteraction")("IGWebBloksApp").__setRef("PolarisPostMediaOverlayInfoFooterCTA.react")),p=c("JSResourceForInteraction")("PolarisInformTreatmentSensitivityDetailsDialog.react").__setRef("PolarisPostMediaOverlayInfoFooterCTA.react");function q(a,b){var c=a.analyticsContext,e=a.bannerInfo,f=a.entityID,g=e.bannerButton,h=e.overlayLayout,i=e.overlayType;d("PolarisInstagramMediaOverlayFalcoEvent").PolarisInstagramMediaOverlayFalcoEvent.log(function(){return d("PolarisInstagramMediaOverlayFalcoEvent").PolarisInstagramMediaOverlayFalcoEvent.buildPayloadForLog({button:g,containerModule:d("PolarisInstagramMediaOverlayFalcoEvent").PolarisInstagramMediaOverlayFalcoEvent.getLoggableContainerModuleFromAnalyticsContext(c),entityID:f,event:b,overlayLayout:h,overlayType:i})})}function r(a){var b=a.entityID,c=a.onLoggedImpression;q(a,d("PolarisInstagramMediaOverlayFalcoEvent").IG_MEDIA_OVERLAY_FALCO_CLIENT_EVENTS.IMPRESSION);c!=null&&c(b)}function s(a){q(a,d("PolarisInstagramMediaOverlayFalcoEvent").IG_MEDIA_OVERLAY_FALCO_CLIENT_EVENTS.ACTION)}function t(a,b){s(a),b()}function u(a){a=a.bannerInfo;var b=a.bannerButton,e=a.iconAltText;a=a.iconGlyph;b=b.text_color;e=e!=null?h._("__JHASH__tZoHuCBQNgF__JHASH__",[h._param("text",e)]):d("PolarisMisinformationConstants").POST_FOOTER_CTA_ALT_TEXT;if(a===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_ICON_GLYPHS.INFO)return j.jsx(c("IGDSInfoPanoOutlineIcon.react"),{alt:e,color:b!=null?b:"ig-primary-icon",size:16});else if(a===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_ICON_GLYPHS.WARNING)return j.jsx(c("PolarisIGCoreIcon.react"),{alt:e,icon:d("PolarisAssetManagerGlyphMapping").ICONS.WARNING_OUTLINE_16_RED5});return null}e=j.forwardRef(a);function a(a,b){var e=n(47),f;e[0]!==a?(f=babelHelpers["extends"]({},a),e[0]=a,e[1]=f):f=e[1];a=m(!1);var g=a[0],h=a[1];a=m(0);var i=a[0],l=a[1];a=f;var q=a.bannerInfo,s=a["data-testid"],w=a.disableImpressionLogging,x=a.entityID,y=a.forceBottomBorder,z=a.fullWidth;a=a.isForSidecar;var A=q.animationInfo,B=q.bannerButton;q=q.text;var C=A.canAnimateSlideIn,D=A.isHidden,E=B.action,F=B.action_url;A=B.has_chevron;var G=B.is_text_centered,H=B.secondary_text;B=B.text_color;var I=E===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_BUTTON_ACTIONS.OPEN_EXTERNAL_URL?F:void 0,J=v(f),K=J!==x,L;e[2]!==K||e[3]!==g||e[4]!==w||e[5]!==D||e[6]!==f?(J=function(){(K||g===!1)&&w!==!0&&D!==!0?(r(f),h(!0)):K&&h(!1)},L=[w,D,K,g,f,h],e[2]=K,e[3]=g,e[4]=w,e[5]=D,e[6]=f,e[7]=J,e[8]=L):(J=e[7],L=e[8]);k(J,L);e[9]!==E||e[10]!==f||e[11]!==i?(J=E!==d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_BUTTON_ACTIONS.NO_OP?function(){return t(f,function(){return l(i+1)})}:void 0,e[9]=E,e[10]=f,e[11]=i,e[12]=J):J=e[12];var M=J;e[13]===Symbol["for"]("react.memo_cache_sentinel")?(L=function(){l(0)},e[13]=L):L=e[13];J=L;e[14]!==x?(L={media_id:x},e[14]=x,e[15]=L):L=e[15];L=c("useIGDSEntryPointDialog")(c("PolarisInformTreatmentDialogRootEntrypoint.entrypoint"),L);var N=L[0];L=c("useIGDSLazyDialog")(p);var O=L[0];e[16]!==E||e[17]!==f||e[18]!==F||e[19]!==N||e[20]!==O||e[21]!==M?(L=function(){if(E!==d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_BUTTON_ACTIONS.NO_OP){t(f,function(){});if(F!=null)bb38:switch(F){case"com.instagram.misinformation.fact_check_sheet.action":N({});break bb38;case"com.bloks.www.instagram.igwb.yci.sensitive_resource_bottomsheet":case"com.instagram.sensitivity.see_why_sheets.sensitivity_sheet_action":O({sensitivityType:d("PolarisInformTreatmentSensitivityType").SensitivityType.SENSITIVE});break bb38;case"com.instagram.sensitivity.see_why_sheets.violence_sheet_action":O({sensitivityType:d("PolarisInformTreatmentSensitivityType").SensitivityType.VIOLENCE});break bb38;default:M&&M()}}},e[16]=E,e[17]=f,e[18]=F,e[19]=N,e[20]=O,e[21]=M,e[22]=L):L=e[22];L=L;var P=f.analyticsContext||"",Q;e[23]!==x||e[24]!==P?(Q={media_id:x,module:P},e[23]=x,e[24]=P,e[25]=Q):Q=e[25];x=Q;P=x;if(e[26]!==f||e[27]!==I||e[28]!==L||e[29]!==H||e[30]!==q||e[31]!==C||e[32]!==D||e[33]!==A||e[34]!==G||e[35]!==s||e[36]!==y||e[37]!==z||e[38]!==a||e[39]!==M||e[40]!==b||e[41]!==B||e[42]!==E||e[43]!==i||e[44]!==F||e[45]!==P){x=c("gkx")("5268")?j.jsx(c("PolarisInformTreatmentBanner.react"),{analyticsContext:f.analyticsContext,externalURL:I,isStory:!1,onClick:L,secondaryText:H,text:q}):j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisPostFooterCTA.react"),{"data-testid":void 0,disableAnimation:!C,externalURL:I,forceBottomBorder:y,fullWidth:z,icon:u(f),isActive:!D,isForSidecar:a,onClick:M,ref:b,secondaryText:H,showChevron:(Q=A)!=null?Q:!1,text:q,textAlign:G===!0?"center":"left",textThemedColor:B}),E===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_BUTTON_ACTIONS.OPEN_BLOKS_APP&&i>0&&F!=null&&j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx(o,{appId:F,bridgeOverrides_DEPRECATED:{onResumeStoryPlayback:J},params:P},i)})]});e[26]=f;e[27]=I;e[28]=L;e[29]=H;e[30]=q;e[31]=C;e[32]=D;e[33]=A;e[34]=G;e[35]=s;e[36]=y;e[37]=z;e[38]=a;e[39]=M;e[40]=b;e[41]=B;e[42]=E;e[43]=i;e[44]=F;e[45]=P;e[46]=x}else x=e[46];return x}f=e;function v(a){var b=a.entityID,c=l();k(function(){c.current=b});return c.current}g["default"]=f}),226);
__d("usePolarisShowFooterCTA",["PolarisPostUtils","polarisGetPostFromGraphMediaInterface","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo;function a(a,b,c,e){return i(function(){if(e===!0)return null;if(a==null)return null;var f=a.isSidecar,g=null,h=null;if(f===!0){var i=d("PolarisPostUtils").getCurrentSidecarItemFromPost(a,b);i!=null&&(h=d("polarisGetPostFromGraphMediaInterface").getMediaOverlayBottomBannerInfoFromSidecarChild(i,c[i.id]===!0),h!=null&&(g=i))}g==null&&(h=d("polarisGetPostFromGraphMediaInterface").getMediaOverlayBottomBannerInfoFromRootPost(a,c[a.id]===!0),h!=null&&(g=a));return g==null||h==null?null:{bottomBannerInfo:h,isParentPostSidecar:f,itemWithBanner:g}},[b,c,e,a])}g["default"]=a}),98);
__d("PolarisPostOverlayInfoFooterCTA.react",["CometRelay","PolarisPostMediaOverlayInfoFooterCTA.react","PolarisRelayEnvironment","react","usePolarisShowFooterCTA"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function k(a){var b=i(8),e=a.analyticsContext,f=a.bottomBannerInfo,g=a.dynamicFooterRef,h=a.idsWithDisabledMediaOverlayInfoImpressionLogging,k=a.isParentPostSidecar,l=a.itemWithBannerID;a=a.onLogOverlayImpression;var m=f.hasMediaCover;m=m||h[l]===!0;b[0]!==e||b[1]!==f||b[2]!==m||b[3]!==l||b[4]!==k||b[5]!==a||b[6]!==g?(h=j.jsx(d("CometRelay").RelayEnvironmentProvider,{environment:c("PolarisRelayEnvironment"),children:j.jsx(c("PolarisPostMediaOverlayInfoFooterCTA.react"),{analyticsContext:e,bannerInfo:f,"data-testid":void 0,disableImpressionLogging:m,entityID:l,isForSidecar:k,onLoggedImpression:a,ref:g})}),b[0]=e,b[1]=f,b[2]=m,b[3]=l,b[4]=k,b[5]=a,b[6]=g,b[7]=h):h=b[7];return h}function a(a){var b=i(8),d,e,f,g;b[0]!==a?(e=a.currentSidecarIndex,f=a.idsWithClearedBlurOverlays,d=a.rootPost,g=babelHelpers.objectWithoutPropertiesLoose(a,["currentSidecarIndex","idsWithClearedBlurOverlays","rootPost"]),b[0]=a,b[1]=d,b[2]=e,b[3]=f,b[4]=g):(d=b[1],e=b[2],f=b[3],g=b[4]);a=c("usePolarisShowFooterCTA")(d,e,f);b[5]!==a||b[6]!==g?(d=a!=null?j.jsx(k,babelHelpers["extends"]({bottomBannerInfo:a.bottomBannerInfo,isParentPostSidecar:a.isParentPostSidecar,itemWithBannerID:a.itemWithBanner.id},g)):null,b[5]=a,b[6]=g,b[7]=d):d=b[7];return d}g.PolarisPostOverlayInfoFooterCTARenderer=k;g.PolarisPostOverlayInfoFooterCTA=a}),98);
__d("PolarisPostTimestamp.react",["IGDSText.react","PolarisFastLink.react","PolarisIGCoreText","PolarisLinkBuilder","PolarisTimestamp.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(11),e=a.code,f=a.isVideo,g=a.mediaLinkBuilder;a=a.postedAt;var h;b[0]!==g||b[1]!==e||b[2]!==f?(h=g!=null?g(e,f):d("PolarisLinkBuilder").buildMediaLink(e),b[0]=g,b[1]=e,b[2]=f,b[3]=h):h=b[3];b[4]===Symbol["for"]("react.memo_cache_sentinel")?(g={navigation_source:"polaris_timestamp"},b[4]=g):g=b[4];b[5]===Symbol["for"]("react.memo_cache_sentinel")?(e="x1p4m5qa",b[5]=e):e=b[5];b[6]!==a?(f=j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",children:j.jsx(c("PolarisTimestamp.react"),{className:e,isLong:!0,value:a})}),b[6]=a,b[7]=f):f=b[7];b[8]!==h||b[9]!==f?(e=j.jsx(c("PolarisIGCoreText"),{display:"block",zeroMargin:!0,children:j.jsx(c("PolarisFastLink.react"),{"data-testid":void 0,href:h,traceParams:g,children:f})}),b[8]=h,b[9]=f,b[10]=e):e=b[10];return e}g["default"]=a}),98);
__d("PolarisPostToastProvider.react",["react","useMergeRefs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));d=h;var j=d.useContext,k=d.useMemo,l=d.useRef,m=d.useState;d=i.forwardRef(e);var n={ActionText:null,BodyText:null,actionHref:"/",positionStyles:{absolutePositionStyles:{},width:0},postToastContainerElem:null,setActionHref:function(){},setActionText:function(){},setBodyText:function(){},setPositionStyles:function(){},setShowToast:function(){},showToast:!1},o=i.createContext(n);function a(){return j(o)}function b(a){var b=a.ActionText,c=a.BodyText,d=a.actionHref,e=a.setActionHref,f=a.setActionText,g=a.setBodyText;a=a.setShowToast;e(d);f(b);g(c);a(!0)}function e(a,b){a=a.children;var d=m(null),e=d[0],f=d[1];d=m(null);var g=d[0],h=d[1];d=m("");var j=d[0],p=d[1];d=m(n.positionStyles);var q=d[0],r=d[1];d=m(!1);var s=d[0],t=d[1],u=l(null);d=c("useMergeRefs")(u,b);b=k(function(){return{ActionText:e,BodyText:g,actionHref:j,positionStyles:q,postToastContainerElem:u.current,setActionHref:p,setActionText:f,setBodyText:h,setPositionStyles:r,setShowToast:t,showToast:s}},[e,g,j,q,s]);return i.jsx(o.Provider,{value:b,children:a(d)})}e.displayName=e.name+" [from "+f.id+"]";e=d;g.usePostToastContext=a;g.showPostToast=b;g.PostToastProvider=e}),98);
__d("PolarisPostViewInsights.react",["fbt","CometPlaceholder.react","CometRouteParams","IGDSButton.react","JSResourceForInteraction","PolarisLinkBuilder","QuickPerformanceLogger","lazyLoadComponent","qex","qpl","react","useCometRouterDispatcher","useCometRouterState"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useEffect;b.useMemo;var m=b.useState,n=b.c,o=c("lazyLoadComponent")(c("JSResourceForInteraction")("IGWebBloksApp").__setRef("PolarisPostViewInsights.react"));function p(a){switch(a){case"com.instagram.insights.media_refresh.videos.ad_bottom_sheet.action":(i||(i=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(39130588,"1610"),0);break;case"com.instagram.insights.media_refresh.videos.bottom_sheet.action":(i||(i=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(39130588,"1610"),0);break;case"com.instagram.insights.media_refresh.clips.ad_bottom_sheet.action":(i||(i=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(39137013,"1611"),0);break;case"com.instagram.insights.media_refresh.clips.bottom_sheet.action":(i||(i=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(39137013,"1611"),0);break;default:(i||(i=c("QuickPerformanceLogger"))).markerStart(c("qpl")._(39124994,"1612"),0)}}function a(a){var b=n(21),e=a.bloksAppId,f=a.mediaId;a=d("CometRouteParams").useRouteParams();var g=a.show_insights;a=m(Boolean(g));var i=a[0],j=a[1],q=c("useCometRouterDispatcher")(),r=c("useCometRouterState")(),s;b[0]!==g?(a=function(){j(Boolean(g))},s=[g],b[0]=g,b[1]=a,b[2]=s):(a=b[1],s=b[2]);l(a,s);b[3]!==f?(a={media_id:f},b[3]=f,b[4]=a):a=b[4];s=a;a=s;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(s=function(){return j(!1)},b[5]=s):s=b[5];s=s;var t;b[6]!==q||b[7]!==f||b[8]!==r||b[9]!==e?(t=function(){var a;a=(a=c("qex")._("1542"))!=null?a:!1;a?q==null?void 0:q.go(d("PolarisLinkBuilder").buildImmersiveMediaInsightsLink(String(f)),{passthroughProps:{fallbackUrl:r==null?void 0:r.main.route.url},target:"self"}):(j(!0),p(e))},b[6]=q,b[7]=f,b[8]=r,b[9]=e,b[10]=t):t=b[10];t=t;var u;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(u=h._("__JHASH__ibs5xsuNLiq__JHASH__"),b[11]=u):u=b[11];b[12]!==t?(u=k.jsx(c("IGDSButton.react"),{display:"block",label:u,onClick:t,variant:"primary_link"}),b[12]=t,b[13]=u):u=b[13];b[14]!==i||b[15]!==e||b[16]!==a?(t=i?k.jsx(c("CometPlaceholder.react"),{fallback:null,children:k.jsx(o,{appId:e,bridgeOverrides_DEPRECATED:{onResumeStoryPlayback:s},loadingFallback:k.jsx("div",{}),params:a})}):null,b[14]=i,b[15]=e,b[16]=a,b[17]=t):t=b[17];b[18]!==u||b[19]!==t?(s=k.jsxs("section",{children:[u,t]}),b[18]=u,b[19]=t,b[20]=s):s=b[20];return s}g["default"]=a}),226);
__d("PolarisPostViews.react",["cx","fbt","IGDSText.react","PolarisBigNumber.react","polarisLogAction","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;var l=b.useState,m=b.c;function n(a){return a===1?i._("__JHASH__-4rMdzmO7iR__JHASH__",[i._param("count",a)]):i._("__JHASH__bzQqcYCqjPQ__JHASH__",[i._param("count",k.jsx(c("PolarisBigNumber.react"),{value:a}))])}n.displayName=n.name+" [from "+f.id+"]";function o(a){return a===1?i._("__JHASH__gVA7T1ZCZwN__JHASH__",[i._param("count",a)]):i._("__JHASH__7IxnQp4Oj43__JHASH__",[i._param("count",k.jsx(c("PolarisBigNumber.react"),{value:a}))])}o.displayName=o.name+" [from "+f.id+"]";function p(a){var b=m(11),c=a.likeCount;a=a.onClose;var d;b[0]!==a?(d=k.jsx("div",{className:"_aaur",onClick:a,role:"button",tabIndex:"0"}),b[0]=a,b[1]=d):d=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",{className:"_aaus"}),b[2]=a):a=b[2];var e;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(e=k.jsx("div",{className:"_aaut"}),b[3]=e):e=b[3];var f="_aauu",g;b[4]!==c?(g=o(c),b[4]=c,b[5]=g):g=b[5];b[6]!==g?(c=k.jsx("div",{className:f,children:g}),b[6]=g,b[7]=c):c=b[7];b[8]!==d||b[9]!==c?(f=k.jsxs("div",{children:[d,a,e,c]}),b[8]=d,b[9]=c,b[10]=f):f=b[10];return f}function a(a){var b=m(17),d=a.analyticsContext,e=a.likeCount;a=a.viewCount;var f=l(!1),g=f[0],h=f[1];b[0]!==g||b[1]!==d?(f=function(){g||c("polarisLogAction")("viewCountClick",{source:d}),h(!g)},b[0]=g,b[1]=d,b[2]=f):f=b[2];f=f;var i="_aauv",j="_aauw",o;b[3]!==a?(o=n(a),b[3]=a,b[4]=o):o=b[4];b[5]!==o?(a=k.jsx(c("IGDSText.react").BodyEmphasized,{zeroMargin:!0,children:o}),b[5]=o,b[6]=a):a=b[6];b[7]!==f||b[8]!==a?(o=k.jsx("span",{className:j,onClick:f,role:"button",tabIndex:"0",children:a}),b[7]=f,b[8]=a,b[9]=o):o=b[9];b[10]!==g||b[11]!==e||b[12]!==f?(j=g&&k.jsx(p,{likeCount:e,onClose:f}),b[10]=g,b[11]=e,b[12]=f,b[13]=j):j=b[13];b[14]!==o||b[15]!==j?(a=k.jsxs("div",{className:i,children:[o,j]}),b[14]=o,b[15]=j,b[16]=a):a=b[16];return a}g["default"]=a}),226);
__d("PolarisSavedCollectionPickerListHeader.react",["fbt","IGDSAddPanoFilledIcon.react","IGDSBox.react","IGDSIconButton.react","IGDSText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l=h._("__JHASH__k_raO8ltliS__JHASH__"),m=h._("__JHASH__OvXLGVUZiSy__JHASH__");function a(a){var b=j(10),d=a.headerMinHeight,e=a.setHidePopover,f=a.setShowCreateCollectionModal;b[0]!==f||b[1]!==e?(a=function(){f(!0),e(!0)},b[0]=f,b[1]=e,b[2]=a):a=b[2];a=a;var g;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("IGDSBox.react"),{flex:"grow",position:"relative",children:k.jsx(c("IGDSBox.react"),{alignItems:"start",marginTop:1,position:"relative",children:k.jsx(c("IGDSText.react").Section,{children:l})})}),b[3]=g):g=b[3];var h;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("IGDSAddPanoFilledIcon.react"),{alt:m,size:12}),b[4]=h):h=b[4];b[5]!==a?(g=k.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",height:46,position:"relative",children:[g,k.jsx(c("IGDSBox.react"),{marginTop:1,position:"relative",children:k.jsx(c("IGDSIconButton.react"),{onClick:a,children:h})})]}),b[5]=a,b[6]=g):g=b[6];b[7]!==d||b[8]!==g?(h=k.jsx(c("IGDSBox.react"),{marginEnd:2,marginStart:4,minHeight:d,position:"relative",children:g}),b[7]=d,b[8]=g,b[9]=h):h=b[9];return h}g["default"]=a}),226);
__d("PolarisSavedCollectionPickerListItem.react",["cx","fbt","CometPressable.react","IGDSBox.react","IGDSText.react","PolarisLinkBuilder","PolarisPostToastProvider.react","PolarisThumbnail.react","PolarisUrlHelpers","emptyFunction","nullthrows","react","usePolarisViewer"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;b.useCallback;var l=b.c,m=32,n=152,o=50;function p(a){return i._("__JHASH__-q2h7eNrQCh__JHASH__",[i._param("collection name",a)])}function q(a){var b=l(6),d=a.collectionName;a=a.coverMedia;a=a.image_versions2;a=a.candidates;var e=a.length>0,f;b[0]!==e||b[1]!==d||b[2]!==a?(f=e?k.jsx(c("PolarisThumbnail.react"),{alt:i._("__JHASH___bvLxc-DOQb__JHASH__",[i._param("collectionName",d)]),src:a[0].url}):null,b[0]=e,b[1]=d,b[2]=a,b[3]=f):f=b[3];b[4]!==f?(e=k.jsx(k.Fragment,{children:f}),b[4]=f,b[5]=e):e=b[5];return e}function a(a){var b=l(33),e=a.collection,f=a.onSaveMedia,g=a.onSaveMediaToCollection,h=a.postIsSaved,j=a.postIsSavedToCollection,r=a.setHidePopover,s=f===void 0?c("emptyFunction"):f;a=e.cover_media;f=e.cover_media_list;var t;a!=null&&(t=a);f!=null&&(t=f[0]);a=t!=null;var u=d("PolarisPostToastProvider.react").usePostToastContext();f=c("usePolarisViewer")();var v;b[0]!==f?(v=c("nullthrows")(f),b[0]=f,b[1]=v):v=b[1];var w=v;b[2]!==e.name?(f=d("PolarisUrlHelpers").slugify(e.name),b[2]=e.name,b[3]=f):f=b[3];var x=f;b[4]!==u||b[5]!==e.name||b[6]!==e.id||b[7]!==w.username||b[8]!==x?(v=function(){d("PolarisPostToastProvider.react").showPostToast(babelHelpers["extends"]({},u,{ActionText:i._("__JHASH__O7TnneKxudi__JHASH__"),BodyText:p(e.name),actionHref:d("PolarisLinkBuilder").buildUserSavedCollectionLink(c("nullthrows")(w.username),x===""?"_":x,e.id)}))},b[4]=u,b[5]=e.name,b[6]=e.id,b[7]=w.username,b[8]=x,b[9]=v):v=b[9];var y=v;b[10]!==g||b[11]!==j||b[12]!==e.id||b[13]!==y||b[14]!==h||b[15]!==s||b[16]!==r?(f=function(){g(j,e.id),j||y(),h===!1&&s(!0),r(!0)},b[10]=g,b[11]=j,b[12]=e.id,b[13]=y,b[14]=h,b[15]=s,b[16]=r,b[17]=f):f=b[17];v=f;b[18]!==a||b[19]!==t||b[20]!==e?(f=a?k.jsx(q,{collectionName:e.name,coverMedia:c("nullthrows")(t)}):null,b[18]=a,b[19]=t,b[20]=e,b[21]=f):f=b[21];b[22]!==f?(a=k.jsx("div",{className:"_aauc",children:k.jsx(c("IGDSBox.react"),{color:"secondaryBackground",height:m,position:"relative",shape:"square",width:m,children:f})}),b[22]=f,b[23]=a):a=b[23];b[24]!==j||b[25]!==e.name?(f=k.jsx(c("IGDSBox.react"),{marginStart:2,maxWidth:n,position:"relative",children:j?k.jsx(c("IGDSText.react").Section,{maxLines:1,zeroMargin:!0,children:e.name}):k.jsx(c("IGDSText.react").Label,{maxLines:1,zeroMargin:!0,children:e.name})}),b[24]=j,b[25]=e.name,b[26]=f):f=b[26];var z;b[27]!==a||b[28]!==f?(z=k.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",height:o,paddingX:4,position:"relative",children:[a,f]}),b[27]=a,b[28]=f,b[29]=z):z=b[29];b[30]!==v||b[31]!==z?(a=k.jsx(c("CometPressable.react"),{onPress:v,children:z}),b[30]=v,b[31]=z,b[32]=a):a=b[32];return a}g.LIST_ITEM_HEIGHT=o;g.savedToCollectionText=p;g.SavedCollectionPickerListItem=a}),226);
__d("PolarisSavedCollectionPicker.react",["FBLogger","IGDSBox.react","IGDSDivider.react","IGDSSpinner.react","PolarisIGCoreAnchoredPopoverContentContainer.react","PolarisIGVirtualList.react","PolarisPostActionRequestSavedCollectionsForPost","PolarisReactRedux.react","PolarisSavedCollectionPickerListHeader.react","PolarisSavedCollectionPickerListItem.react","PolarisSavedPostsActionRequestNextSavedCollections","PolarisSavedPostsTypes","PolarisScrollWatchedComponent.react","PolarisScrollableContainer.react","polarisCollectionsLoading","polarisSavedPostsSelectors","react","usePolarisHoverCardDelay","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.c,l={x:1,y:2},m=280,n=264,o=4,p=47;function q(a){return a.moreAvailable&&!a.isFetching}function r(a,b){q(a)&&b()}function a(a){var b=k(52),e=a.collectionsPostSavedTo,f=a.hidePopover,g=a.onSaveMedia,h=a.onSaveMediaToCollection,u=a.postId,v=a.postIsSaved,w=a.setHidePopover;a=a.setShowCreateCollectionModal;var x=d("PolarisReactRedux.react").useDispatch(),y=c("usePolarisViewer")();if(y==null)throw c("FBLogger")("ig_web").mustfixThrow("PolarisSavedCollectionPicker: viewer must exist");var z;b[0]!==y.id?(z=function(a){return d("polarisSavedPostsSelectors").getSavedCollectionsPaginationForUser(a,y.id)},b[0]=y.id,b[1]=z):z=b[1];var A=d("PolarisReactRedux.react").useSelector(z);b[2]!==y.id?(z=function(a){return d("polarisSavedPostsSelectors").getAllSavedCollectionsForUser(a,y.id)},b[2]=y.id,b[3]=z):z=b[3];z=d("PolarisReactRedux.react").useSelector(z);var B;b[4]!==z?(B=z.filter(t),b[4]=z,b[5]=B):B=b[5];var C=B;B=c("usePolarisHoverCardDelay")();var D=B.handleMouseLeave;B=B.hoverDelayShow;var E;b[6]!==z||b[7]!==A||b[8]!==e?(E=d("polarisCollectionsLoading").collectionsLoading(z,A)||e==null,b[6]=z,b[7]=A,b[8]=e,b[9]=E):E=b[9];z=E;b[10]!==u?(E=function(){return d("PolarisPostActionRequestSavedCollectionsForPost").requestSavedCollectionsForPost({postId:u})},b[10]=u,b[11]=E):E=b[11];var F=E;E=Math.min((C.length+1)*d("PolarisSavedCollectionPickerListItem.react").LIST_ITEM_HEIGHT,m);var G;b[12]!==C||b[13]!==A.isFetching||b[14]!==A.moreAvailable||b[15]!==v||b[16]!==e||b[17]!==g||b[18]!==h||b[19]!==u||b[20]!==w?(G=function(a){a=a.index;if(a===C.length)return i.jsx(c("IGDSBox.react"),{alignItems:"center",height:d("PolarisSavedCollectionPickerListItem.react").LIST_ITEM_HEIGHT,justifyContent:"center",paddingY:2,position:"relative",children:A.isFetching&&A.moreAvailable&&i.jsx(c("IGDSSpinner.react"),{size:"medium"})},"spinner");a=C[a];var b=v&&a.id===d("PolarisSavedPostsTypes").SAVED_COLLECTION_TYPE.ALL_MEDIA_AUTO_COLLECTION;b=b||((b=e==null?void 0:e.includes(a.id))!=null?b:!1);return i.jsx(d("PolarisSavedCollectionPickerListItem.react").SavedCollectionPickerListItem,{collection:a,onSaveMedia:g,onSaveMediaToCollection:h,postId:u,postIsSaved:v,postIsSavedToCollection:b,setHidePopover:w},a.id)},b[12]=C,b[13]=A.isFetching,b[14]=A.moreAvailable,b[15]=v,b[16]=e,b[17]=g,b[18]=h,b[19]=u,b[20]=w,b[21]=G):G=b[21];var H=G;b[22]!==C.length||b[23]!==A.moreAvailable?(G=function(){return C.length+(A.moreAvailable?1:0)},b[22]=C.length,b[23]=A.moreAvailable,b[24]=G):G=b[24];G=G;var I,J;b[25]!==e||b[26]!==x||b[27]!==F?(I=function(){e==null&&x(F())},J=[e,x,F],b[25]=e,b[26]=x,b[27]=F,b[28]=I,b[29]=J):(I=b[28],J=b[29]);j(I,J);b[30]!==f||b[31]!==D?(I=function(){f&&D()},J=[D,f],b[30]=f,b[31]=D,b[32]=I,b[33]=J):(I=b[32],J=b[33]);j(I,J);if(B===!1||f)return null;b[34]!==w||b[35]!==a?(I=i.jsx(c("PolarisSavedCollectionPickerListHeader.react"),{headerMinHeight:p,setHidePopover:w,setShowCreateCollectionModal:a}),b[34]=w,b[35]=a,b[36]=I):I=b[36];b[37]!==z||b[38]!==E||b[39]!==G||b[40]!==H||b[41]!==A||b[42]!==x||b[43]!==y?(J=z?i.jsx(c("IGDSBox.react"),{alignItems:"center",height:E-p,justifyContent:"center",position:"relative",width:n,children:i.jsx(c("IGDSSpinner.react"),{size:"medium"})}):i.jsxs(c("IGDSBox.react"),{position:"relative",children:[i.jsx(c("IGDSDivider.react"),{}),i.jsxs(d("PolarisScrollableContainer.react").ScrollableContainer,{children:[i.jsx(c("PolarisIGVirtualList.react"),{containerSize:E-d("PolarisSavedCollectionPickerListItem.react").LIST_ITEM_HEIGHT,estimatedItemSize:d("PolarisSavedCollectionPickerListItem.react").LIST_ITEM_HEIGHT,itemCount:G(),overscanCount:o,renderer:function(a){return H(a)}}),q(A)&&i.jsx(c("PolarisScrollWatchedComponent.react"),{boundScaleFactor:l,onScrollEnter:function(){return r(A,function(){return x(d("PolarisSavedPostsActionRequestNextSavedCollections").requestNextSavedCollections(y.id))})}})]})]}),b[37]=z,b[38]=E,b[39]=G,b[40]=H,b[41]=A,b[42]=x,b[43]=y,b[44]=J):J=b[44];b[45]!==E||b[46]!==I||b[47]!==J?(B=i.jsxs(c("IGDSBox.react"),{height:E,overflow:"hidden",position:"relative",width:n,children:[I,J]}),b[45]=E,b[46]=I,b[47]=J,b[48]=B):B=b[48];b[49]!==E||b[50]!==B?(a=i.jsx("div",{onWheel:s,children:i.jsx(c("PolarisIGCoreAnchoredPopoverContentContainer.react"),{height:E,isVisible:!0,width:n,children:B})}),b[49]=E,b[50]=B,b[51]=a):a=b[51];return a}function s(a){return a.stopPropagation()}function t(a){return a.id!==d("PolarisSavedPostsTypes").SAVED_COLLECTION_TYPE.AUDIO_AUTO_COLLECTION&&a.id!==d("PolarisSavedPostsTypes").SAVED_COLLECTION_TYPE.ALL_MEDIA_AUTO_COLLECTION}g["default"]=a}),98);
__d("PolarisStepIndicator.react",["cx","joinClasses","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i,l="horizontal",m="vertical",n="default",o="immersiveViewer",p="overlay",q="overlayShadow";function a(a){var b=j(11),d=a.className,e=a.direction,f=a.numSteps,g=a.selectedStep;a=a.style;e=e===void 0?l:e;a=a===void 0?n:a;var h=e===m;e=e===l;var i=a===n,r=a===p,s=a===q;h="_acvz"+(h?" _acnd":"")+(e?" _acnc":"")+(i?" _acne":"")+(r?" _acng":"")+(s?" _acnh":"")+(a===o?" _any_":"");b[0]!==d||b[1]!==h?(e=c("joinClasses")(d,h),b[0]=d,b[1]=h,b[2]=e):e=b[2];if(b[3]!==f||b[4]!==g){b[6]!==g?(i=function(a,b){return k.jsx("div",{className:"_acnb"+(b===g?" _acnf":"")},"step"+b)},b[6]=g,b[7]=i):i=b[7];r=new Array(f).fill(0).map(i);b[3]=f;b[4]=g;b[5]=r}else r=b[5];b[8]!==e||b[9]!==r?(s=k.jsx("div",{className:e,children:r}),b[8]=e,b[9]=r,b[10]=s):s=b[10];return s}g["default"]=a}),98);
__d("PolarisSidecar_DEPRECATED.react",["IGDSBox.react","PolarisPagerButton.react","PolarisResponsiveBlock.react","PolarisSizing","PolarisStepIndicator.react","PolarisVirtualHSnapScroll.react","getPolarisKeyCommandConfig","polarisLogAction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=400;a=1;var k=1,l=a+k,m={areaClick:null,pagerClick:"click",scroll:"scroll",swipe:null};b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=d=a.call.apply(a,[this].concat(f))||this,d.state={hoveredOver:!1,mediaWidth:d.props.initialMediaWidthGuess||0,sidecarChildIndex:d.props.initialCarouselIndex||0},d.$1=null,d.$2=!1,d.$3={},d.$4=function(a){var b=d.props,c=b.initialCarouselIndex;b=b.numSidecarChildren;d.$1=a;if(c!=null&&c>0&&c<b&&d.$2===!1){(a=d.$1)==null?void 0:a.snapToIndex(c);d.$2=!0}d.props.onSetScrollRef&&d.props.onSetScrollRef(d.$1)},d.$5=function(a){d.$2=a},d.$6=function(a){return Math.min(Math.pow(Math.abs(a),.75)*3,j)},d.$9=function(a){d.setState({mediaWidth:a})},d.$10=function(a){a=a.interactionType;a=m[a];a!=null&&!d.$3[a]&&(c("polarisLogAction")("sidecarEngagement",{source:" hscroll",type:a}),d.$3[a]=!0);d.props.onInteract&&d.props.onInteract()},d.$11=function(){var a=d.props,b=a.numSidecarChildren,c=a.onChildIndexChange,e=d.state.sidecarChildIndex,f=(a=(a=d.$1)==null?void 0:a.getCurrentIndex())!=null?a:0;f!==e&&f>=0&&f<b&&d.setState({sidecarChildIndex:f},function(){c&&c(e,f,b)})},b)||babelHelpers.assertThisInitialized(d)}var e=b.prototype;e.$7=function(){this.setState({hoveredOver:!0})};e.$8=function(){this.setState({hoveredOver:!1})};e.$12=function(){var a;return i.jsx(c("PolarisStepIndicator.react"),{className:"x6s0dn4 x1oozmrk x4r51d9 xi8xln7 xl56j7k x47corl x10l6tqk",numSteps:this.props.numSidecarChildren,selectedStep:this.state.sidecarChildIndex,style:(a=this.props.stepIndicatorStyle)!=null?a:"overlay"})};e.$13=function(){var a=this.props,b=a.dimensions;a=a.numSidecarChildren;if(a===0)return null;a=b.toSorted(function(a,b){a=a.width/a.height;b=b.width/b.height;return a-b})[0];if(!a)return null;b=d("PolarisSizing").getHeightPercent(a);a={paddingBottom:b+"%"};return i.jsx("div",babelHelpers["extends"]({className:"x1qjc9v5 x972fbf xcfux6l x1qhh985 xm0m39n x9f619 x1lliihq xdt5ytf x2lah0s xdj266r x11i5rnm xat24cr x1mh8g0r xexx8yu x4uap5 x18d9i69 xkhd6sd x1n2onr6"},{style:a}))};e.$14=function(a){var b=this;return a==="immersiveViewer"?[d("getPolarisKeyCommandConfig").getPolarisKeyCommandConfig("mediaViewer","goToNextIndex",function(){var a;(a=b.$1)==null?void 0:a.snapToNext()}),d("getPolarisKeyCommandConfig").getPolarisKeyCommandConfig("mediaViewer","goToPrevIndex",function(){var a;(a=b.$1)==null?void 0:a.snapToPrev()})]:[]};e.render=function(){var a=this,b=this.props,e=b.autoScrollOnFocus,f=b.initialCarouselIndex,g=b.mediaFooter;b=b.numSidecarChildren;var h=this.state.mediaWidth,j=this.$12(),m=!this.props.hoverTriggeredPager,n=this.$14(this.props.stepIndicatorStyle);return i.jsxs("div",babelHelpers["extends"]({className:"x1qjc9v5 x972fbf xcfux6l x1qhh985 xm0m39n x9f619 x78zum5 xdt5ytf x2lah0s x17qophe xdj266r x11i5rnm xat24cr x1mh8g0r xexx8yu x4uap5 x18d9i69 xkhd6sd x1n2onr6 x13vifvy x11njtxf"},{onMouseEnter:function(){a.$7()},onMouseLeave:function(){a.$8()},ref:this.props.containerRef,children:[i.jsxs(c("PolarisResponsiveBlock.react"),{className:"x1lliihq x1n2onr6",onResize:this.$9,children:[this.$13(),h>0&&i.jsx(c("IGDSBox.react"),{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:i.jsx(c("PolarisVirtualHSnapScroll.react"),{animationDuration:this.$6,autoScrollOnFocus:e,initialIndex:(e=f)!=null?e:0,initialNextPagerVisibleGuess:f!=null&&f<b,initialPreviousPagerVisibleGuess:f!=null&&f>0,initialVisibleItemsGuess:l,itemWidth:h,navigationCommands:n,onInteract:this.$10,onVisibilityChange:this.$11,overscan:this.props.renderAllSidecarChildren===!0?b:k,pagerDisabled:!m&&!this.state.hoveredOver,pagerVariant:d("PolarisPagerButton.react").PAGER_BUTTON_VARIANTS.sidecar,scrollRef:this.$4,setScrollRefMounted:this.$5,children:this.props.renderSidecarChildren(this.state.mediaWidth,this.state.sidecarChildIndex)})})]}),g,j]}))};return b}(i.PureComponent);e=b;g._Sidecar=b;g.Sidecar=e}),98);
__d("PolarisUserTagIndicatorWithSheet.react",["fbt","PolarisUserTagIndicator.react","PolarisUserTagSheet.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._("__JHASH__k2FQhmyaBWn__JHASH__");a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.$1=function(){c.props.onClick!=null&&c.props.onClick(),c.props.disableSheet!==!0&&c.setState({isUserTagSheetOpen:!0})};c.$2=function(){c.setState({isUserTagSheetOpen:!1})};c.state={isUserTagSheetOpen:!1};return c}var e=b.prototype;e.render=function(){return j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisUserTagIndicator.react"),{absolute:!0,onClick:this.$1}),this.state.isUserTagSheetOpen&&j.jsx(d("PolarisUserTagSheet.react").UserTagSheet,{mediaId:this.props.mediaId,onClose:this.$2,title:k,usertags:this.props.usertags})]})};return b}(j.PureComponent);g["default"]=a}),226);
__d("PolarisVideoLoggedOutAppUpsellOverlayBackdrop.react",["IGDSBox.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l={backdrop:{animationDuration:"x7v9bd0",animationName:"x127lhb5",backgroundColor:"x48ylwx",height:"x5yr21d",start:"x17qophe",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0},blocking:{backgroundImage:"x11v4dcs",zIndex:"x1vjfegm",$$css:!0}};function a(a){var b=j(7),d=a.children;a=a.isBlocking;a=a===void 0?!1:a;var e;b[0]!==a?(e=(h||(h=c("stylex"))).props(l.backdrop,a&&l.blocking),b[0]=a,b[1]=e):e=b[1];b[2]!==d?(a=k.jsx(c("IGDSBox.react"),{direction:"column",height:"100%",width:"100%",children:d}),b[2]=d,b[3]=a):a=b[3];b[4]!==e||b[5]!==a?(d=k.jsx("div",babelHelpers["extends"]({},e,{children:a})),b[4]=e,b[5]=a,b[6]=d):d=b[6];return d}g["default"]=a}),98);
__d("PolarisVideoLoggedOutAppUpsellOverlayCard.react",["PolarisIgLiteCarbonUpsellsUtils","PolarisLoggedOutCtaImpressionLogger","PolarisLoggedOutCtaLogger","PolarisVideoLoggedOutAppUpsellOverlayBackdrop.react","deferredLoadComponent","react","requireDeferredForDisplay","usePolarisPageID"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.c,l=c("deferredLoadComponent")(c("requireDeferredForDisplay")("PolarisLoggedOutEndOfVideoUpsell.react").__setRef("PolarisVideoLoggedOutAppUpsellOverlayCard.react")),m=c("deferredLoadComponent")(c("requireDeferredForDisplay")("PolarisLoggedOutEndOfClipUpsell.react").__setRef("PolarisVideoLoggedOutAppUpsellOverlayCard.react"));function a(a){var b=k(11);a=a.isReelsViewer;var e=a===void 0?!1:a,f=c("usePolarisPageID")();b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=d("PolarisIgLiteCarbonUpsellsUtils").isIgLiteCarbonUpsellsEligible(),b[0]=a):a=b[0];var g=a,h;b[1]!==f?(a=function(){d("PolarisLoggedOutCtaLogger").logLoggedOutCtaEvent({ctaType:"end_of_video_app_upsell",ctaVersion:g?"instagramlitecarbon":"",eventName:"impression",module:f}),d("PolarisLoggedOutCtaImpressionLogger").logLoggedOutCtaImpressionEvent("video_end",f)},h=[g,f],b[1]=f,b[2]=a,b[3]=h):(a=b[2],h=b[3]);j(a,h);b[4]!==e?(a=function(){return e?i.jsx(m,{}):i.jsx(l,{})},b[4]=e,b[5]=a):a=b[5];h=a;b[6]!==h?(a=h(),b[6]=h,b[7]=a):a=b[7];b[8]!==e||b[9]!==a?(h=i.jsx(c("PolarisVideoLoggedOutAppUpsellOverlayBackdrop.react"),{isBlocking:e,children:a}),b[8]=e,b[9]=a,b[10]=h):h=b[10];return h}g["default"]=a}),98);
__d("PolarisVideoLogger",["FBLogger","InstagramODS","PolarisConfig","PolarisLogger","PolarisNavChain","PolarisPigeonLogger","pageID"],(function(a,b,c,d,e,f,g){"use strict";e={audioDisabled:"video_audio_disabled",audioEnabled:"video_audio_enabled",bufferingFinished:"video_buffering_finished",bufferingStarted:"video_buffering_started",exited:"video_exited",failedPlaying:"video_failed_playing",formatChanged:"video_format_changed",fullViewedTime:"video_full_viewed_time",paused:"video_paused",playingUpdate:"video_playing_update",seek:"video_seek",shouldStart:"video_should_start",startedPlaying:"video_started_playing",viewabilityChanged:"instagram_video_viewability_changed",viewed:"video_viewed",viewedTime:"video_viewed_time"};function h(a){var b=a.carouselParentId,e=a.id,f=a.isAd,g=a.isDashEligible,h=a.navChain,i=a.ownerId,j=a.playbackFormat,k=a.trackingToken,l=babelHelpers.objectWithoutPropertiesLoose(a,["carouselParentId","id","isAd","isDashEligible","navChain","ownerId","playbackFormat","trackingToken"]);a=d("PolarisLogger").getExtra(a);a=a.ig_userid;i=i||"";e=e||"";b=b!=null?{carousel_media_id:e+"_"+i,m_pk:b+"_"+i}:{m_pk:e+"_"+i};return babelHelpers["extends"]({},l,b,{a_i:f===!0?"ad":"organic",a_pk:i,is_dash_eligible:g,nav_chain:(e=h)!=null?e:(l=c("PolarisNavChain").getInstance())==null?void 0:l.getNavChainForSend(),pk:a,playback_format:j,time_spent_id:c("pageID"),tracking_token:k})}function a(a){return a!=null?Number(a.toFixed(2)):null}function b(b,e,a){if(!d("PolarisConfig").isLoggedIn())return;var g=h(e);if(g.tracking_token==null){c("FBLogger")("ig_web").mustfix("Video: can't log event without a tracking token!");return}e.isAd===!0&&c("InstagramODS").incr_CAREFUL_WHEN_USE_DYNAMIC_KEY("web.ads."+a+"."+b);d("PolarisLogger").logPigeonEvent(d("PolarisPigeonLogger").createEvent(b,g,{module:a}))}g.VIDEO_EVENTS=e;g.normalizeVideoEvent=a;g.logVideoEvent=b}),98);
__d("PolarisVideoVolumeControls.react",["fbt","IGDSBox.react","IGDSIconButton.react","IGDSVolumeNonePanoFilledIcon.react","IGDSVolumeOffFilledIcon.react","IGDSVolumePanoFilledIcon.react","PolarisIGCoreButton.react","PolarisIGCoreToast.react","PolarisVideoConstants","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useState,l=b.c,m=1500,n="web-always-white",o=12,p=16,q={iconWrapperColor:{backgroundColor:"x1wunsqr",$$css:!0}},r=h._("__JHASH__sLFgHENJUFu__JHASH__");function s(a){var b=l(25),e=a.audioState,f=a.inPlayerControls,g=a.isStoryVideo;a=a.onClick;var i=g||f===!0?p:o,k;b[0]!==i?(k={color:n,size:i},b[0]=i,b[1]=k):k=b[1];i=k;var m;bb0:switch(e){case d("PolarisVideoConstants").AUDIO_STATES.on:b[2]===Symbol["for"]("react.memo_cache_sentinel")?(k=h._("__JHASH__r6uAailfqgq__JHASH__"),b[2]=k):k=b[2];b[3]!==i?(e=j.jsx(c("IGDSVolumePanoFilledIcon.react"),babelHelpers["extends"]({alt:k},i,{"data-testid":void 0})),b[3]=i,b[4]=e):e=b[4];m=e;break bb0;case d("PolarisVideoConstants").AUDIO_STATES.off:b[5]===Symbol["for"]("react.memo_cache_sentinel")?(k=h._("__JHASH__5mpM2KJQizt__JHASH__"),b[5]=k):k=b[5];b[6]!==i?(e=j.jsx(c("IGDSVolumeOffFilledIcon.react"),babelHelpers["extends"]({alt:k,"data-testid":void 0},i)),b[6]=i,b[7]=e):e=b[7];m=e;break bb0;case d("PolarisVideoConstants").AUDIO_STATES.none:b[8]===Symbol["for"]("react.memo_cache_sentinel")?(k=h._("__JHASH__QVFOACG0yrg__JHASH__"),b[8]=k):k=b[8];b[9]!==i?(e=j.jsx(c("IGDSVolumeNonePanoFilledIcon.react"),babelHelpers["extends"]({alt:k,"data-testid":void 0},i)),b[9]=i,b[10]=e):e=b[10];m=e}if(m==null)return null;if(g===!0){b[11]!==a||b[12]!==m?(k=j.jsx(c("IGDSIconButton.react"),{"aria-label":r,onClick:a,children:m}),b[11]=a,b[12]=m,b[13]=k):k=b[13];return k}b[14]!==f?(i=f===!0?{color:"transparent",marginBottom:0,marginEnd:0,padding:0}:{marginBottom:4,marginEnd:4,padding:2,xstyle:q.iconWrapperColor},b[14]=f,b[15]=i):i=b[15];e=i;g=f===!0?"relative":"absolute";b[16]!==e||b[17]!==m?(k=j.jsx(c("IGDSBox.react"),babelHelpers["extends"]({},e,{shape:"circle",children:m})),b[16]=e,b[17]=m,b[18]=k):k=b[18];b[19]!==a||b[20]!==k?(i=j.jsx(c("PolarisIGCoreButton.react"),{"aria-label":r,borderless:!0,onClick:a,children:k}),b[19]=a,b[20]=k,b[21]=i):i=b[21];b[22]!==g||b[23]!==i?(f=j.jsx(c("IGDSBox.react"),{bottom:!0,position:g,right:!0,children:i}),b[22]=g,b[23]=i,b[24]=f):f=b[24];return f}function a(a){var b=l(16),e=a.absolutePositionToast,f=a.audioState,g=a.forceMuteReason,i=a.inPlayerControls,n=a.isStoryVideo,o=a.onClick;a=e===void 0?!0:e;e=k(!1);var p=e[0],q=e[1];e=!(g==null||g==="");n=(n=n)!=null?n:!1;var r;b[0]!==o||b[1]!==f?(r=function(a){o(a),f===d("PolarisVideoConstants").AUDIO_STATES.none&&q(!0)},b[0]=o,b[1]=f,b[2]=r):r=b[2];var t;b[3]!==f||b[4]!==i||b[5]!==n||b[6]!==r?(t=j.jsx(s,{audioState:f,inPlayerControls:i,isStoryVideo:n,onClick:r}),b[3]=f,b[4]=i,b[5]=n,b[6]=r,b[7]=t):t=b[7];b[8]!==p||b[9]!==e||b[10]!==g||b[11]!==a?(i=p&&j.jsx(c("PolarisIGCoreToast.react"),{absolutePosition:a,duration:m,onClose:function(){return q(!1)},wide:!0,children:e?String(g):h._("__JHASH__W75JnMJmjFS__JHASH__")}),b[8]=p,b[9]=e,b[10]=g,b[11]=a,b[12]=i):i=b[12];b[13]!==t||b[14]!==i?(n=j.jsxs(j.Fragment,{children:[t,i]}),b[13]=t,b[14]=i,b[15]=n):n=b[15];return n}g["default"]=a}),226);
__d("XPolarisMobileAllCommentsControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/p/{shortcode}/comments/",Object.freeze({enable_persistent_cta:!1}),void 0);b=a;g["default"]=b}),98);
__d("oz-player-polaris/configs/PolarisDummyOzConfig",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){a===void 0&&(a={}),this.$1=a}var b=a.prototype;b.getBool=function(a,b){return typeof this.$1[a]===typeof b?this.$1[a]:b};b.getNumber=function(a,b){return typeof this.$1[a]===typeof b?this.$1[a]:b};b.getString=function(a,b){return typeof this.$1[a]===typeof b?this.$1[a]:b};return a}();f["default"]=a}),66);
__d("oz-player-polaris/utils/PolarisOzError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b.description)||this;c.$PolarisOzError1=b;c.name=b.type;return c}var c=b.prototype;c.getExtra=function(){return this.$PolarisOzError1.extra||{}};c.getType=function(){return this.$PolarisOzError1.type};c.getDescription=function(){return this.$PolarisOzError1.description};return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("polarisAdsSelectors.react",["PolarisContainerModuleUtils","PolarisReactRedux.react","PolarisReportConstants","polarisCreateSelectorWithArg","polarisStorySelectors","react","usePolarisAnalyticsContext","usePolarisSponsoredStoryLoggingParams","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c,j=c("polarisCreateSelectorWithArg")(function(a){return a.ads.feed},function(a){return function(b){return a.get(b)}}),k=c("polarisCreateSelectorWithArg")(function(a){return a.ads.feed},function(a){return function(b){return a.findKey(function(a){return a.ad_id===b})}}),l=c("polarisCreateSelectorWithArg")(function(a){return a.ads.story},function(a){return function(b){return a.findKey(function(a){return a.ad_id===b})}});function a(a,b){var c=i(3),e;c[0]!==a||c[1]!==b?(e=function(c){if(a==null)return null;c=j(c,a);return b(c)},c[0]=a,c[1]=b,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}function b(a,b){var c=i(3),e;c[0]!==a||c[1]!==b?(e=function(c){if(a==null)return null;c=m(c,a);return b(c)},c[0]=a,c[1]=b,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}function e(a,b){var c=i(3),e;c[0]!==b||c[1]!==a?(e=function(c){return b(c.stories.currentTrayOrder.indexOf(a))},c[0]=b,c[1]=a,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}var m=c("polarisCreateSelectorWithArg")(function(a){return a.ads.story},function(a){return function(b){return a.get(b)}});function n(a,b){var c=i(3),e;c[0]!==b||c[1]!==a?(e=function(c){if(b===d("PolarisReportConstants").FRXLocation.FEED)return k(c,a);else if(b===d("PolarisReportConstants").FRXLocation.STORY)return l(c,a);return null},c[0]=b,c[1]=a,c[2]=e):e=c[2];return d("PolarisReactRedux.react").useSelector(e)}function o(a,b,c){var e=i(4),f;e[0]!==a||e[1]!==b||e[2]!==c?(f=function(e){if(a==null)return null;var f=null;b===d("PolarisReportConstants").FRXLocation.FEED?f=j(e,a):b===d("PolarisReportConstants").FRXLocation.STORY&&(f=m(e,a));return c(f)},e[0]=a,e[1]=b,e[2]=c,e[3]=f):f=e[3];return d("PolarisReactRedux.react").useSelector(f)}function f(a,b){var e,f=i(17),g=(e=n(a,b))!=null?e:a;e=o(g,b,p);f[0]!==g?(a=function(a){return a.posts.byId.get(g)},f[0]=g,f[1]=a):a=f[1];a=d("PolarisReactRedux.react").useSelector(a);var h=d("PolarisReactRedux.react").useSelector(d("polarisStorySelectors").getCurrentReel);h=c("usePolarisSponsoredStoryLoggingParams")(h,a);a=h.adInsertedPosition;var j=h.mpk,k=h.reelId,l=h.sessionReelCounter,m=h.traySession;h=h.viewerSession;var q;f[2]===Symbol["for"]("react.memo_cache_sentinel")?(q={},f[2]=q):q=f[2];q=q;if(b===d("PolarisReportConstants").FRXLocation.STORY){f[3]!==a||f[4]!==k||f[5]!==l||f[6]!==m||f[7]!==h?(b={ad_inserted_position:a,reel_id:k,session_reel_counter:l,tray_session_id:m,viewer_session_id:h},f[3]=a,f[4]=k,f[5]=l,f[6]=m,f[7]=h,f[8]=b):b=f[8];q=b}a=c("usePolarisViewer")();k=c("usePolarisAnalyticsContext")();f[9]!==k?(l=d("PolarisContainerModuleUtils").getContainerModule(k),f[9]=k,f[10]=l):l=f[10];m=l;h=a==null?void 0:a.id;f[11]!==j||f[12]!==m||f[13]!==h||f[14]!==e||f[15]!==q?(b=babelHelpers["extends"]({m_pk:j,pigeon_reserved_keyword_module:m,pk:h,source_of_action:m,tracking_token:e},q),f[11]=j,f[12]=m,f[13]=h,f[14]=e,f[15]=q,f[16]=b):b=f[16];return b}function p(a){return a==null?void 0:a.tracking_token}g.useFeedAdInfo=a;g.useStoryAdInfo=b;g.useStoryAdPosition=e;g.useAdPostIDFromAdIDForFRX=n;g.useAdInfoForFRX=o;g.useFRXReportAdLoggingParams=f}),98);
__d("usePolarisSponsoredStoryLoggingParams",["PolarisContainerModuleUtils","PolarisInteractionsLogger","PolarisStoriesLoggingUtils","PolarisViewpointActionUtils","polarisAdsSelectors.react","polarisRelationshipSelectors.react","polarisStorySelectors","react","usePolarisAnalyticsContext","usePolarisSelector","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a,b){var e,f=i(41),g=d("polarisAdsSelectors.react").useStoryAdInfo(b==null?void 0:b.id,m),h;f[0]!==a?(h=function(b){return b.stories.currentTrayOrder.indexOf(a==null?void 0:a.id)},f[0]=a,f[1]=h):h=f[1];h=c("usePolarisSelector")(h);var n;f[2]!==h?(n=h.toString(),f[2]=h,f[3]=n):n=f[3];h=n;n=(n=a==null?void 0:a.isSponsored)!=null?n:!1;var o=c("usePolarisSelector")(l),p=c("usePolarisAnalyticsContext")(),q;f[4]!==p?(q=d("PolarisContainerModuleUtils").getContainerModule(p),f[4]=p,f[5]=q):q=f[5];p=q;q=d("polarisRelationshipSelectors.react").useRelationship((q=b==null?void 0:b.ownerId)!=null?q:"");var r;f[6]!==q?(r=q!=null?d("PolarisViewpointActionUtils").getFollowStatus(q):null,f[6]=q,f[7]=r):r=f[7];q=r;f[8]!==a?(r=function(b){return d("polarisStorySelectors").getGapToPreviousAd(b,a==null?void 0:a.id)},f[8]=a,f[9]=r):r=f[9];r=c("usePolarisSelector")(r);var s;f[10]!==b?(s=b!=null?d("PolarisInteractionsLogger").getMediaTypeFromPost(b).toString():null,f[10]=b,f[11]=s):s=f[11];s=s;if(f[12]!==b){var t;t=b!=null?d("PolarisViewpointActionUtils").getMPKForStoryMedia(b.id,(t=b.owner)==null?void 0:t.id):null;f[12]=b;f[13]=t}else t=f[13];t=t;var u=b==null?void 0:b.owner;u=u==null?void 0:u.id;if(f[14]!==(b==null?void 0:b.postedAt)){var v;v=b==null?void 0:(v=b.postedAt)==null?void 0:v.toString();f[14]=b==null?void 0:b.postedAt;f[15]=v}else v=f[15];v=v;var w=a==null?void 0:a.id;if(f[16]!==(a==null?void 0:(e=a.itemIds)==null?void 0:e.length)){var x;e=a==null?void 0:(e=a.itemIds)==null?void 0:e.length.toString();f[16]=a==null?void 0:(x=a.itemIds)==null?void 0:x.length;f[17]=e}else e=f[17];x=e;e=a==null?void 0:a.type;var y;f[18]!==e?(y=d("PolarisStoriesLoggingUtils").getTypeForLogging(e),f[18]=e,f[19]=y):y=f[19];e=y;var z;f[20]===Symbol["for"]("react.memo_cache_sentinel")?(y=d("PolarisStoriesLoggingUtils").StoriesLoggingSession.getData(),z=y.reelCounter.toString(),f[20]=z,f[21]=y):(z=f[20],y=f[21]);z=z;b=d("polarisAdsSelectors.react").useStoryAdInfo(b==null?void 0:b.id,k);var A=c("usePolarisSelector")(d("polarisStorySelectors").getStoriesContent);A=A.traySession;var B=c("usePolarisSelector")(j),C=c("usePolarisViewer")();C=C==null?void 0:C.id;f[22]!==g||f[23]!==h||f[24]!==p||f[25]!==q||f[26]!==r||f[27]!==n||f[28]!==s||f[29]!==t||f[30]!==u||f[31]!==v||f[32]!==w||f[33]!==x||f[34]!==e||f[35]!==o||f[36]!==b||f[37]!==A||f[38]!==C||f[39]!==B?(y={adId:g,adInsertedPosition:h,containerModule:p,followStatus:q,gapToLastAd:r,isReelSponsored:n,loggingData:y,mediaType:s,mpk:t,ownerId:u,postedAt:v,reelId:w,reelSize:x,reelType:e,reelViewerPosition:h,sessionReelCounter:z,storyAdInjectionData:o,trackingToken:b,traySession:A,viewerId:C,viewerSession:B},f[22]=g,f[23]=h,f[24]=p,f[25]=q,f[26]=r,f[27]=n,f[28]=s,f[29]=t,f[30]=u,f[31]=v,f[32]=w,f[33]=x,f[34]=e,f[35]=o,f[36]=b,f[37]=A,f[38]=C,f[39]=B,f[40]=y):y=f[40];return y}function j(a){return a.stories.viewerSession}function k(a){return a==null?void 0:a.tracking_token}function l(a){return a.ads.storyAdInjectionData}function m(a){return a==null?void 0:a.ad_id}g["default"]=a}),98);
__d("polarisGetXDTMediaDict",["igMapTypenameToRelayID"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=c("igMapTypenameToRelayID")("XDTMediaDict",b,null);return a.get(b)}g["default"]=a}),98);
__d("usePolarisOzPlayer",["FBLogger","InstagramODS","JSResourceForInteraction","PolarisOzConfigMobileDefault","PolarisUA","asyncToGeneratorRuntime","gkx","justknobx","once","oz-player-polaris/configs/PolarisDummyOzConfig","oz-player-polaris/utils/PolarisOzError","polarisManifestHasUnsupportedCodecs","react"],(function(a,b,c,d,e,f,g){"use strict";var h;f=h||d("react");var i=f.useEffect,j=f.useRef,k=f.useState;function a(a){if(!c("justknobx")._("90"))return!1;if(d("PolarisUA").isFirefox())return!1;a=a.dashInfo;if(a==null)return!1;var b=a.is_dash_eligible;a=a.video_dash_manifest;if(!b||a==null||!l())return!1;if(c("polarisManifestHasUnsupportedCodecs")(a)){c("InstagramODS").incr("web.video.unsupported.codec");return!1}return d("PolarisUA").isDesktop()}var l=c("once")(function(){var a=!0;c("InstagramODS").incr("web.video.oz_player_support_check");window.MediaSource||(a=!1,c("InstagramODS").incr("web.video.oz_player_media_source_failed"));(!window.fetch||!window.AbortController)&&(a=!1,c("InstagramODS").incr("web.video.oz_player_fetch_abort_failed"));var b=!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration;b||(a=!1,c("InstagramODS").incr("web.video.oz_player_drm_support_failed"));if(window.ReadableStream)try{new ReadableStream({})}catch(b){a=!1,c("InstagramODS").incr("web.video.oz_player_readable_stream_use_failed")}else a=!1,c("InstagramODS").incr("web.video.oz_player_readable_stream_failed");window.Headers||(a=!1,c("InstagramODS").incr("web.video.oz_player_headers_failed"));(!((b=window.URL)==null?void 0:b.createObjectURL)||!Blob)&&(a=!1,c("InstagramODS").incr("web.video.oz_player_blob_url_failed"));c("gkx")("25408")||(a=!1,c("InstagramODS").incr("web.video.oz_player_gk_failed"));a||c("InstagramODS").incr("web.video.oz_player_support_failed");return a}),m=c("once")(function(){var a=d("PolarisUA").isMobile()?Object.assign({},d("PolarisOzConfigMobileDefault").defaultBools,d("PolarisOzConfigMobileDefault").defaultNumbers,d("PolarisOzConfigMobileDefault").defaultStrings):{cleanup_video_node_on_destroy:!1};return new(c("oz-player-polaris/configs/PolarisDummyOzConfig"))(a)});function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){a===void 0&&(a=null);var e=(yield c("JSResourceForInteraction")("oz-player-polaris").__setRef("usePolarisOzPlayer").load()),f=m(),g={height:b.offsetHeight,width:b.offsetWidth};return a!=null?new e({config:f,customRepresentationParsers:d,dimensions:g,rawMpdXml:a,videoNodeOrQuickStarter:b}):new e({config:f,customRepresentationParsers:d,dimensions:g,videoNodeOrQuickStarter:b})});return o.apply(this,arguments)}function p(a){var b=["oz_player_error -"];b.push("name: "+a.name);b.push("message: "+a.message);a.description!=null&&a.description.length>0&&b.push("description: "+a.description);if(a instanceof c("oz-player-polaris/utils/PolarisOzError")){a=a.getExtra();a.code!=null&&b.push("code: "+a.code)}return b.join(" ")}function q(a,b,c){b!=null&&a.src!==b&&(a.src=b),c&&c()}function e(a,b,d,e,f){a===void 0&&(a=null);b===void 0&&(b=null);var g=k(!1),h=g[0],l=g[1],m=j(null),o=j(null),r=j(e);i(function(){if(d!=null&&m.current==null&&o.current==null){var e=r.current,g=e.customRepresentationParsers,h=e.onPlayerReady,i=e.onSwitchVideoRepresentation;e=n(b,d,g).then(function(b){m.current=b,b.onError(function(a){c("FBLogger")("ig_web").catching(new Error(p(a)))}),b.addListener("enter_buffering",function(){d.playbackRate=0}),b.addListener("leave_buffering",function(){d.playbackRate=1}),b.addListener("mpd_ready",function(){c("InstagramODS").incr("web.video.load_manifest_successful"),l(!0),h&&h()}),b.addListener("switchVideoRepresentation",function(){if(i!=null){var a=d.currentTime;a=b.getVideoRepresentationIDAtTime(a);a!=null&&i(a)}}),c("InstagramODS").incr("web.video.load_manifest_request"),b.load(a)})["catch"](function(){c("FBLogger")("ig_web").catching(new Error("oz_player_error: failed to create the oz player")),c("InstagramODS").incr("web.video.load_manifest_failed"),m.current!=null?m.current.destroy().then(function(){q(d,f,h)}):q(d,f,h)});o.current=e}return function(){o.current!=null&&(o.current=null),m.current!=null&&(m.current.destroy(),m.current=null)}},[f,a,b,d]);return{manifestLoaded:h,ozPlayer:m.current}}g.shouldUseOzForPostVideo=a;g.useOzPlayer=e}),98);
__d("polarisVideoUtils",["PolarisConfig","PolarisContainerModuleUtils","PolarisIsLoggedInDesktop","PolarisRelationshipTypes","PolarisUA","PolarisVideoConstants","PolarisVideoLogger","usePolarisOzPlayer"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){if(!o())return!1;a=h(c);return a!=null&&a>d("PolarisVideoConstants").VIDEO_PREVIEW_DURATION_SECONDS}function h(a){return a&&a.getCurrentTime()}function b(a){return d("usePolarisOzPlayer").shouldUseOzForPostVideo(a)?a.dashInfo:void 0}function c(a){return a?"metadata":"none"}function e(a){return(a==null?void 0:(a=a.followedByViewer)==null?void 0:a.state)===d("PolarisRelationshipTypes").FOLLOW_STATUS_FOLLOWING?"following":"not_following"}function f(a,b){if(a===d("PolarisVideoConstants").AUDIO_STATES.none)return!0;return b!==!0?!1:a!==d("PolarisVideoConstants").AUDIO_STATES.on}function i(a,b){a=a==null?void 0:a.getVideo();if(a===null)return!0;a=(a==null?void 0:a.muted)===!0||(a==null?void 0:a.volume)===0;return a&&b}function j(a){return n(a)&&d("PolarisIsLoggedInDesktop").isLoggedInDesktop()?!1:!0}function k(a){return a===d("PolarisVideoConstants").PLAYER_STATES.playing||a===d("PolarisVideoConstants").PLAYER_STATES.requestedPlay}function l(a){var b=h(a)||0;a=a&&a.getDuration();return a!=null&&a!==0?b/a:0}function m(a){return a&&a.getPauseTime()}function n(a){return a==="feed"||a==="feedPage"||a==="followingFeedPage"||a==="favoritesFeedPage"||a==="pastPostsFeedPage"}function o(){return!1}function p(a,b,c){d("PolarisConfig").isLoggedIn()&&d("PolarisVideoLogger").logVideoEvent(b,c,d("PolarisContainerModuleUtils").getContainerModule(a))}function q(a){if(o())return!0;a=n(a);return d("PolarisUA").isMobile()||a}function r(a,b){return o()}g.didReachEndOfIGTVPreview=a;g.getCurrentVideoTime=h;g.getDashInfo=b;g.getDeclarativeVideoPreload=c;g.getFollowingStatus=e;g.getShouldMuteAudio=f;g.getShouldStopVideoInBackground=i;g.getShouldStopVideoWhenNotVisible=j;g.getShouldVideoLoop=k;g.getTimeAsPercentage=l;g.getTimeAtVideoPause=m;g.isFeed=n;g.isIGTVFeedPreview=o;g.logVideoEventWrapper=p;g.shouldCenterCropPosterHeight_LEGACY=q;g.shouldCenterCropVideoHeight=r}),98);
__d("polarisVideoEventLogger",["InstagramODS","PolarisVideoLogger","polarisVideoUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.adTrackingToken,c=a.carouselParentId,d=a.dashInfo,e=a.extras,f=a.id,g=a.isAd,h=a.navChain,i=a.ownerId,j=a.streamingFormat,k=a.trackingToken;a=a.videoWidth;var l=(d==null?void 0:d.is_dash_eligible)?1:0;(d==null?void 0:d.video_dash_manifest)!=null;d=j==="dash"?"dash":"progressive";e=babelHelpers["extends"]({},e,{carouselParentId:c,id:f||"",isAd:!1,isDashEligible:l,navChain:h,ownerId:(j=i)!=null?j:"",playbackFormat:d,trackingToken:g===!0&&b!=null?b:k});a!=null&&a!==0&&(e.video_width=a);g===!0&&(e.isAd=g);return e}function a(a){return a==null?null:{adTrackingToken:a==null?void 0:a.tracking_token,isAd:!!a}}function b(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.currentVideoTime,g=a.dashInfo,i=a.duration,j=a.id,k=a.isAd,l=a.loopsCount,m=a.navChain,n=a.ownerId,o=a.sequenceNumber,p=a.streamingFormat,q=a.trackingToken;a=a.videoWidth;i={duration:d("PolarisVideoLogger").normalizeVideoEvent(i),loop_count:l,seq_num:o,time:d("PolarisVideoLogger").normalizeVideoEvent(f)};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.audioEnabled,h({adTrackingToken:b,carouselParentId:e,dashInfo:g,extras:i,id:j,isAd:k,navChain:m,ownerId:n,streamingFormat:p,trackingToken:q,videoWidth:a}))}function e(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.currentVideoTime,g=a.dashInfo,i=a.duration,j=a.id,k=a.isAd,l=a.loopsCount,m=a.navChain,n=a.ownerId,o=a.sequenceNumber,p=a.streamingFormat,q=a.trackingToken;a=a.videoWidth;i={duration:d("PolarisVideoLogger").normalizeVideoEvent(i),loop_count:l,seq_num:o,time:d("PolarisVideoLogger").normalizeVideoEvent(f)};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.audioDisabled,h({adTrackingToken:b,carouselParentId:e,dashInfo:g,extras:i,id:j,isAd:k,navChain:m,ownerId:n,streamingFormat:p,trackingToken:q,videoWidth:a}))}function f(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.dashInfo,g=a.followingStatus,i=a.id,j=a.isAd,k=a.lastStartPosition,l=a.loopsCount,m=a.navChain,n=a.ownerId,o=a.postedAt,p=a.sequenceNumber,q=a.streamingFormat,r=a.timeAsPercent,s=a.trackingToken;a=a.videoWidth;g={follow_status:(g=g)!=null?g:"not_following",loop_count:l,lsp:d("PolarisVideoLogger").normalizeVideoEvent(k),m_ts:o,playing_audio:1,radio_type:"none-none",seq_num:p,timeAsPercent:r};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.bufferingFinished,h({adTrackingToken:b,carouselParentId:e,dashInfo:f,extras:g,id:i,isAd:j,navChain:m,ownerId:n,streamingFormat:q,trackingToken:s,videoWidth:a}))}function i(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.dashInfo,g=a.followingStatus,i=a.id,j=a.isAd,k=a.loopsCount,l=a.navChain,m=a.ownerId,n=a.postedAt,o=a.sequenceNumber,p=a.streamingFormat,q=a.timeAsPercent,r=a.trackingToken;a=a.videoWidth;g={follow_status:(g=g)!=null?g:"not_following",loop_count:k,m_ts:n,playing_audio:1,radio_type:"none-none",seq_num:o,timeAsPercent:q};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.bufferingStarted,h({adTrackingToken:b,carouselParentId:e,dashInfo:f,extras:g,id:i,isAd:j,navChain:l,ownerId:m,streamingFormat:p,trackingToken:r,videoWidth:a}))}function j(a){var b=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.dashInfo,i=a.duration,j=a.exitTime,k=a.hasPlayedVideo,l=a.id,m=a.isAd,n=a.lastStartPosition,o=a.loopsCount,p=a.navChain,q=a.ownerId,r=a.sequenceNumber,s=a.streamingFormat,t=a.trackingToken;a=a.videoWidth;if(k){i={duration:(k=d("PolarisVideoLogger")).normalizeVideoEvent(i),loop_count:o,lsp:k.normalizeVideoEvent(n),playing_audio:1,seq_num:r,time:k.normalizeVideoEvent(j)};c("InstagramODS").incr("web.video.old.log_video_exited");d("polarisVideoUtils").logVideoEventWrapper(e,k.VIDEO_EVENTS.exited,h({adTrackingToken:b,carouselParentId:f,dashInfo:g,extras:i,id:l,isAd:m,navChain:p,ownerId:q,streamingFormat:s,trackingToken:t,videoWidth:a}))}}function k(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.currentVideoTime,g=a.dashInfo,i=a.droppedFrameCount,j=a.id,k=a.isAd,l=a.lastStartPosition,m=a.loopsCount,n=a.navChain,o=a.ownerId,p=a.representationId,q=a.sequenceNumber,r=a.streamingFormat,s=a.totalFrameCount,t=a.trackingToken;a=a.videoWidth;m={loop_count:m,lsp:d("PolarisVideoLogger").normalizeVideoEvent(l),playing_audio:1,representation_id:p,seq_num:q,time:d("PolarisVideoLogger").normalizeVideoEvent(f)};s!=null&&i!=null&&(m.total_frame_count=s,m.dropped_frame_count=i);d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.formatChanged,h({adTrackingToken:b,carouselParentId:e,dashInfo:g,extras:m,id:j,isAd:k,navChain:n,ownerId:o,streamingFormat:r,trackingToken:t,videoWidth:a}))}function l(a){var b=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.currentVideoTime,i=a.dashInfo,j=a.droppedFrameCount,k=a.duration,l=a.id,m=a.isAd,n=a.lastStartPosition,o=a.loopsCount,p=a.navChain,q=a.ownerId,r=a.playingAudio;r=r===void 0?1:r;var s=a.representationID,t=a.sequenceNumber,u=a.streamingFormat,v=a.totalFrameCount,w=a.trackingToken;a=a.videoWidth;k={duration:d("PolarisVideoLogger").normalizeVideoEvent(k),loop_count:o,lsp:d("PolarisVideoLogger").normalizeVideoEvent(n),playing_audio:r,seq_num:t,time:d("PolarisVideoLogger").normalizeVideoEvent(g)};v!=null&&j!=null&&(k.total_frame_count=v,k.dropped_frame_count=j);s!=null&&(k.representation_id=s);c("InstagramODS").incr("web.video.old.log_video_paused");d("polarisVideoUtils").logVideoEventWrapper(e,d("PolarisVideoLogger").VIDEO_EVENTS.paused,h({adTrackingToken:b,carouselParentId:f,dashInfo:i,extras:k,id:l,isAd:m,navChain:p,ownerId:q,streamingFormat:u,trackingToken:w,videoWidth:a}))}function m(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.dashInfo,g=a.fromTime,i=a.id,j=a.isAd,k=a.navChain,l=a.ownerId,m=a.sequenceNumber,n=a.streamingFormat,o=a.toTime,p=a.trackingToken;a=a.videoWidth;g={from_time:d("PolarisVideoLogger").normalizeVideoEvent(g),radio_type:"none-none",seq_num:m,to_time:d("PolarisVideoLogger").normalizeVideoEvent(o)};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.seek,h({adTrackingToken:b,carouselParentId:e,dashInfo:f,extras:g,id:i,isAd:j,navChain:k,ownerId:l,streamingFormat:n,trackingToken:p,videoWidth:a}))}function n(a){var b=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.currentVideoTime,i=a.dashInfo,j=a.id,k=a.isAd,l=a.navChain,m=a.ownerId,n=a.reason;n=n===void 0?"autoplay":n;var o=a.sequenceNumber,p=a.streamingFormat,q=a.trackingToken;a=a.videoWidth;n={reason:n,seq_num:o,time:d("PolarisVideoLogger").normalizeVideoEvent(g)};c("InstagramODS").incr("web.video.old.log_video_should_start");d("polarisVideoUtils").logVideoEventWrapper(e,d("PolarisVideoLogger").VIDEO_EVENTS.shouldStart,h({adTrackingToken:b,carouselParentId:f,dashInfo:i,extras:n,id:j,isAd:k,navChain:l,ownerId:m,streamingFormat:p,trackingToken:q,videoWidth:a}))}function o(a){var b=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.currentVideoTime,i=a.dashInfo,j=a.droppedFrameCount,k=a.id,l=a.isAd,m=a.lastShouldStartTime,n=a.navChain,o=a.ownerId,p=a.reason;p=p===void 0?"autoplay":p;var q=a.sequenceNumber,r=a.streamingFormat,s=a.totalFrameCount,t=a.trackingToken;a=a.videoWidth;m=m===0?0:d("PolarisVideoLogger").normalizeVideoEvent(Date.now()-m);p={reason:p,seq_num:q,start_delay:m,time:d("PolarisVideoLogger").normalizeVideoEvent(g)};s!=null&&j!=null&&(p.total_frame_count=s,p.dropped_frame_count=j);c("InstagramODS").incr("web.video.old.log_video_started_playing");d("polarisVideoUtils").logVideoEventWrapper(e,d("PolarisVideoLogger").VIDEO_EVENTS.startedPlaying,h({adTrackingToken:b,carouselParentId:f,dashInfo:i,extras:p,id:k,isAd:l,navChain:n,ownerId:o,streamingFormat:r,trackingToken:t,videoWidth:a}))}function p(a){var b,c=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.dashInfo,i=a.duration,j=a.id,k=a.isAd,l=a.lastStartPosition,m=a.loopCount,n=a.navChain,o=a.ownerId,p=a.sequenceNumber,q=a.streamingFormat,r=a.timeAtVideoPause,s=a.trackingToken;a=a.videoWidth;i={duration:(b=d("PolarisVideoLogger")).normalizeVideoEvent(i),loop_count:m,lsp:b.normalizeVideoEvent(l),seq_num:p,time:b.normalizeVideoEvent(r)};d("polarisVideoUtils").logVideoEventWrapper(e,b.VIDEO_EVENTS.fullViewedTime,h({adTrackingToken:c,carouselParentId:f,dashInfo:g,extras:i,id:j,isAd:k,navChain:n,ownerId:o,streamingFormat:q,trackingToken:s,videoWidth:a}))}function q(a){var b,c=a.adTrackingToken,e=a.analyticsContext,f=a.carouselParentId,g=a.dashInfo,i=a.duration,j=a.id,k=a.isAd,l=a.lastStartPosition,m=a.loopCount,n=a.navChain,o=a.ownerId,p=a.sequenceNumber,q=a.streamingFormat,r=a.timeAtVideoPause,s=a.trackingToken;a=a.videoWidth;i={duration:(b=d("PolarisVideoLogger")).normalizeVideoEvent(i),loop_count:m,lsp:b.normalizeVideoEvent(l),seq_num:p,time:b.normalizeVideoEvent(r)};d("polarisVideoUtils").logVideoEventWrapper(e,b.VIDEO_EVENTS.viewedTime,h({adTrackingToken:c,carouselParentId:f,dashInfo:g,extras:i,id:j,isAd:k,navChain:n,ownerId:o,streamingFormat:q,trackingToken:s,videoWidth:a}))}function r(a){var b=a.adTrackingToken,c=a.analyticsContext,e=a.carouselParentId,f=a.currentVideoTime,g=a.currentViewabilityPercentage,i=a.dashInfo,j=a.id,k=a.isAd,l=a.navChain,m=a.ownerId,n=a.sequenceNumber,o=a.streamingFormat;a=a.trackingToken;g={current_viewability_percentage:g,seq_num:n,video_time_position:d("PolarisVideoLogger").normalizeVideoEvent(f)};d("polarisVideoUtils").logVideoEventWrapper(c,d("PolarisVideoLogger").VIDEO_EVENTS.viewabilityChanged,h({adTrackingToken:b,carouselParentId:e,dashInfo:i,extras:g,id:j,isAd:k,navChain:l,ownerId:m,streamingFormat:o,trackingToken:a}))}g.getAdLoggingParams=a;g.logAudioEnabled=b;g.logAudioDisabled=e;g.logVideoBufferingFinished=f;g.logVideoBufferingStarted=i;g.logVideoExitedEvent=j;g.logVideoFormatChanged=k;g.logVideoPausedEvent=l;g.logVideoSeekingEnded=m;g.logVideoShouldStart=n;g.logVideoStartedPlaying=o;g.logVideoFullViewedTime=p;g.logVideoViewedTime=q;g.logVideoViewabilityChanged=r}),98);
__d("useIGDSecureShareSheetInteractionLogger",["MessengerWebUXLogger","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function j(a){var b=a.messageLength,c=a.recipientIDs,d=a.shareType;a=a.source;d={shareType:d,source:a};c!=null&&(d.recipientIDs=JSON.stringify(c));b!=null&&(d.messageLength=b.toString());return d}function a(a,b){var d=i(5),e;d[0]!==a?(e=j(a),d[0]=a,d[1]=e):e=d[1];var f;d[2]!==e||d[3]!==a.flowInstanceId?(f={eventName:"igd_sharesheet_impression",extraData:e,flowInstanceId:a.flowInstanceId},d[2]=e,d[3]=a.flowInstanceId,d[4]=f):f=d[4];return c("MessengerWebUXLogger").useImpressionLoggerRef(f,b)}function b(){var a=i(2),b=c("MessengerWebUXLogger").useInteractionLogger(),d;a[0]!==b?(d=function(a,c){b==null?void 0:b({eventName:a,extraData:j(c),flowInstanceId:c.flowInstanceId})},a[0]=b,a[1]=d):d=a[1];return d}g.useLogShareSheetImpressionRef=a;g.useLogShareSheetInteraction=b}),98);
__d("usePolarisNavigateToLogin",["PolarisLinkBuilder","PolarisNavigationActions","PolarisReactRedux.react","PolarisUA","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c;function a(a,b){var c=i(4),e=d("PolarisReactRedux.react").useDispatch(),f;c[0]!==e||c[1]!==a||c[2]!==b?(f=function(c){var f;bb2:switch(c){case"comment":f="post_feedback_comment";break bb2;case"direct":f="post_feedback_direct";break bb2;case"like":f="post_feedback_like";break bb2;case"save":default:f="post_feedback_save"}d("PolarisUA").isDesktop()?e(d("PolarisNavigationActions").openLoginModal("feature_wall",d("PolarisLinkBuilder").buildMediaLink(a),f)):e(d("PolarisNavigationActions").openLoggedOutIntentDialog(f,b))},c[0]=e,c[1]=a,c[2]=b,c[3]=f):f=c[3];return f}g["default"]=a}),98);
__d("usePolarisPostShowSavedToastHandler",["fbt","PolarisLinkBuilder","PolarisPostToastProvider.react","PolarisSavedPostsTypes","react","usePolarisViewer"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||d("react")).useCallback;function a(){var a=d("PolarisPostToastProvider.react").usePostToastContext(),b=c("usePolarisViewer")();return j(function(){var c;d("PolarisPostToastProvider.react").showPostToast(babelHelpers["extends"]({},a,{ActionText:h._("__JHASH__vD_V0nwq90r__JHASH__"),BodyText:h._("__JHASH__Ohp7zsmQCxJ__JHASH__"),actionHref:d("PolarisLinkBuilder").buildUserSavedCollectionLink((c=b==null?void 0:b.username)!=null?c:"",d("PolarisSavedPostsTypes").ALL_POSTS_SAVED_COLLECTION_PATH,d("PolarisSavedPostsTypes").SAVED_COLLECTION_TYPE.ALL_MEDIA_AUTO_COLLECTION)}))},[a,b==null?void 0:b.username])}g["default"]=a}),226);/*FB_PKG_DELIM*/
__d("EARInitType",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["EB_INIT","LS_INIT","MAW_INIT","MAW_RP_INIT","MAW_IN_UI_INIT"]);c=a;f["default"]=c}),66);
__d("EBAPI",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=(a=c("requireDeferred"))("EBLSMessagePointQuery").__setRef("EBAPI"),i=a("EBLSMessageRangeQuery").__setRef("EBAPI"),j=a("EBMessageMetadataQuery").__setRef("EBAPI"),k=a("EBMessageRangeQueryForIndexing").__setRef("EBAPI"),l=a("EBUploadReceivedMessages").__setRef("EBAPI"),m=a("EBUploadSentMessage").__setRef("EBAPI"),n=a("MAWEncryptedBackupsRestoreMessageOverGraphQL").__setRef("EBAPI");b={messageMetadataQuery:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return j.load().then(function(a){return a.messageMetadataQuery.apply(a,b)})},messagePointQuery:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return h.load().then(function(a){return a.messagePointQuery.apply(a,b)})},messagePointQueryGQL:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return n.load().then(function(a){return a.getPointRestoreResponseFromGQL.apply(a,b.concat(["GQL_MAIN_THREAD"]))})},messageRangeQuery:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return i.load().then(function(a){return a.messageRangeQuery.apply(a,b)})},messageRangeQueryForIndexing:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return k.load().then(function(a){return a.messageRangeQueryForIndexing.apply(a,b)})},uploadReceivedMessages:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return l.load().then(function(a){return a.uploadReceivedMessages.apply(a,b)})},uploadSentMessage:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return m.load().then(function(a){return a.uploadSentMessage.apply(a,b)})}};d=b;g["default"]=d}),98);
__d("EncryptedBackupsDYITypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({NotStarted:0,InProgress:1,Completed:2,Failed:3});c=b("$InternalEnum")({Armadillo:0,Instamadillo:1});f.EncryptedBackupsDYIState=a;f.EncryptedBackupsDYIConfig=c}),66);
__d("EphemeralMediaViewMode",[],(function(a,b,c,d,e,f){a=Object.freeze({READ_ONCE:0,REPLAYABLE:1,PERMANENT:2});f["default"]=a}),66);
__d("LSContactUtils",["I64","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return!(h||(h=d("I64"))).equal(a.blockedByViewerStatus,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED))}function b(a){return(a=d("LSContactBitOffset").has(66,a))!=null?a:!1}g.isContactBlocked=a;g.isContactRestricted=b}),98);
__d("LSDataTraceTag",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;e=4;var g=5,h=6,i=7,j=20,k=21,l=22,m=23,n=24,o=25,p=26,q=27,r=28,s=29,t=30,u=31,v=32,w=33,x=34,y=35,z=36,A=37,B=38,C=39,D=40,E=41,F=42;f.none=a;f.sticker=b;f.image=c;f.animatedImage=d;f.video=e;f.audio=g;f.file=h;f.xma=i;f.messageTypeNone=j;f.messageTypeText=k;f.messageTypeFutureproof=l;f.messageTypeCiphertext=m;f.messageTypeUnavailable=n;f.messageTypeImage=o;f.messageTypeVideo=p;f.messageTypePtt=q;f.messageTypeAdmin=r;f.messageTypeRevoked=s;f.messageTypeGif=t;f.messageTypeSticker=u;f.messageTypeExpiredEphemeral=v;f.messageTypeEphemeralSettingAdmin=w;f.messageTypeEphemeralSyncResponse=x;f.messageTypeEphemeralScreenshotAction=y;f.messageTypeDeleteForMe=z;f.messageTypeEphemeralSettingChangeFromCurrentDevice=A;f.messageTypeAlertICDC=B;f.messageTypeGroupInvite=C;f.messageTypeXMA=D;f.messageTypeReaction=E;f.messageTypeSenderKeyDistribution=F}),66);
__d("LSHotEmojiSize",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,SMALL:1,MEDIUM:2,LARGE:3});f["default"]=a}),66);
__d("LSMEBTaskCreationSource",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:-1,TEST_ONLY:0,TAM:1,MEM:2,RETROACTIVE_BACKUP:3,TAM_WEB:4,ACT_MESSAGE_DELETE:5,ACT_THREAD_DELETE:6,ACT_UPDATE_ATTACHMENT:7,TAM_PERSISTENCE_TASK:8,TAM_XMA_TOMBSTONE:9,MEM_RECEIVE:10,MEM_SEND:11,MEM_PEER_SYNC:12,MEM_RECEIVE_PROTOBUF:13,MEM_SEND_PROTOBUF:14,MEM_PEER_SYNC_PROTOBUF:15,EB_ADD_DEVICE:21,OPTIMISTIC_THREAD_CREATE_VIA_SHIM:22,ACT_THREAD_INSERT_VIA_SHIM:23,MI_THREAD_INSERT_VIA_SHIM:24,POINT_QUERY_FROM_EB:25,MESSENGER_SEARCH:26,ACT_MESSAGE_RANGE_TASK_HANDLER:27,POINT_QUERY_ON_FULLY_LOADED_THREAD:28,THREAD_CUTOVER:29,HYBRID_THREAD_VERIFY_OR_CREATE_VIA_SHIM:30,BURNER_INTERNAL_LOAD_TESTING_FRAMEWORK:31,THREAD_GALLERY_RESTORE:32,ACT_SURROUNDING_QUERY:33,EB_SNAPSHOT_RESTORE:34,PROTOBUF_RESTORE:39,FTS_INDEX_EB_MESSAGES:40,INSTAMADILLO_DYI:41,MESSENGER_MESSAGE_LIST_PAGINATION:45,EB_RESTORE_REPLIED_MESSAGES_AFTER_RANGE_RESTORE:35,REPL_TESTING:36,EB_POINT_QUERY_IN_ACT:37,EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES:38,IGD_DYI:42,FTS_INDEX_EB_MESSAGES_WEB:43,BULK_QUERY_FOR_SEARCH_RESULT:44,MSGR_DYI:46,EB_RESTORE_ON_REGISTRATION:47,EB_RESTORE_ON_OFFLINE_QUEUE_COUNT_LIMIT:48,EB_POINT_QUERY_RESTORE_ON_ACK_DROP:49,EB_POINT_QUERY_RESTORE_ON_DECRYPTION_FAILURE:50,EB_POINT_QUERY_RESTORE_ON_UNAVAILABLE_DEVICE:51,EB_RANGE_QUERY_RESTORE_ON_THREAD_SESSION_ACTIVATE:52});f["default"]=a}),66);
__d("MAWAckLevel",["LSIntEnum","LSMessageSendStatus"],(function(a,b,c,d,e,f,g){"use strict";var h,i={clock:0,contentGone:-3,contentTooBig:-4,contentUnuploadable:-5,expired:-2,failed:-1,inactiveReceived:-6,partialOptimistic:-8,played:4,read:3,received:2,senderBackFillSent:-7,sent:1};function a(a){return a>0}function b(a){switch(a){case i.partialOptimistic:return(h||(h=d("LSIntEnum"))).ofNumber(0);case i.clock:return(h||(h=d("LSIntEnum"))).ofNumber(1);case i.sent:case i.received:case i.read:case i.played:return(h||(h=d("LSIntEnum"))).ofNumber(2);default:return(h||(h=d("LSIntEnum"))).ofNumber(4)}}function e(a){switch(a){case i.partialOptimistic:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessageSendStatus").NONE);case i.clock:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessageSendStatus").SENDING_TO_SERVER);case i.sent:case i.received:case i.read:case i.played:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessageSendStatus").SERVER_RECEIVED);default:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessageSendStatus").NON_RETRIABLE_ERROR)}}g.ACK=i;g.isMsgAuthoritative=a;g.levelToMessagingSendStatusV2=b;g.levelToMessagingSendStatus=e}),98);
__d("MAWAdminMsgType",[],(function(a,b,c,d,e,f){"use strict";a="currentUserAddedDevice";b="participantAddedDevice";c="currentUserRemovedDevice";d="participantRemovedDevice";e="currentUserUpdatedDevice";var g="participantUpdatedDevice",h="participantAddedYou",i="participantAddedYouAndOneUser",j="participantAddedYouAndMoreThanOneUsers",k="unknowUserAddedYou",l="unknowUserAddedYouAndOneUser",m="unknowUserAddedYouAndMoreThanOneUser",n="unknownUserAddedOneUser",o="unknownUserAddedTwoUser",p="unknownUserAddedMoreThanTwoUser",q="participantAddedOneUser",r="participantAddedTwoUser",s="participantAddedMoreThanTwoUser",t="currentUserRemovedOneParticipant",u="currentUserRemovedTwoParticipant",v="currentUserRemovedMoreThanTwoParticipant",w="currentUserAddedOneParticipant",x="currentUserAddedTwoParticipant",y="currentUserAddedMoreThanTwoParticipant",z="participantRemovedYou",A="participantRemovedYouAndOneUser",B="participantRemovedYouAndMoreThanOneUsers",C="unknowUserRemovedYou",D="unknowUserRemovedYouAndOneUser",E="unknowUserRemovedYouAndMoreThanOneUser",F="unknownUserRemovedOneUser",G="unknownUserRemovedTwoUser",H="unknownUserRemovedMoreThanTwoUser",I="participantRemovedOneUser",J="participantRemovedTwoUser",K="participantRemovedMoreThanTwoUser",L="participantLeftGroup",M="currentUserLeftGroup",N="participantCustomizeParticipantNickname",O="participantClearParticipantNickname",P="participantCustomizeCurrentUserNickname",Q="currentUserSetOwnNickname",R="currentUserClearOwnNickname",aa="currentUserClearParticipantNickname",ba="participantSetOwnNickname",ca="participantClearOwnNickname",da="participantClearCurrentUserNickname",ea="currentUserCustomizeNickname",fa="currentUserNamedGroup",ga="unkonwnUserNamedGroup",ha="participantNamedGroup",ia="currentUserCustomizeHotlike",ja="participantCustomizeHotlike",ka="currentUserCustomizeTheme",la="currentUserCustomizePhoto",ma="participantCustomizeTheme",na="participantCustomizePhoto",oa="currentUserSetAddModeAdminOnly",pa="currentUserSetAddModeAllMembers",qa="participantSetAddModeAdminOnly",ra="participantSetAddModeAllMembers",sa="serverSetAddModeAdminOnly",ta="serverSetAddModeAllMembers",S="currentUserPinnedMessage",T="currentUserUnpinnedMessage",U="participantPinnedMessage",V="participantUnpinnedMessage",W="cutoverThreadAdminMessage",X="cutoverIGDThreadAdminMessage",Y="cutoverRollbackAdminMessage",Z="dualThreadCutoverAdminMessage",$="e2eeThreadDescription",ua="debugMsg",va="reachabilityError",wa="twoUsersConnected",xa="twoUsersConnectedOneMSplit";y={CURRENT_USER_ADDED_DEVICE:a,CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:y,CURRENT_USER_ADDED_ONE_PARTICIPANT:w,CURRENT_USER_ADDED_TWO_PARTICIPANTS:x,CURRENT_USER_CLEAR_OWN_NICKNAME:R,CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:aa,CURRENT_USER_CUSTOMIZE_HOTLIKE:ia,CURRENT_USER_CUSTOMIZE_NICKNAME:ea,CURRENT_USER_CUSTOMIZE_PHOTO:la,CURRENT_USER_CUSTOMIZE_THEME:ka,CURRENT_USER_LEFT_GROUP:M,CURRENT_USER_NAMED_GROUP:fa,CURRENT_USER_PINNED_MESSAGE:S,CURRENT_USER_REMOVED_DEVICE:c,CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:v,CURRENT_USER_REMOVED_ONE_PARTICIPANT:t,CURRENT_USER_REMOVED_TWO_PARTICIPANTS:u,CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY:oa,CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS:pa,CURRENT_USER_SET_OWN_NICKNAME:Q,CURRENT_USER_UNPINNED_MESSAGE:T,CURRENT_USER_UPDATED_DEVICE:e,CUTOVER_IGD_THREAD_ADMIN_MESSAGE:X,CUTOVER_ROLLBACK_ADMIN_MESSAGE:Y,CUTOVER_THREAD_ADMIN_MESSAGE:W,DEBUG_MSG:ua,DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:Z,E2EE_THREAD_DESCRIPTION:$,PARTICIPANT_ADDED_DEVICE:b,PARTICIPANT_ADDED_MORE_THAN_TWO_USER:s,PARTICIPANT_ADDED_ONE_USER:q,PARTICIPANT_ADDED_TWO_USER:r,PARTICIPANT_ADDED_YOU:h,PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:j,PARTICIPANT_ADDED_YOU_AND_ONE_USER:i,PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:da,PARTICIPANT_CLEAR_OWN_NICKNAME:ca,PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:O,PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:P,PARTICIPANT_CUSTOMIZE_HOTLIKE:ja,PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:N,PARTICIPANT_CUSTOMIZE_PHOTO:na,PARTICIPANT_CUSTOMIZE_THEME:ma,PARTICIPANT_LEFT_GROUP:L,PARTICIPANT_NAMED_GROUP:ha,PARTICIPANT_PINNED_MESSAGE:U,PARTICIPANT_REMOVED_DEVICE:d,PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:K,PARTICIPANT_REMOVED_ONE_USER:I,PARTICIPANT_REMOVED_TWO_USER:J,PARTICIPANT_REMOVED_YOU:z,PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:B,PARTICIPANT_REMOVED_YOU_AND_ONE_USER:A,PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:qa,PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:ra,PARTICIPANT_SET_OWN_NICKNAME:ba,PARTICIPANT_UNPINNED_MESSAGE:V,PARTICIPANT_UPDATED_DEVICE:g,REACHABILITY_ERROR:va,SERVER_SET_ADD_MODE_ADMIN_ONLY:sa,SERVER_SET_ADD_MODE_ALL_MEMBERS:ta,TWO_USERS_CONNECTED:wa,TWO_USERS_CONNECTED_ONE_MSPLIT:xa,UNKNOWN_USER_ADDED_MORE_THAN_TWO_USER:p,UNKNOWN_USER_ADDED_ONE_USER:n,UNKNOWN_USER_ADDED_TWO_USER:o,UNKNOWN_USER_ADDED_YOU:k,UNKNOWN_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:m,UNKNOWN_USER_ADDED_YOU_AND_ONE_USER:l,UNKNOWN_USER_NAMED_GROUP:ga,UNKNOWN_USER_REMOVED_MORE_THAN_TWO_USER:H,UNKNOWN_USER_REMOVED_ONE_USER:F,UNKNOWN_USER_REMOVED_TWO_USER:G,UNKNOWN_USER_REMOVED_YOU:C,UNKNOWN_USER_REMOVED_YOU_AND_MORE_THAN_ONE_USER:E,UNKNOWN_USER_REMOVED_YOU_AND_ONE_USER:D};f.CURRENT_USER_ADDED_DEVICE=a;f.CURRENT_USER_PINNED_MESSAGE=S;f.CURRENT_USER_UNPINNED_MESSAGE=T;f.PARTICIPANT_PINNED_MESSAGE=U;f.PARTICIPANT_UNPINNED_MESSAGE=V;f.CUTOVER_THREAD_ADMIN_MESSAGE=W;f.CUTOVER_IGD_THREAD_ADMIN_MESSAGE=X;f.CUTOVER_ROLLBACK_ADMIN_MESSAGE=Y;f.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE=Z;f.E2EE_THREAD_DESCRIPTION=$;f.ADMIN_MSG_TYPE=y}),66);
__d("MAWLocalizationType",["MAWAdminMsgType"],(function(a,b,c,d,e,f,g){"use strict";a="emptySnippet";b="currentUserCreatedGroup";c="participantCreatedGroup";e="unknownUserCreatedGroup";f="currentUserGotPromoted";var h="currentUserGotDemoted",i="participantGotPromoted",j="participantGotDemoted",k="participantPromotedYou",l="participantDemotedYou",m="currentUserPromotedParticipant",n="currentUserDemotedParticipant",o="participantDemotedParticipant",p="participantPromotedParticipant",q="participantSelfDemoted",r="currentUserSelfDemoted",s="currentUserSendText",t="currentUserSendImage",u="currentUserSendVideo",v="currentUserSendAudio",w="currentUserSendGif",x="currentUserSendSticker",y="participantSendText",z="participantSendTextInGroup",A="participantSendImage",B="participantSendVideo",C="participantSendAudio",D="participantSendGif",E="participantSendSticker",F="unavailableSnippet",G="unknownUserEphemeralSettingTurnedOnSeconds",H="unknownUserEphemeralSettingTurnedOnMinutes",I="unknownUserEphemeralSettingTurnedOnHours",J="unknownUserEphemeralSettingTurnedOnDays",K="youEphemeralSettingTurnedOnSeconds",L="youEphemeralSettingTurnedOnMinutes",M="youEphemeralSettingTurnedOnHours",N="youEphemeralSettingTurnedOnDays",O="participantEphemeralSettingTurnedOnSeconds",P="participantEphemeralSettingTurnedOnMinutes",Q="participantEphemeralSettingTurnedOnHours",R="participantEphemeralSettingTurnedOnDays",S="unknownUserEphemeralSettingChangeSeconds",T="unknownUserEphemeralSettingChangeMinutes",U="unknownUserEphemeralSettingChangeHours",V="unknownUserEphemeralSettingChangeDays",W="youEphemeralSettingChangeSeconds",X="youEphemeralSettingChangeMinutes",Y="youEphemeralSettingChangeHours",aa="youEphemeralSettingChangeDays",ba="participantEphemeralSettingChangeSeconds",ca="participantEphemeralSettingChangeMinutes",da="participantEphemeralSettingChangeHours",ea="participantEphemeralSettingChangeDays",fa="unknownUserEphemeralSettingTurnedOff",ga="youEphemeralSettingTurnedOff",ha="participantEphemeralSettingTurnedOff",ia="ephemeralSettingsAutoReset",ja="currentUserUnsentMessage",ka="participantUnsentMessage",la="participantReactMessage",ma="participantReactMessageInGroup",Z="unknownUserEphemeralTakeScreenshot",na="unknownUserEphemeralRecordScreen",oa="youEphemeralTakeScreenshot",pa="youEphemeralRecordScreen",qa="participantEphemeralTakeScreenshot",ra="participantEphemeralRecordScreen",sa="icdcAlertAdminMessage",ta="yourDeviceICDCAlertAdminMessage",$="currentUserSendAttachment",ua="participantSendAttachment",va="currentUserSentPost",wa="currentUserSentReel",xa="currentUserSentStory",ya="currentUserSentEvent",za="currentUserMentionedStoryIG",Aa="currentUserReceivedStoryMentionIG",Ba="participantSentPost",Ca="participantSentReel",Da="participantSentStory",Ea="participantSentEvent",Fa="currentUserSentStoryHighlight",Ga="participantSentStoryHighlight",Ha="currentUserMissedAudioCall",Ia="participantMissedAudioCall",Ja="currentUserMissedVideoCall",Ka="participantMissedVideoCall",La="currentUserAudioCalled",Ma="participantAudioCalled",Na="currentUserVideoCalled",Oa="participantVideoCalled",Pa="currentUserStartedGroupAudioCall",Qa="participantStartedGroupAudioCall",Ra="currentUserStartedGroupVideoCall",Sa="participantStartedGroupVideoCall",Ta="currentUserBumpedOwnMessage",Ua="currentUserBumpedMessage",Va="participantBumpedOwnMessage",Wa="participantBumpedParticipantMessage",Xa="participantBumpedCurrentUserMessage",Ya="userSendUnavailableMessage",Za="userSendEncryptedMessage",$a="currentUserSendUnrenderableMessage",ab="participantSendUnrenderableMessage",bb="currentUserSendLocationFallback",cb="participantSendLocation",db="currentUserSendLocation",eb="participantSendLocation",fb="currentUserSendPollCreationFallback",gb="participantSendPollCreation",hb="currentUserSendContactShareFallback",ib="participantSendContactShareFallback",jb="currentUserSendStoryMentionFallback",kb="currentUserSendStoryMention",lb="participantSendStoryMention",mb="participantSendStoryMentionFallback",nb="metaAISendMessageFallback",ob="currentUserSendBumpMessageFallback",pb="participantSendBumpMessageFallback",qb="participantSendBumpMessageOriginalUnavailable",rb="currentUserSendStickerReceiverFetchMessageFallback",sb="participantSendStickerReceiverFetchMessageFallback",tb="viewOncePhotoMessageFallback",ub="viewOnceVideoMessageFallback",vb="unavailableStory";d=babelHelpers["extends"]({},d("MAWAdminMsgType").ADMIN_MSG_TYPE,{CURRENT_USER_AUDIO_CALLED:La,CURRENT_USER_BUMPED_MESSAGE:Ua,CURRENT_USER_BUMPED_OWN_MESSAGE:Ta,CURRENT_USER_CREATED_GROUP:b,CURRENT_USER_DEMOTED_PARTICIPANT:n,CURRENT_USER_GOT_DEMOTED:h,CURRENT_USER_GOT_PROMOTED:f,CURRENT_USER_MENTIONED_STORY_IG:za,CURRENT_USER_MISSED_AUDIO_CALL:Ha,CURRENT_USER_MISSED_VIDEO_CALL:Ja,CURRENT_USER_PROMOTED_PARTICIPANT:m,CURRENT_USER_RECEIVED_STORY_MENTION_IG:Aa,CURRENT_USER_SELF_DEMOTED:r,CURRENT_USER_SEND_ATTACHMENT:$,CURRENT_USER_SEND_AUDIO:v,CURRENT_USER_SEND_BUMP_MESSAGE_FALLBACK:ob,CURRENT_USER_SEND_CONTACT_SHARE_FALLBACK:hb,CURRENT_USER_SEND_GIF:w,CURRENT_USER_SEND_IMAGE:t,CURRENT_USER_SEND_LOCATION:db,CURRENT_USER_SEND_LOCATION_FALLBACK:bb,CURRENT_USER_SEND_POLL_CREATION_FALLBACK:fb,CURRENT_USER_SEND_STICKER:x,CURRENT_USER_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK:rb,CURRENT_USER_SEND_STORY_MENTION:kb,CURRENT_USER_SEND_STORY_MENTION_FALLBACK:jb,CURRENT_USER_SEND_TEXT:s,CURRENT_USER_SEND_UNRENDERABLE_MESSAGE_FALLBACK:$a,CURRENT_USER_SEND_VIDEO:u,CURRENT_USER_SENT_EVENT:ya,CURRENT_USER_SENT_POST:va,CURRENT_USER_SENT_REEL:wa,CURRENT_USER_SENT_STORY:xa,CURRENT_USER_SENT_STORY_HIGHLIGHT:Fa,CURRENT_USER_STARTED_GROUP_AUDIO_CALL:Pa,CURRENT_USER_STARTED_GROUP_VIDEO_CALL:Ra,CURRENT_USER_UNSENT_MESSAGE:ja,CURRENT_USER_VIDEO_CALLED:Na,EMPTY_SNIPPET:a,EPHEMERAL_SETTINGS_AUTO_RESET:ia,ICDC_ALERT_ADMIN_MESSAGE:sa,META_AI_SEND_MESSAGE_FALLBACK:nb,PARTICIPANT_AUDIO_CALLED:Ma,PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE:Xa,PARTICIPANT_BUMPED_OWN_MESSAGE:Va,PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE:Wa,PARTICIPANT_CREATED_GROUP:c,PARTICIPANT_DEMOTED_PARTICIPANT:o,PARTICIPANT_DEMOTED_YOU:l,PARTICIPANT_EPHEMERAL_RECORD_SCREEN:ra,PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:ea,PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:da,PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:ca,PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:ba,PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:ha,PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:R,PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:Q,PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:P,PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:O,PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:qa,PARTICIPANT_GOT_DEMOTED:j,PARTICIPANT_GOT_PROMOTED:i,PARTICIPANT_MISSED_AUDIO_CALL:Ia,PARTICIPANT_MISSED_VIDEO_CALL:Ka,PARTICIPANT_PROMOTED_PARTICIPANT:p,PARTICIPANT_PROMOTED_YOU:k,PARTICIPANT_REACT_MESSAGE:la,PARTICIPANT_REACT_MESSAGE_IN_GROUP:ma,PARTICIPANT_SELF_DEMOTED:q,PARTICIPANT_SEND_ATTACHMENT:ua,PARTICIPANT_SEND_AUDIO:C,PARTICIPANT_SEND_BUMP_MESSAGE:pb,PARTICIPANT_SEND_BUMP_MESSAGE_ORIGINAL_UNAVAILABLE_FALLBACK:qb,PARTICIPANT_SEND_CONTACT_SHARE_FALLBACK:ib,PARTICIPANT_SEND_GIF:D,PARTICIPANT_SEND_IMAGE:A,PARTICIPANT_SEND_LOCATION:eb,PARTICIPANT_SEND_LOCATION_FALLBACK:cb,PARTICIPANT_SEND_POLL_CREATION_FALLBACK:gb,PARTICIPANT_SEND_STICKER:E,PARTICIPANT_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK:sb,PARTICIPANT_SEND_STORY_MENTION:lb,PARTICIPANT_SEND_STORY_MENTION_FALLBACK:mb,PARTICIPANT_SEND_TEXT:y,PARTICIPANT_SEND_TEXT_IN_GROUP:z,PARTICIPANT_SEND_UNRENDERABLE_MESSAGE_FALLBACK:ab,PARTICIPANT_SEND_VIDEO:B,PARTICIPANT_SENT_EVENT:Ea,PARTICIPANT_SENT_POST:Ba,PARTICIPANT_SENT_REEL:Ca,PARTICIPANT_SENT_STORY:Da,PARTICIPANT_SENT_STORY_HIGHLIGHT:Ga,PARTICIPANT_STARTED_GROUP_AUDIO_CALL:Qa,PARTICIPANT_STARTED_GROUP_VIDEO_CALL:Sa,PARTICIPANT_UNSENT_MESSAGE:ka,PARTICIPANT_VIDEO_CALLED:Oa,UNAVAILABLE_SNIPPET:F,UNAVAILABLE_STORY:vb,UNKNOWN_USER_CREATED_GROUP:e,UNKNOWN_USER_EPHEMERAL_RECORD_SCREEN:na,UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS:V,UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS:U,UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES:T,UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS:S,UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:fa,UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:J,UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:I,UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:H,UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:G,UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT:Z,USER_SEND_ENCRYPTED_MESSAGE_FALLBACK:Za,USER_SEND_UNAVAILABLE_MESSAGE_FALLBACK:Ya,VIEW_ONCE_PHOTO_MESSAGE:tb,VIEW_ONCE_VIDEO_MESSAGE:ub,YOU_EPHEMERAL_RECORD_SCREEN:pa,YOU_EPHEMERAL_SETTING_CHANGE_DAYS:aa,YOU_EPHEMERAL_SETTING_CHANGE_HOURS:Y,YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:X,YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:W,YOU_EPHEMERAL_SETTING_TURNED_OFF:ga,YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:N,YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:M,YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:L,YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:K,YOU_EPHEMERAL_TAKE_SCREENSHOT:oa,YOUR_DEVICE_ICDC_ALERT_ADMIN_MESSAGE:ta});g.CURRENT_USER_CREATED_GROUP=b;g.CURRENT_USER_SEND_TEXT=s;g.CURRENT_USER_SEND_IMAGE=t;g.CURRENT_USER_SEND_VIDEO=u;g.CURRENT_USER_SEND_AUDIO=v;g.CURRENT_USER_SEND_GIF=w;g.CURRENT_USER_SEND_STICKER=x;g.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS=G;g.UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT=Z;g.CURRENT_USER_SEND_ATTACHMENT=$;g.LOCALIZATION_TYPE=d}),98);
__d("getMAWLocalizedBumpMsgReplySnippet",["fbt","FBLogger"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,b,d){switch(a){case"currentUserBumpedOwnMessage":return h._("__JHASH__xEJdAn7fswx__JHASH__");case"currentUserBumpedMessage":return d!=null?h._("__JHASH__V_CNNTmY2Ph__JHASH__",[h._param("name",d)]):h._("__JHASH__e4ANPYcuBv3__JHASH__");case"participantBumpedCurrentUserMessage":return h._("__JHASH__Za_lnuBTLtf__JHASH__",[h._param("sender_name",b)]);case"participantBumpedOwnMessage":return h._("__JHASH___jAChXL58Au__JHASH__",[h._param("name",b)]);case"participantBumpedParticipantMessage":return d!=null?h._("__JHASH__DhJx8omw4RX__JHASH__",[h._param("sender_name",b),h._param("reply_source_sender_name",d)]):h._("__JHASH__nH0a2aTUw0L__JHASH__",[h._param("user_name",b)]);default:a;c("FBLogger")("messenger_e2ee_web").mustfix("unexpected bump type %s",a);return""}}g["default"]=a}),226);
__d("getMAWLocalizedFallbackMsgSnippet",["fbt","FBLogger","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){switch(a){case"userSendEncryptedMessage":return c("gkx")("2161")?h._("__JHASH__fyDhKh6gGJz__JHASH__"):h._("__JHASH__4OgzNQUOXys__JHASH__");case"currentUserSendUnrenderableMessage":return h._("__JHASH__jc4jswoQ0uZ__JHASH__");case"participantSendUnrenderableMessage":return h._("__JHASH__rJAaVw-bGTJ__JHASH__");case"currentUserSendLocationFallback":return h._("__JHASH__uqLzpXLWV1L__JHASH__");case"participantSendLocation":return h._("__JHASH__arQtWP-wajD__JHASH__");case"currentUserSendPollCreationFallback":return h._("__JHASH__yYAB5ipDjSn__JHASH__");case"participantSendPollCreation":return h._("__JHASH__9_u_h4197t1__JHASH__");case"currentUserSendContactShareFallback":return h._("__JHASH__Lucxb4lp5Bj__JHASH__");case"participantSendContactShareFallback":return h._("__JHASH__l8E1YgNTl-P__JHASH__");case"currentUserSendStoryMentionFallback":return h._("__JHASH__eI2fGAdx8aY__JHASH__");case"participantSendStoryMentionFallback":return h._("__JHASH__cgqiUXxl6Ro__JHASH__");case"metaAISendMessageFallback":return h._("__JHASH__rKW2TUo65Qw__JHASH__");case"currentUserSendBumpMessageFallback":return h._("__JHASH__wGbdzlw9c2x__JHASH__");case"participantSendBumpMessageFallback":return h._("__JHASH__ERQ_-V0YrzM__JHASH__");case"participantSendStickerReceiverFetchMessageFallback":return h._("__JHASH__QW1C8s0lKTa__JHASH__");case"currentUserSendStickerReceiverFetchMessageFallback":return h._("__JHASH__G-xm1MPFQ2m__JHASH__");case"userSendUnavailableMessage":return c("gkx")("2161")?h._("__JHASH__kUWcn8afzj2__JHASH__"):h._("__JHASH__Q-6u14LxgkX__JHASH__");case"participantSendBumpMessageOriginalUnavailable":return h._("__JHASH__4OgzNQUOXys__JHASH__");case"unavailableStory":return h._("__JHASH__xG_pfmBU38L__JHASH__");case"viewOncePhotoMessageFallback":return h._("__JHASH__KCDXWiSStNg__JHASH__");case"viewOnceVideoMessageFallback":return h._("__JHASH__QmDiAWEBf9c__JHASH__");default:a;c("FBLogger")("messenger_e2ee_web").mustfix("unexpected content fallback type %s",a);return""}}g["default"]=a}),226);
__d("MAWAdminMsg",["fbt","MAWLocalizationType","getMAWLocalizedBumpMsgReplySnippet","getMAWLocalizedFallbackMsgSnippet"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,b,e){switch(e){case d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET:return"";case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CREATED_GROUP:return h._("__JHASH__28E9UX9VhHs__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CREATED_GROUP:return h._("__JHASH__vc0hFTqTXzB__JHASH__",[h._param("actor",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_CREATED_GROUP:return h._("__JHASH__nIQsgwg4jav__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:return h._("__JHASH__ioocxZa3RHl__JHASH__",[h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:return h._("__JHASH__BkA5SKyiWz8__JHASH__",[h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:return h._("__JHASH__3pkJPr0kqiB__JHASH__",[h._param("actor",b[0]),h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:return h._("__JHASH__7HvCssg8rpe__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:return h._("__JHASH__HcuOxk4Ti9n__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:return h._("__JHASH__z8kxY36E7hc__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:return h._("__JHASH__CWI7wNEpg6X__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:return h._("__JHASH__dMTvVUpHIHh__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return h._("__JHASH__B5b_7hBmzMu__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:return h._("__JHASH__IquH8JP7g3o__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:return h._("__JHASH__6LexHwivW4N__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:return h._("__JHASH__xpYfCqAeoRq__JHASH__",[h._param("user_name",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:return h._("__JHASH__6Z1J4va4_8C__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:return h._("__JHASH__Usbik5t1nBt__JHASH__",[h._param("actor",b[0]),h._param("user_name",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:return h._("__JHASH__P_OgxVnWQoE__JHASH__",[h._param("actor",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:return h._("__JHASH__bobEEsoK5wj__JHASH__",[h._param("actor",b[0]),h._param("user_name",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:return h._("__JHASH__XQQ_fX0JL2u__JHASH__",[h._param("actor",b[0]),h._param("user_name_1",b[1]),h._param("user_name_2",b[2])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:return h._("__JHASH__gdN-cHBGTgb__JHASH__",[h._param("actor",b[0]),h._param("user_name_1",b[1]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:return h._("__JHASH__T1eI6-R4Ys3__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:return h._("__JHASH___J2BJijyg1Y__JHASH__",[h._param("user_name_1",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:return h._("__JHASH__GQYeJHPPFBL__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:return h._("__JHASH__7gBXJGJs1RC__JHASH__",[h._param("name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_LEFT_GROUP:return h._("__JHASH__twBESU9lMQ5__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:return h._("__JHASH__P-TnfmXUkkU__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:return h._("__JHASH__TyOeMbh9c3n__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED:return h._("__JHASH__g2Y-AkokbQi__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED:return h._("__JHASH__QbDk7QLMtd0__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:return h._("__JHASH__vcVM9mG_n59__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:return h._("__JHASH__0ly_0rO21jd__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:return h._("__JHASH__aRkzLhFK0tk__JHASH__",[h._param("actor",b[0]),h._param("target",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:return h._("__JHASH__wIEAcacoGC2__JHASH__",[h._param("actor",b[0]),h._param("target",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:return h._("__JHASH__BVroDb3uWvG__JHASH__",[h._param("target",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:return h._("__JHASH__XW8QFefwwka__JHASH__",[h._param("target",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:return h._("__JHASH__-JHaYRzvfpN__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED:return h._("__JHASH__h_Dfa2FiN92__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:return h._("__JHASH__3iBxxmwApDO__JHASH__").toString()+": "+a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:return a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:return b[0]+": "+a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:return h._("__JHASH__4-ojL4cFyDj__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:return h._("__JHASH___R0NFo7psqZ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_AUDIO:return h._("__JHASH__NHZzbHt5fju__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_GIF:return h._("__JHASH__GgLzAe6GAAY__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER:return h._("__JHASH__WYnHcQZeijb__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:return h._("__JHASH__SkQ-qpSqtIH__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:return h._("__JHASH__Z9w9ch9TmJt__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL:return h._("__JHASH__-kgYEsPaCeZ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:return h._("__JHASH__BxMycMKsI8g__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_EVENT:return h._("__JHASH__AdIYNNW8_BB__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT:return h._("__JHASH__HZfnisG5R39__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG:return h._("__JHASH__Mv-TBSZDdsn__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG:return h._("__JHASH__XUTKHUpfCZy__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION:return h._("__JHASH__NkOpuZkYe13__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION:return h._("__JHASH__LFSYTOj65rJ__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE:return h._("__JHASH__u9NG1-EYfRE__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO:return h._("__JHASH__GZrAjs4uDve__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO:return h._("__JHASH__B_Zg5gCb8wv__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF:return h._("__JHASH__-LJU6ON9QlF__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER:return h._("__JHASH__j_PEgQByu4Z__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST:return h._("__JHASH__kF-N_lTEwQJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL:return h._("__JHASH__T_Dsx3yPqqa__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT:return h._("__JHASH__1gzdEGkoXLS__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION:return h._("__JHASH__V7iXBY7GwFs__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION:return h._("__JHASH__b1af6uIHMmw__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY:return h._("__JHASH__ssliyU4f4NG__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_EVENT:return h._("__JHASH___YfY9t5KQWL__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT:return h._("__JHASH__8KU-2G3ySrJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET:return h._("__JHASH__7Iefg1P6g_q__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.TWO_USERS_CONNECTED:return h._("__JHASH__m7k67dqAe-2__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.TWO_USERS_CONNECTED_ONE_MSPLIT:return h._("__JHASH__aRupJlbtkO6__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.REACHABILITY_ERROR:return h._("__JHASH__NRCMN2f5KgC__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__yoeh6xz8ysN__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__IR8E-wTaoC7__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__FtQHajIZT7O__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__X1cC2Zoa_3e__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__q1Dv0IsA2nN__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__p0MNCtvKqaA__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__kwfHljZ5QBG__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__LHoPMyBE8HS__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__rFeQsz2D0mv__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__vASZV8VZvhw__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__Xyk76kpov4j__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__qtvuopqU1MA__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__tOdgin1piov__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__tU7ZycHCBtt__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__SXTBhBt2NNW__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__oSyzRtJUP0d__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE:return h._("__JHASH__J_nCpYMiV9y__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return h._("__JHASH__cFpYB9yRAJx__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE:return h._("__JHASH__2BRCng4CCeO__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE:return h._("__JHASH__EP_oerZBdU2__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOUR_DEVICE_ICDC_ALERT_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE:return h._("__JHASH__djtpytkb6Sh__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__hcupvvFLxCq__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__fBAvJP2p_1B__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__4ozbPFF4k4a__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__WyaiaRRbnKj__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__iNw3Tti4Hyx__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__fCn7GcPwiSh__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__g-ahVqaxxG1__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__WlJQEt8_oGK__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__Loj0OkThL6V__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__tR4q6c00--C__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__M2dZfT7rhFT__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET:return h._("__JHASH__iGMaDEsRW87__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE:return h._("__JHASH__HpovaTJp70W__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE:return h._("__JHASH__zbO84srNMHF__JHASH__",[h._param("first name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP:return h._("__JHASH__31MoZ8hsHC1__JHASH__",[h._param("name",b[0]),h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE:return h._("__JHASH__5oboVZPgKpA__JHASH__",[h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__j47-K7rZuN___JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__NNSrUYXKqRz__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__7NL8DHtxILK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__vrGwrec4csR__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__GAoFX2GSYx-__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__f2dqrRKp1Rl__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION:return h._("__JHASH__84N8vT7fmIh__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU:return h._("__JHASH__k7nqRDWCEqt__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_ONE_USER:return h._("__JHASH__vzYvZZNuBUQ__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:return h._("__JHASH__kEvDhH7xulF__JHASH__",[h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_ONE_USER:return h._("__JHASH__xyM-QHTai_C__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_TWO_USER:return h._("__JHASH__5P3Id9aMhA-__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_MORE_THAN_TWO_USER:return h._("__JHASH__8qUm4dkQH-w__JHASH__",[h._param("user_name_1",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG:return a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL:e=b[0];return e!=null?h._("__JHASH__3CQShXTU-3b__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__ZdLYEgeUYUi__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL:e=b[0];return e!=null?h._("__JHASH__hSqnAb21UU0__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__FhbzN0qv73L__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL:e=b[0];return e!=null?h._("__JHASH__YM-2KpKGx7o__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__rUeoGw7ywMT__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL:e=b[0];return e!=null?h._("__JHASH__PRszNN6obpG__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__IdxQnq18Kxe__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED:e=b[0];return e!=null?h._("__JHASH__qpT_2Hq8aLK__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__1D3Mug6ESYE__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED:e=b[0];return e!=null?h._("__JHASH__Q2D56NwN4Z2__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__-LOVer9reHI__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED:return h._("__JHASH__N6tiOur0IeU__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL:return h._("__JHASH__281zrADSR3K__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL:e=b[0];return e!=null?h._("__JHASH__BRFQbCVtB3g__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__Y_6qv9Uzxa8__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL:return h._("__JHASH__-bjuy5QVW7S__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL:e=b[0];return e!=null?h._("__JHASH__G7PmoxqH97J__JHASH__",[h._param("user",e)]).toString():h._("__JHASH__6N0ah9mUAzA__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:return h._("__JHASH__EEsmX-_LHlK__JHASH__",[h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:return h._("__JHASH__6MdK4yng1UK__JHASH__",[h._param("participant_name",b[0]),h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:return h._("__JHASH__GyMG8O-C9S5__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:return a[1]!=null?h._("__JHASH__WKommDcgo9P__JHASH__",[h._param("theme_name",a[0]),h._param("theme_emoji",a[1])]).toString():h._("__JHASH__t4yd3Wxrq8W__JHASH__",[h._param("theme_name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:return h._("__JHASH__yuNBxRHgSDK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE:return h._("__JHASH__Zr0kCIYub20__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE:return h._("__JHASH__VWcKR_3CcNp__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:return h._("__JHASH__yI8AwJDDXA8__JHASH__",[h._param("participant_name_1",b[0]),h._param("participant_name_2",b[1]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:return h._("__JHASH__Nu4trdH0AZV__JHASH__",[h._param("participant_name_1",b[0]),h._param("participant_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:return a[1]!=null?h._("__JHASH__pUsACsMNiGM__JHASH__",[h._param("participant_name",b[0]),h._param("theme_name",a[0]),h._param("theme_emoji",a[1])]).toString():h._("__JHASH__5cPy2yotEtg__JHASH__",[h._param("participant_name",b[0]),h._param("theme_name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO:return h._("__JHASH__Dxwz5K9j7Bk__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE:return h._("__JHASH__40grJO79VQ___JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE:return h._("__JHASH__mXVL0NDisiY__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:return h._("__JHASH__6qQ7QWA5Qmg__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:return h._("__JHASH__oAeegILBLai__JHASH__",[h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:return h._("__JHASH__NEVYqiJ_yny__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:return h._("__JHASH__QyW1FG-2acm__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:return h._("__JHASH__-bMyTbFv0nI__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:return h._("__JHASH__Yhh1rYSenJQ__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:return h._("__JHASH__cwzLDs_ko4T__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__x0YG4R4fIWJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__OS47S8NROIK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__qoR_RAXP6cF__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__QFNAQIQatHV__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__BGd7wYLVNyr__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__ogqmOECI7p3__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_OWN_MESSAGE:return c("getMAWLocalizedBumpMsgReplySnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_OWN_MESSAGE,null,null).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE:return c("getMAWLocalizedBumpMsgReplySnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE,null,b[0]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE:return c("getMAWLocalizedBumpMsgReplySnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE,b[0],null).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_OWN_MESSAGE:return c("getMAWLocalizedBumpMsgReplySnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_OWN_MESSAGE,b[0],null).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE:return c("getMAWLocalizedBumpMsgReplySnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE,b[0],b[1]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.USER_SEND_UNAVAILABLE_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.USER_SEND_UNAVAILABLE_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.USER_SEND_ENCRYPTED_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.USER_SEND_ENCRYPTED_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_UNRENDERABLE_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_UNRENDERABLE_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_UNRENDERABLE_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_UNRENDERABLE_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_POLL_CREATION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_POLL_CREATION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_POLL_CREATION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_POLL_CREATION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_CONTACT_SHARE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_CONTACT_SHARE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_CONTACT_SHARE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_CONTACT_SHARE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.META_AI_SEND_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.META_AI_SEND_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_BUMP_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_BUMP_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_BUMP_MESSAGE:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_BUMP_MESSAGE).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK:return c("getMAWLocalizedFallbackMsgSnippet")(d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK).toString();default:return""}}g.buildLocalizedString=a}),226);
__d("MAWAdminMsgNormalized",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_OWN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE:return{contactIds:b,contents:[]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:a=b[0];var c=b[1];return{contactIds:[a],contents:[c]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:a=b[0];c=b[1];var e=b[2];return{contactIds:[a,c],contents:[e]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:a=b[0];c=b[1];e=b[2];return{contactIds:[a],contents:[c,e]};case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:default:return{contactIds:[],contents:b}}}g.deconstructContactIdsFromAdminContent=a}),98);
__d("MAWSubscribeToContactNames",["fbt","$InternalEnum","Env","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";var i;d=b("$InternalEnum").Mirrored(["FIRST_NAME","FULL_NAME"]);var j=Boolean((i||(i=c("Env"))).isMessengerDotComOnComet)?"Messenger":c("gkx")("22979")?"Instagram":"Facebook";function k(){return h._("__JHASH__qNfUY0OKWF7__JHASH__",[h._param("Platform Name",j)]).toString()}function a(a,b){return(a=a.get(b))!=null?a:k()}g.ContactNameMode=d;g.getUnknownUser=k;g.getContactNameFromLookup=a}),226);
__d("MAWThreadCustomizationUtils",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME}function b(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME}g.skipNicknameCheck=a;g.nicknameOnlyForFirstParticipantChecking=b}),98);
__d("fillArray",[],(function(a,b,c,d,e,f){function a(a,b){var c=new Array(a);for(var d=0;d<a;d++)c[d]=b;return c}f["default"]=a}),66);
__d("mapPull",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;d.set(c(g),b(g))}return d}f["default"]=a}),66);
__d("MAWBridgeBuildMsgMentions",["MAWLocalizationType","MAWSubscribeToContactNames","MAWThreadCustomizationUtils","WAJids","emptyFunction","fillArray","mapPull"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.length>0?a.join(","):void 0}function i(a,b){return a.index-b.index}function j(a,b){return a==null||a===""?a:Array.from(b).reduce(function(a,b){var c=b[0];b=b[1];return a.replaceAll(c,b)},a)}function k(a,b){return a==null||a===""?[]:Array.from(b.keys()).flatMap(function(b){return Array.from(a.matchAll(b))}).sort(i)}function l(a,b,e,f){e=c("mapPull")(e,function(a){var c=a[0];a[1];return d("MAWSubscribeToContactNames").getContactNameFromLookup(b,c)},function(a){a[0];a=a[1];return a});var g=k(a,e),i=[],l=[],m=[],n=0;for(g of g){var o=d("WAJids").unsafeCoerceToUserJid(g[0]);i.push(d("WAJids").userIdFromJid(o));var p=d("MAWSubscribeToContactNames").getContactNameFromLookup(e,o);l.push(p.length+1);m.push(Math.max(g.index-1+n,0));n+=p.length-o.length}p=k(f,e);for(o of p){g=d("WAJids").unsafeCoerceToUserJid(o[0]);i.push(d("WAJids").userIdFromJid(g))}n=c("fillArray")(i.length,"p");return{mentionIds:h(i),mentionLengths:h(l),mentionOffsets:h(m),mentionTypes:h(n),replyMessageText:j(f,e),text:j(a,e)}}function m(a,b,c,e){a=l(a,c,e);e=a.text;a=b.map(function(a){return d("MAWSubscribeToContactNames").getContactNameFromLookup(c,a)});return[e,a]}function a(a,b,e){b=c("mapPull")(b,c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);return l(a,b,b,e)}function n(a,b,c,e,f){return b&&c>0||e?f===d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME?"$CONTACT_FIRST_NAME("+a+")":"$CONTACT_FULL_NAME("+a+")":f===d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME?"$PARTICIPANT_FIRST_NAME("+a+")":"$PARTICIPANT_FULL_NAME("+a+")"}function b(a,b,e,f){b=c("mapPull")((b=b)!=null?b:[],c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);if(b.size===0||a==null||a===""){var g=d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME;(f===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG||f===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP)&&(g=d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME);var h=d("MAWThreadCustomizationUtils").nicknameOnlyForFirstParticipantChecking(f),i=d("MAWThreadCustomizationUtils").skipNicknameCheck(f);f=e.map(function(a,b){return n(a,h,b,i,g)});return[a,f]}f=new Map([].concat(Array.from(b.keys()),e).map(function(a){return[a,"$PARTICIPANT_FULL_NAME("+a+")"]}));return m(a,e,f,b)}g.buildMsgTextWithMentions=a;g.buildThreadSnippetWithMentions=b}),98);
__d("WAArrayBufferUtils",["Promise","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=new ArrayBuffer(a.length);b=new Uint8Array(b);var c,d;for(c=0,d=a.length;c<d;c++)b[c]=a.charCodeAt(c);return b.buffer}function d(a,c){c===void 0&&(c=5e5);return new(h||(h=b("Promise")))(function(b,d){var e=a.length,f=new ArrayBuffer(e),g=new Uint8Array(f),h=0;setTimeout(i,0);function i(){var d=Math.min(h+c,e);while(h<d)g[h]=a.charCodeAt(h),h++;if(h===e){b(f);return}setTimeout(i,16)}})}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}var i=8388607;function f(a,b){a=new Uint8Array(a);if(b>i)throw c("err")("Divisor is too big");var d=0;for(var e=0;e<a.length;++e)d=((d<<8)+a[e])%b;return d}function j(a){a=a.map(function(a){return new Uint8Array(a)});var b=a.reduce(function(a,b){return a+b.byteLength},0),c=new Uint8Array(b);a.reduce(function(a,b){c.set(b,a);return a+b.byteLength},0);return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}function k(a,b){a=new Uint8Array(a);b=new Uint8Array(b);return l(a,b)}function l(a,b){if(a.byteLength!==b.byteLength)return!1;for(var c=0;c!==a.byteLength;c++)if(a[c]!==b[c])return!1;return!0}g.stringToArrayBuffer=a;g.largeStringToArrayBuffer=d;g.arrayBufferToString=e;g.arrayBufferMod=f;g.concatBuffers=j;g.arrayBuffersEqualUNSAFE=k;g.uint8ArraysEqualUNSAFE=l}),98);
__d("MAWVaultMaterials",["FBLogger","WAArrayBufferUtils","randomInt","tweetnacl"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=null,j=null;function k(a){i=a}function l(){return h}function m(a){h=a}function a(){h=null,i=null}function n(){return p()!=null&&l()!=null}function b(){return j}function o(){var a=1e9,b=9999999999;return c("randomInt")(a,b)+"##"+c("randomInt")(a,b)}function p(){return i}function q(){if(!n())throw c("FBLogger")("maw_ear").mustfixThrow("Vault materials are null");return{encryptionKey:h,prefixAndSuffix:i}}function e(a,b){var e=n();c("FBLogger")("maw_ear").debug("Setting vault materials -- vaultMaterials=%s, previouslySetup=%s",Boolean(a).toString(),e);if(!e){r((e=a)!=null?e:{encryptionKey:d("tweetnacl").randomBytes(32).buffer,prefixAndSuffix:o()});j=(e=b)!=null?e:a!=null?"existing":"newly-generated"}return q()}function r(a){var b=a.encryptionKey;a=a.prefixAndSuffix;if(b==null||a==null)throw c("FBLogger")("maw_ear").mustfixThrow("Cannot set null values for encryption key and prefix");m(b);k(a)}function f(){return s(q())}function s(a){var b=a.encryptionKey;a=a.prefixAndSuffix;if(a!=null&&b!=null){b=d("WAArrayBufferUtils").arrayBufferToString(b);return JSON.stringify({encryptionKey:b,prefixAndSuffix:a})}else return""}function t(a){if(a==="")return null;else{a=JSON.parse(a);if(a.encryptionKey==null||a.prefixAndSuffix==null)throw c("FBLogger")("maw_ear").mustfixThrow("Vault materials were not in correct format");var b=d("WAArrayBufferUtils").stringToArrayBuffer(a.encryptionKey);a=a.prefixAndSuffix;return{encryptionKey:b,prefixAndSuffix:a}}}g.TEST_ONLY_clearVaultMaterials=a;g.hasVaultBeenSetup=n;g.getVaultMaterialsSource=b;g.getVaultPrefixAndSuffix=p;g.getVaultMaterials=q;g.initializeVaultMaterials=e;g.materialsToString=f;g.fromMaterialsToString=s;g.fromStringToMaterials=t}),98);
__d("MAWVaultMaterialsStorageStatus",[],(function(a,b,c,d,e,f){"use strict";var g=!1;function a(){return g}function b(){g=!0}f.isCurrentContextHoldingLock=a;f.setIsCurrentContextHoldingLock=b}),66);
__d("MAWVault",["ExecutionEnvironment","FBLogger","MAWKeychainNaClCrypto","MAWVaultMaterials","MAWVaultMaterialsStorageStatus","WALRUMap","gkx","hasMultipleTabs","justknobx","promiseDone","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("gkx")("6866")?new(d("WALRUMap").LRUMap)({max:c("justknobx")._("3063")}):new Map(),j=c("gkx")("6866")?new(d("WALRUMap").LRUMap)({max:c("justknobx")._("3063")}):new Map();function k(a){return new RegExp("^[0-9]{10}##[0-9]{10}.*[0-9]{10}##[0-9]{10}$").test(a)}var l=c("gkx")("23909");function m(a){if(!l)return!1;var b=d("MAWVaultMaterials").getVaultPrefixAndSuffix();b=b==null?!1:new RegExp(b+".*"+b).test(a);return b}function n(a,b){b===void 0&&(b=!1);if(!l)return a;if(m(a)){var e=d("MAWVaultMaterials").getVaultMaterials(),f=e.encryptionKey;e=e.prefixAndSuffix;if(e==null)throw c("FBLogger")("maw_ear").mustfixThrow("Vault prefix and suffix should not be null when unvaulting");var g=new RegExp(e+"(.*)"+e);g=a.match(g);if(g==null||g.length!=2)throw c("FBLogger")("maw_ear").mustfixThrow("Could not retrieve inner value to unvault");if(f==null)throw c("FBLogger")("maw_ear").mustfixThrow("Vault encryption key was null before unvault");g=g[1];e=""+e+g+e;var i=p(f,g);return a.replace(e,function(){return i})}if(k(a))if(b)throw c("FBLogger")("maw_ear").mustfixThrow("Encountered vaulted value with incorrect key.");else c("promiseDone")(d("hasMultipleTabs").hasMultipleTabs().then(function(a){c("FBLogger")("maw_ear").mustfix("Encountered vaulted value with incorrect key. Vault material source: %s, environment: %s, hasMultipleTabs: %s, isSharedWorker: %s, isCurrentContextHoldingLock: %s",d("MAWVaultMaterials").getVaultMaterialsSource(),(h||(h=c("ExecutionEnvironment"))).isInMainThread?"main":"worker",a==null?"unknown_multi_tab":a?"multi_tab":"single_tab",d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?"shared_worker":"dedicated_worker",d("MAWVaultMaterialsStorageStatus").isCurrentContextHoldingLock()?"holding_lock":"not_holding_lock")}));return a}function a(a){if(a==="")return a;if(!l)return a;if(!d("MAWVaultMaterials").hasVaultBeenSetup()){c("FBLogger")("maw_ear").mustfix("Attempted to vault value while materials were not setup");return a}if(m(a)){c("FBLogger")("maw_ear").warn("Attempted to vault value that's already been vaulted");return a}k(a)&&c("FBLogger")("maw_ear").mustfix("Attempted to vault value that's already been vaulted with a different key");var b=d("MAWVaultMaterials").getVaultMaterials(),e=b.encryptionKey;b=b.prefixAndSuffix;if(b==null||e==null)throw c("FBLogger")("maw_ear").mustfixThrow("Cannot vault before vault materials are set");e=o(e,a);return""+b+e+b}function b(a){if(!l)return a;if(!m(a))throw c("FBLogger")("maw_ear").mustfixThrow("Value should be vaulted");return n(a)}function o(a,b){var c=i==null?void 0:i.get(b);if(c!=null)return c;c=new TextEncoder().encode(b).buffer;a=d("MAWKeychainNaClCrypto").encryptTweetNaCl(a,new Uint8Array(c));i==null?void 0:i.set(b,a);j==null?void 0:j.set(a,b);return a}function p(a,b){var c=j==null?void 0:j.get(b);if(c!=null)return c;c=new TextDecoder().decode(d("MAWKeychainNaClCrypto").decryptTweetNaCl(a,b));i==null?void 0:i.set(c,b);j==null?void 0:j.set(b,c);return c}g.isVaulted=m;g.unvault=n;g.vault=a;g.unvaultOrThrow=b}),98);
__d("MAWBridgeBuildThreadSnippet",["MAWAdminMsg","MAWBridgeBuildMsgMentions","MAWLocalizationType","MAWVault","first","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a!=null?d("MAWVault").unvault(a):void 0}function i(a,b,c){if(a==null)return b;b=[].concat(b);switch(c){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:b[0]=a;break}return b}function j(a){return a.replace(/\$/g,"$$$$")}function a(a,b){var e=a.snippetContactIDs,f=a.snippetMentionJIDs,g=a.snippetParams,k=a.snippetSenderContactId;a=a.snippetType;if(g==null||a==null||e==null||k==null)return b;!e.includes(k)&&c("justknobx")._("3140")&&e.push(k);b=h(c("first")(g));k=d("MAWBridgeBuildMsgMentions").buildThreadSnippetWithMentions(b==null?null:j(b),f,e,a);b=k[0];f=k[1];return d("MAWAdminMsg").buildLocalizedString(i(b,g,a),f,a)}g.buildBridgeThreadSnippet=a}),98);
__d("MAWDbChatId__UNSAFE_DO_NOT_USE",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a}function b(a){return(h||(h=d("I64"))).of_float(a)}function c(a){return(h||(h=d("I64"))).to_float(a)}function e(a,b){return a+"_"+b}g.unsafeCoerceToChatId__DEPRECATED=a;g.convertToChatId64__DEPRECATED=b;g.convertToChatId__DEPRECATED=c;g.craftAltIndex__DEPRECATED=e}),98);
__d("MAWHexUtils",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.toString(16);return(a.length-1).toString(16)+a}function b(a){for(var b=1;b<a.length;b++){var d=a.substring(0,b),e=a.substring(b);if(e.length-1===parseInt(d,16))return parseInt(e,16)}throw c("err")("Cannot convert the order-preserving-hex back to number")}g.orderPreservingHex=a;g.reverseOrderPreservingHex=b}),98);
__d("WAMsgType",[],(function(a,b,c,d,e,f){"use strict";a="Text";b="Futureproof";c="Ciphertext";d="Unavailable";e="Image";var g="Video",h="Ptt",i="Admin",j="Revoked",k="Gif",l="Sticker",m="DocumentFile",n="ExpiredEphemeral",o="EphemeralSettingAdmin",p="EphemeralSyncResponse",q="DeleteForMe",r="EphemeralSettingChangeFromCurrentDevice",s="AlertICDC",t="GroupInvite",u="NoteReply",v="Reaction",w="SenderKeyDistribution",x="EditAction",y="ReceiverFetch",z="Raven",A={ADMIN:i,CIPHERTEXT:c,DELETE_FOR_ME:q,DOCUMENT_FILE:m,EDIT_ACTION:x,EPHEMERAL_SETTING_ADMIN:o,EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:r,EPHEMERAL_SYNC_RESPONSE:p,EXPIRED_EPHEMERAL:n,FUTUREPROOF:b,GIF:k,GROUP_INVITE:t,ICDC_ALERT:s,IMAGE:e,PTT:h,REACTION:v,REVOKED:j,SK_DISTRIBUTION:w,STICKER:l,TEXT:a,UNAVAILABLE:d,VIDEO:g,RECEIVER_FETCH:y,RAVEN:z};f.TEXT=a;f.FUTUREPROOF=b;f.CIPHERTEXT=c;f.UNAVAILABLE=d;f.IMAGE=e;f.VIDEO=g;f.PTT=h;f.ADMIN=i;f.REVOKED=j;f.GIF=k;f.STICKER=l;f.DOCUMENT_FILE=m;f.EXPIRED_EPHEMERAL=n;f.EPHEMERAL_SETTING_ADMIN=o;f.EPHEMERAL_SYNC_RESPONSE=p;f.DELETE_FOR_ME=q;f.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE=r;f.ICDC_ALERT=s;f.GROUP_INVITE=t;f.NOTE_REPLY=u;f.REACTION=v;f.SK_DISTRIBUTION=w;f.EDIT_ACTION=x;f.RECEIVER_FETCH=y;f.RAVEN=z;f.MSG_TYPE=A}),66);
__d("MAWMsgType",["WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return j.has(a)};b=function(a){return k.has(a)||j.has(a)};c="EphemeralScreenshotAction";e="Raven";f="RavenAction";var h="XMA",i="BumpExistingMessage";d=babelHelpers["extends"]({},d("WAMsgType").MSG_TYPE,{BUMP_EXISTING_MESSAGE:i,EPHEMERAL_SCREENSHOT_ACTION:c,RAVEN:e,RAVEN_ACTION:f,XMA:h});var j=new Set([d.IMAGE,d.VIDEO,d.PTT,d.GIF,d.STICKER,d.XMA,d.RAVEN,d.DOCUMENT_FILE,d.RECEIVER_FETCH]),k=new Set([d.TEXT,d.REVOKED,d.XMA,d.BUMP_EXISTING_MESSAGE]),l=new Set([d.TEXT,d.IMAGE,d.VIDEO,d.PTT,d.GIF,d.STICKER,d.DOCUMENT_FILE,d.UNAVAILABLE,d.EXPIRED_EPHEMERAL,d.REVOKED,d.XMA,d.RAVEN,d.RECEIVER_FETCH]);i=function(a){return l.has(a)};g.isMAWSupportedMediaType=a;g.isEBSupportedMsgType=b;g.EPHEMERAL_SCREENSHOT_ACTION=c;g.MSG_TYPE=d;g.mawSupportedMediaTypes=j;g.isQuotedMsgType=i}),98);
__d("WAMsg",["WAAssertUnreachable","WAJids","WAMsgType","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.author,c=a.chat;a=a.externalId;return c+"_"+a+"_"+b}function h(a){switch(a.type){case d("WAMsgType").MSG_TYPE.TEXT:case d("WAMsgType").MSG_TYPE.IMAGE:case d("WAMsgType").MSG_TYPE.VIDEO:case d("WAMsgType").MSG_TYPE.PTT:case d("WAMsgType").MSG_TYPE.GIF:case d("WAMsgType").MSG_TYPE.STICKER:case d("WAMsgType").MSG_TYPE.RECEIVER_FETCH:return{author:a.id.author,deleteTs:a.deleteTs,ephemeralSetting:a.ephemeralSetting,expirationTs:a.expirationTs,externalId:a.id.externalId,sentTs:a.sentTs,serverTs:a.serverTs,ts:a.ts};case d("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("WAMsgType").MSG_TYPE.UNAVAILABLE:return{author:a.id.author,externalId:a.id.externalId,sentTs:a.sentTs,ts:a.ts};default:a.type;return null}}function b(a){var b=h(a);if(b==null)return null;switch(a.type){case d("WAMsgType").MSG_TYPE.TEXT:return babelHelpers["extends"]({},b,{msgContent:a.msgContent,type:d("WAMsgType").MSG_TYPE.TEXT});case d("WAMsgType").MSG_TYPE.IMAGE:return babelHelpers["extends"]({},b,{mediaId:a.mediaId,type:d("WAMsgType").MSG_TYPE.IMAGE});case d("WAMsgType").MSG_TYPE.VIDEO:return babelHelpers["extends"]({},b,{mediaId:a.mediaId,type:d("WAMsgType").MSG_TYPE.VIDEO});case d("WAMsgType").MSG_TYPE.PTT:return babelHelpers["extends"]({},b,{mediaId:a.mediaId,type:d("WAMsgType").MSG_TYPE.PTT});case d("WAMsgType").MSG_TYPE.STICKER:return babelHelpers["extends"]({},b,{mediaId:a.mediaId,type:d("WAMsgType").MSG_TYPE.STICKER});case d("WAMsgType").MSG_TYPE.RECEIVER_FETCH:return babelHelpers["extends"]({},b,{type:d("WAMsgType").MSG_TYPE.RECEIVER_FETCH});case d("WAMsgType").MSG_TYPE.GIF:return babelHelpers["extends"]({},b,{mediaId:a.mediaId,type:d("WAMsgType").MSG_TYPE.PTT});case d("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return babelHelpers["extends"]({},b,{type:d("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL});case d("WAMsgType").MSG_TYPE.UNAVAILABLE:return babelHelpers["extends"]({},b,{type:d("WAMsgType").MSG_TYPE.UNAVAILABLE});case d("WAMsgType").MSG_TYPE.REVOKED:case d("WAMsgType").MSG_TYPE.REACTION:case d("WAMsgType").MSG_TYPE.ICDC_ALERT:case d("WAMsgType").MSG_TYPE.ADMIN:case d("WAMsgType").MSG_TYPE.FUTUREPROOF:case d("WAMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("WAMsgType").MSG_TYPE.GROUP_INVITE:case d("WAMsgType").MSG_TYPE.DELETE_FOR_ME:case d("WAMsgType").MSG_TYPE.DOCUMENT_FILE:case d("WAMsgType").MSG_TYPE.EDIT_ACTION:return null;default:return c("WAAssertUnreachable")(a.type)}}function e(a){if(d("WAJids").isAuthorSystem(a.author))throw c("err")("Cannot send @system messages");else return{author:a.author,chat:a.chat,externalId:a.externalId}}g.craftWAMsgIdString=a;g.asQuotedMsg=b;g.asProtocolMsgId=e}),98);
__d("MAWDbMsg",["FBLogger","I64","MAWDbChatId__UNSAFE_DO_NOT_USE","MAWHexUtils","MAWMsgType","WAMsg","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;i=[(i=d("MAWMsgType")).MSG_TYPE.REVOKED,i.MSG_TYPE.EPHEMERAL_SYNC_RESPONSE,i.MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE,i.MSG_TYPE.GROUP_INVITE,i.MSG_TYPE.SK_DISTRIBUTION,i.MSG_TYPE.RAVEN_ACTION];var j=0,k=Number.MAX_SAFE_INTEGER;function a(a){return v(a)?a:null}function b(a){return a}function e(a){return a}var l="futureproof",m="futureproof_spam",n="spam",o="toBeRead",p="e2ee_admin_msg",q="cutover_admin_msg";function r(a,b){return d("MAWHexUtils").orderPreservingHex(a)+"_"+d("MAWHexUtils").orderPreservingHex(b)+"_m"}function f(a,b,e){a=d("MAWHexUtils").orderPreservingHex(a)+"_"+d("MAWHexUtils").orderPreservingHex(b)+"_m";return!c("justknobx")._("621")?a:a+"_"+e.externalId}function s(a,b){return!c("justknobx")._("1903")?r(a,b):d("MAWHexUtils").orderPreservingHex(a)+"_"+d("MAWHexUtils").orderPreservingHex(b)+"_um"}function t(a,b){return!c("justknobx")._("1903")?r(a,b):d("MAWHexUtils").orderPreservingHex(a)+"_"+d("MAWHexUtils").orderPreservingHex(b)+"_r"}function u(a,b){return d("MAWHexUtils").orderPreservingHex(a)+"_"+d("MAWHexUtils").orderPreservingHex(b)+"_DEBUG_"+d("MAWHexUtils").orderPreservingHex(Math.floor(Math.random()*1e4))}function v(a){a=a.split("_");return a.length>=3&&a[0]!==""&&a[1]!==""&&a[2]==="m"}function w(a){return d("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(a,o)}function x(a){return d("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(a,p)}function y(a){return d("MAWDbChatId__UNSAFE_DO_NOT_USE").craftAltIndex__DEPRECATED(a,q)}function z(a){a=a.split("_");a[0];a=a[1];return d("MAWHexUtils").reverseOrderPreservingHex(a)}function A(a){return d("MAWHexUtils").orderPreservingHex(a)+"_"}function B(a){return d("MAWHexUtils").orderPreservingHex(a)+"_z"}function C(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.XMA:return!0;case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!1}throw c("FBLogger")("maw_db").mustfixThrow('Invalid msg type for isXMAMsg check: "%s"',a.type)}function D(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.RAVEN:return!0;case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!1}throw c("FBLogger")("maw_db").mustfixThrow('Invalid msg type for isMediaMsg check: "%s"',a.type)}function E(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:return!0;case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!1;default:c("FBLogger")("maw_db").mustfix('Invalid msg type for isPhotoOrVideoMediaMsg check: "%s"',a.type);return!1}}function F(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return!0;case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!1;default:c("FBLogger")("maw_db").mustfix('Invalid msg type for isDocumentFileMediaMsg check: "%s"',a.type);return!1}}function G(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!0;case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:case d("MAWMsgType").MSG_TYPE.RAVEN_ACTION:case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return!1}throw c("FBLogger")("maw_db").mustfixThrow('Invalid msg type for isContentMsg check: "%s"',a.type)}function H(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!0;case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case d("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return!1}throw c("FBLogger")("maw_db").mustfixThrow('Invalid msg type for isMsgEligibleForTriggeringEphemeralSyncResponse check: "%s"',a.type)}function I(a){return K(a.type)}function J(a){return a.type===d("MAWMsgType").MSG_TYPE.ADMIN}function K(a){return a==="EphemeralSyncResponse"||a==="EphemeralSettingChangeFromCurrentDevice"||a==="GroupInvite"||a==="SenderKeyDistribution"||a==="RavenAction"||a==="EditAction"}function L(a){return a==="RavenAction"}function M(a){return a.originalTs!=null?a.originalTs:N(a)}function N(a){return a.serverTs!=null?a.serverTs:a.ts}function O(a){if(a.sortOrderMs!=null)return a.sortOrderMs;else return N(a)*1e3}function P(a,b){if(a.serverTs!=null)return Math.max(b+1,a.serverTs*1e3);else return b+1}function Q(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:return a.msgContent;case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return a.editMsgContent;case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return}throw c("FBLogger")("maw_db").mustfixThrow('Invalid msg type for getMsgContent check: "%s"',a.type)}function R(a){return d("WAMsg").craftWAMsgIdString({author:a.author,chat:a.threadJid,externalId:a.externalId})}function S(a){return(h||(h=d("I64"))).to_float(a)}g.NO_CONTENT_MESSAGE_TYPES_ALLOWLIST=i;g.MIN_MSG_SORT_ORDER=j;g.MAX_MSG_SORT_ORDER=k;g.toMsgId=a;g.stanzaIdToMsgId=b;g.instamadilloMsgIdToMsgId=e;g.FUTUREPROOF_ALT_INDEX=l;g.FUTUREPROOF_SPAM_ALT_INDEX=m;g.SPAM_ALT_INDEX=n;g.craftMsgId=r;g.craftMsgIdV2=f;g.craftUnrenderedMsgId=s;g.craftReactionId=t;g.craftDebugMsgId=u;g.isValidMsgId=v;g.craftToBeReadAltIndex=w;g.craftE2eeAdminMsgAltIndex=x;g.craftCutoverAdminMsgAltIndex=y;g.getInChatMsgIdFromMsgId=z;g.msgIdsInChatLowerBound=A;g.msgIdsInChatUpperBound=B;g.isXMAMsg=C;g.isMediaMsg=D;g.isPhotoOrVideoMediaMsg=E;g.isDocumentFileMediaMsg=F;g.isContentMsg=G;g.isMsgEligibleForTriggeringEphemeralSyncResponse=H;g.isUnrenderedMsg=I;g.isAdminMsg=J;g.isUnrenderedMsgType=K;g.isRavenActionMsgType=L;g.getOriginalTsFromMsg=M;g.getCanonicalTsFromMsg=N;g.getSortOrderWithFallback=O;g.getSortOrderFromPrevious=P;g.getMsgContent=Q;g.getWAMsgId=R;g.convertMsgRowId64=S}),98);
__d("WAProtoConst",[],(function(a,b,c,d,e,f){"use strict";a={REPEATED:1<<6,PACKED:1<<7,REQUIRED:1<<8};b=31;c={INT32:1,INT64:2,UINT32:3,UINT64:4,SINT32:5,SINT64:6,BOOL:7,ENUM:8,FIXED64:9,SFIXED64:10,DOUBLE:11,STRING:12,BYTES:13,MESSAGE:14,FIXED32:15,SFIXED32:16,FLOAT:17,MAP:18};d={VARINT:0,BIT64:1,BINARY:2,BIT32:5};e={ONEOF:"__oneofs__",RESERVED:"__reserved__",RESERVED_TAGS:"tags",RESERVED_FIELDS:"fields"};f.FLAGS=a;f.TYPE_MASK=b;f.TYPES=c;f.ENC=d;f.KEYS=e}),66);
__d("WAMediaEntryData.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};a.internalSpec={fileSha256:[1,(e=d("WAProtoConst")).TYPES.BYTES],mediaKey:[2,e.TYPES.BYTES],fileEncSha256:[3,e.TYPES.BYTES],directPath:[4,e.TYPES.STRING],mediaKeyTimestamp:[5,e.TYPES.INT64],serverMediaType:[6,e.TYPES.STRING],uploadToken:[7,e.TYPES.BYTES],validatedTimestamp:[8,e.TYPES.BYTES],sidecar:[9,e.TYPES.BYTES],objectId:[10,e.TYPES.STRING],fbid:[11,e.TYPES.STRING],downloadableThumbnail:[12,e.TYPES.MESSAGE,c],handle:[13,e.TYPES.STRING],filename:[14,e.TYPES.STRING],progressiveJpegDetails:[15,e.TYPES.MESSAGE,b],size:[16,e.TYPES.INT64],lastDownloadAttemptTimestamp:[17,e.TYPES.INT64]};b.internalSpec={scanLengths:[1,e.FLAGS.REPEATED|e.TYPES.UINT32],sidecar:[2,e.TYPES.BYTES]};c.internalSpec={fileSha256:[1,e.TYPES.BYTES],fileEncSha256:[2,e.TYPES.BYTES],directPath:[3,e.TYPES.STRING],mediaKey:[4,e.TYPES.BYTES],mediaKeyTimestamp:[5,e.TYPES.INT64],objectId:[6,e.TYPES.STRING]};g.MediaEntrySpec=a;g.MediaEntry$ProgressiveJpegDetailsSpec=b;g.MediaEntry$DownloadableThumbnailSpec=c}),98);
__d("WAProgressiveJpegMarkers",[],(function(a,b,c,d,e,f){"use strict";a=255;b=0;c={SOF0:192,SOF1:193,SOF2:194,SOF3:195,DHT:196,SOF5:197,SOF6:198,SOF7:199,JPG:200,SOF9:201,SOF10:202,SOF11:203,SOF13:205,SOF14:206,SOF15:207,RST0:208,RST1:209,RST2:210,RST3:211,RST4:212,RST5:213,RST6:214,RST7:215,SOI:216,EOI:217,SOS:218,DQT:219,DRI:221,APP0:224,APP1:225,APP2:226,APP3:227,APP4:228,APP5:229,APP6:230,APP7:231,APP8:232,APP9:233,APP10:234,APP11:235,APP12:236,APP13:237,APP14:238,APP15:239,COM:254,TEM:1};d=[b,c.RST0,c.RST1,c.RST2,c.RST3,c.RST4,c.RST5,c.RST6,c.RST7];f.MARKER_PREFIX=a;f.MARKER_ESCAPE_BYTE=b;f.MARKERS=c;f.SOS_STREAM=d}),66);
__d("WAProgressiveJpegGetScanOffsets",["WAProgressiveJpegMarkers","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Non-progressive JPEG marker found"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ending marker found before end of image"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Scan found at offset ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Not a JPEG image"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["starting"]);l=function(){return a};return a}var m=d("WATagsLogger").TAGS(["media","progressiveJpegUtils"]);function a(a){m.DEV(l());if(!n(a)){m.DEV(k());return[]}var b=[],c=2,e="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA",f=null,g=0,r=!1,s=!1,t=!1;function u(){t=!1,m.DEV(j(),c-1),b.push(c-1)}while(c<a.byteLength){f=a[c];if(r){m.ERROR(i());return[]}switch(e){case"READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA":f===d("WAProgressiveJpegMarkers").MARKER_PREFIX&&(e="READ_MARKER_SECOND_BYTE");break;case"READ_MARKER_SECOND_BYTE":if(f===d("WAProgressiveJpegMarkers").MARKER_PREFIX)e="READ_MARKER_SECOND_BYTE";else if(f===d("WAProgressiveJpegMarkers").MARKER_ESCAPE_BYTE)e="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA";else if(f===d("WAProgressiveJpegMarkers").MARKERS.EOI)r=!0,t&&u();else if(!s&&p(f)){m.LOG(h());return[]}else o(f)?(s=!0,e="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA"):(t&&u(),f===d("WAProgressiveJpegMarkers").MARKERS.SOS&&(t=!0),q(f)?e="READ_SIZE_FIRST_BYTE":e="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA");break;case"READ_SIZE_FIRST_BYTE":e="READ_SIZE_SECOND_BYTE";break;case"READ_SIZE_SECOND_BYTE":c+=g*256;c+=f;c-=2;e="READ_MARKER_FIRST_BYTE_OR_ENTROPY_DATA";break}c+=1;g=f}return b}function n(a){if(a.byteLength<=2)return!1;if(a[0]!==d("WAProgressiveJpegMarkers").MARKER_PREFIX)return!1;return a[1]!==d("WAProgressiveJpegMarkers").MARKERS.SOF2&&a[1]!==d("WAProgressiveJpegMarkers").MARKERS.SOI?!1:!0}function o(a){return a===d("WAProgressiveJpegMarkers").MARKERS.SOF2||a===d("WAProgressiveJpegMarkers").MARKERS.SOF6||a===d("WAProgressiveJpegMarkers").MARKERS.SOF10||a===d("WAProgressiveJpegMarkers").MARKERS.SOF14}function p(a){return a===d("WAProgressiveJpegMarkers").MARKERS.SOF0||a===d("WAProgressiveJpegMarkers").MARKERS.SOF1||a===d("WAProgressiveJpegMarkers").MARKERS.SOF3||a===d("WAProgressiveJpegMarkers").MARKERS.SOF5||a===d("WAProgressiveJpegMarkers").MARKERS.SOF7||a===d("WAProgressiveJpegMarkers").MARKERS.JPG||a===d("WAProgressiveJpegMarkers").MARKERS.SOF9||a===d("WAProgressiveJpegMarkers").MARKERS.SOF11||a===d("WAProgressiveJpegMarkers").MARKERS.SOF13||a===d("WAProgressiveJpegMarkers").MARKERS.SOF15}function q(a){if(a===d("WAProgressiveJpegMarkers").MARKERS.TEM)return!1;return a>=d("WAProgressiveJpegMarkers").MARKERS.RST0&&a<=d("WAProgressiveJpegMarkers").MARKERS.RST7?!1:a!==d("WAProgressiveJpegMarkers").MARKERS.EOI&&a!==d("WAProgressiveJpegMarkers").MARKERS.SOI}g.getProgressiveJpegScanOffsets=a}),98);
__d("WAProgressiveJpegGetScanLengths",["WAProgressiveJpegGetScanOffsets"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("WAProgressiveJpegGetScanOffsets").getProgressiveJpegScanOffsets(a);return h(a)}function b(a){return a}function h(a){var b=[],c=0;for(var d=0;d<a.length;d++){var e=a[d];b.push(e-c);c=e}return b}g.getProgressiveJpegScanLengths=a;g.asProgressiveJpegScanLength=b}),98);
__d("WAServerMediaType",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){"use strict";d=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","payment-bg-image","novi-video","novi-image","product","product-catalog-image","xma-image","biz-cover-photo","preview","newsletter-audio","newsletter-document","newsletter-image","newsletter-gif","newsletter-ptt","newsletter-sticker","newsletter-thumbnail-link","newsletter-video","sticker-pack","thumbnail-sticker-pack"];function a(a){switch(a){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"payment-bg-image":case"novi-video":case"novi-image":case"template":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":case"sticker-pack":case"thumbnail-sticker-pack":return a;default:return null}}function b(a){switch(a){case"Image":return"image";case"Video":return"video";case"Ptt":return"ptt";case"Gif":return"gif";case"Sticker":return"sticker";case"DocumentFile":return"document";case"Text":case"Futureproof":case"Ciphertext":case"Unavailable":case"ExpiredEphemeral":case"Admin":case"Revoked":case"DeleteForMe":case"EphemeralSettingAdmin":case"EphemeralSyncResponse":case"EphemeralSettingChangeFromCurrentDevice":case"AlertICDC":case"GroupInvite":case"SenderKeyDistribution":case"Reaction":case"EditAction":case"ReceiverFetch":case"Raven":return null;default:return c("WAAssertUnreachable")(a)}}g.SERVER_MEDIA=d;g.castToServerMediaType=a;g.getMediaType=b}),98);
__d("WABinary",["WAHex","err"],(function(a,b,c,d,e,f,g){"use strict";var h=65533,i=10,j=new Uint8Array(i),k=new Uint8Array(0);a=function(){function a(b,c){var d=this;b===void 0&&(b=k);c===void 0&&(c=!1);this.$1=new Uint8Array(0);this.$2=0;this.$4=0;this.write=function(){for(var b=0;b<arguments.length;b++){var c=b<0||arguments.length<=b?void 0:arguments[b];typeof c==="string"?d.writeString(c):typeof c==="number"?d.writeUint8(c):c instanceof a?d.writeBinary(c):c instanceof ArrayBuffer?d.writeBuffer(c):c instanceof Uint8Array&&d.writeByteArray(c)}};b instanceof ArrayBuffer?(this.$1=new Uint8Array(b),this.$2=this.$4=b.byteLength):b instanceof Uint8Array&&(this.$1=b,this.$2=this.$4=b.length);this.$5=0;this.$6=this.$3=0;this.$7=null;this.$8=c;this.$9=0;this.$10=0}var b=a.prototype;b.size=function(){return this.$2-this.$3};b.peek=function(a,b){this.$9++;var c=this.$3,d=this.$5;try{return a(this,b)}finally{this.$9--,this.$3=c-(this.$5-d)}};b.advance=function(a){this.$11(a)};b.readWithViewParser=function(a,b,c,d){return b(this.$12(),this.$11(a),a,c,d)};b.readWithBytesParser=function(a,b,c,d){return b(this.$1,this.$11(a),a,c,d)};b.readUint8=function(){return p(this,1,r,!1)};b.readInt8=function(){return p(this,1,r,!0)};b.readUint16=function(a){a===void 0&&(a=this.$8);return p(this,2,s,a)};b.readInt32=function(a){a===void 0&&(a=this.$8);return p(this,4,t,a)};b.readUint32=function(a){a===void 0&&(a=this.$8);return p(this,4,u,a)};b.readInt64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,U,a)};b.readUint64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,V,a)};b.readLong=function(a,b){b===void 0&&(b=this.$8);return p(this,8,v,a,b)};b.readFloat32=function(a){a===void 0&&(a=this.$8);return p(this,4,w,a)};b.readFloat64=function(a){a===void 0&&(a=this.$8);return p(this,8,x,a)};b.readVarInt=function(a){var b=this.size();b=q(this,0,y,b);return q(this,b,z,a)};b.readBuffer=function(a){a===void 0&&(a=this.size());return a===0?new ArrayBuffer(0):q(this,a,A)};b.readByteArray=function(a){a===void 0&&(a=this.size());return a===0?new Uint8Array(0):q(this,a,B)};b.readBinary=function(b,c){b===void 0&&(b=this.size());c===void 0&&(c=this.$8);if(b===0)return new a(void 0,c);b=q(this,b,B);return new a(b,c)};b.indexOf=function(a){if(a.length===0)return 0;var b=this.$1,c=this.$2,d=this.$3,e=0,f=d;for(var g=d;g<c;g++)if(b[g]===a[e]){e===0&&(f=g);e++;if(e===a.byteLength)return g-d-a.byteLength+1}else e>0&&(e=0,g=f);return-1};b.readString=function(a){return q(this,a,C)};b.ensureCapacity=function(a){this.$13(this.$3+a)};b.ensureAdditionalCapacity=function(a){this.$13(this.$4+a)};b.writeToView=function(a,b,c,d){var e=this.$14(a);return b(this.$12(),e,a,c,d)};b.writeToBytes=function(a,b,c,d){var e=this.$14(a);return b(this.$1,e,a,c,d)};b.writeUint8=function(a){S(a,0,256,"uint8"),E(this,1,F,a,!1)};b.writeInt8=function(a){S(a,-128,128,"signed int8"),E(this,1,F,a,!0)};b.writeUint16=function(a,b){b===void 0&&(b=this.$8),S(a,0,65536,"uint16"),D(this,2,G,a,b)};b.writeInt16=function(a,b){b===void 0&&(b=this.$8),S(a,-32768,32768,"signed int16"),D(this,2,H,a,b)};b.writeUint32=function(a,b){b===void 0&&(b=this.$8),S(a,0,4294967296,"uint32"),D(this,4,I,a,b)};b.writeInt32=function(a,b){b===void 0&&(b=this.$8),S(a,-2147483648,2147483648,"signed int32"),D(this,4,J,a,b)};b.writeUint64=function(a,b){b===void 0&&(b=this.$8),S(a,0,18446744073709552e3,"uint64"),D(this,8,K,a,b)};b.writeInt64=function(a,b){b===void 0&&(b=this.$8),S(a,-9223372036854776e3,9223372036854776e3,"signed int64"),D(this,8,K,a,b)};b.writeFloat32=function(a,b){b===void 0&&(b=this.$8),D(this,4,L,a,b)};b.writeFloat64=function(a,b){b===void 0&&(b=this.$8),D(this,8,M,a,b)};b.writeVarInt=function(a){S(a,-9223372036854776e3,9223372036854776e3,"varint (signed int64)");var b=a<0;a=b?-a:a;var c=Math.floor(a/4294967296);a=a-c*4294967296;b&&(c=~c,a===0?c++:a=-a);b=R(c,a);E(this,b,N,c,a)};b.writeVarIntFromHexLong=function(a){var b=d("WAHex").hexLongIsNegative(a);a=b?d("WAHex").negateHexLong(a):a;a=d("WAHex").hexLongToHex(a);var c=0,e=0;for(var f=0;f<d("WAHex").NUM_HEX_IN_LONG;f++)c=c<<4|e>>>28,e=e<<4|d("WAHex").hexAt(a,f);b&&(c=~c,e===0?c++:e=-e);a=R(c,e);E(this,a,N,c,e)};b.writeBinary=function(a){a=a.peek(function(a){return a.readByteArray()});if(a.length){var b=this.$14(a.length);this.$1.set(a,b)}};b.writeBuffer=function(a){this.writeByteArray(new Uint8Array(a))};b.writeByteArray=function(a){var b=this.$14(a.length);this.$1.set(a,b)};b.writeBufferView=function(a){this.writeByteArray(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))};b.writeString=function(a){E(this,n(a),O,a)};b.writeHexLong=function(a,b){b===void 0&&(b=this.$8),D(this,8,P,a,b)};b.writeBytes=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++)S(b[d],0,256,"byte");E(this,b.length,Q,b)};b.writeAtomically=function(a,b){this.$10++;var c=this.$4,d=this.$5;try{a=a(this,b);c=this.$4;d=this.$5;return a}finally{this.$10--,this.$4=c-(this.$5-d)}};b.writeWithVarIntLength=function(a,b){var c=this.$4;a=this.writeAtomically(a,b);b=this.$4;this.writeVarInt(b-c);var d=this.$4-b,e=this.$1;for(var f=0;f<d;f++)j[f]=e[b+f];for(f=b-1;f>=c;f--)e[f+d]=e[f];for(b=0;b<d;b++)e[c+b]=j[b];return a};a.build=function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=0;for(var f=0;f<c.length;f++){var g=c[f];typeof g==="string"?e+=n(g):typeof g==="number"?e++:g instanceof a?e+=g.size():g instanceof ArrayBuffer?e+=g.byteLength:g instanceof Uint8Array&&(e+=g.length)}var h=new a();h.ensureCapacity(e);h.write.apply(h,arguments);return h};b.$12=function(){return this.$7||(this.$7=new DataView(this.$1.buffer,this.$1.byteOffset))};b.$11=function(a){if(a<0)throw c("err")("ReadError: given negative number of bytes to read");var b=this.$3;a=b+a;if(a>this.$2)throw c("err")(b===this.$2?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");this.$3=a;this.$9||(this.$6=a);return b};b.$13=function(a){var b=this.$1;if(a<=b.length)return a;else{var c=this.$6;a=a-c;var d=Math.max(a,2*(b.length-c),64);d=new Uint8Array(d);c?(d.set(b.subarray(c)),this.$5+=c,this.$3-=c,this.$2-=c,this.$4-=c,this.$6=0):d.set(b);this.$1=d;this.$7=null;return a}};b.$14=function(a){a=this.$13(this.$4+a);var b=this.$4;this.$4=a;this.$10||(this.$2=a);return b};return a}();var l="",m=0;function n(a){if(a===l)return m;var b=a.length,c=0;for(var d=0;d<b;d++){var e=a.charCodeAt(d);if(e<128)c++;else if(e<2048)c+=2;else if(e<55296||57344<=e&&e<=65535)c+=3;else if(55296<=e&&e<56320&&d+1!==b){e=a.charCodeAt(d+1);56320<=e&&e<57344?(d++,c+=4):c+=3}else c+=3}l=a;return m=c}function o(a,b,c){var d=b>>21;if(!a)return d===0;else{a=b&2097151;b=Boolean(a||c);return d===0||d===-1&&b}}function p(a,b,c,d,e){return a.readWithViewParser(b,c,d,e)}function q(a,b,c,d,e){return a.readWithBytesParser(b,c,d,e)}function r(a,b,c,d){return d?a.getInt8(b):a.getUint8(b)}function s(a,b,c,d){return a.getUint16(b,d)}function t(a,b,c,d){return a.getInt32(b,d)}function u(a,b,c,d){return a.getUint32(b,d)}function v(a,b,c,d,e){c=a.getInt32(e?b+4:b,e);a=a.getInt32(e?b:b+4,e);return d(c,a)}function w(a,b,c,d){return a.getFloat32(b,d)}function x(a,b,c,d){return a.getFloat64(b,d)}function y(a,b,d,e){d=Math.min(e,i);e=0;var f=128;while(e<d&&f&128)f=a[b+e++];if(e===i&&f>1)throw c("err")("ParseError: varint exceeds 64 bits");else if(f&128)return e+1;return e}function z(b,c,d,a){var e=0,f=0,g=d;d===i&&(g--,f=b[c+g]&1);for(d=g-1;d>=0;d--)e=e<<7|f>>>25,f=f<<7|b[c+d]&127;return a(e,f)}function A(a,b,c){b=b+a.byteOffset;a=a.buffer;return b===0&&c===a.byteLength?a:a.slice(b,b+c)}function B(a,b,c){return a.subarray(b,b+c)}function C(a,b,c){c=b+c;var d=[],e=null;for(b=b;b<c;b++){d.length>5e3&&(e||(e=[]),e.push(String.fromCharCode.apply(String,d)),d=[]);var f=a[b]|0;if((f&128)===0)d.push(f);else if((f&224)===192){var g=W(a,b+1,c);if(g){b++;g=(f&31)<<6|g&63;g>=128?d.push(g):d.push(h)}else d.push(h)}else if((f&240)===224){g=W(a,b+1,c);var i=W(a,b+2,c);if(g&&i){b+=2;i=(f&15)<<12|(g&63)<<6|i&63;i>=2048&&!(55296<=i&&i<57344)?d.push(i):d.push(h)}else g?(b++,d.push(h)):d.push(h)}else if((f&248)===240){i=W(a,b+1,c);g=W(a,b+2,c);var j=W(a,b+3,c);if(i&&g&&j){b+=3;f=(f&7)<<18|(i&63)<<12|(g&63)<<6|j&63;if(f>=65536&&f<=1114111){j=f-65536;d.push(55296|j>>10,56320|j&1023)}else d.push(h)}else i&&g?(b+=2,d.push(h)):i?(b++,d.push(h)):d.push(h)}else d.push(h)}f=String.fromCharCode.apply(String,d);if(e){e.push(f);return e.join("")}else return f}function D(a,b,c,d,e){return a.writeToView(b,c,d,e)}function E(a,b,c,d,e){return a.writeToBytes(b,c,d,e)}function F(a,b,c,d){a[b]=d}function G(a,b,c,d,e){a.setUint16(b,d,e)}function H(a,b,c,d,e){a.setInt16(b,d,e)}function I(a,b,c,d,e){a.setUint32(b,d,e)}function J(a,b,c,d,e){a.setInt32(b,d,e)}function K(a,b,c,d,e){c=d<0;d=c?-d:d;var f=Math.floor(d/4294967296);d=d-f*4294967296;c&&(f=~f,d===0?f++:d=-d);a.setUint32(e?b+4:b,f,e);a.setUint32(e?b:b+4,d,e)}function L(a,b,c,d,e){a.setFloat32(b,d,e)}function M(a,b,c,d,e){a.setFloat64(b,d,e)}function N(a,b,c,d,e){d=d;e=e;c=b+c-1;for(b=b;b<c;b++)a[b]=128|e&127,e=d<<25|e>>>7,d>>>=7;a[c]=e}function O(a,b,c,d){c=b;b=d.length;for(var e=0;e<b;e++){var f=d.charCodeAt(e);if(f<128)a[c++]=f;else if(f<2048)a[c++]=192|f>>6,a[c++]=128|f&63;else if(f<55296||57344<=f)a[c++]=224|f>>12,a[c++]=128|f>>6&63,a[c++]=128|f&63;else if(55296<=f&&f<56320&&e+1!==b){var g=d.charCodeAt(e+1);if(56320<=g&&g<57344){e++;f=65536+((f&1023)<<10|g&1023);a[c++]=240|f>>18;a[c++]=128|f>>12&63;a[c++]=128|f>>6&63;a[c++]=128|f&63}else a[c++]=239,a[c++]=191,a[c++]=189}else a[c++]=239,a[c++]=191,a[c++]=189}}function P(a,b,c,e,f){c=d("WAHex").hexLongIsNegative(e);e=d("WAHex").hexLongToHex(e);var g=0,h=0;for(var i=0;i<16;i++)g=g<<4|h>>>28,h=h<<4|d("WAHex").hexAt(e,i);c&&(g=~g,h===0?g++:h=-h);a.setUint32(f?b+4:b,g,f);a.setUint32(f?b:b+4,h,f)}function Q(a,b,c,d){for(var e=0;e<c;e++)a[b+e]=d[e]}function R(a,b){var c;a?(c=5,a=a>>>3):(c=1,a=b>>>7);while(a)c++,a>>>=7;return c}function S(a,b,d,e){if(typeof a!=="number"||a!==a||Math.floor(a)!==a||a<b||a>=d)throw c("err")(typeof a==="string"?'TyperError WriteError: string "'+a+'" is not a valid '+e:"TypeError WriteError: "+String(a)+" is not a valid "+e)}function T(a,b,d){var e=o(a,b,d),f;b>=0?f=b:f=a?b:4294967296+b;a=d>=0?d:4294967296+d;b=f*4294967296+a;if(!e)throw c("err")("ReadError: integer exceeded 53 bits ("+b+")");return b}function U(a,b){return T(!0,a,b)}function V(a,b){return T(!1,a,b)}function W(a,b,c){if(b>=c)return 0;c=a[b]|0;return(c&192)===128?c:0}g.Binary=a;g.numUtf8Bytes=n;g.longFitsInDouble=o;g.parseInt64OrThrow=U;g.parseUint64OrThrow=V}),98);
__d("WAHasProperty",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return Object.prototype.hasOwnProperty.call(a,b)}f["default"]=a}),66);
__d("WAProtoCompile",["WAProtoConst"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c,d,e,f,g,h,i){this.names=a,this.fields=b,this.types=c,this.defaults=d,this.meta=e,this.oneofToFields=f,this.fieldToOneof=g,this.reservedTags=h?h.reduce(function(a,b){a[b]=!0;return a},{}):{},this.reservedFields=i?i.reduce(function(a,b){a[b]=!0;return a},{}):{}};function a(a){if(a.internalCompiledSpec)return a.internalCompiledSpec;var b=a.internalSpec;if(!b)throw new Error("Message Class "+String(a)+" does not have internalSpec");var c=a.internalDefaults||{},e=Object.keys(b).filter(function(a){return a!==d("WAProtoConst").KEYS.ONEOF}),f=new Array(e.length),g=[],j=[],k=new Array(e.length),l=b[d("WAProtoConst").KEYS.ONEOF]||{};e.sort(function(a,c){a=i(b,a);c=i(b,c);return a[0]-c[0]});for(var m=0;m<e.length;m++){var n=e[m],o=i(b,n);k[m]=c[n];var p=o[1],q=o[0];g.push(q);j.push(p);if((p&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE)f[m]=o[2];else if((p&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.ENUM){q=o[2];if(typeof q.cast==="function")f[m]=q;else{var r=!0,s=0;for(var t in q)r&&t!==s++&&(r=!1);t=void 0;if(r){t=[];for(r=0;r<s;r++)t.push(!0)}else{t={};for(r in q)t[q[r]]=!0}f[m]=t}}else if((p&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MAP){if(o.length!==3)throw new Error("Map field "+n+" should have exactly three elements in its internalSpec");f[m]=o[2]}else f[m]=null}var u={};s=function(a){l[a].forEach(function(b){u[b]||(u[b]=[]),u[b].push(a)})};for(r in l)s(r);q=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_TAGS];t=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_FIELDS];p=new h(e,g,j,k,f,l,u,q,t);a.internalCompiledSpec=p;return p}function i(a,b){a=a[b];if(a==null)throw new Error("fieldData of "+b+" is missing");return a}g.Spec=h;g.compileSpec=a}),98);
__d("WAProtoUtils",["WAProtoConst"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a&d("WAProtoConst").FLAGS.PACKED)return d("WAProtoConst").ENC.BINARY;a=a&d("WAProtoConst").TYPE_MASK;if(a<=d("WAProtoConst").TYPES.ENUM)return d("WAProtoConst").ENC.VARINT;else if(a<=d("WAProtoConst").TYPES.DOUBLE)return d("WAProtoConst").ENC.BIT64;else if(a<=d("WAProtoConst").TYPES.MESSAGE)return d("WAProtoConst").ENC.BINARY;else if(a===d("WAProtoConst").TYPES.MAP)return d("WAProtoConst").ENC.BINARY;else return d("WAProtoConst").ENC.BIT32}g.typeToEncType=a}),98);
__d("WAProtoValidate",["WAHasProperty","WALogger","WAProtoCompile","WAProtoConst"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not an array']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not ',""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is out of range']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid int']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid long']);l=function(){return a};return a}var m=Number.MAX_SAFE_INTEGER;function n(a,b){a=o(a,b);if(a){a.reverse();throw new TypeError("Message missing required value "+a.join("."))}}function a(a,b){n(a,b);b=u(b,a);if(b){b.path.reverse();throw new TypeError("Invalid value at "+b.path.join(".")+": "+b.error)}}function o(a,b){a=d("WAProtoCompile").compileSpec(a);var e=a.names,f=a.types;a=a.meta;var g=void 0;for(var h=0;h<f.length&&!g;h++){var i=f[h],j=e[h],k=c("WAHasProperty")(b,j)?b[j]:void 0;if(i&d("WAProtoConst").FLAGS.REQUIRED&&k==null)g=[j];else if((i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&i&d("WAProtoConst").FLAGS.REPEATED&&k!=null){var l=a[h],m=void 0;for(m=0;m<k.length&&!g;m++)g=o(l,k[m]);g&&g.push(j+"["+m+"]")}else(i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&k!=null&&(g=o(a[h],k),g&&g.push(j))}return g}function p(a,b,c){if(typeof a==="string")if(/^-?0x[0-9a-f]{16}$/i.test(a))return!1;else{d("WALogger").LOG(l(),s(a)).color("red");return{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}}else return q(a,b,c)}function q(a,b,c){if(typeof a!=="number"||a!==a||Math.floor(a)!==a){d("WALogger").LOG(k(),s(a)).color("red");return{path:[],error:"value must be an int"}}else if(a<b||a>=c){d("WALogger").LOG(j(),s(a)).color("red");return{path:[],error:"value is out of range"}}else return!1}function r(a,b,c){if(a)return void 0;else{d("WALogger").LOG(i(),s(c),b).color("red");return{path:[],error:"value is invalid"}}}function s(a){if(typeof a==="string")return'"'+a+'"';else if(Array.isArray(a))return"["+a.join(", ")+"]";else return""+a}var t=[void 0,function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return q(a,0,4294967296)},function(a){return p(a,0,m+1)},function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="boolean","boolean",a)},function(a,b){return r(typeof a==="number"&&(b[a]||b.cast(a)!==void 0),"in enum",a)},function(a){return p(a,0,m+1)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="number","number",a)},function(a){return r(typeof a==="string","string",a)},function(a){return r(a instanceof ArrayBuffer||a instanceof Uint8Array,"ArrayBuffer or Uint8Array",a)},u,function(a){return q(a,0,4294967296)},function(a){return q(a,-2147483648,2147483648)},function(a){return r(typeof a==="number","number",a)}];function u(a,b){b=d("WAProtoCompile").compileSpec(b);var c=b.names,e=b.fields,f=b.types,g=b.meta,i=b.oneofToFields,j=b.fieldToOneof,k=b.reservedTags,l=b.reservedFields,m=void 0;b=function(b){var n=c[b],o=f[b],p=a[n],q=o&d("WAProtoConst").TYPE_MASK,r=t[q],u=(o&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MAP;if(r===void 0&&!u)throw new Error("Can not find the validator for type "+q);if(o&(d("WAProtoConst").FLAGS.PACKED|d("WAProtoConst").FLAGS.REPEATED)&&p!=null)if(!Array.isArray(p))d("WALogger").LOG(h(),s(p)).color("red"),m={path:[n],error:"repeated field must be array"};else{q=g[b];for(o=0;o<p.length&&!m;o++)m=r(p[o],q),m&&m.path.push(n+"["+o+"]")}else if(u&&p!=null){o=g[b];q=o[0];u=o[1];o=typeof u==="object"?d("WAProtoConst").TYPES.MESSAGE:u;var v=t[q],w=t[o];if(v===void 0||w===void 0)throw new Error("Can not find the validator for Map with key type "+q+", value type "+o);for(var o=p,x=Array.isArray(o),y=0,o=x?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var z;if(x){if(y>=o.length)break;z=o[y++]}else{y=o.next();if(y.done)break;z=y.value}z=z;var A=z[0];z=z[1];m=v(A,q);if(m){m.path.push(n+"'s key ["+A+"]");return{v:m}}m=w(z,u);if(m){m.path.push(n+"["+A+"]'s value");return{v:m}}}}else if(p!=null){m=r(p,g[b]);m&&m.path.push(n);z=j[n];z&&z.forEach(function(b){var c=i[b].filter(function(a){return a!==n});c.forEach(function(c){typeof a[c]!=="undefined"&&(m={path:[b],error:"oneof '"+b+"' has fields '"+n+"' and '"+c+"' set"})})});k[e[b]]&&(m={path:[n],error:"tag "+e[b]+" is reserved"});l[n]&&(m={path:[n],error:"field "+n+" is reserved"})}};for(var n=0;n<c.length&&!m;n++){var o=b(n);if(typeof o==="object")return o.v}return m}g.checkRequirements=n;g.checkValid=a}),98);
__d("decodeProtobuf",["WABinary","WAHasProperty","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!1);d("WAProtoValidate").checkRequirements(a,b);return b}function b(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!0);d("WAProtoValidate").checkRequirements(a,b);return b}function e(a){return c("WAHasProperty")(a,"$$unsafeUnknownFields")?a.$$unsafeUnknownFields:null}function h(a,b,c){if(a!==d("WAProtoUtils").typeToEncType(b))throw new Error("FormatError: "+c+" encoded with wire type "+a)}function i(a,b,c){switch(b){case d("WAProtoConst").TYPES.INT32:return j(c,-2147483648,2147483648,a,d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.INT64:return c.readVarInt(k);case d("WAProtoConst").TYPES.UINT32:return j(c,0,4294967296,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.UINT64:return c.readVarInt(l);case d("WAProtoConst").TYPES.SINT32:b=j(c,0,4294967296,a,d("WABinary").parseInt64OrThrow);return b&1?~(b>>>1):b>>>1;case d("WAProtoConst").TYPES.SINT64:return c.readVarInt(m);case d("WAProtoConst").TYPES.BOOL:return!!j(c,0,2,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.ENUM:return c.readVarInt(d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.FIXED64:return c.readLong(l,!0);case d("WAProtoConst").TYPES.SFIXED64:return c.readLong(k,!0);case d("WAProtoConst").TYPES.DOUBLE:return c.readFloat64(!0);case d("WAProtoConst").TYPES.STRING:return c.readString(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.BYTES:return c.readBuffer(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.FIXED32:return c.readUint32(!0);case d("WAProtoConst").TYPES.SFIXED32:return c.readInt32(!0);case d("WAProtoConst").TYPES.FLOAT:return c.readFloat32(!0)}}function j(a,b,c,d,e){a=a.readVarInt(e);if(a<b||a>=c)throw new Error("FormatError: "+d+" encoded with out-of-range value "+a);return a}function k(a,b){var c=d("WABinary").longFitsInDouble(!0,a,b);if(c){c=o(b);return a*4294967296+c}else{c=a<0;var e;c?e=b===0?-a:~a:e=a;a=c?-b:b;return d("WAHex").createHexLongFrom32Bits(e,a,c)}}function l(a,b){var c=d("WABinary").longFitsInDouble(!1,a,b);if(c){c=o(a);var e=o(b);return c*4294967296+e}else return d("WAHex").createHexLongFrom32Bits(a,b)}function m(a,b){var c=a>>>1;a=a<<31|b>>>1;b&1&&(c=~c,a=~a);return k(c,a)}function n(a,b,c,e){var f=d("WAProtoCompile").compileSpec(a),g=f.names,k=f.fields,l=f.types,m=f.meta,o=f.oneofToFields,p=f.fieldToOneof,q=f.reservedTags,r=f.reservedFields;f=a.internalDefaults;var s=c||babelHelpers["extends"]({},f)||{};s.$$unknownFieldCount=(a=c==null?void 0:c.$$unknownFieldCount)!=null?a:0;for(f=0;f<g.length;f++)l[f]&d("WAProtoConst").FLAGS.REPEATED?s[g[f]]=[]:l[f]===(d("WAProtoConst").TYPES.MAP&d("WAProtoConst").TYPE_MASK)&&(s[g[f]]=new Map());var t=0;c=k.length>0;a=k[0];while(b.size()){f=j(b,0,4294967296,"field and enc type",d("WABinary").parseInt64OrThrow);var u=f&7,v=f>>>3;if(c&&v!==a){f=t;do++t===k.length&&(t=0),a=k[t];while(v!==a&&t!==f)}if(c&&v===a)(function(){var a=g[t],c=l[t];h(u,c,a);var f=c&d("WAProtoConst").TYPE_MASK,k=m[t];if(c&d("WAProtoConst").FLAGS.PACKED){var w=b.readVarInt(d("WABinary").parseUint64OrThrow);w=b.readBinary(w);while(w.size()){var x=i(a,f,w);(f!==d("WAProtoConst").TYPES.ENUM||k[x]||(k.cast==null?void 0:k.cast(x))!==void 0)&&s[a].push(x)}}else if(f===d("WAProtoConst").TYPES.MESSAGE){x=b.readVarInt(d("WABinary").parseUint64OrThrow);w=b.readBinary(x);if(c&d("WAProtoConst").FLAGS.REPEATED)s[a].push(n(k,w,void 0,e));else{x=s[a];s[a]=n(k,w,x,e)}}else if(f===d("WAProtoConst").TYPES.MAP){w=b.readVarInt(d("WABinary").parseUint64OrThrow);x=b.readBinary(w);var y,z;for(w=0;w<m[t].length;w++){var A=j(x,0,4294967296,"map field and enc type",d("WABinary").parseInt64OrThrow),B=A&7;A=A>>>3;var C=void 0;switch(B){case d("WAProtoConst").ENC.VARINT:C=x.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:C=x.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:B=k[w];if(B===d("WAProtoConst").TYPES.BYTES||B===d("WAProtoConst").TYPES.STRING)C=i(a,B,x);else{var D=x.readVarInt(d("WABinary").parseUint64OrThrow);D=x.readBinary(D);C=n(B,D,void 0,e)}break;case d("WAProtoConst").ENC.BIT32:C=x.readBinary(4);break}A===1?y=C:z=C}s[a].set(y,z)}else{B=i(a,f,b);(f!==d("WAProtoConst").TYPES.ENUM||k[B]||(k.cast==null?void 0:k.cast(B))!==void 0)&&(c&d("WAProtoConst").FLAGS.REPEATED?s[a].push(B):s[a]=B)}D=p[a];D&&typeof s[a]!=="undefined"&&D.forEach(function(b){b=o[b].filter(function(b){return b!==a});b.forEach(function(a){delete s[a]})});(q[v]||r[a])&&delete s[a]})();else{s.$$unknownFieldCount++;if(e){s.$$unsafeUnknownFields||(s.$$unsafeUnknownFields={});f=void 0;switch(u){case d("WAProtoConst").ENC.VARINT:f=b.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:f=b.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:f=b.readBinary(b.readVarInt(d("WABinary").parseUint64OrThrow));break;case d("WAProtoConst").ENC.BIT32:f=b.readBinary(4);break}s.$$unsafeUnknownFields[v]=f}else u===d("WAProtoConst").ENC.VARINT?b.readVarInt(d("WABinary").parseInt64OrThrow):u===d("WAProtoConst").ENC.BIT64?b.advance(8):u===d("WAProtoConst").ENC.BINARY?b.advance(b.readVarInt(d("WABinary").parseUint64OrThrow)):u===d("WAProtoConst").ENC.BIT32&&b.advance(4)}}return s}function o(a){return a>=0?a:4294967296+a}g.decodeProtobuf=a;g.decodeProtobufWithUnknowns=b;g.getUnknownFields=e}),98);
__d("encodeProtobuf",["WABinary","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){"use strict";var h=void 0,i=128;function a(a,b,c){c===void 0&&(c=new(d("WABinary").Binary)());d("WAProtoValidate").checkValid(a,b);o(c,b,a);h=void 0;return c}function b(){return h!==void 0?"Last encoded value for "+h:"No information known"}function c(a,b){a.writeVarInt(b)}function e(a,b){if(typeof b==="number"&&b<4503599627370496&&b>=-4503599627370496)a.writeVarInt(b>=0?2*b:2*-b-1);else{var c=new(d("WABinary").Binary)(),e;typeof b==="number"?(e=b<0,c.writeVarInt(e?-b:b)):(e=d("WAHex").hexLongIsNegative(b),c.writeVarIntFromHexLong(e?d("WAHex").negateHexLong(b):b));b=c.peek(function(){return c.readByteArray()});var f=b.byteLength;if(e){var g=0,h;do h=b[g],b[g]=h&i|(h&127)-1&127,g++;while(b[g-1]===255)}h=e?1:0;for(g=0;g<f;g++){e=b[g];var j=e&i|(e&63)<<1|h;h=(e&64)>>6;b[g]=j}h===1&&(b[f-1]|=i,c.writeInt8(1));a.writeBinary(c)}}function f(a,b){typeof b==="number"?a.writeVarInt(b):a.writeVarIntFromHexLong(b)}function j(a,b){a.writeVarInt(d("WABinary").numUtf8Bytes(b)),a.writeString(b)}function k(a,b){a.writeVarInt(b.byteLength),a.writeBuffer(b)}function l(a,b,c){a.writeWithVarIntLength(function(a,b){return o(a,b,c)},b)}var m=[void 0,c,f,c,f,e,e,function(a,b){a.writeVarInt(b?1:0)},c,function(a,b){typeof b==="number"?a.writeUint64(b,!0):a.writeHexLong(b,!0)},function(a,b){typeof b==="number"?a.writeInt64(b,!0):a.writeHexLong(b,!0)},function(a,b){a.writeFloat64(b,!0)},j,k,l,function(a,b){a.writeUint32(b,!0)},function(a,b){a.writeInt32(b,!0)},function(a,b){a.writeFloat32(b,!0)}];f=function(a){if(a==null)return void 0;var b=a;function c(a,c){for(var d=0;d<c.length;d++)b(a,c[d])}return function(a,b){a.writeWithVarIntLength(c,b)}};var n=m.map(f);function o(a,b,c){var e=d("WAProtoCompile").compileSpec(c),f=e.names,g=e.fields,i=e.types;e=e.meta;c=c.internalDefaults;for(var j=0;j<f.length;j++){var k=f[j],l=b[k];l==null&&c&&(l=c[k]);if(l!=null){h=k;k=g[j];var o=i[j],p=o&d("WAProtoConst").TYPE_MASK,q=e[j];k=k*8|d("WAProtoUtils").typeToEncType(o);if(o&d("WAProtoConst").FLAGS.PACKED){if(l.length>0){a.writeVarInt(k);var r=n[p];r(a,l,q)}}else if(o&d("WAProtoConst").FLAGS.REPEATED)for(r=0;r<l.length;r++){a.writeVarInt(k);o=m[p];o(a,l[r],q)}else if(p===d("WAProtoConst").TYPES.MAP)for(var o=l,r=Array.isArray(o),s=0,o=r?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(r){if(s>=o.length)break;t=o[s++]}else{s=o.next();if(s.done)break;t=s.value}t=t;var u=t[0];t=t[1];a.writeVarInt(k);var v=q[0],w=q[1],x=typeof w==="object"?d("WAProtoConst").TYPES.MESSAGE:w,y=m[v],z=m[x];if(y==null||z==null)throw new Error("Invalid encoder for map key/value");var A=new(d("WABinary").Binary)(),B=1*8|d("WAProtoUtils").typeToEncType(v);A.writeVarInt(B);y(A,u,v);B=2*8|d("WAProtoUtils").typeToEncType(x);A.writeVarInt(B);z(A,t,w);a.writeVarInt(A.size());a.writeBinary(A)}else{a.writeVarInt(k);y=m[p];y(a,l,q)}}}}g.encodeProtobuf=a;g.encodeErrorInfo=b}),98);
__d("WAMediaUtils",["Promise","WACryptoDependencies","WAGlobals","WALongInt","WAMediaEntryData.pb","WAProgressiveJpegGetScanLengths","WAResultOrError","WAServerMediaType","WATimeUtils","decodeProtobuf","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=new Uint8Array(32);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a.buffer}function j(a){return a}function a(){return i()}function k(a){return a}function l(a){return a}function e(a){return a}var m="0_0_0_.enc";function f(a){if(a==null)return d("WAResultOrError").makeError("direct-path-undefined");if(a==="")return d("WAResultOrError").makeError("direct-path-empty");return a.includes(m)?d("WAResultOrError").makeError("direct-path-corrupted"):d("WAResultOrError").makeResult(a)}function n(a){return a}function o(a){return a}function p(a,b){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,b);b=a.fileSha256;var c=a.mediaKey,e=a.fileEncSha256,f=a.directPath,g=a.mediaKeyTimestamp,h=a.sidecar,i=a.objectId,j=a.fbid,k=a.serverMediaType,m=a.downloadableThumbnail,n=a.filename,o=a.progressiveJpegDetails;a=a.size;return{fileSha256:b,mediaKey:c,fileEncSha256:e,directPath:f,mediaKeyTimestamp:g==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(g)),sidecar:h&&l(h),objectId:i,fbid:j,downloadableThumbnail:m&&w(m),serverMediaType:k,filename:n,progressiveJpegDetails:o&&x(o),size:a==null?void 0:d("WALongInt").numberOrThrowIfTooLarge(a)}}function q(a){var b=a.fileSha256,c=a.fileEncSha256,e=a.mediaKey,f=a.directPath,g=a.mediaKeyTimestamp,h=a.serverMediaType,i=a.objectId,j=a.fbid,k=a.downloadableThumbnail,l=a.filename,m=a.progressiveJpegDetails;a=a.size;b=d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,{fileSha256:b,fileEncSha256:c,mediaKey:e,directPath:f,mediaKeyTimestamp:g,serverMediaType:h,objectId:i,fbid:j,downloadableThumbnail:k,filename:l,progressiveJpegDetails:m,size:a});return b.readByteArray()}function r(a){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function s(a,b){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers["extends"]({},a,{directPath:b})).readByteArray()}function t(a,b){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers["extends"]({},a,{downloadableThumbnail:babelHelpers["extends"]({},a.downloadableThumbnail,{directPath:b})})).readByteArray()}function u(a,b){a=babelHelpers["extends"]({},a,{fbid:b});return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function v(a,b){a=babelHelpers["extends"]({},a,{objectId:b});return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function w(a){if(a==null)return null;a.$$unknownFieldCount;var b=a.directPath,c=a.objectId,e=babelHelpers.objectWithoutPropertiesLoose(a,["$$unknownFieldCount","directPath","objectId"]);return babelHelpers["extends"]({},e,{directPath:b,objectId:c,mediaKey:a.mediaKey&&j(a.mediaKey),mediaKeyTimestamp:a.mediaKeyTimestamp==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(a.mediaKeyTimestamp))})}function x(a){if(a==null)return null;return a.scanLengths==null||a.sidecar==null?null:{sidecar:a.sidecar,scanLengths:a.scanLengths.map(function(a){return d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength(d("WALongInt").numberOrThrowIfTooLarge(a))})}}function y(a){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a);var b=a.serverMediaType,c=a.mediaKey,e=a.mediaKeyTimestamp,f=a.uploadToken,g=a.downloadableThumbnail,h=a.progressiveJpegDetails,i=a.size,l=a.lastDownloadAttemptTimestamp,m=a.sidecar,n=a.directPath,o=a.objectId;a=babelHelpers.objectWithoutPropertiesLoose(a,["serverMediaType","mediaKey","mediaKeyTimestamp","uploadToken","downloadableThumbnail","progressiveJpegDetails","size","lastDownloadAttemptTimestamp","sidecar","directPath","objectId"]);var p=null;h!=null&&h.scanLengths!=null&&h.sidecar!=null&&(p={sidecar:h.sidecar,scanLengths:h.scanLengths.map(function(a){return d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength(d("WALongInt").numberOrThrowIfTooLarge(a))})});return babelHelpers["extends"]({},a,{objectId:o,directPath:n,sidecar:m,serverMediaType:b==null?null:d("WAServerMediaType").castToServerMediaType(b),mediaKey:c&&j(c),mediaKeyTimestamp:e==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(e)),uploadToken:f&&k(f),progressiveJpegDetails:p,downloadableThumbnail:g&&w(g),size:d("WALongInt").maybeNumberOrThrowIfTooLarge(i),lastDownloadAttemptTimestamp:l==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(l))})}function z(a){return"arrayBuffer"in a&&typeof a.arrayBuffer==="function"?a.arrayBuffer():new(h||(h=b("Promise")))(function(b,d){var e=new FileReader();e.onload=function(){var a=e.result;a instanceof ArrayBuffer?b(a):d(c("err")("blobToArrayBuffer got error because result is not ArrayBuffer: "+typeof a))};e.onerror=function(){var a;d((a=e.error)!=null?a:c("err")("blobToArrayBuffer got unknown error"))};e.readAsArrayBuffer(a)})}function A(a){var b="image/jpeg";switch(a){case"image":b="image/jpeg";break;case"ptt":b="audio/wav";break;case"video":b="video/mp4";break;case"gif":b="image/gif";break;case"sticker":b="image/webp";break;case"preview":b="image/jpeg";break;case"document":b=d("WAGlobals").getConfig().isOctetStreamAttachmentMimeTypeEnabled()===!0?"application/octet-stream":"application/pdf";break;case"xma-image":b="image/jpeg";break;default:throw c("err")("Unsupported server media type: "+a)}return b}var B=function(){return"TransformStream"in self};g.createMediaKey=i;g.castToMediaKey=j;g.createUploadToken=a;g.castToUploadToken=k;g.castToStreamingSidecar=l;g.unsafeCastToDirectPath=e;g.validateDirectPath=f;g.stringToDeliveryObjectId=n;g.stringToBackupEntFbid=o;g.mediaEntryDataToRawData=p;g.rawDataToMediaEntry=q;g.encodeMediaEntryForUpload=r;g.encodeMediaEntryWithUpdatedPath=s;g.encodeMediaEntryDownloadableThumbnailWithUpdatedPath=t;g.encodeMediaEntryWithUpdatedFbid=u;g.encodeMediaEntryWithUpdatedObjectId=v;g.convertMediaDownloadableThumbnailToDownloadableThumbnail=w;g.decodeMediaEntryData=y;g.blobToArrayBuffer=z;g.getMimeTypeFromServerMediaType=A;g.isTransformStreamSupported=B}),98);
__d("MAWImageUtils",["Promise","WAMediaUtils","cr:8676","err","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i="image/jpeg",j=100,k=c("justknobx")._("2338")*1024,l=c("justknobx")._("2340"),m=c("justknobx")._("2545");function n(a,d){d===void 0&&(d=!0);var e;return new(h||(h=b("Promise")))(function(b,f){e=new Image();var g=/^(?:data|blob):/.test(a);d&&!g&&e.setAttribute("crossOrigin","anonymous");e.onload=b;e.onabort=function(){f(function(){throw c("err")("Error loading image from provided URL")})};e.onerror=function(){f(function(){throw c("err")("Wrong blob type")})};e.src=a}).then(function(){return e})}function o(a,c,d,e){d===void 0&&(d=!1);if(a.toBlob)return new(h||(h=b("Promise")))(function(b){var d=e==null?void 0:e/100;a.toBlob(b,c,d)}).then(function(e){var f=k,g=l/100;return d&&e.size>=f?new(h||(h=b("Promise")))(function(b){a.toBlob(b,c,g)}):e});else{var f,g=(f=b("cr:8676")==null?void 0:b("cr:8676").dataURLtoBlob)!=null?f:window.dataURLtoBlob;return(h||(h=b("Promise"))).resolve(g(a.toDataURL(c))).then(function(e){var f=k,i=l/100;return d&&e.size>=f?(h||(h=b("Promise"))).resolve(g(a.toDataURL(c,i))):e})}}function a(a,d,e,f){return n(a).then(function(a){var b=document.createElement("canvas");b.width=a.naturalWidth;b.height=a.naturalHeight;var c=b.getContext("2d");f!==!0&&r(b);c.drawImage(a,0,0);return o(b,d,!1,e).then(function(b){return{blob:b,height:a.naturalHeight,width:a.naturalWidth}})})["catch"](function(a){return(h||(h=b("Promise"))).reject((a=a)!=null?a:c("err")("Error loading image from URL"))})}var p=function(a){return!c("gkx")("5179")?a.arrayBuffer():d("WAMediaUtils").blobToArrayBuffer(a)};function e(a,b){return n(a).then(function(a){var c=document.createElement("canvas"),d=a.naturalWidth,e=a.naturalHeight,f=c.getContext("2d");e=s(e,d,b);c.width=e.width;c.height=e.height;var g=c.width,h=c.height;q(c);f.drawImage(a,0,0,g,h);return o(c,i,!0).then(function(a){return p(a).then(function(a){return{height:h,jpegThumbnail:a,width:g}})})})}function f(a,b){return n(a).then(function(a){a=s(a.naturalHeight,a.naturalWidth,b);return{height:a.height,width:a.width}})}function q(a){var b=a.getContext("2d");b.fillStyle="rgb(247,247,247)";b.fillRect(0,0,a.width,a.height)}function r(a){var b=a.getContext("2d");b.fillStyle="rgb(255,255,255)";b.fillRect(0,0,a.width,a.height)}function s(a,b,c){b=b!=null?b:c;a=a!=null?a:c;b>a?b>c&&(a*=c/b,b=c):a>c&&(b*=c/a,a=c);return{height:Math.round(Math.max(a,1)),width:Math.round(Math.max(b,1))}}function t(a){return n(a).then(function(a){return{height:a.naturalHeight,width:a.naturalWidth}})}g.TYPE_JPEG=i;g.IMG_THUMB_MAX_EDGE=j;g.STICKER_THUMBNAIL_MAX_SIZE=m;g.canvasToBlob=o;g.urlToFile=a;g.urlToThumbnail=e;g.urlToThumbnailSpec=f;g.boundHeightWidth=s;g.urlToImageSpec=t}),98);
__d("WACommon.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={EVERYONE:1,SILENT:2,AI:3,AI_IMAGINE:4};b={PLACEHOLDER:0,NO_PLACEHOLDER:1,IGNORE:2};c={};e={};f={};var h={};c.internalSpec={remoteJid:[1,(d=d("WAProtoConst")).TYPES.STRING],fromMe:[2,d.TYPES.BOOL],id:[3,d.TYPES.STRING],participant:[4,d.TYPES.STRING]};e.internalSpec={commandType:[1,d.TYPES.ENUM,a],offset:[2,d.TYPES.UINT32],length:[3,d.TYPES.UINT32],validationToken:[4,d.TYPES.STRING]};f.internalSpec={text:[1,d.TYPES.STRING],mentionedJid:[2,d.FLAGS.REPEATED|d.TYPES.STRING],commands:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,e]};h.internalSpec={payload:[1,d.TYPES.BYTES],version:[2,d.TYPES.INT32]};g.COMMAND_COMMAND_TYPE=a;g.FUTURE_PROOF_BEHAVIOR=b;g.MessageKeySpec=c;g.CommandSpec=e;g.MessageTextSpec=f;g.SubProtocolSpec=h}),98);
__d("WAArmadilloXMA.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={INFO:0,EYE_OFF:1,NEWS_OFF:2,WARNING:3,PRIVATE:4,NONE:5,MEDIA_LABEL:6,POST_COVER:7,POST_LABEL:8,WARNING_SCREENS:9};b={OPEN_NATIVE:11};c={SINGLE:0,HSCROLL:1,PORTRAIT:3,STANDARD_DXMA:12,LIST_DXMA:15,GRID:16};e={UNSUPPORTED:-1,IG_STORY_PHOTO_MENTION:4,IG_SINGLE_IMAGE_POST_SHARE:9,IG_MULTIPOST_SHARE:10,IG_SINGLE_VIDEO_POST_SHARE:11,IG_STORY_PHOTO_SHARE:12,IG_STORY_VIDEO_SHARE:13,IG_CLIPS_SHARE:14,IG_IGTV_SHARE:15,IG_SHOP_SHARE:16,IG_PROFILE_SHARE:19,IG_STORY_PHOTO_HIGHLIGHT_SHARE:20,IG_STORY_VIDEO_HIGHLIGHT_SHARE:21,IG_STORY_REPLY:22,IG_STORY_REACTION:23,IG_STORY_VIDEO_MENTION:24,IG_STORY_HIGHLIGHT_REPLY:25,IG_STORY_HIGHLIGHT_REACTION:26,IG_EXTERNAL_LINK:27,IG_RECEIVER_FETCH:28,FB_FEED_SHARE:1e3,FB_STORY_REPLY:1001,FB_STORY_SHARE:1002,FB_STORY_MENTION:1003,FB_FEED_VIDEO_SHARE:1004,FB_GAMING_CUSTOM_UPDATE:1005,FB_PRODUCER_STORY_REPLY:1006,FB_EVENT:1007,FB_FEED_POST_PRIVATE_REPLY:1008,FB_SHORT:1009,FB_COMMENT_MENTION_SHARE:1010,MSG_EXTERNAL_LINK_SHARE:2e3,MSG_P2P_PAYMENT:2001,MSG_LOCATION_SHARING:2002,MSG_LOCATION_SHARING_V2:2003,MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:2004,MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:2005,MSG_RECEIVER_FETCH:2006,MSG_IG_MEDIA_SHARE:2007,MSG_GEN_AI_SEARCH_PLUGIN_RESPONSE:2008,MSG_REELS_LIST:2009,MSG_CONTACT:2010,MSG_THREADS_POST_SHARE:2011,MSG_FILE:2012,MSG_AVATAR_DETAILS:2013,MSG_AI_CONTACT:2014,MSG_MEMORIES_SHARE:2015,MSG_SHARED_ALBUM_REPLY:2016,MSG_SHARED_ALBUM:2017,MSG_OCCAMADILLO_XMA:2018,MSG_GEN_AI_SUBSCRIPTION:2021,MSG_GEN_AI_REMINDER:2022,MSG_GEN_AI_MEMU_ONBOARDING_RESPONSE:2023,MSG_NOTE_REPLY:2024,MSG_NOTE_MENTION:2025,RTC_AUDIO_CALL:3e3,RTC_VIDEO_CALL:3001,RTC_MISSED_AUDIO_CALL:3002,RTC_MISSED_VIDEO_CALL:3003,RTC_GROUP_AUDIO_CALL:3004,RTC_GROUP_VIDEO_CALL:3005,RTC_MISSED_GROUP_AUDIO_CALL:3006,RTC_MISSED_GROUP_VIDEO_CALL:3007,DATACLASS_SENDER_COPY:4e3};f={};var i={};f.internalSpec={associatedMessage:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,(d=d("WACommon.pb")).SubProtocolSpec],targetType:[2,h.TYPES.ENUM,e],targetUsername:[3,h.TYPES.STRING],targetId:[4,h.TYPES.STRING],targetExpiringAtSec:[5,h.TYPES.INT64],xmaLayoutType:[6,h.TYPES.ENUM,c],ctas:[7,h.FLAGS.REPEATED|h.TYPES.MESSAGE,i],previews:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d.SubProtocolSpec],titleText:[9,h.TYPES.STRING],subtitleText:[10,h.TYPES.STRING],maxTitleNumOfLines:[11,h.TYPES.UINT32],maxSubtitleNumOfLines:[12,h.TYPES.UINT32],favicon:[13,h.TYPES.MESSAGE,d.SubProtocolSpec],headerImage:[14,h.TYPES.MESSAGE,d.SubProtocolSpec],headerTitle:[15,h.TYPES.STRING],overlayIconGlyph:[16,h.TYPES.ENUM,a],overlayTitle:[17,h.TYPES.STRING],overlayDescription:[18,h.TYPES.STRING],sentWithMessageId:[19,h.TYPES.STRING],messageText:[20,h.TYPES.STRING],headerSubtitle:[21,h.TYPES.STRING],xmaDataclass:[22,h.TYPES.STRING],contentRef:[23,h.TYPES.STRING],mentionedJid:[24,h.FLAGS.REPEATED|h.TYPES.STRING],commands:[25,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d.CommandSpec]};i.internalSpec={buttonType:[1,h.TYPES.ENUM,b],title:[2,h.TYPES.STRING],actionUrl:[3,h.TYPES.STRING],nativeUrl:[4,h.TYPES.STRING],ctaType:[5,h.TYPES.STRING],actionContentBlob:[6,h.TYPES.STRING]};g.EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH=a;g.EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE=b;g.EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE=c;g.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE=e;g.ExtendedContentMessageSpec=f;g.ExtendedContentMessage$CTASpec=i}),98);
__d("MAWXMAUtils",["MAWMsgType","WAArmadilloXMA.pb","WALogger","WATimeUtils","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Hit Unreachable XMAType "," - checking isXMAShare"]);h=function(){return a};return a}function a(a){return!a||a.type!==d("MAWMsgType").MSG_TYPE.XMA?null:a}function b(a){if(a==null)return!1;switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:return!0;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return c("qex")._("1711")===!0;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:return c("gkx")("6952");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return c("gkx")("5481");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:return!1;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:return!0;default:d("WALogger").ERROR(h(),a);return!1}}function e(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE}function f(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE}function i(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH}function j(a){return a==null?!1:a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE}function k(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY}function l(a,b){return a!=null&&a||b!=null&&b<d("WATimeUtils").unixTime()}function m(a){a=a.ctas;a!=null&&(a=a.filter(function(a){return a.buttonType!==d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE}));return a}function n(a){return babelHelpers["extends"]({},a,{ctas:void 0,defaultCTA:void 0,headerTitle:void 0,isTombstoned:!0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,overlayDescription:void 0,overlayIconGlyph:void 0,overlayTitle:void 0,subtitleText:void 0,targetId:void 0,targetUsername:void 0,titleText:void 0})}function o(a){return babelHelpers["extends"]({},a,{ctas:void 0,defaultCTA:void 0,defaultPreviewMediaId:void 0,faviconMediaId:void 0,headerMediaId:void 0,headerTitle:void 0,isTombstoned:!0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,overlayDescription:void 0,overlayIconGlyph:void 0,overlayTitle:void 0,previewMediaIds:void 0,subtitleText:void 0,targetId:void 0,targetUsername:void 0,titleText:void 0})}function p(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY}function q(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION}function r(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION?c("qex")._("1711")===!0:!1}function s(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:return!0;default:return!1}}function t(a){return r(a)||s(a)}function u(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE}function v(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE||a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE}function w(a){return a===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY&&c("gkx")("3587")}function x(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_VIDEO_CALL:return!0;default:return!1}}g.maybeXMAMessage=a;g.isXMAShare=b;g.isXMAStoryShare=e;g.isXMAExternalLinkShare=f;g.isReceiverFetchXMA=i;g.isIGXMAStoryShare=j;g.isXMAPostPrivateReply=k;g.isXMAExpired=l;g.removeCTAsForStoryMentionXMA=m;g.buildUnstoredTombstonedXMA=n;g.buildTombstonedDbXMA=o;g.isXMAStoryReply=p;g.isXMAStoryReaction=q;g.isFBXMAStoryMention=r;g.isIGXMAStoryMention=s;g.isXMAStoryMention=t;g.isIGXMAPostShare=u;g.isXMAStoryHighlightShare=v;g.isXMAMsgHighlightsTabFriendUpdatesReply=w;g.isRtcXMA=x}),98);
__d("WAHashUtils",["WABase64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WABase64").encodeB64UrlSafe(a,b)}function b(a,b){return d("WABase64").encodeB64UrlSafe(a,b)}function c(a){return a}function e(a){return a}function f(a){return""+a.slice(0,3)}g.toPlaintextHash=a;g.toCiphertextHash=b;g.stringToPlaintextHash=c;g.toHashedPlaintextHash=e;g.sanitisePlaintextHash=f}),98);
__d("getReplyContentForNoteReply",["WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a.author,e=a.msgId;c=d("WAJids").authorToUserId(c,b);b=(b=a.quote)==null?void 0:(a=b.content.msgContent)==null?void 0:a.content;return{isNoteReply:!0,replyMessageText:b,replySourceId:e,replyToUserId:c}}g["default"]=a}),98);
__d("MAWBridgeMsg",["LSHotEmojiSize","LSIntEnum","MAWDbMsg","MAWImageUtils","MAWMsgType","MAWUserJidWrapper","MAWVault","MAWXMAUtils","MWPBumpEntityKey","WAAssertUnreachable","WAHashUtils","WAJids","WALogger","WAMsgType","getReplyContentForNoteReply","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWBridgeMsg] Missing content for external link share XMA message"]);i=function(){return a};return a}function j(a,b,e){var f,g;f=((f=a.quote)==null?void 0:f.content.type)===d("WAMsgType").NOTE_REPLY;if(f)return c("getReplyContentForNoteReply")(a,e);f=(f=a.quote)==null?void 0:f.content;if(d("MAWXMAUtils").isXMAStoryShare(a.xmaMessageType)||d("MAWXMAUtils").isXMAStoryReaction(a.xmaMessageType)||d("MAWXMAUtils").isXMAStoryMention(a.xmaMessageType)||d("MAWXMAUtils").isXMAStoryHighlightShare(a.xmaMessageType)||d("MAWXMAUtils").isXMAMsgHighlightsTabFriendUpdatesReply(a.xmaMessageType)){var h=a.author,i=a.mediaId,j=a.msgId,k=d("WAJids").authorToUserId(h,e);if(d("MAWXMAUtils").isXMAStoryMention(a.xmaMessageType)){var l=a.threadJid,m;l!=null&&(m=d("WAJids").interpretAsUserJid(l));m!=null&&(k=d("WAJids").userIdFromJid(m))}i!=null&&a.plaintextHash==null&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.reply_attachment_media_missing_plaintext_hash","bridge_msg_get_reply_content");return{isFBStoryMention:d("MAWXMAUtils").isFBXMAStoryMention(a.xmaMessageType),isIGStoryMention:d("MAWXMAUtils").isIGXMAStoryMention(a.xmaMessageType),isIGXMAStoryShare:d("MAWXMAUtils").isIGXMAStoryShare(a.xmaMessageType),isMsgHighlightsTabFriendUpdatesReply:d("MAWXMAUtils").isXMAMsgHighlightsTabFriendUpdatesReply(a.xmaMessageType),isStoryHighlightShare:d("MAWXMAUtils").isXMAStoryHighlightShare(a.xmaMessageType),isStoryReaction:d("MAWXMAUtils").isXMAStoryReaction(a.xmaMessageType),isStoryReply:d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType),replyMediaId:i,replyMediaUrlMimeType:i!=null?"image/jpeg":void 0,replyPlaintextHash:(l=a.plaintextHash)!=null?l:void 0,replySenderIsMe:h===d("WAJids").AUTHOR_ME||k===e,replySourceId:j,replySourceTimestampMs:a.sortOrderMs,replyStatusType:i!=null?"Image":void 0,replyToUserId:k,storyShareAuthor:b==null?void 0:b.storyShareAuthor}}l=(f==null?void 0:f.type)===d("MAWMsgType").MSG_TYPE.XMA&&c("gkx")("458");if(f==null||(f==null?void 0:f.msgId)==null&&(f==null?void 0:f.sourceId)==null&&!l)return;h=f||{};j=h.author;i=h.mediaId;k=h.msgId;var n=h.plaintextHash,o=h.sourceId,p=h.specialTextSize,q=h.ts,r=h.type;h=h.xmaMessageType;q=q!=null?q*1e3:void 0;g=f.type===d("MAWMsgType").MSG_TYPE.TEXT||d("MAWXMAUtils").isXMAExternalLinkShare(h)?(g=f.msgContent)==null?void 0:g.content:void 0;var s=d("WAJids").authorToUserId(j,e);f=f.type===d("MAWMsgType").MSG_TYPE.TEXT?f.msgContent.mentionedJids:void 0;j=j===d("WAJids").AUTHOR_ME||s===e;e=b||{};b=e.replyMediaId;var t=e.replyMediaPreviewHeight,u=e.replyMediaPreviewWidth,v=e.replyMediaUrlFallback,w=e.replyMediaUrlMimeType,x=e.replyPlaintextHash;e=e.replyXMAId;if(d("MAWXMAUtils").isXMAStoryReply(h)){return{isStoryReaction:d("MAWXMAUtils").isXMAStoryReaction(h),isStoryReply:!0,replyMediaId:i,replyMediaUrlMimeType:i!=null?"image/jpeg":void 0,replyPlaintextHash:(n=x!=null?d("WAHashUtils").stringToPlaintextHash(x):n)!=null?n:void 0,replySenderIsMe:j,replySourceId:o,replySourceTimestampMs:q,replyStatusType:i!=null?"Image":void 0,replyToUserId:s}}n=d("MAWImageUtils").boundHeightWidth(t,u,96*.8);o=n.height;i=n.width;return{isIGXMAPostShare:d("MAWXMAUtils").isIGXMAPostShare(h),isIGXMAStoryShare:d("MAWXMAUtils").isIGXMAStoryShare(h),isStoryReply:!1,replyMediaId:b,replyMediaPreviewHeight:r===d("MAWMsgType").MSG_TYPE.STICKER?o:t,replyMediaPreviewWidth:r===d("MAWMsgType").MSG_TYPE.STICKER?i:u,replyMediaUrlFallback:v,replyMediaUrlMimeType:w,replyMentionedJids:f,replyMessageText:g,replyPlaintextHash:x!=null?d("WAHashUtils").stringToPlaintextHash(x):void 0,replySenderIsMe:j,replySourceId:l&&k==null?a.msgId:k,replySourceTimestampMs:q,replyStatusType:p===1||p===2||p===3?d("MAWMsgType").MSG_TYPE.STICKER:r,replyToUserId:s,replyXMAId:e}}function a(a){a=a.specialTextSize;switch(a){case 1:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").SMALL);case 2:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").MEDIUM);case 3:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").LARGE);default:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").NONE)}}function b(a,b,e,f,g){var h,k,l=d("WAJids").extractUserId(d("MAWUserJidWrapper").getMyUserJid());h=((h=a.isForwarded)!=null?h:!1)&&a.type!==d("MAWMsgType").MSG_TYPE.STICKER;k=(k=a.forwardingScore)!=null?k:0;var m=d("MAWDbMsg").getCanonicalTsFromMsg(a),n=j(a,e,l),o=d("MAWXMAUtils").isXMAStoryShare(a.xmaMessageType),p=d("MAWXMAUtils").isXMAStoryReaction(a.xmaMessageType),q=d("MAWXMAUtils").isXMAExternalLinkShare(a.xmaMessageType),r=d("MAWXMAUtils").isIGXMAStoryMention(a.xmaMessageType),s=d("MAWXMAUtils").isFBXMAStoryMention(a.xmaMessageType),t=d("MAWXMAUtils").isXMAStoryHighlightShare(a.xmaMessageType),u=d("MAWXMAUtils").isXMAPostPrivateReply(a.xmaMessageType),v=d("MAWXMAUtils").isXMAMsgHighlightsTabFriendUpdatesReply(a.xmaMessageType),w=d("MAWDbMsg").getSortOrderWithFallback(a),x=a.externalId,y=void 0;if(!c("justknobx")._("2996"))y=(e==null?void 0:e.replyPlaintextHash)!=null?d("WAHashUtils").stringToPlaintextHash(e==null?void 0:e.replyPlaintextHash):void 0;else{y=(e==null?void 0:e.replyPlaintextHash)!=null?d("WAHashUtils").stringToPlaintextHash(e==null?void 0:e.replyPlaintextHash):(e=n==null?void 0:n.replyPlaintextHash)!=null?e:void 0}switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:e=d("MAWVault").isVaulted(a.msgContent.content)?a.msgContent.content:d("MAWVault").vault(a.msgContent.content);return babelHelpers["extends"]({},n,{ack:a.ack,chatJid:a.threadJid,content:e,editCount:a.editCount,ephemeralDurationInSec:(e=a.ephemeralSetting)==null?void 0:e.ephemeralExpirationInSec,externalId:x,forwardingScore:k,instanceKey:g,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,mentionedJids:a.msgContent.mentionedJids,msgId:a.msgId,offlineMsg:b,replyPlaintextHash:y,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,specialTextSize:a.specialTextSize,transportKey:f,ts:m,type_:a.type});case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return babelHelpers["extends"]({},n,{ack:a.ack,chatJid:a.threadJid,ephemeralDurationInSec:(e=a.ephemeralSetting)==null?void 0:e.ephemeralExpirationInSec,externalId:x,forwardingScore:k,groupId:a.groupId,groupIndex:a.groupIndex,groupSize:a.groupSize,instanceKey:g,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,replyPlaintextHash:y,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type});case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:return babelHelpers["extends"]({},n,{ack:a.ack,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,replyPlaintextHash:y,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type,unsupportedType:a.msgContent.subtype});case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:return{ack:a.ack,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type};case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return babelHelpers["extends"]({},n,{ack:a.ack,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,replyPlaintextHash:y,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type});case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:return{ack:a.ack,adminContent:[a.msgContent.authorName],adminType:a.msgContent.adminType,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!0,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type};case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return{ack:a.ack,adminContent:a.msgContent.adminMsgContent.map(function(a){return a==="Facebook User"?"0":a}),adminType:a.msgContent.adminType,adminVersion:a.msgContent.version,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!0,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type};case d("MAWMsgType").MSG_TYPE.REVOKED:return{ack:a.ack,chatJid:a.threadJid,externalId:x,forwardingScore:k,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isForwarded:h,msgId:a.msgId,offlineMsg:b,originalTs:a.originalTs,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type};case d("MAWMsgType").MSG_TYPE.XMA:var z;e=(e=a.msgContent)==null?void 0:e.content;z=e!=null?d("MAWVault").isVaulted(e)?(z=a.msgContent)==null?void 0:z.content:d("MAWVault").vault(e):void 0;q&&z==null&&d("WALogger").WARN(i());e=c("justknobx")._("1191")||p||q?z:void 0;return babelHelpers["extends"]({},n,{ack:a.ack,chatJid:a.threadJid,content:e,ephemeralDurationInSec:(q=a.ephemeralSetting)==null?void 0:q.ephemeralExpirationInSec,externalId:x,forwardingScore:k,instanceKey:g,isAdminMessage:!1,isAuthorMe:a.author===d("WAJids").AUTHOR_ME,isExpiredXmaMsg:a.isExpiredXmaMsg,isFBStoryMention:s,isForwarded:h,isIGStoryMention:r,isMsgHighlightsTabFriendUpdatesReply:v,isPostPrivateReply:u,isStoryHighlightShare:t,isStoryReaction:p,isStoryShare:o,mentionedJids:(z=a.msgContent)==null?void 0:z.mentionedJids,msgId:a.msgId,offlineMsg:b,replyPlaintextHash:y,sender:d("WAJids").authorToUserId(a.author,l),sortOrderMs:w,transportKey:f,ts:m,type_:a.type,xmaMessageType:a.xmaMessageType});default:return c("WAAssertUnreachable")(a.type)}}g.getSpecialTextSize=a;g.createBridgeMsg=b}),98);
__d("MAWBridgeTrace",["WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f,g,h,i){var j=a.ack,k=a.externalId,l=a.ts;a=a.type;var m=d("WAJids").switchOnMsgrChatJidType(b,{group:function(a){return"Group"},user:function(a){return"User"}});return{ack:j,externalId:k,isFirstMsg:!!f,openMessageOtid:e,openMessageParticipantCount:g,participantCount:h,threadJid:b,threadKey:i,threadType:m,traceType:c,ts:l,type_:a}}function b(a,b,c){return{traceContext:c,traceId:b,traceType:a}}function c(a,b,c,d){return{errorMessage:d,event:b,externalIds:a,traceType:c}}function e(a,b,c,d,e,f){return{checkPointId:a,dataTraceId:b,errorMessage:c,shouldFlush:d,syncChannel:e,tags:f}}g.createBridgeStartTraceData=a;g.createBridgeStartTraceWithTraceIdData=b;g.createBridgeUpdateTraceData=c;g.createBridgeTraceRecordCheckpointData=e}),98);
__d("MAWBridgeUIEventDataValidation",["FBLogger","I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){try{return(h||(h=d("I64"))).of_string(a)}catch(b){c("FBLogger")("maw_bridge").catching(b).mustfix("Cannot convert string to i64: %s",a)}}g.stringToI64Opt=a}),98);
__d("MAWDbReaction",["I64","MAWAckLevel","MAWUserJidWrapper","WAJids","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=d("MAWUserJidWrapper").getMyUserJid();if(a.reactToAuthor!=="@me"&&a.reactToAuthor!==b||a.reaction==null)return null;b=a.author==="@me"||a.author==="@system"?null:a.author;return b==null?null:babelHelpers["extends"]({},a,{author:b,reaction:a.reaction,reactToAuthor:"@me"})}function b(a,b,c){var e=d("MAWUserJidWrapper").getMyUserJid();return a.find(function(a){return a.threadJid===b&&d("WAJids").authorToUserId(a.author,e)===d("WAJids").authorToUserId(c,e)})}function c(a){return a}function e(a,b,c,e,f,g,h,i,j,k,l,m,n){m===void 0&&(m=d("MAWAckLevel").ACK.clock);m={ack:m,author:k,externalId:b,groupingKey:g,reaction:f,reactionId:c,reactToAuthor:h,reactToExternalId:e,reactToMsgId:i,senderTimestampMs:n,threadJid:a,ts:j};return l!=null?babelHelpers["extends"]({},m,{rowId:l}):m}function f(a){return a.senderTimestampMs!=null?d("WATimeUtils").castLongIntToMillisTime(a.senderTimestampMs):d("WATimeUtils").castUnixTimeToMillisTime(a.ts)}function i(a){if(a.senderTimestampMs!=null)return(h||(h=d("I64"))).of_string(d("WALongInt").longIntToDecimalString(a.senderTimestampMs));else return(h||(h=d("I64"))).mul(h.of_int32(a.ts),h.of_int32(1e3))}g.castToIncomingDbReaction=a;g.findMatchingReaction=b;g.reactionIdToMsgId=c;g.formatReactionForDb=e;g.getReactionTimeMs=f;g.getSenderTimestampWithFallback=i}),98);
__d("MAWExtractMsFromExternalId",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return new Date(a).getTime()>0}var j=2199023255551;function a(a){a=Number((h||(h=d("I64"))).to_string(h.and_(h.lsr_(a,22),h.of_float(j))));if(i(a)){a=Math.floor(Number(a)%1e5/100);return a}}g.extractMsFromExternalId=a}),98);
__d("MAWCalculateBumpTimestampMs",["I64","MAWDbReaction","MAWExtractMsFromExternalId","MAWTimeUtils","WATimeUtils","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){b=b==null?null:d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);return(h||(h=d("I64"))).add(d("MAWTimeUtils").millisTimeToTimestamp(a),h.of_int32((a=b)!=null?a:0))}function a(a){var b=a.msg;a=a.throwIfNoServerTs;a=a?c("nullthrows")(b.serverTs):b.serverTs;return i(d("WATimeUtils").castUnixTimeToMillisTime((a=a)!=null?a:b.ts),(h||(h=d("I64"))).of_string(b.externalId))}function b(a){return i(d("MAWDbReaction").getReactionTimeMs(a),(h||(h=d("I64"))).of_string(a.externalId))}g.calculateBumpTimestampMs=i;g.calculateBumpTimestampMsForMsg=a;g.calculateBumpTimestampMsForReaction=b}),98);
__d("WADbContact",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;f.NON_CONTACT=a;f.ONE_WAY_CONTACT=b;f.REVERSED_ONE_WAY_CONTACT=c;f.TWO_WAY_CONTACT=d}),66);
__d("MAWContactRelationshipType",["I64","LSContactBitOffset","WADbContact"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=d("LSContactBitOffset").hasWithDefault(64,a,!0);a=(h||(h=d("I64"))).ge(a.contactViewerRelationship,h.of_string("2"));if(a&&b)return d("WADbContact").ONE_WAY_CONTACT;else if(!a&&!b)return d("WADbContact").REVERSED_ONE_WAY_CONTACT;else if(a&&!b)return d("WADbContact").TWO_WAY_CONTACT;return d("WADbContact").NON_CONTACT}g.getContactRelationshipType=a}),98);
__d("MAWDbMedia",["I64","WAMediaUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i="Image",j="Video",k="Ptt",l="Gif",m="Sticker",n="DocumentFile",o={DOCUMENT_FILE:n,GIF:l,IMAGE:i,PTT:k,STICKER:m,VIDEO:j};function a(a){return a}function b(a){return a}function c(a){return(h||(h=d("I64"))).of_float(a)}function e(a){return(h||(h=d("I64"))).to_float(a)}function f(a,b){a=a.mediaEntries.get(b);if(a==null)return d("WAResultOrError").makeError("missing-media-entry");b=d("WAMediaUtils").decodeMediaEntryData(a);a=b.serverMediaType;return a==null?d("WAResultOrError").makeError("missing-server-media-type"):d("WAResultOrError").makeResult(a)}g.IMAGE=i;g.VIDEO=j;g.PTT=k;g.GIF=l;g.STICKER=m;g.DOCUMENT_FILE=n;g.MEDIA_TYPE=o;g.convertNumberToMediaId=a;g.convertToMediaId64=b;g.convertMediaIdToMediaId64=c;g.convertMediaId64ToMediaId=e;g.getServerMediaType=f}),98);
__d("MAWLowLevelApiTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a={EXISTING_GROUP_INVITE:"existing_group_invite",MISSING_GROUP:"missing_group"};c={EXPIRED_GROUP_INVITE:"expired_group_invite",MISSING_GROUP:"missing_group",MISSING_GROUP_INVITE:"missing_group_invite"};d=b("$InternalEnum")({Initializing:"initializing",Open:"open",Closed:"closed",Error:"error",Upgrading:"upgrading"});f.WRITE_GROUP_INVITE_ERROR=a;f.GET_GROUP_INVITE_ERROR=c;f.DatabaseState=d}),66);
__d("MAWGetWorkerStatusApi",["MAWLowLevelApiTypes","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Worker Status: ",""]);h=function(){return a};return a}var i=d("WATagsLogger").TAGS(["WorkerStatus"]),j="initializing",k="disconnected",l={},m=[];function n(){var a=d("WAResultOrError").makeResult({comms:k,databases:l,startup:j});i.LOG(h(),JSON.stringify(a));if(j!=="success")return d("WAResultOrError").makeError("worker_startup_"+j);if(k==="disconnected")return d("WAResultOrError").makeError("comms_disconnected");var b=Object.values(l).some(function(a){a=a.status;return a===d("MAWLowLevelApiTypes").DatabaseState.Error||a===d("MAWLowLevelApiTypes").DatabaseState.Closed});if(b)return d("WAResultOrError").makeError("database_failure");b=Object.values(l).some(function(a){a=a.status;return a===d("MAWLowLevelApiTypes").DatabaseState.Upgrading});return b?d("WAResultOrError").makeError("database_upgrading"):a}function o(){var a=n();m.forEach(function(b){return b(a)})}function a(a){m.push(a);var b=n();a(b)}function b(a){k=a,o()}function c(a){j=a,o()}function e(a,b){l[a]=babelHelpers["extends"]({},l[a],{status:b}),o()}function f(a,b){l[a]=babelHelpers["extends"]({},l[a],{api:b}),o()}function p(a){return l[a]}g.getWorkerStatus=n;g.onWorkerStateChange=a;g.setCommsStatus=b;g.updateWorkerStatus=c;g.setDatabaseStatus=e;g.setDatabaseApi=f;g.getDatabaseMetadata=p}),98);
__d("MAWIndexedDbMetadata",[],(function(a,b,c,d,e,f){"use strict";var g="v1",h="v1",i="v1",j="v1",k="v1",l="v1",m="messenger_web_"+g,n="messenger_web_v3",o="messenger_web_encryption_"+h,p="messenger_web_signal_"+i,q="messenger_web_signal_v3",r="messenger_web_log_"+j,s="messenger_web_eb_lsdb_"+k,t="messenger_web_fts_"+l;function a(a){return m+"_"+a}function b(a){return t+"_"+a}function c(a){return n+"_"+a}function d(a){return o+"_"+a}function e(a){return p+"_"+a}function u(a){return q+"_"+a}function v(a){return r+"_"+a}function w(a){return s+"_"+a}f.dbName=a;f.ftsDbName=b;f.restoreDbName2=c;f.encryptionDbName=d;f.jobsDbName=e;f.signalWorm=u;f.logDbName=v;f.ebLSDBName=w}),66);
__d("MAWRestoreDbState",["Deferred","FBLogger","MAWCurrentUser","MAWGetWorkerStatusApi","MAWIndexedDbMetadata","MWLSIndexedDBName","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=!1,j=new(c("Deferred"))();function a(){j.isSettled()||c("FBLogger")("messenger_e2ee_web").mustfix("isUsingShim called before db initted");return i}function b(){return!j.isSettled()?void 0:i}function e(){return j.getPromise().then(function(){return i})}function k(){var a=d("MAWCurrentUser").getID();a=c("qex")._("1210")?d("MWLSIndexedDBName").dbName():d("MAWIndexedDbMetadata").restoreDbName2(a);d("MAWGetWorkerStatusApi").setDatabaseApi(a,"shim")}function f(a){i=a,k(),j.resolve()}function l(a){if(!c("gkx")("1159"))return;if(a==null){h=null;return}h=a}function m(){return!c("gkx")("1159")?null:h}g.isUsingShim_UNSAFE=a;g.isUsingShim_LOGGING_ONLY=b;g.isUsingShim=e;g.setIsUsingShim=f;g.setTargetDbState=l;g.getTargetDbState=m}),98);
__d("MAWQplProxy",["ExecutionEnvironment","MAWBridge","MAWRestoreDbState","MAWSendQplToServer","QPLEvent","asyncToGeneratorRuntime","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h=c("gkx")("23949"))!=null?h:!1,l=new Set([25313175,25310776,1056839232,1056840931,521485625,521480745,521478596,521479468,521485815,521476165,521480391]),m=0;function n(){return Date.now()}function o(a,b,c,e){var f;e===void 0&&(e=!0);f=(f=c==null?void 0:c.timestamp)!=null?f:n();d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{name:b,type:"point"},annotations:c==null?void 0:c.annotations,event:a,instanceKey:c==null?void 0:c.instanceKey,timestamp:e?f:void 0},!0)}function a(a,b,c,e){var f;d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"annotations"},annotations:{bool:(f={},f[b]=c,f)},event:a,instanceKey:e},!0)}function e(a,b,c,e){var f;d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"annotations"},annotations:{string:(f={},f[b]=c,f)},event:a,instanceKey:e},!0)}function f(a,b,c,e){var f;d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"annotations"},annotations:{"int":(f={},f[b]=c,f)},event:a,instanceKey:e},!0)}function p(a,b,c){d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"annotations"},annotations:{"double":b},event:a,instanceKey:c},!0)}function q(a,b,c){d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"annotations"},annotations:b,event:a,instanceKey:c},!0)}function r(a,b,c,e){var f=n();d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{name:b,type:"failure"},annotations:c,event:a,instanceKey:e,timestamp:f},!0)}function s(a,b,c,e){e===void 0&&(e=!0);var f=n();d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"success"},annotations:b,event:a,instanceKey:c,timestamp:e?f:void 0},!0)}function t(a,b,c){var e=n();d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"cancel"},annotations:b,event:a,instanceKey:c,timestamp:e},!0)}function u(a,b,c){d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{name:b,type:"error"},debugInfo:c==null?void 0:c.debugInfo,error:c==null?void 0:c.error,event:a,instanceKey:c==null?void 0:c.instanceKey},!0)}function v(a,b,c,d,e){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e){o(a,b+"_start",{annotations:d,instanceKey:e});d=(yield c());o(a,b+"_end",{instanceKey:e});return d});return w.apply(this,arguments)}function x(a,b,e,f,g){g===void 0&&(g=!0);e==null&&m++;var h=(e=e)!=null?e:m;f=(e=f)!=null?e:c("justknobx")._("2596");if(!(j||(j=c("ExecutionEnvironment"))).isInWorker||!y(a))return d("MAWSendQplToServer").startQplUserFlow(a,b,h,f);e=n();d("MAWBridge").getBridge().fireAndForget("event","qplEvent",{action:{type:"start"},annotations:b!=null?babelHelpers["extends"]({},b,{bool:babelHelpers["extends"]({},b.bool,{isUsingShim:d("MAWRestoreDbState").isUsingShim_LOGGING_ONLY()})}):{bool:{isUsingShim:d("MAWRestoreDbState").isUsingShim_LOGGING_ONLY()}},event:a,instanceKey:h,timeoutInMs:f,timestamp:g?e:void 0},!0);return{addAnnotations:function(b){return q(a,b,h)},addPoint:function(b,c){return o(a,b,{annotations:c,instanceKey:h})},endCancel:function(b){return t(a,b,h)},endFail:function(b,c){return r(a,b,c,h)},endSuccess:function(b){return s(a,b,h)},markError:function(b,c,d){return u(a,b,{debugInfo:c,error:d,instanceKey:h})},startTime:e}}function y(a){return k||l.has((i||(i=d("QPLEvent"))).getMarkerId(a))}g.performanceAbsoluteNow=n;g.sendQplPointThroughBridge=o;g.sendQPLBoolAnnotationThroughBridge=a;g.sendQPLStringAnnotationThroughBridge=e;g.sendQPLIntAnnotationThroughBridge=f;g.sendQPLDoubleAnnotationsThroughBridge=p;g.sendQPLAnnotationsThroughBridge=q;g.sendQPLFailThroughBridge=r;g.sendQPLSuccessThroughBridge=s;g.sendQPLCancelThroughBridge=t;g.sendQPLErrorThroughBridge=u;g.measurePerfInQPL=v;g.startQplUserFlow=x}),98);
__d("MAWSendQplToServer",["ExecutionEnvironment","MAWEBSwitch","MAWQplProxy","MAWRestoreDbState","QPLUserFlow","WAExceededStorageQuota","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f){var g=d("MAWQplProxy").performanceAbsoluteNow();c("QPLUserFlow").start(a,{annotations:babelHelpers["extends"]({},b||{},{bool:babelHelpers["extends"]({},(b==null?void 0:b.bool)||{},{is_eb_enabled:c("MAWEBSwitch").isEnabled(),isDev:0,isFromUIThread:(h||(h=c("ExecutionEnvironment"))).isInMainThread,isGifSearchEnbled:!0,isUsingShim:d("MAWRestoreDbState").isUsingShim_LOGGING_ONLY(),processAcksInOneQueue:c("gkx")("23955"),signalOnWorm:c("gkx")("6294"),useSharedWorker:"SharedWorkerGlobalScope"in self&&self instanceof self.SharedWorkerGlobalScope})}),instanceKey:e,timeoutInMs:f,timestamp:g});return{addAnnotations:function(b){c("QPLUserFlow").addAnnotations(a,b,{instanceKey:e})},addPoint:function(b,f){var g=d("MAWQplProxy").performanceAbsoluteNow();f&&c("QPLUserFlow").addAnnotations(a,f,{instanceKey:e});c("QPLUserFlow").addPoint(a,b,{instanceKey:e,timestamp:g})},endCancel:function(b){var f,g=d("MAWQplProxy").performanceAbsoluteNow();c("QPLUserFlow").addAnnotations(a,babelHelpers["extends"]({},b,{bool:babelHelpers["extends"]({},b==null?void 0:b.bool,{exceededStorageQuota:d("WAExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}),string:babelHelpers["extends"]({},b==null?void 0:b.string,{threadID:b==null?void 0:(f=b.string)==null?void 0:f.jid})}),{instanceKey:e});c("QPLUserFlow").endCancel(a,{annotations:b,instanceKey:e,timestamp:g})},endFail:function(b,f){var g,h=d("MAWQplProxy").performanceAbsoluteNow();c("QPLUserFlow").addAnnotations(a,babelHelpers["extends"]({},f,{bool:babelHelpers["extends"]({},f==null?void 0:f.bool,{exceededStorageQuota:d("WAExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}),string:babelHelpers["extends"]({},f==null?void 0:f.string,{threadID:f==null?void 0:(g=f.string)==null?void 0:g.jid})}),{instanceKey:e});c("QPLUserFlow").endFailure(a,b,{annotations:f,instanceKey:e,timestamp:h})},endSuccess:function(b){var f=d("MAWQplProxy").performanceAbsoluteNow();c("QPLUserFlow").addAnnotations(a,{bool:{exceededStorageQuota:d("WAExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}},{instanceKey:e});c("QPLUserFlow").endSuccess(a,{annotations:b,instanceKey:e,timestamp:f})},markError:function(b,d,f){return c("QPLUserFlow").markError(a,b,{debugInfo:d,error:f,instanceKey:e})},startTime:g}}g.startQplUserFlow=a}),98);
__d("MWEBODSEntityName.enum",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({MW_EB_PIN_RESTORE_AUTH:"mw_eb_pin_restore_auth",MW_EB_RC_RESTORE_AUTH:"mw_eb_rc_restore_auth",MW_EB_AUTO_RESTORE_AUTH:"mw_eb_auto_restore_auth",MW_EB_OTC_AUTH:"mw_eb_otc_auth",MW_EB_ONBOARDING_AUTH:"mw_eb_onboarding_auth",MW_EBSM_HYDRATION:"mw_ebsm_hydration",MW_EBSM_IDB:"mw_eb_ebsm_idb",MAW_EB_UPLOAD_TRACKING:"maw_eb_upload_tracking",MAW_EB_UPLOAD_COUNTER:"maw_eb_upload_counter",MAW_EB_RESTORE_COUNTER:"maw_eb_restore_counter",MAW_EB_RESTORE_QUEUE:"maw_eb_restore_queue"});c=a;f["default"]=c}),66);
__d("MAWEBRestoreTrackingUtils",["LSIntEnum","LSMEBTaskCreationSource","MAWQplProxy","MWEBODSEntityName.enum","ODS","QPLUserFlow","WAHashStringToNumber","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,e){b!=null&&p({querySource:e,taskSource:a,traceId:b,triggerType:"paginated"}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.paginated")}function b(a){var b=a.querySource,e=a.taskSource;a=a.traceId;a!=null&&p({querySource:b,taskSource:e,traceId:a,triggerType:"initial"});(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.initial")}function e(a,b){b!=null&&p({querySource:"LS",taskSource:a,traceId:b,triggerType:"dyi"}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.dyi")}function f(a,b){b!=null&&p({querySource:"LS",taskSource:a,traceId:b,triggerType:"frontloaded"}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.frontloaded")}function j(a,b,e){b!=null&&p({querySource:e,taskSource:a,traceId:b,triggerType:"point"}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.point")}function k(a){var b=a.querySource;a=a.traceId;a!=null&&p({querySource:b,taskSource:c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB,traceId:a,triggerType:"search"});(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.request.search")}function l(a){a!=null&&c("QPLUserFlow").endSuccess(c("qpl")._(521476165,"2432"),{instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.decryption.success")}function m(a){a!=null&&c("QPLUserFlow").endFailure(c("qpl")._(521476165,"2432"),"restore_failure",{instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore.decryption.failure")}function n(a){t("echo",a)}function o(a){t("protobuf",a)}function p(a){var b=a.querySource,e=a.taskSource,f=a.traceId;a=a.triggerType;c("QPLUserFlow").start(c("qpl")._(521476165,"2432"),{annotations:{string:{querySource:b,taskSource:u(e),traceId:f,triggerType:a}},instanceKey:d("WAHashStringToNumber").hashStringToNumber(f),timeoutInMs:c("justknobx")._("2950")})}function q(a){var b=a.pointName,e=a.traceId;a=a.type;c("QPLUserFlow").addAnnotations(c("qpl")._(521476165,"2432"),{string:{type:a}},{instanceKey:d("WAHashStringToNumber").hashStringToNumber(e)});c("QPLUserFlow").addPoint(c("qpl")._(521476165,"2432"),b,{instanceKey:d("WAHashStringToNumber").hashStringToNumber(e)})}function r(a){var b=a.annotations,e=a.pointName;a=a.traceId;a!=null&&d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521476165,"2432"),e,{annotations:b,instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)})}function s(a){var b=a.pointName;a=a.traceId;d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(521476165,"2432"),b,{instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)})}function t(a,b){b=b?(i||(i=d("LSIntEnum"))).unwrapIntEnum(b):null;(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore."+a+"."+u(b))}function u(a){return(a=a==null?void 0:a.toString())!=null?a:"unknown"}g.markEBRestorePaginated=a;g.markEBRestoreInitial=b;g.markEBRestoreDYI=e;g.markEBRestoreFrontloaded=f;g.markEBRestorePoint=j;g.markEBRestoreSearch=k;g.markEBRestoreSuccess=l;g.markEBRestoreFail=m;g.markEBRestoreEcho=n;g.markEBRestoreProtobuf=o;g.addQPLRestorePoint=q;g.addQPLRestorePointWithAnnotationsWorker=r;g.addQPLRestorePointWorker=s}),98);
__d("WAGetHashFromProtocolMsgId",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.externalId+"_"+a.author+"_"+a.chat}f.getHashFromProtocolMsgId=a}),66);
__d("MAWEBUploadTrackingUtils",["MAWAckLevel","MAWEBSwitch","MAWExternalId","MAWMsgType","MAWQplProxy","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","ODS","QPLUserFlow","WAExceededStorageQuota","WAGetHashFromProtocolMsgId","WAGlobals","WAHashStringToNumber","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i="20240712";function a(a,b,e,f,g){g===void 0&&(g=!1);if(!c("MAWEBSwitch").isEnabled()){l(a);return}c("QPLUserFlow").start(c("qpl")._(521481602,"829"),{annotations:{bool:{eb_switch:c("MAWEBSwitch").isEnabled(),eb_upload_queue:!0,fromUploadQueue:g,middleware_init:!1},string:{externalId:a,msgType:b,triggerType:e,versionDate:i}},instanceKey:f,timeoutInMs:c("justknobx")._("1405")});m(f,"upload_tracking_started");(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,c("MWEBODSEntityKey.enum").START)}var j=new Map();function k(a,b,c){j.set(a,{instanceKey:b,msgType:c})}function l(a){return j["delete"](a)}function b(a){var b=j.get(a);l(a);return b}function e(){return new Map(j)}function f(a,b,c,d){switch(a){case"success":o(b,c);break;case"fail":n(b,c,d);break;case"point":m(b,c,d);break}}function m(a,b,e){var f=d("MAWQplProxy").performanceAbsoluteNow();e&&c("QPLUserFlow").addAnnotations(c("qpl")._(521481602,"829"),e,{instanceKey:a});c("QPLUserFlow").addPoint(c("qpl")._(521481602,"829"),b,{instanceKey:a,timestamp:f})}function n(a,b,e){c("QPLUserFlow").endFailure(c("qpl")._(521481602,"829"),b,{annotations:babelHelpers["extends"]({},e,{bool:babelHelpers["extends"]({},e==null?void 0:e.bool,{exceededStorageQuota:d("WAExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}),string:babelHelpers["extends"]({},e==null?void 0:e.string,{threadID:e==null?void 0:(b=e.string)==null?void 0:b.jid})}),instanceKey:a,timestamp:d("MAWQplProxy").performanceAbsoluteNow()});(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,c("MWEBODSEntityKey.enum").FAIL)}function o(a,b,e){m(a,b),c("QPLUserFlow").endSuccess(c("qpl")._(521481602,"829"),{annotations:babelHelpers["extends"]({},e,{bool:{exceededStorageQuota:d("WAExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}}),instanceKey:a,timestamp:d("MAWQplProxy").performanceAbsoluteNow()}),(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,c("MWEBODSEntityKey.enum").SUCCESS)}function p(){return d("WAHashStringToNumber").hashStringToNumber(d("MAWExternalId").generateExternalId())}function q(a,b){b===void 0&&(b=0);return d("WAHashStringToNumber").hashStringToNumber(d("WAGetHashFromProtocolMsgId").getHashFromProtocolMsgId(a)+"_"+d("WAGlobals").getMyDeviceJid()+"_"+b)}function r(a,b){if(!c("MAWEBSwitch").isEnabled())return;var d=q(a);k(a.externalId,d,b)}function s(a){return c("MAWEBSwitch").isEnabled()&&d("MAWMsgType").isEBSupportedMsgType(a.type)&&a.ack>=d("MAWAckLevel").ACK.sent&&a.serverTs!=null&&!(a.ephemeralSetting!=null&&a.ephemeralSetting.ephemeralExpirationInSec>0)}g.startUploadTracking=a;g.removeExternalIdFromUploadQueueStartedCache=l;g.getAndRemoveFromUploadQueueStartedCache=b;g.getUploadQueueStartedCache=e;g.handleBridgeEbUploadTrackingQPL=f;g.addPointWorkerOnly=m;g.endFailWorkerOnly=n;g.endSuccessWorkerOnly=o;g.genInstanceKeyOnly=p;g.genInstanceKeyForUploadQueue=q;g.addExternalIdToCache=r;g.isUploadSupported=s}),98);
__d("MAWIndexedDBDeletion",["CurrentMessengerUser","FBLogger","MAWIndexedDbMetadata","Promise","asyncToGeneratorRuntime","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,d){return indexedDB==null||a==null?(h||(h=b("Promise"))).resolve():new(h||(h=b("Promise")))(function(b,e){var f=indexedDB.deleteDatabase(a);f.onsuccess=function(){c("FBLogger")("maw_db").warn("%s db was deleted",d),b()};f.onblocked=function(){c("recoverableViolation")("Cannot delete "+d+" db: blocked. Make sure DB is closed.","maw_db")};f.onerror=function(){c("recoverableViolation")("Cannot delete "+d+" db","maw_db"),e(f.error)}})}function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("CurrentMessengerUser").getID();yield (h||(h=b("Promise"))).all([i(d("MAWIndexedDbMetadata").dbName(a),"maw_v1"),i(d("MAWIndexedDbMetadata").restoreDbName2(a),"maw_v3"),i(d("MAWIndexedDbMetadata").jobsDbName(a),"signal"),i(d("MAWIndexedDbMetadata").logDbName(a),"logDb")])});return j.apply(this,arguments)}g.deleteDB=i;g.deleteMAWPersistence=a}),98);
__d("WAWorkerGlobalScope",[],(function(a,b,c,d,e,f){"use strict";a=function(){if(typeof window!=="undefined")return window;return typeof globalThis!=="undefined"?globalThis:self}();f.workerGlobalScope=a}),66);
__d("MAWEncryptionIndexedDbV2",["BrowserLockManager","EARInitType","ExecutionEnvironment","FBLogger","IndexedDbPolyfills","MAWCurrentUser","MAWIndexedDBDeletion","MAWIndexedDbMetadata","MAWQplProxy","Promise","QPLUserFlow","WALogger","WAWorkerGlobalScope","err","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Armadillo Web Remote Presence] MAW RP Initialising EAR"]);j=function(){return a};return a}b("IndexedDbPolyfills");var k="browserEncryptionMetaV2",l="version",m=1,n=null,o=null,p=null;function a(){return n}function e(){return n!=null}var q=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(babelHelpers.wrapNativeSuper(Error));function r(a,e){e===void 0&&(e=0);var f=d("MAWCurrentUser").getID(),g=c("gkx")("1030");if(e>m){u(a,"ear_idb_retry_failed_max_reached");return(i||(i=b("Promise"))).reject(new q())}if(n!=null){u(a,"ear_db_exists");return(i||(i=b("Promise"))).resolve()}if(indexedDB==null){u(a,"ear_idb_unavailable");return(i||(i=b("Promise"))).reject(c("err")("IndexedDB API not available"))}u(a,"ear_db_open_start",{bool:{browserLockEnabled:c("BrowserLockManager")!=null}});return new(i||(i=b("Promise")))(function(b,i){var j=function(c){r(a,e+1).then(b)["catch"](function(a){if(a instanceof q)return i(c);i(a)})};try{p=d("MAWIndexedDbMetadata").encryptionDbName(f);var m=indexedDB.open(p),s=d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){i(c("err")("IndexedDB initialisation timeout in %s flow, isInWorker: %s, openRequest: %s",String(a),(h||(h=c("ExecutionEnvironment"))).isInWorker?"true":"false",m.readyState))},g?6e4:1e4);m.onupgradeneeded=function(b){d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(s);u(a,"ear_db_upgrade_start");b=b.target.result;if(!b.objectStoreNames.contains(k)){b=b.createObjectStore(k,{autoIncrement:!0,keyPath:"id"});b.createIndex(l,l,{unique:!0})}u(a,"ear_db_upgrade_end")};m.onblocked=function(){u(a,"ear_db_open_blocked"),d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){i(c("err")("EAR Open timed out while blocked"))},2e3)};m.onsuccess=function(e){d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(s);var f=e.target.result;if(!f.objectStoreNames.contains(k)){d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(s);f.close();if(p==null){u(a,"ear_idb_retry_failed_missing_db");return i(c("err")("Attempting to delete encryption DB but _dbName is null"))}var g=indexedDB.deleteDatabase(p);g.onerror=function(){u(a,"ear_idb_retry_failed_delete_failed");return i(c("err")("Failed to delete malformed encryption DB: "+g.error.message))};g.onsuccess=function(){j(c("err")("Malformed encryption DB"))};return}f.onversionchange=function(){f.close(),c("FBLogger")("messenger_e2ee_web").info("EAR onversionchange triggered"),d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(s),o==null?void 0:o()};u(a,"ear_db_open_end");n=f;b()};m.onerror=function(){d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(s);if(m.error.name==="UnknownError"&&g){u(a,"ear_db_open_error_unknown_error");return j(m.error)}u(a,"ear_db_open_error");i(m.error)}}catch(b){u(a,"ear_db_error"),i(b)}})}function f(a){o=o==null?a:o}function s(){n!=null&&n.close();return d("MAWIndexedDBDeletion").deleteDB(p,"ear")}function t(a){switch(a){case c("EARInitType").EB_INIT:return c("qpl")._(521477507,"1406");case c("EARInitType").MAW_INIT:return c("qpl")._(25310776,"6155");case c("EARInitType").MAW_RP_INIT:d("WALogger").DEV(j());return c("qpl")._(25310776,"6155");case c("EARInitType").LS_INIT:return c("qpl")._(25305590,"1127");case c("EARInitType").MAW_IN_UI_INIT:return null}}function u(a,b,e){a=t(a);if(a==null)return;(h||(h=c("ExecutionEnvironment"))).isInWorker?d("MAWQplProxy").sendQplPointThroughBridge(a,"worker_"+b,{annotations:e}):(c("QPLUserFlow").addPoint(a,b),e!=null&&c("QPLUserFlow").addAnnotations(a,e))}g.storeName=k;g.ENCRYPTION_MAW_STORES_INDEX=l;g.getEncryptionDB=a;g.isEncryptionDBInited=e;g.makeEncryptionDB=r;g.maybeSetEncryptionDbOnVersionChange=f;g.deleteEncryptionDB=s}),98);
__d("MAWEphemeralConsts",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=300;b=600;c=900;e=1800;d=Math.imul((f=d("WATimeUtils")).HOUR_SECONDS,6);var h=Math.imul(f.HOUR_SECONDS,12),i=Math.imul(f.DAY_SECONDS,14),j=1e3,k=5,l=10,m=30,n=60,o=d;g.fiveMinutesInSeconds=a;g.tenMinutesInSeconds=b;g.fifteenMinutesInSeconds=c;g.thirtyMinutesInSeconds=e;g.oneHourInSeconds=f.HOUR_SECONDS;g.sixHoursInSeconds=d;g.twelveHoursInSeconds=h;g.oneDayInSeconds=f.DAY_SECONDS;g.ephemeralMaxDelectionWindowForUnseenMessage=i;g.msPerSec=j;g.fiveSeconds=k;g.tenSeconds=l;g.thirtySeconds=m;g.oneMinuteInSeconds=n;g.ephemeralReportingWindowInSeconds=o}),98);
__d("MAWErrorObject",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a instanceof Error)return a;else if(typeof a==="string")return c("err")(a);else return null}g.getErrorObject=a}),98);
__d("MAWFolderTypes",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;e=10;var g={ARCHIVED:e,INBOX:a,OTHER:c,PENDING:b,SPAM:d};f.INBOX=a;f.PENDING=b;f.OTHER=c;f.SPAM=d;f.ARCHIVED=e;f.FOLDER_ID=g}),66);
__d("MAWFrontendMediaUtils",["MAWDbMedia"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){if(a==="image/gif")return{mediaType:d("MAWDbMedia").MEDIA_TYPE.GIF,serverMediaType:"gif"};if(a==="image/webp"&&b!==!0)return{mediaType:d("MAWDbMedia").MEDIA_TYPE.STICKER,serverMediaType:"sticker"};c=(c=c)!=null?c:a.split("/")[0];switch(c){case"image":if(b===!0)return{mediaType:d("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"xma-image"};else return{mediaType:d("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"image"};case"video":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.VIDEO,serverMediaType:"video"};case"audio":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.PTT,serverMediaType:"ptt"};case"application":default:return{mediaType:d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE,serverMediaType:"document"}}}g.getMediaTypeAndServerMediaTypeFromBlob=a}),98);
__d("MAWGetIsMediaDownloadStatusEnabled",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("1615")===!0}g.getIsMediaDownloadStatusEnabled=a}),98);
__d("MAWTransactionMode",[],(function(a,b,c,d,e,f){"use strict";a="r";b="rw";f.READONLY=a;f.READWRITE=b}),66);
__d("MAWJobActionsV2",["MAWTransactionMode","Promise","WAHex","WALRUMap","WATimeUtils","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return new(h||(h=b("Promise")))(function(b,c){a.onsuccess=b,a.onerror=c})}function j(a){return i(a).then(function(a){return a.target.result})}function k(a,c,e){return new(h||(h=b("Promise")))(function(b,f){var g=a(d("MAWTransactionMode").READONLY).index(c);g=g.openCursor(IDBKeyRange.only(e));var h=[];g.onsuccess=function(a){a=a.target.result;if(!a){b(h);return}h.push(a.value);a["continue"]()};g.onerror=function(a){return f(a)}})}var l=new(d("WALRUMap").LRUMap)({max:100});function a(a,c){var e,f=c.args,g=c.scheduleConfig,i=c.type,l=c.uniqKey;c=c.version;c=c===void 0?1:c;e=JSON.stringify([i,(e=l)!=null?e:d("WAHex").randomHex(32)]);var n={backedOffCount:0,current:f,original:f,scheduleConfig:g,startTime:d("WATimeUtils").unixTime(),step:"$unstarted",stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,type:i,uniqKey:e,version:c,waitUntil:null},o=function(){var b,c=a().add(n),d=j(c);if(n.uniqKey==null&&typeof ((b=c.transaction)==null?void 0:b.commit)==="function")try{c.transaction.commit()}catch(a){}return d.then(function(a){return{id:a,newlyCreated:!0}})};if(l!=null)return k(a,"uniqKey",e).then(function(c){if(c.length===0)return o();var d=[],e=null;c.forEach(function(b){b.step!=="$finished"?e=b:d.push(m(a,b.jobId))});return(h||(h=b("Promise"))).all(d).then(function(){return e!=null?{id:e.jobId,newlyCreated:!1}:o()})});else return o()}function m(a,b){return j(a()["delete"](b))}function e(a,b){return j(a().get(b))}function f(a,b){return j(a().put(b))}function n(a){return j(a().getAll())}function o(a){try{return i(a().clear()).then(c("emptyFunction"))}catch(a){if(a.name==="NotFoundError")return(h||(h=b("Promise"))).resolve();throw a}}g.recentFinishedJobsCache=l;g.maybeCreateJob=a;g.deletePersistedJob=m;g.readPersistedJob=e;g.updatePersistedJob=f;g.readAllPersistedJobs=n;g.clearJobs=o}),98);
__d("MAWJobDefinitions",["MAWExternalId"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(a){return a}e={acceptGroupInvite:function(a,b,c,d,e,f){f=i(f);return{args:{chatJid:a,inviteCode:d,invitedParticipantUserId:c,inviteExpirationTs:e,inviterUserId:b},scheduleConfig:(a=f)!=null?a:void 0,type:"acceptGroupInvite"}},addGroupParticipants:function(a,b,c){c=i(c);return{args:{group:a,users:b},scheduleConfig:(a=c)!=null?a:void 0,type:"addGroupParticipants"}},deleteMsgsForMe:function(a,b){b=i(b);return{args:{msgIds:a},scheduleConfig:(a=b)!=null?a:void 0,type:"deleteMsgsForMe"}},demoteGroupParticipants:function(a,b,c){c=i(c);return{args:{group:a,users:b},scheduleConfig:(a=c)!=null?a:void 0,type:"demoteGroupParticipants"}},downloadAndHandleMedia:function(a,b,c,d,e,f,g){e=i(g);return{args:{hash:b,metricInstanceKeys:f,msgType:d,protocolMsgId:a,qplEntryPoint:c},scheduleConfig:(g=e)!=null?g:void 0,type:"downloadAndHandleMedia"}},forwardMsg:function(a,b,c,e,f,g,h){g=i(g);return{args:{args:h,chatJid:a,ephemeralSetting:c,externalId:(h=e)!=null?h:d("MAWExternalId").generateExternalId(),isFirstMsg:f,protocolMsgId:b},scheduleConfig:(a=g)!=null?a:void 0,type:"forwardMsg"}},getSpams:function(a){a=i(a);return{args:void 0,scheduleConfig:(a=a)!=null?a:void 0,type:"getSpams"}},handleFutureproofMsg:function(a){a=i(a);return{args:{},scheduleConfig:(a=a)!=null?a:void 0,type:"handleFutureproofMsg"}},handleSpamMsg:function(a){a=i(a);return{args:void 0,scheduleConfig:(a=a)!=null?a:void 0,type:"handleSpamMsg"}},igdReportUserSpam:function(a,b){var c=a.chatJid,d=a.context,e=a.frxParams,f=a.frxTags,g=a.msgs,h=a.reportedMessageId,j=a.spamFlow;a=a.userJid;b=i(b);return{args:{chatJid:c,context:d,frxParams:e,frxTags:f,msgs:g,reportedMessageId:h,spamFlow:j,userJid:a},scheduleConfig:(c=b)!=null?c:void 0,type:"igdReportUserSpam"}},igdSendMsg:function(a,b){var c=a.actorID;a=a.taskID;b=i(b);return{args:{actorID:c,taskID:a},scheduleConfig:(c=b)!=null?c:void 0,type:"igdSendMsg"}},leaveGroups:function(a,b){b=i(b);return{args:{groups:a},scheduleConfig:(a=b)!=null?a:void 0,type:"leaveGroups"}},markThreadAsRead:function(a,b,c,d,e,f,g){g=i(g);return{args:{chatJid:a,isBlocked:c,isReadReceiptsDisabled:f,isRestricted:d,relationship:b,upTo:e},scheduleConfig:(a=g)!=null?a:void 0,type:"markThreadAsRead",uniqKey:e==null?void 0:e.externalId}},promoteGroupParticipants:function(a,b,c){c=i(c);return{args:{group:a,users:b},scheduleConfig:(a=c)!=null?a:void 0,type:"promoteGroupParticipants"}},removeGroupParticipants:function(a,b,c){c=i(c);return{args:{group:a,users:b},scheduleConfig:(a=c)!=null?a:void 0,type:"removeGroupParticipants"}},reportUserSpam:function(a,b,c,d,e,f,g,h,j,k){j=i(j);return{args:{chatJid:c,context:f,frxParams:g,frxTags:e,isIgd:d,openMsgs:k,reportedMessageId:h,spamFlow:b,userJid:a},scheduleConfig:(c=j)!=null?c:void 0,type:"reportUserSpam"}},resendWrittenAppData:function(a,b){b=i(b);return{args:{appDataExternalId:a},scheduleConfig:(a=b)!=null?a:void 0,type:"resendWrittenAppData"}},restoreMessagesFromEncryptedBackups:function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p){n=i(n);return{args:{deanonApiPayload:o,hasMoreAfter:e,hasMoreBefore:d,instanceKey:k,isPointQuery:f,messages:c,minMsgId:g,optimisticMsgs:l,skipMediaDownload:p,startSortKey:j,taskSource:m,threadId:b,traceId:h,transportKey:a},scheduleConfig:(o=n)!=null?o:void 0,type:"restoreMessagesFromEncryptedBackups"}},restoreProtobufsFromEncryptedBackups:function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p){m=i(m);return{args:{deanonApiPayload:o,echoMessages:a,hasMoreAfter:f,hasMoreBefore:e,instanceKey:l,isPointQuery:g,messages:d,minMsgId:h,referenceTimestamp:k,requestId:j,skipMediaDownload:p,taskSource:n,threadId:c,transportKey:b},scheduleConfig:(o=m)!=null?o:void 0,type:"restoreProtobufsFromEncryptedBackups"}},revokeMsgs:function(a,b){b=i(b);return{args:a,scheduleConfig:(a=b)!=null?a:void 0,type:"revokeMsgs"}},sendAppData:function(a,b,c){c=i(c);return{args:{args:a,externalId:(a=b)!=null?a:d("MAWExternalId").generateExternalId()},scheduleConfig:(b=c)!=null?b:void 0,type:"sendAppData"}},sendEditMsg:function(a,b,c){c=i(c);return{args:{args:a,externalId:(a=b)!=null?a:d("MAWExternalId").generateExternalId()},scheduleConfig:(b=c)!=null?b:void 0,type:"sendEditMsg"}},sendEphemeralSettingMsg:function(a,b,c,e){e=i(e);return{args:{args:b,chatJid:a,externalId:(b=c)!=null?b:d("MAWExternalId").generateExternalId()},scheduleConfig:(a=e)!=null?a:void 0,type:"sendEphemeralSettingMsg"}},sendGroupInviteMsg:function(a,b,c){c=i(c);return{args:{args:a,externalId:(a=b)!=null?a:d("MAWExternalId").generateExternalId()},scheduleConfig:(b=c)!=null?b:void 0,type:"sendGroupInviteMsg"}},sendMediaMsg:function(a,b,c,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){r=i(r);return{args:{args:{duration:j,ephemeralSetting:l,filename:t,height:f,isFirstMsg:p,isForwarded:o,isPtt:k,jpegThumbnail:c,jpegThumbnailHeight:h,jpegThumbnailWidth:g,mediaGroupMetadata:x,offlineAttachmentId:u,openMessageOtid:n,quote:m,s2sInstanceKey:v,source:s,width:e},attachmentType:w,chatJid:a,externalId:(j=q)!=null?j:d("MAWExternalId").generateExternalId(),file:b},scheduleConfig:(l=r)!=null?l:void 0,type:"sendMediaMsg"}},sendMsg:function(a,b,c,e){e=i(e);return{args:{args:b,chatJid:a,externalId:(b=c)!=null?b:d("MAWExternalId").generateExternalId()},scheduleConfig:(a=e)!=null?a:void 0,type:"sendMsg"}},sendRavenActionMsg:function(a,b,c,e){e=i(e);return{args:{args:b,chatJid:a,externalId:(b=c)!=null?b:d("MAWExternalId").generateExternalId()},scheduleConfig:(a=e)!=null?a:void 0,type:"sendRavenActionMsg"}},sendReactionMsg:function(a,b,c,e,f,g,h,j){g=i(g);return{args:{args:{groupingKey:"",reaction:e,reactToAuthor:c,reactToProtocolMsgId:b,s2sInstanceKey:h,source:j},chatJid:a,externalId:(e=f)!=null?e:d("MAWExternalId").generateExternalId()},scheduleConfig:(c=g)!=null?c:void 0,type:"sendReactionMsg"}},sendWrittenAppData:function(a,b){b=i(b);return{args:{appDataExternalId:a},scheduleConfig:(a=b)!=null?a:void 0,type:"sendWrittenAppData"}},sendWrittenMsg:function(a,b,c,d){c===void 0&&(c="message");d=i(d);return{args:{protocolMsgId:a,s2sInstanceKey:b,type:c},scheduleConfig:(a=d)!=null?a:void 0,type:"sendWrittenMsg"}},sendXMAShareMsg:function(a,b,c,e,f,g,h,j,k,l){l=i(l);return{args:{args:g,associatedMsgContent:f,associatedMsgContentExternalId:(g=j)!=null?g:d("MAWExternalId").generateExternalId(),chatJid:a,faviconFile:e,headerFile:c,previewFile:b,xmaArgs:k,xmaMsgExternalId:(f=h)!=null?f:d("MAWExternalId").generateExternalId()},scheduleConfig:(j=l)!=null?j:void 0,type:"sendXMAShareMsg"}},setGroupSubject:function(a,b,c){c=i(c);return{args:{group:a,subject:b},scheduleConfig:(a=c)!=null?a:void 0,type:"setGroupSubject"}},startInstamadilloDYI:function(a,b){b=i(b);return{args:{qplInstanceKey:a},scheduleConfig:(a=b)!=null?a:void 0,type:"startInstamadilloDYI"}},updateBackupEntFbidForMedia:function(a,b,c,d){d=i(d);return{args:{backupEntFbid:b,deliveryObjectId:a,traceId:c},scheduleConfig:(b=d)!=null?b:void 0,type:"updateBackupEntFbidForMedia"}},uploadRetroactiveThreadsAndMessages:function(a){a=i(a);return{args:void 0,scheduleConfig:(a=a)!=null?a:void 0,type:"uploadRetroactiveThreadsAndMessages"}}};function c(a,b){return h(a,b)}function h(a,b){var c=b.scheduleConfig,e=babelHelpers.objectWithoutPropertiesLoose(b,["scheduleConfig"]);c={args:{},scheduleConfig:c,type:a};b.externalIdJob&&(c.args.externalId=d("MAWExternalId").generateExternalId());c.args=babelHelpers["extends"]({},c.args,e);b.uniqueJob&&(c.uniqKey=a);return c}function i(a){if(a==null)return;return{jobId:a.jobId,maxTimeoutMs:a.maxTimeoutMs,priority:a.priority}}g.toThreadJidPrimaryId=a;g.toEncodedEchoMessage=b;g.jobSerializers=e;g.createStartJobInfo=c;g.createStartJobInfoGeneric=h;g.serializeJobScheduledConfig=i}),98);
__d("MWEARKeychainV3",["ExecutionEnvironment","FBLogger","LSPlatformLsInitLog","MAWCryptoConsts","MAWCurrentUser","MAWEARGenNewKeychainCryptoKey","MAWEncryptionIndexedDbV2","MAWGenKeychainCryptoKeyWithVersion","MAWKeychainCrypto","MAWWebInitDataHelpers","MWEARKeychainV3Errors","MessengerWebInitData","Promise","ReStoreTabNotifier","WAResultOrError","WATimeUtils","asyncToGeneratorRuntime","err","getErrorSafe","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j={accountKey:null,databaseEncryptionKeys:new Map(),latestVersion:d("MAWCryptoConsts").VERSION},k=babelHelpers["extends"]({},j),l="none";function a(){k=babelHelpers["extends"]({},j,{databaseEncryptionKeys:new Map()}),l="none"}var m="browserEncryptionMetaV2";function e(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(l==="success"&&k.databaseEncryptionKeys.size!==0)return d("WAResultOrError").makeResult(o());var a=d("MAWCurrentUser").getID(),e=c("ReStoreTabNotifier")("channel-ear-keychain-v3-"+a);e==null?void 0:e.onEventReceive("notifyEarKeychain",w);d("LSPlatformLsInitLog").addPoint("ear_init_start");var f=[];try{d("LSPlatformLsInitLog").addPoint("ear_gen_key_start");var g=(yield c("MAWEARGenNewKeychainCryptoKey")());f=(yield new(i||(i=b("Promise")))(function(a,b){var h=t("readwrite"),i=h.objectStore(m).getAll();i.onerror=function(){return b(i.error)};i.onsuccess=function(){var j;f=s(i.result);if(!q(f))return a(f);var k=f.map(function(a){return a.version});j=(j=k[k.length-1])!=null?j:0;k.includes(j+1)&&c("FBLogger")("messenger_e2ee_web").mustfix("EAR version corruption: versions: %s",k.toString());var l=babelHelpers["extends"]({},g,{version:j+1});h.oncomplete=function(){f.push(babelHelpers["extends"]({},l,{id:l.version})),e.postMessage("notifyEarKeychain",l.version),d("LSPlatformLsInitLog").addPoint("ear_gen_key_end"),a(f)};var n=h.objectStore(m).put(l);n.onerror=function(){return b(c("FBLogger")("messenger_e2ee_web").catching(n.error).mustfixThrow("Failed to rotate EAR key"))}}}));d("LSPlatformLsInitLog").addPoint("ear_import_start");a=(yield i.all(f.map(function(a){return p(a).then(function(b){(a.accountKeyString==null||a.userKeyBaseString==null||a.appIdOrigin==null||a.formatVersion==null)&&(d("LSPlatformLsInitLog").addPoint("ear_import_entry_backfill"),c("promiseDone")(x(a)));return b})})));d("LSPlatformLsInitLog").addPoint("ear_import_end");for(a of a)k.databaseEncryptionKeys.set(a.version,a.key);v();d("LSPlatformLsInitLog").addPoint("ear_init_end");l="success";return d("WAResultOrError").makeResult(o())}catch(a){l="failure";d("LSPlatformLsInitLog").addPoint("ear_init_error");c("FBLogger")("messenger_e2ee_web").catching(c("getErrorSafe")(a)).mustfix("Failed to setup EAR Keychain V3");return d("WAResultOrError").makeError("keychain-setup-failure",a)}});return n.apply(this,arguments)}function o(){return k.latestVersion}function f(a){a===void 0&&(a=o());var b=k.databaseEncryptionKeys.get(a);if(b==null){c("promiseDone")(r(t("readonly")).then(function(b){var d=b.map(function(a){return a.version}).includes(a);c("FBLogger")("messenger_e2ee_web").info("EAR Keychain DB match found: %s. Version = %s. NumberVersions = %s",d,a,b.length)}));var e=o(),f=Array.from(k.databaseEncryptionKeys.keys());c("FBLogger")("messenger_e2ee_web").mustfix("EAR Key v%s was null. Latest version: %s has key: %s, keychain length: %s, currentLatestVersion: %s, init status %s, in worker %s",a,e,k.databaseEncryptionKeys.get(e)==null,k.databaseEncryptionKeys.size,Math.max.apply(Math,f),l,(h||(h=c("ExecutionEnvironment"))).isInWorker);throw new(d("MWEARKeychainV3Errors").EARKeychainNotFoundError)("EAR Key "+a+" was null.")}return{key:b,version:a}}function p(a){return c("MAWGenKeychainCryptoKeyWithVersion")(a.key,a.seed,a.version,a.formatVersion,a.accountKeyString,a.userKeyBaseString,a.appIdOrigin)}function q(a){return a.length===0||!d("WATimeUtils").isInFuture(a[a.length-1].expiration)}function r(a){return u(a.objectStore(m).getAll()).then(s)}function s(a){var b=a.find(function(a){return a.version==null});b!=null&&c("FBLogger")("messenger_e2ee_web").mustfix("EAR Keychain Rotation null version: fields nonnull: %s %s %s %s %s %s",b.id==null,b.key==null,b.seed==null,b.formatVersion==null,b.accountKeyString==null,b.userKeyBaseString==null);b=a.filter(function(a){return a.version!=null});return b.sort(function(a,b){return a.version-b.version})}function t(a){var b=d("MAWEncryptionIndexedDbV2").getEncryptionDB();if(b==null)throw c("err")("Encryption IndexDB should've been initialized");return b.transaction(m,a,{durability:"relaxed"})}function u(a){return new(i||(i=b("Promise")))(function(b,c){a.onsuccess=function(){return b(a.result)},a.onerror=function(){return c(a.error)}})}var v=function(){var a=Array.from(k.databaseEncryptionKeys.keys());a.length>0?k.latestVersion=Math.max.apply(Math,a):c("FBLogger")("messenger_e2ee_web").mustfix("EAR latest version does not exist")},w=function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield r(t("readonly"))).find(function(b){return b.version===a});if(b==null)throw c("err")("Notified new Ear Key but missing in DB");b=(yield p(b));k.databaseEncryptionKeys.set(b.version,b.key);v()}catch(a){return c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("Failed to handleNewVersion. In worker %s.",(h||(h=c("ExecutionEnvironment"))).isInWorker)}})())},x=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=a.formatVersion)!=null?b:1;var e=(yield d("MAWKeychainCrypto").generateHashString(d("MAWWebInitDataHelpers").getAccountKeyString(b))),f=(yield d("MAWKeychainCrypto").generateHashString(c("MessengerWebInitData").userKeyBase)),g=t("readwrite");g.objectStore(m).put(babelHelpers["extends"]({},a,{accountKeyString:e,appIdOrigin:c("MessengerWebInitData").appId,formatVersion:b,userKeyBaseString:f}))});return function(b){return a.apply(this,arguments)}}();function y(){if(l==="success"){k.databaseEncryptionKeys.size===0&&c("FBLogger")("messenger_e2ee_web").mustfix("Keychain initialised but no keys present");return!0}return!1}g.resetKeychain__TEST_ONLY_DO_NOT_USE=a;g.init=e;g.getLatestVersion=o;g.getDbEncryptionKey=f;g.isKeychainInitialised=y}),98);
__d("MAWKeychain",["MWEARKeychainV3"],(function(a,b,c,d,e,f,g){"use strict";a={getDbEncryptionKey:d("MWEARKeychainV3").getDbEncryptionKey,getLatestVersion:d("MWEARKeychainV3").getLatestVersion,init:d("MWEARKeychainV3").init};g["default"]=a}),98);
__d("MAWLocalStorage",["LocalStorageWrapper","MWLocalStorageErrorHandler","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["not storage found"]);h=function(){return a};return a}function i(a){d("WALogger").LOG([a])}function j(a){d("WALogger").ERROR([a])}function a(){return d("LocalStorageWrapper").getStorage(i)}function b(){return d("LocalStorageWrapper").isLocalStorageAvailable(i)}function c(a,b,c){return d("LocalStorageWrapper").setItemGuarded(a,b,c,j,d("MWLocalStorageErrorHandler").onQuotaExceeded)}function e(a,b){a==null?d("WALogger").ERROR(h()):a.removeItem(b)}g.getStorage=a;g.isLocalStorageAvailable=b;g.setItemGuarded=c;g.removeItemGuarded=e}),98);
__d("MAWLoggerUtils",["Random"],(function(a,b,c,d,e,f,g){"use strict";b={CleanerPurge:"CleanerPurge",CleanerStart:"CleanerStart",CleanerTimestamp:"CleanerTimestamp",CleanerUpdate:"CleanerUpdate",Countdown:"Countdown",Ephemeral:"Ephemeral",Incoming:"Incoming",MsgCleaner:"MsgCleaner",OnLoad:"OnLoad",OnRead:"OnRead",Outgoing:"Outgoing",PeerReceipt:"PeerReceipt",SettingChange:"SettingChange",SettingSync:"SettingSync",DeviceRegistration:"DeviceRegistration",MessageReceive:"MessageReceive",MediaDownload:"MediaDownload",WorkerSetup:"WorkerSetup",MAWWorker:"MAWWorker",MAWInit:"MAWInit",LogoutHandler:"LogoutHandler",MiActMapping:"MiActMapping",ThreadReady:"ThreadReady"};function a(){return Math.floor(Date.now()+d("Random").random()*1e4+1e4)}g.Tag=b;g.getInstanceKey=a}),98);
__d("MAWMediaDownloadStatus",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["DOWNLOADING","SUCCESS","NOT_MANUAL_RETRYABLE_FAILURE","MANUAL_RETRYABLE_FAILURE","MISSING_FILE"]);c=a;f["default"]=c}),66);
__d("WALoggerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("WATagsLogger").__setRef("WALoggerDeferred");function a(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.load().then(function(b){return b.whenReady().then(function(){var d;return(d=b.TAGS([])).DEV.apply(d,[a].concat(c))})})}function b(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.load().then(function(b){return b.whenReady().then(function(){var d;return(d=b.TAGS([])).DEV_XMPP.apply(d,[a].concat(c))})})}function d(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.load().then(function(b){return b.whenReady().then(function(){var d;return(d=b.TAGS([])).LOG.apply(d,[a].concat(c))})})}function e(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.load().then(function(b){return b.whenReady().then(function(){var d;return(d=b.TAGS([])).WARN.apply(d,[a].concat(c))})})}function f(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return h.load().then(function(b){return b.whenReady().then(function(){var d;return(d=b.TAGS([])).ERROR.apply(d,[a].concat(c))})})}function i(a,b,c){return h.load().then(function(d){return d.whenReady().then(function(){return d.TAGS(a)}).then(function(a){a[c](b)})})}g.DEV=a;g.DEV_XMPP=b;g.LOG=d;g.WARN=e;g.ERROR=f;g.logWithTags=i}),98);
__d("MAWMiActOnActThreadReadyQueue",["FBLogger","I64","MAWWebWorkerInstance","WALoggerDeferred","asyncToGeneratorRuntime","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MiActMapping] Executing queued action on ACT thread ready: "," for threadKey: ",""]);i=function(){return a};return a}var j=new Map(),k=3e4;function a(a,b,e,f,g){var i=(h||(h=d("I64"))).to_string(a);a=(a=j.get(i))!=null?a:[];var l=c("setTimeout")(function(){c("FBLogger")("messenger_e2ee_web").mustfix("[MiActMapping] Took longer than %s ms to execute: %s in threadState: %s for threadKey: %s, onActThreadReady, isWorkerAlive: %s",k,f,g,i,d("MAWWebWorkerInstance").doesWorkerExist()),e()},k);a.push({callback:b,description:f,threadState:g,timeoutId:l});j.set(i,a)}function e(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(h||(h=d("I64"))).to_string(a),f=j.get(e);if(f==null||f.length===0)return;while(f.length!==0){var g=f.shift(),k=g.callback,l=g.description,m=g.threadState;g=g.timeoutId;try{c("promiseDone")(d("WALoggerDeferred").LOG(i(),l,e)),yield k(a,b),c("clearTimeout")(g)}catch(a){c("clearTimeout")(g),c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[MiActMapping] Error executing callback on ACT thread ready: %s, original threadState: %s, threadKey: %s",l,m,e)}}j["delete"](e)});return l.apply(this,arguments)}g.enqueueByThreadKey=a;g.processQueueOnActThreadReady=e}),98);
__d("MAWMsg",["$InternalEnum","I64","LSIntEnum","LSMessagingThreadTypeUtil","LSReplyMessageAttachmentType","MAWMsgType","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b,e,f,g){if(a===d("MAWMsgType").MSG_TYPE.TEXT)if(b)return(i||(i=d("LSIntEnum"))).ofNumber(8192);else return(i||(i=d("LSIntEnum"))).ofNumber(1);else if(a===d("MAWMsgType").MSG_TYPE.IMAGE||a===d("MAWMsgType").MSG_TYPE.VIDEO||a===d("MAWMsgType").MSG_TYPE.RAVEN)return(i||(i=d("LSIntEnum"))).ofNumber(2);else if(a===d("MAWMsgType").MSG_TYPE.PTT)return(i||(i=d("LSIntEnum"))).ofNumber(4);else if(a===d("MAWMsgType").MSG_TYPE.FUTUREPROOF)return k(g);else if(a===d("MAWMsgType").MSG_TYPE.CIPHERTEXT)return(i||(i=d("LSIntEnum"))).ofNumber(65536);else if(a===d("MAWMsgType").MSG_TYPE.UNAVAILABLE)return(i||(i=d("LSIntEnum"))).ofNumber(262144);else if(a===d("MAWMsgType").MSG_TYPE.GIF)return(i||(i=d("LSIntEnum"))).ofNumber(16384);else if(a===d("MAWMsgType").MSG_TYPE.STICKER)return(i||(i=d("LSIntEnum"))).ofNumber(4096);else if(a===d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE)return(i||(i=d("LSIntEnum"))).ofNumber(64);else if(a===d("MAWMsgType").MSG_TYPE.XMA)if(e!=null&&e)return(i||(i=d("LSIntEnum"))).ofNumber(256);else return(i||(i=d("LSIntEnum"))).ofNumber(1024);else if(a===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE)if(!f)return(i||(i=d("LSIntEnum"))).ofNumber(33554432);else return(i||(i=d("LSIntEnum"))).ofNumber(1);else if(a===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH)return!c("gkx")("5624")?(i||(i=d("LSIntEnum"))).ofNumber(67108864):(i||(i=d("LSIntEnum"))).ofNumber(134217728);else return(i||(i=d("LSIntEnum"))).ofNumber(1)}function k(a){switch(a){case"locationMessage":case"liveLocationMessage":return(i||(i=d("LSIntEnum"))).ofNumber(524288);case"pollCreationMessage":return(i||(i=d("LSIntEnum"))).ofNumber(1048576);case"contactShareMessage":return(i||(i=d("LSIntEnum"))).ofNumber(2097152);case"storyMentionMessage":return(i||(i=d("LSIntEnum"))).ofNumber(4194304);case"metaAiMessage":return(i||(i=d("LSIntEnum"))).ofNumber(8388608);case"bumpMessage":return(i||(i=d("LSIntEnum"))).ofNumber(16777216);case"stickerReceiverFetchMessage":return(i||(i=d("LSIntEnum"))).ofNumber(67108864);default:return(i||(i=d("LSIntEnum"))).ofNumber(131072)}}function e(a){a=a.displayedContentTypes;return(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(2))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(4))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(16384))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(16))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(64))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(4096))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(134217728))}function f(a,b){var e=a.replyAttachmentType;if(e==null)return!1;b=d("LSMessagingThreadTypeUtil").isArmadilloSecure(b);return b&&a.replyAttachmentId==null?!1:(j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").PHOTO))||(j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").GIF))||(j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").AUDIO))||(j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER))||(j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").VIDEO))}function l(a){return(j||(j=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(134217728))}function m(a){a=a.displayedContentTypes;if((j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(32)))return!0;else return!1}function n(a){return(j||(j=d("I64"))).equal(a.sendStatusV2,(i||(i=d("LSIntEnum"))).ofNumber(0))}function o(a){a=a.displayedContentTypes;return(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(1024))}function p(a){a=a.displayedContentTypes;return(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(65536))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(131072))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(524288))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(1048576))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(2097152))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(4194304))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(8388608))||(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(16777216))?!0:(j||(j=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(262144))}var q=(b=b("$InternalEnum"))({PLAYED:0,SCREENSHOTTED:1,FORCE_DISABLED:2}),r=b({PERMANENT:0,UNSEEN:1,SEEN:2,REPLAYED:3,EXPIRED:4}),s=b({VIEW_ONCE:0,ALLOW_REPLAY:1,KEEP_IN_CHAT:2});b=b({IMAGE:0,VIDEO:1});g.text=(h=d("MAWMsgType")).MSG_TYPE.TEXT;g.image=h.MSG_TYPE.IMAGE;g.video=h.MSG_TYPE.VIDEO;g.ptt=h.MSG_TYPE.PTT;g.unsent=h.MSG_TYPE.REVOKED;g.gif=h.MSG_TYPE.GIF;g.bumpExistingMessage=h.MSG_TYPE.BUMP_EXISTING_MESSAGE;g.getDisplayedContentTypes=a;g.isMediaMsg=e;g.isMediaReplyAttachmentType=f;g.isReceiverFetchMsg=l;g.isAdminMsg=m;g.isOptimistic=n;g.isXMAMsg=o;g.isPlaceholder=p;g.MAWRavenActionNotifType=q;g.MAWRavenMsgEphemeralMediaState=r;g.MAWRavenMsgEphemeralType=s;g.MAWRavenMsgMediaType=b}),98);
__d("MAWParseXMAFBConfig",["WAArmadilloXMA.pb","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([(b=d("WAArmadilloXMA.pb")).EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT,c("qex")._("1711")?d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:null,c("gkx")("5481")?d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:null,c("gkx")("23929")?d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:null].concat(c("gkx")("6952")?[d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2,d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING]:[]).filter(Boolean));function a(a){return a==null?!1:h.has(a)}g.FB_SUPPORTED_TARGET_TYPES=h;g.isFBSupportedTargetType=a}),98);
__d("RavenMessagingState",[],(function(a,b,c,d,e,f){a=Object.freeze({PERMANENT:0,UNSEEN:1,SEEN:2,REPLAYED:3,EXPIRED:4});f["default"]=a}),66);
__d("MAWRavenUtils",["EphemeralMediaViewMode","MAWMsg","RavenMessagingState"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){switch(a){case d("MAWMsg").MAWRavenMsgEphemeralMediaState.PERMANENT:return c("RavenMessagingState").PERMANENT;case d("MAWMsg").MAWRavenMsgEphemeralMediaState.UNSEEN:return c("RavenMessagingState").UNSEEN;case d("MAWMsg").MAWRavenMsgEphemeralMediaState.SEEN:return c("RavenMessagingState").SEEN;case d("MAWMsg").MAWRavenMsgEphemeralMediaState.REPLAYED:return c("RavenMessagingState").REPLAYED;case d("MAWMsg").MAWRavenMsgEphemeralMediaState.EXPIRED:return c("RavenMessagingState").EXPIRED}},i=function(a){switch(a){case d("MAWMsg").MAWRavenMsgEphemeralType.KEEP_IN_CHAT:return c("EphemeralMediaViewMode").PERMANENT;case d("MAWMsg").MAWRavenMsgEphemeralType.ALLOW_REPLAY:return c("EphemeralMediaViewMode").REPLAYABLE;case d("MAWMsg").MAWRavenMsgEphemeralType.VIEW_ONCE:return c("EphemeralMediaViewMode").READ_ONCE}};b=function(a,b){return{ephemeralMediaState:b,ephemeralMediaViewMode:i(a)}};function a(a,b){switch(b){case d("MAWMsg").MAWRavenMsgEphemeralType.VIEW_ONCE:return a===d("MAWMsg").MAWRavenMsgEphemeralMediaState.UNSEEN?c("RavenMessagingState").SEEN:h(a);case d("MAWMsg").MAWRavenMsgEphemeralType.ALLOW_REPLAY:if(a===d("MAWMsg").MAWRavenMsgEphemeralMediaState.UNSEEN)return c("RavenMessagingState").SEEN;else if(a===d("MAWMsg").MAWRavenMsgEphemeralMediaState.SEEN)return c("RavenMessagingState").REPLAYED;return h(a);case d("MAWMsg").MAWRavenMsgEphemeralType.KEEP_IN_CHAT:return h(a)}}g.getEphemeralMediaState=h;g.getEphemeralMediaViewMode=i;g.deriveRavenSettings=b;g.getNextRavenMessageEphemeralState=a}),98);
__d("MAWSharedProtocolQueueConst",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Initializing:"initializing",Failed:"failed",Processing:"processing",Complete:"complete"});f.OfflineConsumerStatus=a}),66);
__d("MAWThreadBumpType",[],(function(a,b,c,d,e,f){"use strict";a="NO_UPDATE";b="LOCAL_ONLY";c="LOCAL_AND_SERVER";d=Object.freeze({LOCAL_AND_SERVER:c,LOCAL_ONLY:b,NO_UPDATE:a});f.THREAD_BUMP_TYPE=d}),66);
__d("MAWThreadUpdateType",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;e=Object.freeze({BUMP_THREAD:c,MARK_THREAD_AS_UNREAD:d,NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:a,SNIPPET_ONLY:b});f.THREAD_UPDATE_TYPE=e}),66);
__d("WAJobOrchestratorTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({SKIP:"SKIP_PRIORITIZATION",UI_ACTION:"UI_ACTION",LOW:"LOW",HIGH:"HIGH",OFFLINE:"OFFLINE",HISTORY_SYNC:"HISTORY_SYNC",BEST_EFFORT:"BEST_EFFORT"});c=1;d=a.LOW;e=10*1e3;f.JOB_PRIORITY=a;f.DEFAULT_CONCURRENCY=c;f.DEFAULT_JOB_PRIORITY=d;f.DEFAULT_JOB_TIMEOUT_MS=e}),66);
__d("MAWUIJob",["ExecutionEnvironment","MAWBridge","WAJobOrchestratorTypes","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters waitUntilPersisted called in the worker, which is a bug for job: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters waitUntilCompleted called in the worker, which is a bug for job: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters fireAndForget called in the worker, which is a bug for job: ",""]);k=function(){return a};return a}var l={priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION};a={fireAndForget:function(a){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(k(),a.type);d("MAWBridge").getBridge().fireAndForget("backend","runJobFireAndForget",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}))},waitUntilCompleted:function(a,b){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(j(),a.type);a=d("MAWBridge").getBridge().sendAndReceive("backend","runJobWaitUntilCompleted",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}),void 0,b);return a},waitUntilPersisted:function(a,b){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(i(),a.type);a=d("MAWBridge").getBridge().sendAndReceive("backend","runJobWaitUntilPersisted",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}),void 0,b);return a}};g.UIJobStarters=a}),98);
__d("MAWTimedJob",["FBLogger","MAWBridgeLoggingUtils","MAWMaybeWithTimeout","MAWUIJob","MAWWaitForBackendSetup","MAWWebWorkerInstance","MAWWorkerEvent","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";var h=6e4;a={fireAndForget:function(a,b){b===void 0&&(b=h);var e=!1;return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){e=!0;return d("MAWUIJob").UIJobStarters.fireAndForget(a)}),b,function(){var b=d("MAWWebWorkerInstance").doesWorkerExist();throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to complete execution of job %s in time. Backend setup: %s, workerExists: %s",a.type,e,b)},a.type)},waitUntilCompleted:function(a,b){b===void 0&&(b=h);var e=!1,f=d("MAWBridgeLoggingUtils").getBridgeEventInstanceKey();return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){d("MAWWorkerEvent").logStart(a.type,f);d("MAWWorkerEvent").logAnnotations(f,{string:{callType:"waitUntilCompleted"}});e=!0;return d("MAWUIJob").UIJobStarters.waitUntilCompleted(a,{onSend:function(){d("MAWWorkerEvent").logPoint(f,"send")},onAck:function(a){d("MAWWorkerEvent").logPoint(f,"ack"),d("MAWWorkerEvent").logAckResultAnnotations(f,a)}}).then(function(a){d("MAWWorkerEvent").logSuccess(f);return a},function(a){a=c("getErrorSafe")(a);d("MAWWorkerEvent").logFailure(f,a.message);throw a})}),b,function(){var b=d("MAWWebWorkerInstance").doesWorkerExist();d("MAWWorkerEvent").logTimeout(f);throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to complete execution of job %s in time. Backend setup: %s, workerExists: %s",a.type,e,b)},a.type)},waitUntilPersisted:function(a,b){b===void 0&&(b=h);var e=!1,f=d("MAWBridgeLoggingUtils").getBridgeEventInstanceKey();return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){e=!0;d("MAWWorkerEvent").logStart(a.type,f);d("MAWWorkerEvent").logAnnotations(f,{string:{callType:"waitUntilPersisted"}});return d("MAWUIJob").UIJobStarters.waitUntilPersisted(a,{onSend:function(){d("MAWWorkerEvent").logPoint(f,"send")},onAck:function(a){d("MAWWorkerEvent").logPoint(f,"ack"),d("MAWWorkerEvent").logAckResultAnnotations(f,a)}}).then(function(a){d("MAWWorkerEvent").logSuccess(f);return a},function(a){a=c("getErrorSafe")(a);d("MAWWorkerEvent").logFailure(f,a.message);throw a})}),b,function(){var b=d("MAWWebWorkerInstance").doesWorkerExist();d("MAWWorkerEvent").logTimeout(f);throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to persist execution of job %s in time. Backend setup: %s, workerExists: %s",a.type,e,b)},a.type)}};g.DEFAULT_TIMEOUT_MS=h;g.TimedUIJobStarters=a}),98);
__d("MAWTraceUtils",["LSDataTraceCheckPoint","LSDataTraceTag","LSIntEnum","LSRequestId","MAWBridge","MAWBridgeTrace","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h,i="backup_upload",j="media_backup",k="vesta_registration",l="vesta_login";function m(){return c("LSRequestId").generate()}function a(a,b,c){c=(c=c)!=null?c:m();d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"StartTraceWithTraceId",value:d("MAWBridgeTrace").createBridgeStartTraceWithTraceIdData(a,c,b)}]},!0);return c}function n(a,b,c,e,f){if(a!=null){c=c.length>0?c.map(function(a){return a.toString()}).join(","):void 0;d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"TraceRecordCheckpoint",value:d("MAWBridgeTrace").createBridgeTraceRecordCheckpointData(b,a,f,e,-1,c)}]},!0)}}function b(a,b,e,f){n(a,b,e,!1),n(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE),e,!0,f)}function e(a,b,e){n(a,b,e,!1),n(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),e,!0)}function f(a,b,e){n(a,b,e,!1),n(a,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),e,!0)}function o(a){switch(a){case d("MAWMsgType").MSG_TYPE.TEXT:return d("LSDataTraceTag").messageTypeText;case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:return d("LSDataTraceTag").messageTypeFutureproof;case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:return d("LSDataTraceTag").messageTypeCiphertext;case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:return d("LSDataTraceTag").messageTypeUnavailable;case d("MAWMsgType").MSG_TYPE.IMAGE:return d("LSDataTraceTag").messageTypeImage;case d("MAWMsgType").MSG_TYPE.VIDEO:return d("LSDataTraceTag").messageTypeVideo;case d("MAWMsgType").MSG_TYPE.PTT:return d("LSDataTraceTag").messageTypePtt;case d("MAWMsgType").MSG_TYPE.ADMIN:return d("LSDataTraceTag").messageTypeAdmin;case d("MAWMsgType").MSG_TYPE.REVOKED:return d("LSDataTraceTag").messageTypeRevoked;case d("MAWMsgType").MSG_TYPE.GIF:return d("LSDataTraceTag").messageTypeGif;case d("MAWMsgType").MSG_TYPE.STICKER:return d("LSDataTraceTag").messageTypeSticker;case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return d("LSDataTraceTag").messageTypeExpiredEphemeral;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return d("LSDataTraceTag").messageTypeEphemeralSettingAdmin;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return d("LSDataTraceTag").messageTypeEphemeralSyncResponse;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return d("LSDataTraceTag").messageTypeEphemeralScreenshotAction;case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:return d("LSDataTraceTag").messageTypeDeleteForMe;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:return d("LSDataTraceTag").messageTypeEphemeralSettingChangeFromCurrentDevice;case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:return d("LSDataTraceTag").messageTypeAlertICDC;case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:return d("LSDataTraceTag").messageTypeGroupInvite;case d("MAWMsgType").MSG_TYPE.XMA:return d("LSDataTraceTag").messageTypeXMA;case d("MAWMsgType").MSG_TYPE.REACTION:return d("LSDataTraceTag").messageTypeReaction;case d("MAWMsgType").MSG_TYPE.SK_DISTRIBUTION:return d("LSDataTraceTag").messageTypeSenderKeyDistribution;default:return d("LSDataTraceTag").messageTypeNone}}g.CONTEXT_BACKUP_UPLOAD=i;g.CONTEXT_MEDIA_BACKUP=j;g.CONTEXT_VESTA_REGISTRATION=k;g.CONTEXT_VESTA_LOGIN=l;g.createTraceId=m;g.startNewTrace=a;g.recordCheckpointForTrace=n;g.recordFailureAndFlushForTraceId=b;g.recordSuccessAndFlushForTraceId=e;g.recordInvalidUploadRequestAndFlushTrace=f;g.getTagForMsgType=o}),98);
__d("MWTabCommunicationChannel",["MAWLocalStorage"],(function(a,b,c,d,e,f,g){"use strict";var h=typeof window!=="undefined"?window:self;function i(a){var b=d("MAWLocalStorage").getStorage(),c=function(c){d("MAWLocalStorage").setItemGuarded(b,a,JSON.stringify(c))},e=function(c){window.removeEventListener("storage",c),d("MAWLocalStorage").removeItemGuarded(b,a)},f=function(a){window.addEventListener("storage",a)},g=function(b){return b!=null&&b.key===a&&typeof b.newValue==="string"?JSON.parse(b.newValue):null};return{getMessage:g,onRequestReceived:function(a){var b=function(b){b=g(b);b!=null&&a(b)};f(b);return{release:function(){e(b)}}},sendMessage:c,stopWaitingForReply:e,waitForReply:f}}function j(a){var b=new h.BroadcastChannel(a),c=new Set();b.addEventListener("message",function(a){c.forEach(function(b){b(a)})});var d=function(a){c.add(a)},e=function(a){c["delete"](a)};a=function(a){b.postMessage(JSON.stringify(a))};var f=function(a){return a!=null&&typeof a.data==="string"?JSON.parse(a.data):null};return{getMessage:f,onRequestReceived:function(a){var b=function(b){b=f(b);b!=null&&a(b)};d(b);return{release:function(){e(b)}}},sendMessage:a,stopWaitingForReply:e,waitForReply:d}}function a(a){return h.BroadcastChannel!=null?j(a):i(a)}g.getChannel=a}),98);
__d("MWTabCommunication",["MWTabCommunicationChannel","Promise","clearTimeout","pageID","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b){var c=this;this.$2=null;this.$5=function(a){a=c.$4.getMessage(a);a!=null&&a.a==="sb"&&a.t!==c.tabID()&&a.r===c.tabID()&&a.k!=null&&(c.$2&&c.$2(a.k),c.$4.stopWaitingForReply(c.$5),c.$2=null)};this.$1=a;this.$3=b!=null?b:500;this.$4=d("MWTabCommunicationChannel").getChannel(a)}var e=a.prototype;e.tabID=function(){return c("pageID")};e.$6=function(){var a={a:"r",t:this.tabID()};this.$4.sendMessage(a)};e.listenToRequest=function(a){return this.listenToRequestAsync(function(){return(h||(h=b("Promise"))).resolve(a())})};e.listenToRequestAsync=function(a){var b=this,d=function(d){d.a==="r"&&d.t!==b.tabID()&&c("promiseDone")(a().then(function(a){a={a:"sb",k:a,r:d.t,t:b.tabID()};b.$4.sendMessage(a)}))};return this.$4.onRequestReceived(d)};e.$7=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.$2=b,a.$4.waitForReply(a.$5),a.$6()})};e.request=function(a,d){var e=this,f,g=function(){f!=null&&c("clearTimeout")(f)};return(h||(h=b("Promise"))).race([this.$7().then(function(b){e.$4.stopWaitingForReply(e.$5);return a(b)}),new h(function(a){f=c("setTimeout")(function(){a(d()),e.$4.stopWaitingForReply(e.$5)},e.$3)})]).then(function(a){g();return a})};return a}();g.MWTabCommunication=a}),98);
__d("MAWVaultMaterialsStorage",["BrowserLockManager","FBLogger","MAWVaultMaterials","MAWVaultMaterialsStorageStatus","MWTabCommunication","Promise","asyncToGeneratorRuntime","emptyFunction","gkx","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i="mw_vaulting_materials_lock";f="mw_exchange_vm";var j=new(d("MWTabCommunication").MWTabCommunication)(f,c("gkx")("5912")?c("justknobx")._("2891"):500);function k(a){return j.request(function(a){return{isRequestSuccessful:!0,vaultMaterials:d("MAWVaultMaterials").fromStringToMaterials(a)}},function(){a&&c("FBLogger")("maw_ear").mustfix("Vaulting materials were not received from another tab");return{isRequestSuccessful:!1,vaultMaterials:null}}).then(function(a){var b=a.isRequestSuccessful;a=a.vaultMaterials;return d("MAWVaultMaterials").initializeVaultMaterials(a,b===!1?"generated after timeout":void 0)})}function l(){if(c("BrowserLockManager")!=null)return new(h||(h=b("Promise")))(function(a,e){c("BrowserLockManager").request(i,{ifAvailable:!0},function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e==null){c("promiseDone")(c("BrowserLockManager").request(i,function(){d("MAWVaultMaterialsStorageStatus").setIsCurrentContextHoldingLock();return new(h||(h=b("Promise")))(c("emptyFunction"))}));e=(yield k(!0));a(e);return}a(d("MAWVaultMaterials").initializeVaultMaterials());return new(h||(h=b("Promise")))(c("emptyFunction"))});return function(a){return e.apply(this,arguments)}}())["catch"](function(a){e(a)})});else{c("FBLogger")("maw_ear").info("navigator.locks is not available, using fallback");return k(!1)}}function a(){if(d("MAWVaultMaterials").hasVaultBeenSetup())return(h||(h=b("Promise"))).resolve(d("MAWVaultMaterials").getVaultMaterials());var a=l();j.listenToRequestAsync(function(){return a.then(function(){return d("MAWVaultMaterials").materialsToString()})});return a}function e(a){if(d("MAWVaultMaterials").hasVaultBeenSetup())return;d("MAWVaultMaterials").initializeVaultMaterials(a);j.listenToRequest(function(){return d("MAWVaultMaterials").materialsToString()});c("BrowserLockManager")!=null&&c("promiseDone")(c("BrowserLockManager").request(i,function(){d("MAWVaultMaterialsStorageStatus").setIsCurrentContextHoldingLock();return new(h||(h=b("Promise")))(c("emptyFunction"))}))}g.setupVaultMaterials=a;g.setupExistingVaultMaterials=e}),98);
__d("MWSetupDBEncryption",["BrowserLockManager","ExecutionEnvironment","FBLogger","MAWEncryptionIndexedDbV2","MAWKeychain","MWEARKeychainV3","Promise","WAResultOrError","asyncToGeneratorRuntime","getErrorSafe","gkx","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a,b){return b()};function a(a){j=a}var k="mw_ear_db";function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield d("MAWEncryptionIndexedDbV2").makeEncryptionDB(a);return yield j("init_setup_keychain",function(){return c("MAWKeychain").init()})}catch(e){var b=e instanceof Error?e:c("getErrorSafe")(e);c("FBLogger")("messenger_e2ee_web").catching(b).mustfix("[%s] EAR setup error",String(a));return d("WAResultOrError").makeError("keychain-setup-failure",b)}});return m.apply(this,arguments)}function n(a){if(d("MAWEncryptionIndexedDbV2").getEncryptionDB()!=null&&d("MWEARKeychainV3").isKeychainInitialised())return(i||(i=b("Promise"))).resolve(d("WAResultOrError").makeResult(d("MWEARKeychainV3").getLatestVersion()));var e=c("gkx")("5522")?k.concat((h||(h=c("ExecutionEnvironment"))).isInWorker?"_worker":"_main"):k;if(c("BrowserLockManager")!=null)return new(i||(i=b("Promise")))(function(d,f){c("promiseDone")(c("BrowserLockManager").request(e,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield l(a));d(b)}catch(a){f(a)}})),function(a){},function(a){f(a)})});else return l(a)}function e(a,c){c===void 0&&(c=function(a){return!0});var d=null;return function(e){d==null&&(d=a(e).then(function(a){d=c(a)?(i||(i=b("Promise"))).resolve(a):null;return a})["catch"](function(a){d=null;throw a}));return d}}f=e(function(a){return n(a)},function(a){return(a==null?void 0:a.success)===!0});e=c("justknobx")._("2804")?f:n;g.setPerformanceMeasurementTool=a;g.init=e}),98);
__d("WAArmadilloBackupMessage.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};a.internalSpec={metadata:[1,(e=d("WAProtoConst")).TYPES.MESSAGE,b],payload:[2,e.TYPES.BYTES]};b.internalSpec={senderId:[1,e.TYPES.STRING],messageId:[2,e.TYPES.STRING],timestampMs:[3,e.TYPES.INT64],frankingMetadata:[4,e.TYPES.MESSAGE,c],payloadVersion:[5,e.TYPES.INT32],futureProofBehavior:[6,e.TYPES.INT32]};c.internalSpec={frankingTag:[3,e.TYPES.BYTES],reportingTag:[4,e.TYPES.BYTES]};g.BackupMessageSpec=a;g.BackupMessage$MetadataSpec=b;g.BackupMessage$Metadata$FrankingMetadataSpec=c}),98);
__d("WAByteArray",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b=b;var c=new Uint8Array(a);for(a=a-1;a>=0;a--)c[a]=b&255,b>>>=8;return c}function b(a){return a.buffer.slice(a.byteOffset,a.byteLength+a.byteOffset)}function c(a,b){if(!a||!b)return!1;a=new Uint8Array(a);b=new Uint8Array(b);var c=a.length,d=b.length;if(c!==d)return!1;for(d=0;d<c;d++)if(a[d]!==b[d])return!1;return!0}f.intToBytes=a;f.uint8ArrayToBuffer=b;f.compareArrayBuffer=c}),66);
__d("WAShiftTimer",["err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.$2=0;this.$3=0;this.ts=0;this.$4=0;this.$5=0;this.$6=0;this.$7=void 0;this.$8=function(){var a=b.$7,c=b.$1;b.$3=0;b.$2=0;b.ts=0;b.$4=0;b.$5=0;b.$6=0;b.$7=void 0;c(a)};this.onOrBefore=function(a,c){h(a);var d=Date.now();d=d+a;var e=b.$5;if(e!==0&&e<d)return;e=b.$6;if(e!==0&&d<e)return;b.$5=d;!b.$3&&(!b.$2||d<b.ts)&&b.$9(d,a,c)};this.forceRunNow=function(a){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$7=a,b.$8()};this.cancel=function(){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$2=0,b.$3=0,b.ts=0,b.$4=0,b.$5=0,b.$6=0,b.$7=void 0};this.$1=a}var b=a.prototype;b.onOrBeforeRepaint=function(a){if(this.$3)return;var b=Date.now(),c=this.$6;if(c!==0&&b<c)return;c=this.$5;(c===0||b<c)&&(this.$5=b);this.$2&&(clearTimeout(this.$2),this.$2=0);(!this.ts||this.ts>b)&&(this.ts=b);this.$7=a;this.$3=requestAnimationFrame(this.$8)};b.onOrAfter=function(a,b){h(a);var c=Date.now();c=c+a;var d=this.$6;if(d!==0&&c<d)return;d=this.$5;if(d!==0&&d<c)return;this.$6=c;(!this.$2||this.ts<c)&&this.$9(c,a,b)};b.debounce=function(a,b){h(a),this.$10(Date.now(),a,b)};b.debounceAndCap=function(a,b,c){h(a);h(b);var d=Date.now();b=d+b;var e=this.$6,f=this.$5;(e===0||e<=b)&&(f===0||b<f)&&(this.$5=b);this.$10(d,a,c)};b.forceRunNowIfScheduled=function(){this.$2?(clearTimeout(this.$2),this.$8()):this.$3&&(cancelAnimationFrame(this.$3),this.$8())};b.isScheduled=function(){return this.$2!==0||this.$3!==0};b.$10=function(a,b,c){var d=a+b,e=this.$6;if(e!==0&&d<e)return;e=this.ts;var f=this.$5;f!==0&&f<d?e<f&&this.$9(f,f-a,c):e<d&&this.$9(d,b,c)};b.$9=function(a,b,c){this.$3&&(cancelAnimationFrame(this.$3),this.$3=0);this.$7=c;this.ts=a;if(this.$2){c=a-this.$4;if(-16<c&&c<16)return;clearTimeout(this.$2)}this.$2=setTimeout(this.$8,b);this.$4=a};return a}();function h(a){if(!(a>=0))throw c("err")("ShiftTimer must be given delayMs >= 0")}g.ShiftTimer=a}),98);
__d("WALruCache",["WALogger","WAShiftTimer","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Blob size is larger than the limit of the whole store."]);h=function(){return a};return a}var i=function(a,b){this.key=a,this.value=b,this.prev=null,this.next=null};a=function(){function a(a){var b=this,e;this.$2=new Map();this.purgeNow=function(){for(var a=b.$6.prev;b.$4>b.$3&&a!==b.$5;a=a?a.prev:null){if(a==null)throw c("err")("The linked list is not constructed properly.");var d=a,e=d.key;d=d.value;if(!b.$9(e,d))continue;b["delete"](e);b.$10&&b.$10(e,d)}b.$8&&b.$8(b.$2)};this.$3=a.sizeLimit;this.$7=a.getSize;this.$8=a.onPurge;this.$9=(e=a.shouldEvict)!=null?e:function(){return!0};this.$10=a.onEvict;this.$11=a.onAdd;this.$12=a.onDelete;this.$4=0;this.$5=new i("placeholder-head",null);this.$6=new i("placeholder-tail",null);this.$5.next=this.$6;this.$6.prev=this.$5;this.$1=new(d("WAShiftTimer").ShiftTimer)(function(){return b.purgeNow()})}var b=a.prototype;b.get=function(a){if(!this.$2.has(a))return null;a=this.$2.get(a);if(a==null)return null;var b=a.prev,d=a.next;b&&(b.next=d);d&&(d.prev=b);d=this.$5.next;if(d==null)throw c("err")("The linked list is not constructed properly.");this.$5.next=a;d.prev=a;a.prev=this.$5;a.next=d;return a.value};b.has=function(a){return this.$2.has(a)};b.touch=function(a){this.get(a)};b.put=function(a,b){if(this.$3===0)return;if(this.$7(b)>this.$3){d("WALogger").WARN(h());return}this["delete"](a);this.$14(a,b);this.schedulePurge()};b.$14=function(a,b){var d=new i(a,b);this.$2.set(a,d);var e=this.$5.next;if(e==null)throw c("err")("The linked list is not constructed properly.");this.$5.next=d;e.prev=d;d.prev=this.$5;d.next=e;this.$4+=this.$7(b);this.$11&&this.$11(a,b)};b["delete"]=function(a){if(!this.$2.has(a))return;var b=this.$2.get(a);if(b==null)return;this.$4-=this.$7(b.value);var c=b.prev,d=b.next;c&&(c.next=d);d&&(d.prev=c);this.$2["delete"](a);this.$12&&this.$12(a,b.value)};b.clear=function(){this.$2.clear(),this.$4=0,this.$5.next=this.$6,this.$6.prev=this.$5,this.$13&&this.$13()};b.schedulePurge=function(){this.$1.onOrBefore(1e3)};b.getCurrentSize=function(){return this.$4};b.getPlaceholderHead=function(){return this.$5};return a}();g.LruCache=a}),98);
__d("WAMapWithDefault",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,b!=null?this.$2=new Map(b):this.$2=new Map()}var b=a.prototype;b.size=function(){return this.$2.size};b.clear=function(){this.$2.clear()};b["delete"]=function(a){return this.$2["delete"](a)};b.get=function(a){var b=this.$2.get(a);if(b!=null)return b;else{b=this.$1(a);this.$2.set(a,b);return b}};b.keys=function(){return this.$2.keys()};b.entries=function(){return this.$2.entries()};b.update=function(b,c){c=new Map(this.$2).set(b,c(this.get(b)));return new a(this.$1,c)};b.toMap=function(){return new Map(this.$2)};return a}();f.MapWithDefault=a}),66);
__d("WAMediaQplHelper",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null||a<0||a>100*1024*1024)return"invalid_size";else if(a<=1*1024)return"size lower than 1 KB";else if(a<=50*1024)return"size between 1 KB and 50 KB";else if(a<=100*1024)return"size between 50 KB and 100 KB";else if(a<=500*1024)return"size between 100 KB and 500 KB";else if(a<=1*1024*1024)return"size between 500 KB and 1 MB";else if(a<=2*1024*1024)return"size between 1 MB and 2 MB";else if(a<=5*1024*1024)return"size between 2 MB and 5 MB";else if(a<=10*1024*1024)return"size between 5 MB and 10 MB";else if(a<=20*1024*1024)return"size between 10 MB and 20 MB";else if(a<=30*1024*1024)return"size between 20 MB and 30 MB";else if(a<=50*1024*1024)return"size between 30 MB and 50 MB";else return"size above 50 MB"}f.convertIntegerSizeToStringBucket=a}),66);
__d("WAOfflineUtils",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["INIT","OFFLINE_RESUME","ONLINE"]);c=b("$InternalEnum")({Initializing:"initializing",Failed:"failed",Processing:"processing",Complete:"complete"});f.ServerRPCMode=a;f.WAClientInfraOfflineProgress=c}),66);
__d("WAPromiseTimeout",["Promise","WACustomError"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,c,e){var f=null,g=new(h||(h=b("Promise")))(function(a,b){f=setTimeout(function(){b(new(d("WACustomError").TimeoutError)(e)),clearTimeout(f)},c)});return h.race([a,g])["finally"](function(){clearTimeout(f)})};g.promiseTimeout=a}),98);/*FB_PKG_DELIM*/
__d("ACSCipherSuiteModule",[],(function(a,b,c,d,e,f){"use strict";b={hash:"SHA-512",name:"HMAC"};c={curveName:"RISTRETTO",macAlgorithm:b,value:1};var g=new Map([[c.value,c]]);function a(a){return g.has(a)?g.get(a):null}f.VOPRF_RISTRETTO_HMACSHA512=c;f.getACSCipherSuiteByValue=a}),66);
__d("ACSTokenHmacUtil",["XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h(a,b).then(function(a){return j(a,c)})}function h(a,b){return d("XPlatReactCrypto").subtleImportKey("raw",b,a,!1,["sign"]).then(function(b){return{algo:a,key:b}})}function i(a){return typeof a.hash==="string"?a.hash:a.hash.name}function j(a,b){var c=a.algo;a=a.key;c={hash:i(c),name:"HMAC"};return d("XPlatReactCrypto").subtleSign(c,a,b).then(function(a){return new Uint8Array(a)})}g.hmac=a}),98);
__d("LSACSExperimentCapability",[],(function(a,b,c,d,e,f){a=Object.freeze({RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:0,BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:1,INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:2});f["default"]=a}),66);
__d("LSBeginHandlingFireForgetTasksForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return c[0]=b.createArray(),b.forEach(b.filter(b.db.table(5).fetch(),function(b){return b.queueName===a[0]}),function(a){a=a.item;return c[3]=new b.Map(),c[3].set("label",a.context),c[3].set("payload",a.taskValue),c[3].set("queue_name",a.queueName),c[3].set("task_id",a.taskId),c[3].set("failure_count",b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))?void 0:b.i64.cast([0,0])),c[4]=(c[0].push(c[3]),c[0])})},function(e){return c[1]=new b.Map(),c[1].set("tasks",c[0]),c[1].set("epoch_id",void 0),c[2]=new b.Map(),c[2].set("queue_name",a[0]),c[2].set("next_sync_ms",void 0),c[2].set("work_item_type",b.i64.cast([0,5])),c[2].set("network_payload",c[1]),c[2].set("http_url_override",void 0),c[2].set("skip_realtime_gateway",!1),d[0]=c[2]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreBeginHandlingFireForgetTasksForQueueStoredProcedure";e.exports=a}),null);
__d("LSBeginHandlingFireForgetTasksForQueueStoredProcedure",["LSBeginHandlingFireForgetTasksForQueue","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.queueName;return c("LSBeginHandlingFireForgetTasksForQueue").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSForceTaskExecutionImmediately",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,c[1]=b.i64.of_float(Date.now()),b.i64.lt(c[1],e.minTimeToSyncTimestampMs)?b.forEach(b.db.table(2).fetch([[[a[0]]]]),function(a){var c=a.update;a=a.item;return c({minTimeToSyncTimestampMs:b.i64.cast([0,0]),failureCount:b.i64.add(a.failureCount,b.i64.cast([0,1]))})}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreForceTaskExecutionImmediatelyStoredProcedure";e.exports=a}),null);
__d("LSRemoveUsedTokens",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.filter(b.db.table(309).fetch(),function(a){return b.i64.le(a.redeemLimit,b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSAnonymousCredentialsRemoveUsedTokensStoredProcedure";e.exports=a}),null);
__d("LSGetCurrentTokenPoolState",["LSArrayGetObjectAt","LSRemoveBlindedTokens","LSRemoveUsedTokens"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),d[1]=c.createArray(),c.count(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]})).then(function(a){return d[2]=a})},function(b){return c.forEach(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]}),function(a){a=a.item;return d[7]=a.configId,c.i64.gt(d[0],a.expirationTimestampMs)?c.forEach(c.db.table(307).fetch([[[d[7]]]]),function(a){return a["delete"]()}):c.resolve(d[8]=(d[1].push(d[7]),d[1]))})},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[3]=c.i64.cast([0,0]),d[4]=c.i64.of_int32(d[1].length),c.i64.gt(d[4],c.i64.cast([0,0]))?c.loopAsync(d[4],function(a){return d[7]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[1],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return c.count(c.filter(c.db.table(309).fetch(),function(a){return a.configId===d[8]})).then(function(a){return d[10]=a})},function(a){return d[3]=c.i64.add(d[10],d[3]),c.storedProcedure(b("LSRemoveBlindedTokens"),d[8])}])}):c.resolve()},function(a){return c.i64.gt(d[2],c.i64.cast([0,0]))?(d[7]=c.i64.of_int32(d[1].length),d[5]=c.i64.ge(d[7],c.i64.cast([0,1]))):d[5]=void 0,d[5]!==void 0?(d[5]?(c.i64.gt(d[3],c.i64.cast([0,0]))?d[8]=c.i64.cast([0,3]):d[8]=c.i64.cast([0,2]),d[7]=d[8]):d[7]=c.i64.cast([0,1]),d[6]=d[7]):d[6]=c.i64.cast([0,0]),a=[d[6],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsGetCurrentTokenPoolStateStoredProcedure";e.exports=a}),null);
__d("LSIssueNextSync",["LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.count(c.filter(c.db.table(310).fetch(),function(b){return b.projectName===a[1]})).then(function(a){return d[0]=a})},function(e){return c.i64.gt(d[0],c.i64.cast([0,0]))&&a[3]===!0?c.resolve(0):c.sequence([function(b){return c.forEach(c.filter(c.db.table(310).fetch(),function(b){return b.projectName===a[1]}),function(a){return a["delete"]()})},function(e){return c.i64.gt(a[2],c.i64.cast([0,0]))?(d[3]=c.i64.of_float(Date.now()),d[1]=c.i64.add(d[3],a[2])):d[1]=c.i64.cast([0,0]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["acs_sync","_",a[1]].join(""),c.i64.cast([0,362]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[1],c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(310).add({taskId:d[2],projectName:a[1],maxClientTokenPoolSize:a[0]})}])}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsIssueNextSyncStoredProcedure";e.exports=a}),null);
__d("LSVoprfBlind.nop",["LSVoprfLoggingUtils","XPlatReactVoprf","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(25304788,"29");a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("LSVoprfLoggingUtils").getAcsQplEventLogger(h);a.start();b=(yield d("XPlatReactVoprf").loadXPlatReactVoprf());var e=b.instanceCreationTimestampNs;b=b.voprfInstance;var f=b.voprfInfo,g=b.voprfWasm;a.addVoprfLoadedPoint(e);try{e=g.blind(f,new Uint8Array(c));a.endSuccess({wasmMemorySize:(f=g.wasmMemory)==null?void 0:f.buffer.byteLength});return[e.blindedElement.buffer,e.blindingFactor.buffer]}catch(b){a.endFailure({error:b,wasmMemorySize:(c=g.wasmMemory)==null?void 0:c.buffer.byteLength});throw b}finally{d("XPlatReactVoprf").freeVoprfInstance(b)}});function c(b,c,d){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSVoprfCreateNonce.nop",["LSVoprfLoggingUtils","XPlatReactCrypto","XPlatReactVoprf","asyncToGeneratorRuntime","qex","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(25311408,"2543"),i=32;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=i;if(c("qex")._("2051")!==!0){b=d("LSVoprfLoggingUtils").getAcsQplEventLogger(h);b.start();var e=(yield d("XPlatReactVoprf").loadXPlatReactVoprf()),f=e.instanceCreationTimestampNs;e=e.voprfInstance;b.addVoprfLoadedPoint(f);f=e.voprfInfo;var g=e.voprfWasm;try{a=g.getCurveBytes(f);b.endSuccess({wasmMemorySize:(f=g.wasmMemory)==null?void 0:f.buffer.byteLength})}catch(a){b.endFailure({error:a,wasmMemorySize:(f=g.wasmMemory)==null?void 0:f.buffer.byteLength});throw a}finally{d("XPlatReactVoprf").freeVoprfInstance(e)}}b=new Uint8Array(a);d("XPlatReactCrypto").getRandomValues(b);return[b.buffer]});function e(b,c){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("LSTaskSerializerAcsIssueNextSync",["LSBase64Encode.nop","LSGetCurrentTokenPoolState","LSIssueNextSync","LSVoprfBlind.nop","LSVoprfCreateNonce.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.db.table(310).fetch([[[a[0]]]]).next().then(function(a,e){var f=a.done;a=a.value;return f?(function(a){c.logger(a).mustfix(a)}("Request context for the passed task_id was not found"),f=[void 0,void 0,void 0],d[0]=f[0],d[1]=f[1],d[2]=f[2],f):(e=a.item,c.sequence([function(a){return d[9]=e.projectName,d[10]=e.maxClientTokenPoolSize,c.storedProcedure(b("LSGetCurrentTokenPoolState"),d[9]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(a){return c.i64.eq(d[4],c.i64.cast([0,0]))||c.i64.eq(d[4],c.i64.cast([0,1]))?c.resolve((d[11]=new c.Map(),d[11].set("project_name",d[9]),d[12]=c.toJSON(d[11]),a=[d[12],c.i64.cast([0,351]),void 0],d[6]=a[0],d[7]=a[1],d[8]=a[2],a)):c.sequence([function(a){return d[11]=c.i64.of_float(Date.now()),c.islc(c.sortBy(c.filter(c.db.table(307).fetch(),function(a){return a.projectName===d[9]&&c.i64.gt(a.expirationTimestampMs,d[11])}),[["expirationTimestampMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("A config for the passed project name was not found"),d[16]=new c.Map(),d[16].set("project_name",d[9]),d[16].set("max_client_token_pool_size",d[10]),d[17]=c.toJSON(d[16]),a=[d[17],c.i64.cast([0,362]),void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],a):(f=e.item,c.sequence([function(a){return d[24]=f.configId,d[16]=f.maxEvals,d[26]=f.tokenPollFrequencyMs,d[25]=f.maxClientTokenPoolSize,d[17]=c.i64.sub(d[10],d[5]),d[23]=c.i64.lt(d[16],d[17])?d[16]:d[17],d[18]=c.createArray(),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(a){return d[27]=a,c.sequence([function(a){return c.nativeOperation(b("LSVoprfCreateNonce.nop")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.blobs.neq(d[28],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSVoprfBlind.nop"),d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return c.blobs.neq(d[29],void 0)?c.blobs.neq(d[30],void 0)?c.sequence([function(a){return d[31]=c.i64.cast([-1,4294967295]),c.db.table(308).peekNextAutoIncrementId().then(function(a){return d[31]=a})},function(a){return c.db.table(308).add({tokenId:void 0,blindedNonce:d[29],blindingFactor:d[30],nonce:d[28],configId:d[24]})},function(a){return c.db.table(308).fetch([[[d[31]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[32]=c.i64.cast([-1,4294967295]):(e=b.item,d[32]=e.tokenId)})},function(a){return c.i64.eq(d[32],c.i64.cast([-1,4294967295]))?c.sequence([function(a){return c.islc(c.db.table(308).fetchDesc([[[{gt:c.i64.cast([0,0])}]]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,e){var a=b.done;b=b.value;return a?d[37]=c.i64.cast([-1,4294967295]):(e=b.item,d[37]=e.tokenId)})},function(a){return d[34]=d[37]}]):c.resolve(d[34]=d[32])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[29]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[36]=new c.Map(),d[36].set("id",d[34]),d[36].set("data",d[35]==null?"":d[35]),d[37]=(d[18].push(d[36]),d[18])}]):c.resolve():c.resolve()}]):c.resolve()}])}):c.resolve()},function(a){return d[19]=c.i64.of_int32(d[18].length),c.i64.gt(d[19],c.i64.cast([0,0]))?c.resolve((d[27]=new c.Map(),d[27].set("project_name",d[9]),d[27].set("config_id",d[24]),d[27].set("blinded_nonces",d[18]),d[28]=c.toJSON(d[27]),a=[d[28],c.i64.cast([0,354]),void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a)):c.sequence([function(a){return c.i64.neq(d[26],void 0)?c.sequence([function(a){return c.i64.neq(d[25],void 0)?c.sequence([function(a){return function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling next ACS token sync locally for project: ",d[9]].join("")),c.storedProcedure(b("LSIssueNextSync"),d[25],d[9],d[26],!1)},function(a){return a=[void 0,void 0,void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["token_poll_frequency is nonnull but max_client_token_pool_size is null. Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[33]=new c.Map(),d[33].set("project_name",d[9]),d[33].set("max_client_token_pool_size",d[10]),d[34]=c.toJSON(d[33]),a=[d[34],c.i64.cast([0,362]),void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2],a))},function(a){return a=[d[30],d[31],d[32]],d[27]=a[0],d[28]=a[1],d[29]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[30]=new c.Map(),d[30].set("project_name",d[9]),d[30].set("max_client_token_pool_size",d[10]),d[31]=c.toJSON(d[30]),a=[d[31],c.i64.cast([0,362]),void 0],d[27]=a[0],d[28]=a[1],d[29]=a[2],a))},function(a){return a=[d[27],d[28],d[29]],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}])},function(a){return a=[d[20],d[21],d[22]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}])},function(a){return a=[d[6],d[7],d[8]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}]))})},function(a){return a=[d[0],d[1],d[2]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerAcsIssueNextSyncStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerDeleteChatHistory",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerDeleteChatHistory: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerDeleteChatHistory: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2],d):(a.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,903]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerDeleteChatHistoryStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerE2eeMessageIntegrityCheckV2",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,705]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerE2eeMessageIntegrityCheckV2StoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerE2eeMetadataThreadIntegrityCheck",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,700]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSE2EEMessagingMetadataMailboxTaskSerializerE2eeMetadataThreadIntegrityCheckStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupAction",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,319]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsLoopingUpload",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] LSEncryptedBackupsLoopingUploadPayloadsTable table not found"),d[2]=c.createArray(),void 0!==void 0?d[9]=(d[2].push(void 0),d[2]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure","LSEncryptedBackupsLoopingUploadPayloadsTable table not found",d[2],c.i64.cast([0,3]))},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsLoopingUpload",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()},function(a){return a=['{"request_id":"unknown","upload_type":"FBN","payload":{"error_code":2,"operation":"","error_message":"","__typename":"MPSUploadFailurePayload"}}',c.i64.cast([0,50043]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure";e.exports=a}),null);
__d("LSQueryLocalPersistenceStoreForBackup.nop",["Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store).filter(function(a){var b=a.offlineThreadingId;a=a.threadId;return a===e&&f===b})));if(c.length===0)return(h||(h=b("Promise"))).resolve([void 0,void 0,!1]);a=c[0];return(h||(h=b("Promise"))).resolve([a.messagePayload,a.messageTimestampMs,!1])});function c(b,c,d,e){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSQueryLocalPersistenceStoreSupplementalForBackup.nop",["Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){c=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_supplemental).filter(function(a){var b=a.supplementalKey,c=a.threadId;a=a.toplevelOfflineThreadingId;return c===e&&a===f&&b===g})));return c==null?(h||(h=b("Promise"))).resolve([void 0,void 0]):(h||(h=b("Promise"))).resolve([c.messagePayload,c.messageTimestampMs])});function c(b,c,d,e,f){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("isInstamadilloOpenEB",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("890")===!0}g["default"]=a}),98);
__d("LSQueryLocalPersistenceStoreTagsForBackup.nop",["LSVec","Promise","ReQL","asyncToGeneratorRuntime","isInstamadilloEB","isInstamadilloOpenEB"],(function(a,b,c,d,e,f,g){"use strict";var h,i=":";a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(!c("isInstamadilloEB")()&&!c("isInstamadilloOpenEB")())return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray([])]);e=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_tag_index.index("offlineThreadingId")).getKeyRange(g,f)));if(e==null)return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray([])]);a=e.tag;return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray(a.split(i))])});function e(b,c,d,e){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("LSLoadUnencryptedProtobufWithInputs",["LSBase64Encode.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufWithInputs] Beginning execution."),d[1]=c.i64.of_float(Date.now()),!1===!0?c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error REQUIRED_COLUMN_NOT_PRESENT_ON_CLIENT"),d[10]=new c.Map(),d[10].set("error_code",c.i64.cast([-1,4294967293])),d[10].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[10].set("error_message",""),e=[void 0,d[10]],d[2]=e[0],d[3]=e[1],e)):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],d[14]=a[2],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[15]=a[0],a})},function(e){return c.blobs.neq(d[12],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[12]).then(function(a){return a=a,d[18]=a[0],a})},function(b){return d[18]!==void 0?(d[15]!==void 0?(d[23]=new c.Map(),d[23].set("message_tags",d[15]),d[24]=new c.Map(),d[28]="message_tags",d[25]=d[23].get(d[28]),d[23],d[25]?d[26]=!1:d[26]=!0,d[26]?0:d[24].set(d[28],d[25]),d[27]=c.toJSON(d[24]),d[21]=d[27]):d[21]=void 0,d[22]=new c.Map(),d[22].set("backup_action",a[0]),d[22].set("protobuf_encrypted",d[18]),d[22].set("supplemental_data_encrypted",void 0),d[22].set("timestamp_ms",a[4]),d[22].set("message_tags",d[21]),b=[d[22],void 0],d[19]=b[0],d[20]=b[1],b):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,68])),d[21].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[21].set("error_message",""),b=[void 0,d[21]],d[19]=b[0],d[20]=b[1],b),b=[d[19],d[20]],d[16]=b[0],d[17]=b[1],b}]):c.resolve((d[14]?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,70])),d[20].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1],e):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,63])),d[20].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1],e),e=[d[18],d[19]],d[16]=e[0],d[17]=e[1],e))},function(a){return a=[d[16],d[17]],d[10]=a[0],d[11]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))?c.sequence([function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[18]=a[0],a})},function(e){return c.blobs.neq(d[16],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,d[21]=a[0],a})},function(e){return c.blobs.neq(d[21],void 0)?c.sequence([function(a){return d[24]=new c.Map(),d[24].set("sk_ciphertext",d[21]),d[24].set("sk_hash",d[21]),c.nativeOperation(b("LSBase64Encode.nop"),d[16]).then(function(a){return a=a,d[25]=a[0],a})},function(b){return d[25]!==void 0?(d[18]!==void 0?(d[30]=new c.Map(),d[30].set("message_tags",d[18]),d[31]=new c.Map(),d[35]="message_tags",d[32]=d[30].get(d[35]),d[30],d[32]?d[33]=!1:d[33]=!0,d[33]?0:d[31].set(d[35],d[32]),d[34]=c.toJSON(d[31]),d[28]=d[34]):d[28]=void 0,d[29]=new c.Map(),d[29].set("backup_action",a[0]),d[29].set("protobuf_encrypted",d[25]),d[29].set("supplemental_data_encrypted",d[24]),d[29].set("timestamp_ms",a[4]),d[29].set("message_tags",d[28]),b=[d[29],void 0],d[26]=b[0],d[27]=b[1],b):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[28]=new c.Map(),d[28].set("error_code",c.i64.cast([0,68])),d[28].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[28].set("error_message",""),b=[void 0,d[28]],d[26]=b[0],d[27]=b[1],b),b=[d[26],d[27]],d[22]=b[0],d[23]=b[1],b}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_FORMATTING_FAILED"),d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,69])),d[24].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[24].set("error_message",""),e=[void 0,d[24]],d[22]=e[0],d[23]=e[1],e))},function(a){return a=[d[22],d[23]],d[19]=a[0],d[20]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,64])),d[21].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[21].set("error_message",""),e=[void 0,d[21]],d[19]=e[0],d[20]=e[1],e))},function(a){return a=[d[19],d[20]],d[14]=a[0],d[15]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,65])),d[16].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[16].set("error_message",""),e=[void 0,d[16]],d[14]=e[0],d[15]=e[1],e))},function(a){return a=[d[14],d[15]],d[12]=a[0],d[13]=a[1],a}]):c.resolve((c.i64.eq(a[0],c.i64.cast([0,3]))?(d[16]=new c.Map(),d[16].set("backup_action",a[0]),d[16].set("protobuf_encrypted",void 0),d[16].set("supplemental_data_encrypted",void 0),d[16].set("timestamp_ms",a[4]),d[16].set("message_tags",void 0),e=[d[16],void 0],d[14]=e[0],d[15]=e[1],e):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error INVALID_BACKUP_OPERATION"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([-1,4294967289])),d[16].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[16].set("error_message",""),e=[void 0,d[16]],d[14]=e[0],d[15]=e[1],e),e=[d[14],d[15]],d[12]=e[0],d[13]=e[1],e))},function(a){return a=[d[12],d[13]],d[10]=a[0],d[11]=a[1],a}])},function(a){return a=[d[10],d[11]],d[2]=a[0],d[3]=a[1],a}])},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufWithInputs] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufWithInputs",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure";e.exports=a}),null);
__d("LSLoadUnencryptedProtobufBackupSerializedPayloadData",["LSLoadUnencryptedProtobufWithInputs","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[19]=c.i64.mul(d[1],c.i64.cast([0,1e6])),c.db.table(2).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(d[23]=c.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f):(e=b.item,d[23]=c.i64.of_float(Date.now()),f=[a[0],e.queueName,e.enqueueTimestampMs,e.priority,e.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f)})},function(e){return d[10]=new c.Map(),d[10].set("task_id",d[2]),d[10].set("queue_name",d[3]),d[10].set("enqueue_timestamp_ms",d[4]),d[10].set("priority",d[5]),d[10].set("first_executed_timestamp_ms",d[6]),d[10].set("execution_time_ns",d[7]),d[10].set("echo_encoding_execution_time_ns",d[8]),d[11]=new c.Map(),d[11].set("task_metadata",d[10]),d[11].set("action_type",void 0),d[11].set("content_type",void 0),d[11].set("identifiers",void 0),d[11].set("identifiers_v2",void 0),d[11].set("task_creation_source",void 0),d[11].set("message_payload_source",c.i64.cast([0,2])),c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[23]=new c.Map(),d[23].set("error_code",c.i64.cast([0,5])),d[23].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure"),d[23].set("error_message",""),g=[void 0,d[23],d[11]],d[12]=g[0],d[13]=g[1],d[14]=g[2],g):(f=e.item,c.sequence([function(b){return d[41]=f.actThreadId,d[42]=f.toplevelOfflineThreadingId,d[24]=f.messageTimestampMs,d[23]=new c.Map(),d[23].set("backup_id","openEbUploadGenericBackupId"),d[23].set("act_thread_id",d[41]),d[23].set("server_thread_id",d[41]),d[23].set("timestamp",c.i64.to_string(d[24])),d[23].set("otid",d[42]),d[25]=new c.Map(),d[25].set("backup_id","openEbUploadGenericBackupId"),d[25].set("act_thread_id",d[41]),d[25].set("timestamp",c.i64.to_string(d[24])),d[25].set("otid",d[42]),c.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var b=e.done;e=e.value;return b?(d[43]=c.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[43],c.i64.cast([0,1e6])),d[19]),void 0],d[26]=b[0],d[27]=b[1],d[28]=b[2],d[29]=b[3],d[30]=b[4],d[31]=b[5],d[32]=b[6],b):(f=e.item,d[43]=c.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,f.priority,f.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[43],c.i64.cast([0,1e6])),d[19]),void 0],d[26]=b[0],d[27]=b[1],d[28]=b[2],d[29]=b[3],d[30]=b[4],d[31]=b[5],d[32]=b[6],b)})},function(a){return d[34]=new c.Map(),d[34].set("task_id",d[26]),d[34].set("queue_name",d[27]),d[34].set("enqueue_timestamp_ms",d[28]),d[34].set("priority",d[29]),d[34].set("first_executed_timestamp_ms",d[30]),d[34].set("execution_time_ns",d[31]),d[34].set("echo_encoding_execution_time_ns",d[32]),d[35]=new c.Map(),d[35].set("task_metadata",d[34]),d[35].set("action_type",void 0),d[35].set("content_type",void 0),d[35].set("identifiers",void 0),d[35].set("identifiers_v2",d[25]),d[35].set("task_creation_source",void 0),d[35].set("message_payload_source",c.i64.cast([0,2])),c.storedProcedure(b("LSLoadUnencryptedProtobufWithInputs"),f.backupAction,d[41],d[42],f.supplementalKey,d[24],d[23]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return d[36]!==void 0?(d[43]=new c.Map(),d[43].set("unencrypted_protobuf_backup_payload",d[36]),d[43].set("message_identifiers",d[23]),d[43].set("attachment_backup_payload",f.attachmentPayload),d[43].set("sender_id",f.senderId),d[43].set("extra_data_for_eb_upload",void 0),a=[d[43],void 0,d[35]],d[38]=a[0],d[39]=a[1],d[40]=a[2],a):(a=[void 0,d[37],d[35]],d[38]=a[0],d[39]=a[1],d[40]=a[2],a),a=[d[38],d[39],d[40]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return d[16]=c.i64.of_float(Date.now()),d[17]=c.i64.random(),d[20]="Finishing execution. Execution time: ",d[21]=c.i64.to_string(c.i64.sub(d[16],d[0])),d[22]=" ms",d[18]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] ",d[18],d[20],d[18],d[21],d[18],d[22]].join("")),c.i64.eq(c.i64.mod_(d[17],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[23]=",",d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufBackupSerializedPayloadData",[d[20],d[23],d[21],d[23],d[22]].join(""),d[24],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[12],d[13],d[14]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsOpenUpload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadUnencryptedProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSLoadUnencryptedProtobufBackupSerializedPayloadData"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],a})},function(a){return d[2]!==void 0?c.sequence([function(a){return d[15]=d[2].get("message_identifiers"),d[2],d[16]=d[2].get("unencrypted_protobuf_backup_payload"),d[2],d[17]=d[15].get("server_thread_id"),d[15],d[18]=d[15].get("timestamp"),d[15],d[19]=d[15].get("otid"),d[15],d[20]=d[15].get("act_thread_id"),d[15],d[21]=new c.Map(),d[21].set("server_thread_key",d[17]),d[21].set("timestamp",d[18]),d[21].set("otid",d[19]),d[21].set("wa_thread_id",c.i64.from_string(d[20])),d[22]=new c.Map(),d[22].set("message_identifiers",d[21]),d[23]=d[2].get("extra_data_for_eb_upload"),d[2],d[23]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[23]).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[33]=new c.Map(),d[38]="ttd",d[34]=d[32].get(d[38]),d[32],d[34]?d[35]=!1:d[35]=!0,d[35]?c.resolve():c.sequence([function(a){return d[34]?d[40]=!1:d[40]=!0,d[40]?c.resolve(d[41]=void 0):c.sequence([function(a){return d[42]=new c.Map(),d[45]="message_tags",d[43]=d[34].get(d[45]),d[34],d[43]?d[44]=!1:d[44]=!0,d[44]?c.resolve():c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[43].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[46].push(d[49]),d[46])}])}):c.resolve()},function(a){return d[42].set(d[45],d[46])}])},function(a){return d[41]=d[42]}])},function(a){return d[33].set(d[38],d[41])}])},function(a){return d[39]="mt",d[36]=d[32].get(d[39]),d[32],d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve():c.sequence([function(a){return d[36]?d[40]=!1:d[40]=!0,d[40]?c.resolve(d[41]=void 0):c.sequence([function(a){return d[42]=new c.Map(),d[45]="message_tags",d[43]=d[36].get(d[45]),d[36],d[43]?d[44]=!1:d[44]=!0,d[44]?c.resolve():c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[43].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[46].push(d[49]),d[46])}])}):c.resolve()},function(a){return d[42].set(d[45],d[46])}])},function(a){return d[41]=d[42]}])},function(a){return d[33].set(d[39],d[41])}])},function(a){return d[24]=d[33]}]):c.resolve(d[24]=void 0)},function(a){return d[24]!==void 0?(d[32]=d[24].get("mt"),d[24],d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[32],d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[25]=d[33]):d[25]=void 0,d[26]=d[16].get("supplemental_data_encrypted"),d[16],d[26]!==void 0?c.sequence([function(a){return d[32]=d[16].get("protobuf_encrypted"),d[16],d[33]=d[16].get("backup_action"),d[16],d[34]=d[16].get("timestamp_ms"),d[16],d[35]=d[26].get("sk_ciphertext"),d[26],c.nativeOperation(b("LSBase64Encode.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[37]=d[26].get("sk_hash"),d[26],c.nativeOperation(b("LSBase64Encode.nop"),d[37]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[39]=new c.Map(),d[39].set("supplementary_data_key",void 0),d[39].set("encrypted_protobuf",d[32]),d[39].set("key_value_backup_action",d[33]),d[39].set("protobuf_ts_ms",d[34]),d[39].set("supplemental_key_ciphertext",d[36]),d[39].set("supplemental_key_hash",d[38]),d[39].set("message_tags",d[25]),d[27]=d[39]}]):c.resolve((d[32]=d[16].get("protobuf_encrypted"),d[16],d[33]=d[16].get("backup_action"),d[16],d[34]=d[16].get("timestamp_ms"),d[16],d[35]=new c.Map(),d[35].set("supplementary_data_key",void 0),d[35].set("encrypted_protobuf",d[32]),d[35].set("key_value_backup_action",d[33]),d[35].set("protobuf_ts_ms",d[34]),d[35].set("message_tags",d[25]),d[27]=d[35]))},function(a){return d[22].set("key_value_backup_unencrypted_payload",d[27]),d[28]=d[2].get("sender_id"),d[2],d[22].set("sender_id",d[28]),d[29]=d[2].get("attachment_backup_payload"),d[2],d[29]!==void 0?d[22].set("attachment_backup_payload",d[29]):0,d[24]!==void 0?(d[32]=d[24].get("ttd"),d[24],d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[32],d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[30]=d[33]):d[30]=void 0,d[30]!==void 0?d[22].set("tags_to_delete",d[30]):0,d[31]=c.toJSON(d[22]),a=[d[31],void 0,d[4]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a}]):c.resolve((d[3]?d[15]=!1:d[15]=!0,d[15]?(a=[void 0,void 0,d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a):(a=[void 0,d[3],d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a),a=[d[16],d[17],d[18]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a))},function(a){return d[15]=new c.Map(),d[16]=d[15].set("success",d[5]),d[17]=d[15].set("failure",d[6]),d[18]=d[15].set("context",d[7]),d[19]=c.toJSON(d[15]),d[8]=d[19],d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsOpenUpload",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[8],c.i64.cast([0,50048])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsOpenUploadStoredProcedure";e.exports=a}),null);
__d("LSGetOpenEpochKeys",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSCreateDataTrace","LSCreateDataTraceID.nop","LSDeleteBackupOnClient","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Beginning execution."),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))&&c.i64.eq(a.backupTenancy,c.i64.cast([0,2]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?d[1]=!1:(a.item,d[1]=!0)})},function(a){return d[1]?d[3]=c.i64.or_(c.i64.cast([0,90]),c.i64.cast([0,128])):d[3]=c.i64.cast([0,90]),c.sequence([function(a){return c.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.sequence([function(a){return d[24]="EncryptedBackups MCD Trace ID",d[25]=c.i64.to_string(d[3]),d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",d[23],d[24],d[23],d[25]].join("")),c.resolve()},function(a){return c.storedProcedure(b("LSCreateDataTrace"),d[20],void 0,void 0,"get_open_epoch_keys",d[3])}])},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()},function(a){return d[4]=d[20]}])},function(b){return d[15]="Querying latest epoch keys with authority level: ",a[0]?d[5]="OPTIMISTIC":d[5]="AUTHORITATIVE",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[6],d[15],d[6],d[5]].join("")),c.resolve()},function(e){return a[0]?d[7]="OPTIMISTIC":d[7]="AUTHORITATIVE",c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2842]),c.i64.cast([0,2]),void 0,d[7]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2844]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(b){return d[8]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(b){return a[0]||c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[20]=(d[8].push(c.blobs.to_string(a.epochAnonIdBlob)),d[8])})},function(a){return d[9]=c.i64.of_int32(d[8].length),c.i64.gt(d[9],c.i64.cast([0,0]))?c.sequence([function(a){return d[20]=c.i64.of_int32(d[8].length),c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2845]),c.i64.cast([0,2]),void 0,c.i64.to_string(d[20])):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[25]?d[26]=!0:d[26]=!1,d[26]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[27]=c.createArray(),void 0!==void 0?d[28]=(d[27].push(void 0),d[27]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[27],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[8],c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],d[22]=a[1],a})},function(a){return d[23]=d[21],d[24]=c.i64.of_int32(d[8].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.loopAsync(d[24],function(a){return d[25]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[8],d[25]).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],a})},function(a){return c.i64.eq([0,d[23].length],[0,d[26].length])?(d[23]===d[26]?d[29]=d[23]:(d[23]>d[26]?d[30]=d[23]:d[30]=d[26],d[29]=d[30]),d[28]=d[29]):(c.i64.gt([0,d[23].length],[0,d[26].length])?d[29]=d[23]:d[29]=d[26],d[28]=d[29]),d[23]=d[28]}])}):c.resolve()},function(a){return d[10]=d[23]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Epoch anon ID list is empty."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","Epoch anon ID list is empty.",d[20],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2846]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[10]=void 0}])},function(a){return d[10]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2863]),c.i64.cast([0,2]),void 0,d[10]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}]):c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2864]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[16]=c.blobs.of_string(d[10]),c.blobs.neq(d[16],void 0)?c.sequence([function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2847]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[23]=!0:d[23]=!1,d[23]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,d[16])}).next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Found a most recent epoch anon ID, but unable to locate it again in the table. This can really only happen if the tablesomehow changed in the middle of our transaction."),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","Found a most recent epoch anon ID, but unable to locate it again in the table. This can really only happen if the tablesomehow changed in the middle of our transaction.",d[22],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2848]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[24]=!0:d[24]=!1,d[24]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[25]=c.createArray(),void 0!==void 0?d[26]=(d[25].push(void 0),d[25]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[25],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[20]=void 0}]):(e=a.item,c.sequence([function(a){return d[26]=e.epochAnonIdBlob,d[24]="Using latest epoch: ",d[25]=c.blobs.to_string(d[26]),d[22]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[22],d[24],d[22],d[25]].join("")),c.resolve()},function(a){return d[23]=new c.Map(),d[23].set("epoch_id",e.epochId),d[23].set("epoch_root_key",e.epochRootKeyBlob),d[23].set("epoch_anon_id",d[26]),d[20]=d[23]}]))})},function(a){return d[11]=d[20]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] No epochs whatsoever on client! This should absolutely never happen. Deleting backup from client."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","No epochs whatsoever on client! This should absolutely never happen. Deleting backup from client.",d[20],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2843]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.storedProcedure(b("LSDeleteBackupOnClient"),void 0,"get_open_epoch_keys",!0,d[4],"Attempted to fetch epoch keys when there are no epochs on the client.",!1)},function(a){return d[11]=void 0}])},function(a){return d[12]=c.i64.of_float(Date.now()),d[13]=c.i64.random(),d[17]="Finishing execution. Execution time: ",d[18]=c.i64.to_string(c.i64.sub(d[12],d[0])),d[19]=" ms",d[14]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[14],d[17],d[14],d[18],d[14],d[19]].join("")),c.i64.eq(c.i64.mod_(d[13],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[20]=",",d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure",[d[17],d[20],d[18],d[20],d[19]].join(""),d[21],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[11]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsGetOpenEpochKeysStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsRestoreWithSerializer",["LSAppendDataTraceAddon","LSBase64Encode.nop","LSGetOpenEpochKeys","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Beginning execution."),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Fetching locally available epochs on client from epochs table"),d[1]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[16]=(d[1].push(a.epochId),d[1])})},function(a){return d[11]="Queried locally available epochs. Count: ",d[2]=c.i64.of_int32(d[1].length),d[12]=c.i64.to_string(d[2]),d[3]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[3],d[11],d[3],d[12]].join("")),c.resolve()},function(e){return c.db.table(168).fetch().next().then(function(e,f){var g=e.done;e=e.value;return g?(g=[void 0,void 0,void 0],d[4]=g[0],d[5]=g[1],d[6]=g[2],g):(f=e.item,c.sequence([function(e){return d[19]=f.deviceId,c.i64.neq(d[19],void 0)?c.sequence([function(e){return c.db.table(190).fetch([[[a[0]]]]).next().then(function(e,h){var a=e.done;e=e.value;return a?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] No restore payload context found."),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","No restore payload context found.",d[24],c.i64.cast([0,3]))},function(a){return a=[void 0,void 0,void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}]):(h=e.item,c.sequence([function(a){return d[32]=h.traceId,c.sequence([function(a){return d[32]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[32],c.i64.cast([0,3603]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[33]?d[34]=!0:d[34]=!1,d[34]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[35]=c.createArray(),void 0!==void 0?d[36]=(d[35].push(void 0),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[35],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[24]=new c.Map(),d[24].set("server_thread_key",h.serverThreadKey),d[24].set("otid",h.messageId),d[24].set("timestamp",h.unencryptedSortKey),d[24].set("wa_thread_id",h.waThreadId),c.nativeOperation(b("LSBase64Encode.nop"),f.ocmfClientStateBlob).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.mailboxRootKeyBlob).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),c.storedProcedure(b("LSGetOpenEpochKeys"),!1).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]!==void 0?(d[33]=d[28].get("epoch_id"),d[28],d[29]=d[33]):d[29]=void 0,d[30]=new c.Map(),d[30].set("content_type",h.contentType),d[30].set("device_id",d[19]),d[30].set("epoch_id",d[29]),d[30].set("list_id",h.listId),d[30].set("num_items",h.numItems),d[30].set("start_sort_key",h.startSortKey),d[30].set("mailbox_partial_id",h.mailboxPartialId),d[30].set("trace_id",d[32]),d[30].set("message_partial_id",h.messagePartialId),d[30].set("newer_num_items",h.newerNumItems),d[30].set("locally_available_epochs",d[1]),d[30].set("raw_identifiers",d[24]),d[30].set("raw_tokens",d[27]),d[31]=c.toJSON(d[30]),a=[d[31],c.i64.cast([0,50015]),void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}]))})},function(a){return a=[d[20],d[21],d[22]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Unexpected error: Device ID is null."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","Unexpected error: Device ID is null.",d[20],c.i64.cast([0,3]))},function(a){return a=[void 0,void 0,void 0],d[16]=a[0],d[17]=a[1],d[18]=a[2],a}])},function(a){return a=[d[16],d[17],d[18]],d[4]=a[0],d[5]=a[1],d[6]=a[2],a}]))})},function(a){return d[8]=c.i64.of_float(Date.now()),d[9]=c.i64.random(),d[13]="Finishing execution. Execution time: ",d[14]=c.i64.to_string(c.i64.sub(d[8],d[0])),d[15]=" ms",d[10]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] ",d[10],d[13],d[10],d[14],d[10],d[15]].join("")),c.i64.eq(c.i64.mod_(d[9],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[16]=",",d[17]=c.createArray(),void 0!==void 0?d[18]=(d[17].push(void 0),d[17]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure",[d[13],d[16],d[14],d[16],d[15]].join(""),d[17],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[4],d[5],d[6]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure";e.exports=a}),null);
__d("LSDeriveValueSecretRefV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][deriveValueSecretRefV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),a[2],d[3]=d[2].get("encryption_version"),d[2],d[4]=d[2].get("epoch_anon_id"),d[2],d[5]=d[2].get("epoch_root_key"),d[2],d[6]=d[2].get("payload_key"),d[2],d[7]=c.createArray(),d[41]=(d[7].push(c.i64.cast([0,6])),d[7]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[8]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[8],void 0,d[4],d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!1:d[10]=!0,d[10]?c.resolve(d[11]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[11]=d[43]==null?"":d[43]}])},function(a){return d[12]=c.createArray(),d[41]=(d[12].push(c.i64.cast([0,6])),d[12]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[13]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[13],void 0,d[5],d[12]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!1:d[15]=!0,d[15]?c.resolve(d[16]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[14],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[16]=d[43]==null?"":d[43]}])},function(a){return d[17]=c.createArray(),d[41]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[6],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[21]=d[43]==null?"":d[43]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[22]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[22]==null?"":d[22],a[0]].join("")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[24]=c.createArray(),d[41]=(d[24].push(c.i64.cast([0,6])),d[24]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[25],void 0,d[23],d[24]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!1:d[27]=!0,d[27]?c.resolve(d[28]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[28]=d[43]==null?"":d[43]}])},function(a){return d[29]=":",c.blobs.neq(d[5],void 0)?c.sequence([function(a){return d[41]=c.createArray(),d[47]=(d[41].push(c.i64.cast([0,18])),d[41]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[5],d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]!==void 0?c.sequence([function(a){return d[47]=c.i64.of_int32(d[42].length),c.i64.ge(d[47],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[42],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[48]=d[49]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[49]=c.createArray(),void 0!==void 0?d[50]=(d[49].push(void 0),d[49]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[49],c.i64.cast([0,3]))},function(a){return d[48]=void 0}])},function(a){return d[43]=d[48]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[47]=c.createArray(),void 0!==void 0?d[48]=(d[47].push(void 0),d[47]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[47],c.i64.cast([0,3]))},function(a){return d[43]=void 0}])},function(a){return c.blobs.neq(d[43],void 0)?d[44]=!0:d[44]=!1,d[44]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[43]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]!==void 0?d[46]=d[45]:d[46]="encodingfailed",d[30]=d[46]}]):c.resolve(d[30]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[31]=a[0],a})},function(e){return d[32]=new c.Map(),d[32].set("encryption_version",d[3]),d[32].set("epoch_anon_id",d[31]==null?"":d[31]),d[32].set("message_encryption_values",[d[11],d[29],d[16],d[29],d[21],d[29],d[28]].join("")),d[32].set("root_key_fingerprint",d[30]),d[32].set("backup_id",a[1]),d[33]=c.toJSON(d[32]),d[34]=new c.Map(),d[34].set("value_secret_ref",d[33]),d[35]=c.i64.of_float(Date.now()),d[36]=c.i64.random(),d[38]="Finishing execution. Execution time: ",d[39]=c.i64.to_string(c.i64.sub(d[35],d[0])),d[40]=" ms",d[37]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][deriveValueSecretRefV2] ",d[37],d[38],d[37],d[39],d[37],d[40]].join("")),c.i64.eq(c.i64.mod_(d[36],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[41]=",",d[42]=c.createArray(),void 0!==void 0?d[43]=(d[42].push(void 0),d[42]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"deriveValueSecretRefV2",[d[38],d[41],d[39],d[41],d[40]].join(""),d[42],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[34],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeriveValueSecretRefV2StoredProcedure";e.exports=a}),null);
__d("LSEncryptIdentifiersV2",["LSBase64Encode.nop","LSBinaryToHex.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptIdentifiersV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),a[2]).then(function(a){return a=a,d[3]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[3]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[2],d[4]).then(function(a){return a=a,d[5]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[6]=a[0],a})},function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))&&c.i64.eq(a[1],c.i64.cast([0,2]))?d[7]=a[5]:d[7]=a[3],d[8]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[9]).then(function(a){return a=a,d[10]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[8],d[10]).then(function(a){return a=a,d[11]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[11]).then(function(a){return a=a,d[12]=a[0],a})},function(e){return d[13]=a[6].get("ope_key"),a[6],c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[4]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[13],d[15],c.i64.cast([0,16])).then(function(a){return a=a,d[16]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[16]).then(function(a){return a=a,d[17]=a[0],a})},function(e){return d[18]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[19]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[18],d[20]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[21]).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[23]=new c.Map(),d[23].set("backup_id_ocmf_partial",d[6]==null?"":d[6]),d[23].set("act_thread_id_ocmf_partial",d[12]==null?"":d[12]),d[23].set("timestamp_encrypted",d[17]==null?"":d[17]),d[23].set("otid_ocmf_partial",d[22]==null?"":d[22]),d[24]=c.i64.of_float(Date.now()),d[25]=c.i64.random(),d[27]="Finishing execution. Execution time: ",d[28]=c.i64.to_string(c.i64.sub(d[24],d[0])),d[29]=" ms",d[26]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptIdentifiersV2] ",d[26],d[27],d[26],d[28],d[26],d[29]].join("")),c.i64.eq(c.i64.mod_(d[25],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[30]=",",d[31]=c.createArray(),void 0!==void 0?d[32]=(d[31].push(void 0),d[31]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptIdentifiersV2",[d[27],d[30],d[28],d[30],d[29]].join(""),d[31],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[23],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptIdentifiersV2StoredProcedure";e.exports=a}),null);
__d("LSSymmetricEncryptionCreateEncryptedData.nop",["CryptoLogger","EncryptedBackupsSymmetricEncryptionUtils","HChaCha20","Promise","RetUtil","SymmetricEncryptionPaddingUtils","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,c,e,f,g){var i=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_encrypted_data"),j=d("SymmetricEncryptionPaddingUtils").padData(g),k=d("XPlatReactCrypto").getRandomValues(new Uint8Array(d("EncryptedBackupsSymmetricEncryptionUtils").totalNonceLengthInBytes));a=new(d("HChaCha20").HChaCha20)();c=a.hChaCha20Bytes(k.slice(0,d("EncryptedBackupsSymmetricEncryptionUtils").hChaCha20SubKeyNonceLengthInBytes).buffer,e);return d("XPlatReactCrypto").subtleImportKey("raw",c,"AES-GCM",!1,["encrypt"]).then(function(a){return d("XPlatReactCrypto").subtleEncrypt({additionalData:f,iv:new Uint8Array(k.slice(d("EncryptedBackupsSymmetricEncryptionUtils").hChaCha20SubKeyNonceLengthInBytes).buffer),name:"AES-GCM",tagLength:d("EncryptedBackupsSymmetricEncryptionUtils").aesGcmTagLength},a,j)}).then(function(a){var c=k.byteLength+a.byteLength;c=new Uint8Array(c);c.set(k);c.set(new Uint8Array(a),d("EncryptedBackupsSymmetricEncryptionUtils").totalNonceLengthInBytes);return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(c.buffer))})["catch"](function(a){d("CryptoLogger").captureError(i,a).mustfix("symmetric data encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult())})};g["default"]=a}),98);
__d("LSSymmetricEncryptionCreateEncryptedString.nop",["Base64Utils","CryptoLogger","LSCryptoUtils","LSSymmetricEncryptionCreateEncryptedData.nop","Promise","RetUtil"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f,g,i){var j=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_encrypted_string");return c("LSSymmetricEncryptionCreateEncryptedData.nop")(a,e,f,g,d("LSCryptoUtils").strToBuf(i)).then(function(a){return a[0]}).then(function(a){return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(a?d("Base64Utils").fromArrayBuffer(a):void 0))})["catch"](function(a){d("CryptoLogger").captureError(j,a).mustfix("symmetric string encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult())})};g["default"]=a}),98);
__d("LSEncryptMessagePayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptMessagePayloadV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),a[2],d[3]=d[2].get("payload_key"),d[2],c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),d[3],c.blobs.of_string(["message_thread","_",a[1]].join("")),a[3]).then(function(a){return a=a,d[4]=a[0],a})},function(e){return d[4]!==void 0?c.sequence([function(a){return d[13]=d[2].get("encryption_version"),d[2],d[14]=d[2].get("epoch_anon_id"),d[2],d[15]=d[2].get("epoch_root_key"),d[2],d[16]=d[2].get("payload_key"),d[2],d[17]=c.createArray(),d[45]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[14],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[21]=d[47]==null?"":d[47]}])},function(a){return d[22]=c.createArray(),d[45]=(d[22].push(c.i64.cast([0,6])),d[22]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[23]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[23],void 0,d[15],d[22]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!1:d[25]=!0,d[25]?c.resolve(d[26]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[24],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[26]=d[47]==null?"":d[47]}])},function(a){return d[27]=c.createArray(),d[45]=(d[27].push(c.i64.cast([0,6])),d[27]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[28],void 0,d[16],d[27]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]?d[30]=!1:d[30]=!0,d[30]?c.resolve(d[31]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[31]=d[47]==null?"":d[47]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[15]).then(function(a){return a=a,d[32]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[32]==null?"":d[32],a[1]].join("")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=c.createArray(),d[45]=(d[34].push(c.i64.cast([0,6])),d[34]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[35],void 0,d[33],d[34]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve(d[38]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[38]=d[47]==null?"":d[47]}])},function(a){return d[39]=":",c.blobs.neq(d[15],void 0)?c.sequence([function(a){return d[45]=c.createArray(),d[51]=(d[45].push(c.i64.cast([0,18])),d[45]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[15],d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]!==void 0?c.sequence([function(a){return d[51]=c.i64.of_int32(d[46].length),c.i64.ge(d[51],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],c.i64.cast([0,0])).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[52]=d[53]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[53]=c.createArray(),void 0!==void 0?d[54]=(d[53].push(void 0),d[53]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[53],c.i64.cast([0,3]))},function(a){return d[52]=void 0}])},function(a){return d[47]=d[52]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[51]=c.createArray(),void 0!==void 0?d[52]=(d[51].push(void 0),d[51]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[51],c.i64.cast([0,3]))},function(a){return d[47]=void 0}])},function(a){return c.blobs.neq(d[47],void 0)?d[48]=!0:d[48]=!1,d[48]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[47]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[49]!==void 0?d[50]=d[49]:d[50]="encodingfailed",d[40]=d[50]}]):c.resolve(d[40]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[14]).then(function(a){return a=a,d[41]=a[0],a})},function(b){return d[42]=new c.Map(),d[42].set("encryption_version",d[13]),d[42].set("epoch_anon_id",d[41]==null?"":d[41]),d[42].set("message_encryption_values",[d[21],d[39],d[26],d[39],d[31],d[39],d[38]].join("")),d[42].set("root_key_fingerprint",d[40]),d[42].set("backup_id",a[0]),d[43]=c.toJSON(d[42]),d[44]=new c.Map(),d[44].set("encrypted_message_payload",d[4]),d[44].set("value_secret_ref",d[43]),b=[d[44],void 0],d[5]=b[0],d[6]=b[1],b}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,40])),d[13].set("stored_procedure","LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure"),d[13].set("error_message",""),e=[void 0,d[13]],d[5]=e[0],d[6]=e[1],e))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptMessagePayloadV2] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptMessagePayloadV2",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure";e.exports=a}),null);
__d("LSGetLatestEpochKeys",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][getLatestEpochKeys] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]="",d[3]=void 0,d[4]=void 0,a[0]?c.resolve(0):(d[14]=void 0,c.i64.neq(d[14],void 0)?c.db.table(169).fetch([[[d[14]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[2]=c.blobs.to_string(b.epochAnonIdBlob),d[3]=b.epochId,d[4]=b.epochRootKeyBlob)}):c.resolve())},function(b){return c.i64.neq(d[3],void 0)?c.resolve(0):c.forEach(c.filter(c.db.table(169).fetch(),function(b){return a[0]||c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[15]=c.blobs.to_string(a.epochAnonIdBlob),c.i64.eq([0,d[15].length],[0,d[2].length])?d[14]=d[15]>d[2]:d[14]=c.i64.gt([0,d[15].length],[0,d[2].length]),d[14]?(d[2]=d[15],d[3]=a.epochId,d[4]=a.epochRootKeyBlob,d[16]=c.i64.of_float(Date.now()),0):0})},function(a){return d[10]=c.blobs.of_string(d[2]),c.i64.neq(d[3],void 0)?(c.blobs.neq(d[10],void 0)?(c.blobs.neq(d[4],void 0)?(d[18]=new c.Map(),d[18].set("epoch_id",d[3]),d[18].set("epoch_root_key",d[4]),d[18].set("epoch_anon_id",d[10]),d[19]=new c.Map(),d[19].set("epoch_keys",d[18]),a=[d[19],void 0],d[16]=a[0],d[17]=a[1],a):(d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,402])),d[18].set("error_message","failed to query latest epoch"),d[18].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[18]],d[16]=a[0],d[17]=a[1],a),a=[d[16],d[17]],d[14]=a[0],d[15]=a[1],a):(d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,403])),d[16].set("error_message","failed to query latest epoch"),d[16].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[16]],d[14]=a[0],d[15]=a[1],a),a=[d[14],d[15]],d[5]=a[0],d[6]=a[1],a):(d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,400])),d[14].set("error_message","failed to query latest epoch"),d[14].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[14]],d[5]=a[0],d[6]=a[1],a),d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[11]="Finishing execution. Execution time: ",d[12]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[13]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][getLatestEpochKeys] ",d[9],d[11],d[9],d[12],d[9],d[13]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[14]=",",d[15]=c.createArray(),void 0!==void 0?d[16]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"getLatestEpochKeys",[d[11],d[14],d[12],d[14],d[13]].join(""),d[15],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsGetLatestEpochKeysStoredProcedure";e.exports=a}),null);
__d("LSLoadAndEncryptProtobufWithInputsV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop","LSSymmetricEncryptionCreateEncryptedData.nop","gkx","qex"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[8]=function(a){return a==void 0?void 0:a}(c("qex")._("1526")),e[8]!==void 0?e[2]=e[8]:e[2]=!1,(c("gkx")("23657")||c("gkx")("26375"))&&(e[2]||c("gkx")("26377")||c("gkx")("687"))?d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,1]))?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[14]=a[0],e[15]=a[1],e[16]=a[2],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[17]=a[0],a})},function(c){return d.blobs.neq(e[14],void 0)?d.sequence([function(c){return e[20]=a[5].get("message_payload_encryption_keys"),a[5],e[21]=e[20].get("payload_key"),e[20],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[21],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[14]).then(function(a){return a=a,e[22]=a[0],a})},function(a){return d.blobs.neq(e[22],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[22]).then(function(a){return a=a,e[26]=a[0],a})},function(a){return e[23]=e[26]}]):d.resolve(e[23]=void 0)},function(b){return e[23]!==void 0?(e[17]!==void 0?(e[28]=new d.Map(),e[28].set("message_tags",e[17]),e[29]=new d.Map(),e[33]="message_tags",e[30]=e[28].get(e[33]),e[28],e[30]?e[31]=!1:e[31]=!0,e[31]?0:e[29].set(e[33],e[30]),e[32]=d.toJSON(e[29]),e[26]=e[32]):e[26]=void 0,e[27]=new d.Map(),e[27].set("backup_action",a[0]),e[27].set("protobuf_encrypted",e[23]),e[27].set("supplemental_data_encrypted",void 0),e[27].set("timestamp_ms",a[4]),e[27].set("message_tags",e[26]),e[27].set("serialized_attachment_backup_payload",void 0),b=[e[27],void 0],e[24]=b[0],e[25]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,62])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),b=[void 0,e[26]],e[24]=b[0],e[25]=b[1],b),b=[e[24],e[25]],e[18]=b[0],e[19]=b[1],b}]):d.resolve((e[16]?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),e[22]=new d.Map(),e[22].set("error_code",d.i64.cast([0,70])),e[22].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[22].set("error_message",""),c=[void 0,e[22]],e[20]=c[0],e[21]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),e[22]=new d.Map(),e[22].set("error_code",d.i64.cast([0,63])),e[22].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[22].set("error_message",""),c=[void 0,e[22]],e[20]=c[0],e[21]=c[1],c),c=[e[20],e[21]],e[18]=c[0],e[19]=c[1],c))},function(a){return a=[e[18],e[19]],e[12]=a[0],e[13]=a[1],a}]):d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,2]))?d.sequence([function(c){return a[3]!==void 0?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,e[18]=a[0],e[19]=a[1],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[20]=a[0],a})},function(c){return d.blobs.neq(e[18],void 0)?d.sequence([function(c){return e[23]=a[5].get("mailbox_root_key_v2"),a[5],d.blobs.neq(e[23],void 0)?d.sequence([function(c){return e[26]=a[5].get("message_payload_encryption_keys"),a[5],e[27]=e[26].get("epoch_root_key"),e[26],e[28]=d.createArray(),e[41]=(e[28].push(d.i64.cast([0,32])),e[28]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfcHJmX2tleQ=="),void 0,e[23],e[28]).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]!==void 0?d.sequence([function(a){return e[41]=d.i64.of_int32(e[29].length),d.i64.ge(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[29],d.i64.cast([0,0])).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[42]=e[43]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[43]=d.createArray(),void 0!==void 0?e[44]=(e[43].push(void 0),e[43]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[43],d.i64.cast([0,3]))},function(a){return e[42]=void 0}])},function(a){return e[30]=e[42]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[41]=d.createArray(),void 0!==void 0?e[42]=(e[41].push(void 0),e[41]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[41],d.i64.cast([0,3]))},function(a){return e[30]=void 0}])},function(a){return d.blobs.neq(e[30],void 0)?e[31]=!0:e[31]=!1,e[31]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[32]=d.createArray(),e[41]=(e[32].push(d.i64.cast([0,32])),e[32]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,e[27],e[32]).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]!==void 0?d.sequence([function(a){return e[41]=d.i64.of_int32(e[33].length),d.i64.ge(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[33],d.i64.cast([0,0])).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[42]=e[43]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[43]=d.createArray(),void 0!==void 0?e[44]=(e[43].push(void 0),e[43]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[43],d.i64.cast([0,3]))},function(a){return e[42]=void 0}])},function(a){return e[34]=e[42]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[41]=d.createArray(),void 0!==void 0?e[42]=(e[41].push(void 0),e[41]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[41],d.i64.cast([0,3]))},function(a){return e[34]=void 0}])},function(c){return d.blobs.neq(e[34],void 0)?e[35]=!0:e[35]=!1,e[35]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,e[36]=a[0],a})},function(a){return d.nativeOperation(b("LSHmac_v2.nop"),e[30],e[36]).then(function(a){return a=a,e[37]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[34],d.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),e[36]).then(function(a){return a=a,e[38]=a[0],a})},function(c){return d.blobs.neq(e[38],void 0)?d.sequence([function(c){return e[41]=new d.Map(),e[41].set("sk_ciphertext",e[38]),e[41].set("sk_hash",e[37]),e[42]=a[5].get("message_payload_encryption_keys"),a[5],e[43]=e[42].get("payload_key"),e[42],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[43],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[18]).then(function(a){return a=a,e[44]=a[0],a})},function(a){return d.blobs.neq(e[44],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[44]).then(function(a){return a=a,e[48]=a[0],a})},function(a){return e[45]=e[48]}]):d.resolve(e[45]=void 0)},function(b){return e[45]!==void 0?(e[20]!==void 0?(e[50]=new d.Map(),e[50].set("message_tags",e[20]),e[51]=new d.Map(),e[55]="message_tags",e[52]=e[50].get(e[55]),e[50],e[52]?e[53]=!1:e[53]=!0,e[53]?0:e[51].set(e[55],e[52]),e[54]=d.toJSON(e[51]),e[48]=e[54]):e[48]=void 0,e[49]=new d.Map(),e[49].set("backup_action",a[0]),e[49].set("protobuf_encrypted",e[45]),e[49].set("supplemental_data_encrypted",e[41]),e[49].set("timestamp_ms",a[4]),e[49].set("message_tags",e[48]),e[49].set("serialized_attachment_backup_payload",void 0),b=[e[49],void 0],e[46]=b[0],e[47]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[48]=new d.Map(),e[48].set("error_code",d.i64.cast([0,62])),e[48].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[48].set("error_message",""),b=[void 0,e[48]],e[46]=b[0],e[47]=b[1],b),b=[e[46],e[47]],e[39]=b[0],e[40]=b[1],b}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_ENCRYPTION_FAILED"),e[41]=new d.Map(),e[41].set("error_code",d.i64.cast([0,66])),e[41].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[41].set("error_message",""),c=[void 0,e[41]],e[39]=c[0],e[40]=c[1],c))},function(a){return a=[e[39],e[40]],e[24]=a[0],e[25]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NULL_MAILBOX_ROOT_KEY_V2"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,27])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c))},function(a){return a=[e[24],e[25]],e[21]=a[0],e[22]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,64])),e[23].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[23].set("error_message",""),c=[void 0,e[23]],e[21]=c[0],e[22]=c[1],c))},function(a){return a=[e[21],e[22]],e[16]=a[0],e[17]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),e[18]=new d.Map(),e[18].set("error_code",d.i64.cast([0,65])),e[18].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[18].set("error_message",""),c=[void 0,e[18]],e[16]=c[0],e[17]=c[1],c))},function(a){return a=[e[16],e[17]],e[14]=a[0],e[15]=a[1],a}]):d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,4]))?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[18]=a[0],e[19]=a[1],e[20]=a[2],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[21]=a[0],a})},function(c){return d.blobs.neq(e[18],void 0)?d.sequence([function(c){return e[24]=a[5].get("message_payload_encryption_keys"),a[5],e[25]=e[24].get("payload_key"),e[24],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[25],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[18]).then(function(a){return a=a,e[26]=a[0],a})},function(a){return d.blobs.neq(e[26],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[26]).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[27]=e[30]}]):d.resolve(e[27]=void 0)},function(b){return e[27]!==void 0?(e[21]!==void 0?(e[32]=new d.Map(),e[32].set("message_tags",e[21]),e[33]=new d.Map(),e[37]="message_tags",e[34]=e[32].get(e[37]),e[32],e[34]?e[35]=!1:e[35]=!0,e[35]?0:e[33].set(e[37],e[34]),e[36]=d.toJSON(e[33]),e[30]=e[36]):e[30]=void 0,e[31]=new d.Map(),e[31].set("backup_action",a[0]),e[31].set("protobuf_encrypted",e[27]),e[31].set("supplemental_data_encrypted",void 0),e[31].set("timestamp_ms",a[4]),e[31].set("message_tags",e[30]),e[31].set("serialized_attachment_backup_payload",void 0),b=[e[31],void 0],e[28]=b[0],e[29]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[30]=new d.Map(),e[30].set("error_code",d.i64.cast([0,62])),e[30].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[30].set("error_message",""),b=[void 0,e[30]],e[28]=b[0],e[29]=b[1],b),b=[e[28],e[29]],e[22]=b[0],e[23]=b[1],b}]):d.resolve((e[20]?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,70])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,63])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c),c=[e[24],e[25]],e[22]=c[0],e[23]=c[1],c))},function(a){return a=[e[22],e[23]],e[16]=a[0],e[17]=a[1],a}]):d.resolve((d.i64.eq(a[0],d.i64.cast([0,3]))?(e[20]=new d.Map(),e[20].set("backup_action",a[0]),e[20].set("protobuf_encrypted",void 0),e[20].set("supplemental_data_encrypted",void 0),e[20].set("timestamp_ms",a[4]),e[20].set("message_tags",void 0),e[20].set("serialized_attachment_backup_payload",void 0),c=[e[20],void 0],e[18]=c[0],e[19]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error UNKNOWN"),e[20]=new d.Map(),e[20].set("error_code",d.i64.cast([0,603])),e[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[20].set("error_message",""),c=[void 0,e[20]],e[18]=c[0],e[19]=c[1],c),c=[e[18],e[19]],e[16]=c[0],e[17]=c[1],c))},function(a){return a=[e[16],e[17]],e[14]=a[0],e[15]=a[1],a}])},function(a){return a=[e[14],e[15]],e[12]=a[0],e[13]=a[1],a}])},function(a){return a=[e[12],e[13]],e[3]=a[0],e[4]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NOT_SUPPORTED_ON_WEB"),e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,7])),e[12].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[12].set("error_message",""),f=[void 0,e[12]],e[3]=f[0],e[4]=f[1],f))},function(a){return e[5]=d.i64.of_float(Date.now()),e[6]=d.i64.random(),e[9]="Finishing execution. Execution time: ",e[10]=d.i64.to_string(d.i64.sub(e[5],e[0])),e[11]=" ms",e[7]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] ",e[7],e[9],e[7],e[10],e[7],e[11]].join("")),d.i64.eq(d.i64.mod_(e[6],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[12]=",",e[13]=d.createArray(),void 0!==void 0?e[14]=(e[13].push(void 0),e[13]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufWithInputsV2",[e[9],e[12],e[10],e[12],e[11]].join(""),e[13],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[3],e[4]],f[0]=a[0],f[1]=a[1],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSLoadAndEncryptProtobufV2",["LSLoadAndEncryptProtobufWithInputsV2","LSLogMebClientEvent.nop","gkx","qex"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[8]=function(a){return a==void 0?void 0:a}(c("qex")._("1526")),e[8]!==void 0?e[2]=e[8]:e[2]=!1,(c("gkx")("23657")||c("gkx")("26375"))&&(e[2]||c("gkx")("26377")||c("gkx")("687"))?d.sequence([function(c){return d.filter(d.db.table(305).fetch(),function(b){return d.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(c,f){var g=c.done;c=c.value;return g?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error PROTOBUF_CONTEXT_ROW_NOT_FOUND"),e[15]=new d.Map(),e[15].set("error_code",d.i64.cast([0,67])),e[15].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),e[15].set("error_message",""),g=[void 0,e[15]],e[12]=g[0],e[13]=g[1],g):(f=c.item,d.sequence([function(c){return d.storedProcedure(b("LSLoadAndEncryptProtobufWithInputsV2"),f.backupAction,a[2],f.toplevelOfflineThreadingId,f.supplementalKey,f.messageTimestampMs,a[1]).then(function(a){return a=a,e[15]=a[0],e[16]=a[1],a})},function(a){return a=[e[15],e[16]],e[12]=a[0],e[13]=a[1],a}]))})},function(a){return a=[e[12],e[13]],e[3]=a[0],e[4]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error NOT_SUPPORTED_ON_WEB"),e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,7])),e[12].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),e[12].set("error_message",""),f=[void 0,e[12]],e[3]=f[0],e[4]=f[1],f))},function(a){return e[5]=d.i64.of_float(Date.now()),e[6]=d.i64.random(),e[9]="Finishing execution. Execution time: ",e[10]=d.i64.to_string(d.i64.sub(e[5],e[0])),e[11]=" ms",e[7]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufV2] ",e[7],e[9],e[7],e[10],e[7],e[11]].join("")),d.i64.eq(d.i64.mod_(e[6],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[12]=",",e[13]=d.createArray(),void 0!==void 0?e[14]=(e[13].push(void 0),e[13]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufV2",[e[9],e[12],e[10],e[12],e[11]].join(""),e[13],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[3],e[4]],f[0]=a[0],f[1]=a[1],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSLogWebQpl.nop",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LogWebQplNOP").__setRef("LSLogWebQpl.nop");a=function(a,b,c,d,e,f,g){return h.load().then(function(a){return a.call(c,d,e,f,g)})};g["default"]=a}),98);
__d("LSSerializeBackupPayloadV2",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDeriveValueSecretRefV2","LSEncryptIdentifiersV2","LSEncryptMessagePayloadV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSIsMobileClient","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop","LSLogWebQpl.nop","gkx","justknobx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][serializeBackupPayloadV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[9]=d.i64.mul(e[1],d.i64.cast([0,1e6])),(c("gkx")("23657")||c("gkx")("26375"))&&c("justknobx")._("1071")?d.sequence([function(f){return d.islc(d.filter(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))||!1}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(f,g){var h=f.done;f=f.value;return h?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[30]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[30],d.i64.cast([0,1e6])),e[9]),void 0],e[18]=b[0],e[19]=b[1],e[20]=b[2],e[21]=b[3],e[22]=b[4],e[23]=b[5],e[24]=b[6],b):(f=c.item,e[30]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[30],d.i64.cast([0,1e6])),e[9]),void 0],e[18]=b[0],e[19]=b[1],e[20]=b[2],e[21]=b[3],e[22]=b[4],e[23]=b[5],e[24]=b[6],b)})},function(a){return e[26]=new d.Map(),e[26].set("task_id",e[18]),e[26].set("queue_name",e[19]),e[26].set("enqueue_timestamp_ms",e[20]),e[26].set("priority",e[21]),e[26].set("first_executed_timestamp_ms",e[22]),e[26].set("execution_time_ns",e[23]),e[26].set("echo_encoding_execution_time_ns",e[24]),e[27]=new d.Map(),e[27].set("task_metadata",e[26]),e[27].set("action_type",void 0),e[27].set("content_type",void 0),e[27].set("identifiers",void 0),e[27].set("identifiers_v2",void 0),e[27].set("task_creation_source",void 0),e[27].set("message_payload_source",d.i64.cast([0,2])),e[28]=new d.Map(),e[28].set("error_code",d.i64.cast([0,1])),e[28].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[28].set("error_message",""),e[29]=d.createArray(),a=[void 0,e[28],e[27],e[29]],e[13]=a[0],e[14]=a[1],e[15]=a[2],e[16]=a[3],a}]):(g=f.item,d.sequence([function(a){return e[28]=g.mailboxRootKeyBlob,e[29]=g.deviceId,e[27]=g.backupTenancy,e[26]=g.encryptionVersion,e[18]=void 0,d.i64.neq(e[18],void 0)?d.resolve(e[19]=e[18]):d.sequence([function(a){return e[30]=d.createArray(),d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[31]?e[40]=(e[30].push(d.i64.cast([0,0])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[32]=a[0],a})},function(a){return e[32]?e[40]=(e[30].push(d.i64.cast([0,2])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[40]=(e[30].push(d.i64.cast([0,3])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[34]=a[0],a})},function(a){return e[34]?e[40]=(e[30].push(d.i64.cast([0,4])),e[30]):0,e[35]=d.createArray(),e[36]=d.i64.of_int32(e[30].length),d.i64.gt(e[36],d.i64.cast([0,0]))?d.loopAsync(e[36],function(a){return e[40]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[30],e[40]).then(function(a){return a=a,e[41]=a[0],e[42]=a[1],a})},function(a){return e[43]=(e[35].push(e[41]),e[35])}])}):d.resolve()},function(a){return d.sequence([function(a){return e[40]=d.createArray(),e[41]=d.i64.of_int32(e[35].length),d.i64.gt(e[41],d.i64.cast([0,0]))?d.loopAsync(e[41],function(a){return e[43]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[35],e[43]).then(function(a){return a=a,e[44]=a[0],e[45]=a[1],a})},function(a){return e[46]=(e[40].push(d.i64.to_string(e[44])),e[40])}])}):d.resolve()},function(a){return e[42]=e[40].join(","),e[37]=e[42]}])},function(a){return e[35].some(function(a){return d.i64.eq(e[26],a)})?e[38]=e[26]:e[38]=void 0,d.i64.neq(e[38],void 0)?e[39]=e[38]:e[39]=void 0,e[19]=e[39]}])},function(f){return d.i64.neq(e[19],void 0)?e[20]=e[19]:e[20]=d.i64.cast([0,0]),d.i64.neq(e[27],void 0)?e[21]=e[27]:e[21]=d.i64.cast([0,1]),d.i64.neq(e[29],void 0)?d.sequence([function(f){return d.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]).next().then(function(i,j){var f=i.done;i=i.value;return f?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[47]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[47],d.i64.cast([0,1e6])),e[9]),void 0],e[35]=b[0],e[36]=b[1],e[37]=b[2],e[38]=b[3],e[39]=b[4],e[40]=b[5],e[41]=b[6],b):(f=c.item,e[47]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[47],d.i64.cast([0,1e6])),e[9]),void 0],e[35]=b[0],e[36]=b[1],e[37]=b[2],e[38]=b[3],e[39]=b[4],e[40]=b[5],e[41]=b[6],b)})},function(a){return e[43]=new d.Map(),e[43].set("task_id",e[35]),e[43].set("queue_name",e[36]),e[43].set("enqueue_timestamp_ms",e[37]),e[43].set("priority",e[38]),e[43].set("first_executed_timestamp_ms",e[39]),e[43].set("execution_time_ns",e[40]),e[43].set("echo_encoding_execution_time_ns",e[41]),e[44]=new d.Map(),e[44].set("task_metadata",e[43]),e[44].set("action_type",void 0),e[44].set("content_type",void 0),e[44].set("identifiers",void 0),e[44].set("identifiers_v2",void 0),e[44].set("task_creation_source",void 0),e[44].set("message_payload_source",d.i64.cast([0,2])),e[45]=new d.Map(),e[45].set("error_code",d.i64.cast([0,5])),e[45].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[45].set("error_message","Pending backup context row not found"),e[46]=d.createArray(),a=[void 0,e[45],e[44],e[46]],e[30]=a[0],e[31]=a[1],e[32]=a[2],e[33]=a[3],a}]):(j=i.item,d.sequence([function(f){return e[40]=j.actionType,e[41]=j.contentType,e[45]=j.echoContent,e[43]=j.lsTraceId,e[44]=j.echoEncodingLatencyNs,e[42]=j.attachmentPayload,e[46]=j.tamThreadSubtype,e[47]=j.isInstamadillo,e[35]=new d.Map(),e[35].set("backup_id",d.i64.to_string(g.backupId)),e[35].set("act_thread_id",j.listKey),e[35].set("timestamp",j.sortKey),e[35].set("otid",j.uniqueKey),e[48]=j.error==null?d.i64.cast([0,0]):j.error,d.i64.eq(e[48],d.i64.cast([0,0]))?d.sequence([function(a){return e[49]=e[35].get("act_thread_id"),e[35],e[50]=e[35].get("otid"),e[35],d.storedProcedure(b("LSGetLatestEpochKeys"),!1).then(function(a){return a=a,e[51]=a[0],e[52]=a[1],a})},function(a){return e[51]!==void 0?d.sequence([function(a){return d.i64.eq(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return e[62]=d.createArray(),e[67]=(e[62].push(d.i64.cast([0,32])),e[62]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[49]].join("")).then(function(a){return a=a,e[63]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[63],void 0,e[28],e[62]).then(function(a){return a=a,e[64]=a[0],a})},function(a){return e[64]?e[65]=!1:e[65]=!0,e[65]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[67]=d.createArray(),void 0!==void 0?e[68]=(e[67].push(void 0),e[67]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",e[67],d.i64.cast([0,3]))},function(a){return e[66]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[64],d.i64.cast([0,0])).then(function(a){return a=a,e[67]=a[0],e[68]=a[1],a})},function(a){return e[66]=e[67]}])},function(a){return e[59]=e[66]}]):d.sequence([function(a){return d.i64.eq(e[40],d.i64.cast([0,2]))?d.sequence([function(a){return e[63]=d.createArray(),e[68]=(e[63].push(d.i64.cast([0,32])),e[63]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[50]].join("")).then(function(a){return a=a,e[64]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[64],void 0,e[28],e[63]).then(function(a){return a=a,e[65]=a[0],a})},function(a){return e[65]?e[66]=!1:e[66]=!0,e[66]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[68]=d.createArray(),void 0!==void 0?e[69]=(e[68].push(void 0),e[68]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",e[68],d.i64.cast([0,3]))},function(a){return e[67]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[65],d.i64.cast([0,0])).then(function(a){return a=a,e[68]=a[0],e[69]=a[1],a})},function(a){return e[67]=e[68]}])},function(a){return e[62]=e[67]}]):d.resolve(e[62]=void 0)},function(a){return e[59]=e[62]}])},function(a){return d.blobs.neq(e[59],void 0)?d.sequence([function(a){return e[62]=e[51].get("epoch_keys"),e[51],e[63]=e[62].get("epoch_anon_id"),e[62],e[64]=e[62].get("epoch_root_key"),e[62],e[65]=d.createArray(),e[76]=(e[65].push(d.i64.cast([0,32])),e[65]),d.i64.ge(e[20],d.i64.cast([0,3]))?d.resolve(e[66]=void 0):d.sequence([function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),e[49]).then(function(a){return a=a,e[76]=a[0],a})},function(a){return e[66]=e[76]}])},function(a){return d.i64.ge(e[20],d.i64.cast([0,4]))?(e[76]="_",e[67]=["message_key_in_epoch",e[76],d.blobs.to_string(e[63]),e[76],"cipher_version",e[76],d.i64.to_string(e[20]),e[76],"thread",e[76],e[49]==null?"":e[49]].join("")):(d.i64.ge(e[20],d.i64.cast([0,3]))?(e[77]="_",e[76]=["message_key_in_epoch",e[77],d.blobs.to_string(e[63]),e[77],"cipher_version",e[77],d.i64.to_string(e[20]),e[77],"thread",e[77],e[49]==null?"":e[49]].join("")):(d.i64.ge(e[20],d.i64.cast([0,2]))?(e[78]="_",e[77]=["message_key_in_epoch",e[78],d.blobs.to_string(e[63]),e[78],"cipher_version",e[78],d.i64.to_string(e[20])].join("")):e[77]=["message_key_in_epoch","_",d.blobs.to_string(e[63])].join(""),e[76]=e[77]),e[67]=e[76]),d.nativeOperation(b("LSGetBlobFromString.nop"),e[67]).then(function(a){return a=a,e[68]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[68],e[66],e[64],e[65]).then(function(a){return a=a,e[69]=a[0],a})},function(a){return e[69]?e[70]=!1:e[70]=!0,e[70]?d.resolve(e[71]=void 0):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[69],d.i64.cast([0,0])).then(function(a){return a=a,e[76]=a[0],e[77]=a[1],a})},function(a){return e[71]=e[76]}])},function(a){return d.filter(d.db.table(169).fetch(),function(a){return d.blobs.eq(a.epochAnonIdBlob,d.blob("MA=="))}).next().then(function(c,f){var a=c.done;c=c.value;return a?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTableUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),e[76]=d.createArray(),void 0!==void 0?e[77]=(e[76].push(void 0),e[76]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get mailbox_root_key_v2: epoch 0 is not available.",e[76],d.i64.cast([0,3]))},function(a){return e[72]=void 0}]):(f=c.item,d.sequence([function(a){return e[76]=d.createArray(),e[84]=(e[76].push(d.i64.cast([0,32])),e[76]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,e[28],e[76]).then(function(a){return a=a,e[77]=a[0],a})},function(a){return e[77]!==void 0?d.sequence([function(a){return e[84]=d.i64.of_int32(e[77].length),d.i64.ge(e[84],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[77],d.i64.cast([0,0])).then(function(a){return a=a,e[86]=a[0],e[87]=a[1],a})},function(a){return e[85]=e[86]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[85]=void 0}])},function(a){return e[78]=e[85]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[84]=d.createArray(),void 0!==void 0?e[85]=(e[84].push(void 0),e[84]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[84],d.i64.cast([0,3]))},function(a){return e[78]=void 0}])},function(a){return d.blobs.neq(e[78],void 0)?e[79]=!0:e[79]=!1,e[79]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[80]=d.createArray(),e[84]=(e[80].push(d.i64.cast([0,32])),e[80]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),e[78],f.epochRootKeyBlob,e[80]).then(function(a){return a=a,e[81]=a[0],a})},function(a){return e[81]!==void 0?d.sequence([function(a){return e[84]=d.i64.of_int32(e[81].length),d.i64.ge(e[84],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[81],d.i64.cast([0,0])).then(function(a){return a=a,e[86]=a[0],e[87]=a[1],a})},function(a){return e[85]=e[86]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[85]=void 0}])},function(a){return e[82]=e[85]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[84]=d.createArray(),void 0!==void 0?e[85]=(e[84].push(void 0),e[84]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[84],d.i64.cast([0,3]))},function(a){return e[82]=void 0}])},function(a){return d.blobs.neq(e[82],void 0)?e[83]=!0:e[83]=!1,e[83]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[72]=e[82]}]))})},function(a){return d.blobs.neq(e[71],void 0)?d.sequence([function(a){return d.blobs.neq(e[72],void 0)?d.sequence([function(a){return e[82]=d.createArray(),e[86]=(e[82].push(d.i64.cast([0,32])),e[82]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,e[72],e[82]).then(function(a){return a=a,e[83]=a[0],a})},function(a){return e[83]!==void 0?d.sequence([function(a){return e[86]=d.i64.of_int32(e[83].length),d.i64.ge(e[86],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[83],d.i64.cast([0,0])).then(function(a){return a=a,e[88]=a[0],e[89]=a[1],a})},function(a){return e[87]=e[88]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[88]=d.createArray(),void 0!==void 0?e[89]=(e[88].push(void 0),e[88]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[88],d.i64.cast([0,3]))},function(a){return e[87]=void 0}])},function(a){return e[84]=e[87]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[84]=void 0}])},function(a){return d.blobs.neq(e[84],void 0)?e[85]=!0:e[85]=!1,e[85]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[76]=e[84]}]):d.resolve(e[76]=void 0)},function(a){return e[77]=e[62].get("epoch_root_key"),e[62],e[78]=e[62].get("epoch_anon_id"),e[62],e[79]=e[62].get("epoch_id"),e[62],e[80]=new d.Map(),e[80].set("payload_key",e[71]),e[80].set("payload_fallback_key",e[76]),e[80].set("encryption_version",e[20]),e[80].set("epoch_root_key",e[77]),e[80].set("epoch_anon_id",e[78]),e[80].set("epoch_id",e[79]),e[81]=new d.Map(),e[81].set("ope_key",e[59]),e[81].set("message_payload_encryption_keys",e[80]),e[81].set("ocmf_shared_key",g.ocmfClientStateBlob),e[81].set("mailbox_base_salt",e[28]),e[81].set("mailbox_root_key_v2",e[72]),a=[e[81],void 0],e[74]=a[0],e[75]=a[1],a}]):d.resolve((e[76]=new d.Map(),e[76].set("error_code",d.i64.cast([0,26])),e[76].set("stored_procedure","MEBKeyDeriver"),e[76].set("error_message",""),a=[void 0,e[76]],e[74]=a[0],e[75]=a[1],a))},function(a){return a=[e[74],e[75]],e[60]=a[0],e[61]=a[1],a}]):d.resolve((e[62]=new d.Map(),e[62].set("error_code",d.i64.cast([0,25])),e[62].set("stored_procedure","MEBKeyDeriver"),e[62].set("error_message",""),a=[void 0,e[62]],e[60]=a[0],e[61]=a[1],a))},function(a){return a=[e[60],e[61]],e[53]=a[0],e[54]=a[1],a}]):d.resolve((a=[void 0,e[52]],e[53]=a[0],e[54]=a[1],a))},function(f){return e[53]!==void 0?d.sequence([function(a){return e[59]=e[35].get("backup_id"),e[35],e[60]=e[35].get("act_thread_id"),e[35],e[61]=e[35].get("timestamp"),e[35],e[62]=e[35].get("otid"),e[35],d.storedProcedure(b("LSEncryptIdentifiersV2"),e[40],e[41],e[59],e[60],d.i64.from_string(e[61]),e[62],e[53]).then(function(a){return a=a,e[63]=a[0],e[64]=a[1],a})},function(f){return e[63]!==void 0?d.sequence([function(c){return e[69]=e[35].get("act_thread_id"),e[35],d.storedProcedure(b("LSLoadAndEncryptProtobufV2"),a[0],e[53],e[69]).then(function(a){return a=a,e[70]=a[0],e[71]=a[1],a})},function(f){return c("gkx")("6356")&&e[70]!==void 0?d.sequence([function(a){return e[76]=e[35].get("act_thread_id"),e[35],e[77]=e[35].get("backup_id"),e[35],d.storedProcedure(b("LSDeriveValueSecretRefV2"),e[76],e[77],e[53]).then(function(a){return a=a,e[78]=a[0],e[79]=a[1],a})},function(c){return e[70]!==void 0?d.sequence([function(c){return e[78]!==void 0?d.sequence([function(a){return e[88]=e[78].get("value_secret_ref"),e[78],e[89]=e[63].get("act_thread_id_ocmf_partial"),e[63],e[90]=e[63].get("otid_ocmf_partial"),e[63],e[91]=e[63].get("timestamp_encrypted"),e[63],e[92]=new d.Map(),e[92].set("list_key",e[89]),e[92].set("unique_key",e[90]),e[92].set("sort_key",e[91]),void 0!==void 0?(e[124]=(void 0).get("encrypted_message_payload"),void 0,e[125]=(void 0).get("value_secret_ref"),void 0,e[126]=new d.Map(),e[126].set("value",e[124]),e[126].set("value_secret_ref",e[125]),e[93]=e[126]):e[93]=void 0,e[94]=new d.Map(),e[94].set("list_item_id",e[92]),e[94].set("list_item",e[93]),e[94].set("action_type",e[40]),e[95]=e[35].get("timestamp"),e[35],e[96]=e[35].get("otid"),e[35],e[97]=e[35].get("act_thread_id"),e[35],e[98]=new d.Map(),e[98].set("timestamp",e[95]),e[98].set("otid",e[96]),e[98].set("wa_thread_id",d.i64.from_string(e[97])),e[99]=e[53].get("mailbox_base_salt"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[99]).then(function(a){return a=a,e[100]=a[0],a})},function(a){return e[101]=e[53].get("ocmf_shared_key"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[101]).then(function(a){return a=a,e[102]=a[0],a})},function(a){return e[103]=new d.Map(),e[103].set("mailbox_root_key",e[100]==null?"":e[100]),e[103].set("ocmf_client_state_blob",e[102]==null?"":e[102]),e[104]=e[63].get("backup_id_ocmf_partial"),e[63],e[105]=e[53].get("message_payload_encryption_keys"),e[53],e[106]=e[105].get("epoch_id"),e[105],e[107]=e[53].get("message_payload_encryption_keys"),e[53],e[108]=e[107].get("encryption_version"),e[107],e[123]=e[43]==null?"":e[43],e[109]=new d.Map(),e[109].set("mailbox_partial_id",e[104]),e[109].set("action",e[94]),e[109].set("device_id",e[29]),e[109].set("echo_version",d.i64.cast([0,0])),e[109].set("epoch_id",e[106]),e[109].set("trace_id",void 0),e[109].set("encryption_version",e[108]),e[109].set("is_thread",d.i64.eq(e[41],d.i64.cast([0,2]))),e[109].set("raw_identifiers",e[98]),e[109].set("raw_tokens",e[103]),e[109].set("request_id",e[123]),e[109].set("tam_thread_subtype",e[46]==null?d.i64.cast([0,0]):e[46]),e[109].set("is_instamadillo",e[47]==null?!1:e[47]),e[109].set("empty_echo_payload_reason",d.i64.cast([0,1])),e[109].set("value_secret_ref",e[88]),e[70]!==void 0?d.sequence([function(a){return e[124]=e[70].get("supplemental_data_encrypted"),e[70],e[124]!==void 0?d.sequence([function(a){return e[126]=e[70].get("protobuf_encrypted"),e[70],e[127]=e[70].get("backup_action"),e[70],e[128]=e[70].get("timestamp_ms"),e[70],e[129]=e[124].get("sk_ciphertext"),e[124],d.nativeOperation(b("LSBase64Encode.nop"),e[129]).then(function(a){return a=a,e[130]=a[0],a})},function(a){return e[131]=e[124].get("sk_hash"),e[124],d.nativeOperation(b("LSBase64Encode.nop"),e[131]).then(function(a){return a=a,e[132]=a[0],a})},function(a){return e[133]=e[70].get("message_tags"),e[70],e[134]=new d.Map(),e[134].set("supplementary_data_key",void 0),e[134].set("encrypted_protobuf",e[126]),e[134].set("key_value_backup_action",e[127]),e[134].set("protobuf_ts_ms",e[128]),e[134].set("supplemental_key_ciphertext",e[130]),e[134].set("supplemental_key_hash",e[132]),e[134].set("message_tags",e[133]),e[125]=e[134]}]):d.resolve((e[126]=e[70].get("protobuf_encrypted"),e[70],e[127]=e[70].get("backup_action"),e[70],e[128]=e[70].get("timestamp_ms"),e[70],e[129]=e[70].get("message_tags"),e[70],e[130]=new d.Map(),e[130].set("supplementary_data_key",void 0),e[130].set("encrypted_protobuf",e[126]),e[130].set("key_value_backup_action",e[127]),e[130].set("protobuf_ts_ms",e[128]),e[130].set("message_tags",e[129]),e[125]=e[130]))},function(a){return e[109].set("key_value_backup_payload",e[125])}]):d.resolve()},function(a){return e[42]!==void 0?e[109].set("attachment_backup_payload",e[42]):function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[123]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[123],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(a){return d.sequence([function(a){return e[43]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[43],d.i64.cast([0,1463]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[124]=a[0],a})},function(a){return e[124]?e[125]=!0:e[125]=!1,e[125]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[126]=d.createArray(),void 0!==void 0?e[127]=(e[126].push(void 0),e[126]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[126],d.i64.cast([0,3]))):d.resolve()}])},function(b){return e[110]=d.toJSON(e[109]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[124]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[125]=void 0:e[125]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[124],d.i64.cast([0,1e6])),e[9]),e[125]],e[111]=b[0],e[112]=b[1],e[113]=b[2],e[114]=b[3],e[115]=b[4],e[116]=b[5],e[117]=b[6],b):(f=c.item,e[124]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[125]=void 0:e[125]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[124],d.i64.cast([0,1e6])),e[9]),e[125]],e[111]=b[0],e[112]=b[1],e[113]=b[2],e[114]=b[3],e[115]=b[4],e[116]=b[5],e[117]=b[6],b)})},function(a){return e[119]=new d.Map(),e[119].set("task_id",e[111]),e[119].set("queue_name",e[112]),e[119].set("enqueue_timestamp_ms",e[113]),e[119].set("priority",e[114]),e[119].set("first_executed_timestamp_ms",e[115]),e[119].set("execution_time_ns",e[116]),e[119].set("echo_encoding_execution_time_ns",e[117]),e[120]=new d.Map(),e[120].set("task_metadata",e[119]),e[120].set("action_type",e[40]),e[120].set("content_type",e[41]),e[120].set("identifiers",void 0),e[120].set("identifiers_v2",e[35]),e[120].set("task_creation_source",void 0),e[120].set("message_payload_source",d.i64.cast([0,2])),e[121]=new d.Map(),e[121].set("payload",e[110]),e[122]=d.createArray(),e[124]=(e[122].push(void 0),e[122]),a=[e[121],void 0,e[120],e[122]],e[84]=a[0],e[85]=a[1],e[86]=a[2],e[87]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[99]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[100]=void 0:e[100]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[99],d.i64.cast([0,1e6])),e[9]),e[100]],e[88]=b[0],e[89]=b[1],e[90]=b[2],e[91]=b[3],e[92]=b[4],e[93]=b[5],e[94]=b[6],b):(f=c.item,e[99]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[100]=void 0:e[100]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[99],d.i64.cast([0,1e6])),e[9]),e[100]],e[88]=b[0],e[89]=b[1],e[90]=b[2],e[91]=b[3],e[92]=b[4],e[93]=b[5],e[94]=b[6],b)})},function(a){return e[96]=new d.Map(),e[96].set("task_id",e[88]),e[96].set("queue_name",e[89]),e[96].set("enqueue_timestamp_ms",e[90]),e[96].set("priority",e[91]),e[96].set("first_executed_timestamp_ms",e[92]),e[96].set("execution_time_ns",e[93]),e[96].set("echo_encoding_execution_time_ns",e[94]),e[97]=new d.Map(),e[97].set("task_metadata",e[96]),e[97].set("action_type",e[40]),e[97].set("content_type",e[41]),e[97].set("identifiers",void 0),e[97].set("identifiers_v2",e[35]),e[97].set("task_creation_source",void 0),e[97].set("message_payload_source",d.i64.cast([0,2])),e[98]=d.createArray(),e[99]=(e[98].push(void 0),e[98]),a=[void 0,e[79],e[97],e[98]],e[84]=a[0],e[85]=a[1],e[86]=a[2],e[87]=a[3],a}])},function(a){return a=[e[84],e[85],e[86],e[87]],e[80]=a[0],e[81]=a[1],e[82]=a[2],e[83]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[95]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[96]=void 0:e[96]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[95],d.i64.cast([0,1e6])),e[9]),e[96]],e[84]=b[0],e[85]=b[1],e[86]=b[2],e[87]=b[3],e[88]=b[4],e[89]=b[5],e[90]=b[6],b):(f=c.item,e[95]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[96]=void 0:e[96]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[95],d.i64.cast([0,1e6])),e[9]),e[96]],e[84]=b[0],e[85]=b[1],e[86]=b[2],e[87]=b[3],e[88]=b[4],e[89]=b[5],e[90]=b[6],b)})},function(a){return e[92]=new d.Map(),e[92].set("task_id",e[84]),e[92].set("queue_name",e[85]),e[92].set("enqueue_timestamp_ms",e[86]),e[92].set("priority",e[87]),e[92].set("first_executed_timestamp_ms",e[88]),e[92].set("execution_time_ns",e[89]),e[92].set("echo_encoding_execution_time_ns",e[90]),e[93]=new d.Map(),e[93].set("task_metadata",e[92]),e[93].set("action_type",e[40]),e[93].set("content_type",e[41]),e[93].set("identifiers",void 0),e[93].set("identifiers_v2",e[35]),e[93].set("task_creation_source",void 0),e[93].set("message_payload_source",d.i64.cast([0,2])),e[94]=d.createArray(),e[95]=(e[94].push(e[71]),e[94]),a=[void 0,void 0,e[93],e[94]],e[80]=a[0],e[81]=a[1],e[82]=a[2],e[83]=a[3],a}])},function(a){return a=[e[80],e[81],e[82],e[83]],e[72]=a[0],e[73]=a[1],e[74]=a[2],e[75]=a[3],a}]):d.sequence([function(c){return d.i64.eq(e[40],d.i64.cast([0,1]))?(e[84]=e[45]===""?void 0:e[45],e[84]!==void 0?(c=[e[84],void 0],e[82]=c[0],e[83]=c[1],c):(e[85]=new d.Map(),e[85].set("error_code",d.i64.cast([0,30])),e[85].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[85].set("error_message",""),c=[void 0,e[85]],e[82]=c[0],e[83]=c[1],c),c=[e[82],e[83]],e[76]=c[0],e[77]=c[1],c):(c=["",void 0],e[76]=c[0],e[77]=c[1],c),e[76]!==void 0?d.sequence([function(a){return d.i64.eq(e[40],d.i64.cast([0,1]))?d.sequence([function(a){return e[88]=e[35].get("backup_id"),e[35],e[89]=e[35].get("act_thread_id"),e[35],d.storedProcedure(b("LSEncryptMessagePayloadV2"),e[88],e[89],e[53],e[76]).then(function(a){return a=a,e[90]=a[0],e[91]=a[1],a})},function(a){return a=[e[90],e[91]],e[82]=a[0],e[83]=a[1],a}]):d.resolve((e[88]=new d.Map(),e[88].set("encrypted_message_payload",""),e[88].set("value_secret_ref",""),a=[e[88],void 0],e[82]=a[0],e[83]=a[1],a))},function(c){return e[82]!==void 0?d.sequence([function(a){return e[88]=e[63].get("act_thread_id_ocmf_partial"),e[63],e[89]=e[63].get("otid_ocmf_partial"),e[63],e[90]=e[63].get("timestamp_encrypted"),e[63],e[91]=new d.Map(),e[91].set("list_key",e[88]),e[91].set("unique_key",e[89]),e[91].set("sort_key",e[90]),e[82]!==void 0?(e[123]=e[82].get("encrypted_message_payload"),e[82],e[124]=e[82].get("value_secret_ref"),e[82],e[125]=new d.Map(),e[125].set("value",e[123]),e[125].set("value_secret_ref",e[124]),e[92]=e[125]):e[92]=void 0,e[93]=new d.Map(),e[93].set("list_item_id",e[91]),e[93].set("list_item",e[92]),e[93].set("action_type",e[40]),e[94]=e[35].get("timestamp"),e[35],e[95]=e[35].get("otid"),e[35],e[96]=e[35].get("act_thread_id"),e[35],e[97]=new d.Map(),e[97].set("timestamp",e[94]),e[97].set("otid",e[95]),e[97].set("wa_thread_id",d.i64.from_string(e[96])),e[98]=e[53].get("mailbox_base_salt"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[98]).then(function(a){return a=a,e[99]=a[0],a})},function(a){return e[100]=e[53].get("ocmf_shared_key"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[100]).then(function(a){return a=a,e[101]=a[0],a})},function(a){return e[102]=new d.Map(),e[102].set("mailbox_root_key",e[99]==null?"":e[99]),e[102].set("ocmf_client_state_blob",e[101]==null?"":e[101]),e[103]=e[63].get("backup_id_ocmf_partial"),e[63],e[104]=e[53].get("message_payload_encryption_keys"),e[53],e[105]=e[104].get("epoch_id"),e[104],e[106]=e[53].get("message_payload_encryption_keys"),e[53],e[107]=e[106].get("encryption_version"),e[106],e[122]=e[43]==null?"":e[43],e[108]=new d.Map(),e[108].set("mailbox_partial_id",e[103]),e[108].set("action",e[93]),e[108].set("device_id",e[29]),e[108].set("echo_version",d.i64.cast([0,0])),e[108].set("epoch_id",e[105]),e[108].set("trace_id",void 0),e[108].set("encryption_version",e[107]),e[108].set("is_thread",d.i64.eq(e[41],d.i64.cast([0,2]))),e[108].set("raw_identifiers",e[97]),e[108].set("raw_tokens",e[102]),e[108].set("request_id",e[122]),e[108].set("tam_thread_subtype",e[46]==null?d.i64.cast([0,0]):e[46]),e[108].set("is_instamadillo",e[47]==null?!1:e[47]),e[70]!==void 0?d.sequence([function(a){return e[123]=e[70].get("supplemental_data_encrypted"),e[70],e[123]!==void 0?d.sequence([function(a){return e[125]=e[70].get("protobuf_encrypted"),e[70],e[126]=e[70].get("backup_action"),e[70],e[127]=e[70].get("timestamp_ms"),e[70],e[128]=e[123].get("sk_ciphertext"),e[123],d.nativeOperation(b("LSBase64Encode.nop"),e[128]).then(function(a){return a=a,e[129]=a[0],a})},function(a){return e[130]=e[123].get("sk_hash"),e[123],d.nativeOperation(b("LSBase64Encode.nop"),e[130]).then(function(a){return a=a,e[131]=a[0],a})},function(a){return e[132]=e[70].get("message_tags"),e[70],e[133]=new d.Map(),e[133].set("supplementary_data_key",void 0),e[133].set("encrypted_protobuf",e[125]),e[133].set("key_value_backup_action",e[126]),e[133].set("protobuf_ts_ms",e[127]),e[133].set("supplemental_key_ciphertext",e[129]),e[133].set("supplemental_key_hash",e[131]),e[133].set("message_tags",e[132]),e[124]=e[133]}]):d.resolve((e[125]=e[70].get("protobuf_encrypted"),e[70],e[126]=e[70].get("backup_action"),e[70],e[127]=e[70].get("timestamp_ms"),e[70],e[128]=e[70].get("message_tags"),e[70],e[129]=new d.Map(),e[129].set("supplementary_data_key",void 0),e[129].set("encrypted_protobuf",e[125]),e[129].set("key_value_backup_action",e[126]),e[129].set("protobuf_ts_ms",e[127]),e[129].set("message_tags",e[128]),e[124]=e[129]))},function(a){return e[108].set("key_value_backup_payload",e[124])}]):d.resolve()},function(a){return e[42]!==void 0?e[108].set("attachment_backup_payload",e[42]):function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[122]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[122],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(a){return d.sequence([function(a){return e[43]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[43],d.i64.cast([0,1463]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[123]=a[0],a})},function(a){return e[123]?e[124]=!0:e[124]=!1,e[124]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[125]=d.createArray(),void 0!==void 0?e[126]=(e[125].push(void 0),e[125]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[125],d.i64.cast([0,3]))):d.resolve()}])},function(b){return e[109]=d.toJSON(e[108]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[123]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[124]=void 0:e[124]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[123],d.i64.cast([0,1e6])),e[9]),e[124]],e[110]=b[0],e[111]=b[1],e[112]=b[2],e[113]=b[3],e[114]=b[4],e[115]=b[5],e[116]=b[6],b):(f=c.item,e[123]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[124]=void 0:e[124]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[123],d.i64.cast([0,1e6])),e[9]),e[124]],e[110]=b[0],e[111]=b[1],e[112]=b[2],e[113]=b[3],e[114]=b[4],e[115]=b[5],e[116]=b[6],b)})},function(a){return e[118]=new d.Map(),e[118].set("task_id",e[110]),e[118].set("queue_name",e[111]),e[118].set("enqueue_timestamp_ms",e[112]),e[118].set("priority",e[113]),e[118].set("first_executed_timestamp_ms",e[114]),e[118].set("execution_time_ns",e[115]),e[118].set("echo_encoding_execution_time_ns",e[116]),e[119]=new d.Map(),e[119].set("task_metadata",e[118]),e[119].set("action_type",e[40]),e[119].set("content_type",e[41]),e[119].set("identifiers",void 0),e[119].set("identifiers_v2",e[35]),e[119].set("task_creation_source",void 0),e[119].set("message_payload_source",d.i64.cast([0,2])),e[120]=new d.Map(),e[120].set("payload",e[109]),e[121]=d.createArray(),e[123]=(e[121].push(e[71]),e[121]),a=[e[120],void 0,e[119],e[121]],e[84]=a[0],e[85]=a[1],e[86]=a[2],e[87]=a[3],a}]):d.sequence([function(b){return d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[103]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[104]=void 0:e[104]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[103],d.i64.cast([0,1e6])),e[9]),e[104]],e[92]=b[0],e[93]=b[1],e[94]=b[2],e[95]=b[3],e[96]=b[4],e[97]=b[5],e[98]=b[6],b):(f=c.item,e[103]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[104]=void 0:e[104]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[103],d.i64.cast([0,1e6])),e[9]),e[104]],e[92]=b[0],e[93]=b[1],e[94]=b[2],e[95]=b[3],e[96]=b[4],e[97]=b[5],e[98]=b[6],b)})},function(a){return e[100]=new d.Map(),e[100].set("task_id",e[92]),e[100].set("queue_name",e[93]),e[100].set("enqueue_timestamp_ms",e[94]),e[100].set("priority",e[95]),e[100].set("first_executed_timestamp_ms",e[96]),e[100].set("execution_time_ns",e[97]),e[100].set("echo_encoding_execution_time_ns",e[98]),e[101]=new d.Map(),e[101].set("task_metadata",e[100]),e[101].set("action_type",e[40]),e[101].set("content_type",e[41]),e[101].set("identifiers",void 0),e[101].set("identifiers_v2",e[35]),e[101].set("task_creation_source",void 0),e[101].set("message_payload_source",d.i64.cast([0,2])),e[102]=d.createArray(),e[103]=(e[102].push(e[71]),e[102]),a=[void 0,e[83],e[101],e[102]],e[88]=a[0],e[89]=a[1],e[90]=a[2],e[91]=a[3],a}])},function(a){return a=[e[88],e[89],e[90],e[91]],e[84]=a[0],e[85]=a[1],e[86]=a[2],e[87]=a[3],a}])},function(a){return a=[e[84],e[85],e[86],e[87]],e[78]=a[0],e[79]=a[1],e[80]=a[2],e[81]=a[3],a}]):d.sequence([function(b){return d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[97]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[98]=void 0:e[98]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[97],d.i64.cast([0,1e6])),e[9]),e[98]],e[86]=b[0],e[87]=b[1],e[88]=b[2],e[89]=b[3],e[90]=b[4],e[91]=b[5],e[92]=b[6],b):(f=c.item,e[97]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[98]=void 0:e[98]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[97],d.i64.cast([0,1e6])),e[9]),e[98]],e[86]=b[0],e[87]=b[1],e[88]=b[2],e[89]=b[3],e[90]=b[4],e[91]=b[5],e[92]=b[6],b)})},function(a){return e[94]=new d.Map(),e[94].set("task_id",e[86]),e[94].set("queue_name",e[87]),e[94].set("enqueue_timestamp_ms",e[88]),e[94].set("priority",e[89]),e[94].set("first_executed_timestamp_ms",e[90]),e[94].set("execution_time_ns",e[91]),e[94].set("echo_encoding_execution_time_ns",e[92]),e[95]=new d.Map(),e[95].set("task_metadata",e[94]),e[95].set("action_type",e[40]),e[95].set("content_type",e[41]),e[95].set("identifiers",void 0),e[95].set("identifiers_v2",e[35]),e[95].set("task_creation_source",void 0),e[95].set("message_payload_source",d.i64.cast([0,2])),e[96]=d.createArray(),e[97]=(e[96].push(e[71]),e[96]),a=[void 0,e[77],e[95],e[96]],e[82]=a[0],e[83]=a[1],e[84]=a[2],e[85]=a[3],a}])},function(a){return a=[e[82],e[83],e[84],e[85]],e[78]=a[0],e[79]=a[1],e[80]=a[2],e[81]=a[3],a}])},function(a){return a=[e[78],e[79],e[80],e[81]],e[72]=a[0],e[73]=a[1],e[74]=a[2],e[75]=a[3],a}])},function(a){return a=[e[72],e[73],e[74],e[75]],e[65]=a[0],e[66]=a[1],e[67]=a[2],e[68]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[80]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[81]=void 0:e[81]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[80],d.i64.cast([0,1e6])),e[9]),e[81]],e[69]=b[0],e[70]=b[1],e[71]=b[2],e[72]=b[3],e[73]=b[4],e[74]=b[5],e[75]=b[6],b):(f=c.item,e[80]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[81]=void 0:e[81]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[80],d.i64.cast([0,1e6])),e[9]),e[81]],e[69]=b[0],e[70]=b[1],e[71]=b[2],e[72]=b[3],e[73]=b[4],e[74]=b[5],e[75]=b[6],b)})},function(a){return e[77]=new d.Map(),e[77].set("task_id",e[69]),e[77].set("queue_name",e[70]),e[77].set("enqueue_timestamp_ms",e[71]),e[77].set("priority",e[72]),e[77].set("first_executed_timestamp_ms",e[73]),e[77].set("execution_time_ns",e[74]),e[77].set("echo_encoding_execution_time_ns",e[75]),e[78]=new d.Map(),e[78].set("task_metadata",e[77]),e[78].set("action_type",e[40]),e[78].set("content_type",e[41]),e[78].set("identifiers",void 0),e[78].set("identifiers_v2",e[35]),e[78].set("task_creation_source",void 0),e[78].set("message_payload_source",d.i64.cast([0,2])),e[79]=d.createArray(),e[80]=(e[79].push(void 0),e[79]),a=[void 0,e[64],e[78],e[79]],e[65]=a[0],e[66]=a[1],e[67]=a[2],e[68]=a[3],a}])},function(a){return a=[e[65],e[66],e[67],e[68]],e[55]=a[0],e[56]=a[1],e[57]=a[2],e[58]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[70]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[71]=void 0:e[71]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[70],d.i64.cast([0,1e6])),e[9]),e[71]],e[59]=b[0],e[60]=b[1],e[61]=b[2],e[62]=b[3],e[63]=b[4],e[64]=b[5],e[65]=b[6],b):(f=c.item,e[70]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[71]=void 0:e[71]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[70],d.i64.cast([0,1e6])),e[9]),e[71]],e[59]=b[0],e[60]=b[1],e[61]=b[2],e[62]=b[3],e[63]=b[4],e[64]=b[5],e[65]=b[6],b)})},function(a){return e[67]=new d.Map(),e[67].set("task_id",e[59]),e[67].set("queue_name",e[60]),e[67].set("enqueue_timestamp_ms",e[61]),e[67].set("priority",e[62]),e[67].set("first_executed_timestamp_ms",e[63]),e[67].set("execution_time_ns",e[64]),e[67].set("echo_encoding_execution_time_ns",e[65]),e[68]=new d.Map(),e[68].set("task_metadata",e[67]),e[68].set("action_type",e[40]),e[68].set("content_type",e[41]),e[68].set("identifiers",void 0),e[68].set("identifiers_v2",e[35]),e[68].set("task_creation_source",void 0),e[68].set("message_payload_source",d.i64.cast([0,2])),e[69]=d.createArray(),e[70]=(e[69].push(void 0),e[69]),a=[void 0,e[54],e[68],e[69]],e[55]=a[0],e[56]=a[1],e[57]=a[2],e[58]=a[3],a}])},function(a){return a=[e[55],e[56],e[57],e[58]],e[36]=a[0],e[37]=a[1],e[38]=a[2],e[39]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[61]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[62]=void 0:e[62]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[61],d.i64.cast([0,1e6])),e[9]),e[62]],e[49]=b[0],e[50]=b[1],e[51]=b[2],e[52]=b[3],e[53]=b[4],e[54]=b[5],e[55]=b[6],b):(f=c.item,e[61]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[62]=void 0:e[62]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[61],d.i64.cast([0,1e6])),e[9]),e[62]],e[49]=b[0],e[50]=b[1],e[51]=b[2],e[52]=b[3],e[53]=b[4],e[54]=b[5],e[55]=b[6],b)})},function(a){return e[57]=new d.Map(),e[57].set("task_id",e[49]),e[57].set("queue_name",e[50]),e[57].set("enqueue_timestamp_ms",e[51]),e[57].set("priority",e[52]),e[57].set("first_executed_timestamp_ms",e[53]),e[57].set("execution_time_ns",e[54]),e[57].set("echo_encoding_execution_time_ns",e[55]),e[58]=new d.Map(),e[58].set("task_metadata",e[57]),e[58].set("action_type",e[40]),e[58].set("content_type",e[41]),e[58].set("identifiers",void 0),e[58].set("identifiers_v2",e[35]),e[58].set("task_creation_source",void 0),e[58].set("message_payload_source",d.i64.cast([0,2])),e[59]=new d.Map(),e[59].set("error_code",e[48]),e[59].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[59].set("error_message",""),e[60]=d.createArray(),a=[void 0,e[59],e[58],e[60]],e[36]=a[0],e[37]=a[1],e[38]=a[2],e[39]=a[3],a}])},function(a){return a=[e[36],e[37],e[38],e[39]],e[30]=a[0],e[31]=a[1],e[32]=a[2],e[33]=a[3],a}]))})},function(a){return a=[e[30],e[31],e[32],e[33]],e[22]=a[0],e[23]=a[1],e[24]=a[2],e[25]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[42]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[42],d.i64.cast([0,1e6])),e[9]),void 0],e[30]=b[0],e[31]=b[1],e[32]=b[2],e[33]=b[3],e[34]=b[4],e[35]=b[5],e[36]=b[6],b):(f=c.item,e[42]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[42],d.i64.cast([0,1e6])),e[9]),void 0],e[30]=b[0],e[31]=b[1],e[32]=b[2],e[33]=b[3],e[34]=b[4],e[35]=b[5],e[36]=b[6],b)})},function(a){return e[38]=new d.Map(),e[38].set("task_id",e[30]),e[38].set("queue_name",e[31]),e[38].set("enqueue_timestamp_ms",e[32]),e[38].set("priority",e[33]),e[38].set("first_executed_timestamp_ms",e[34]),e[38].set("execution_time_ns",e[35]),e[38].set("echo_encoding_execution_time_ns",e[36]),e[39]=new d.Map(),e[39].set("task_metadata",e[38]),e[39].set("action_type",void 0),e[39].set("content_type",void 0),e[39].set("identifiers",void 0),e[39].set("identifiers_v2",void 0),e[39].set("task_creation_source",void 0),e[39].set("message_payload_source",d.i64.cast([0,2])),e[40]=new d.Map(),e[40].set("error_code",d.i64.cast([0,24])),e[40].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[40].set("error_message",""),e[41]=d.createArray(),a=[void 0,e[40],e[39],e[41]],e[22]=a[0],e[23]=a[1],e[24]=a[2],e[25]=a[3],a}])},function(a){return a=[e[22],e[23],e[24],e[25]],e[13]=a[0],e[14]=a[1],e[15]=a[2],e[16]=a[3],a}]))})},function(a){return a=[e[13],e[14],e[15],e[16]],e[2]=a[0],e[3]=a[1],e[4]=a[2],e[5]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(b,c){var f=b.done;b=b.value;return f?(e[25]=d.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[25],d.i64.cast([0,1e6])),e[9]),void 0],e[13]=f[0],e[14]=f[1],e[15]=f[2],e[16]=f[3],e[17]=f[4],e[18]=f[5],e[19]=f[6],f):(c=b.item,e[25]=d.i64.of_float(Date.now()),f=[a[0],c.queueName,c.enqueueTimestampMs,void 0,c.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[25],d.i64.cast([0,1e6])),e[9]),void 0],e[13]=f[0],e[14]=f[1],e[15]=f[2],e[16]=f[3],e[17]=f[4],e[18]=f[5],e[19]=f[6],f)})},function(a){return e[21]=new d.Map(),e[21].set("task_id",e[13]),e[21].set("queue_name",e[14]),e[21].set("enqueue_timestamp_ms",e[15]),e[21].set("priority",e[16]),e[21].set("first_executed_timestamp_ms",e[17]),e[21].set("execution_time_ns",e[18]),e[21].set("echo_encoding_execution_time_ns",e[19]),e[22]=new d.Map(),e[22].set("task_metadata",e[21]),e[22].set("action_type",void 0),e[22].set("content_type",void 0),e[22].set("identifiers",void 0),e[22].set("identifiers_v2",void 0),e[22].set("task_creation_source",void 0),e[22].set("message_payload_source",d.i64.cast([0,2])),e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,4])),e[23].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[23].set("error_message",""),e[24]=d.createArray(),a=[void 0,e[23],e[22],e[24]],e[2]=a[0],e[3]=a[1],e[4]=a[2],e[5]=a[3],a}])},function(a){return e[6]=d.i64.of_float(Date.now()),e[7]=d.i64.random(),e[10]="Finishing execution. Execution time: ",e[11]=d.i64.to_string(d.i64.sub(e[6],e[0])),e[12]=" ms",e[8]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][serializeBackupPayloadV2] ",e[8],e[10],e[8],e[11],e[8],e[12]].join("")),d.i64.eq(d.i64.mod_(e[7],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[13]=",",e[14]=d.createArray(),void 0!==void 0?e[15]=(e[14].push(void 0),e[14]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"serializeBackupPayloadV2",[e[10],e[13],e[11],e[13],e[12]].join(""),e[14],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[2],e[3],e[4],e[5]],f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSTaskSerializerEncryptedBackupsUpload",["LSArrayGetObjectAt","LSLogMebClientEvent.nop","LSSerializeBackupPayloadV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.forEach(c.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]),function(a){var b=a.update;a.item;return b({backupStatus:c.i64.cast([0,2])})})},function(e){return c.storedProcedure(b("LSSerializeBackupPayloadV2"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],a})},function(a){return d[6]=c.i64.of_int32(d[5].length),c.i64.gt(d[6],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[5],c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return d[7]=d[20]}]):c.resolve(d[7]=void 0)},function(a){return d[2]?d[8]=!1:d[8]=!0,d[8]?(d[3]?d[20]=!1:d[20]=!0,d[20]?(a=[void 0,void 0,d[7],d[4]],d[21]=a[0],d[22]=a[1],d[23]=a[2],d[24]=a[3],a):(a=[void 0,d[3],d[7],d[4]],d[21]=a[0],d[22]=a[1],d[23]=a[2],d[24]=a[3],a),a=[d[21],d[22],d[23],d[24]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],a):(d[20]=d[2].get("payload"),d[2],a=[d[20],d[3],d[7],d[4]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],a),d[20]=new c.Map(),d[21]=d[20].set("success",d[9]),d[22]=d[20].set("failure",d[10]),d[23]=d[20].set("protobuf_failure",d[11]),d[24]=d[20].set("context",d[12]),d[25]=c.toJSON(d[20]),d[13]=d[25],d[14]=c.i64.of_float(Date.now()),d[15]=c.i64.random(),d[17]="Finishing execution. Execution time: ",d[18]=c.i64.to_string(c.i64.sub(d[14],d[0])),d[19]=" ms",d[16]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUpload] ",d[16],d[17],d[16],d[18],d[16],d[19]].join("")),c.i64.eq(c.i64.mod_(d[15],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[20]=",",d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUpload",[d[17],d[20],d[18],d[20],d[19]].join(""),d[21],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[13],c.i64.cast([0,50026])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadStoredProcedure";e.exports=a}),null);
__d("LSLoadProtobufBackupSerializedPayloadData",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSEncryptIdentifiersV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadProtobufBackupSerializedPayloadData] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[19]=c.i64.mul(d[1],c.i64.cast([0,1e6])),c.db.table(2).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(d[23]=c.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f):(e=b.item,d[23]=c.i64.of_float(Date.now()),f=[a[0],e.queueName,e.enqueueTimestampMs,e.priority,e.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f)})},function(e){return d[10]=new c.Map(),d[10].set("task_id",d[2]),d[10].set("queue_name",d[3]),d[10].set("enqueue_timestamp_ms",d[4]),d[10].set("priority",d[5]),d[10].set("first_executed_timestamp_ms",d[6]),d[10].set("execution_time_ns",d[7]),d[10].set("echo_encoding_execution_time_ns",d[8]),d[11]=new c.Map(),d[11].set("task_metadata",d[10]),d[11].set("action_type",void 0),d[11].set("content_type",void 0),d[11].set("identifiers",void 0),d[11].set("identifiers_v2",void 0),d[11].set("task_creation_source",void 0),d[11].set("message_payload_source",c.i64.cast([0,2])),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[23]=new c.Map(),d[23].set("error_code",c.i64.cast([0,1])),d[23].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[23].set("error_message",""),g=[void 0,d[23],d[11]],d[12]=g[0],d[13]=g[1],d[14]=g[2],g):(f=e.item,c.sequence([function(a){return d[32]=f.backupId,d[33]=f.mailboxRootKeyBlob,d[34]=f.deviceId,d[31]=f.backupTenancy,d[30]=f.encryptionVersion,d[23]=void 0,c.i64.neq(d[23],void 0)?c.resolve(d[24]=d[23]):c.sequence([function(a){return d[35]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[45]=(d[35].push(c.i64.cast([0,0])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[45]=(d[35].push(c.i64.cast([0,2])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[38]?d[45]=(d[35].push(c.i64.cast([0,3])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[45]=(d[35].push(c.i64.cast([0,4])),d[35]):0,d[40]=c.createArray(),d[41]=c.i64.of_int32(d[35].length),c.i64.gt(d[41],c.i64.cast([0,0]))?c.loopAsync(d[41],function(a){return d[45]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[35],d[45]).then(function(a){return a=a,d[46]=a[0],d[47]=a[1],a})},function(a){return d[48]=(d[40].push(d[46]),d[40])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[45]=c.createArray(),d[46]=c.i64.of_int32(d[40].length),c.i64.gt(d[46],c.i64.cast([0,0]))?c.loopAsync(d[46],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[40],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[45].push(c.i64.to_string(d[49])),d[45])}])}):c.resolve()},function(a){return d[47]=d[45].join(","),d[42]=d[47]}])},function(a){return d[40].some(function(a){return c.i64.eq(d[30],a)})?d[43]=d[30]:d[43]=void 0,c.i64.neq(d[43],void 0)?d[44]=d[43]:d[44]=void 0,d[24]=d[44]}])},function(e){return c.i64.neq(d[24],void 0)?d[25]=d[24]:d[25]=c.i64.cast([0,0]),c.i64.neq(d[31],void 0)?d[26]=d[31]:d[26]=c.i64.cast([0,1]),c.i64.neq(d[34],void 0)?c.sequence([function(e){return c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(h,i){var e=h.done;h=h.value;return e?(d[39]=new c.Map(),d[39].set("error_code",c.i64.cast([0,5])),d[39].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[39].set("error_message",""),e=[void 0,d[39],d[11]],d[35]=e[0],d[36]=e[1],d[37]=e[2],e):(i=h.item,c.sequence([function(b){return d[61]=i.actThreadId,d[62]=i.toplevelOfflineThreadingId,d[40]=i.messageTimestampMs,d[39]=new c.Map(),d[39].set("backup_id",c.i64.to_string(d[32])),d[39].set("act_thread_id",d[61]),d[39].set("server_thread_id",d[61]),d[39].set("timestamp",c.i64.to_string(d[40])),d[39].set("otid",d[62]),d[41]=new c.Map(),d[41].set("backup_id",c.i64.to_string(d[32])),d[41].set("act_thread_id",d[61]),d[41].set("timestamp",c.i64.to_string(d[40])),d[41].set("otid",d[62]),c.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var b=e.done;e=e.value;return b?(d[63]=c.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[63],c.i64.cast([0,1e6])),d[19]),void 0],d[42]=b[0],d[43]=b[1],d[44]=b[2],d[45]=b[3],d[46]=b[4],d[47]=b[5],d[48]=b[6],b):(f=e.item,d[63]=c.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,f.priority,f.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[63],c.i64.cast([0,1e6])),d[19]),void 0],d[42]=b[0],d[43]=b[1],d[44]=b[2],d[45]=b[3],d[46]=b[4],d[47]=b[5],d[48]=b[6],b)})},function(a){return d[50]=new c.Map(),d[50].set("task_id",d[42]),d[50].set("queue_name",d[43]),d[50].set("enqueue_timestamp_ms",d[44]),d[50].set("priority",d[45]),d[50].set("first_executed_timestamp_ms",d[46]),d[50].set("execution_time_ns",d[47]),d[50].set("echo_encoding_execution_time_ns",d[48]),d[51]=new c.Map(),d[51].set("task_metadata",d[50]),d[51].set("action_type",c.i64.cast([0,1])),d[51].set("content_type",c.i64.cast([0,1])),d[51].set("identifiers",void 0),d[51].set("identifiers_v2",d[41]),d[51].set("task_creation_source",void 0),d[51].set("message_payload_source",c.i64.cast([0,2])),d[52]=d[39].get("act_thread_id"),d[39],d[53]=d[39].get("otid"),d[39],c.storedProcedure(b("LSGetLatestEpochKeys"),!1).then(function(a){return a=a,d[54]=a[0],d[55]=a[1],a})},function(a){return d[54]!==void 0?c.sequence([function(a){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))?c.sequence([function(a){return d[66]=c.createArray(),d[71]=(d[66].push(c.i64.cast([0,32])),d[66]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",d[52]].join("")).then(function(a){return a=a,d[67]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[67],void 0,d[33],d[66]).then(function(a){return a=a,d[68]=a[0],a})},function(a){return d[68]?d[69]=!1:d[69]=!0,d[69]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[71]=c.createArray(),void 0!==void 0?d[72]=(d[71].push(void 0),d[71]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[71],c.i64.cast([0,3]))},function(a){return d[70]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[68],c.i64.cast([0,0])).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[70]=d[71]}])},function(a){return d[63]=d[70]}]):c.sequence([function(a){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,2]))?c.sequence([function(a){return d[67]=c.createArray(),d[72]=(d[67].push(c.i64.cast([0,32])),d[67]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",d[53]].join("")).then(function(a){return a=a,d[68]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[68],void 0,d[33],d[67]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]?d[70]=!1:d[70]=!0,d[70]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[72]=c.createArray(),void 0!==void 0?d[73]=(d[72].push(void 0),d[72]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[72],c.i64.cast([0,3]))},function(a){return d[71]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[69],c.i64.cast([0,0])).then(function(a){return a=a,d[72]=a[0],d[73]=a[1],a})},function(a){return d[71]=d[72]}])},function(a){return d[66]=d[71]}]):c.resolve(d[66]=void 0)},function(a){return d[63]=d[66]}])},function(a){return c.blobs.neq(d[63],void 0)?c.sequence([function(a){return d[66]=d[54].get("epoch_keys"),d[54],d[67]=d[66].get("epoch_anon_id"),d[66],d[68]=d[66].get("epoch_root_key"),d[66],d[69]=c.createArray(),d[80]=(d[69].push(c.i64.cast([0,32])),d[69]),c.i64.ge(d[25],c.i64.cast([0,3]))?c.resolve(d[70]=void 0):c.sequence([function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[52]).then(function(a){return a=a,d[80]=a[0],a})},function(a){return d[70]=d[80]}])},function(a){return c.i64.ge(d[25],c.i64.cast([0,4]))?(d[80]="_",d[71]=["message_key_in_epoch",d[80],c.blobs.to_string(d[67]),d[80],"cipher_version",d[80],c.i64.to_string(d[25]),d[80],"thread",d[80],d[52]==null?"":d[52]].join("")):(c.i64.ge(d[25],c.i64.cast([0,3]))?(d[81]="_",d[80]=["message_key_in_epoch",d[81],c.blobs.to_string(d[67]),d[81],"cipher_version",d[81],c.i64.to_string(d[25]),d[81],"thread",d[81],d[52]==null?"":d[52]].join("")):(c.i64.ge(d[25],c.i64.cast([0,2]))?(d[82]="_",d[81]=["message_key_in_epoch",d[82],c.blobs.to_string(d[67]),d[82],"cipher_version",d[82],c.i64.to_string(d[25])].join("")):d[81]=["message_key_in_epoch","_",c.blobs.to_string(d[67])].join(""),d[80]=d[81]),d[71]=d[80]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[72],d[70],d[68],d[69]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[73]?d[74]=!1:d[74]=!0,d[74]?c.resolve(d[75]=void 0):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],c.i64.cast([0,0])).then(function(a){return a=a,d[80]=a[0],d[81]=a[1],a})},function(a){return d[75]=d[80]}])},function(a){return c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,c.blob("MA=="))}).next().then(function(e,f){var a=e.done;e=e.value;return a?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTableUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),d[80]=c.createArray(),void 0!==void 0?d[81]=(d[80].push(void 0),d[80]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get mailbox_root_key_v2: epoch 0 is not available.",d[80],c.i64.cast([0,3]))},function(a){return d[76]=void 0}]):(f=e.item,c.sequence([function(a){return d[80]=c.createArray(),d[88]=(d[80].push(c.i64.cast([0,32])),d[80]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,d[33],d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?c.sequence([function(a){return d[88]=c.i64.of_int32(d[81].length),c.i64.ge(d[88],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[81],c.i64.cast([0,0])).then(function(a){return a=a,d[90]=a[0],d[91]=a[1],a})},function(a){return d[89]=d[90]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return d[82]=d[89]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[88]=c.createArray(),void 0!==void 0?d[89]=(d[88].push(void 0),d[88]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[88],c.i64.cast([0,3]))},function(a){return d[82]=void 0}])},function(a){return c.blobs.neq(d[82],void 0)?d[83]=!0:d[83]=!1,d[83]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[84]=c.createArray(),d[88]=(d[84].push(c.i64.cast([0,32])),d[84]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),d[82],f.epochRootKeyBlob,d[84]).then(function(a){return a=a,d[85]=a[0],a})},function(a){return d[85]!==void 0?c.sequence([function(a){return d[88]=c.i64.of_int32(d[85].length),c.i64.ge(d[88],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[85],c.i64.cast([0,0])).then(function(a){return a=a,d[90]=a[0],d[91]=a[1],a})},function(a){return d[89]=d[90]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return d[86]=d[89]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[88]=c.createArray(),void 0!==void 0?d[89]=(d[88].push(void 0),d[88]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[88],c.i64.cast([0,3]))},function(a){return d[86]=void 0}])},function(a){return c.blobs.neq(d[86],void 0)?d[87]=!0:d[87]=!1,d[87]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[76]=d[86]}]))})},function(a){return c.blobs.neq(d[75],void 0)?c.sequence([function(a){return c.blobs.neq(d[76],void 0)?c.sequence([function(a){return d[86]=c.createArray(),d[90]=(d[86].push(c.i64.cast([0,32])),d[86]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,d[76],d[86]).then(function(a){return a=a,d[87]=a[0],a})},function(a){return d[87]!==void 0?c.sequence([function(a){return d[90]=c.i64.of_int32(d[87].length),c.i64.ge(d[90],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[87],c.i64.cast([0,0])).then(function(a){return a=a,d[92]=a[0],d[93]=a[1],a})},function(a){return d[91]=d[92]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[92]=c.createArray(),void 0!==void 0?d[93]=(d[92].push(void 0),d[92]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[92],c.i64.cast([0,3]))},function(a){return d[91]=void 0}])},function(a){return d[88]=d[91]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[88]=void 0}])},function(a){return c.blobs.neq(d[88],void 0)?d[89]=!0:d[89]=!1,d[89]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[80]=d[88]}]):c.resolve(d[80]=void 0)},function(a){return d[81]=d[66].get("epoch_root_key"),d[66],d[82]=d[66].get("epoch_anon_id"),d[66],d[83]=d[66].get("epoch_id"),d[66],d[84]=new c.Map(),d[84].set("payload_key",d[75]),d[84].set("payload_fallback_key",d[80]),d[84].set("encryption_version",d[25]),d[84].set("epoch_root_key",d[81]),d[84].set("epoch_anon_id",d[82]),d[84].set("epoch_id",d[83]),d[85]=new c.Map(),d[85].set("ope_key",d[63]),d[85].set("message_payload_encryption_keys",d[84]),d[85].set("ocmf_shared_key",f.ocmfClientStateBlob),d[85].set("mailbox_base_salt",d[33]),d[85].set("mailbox_root_key_v2",d[76]),a=[d[85],void 0],d[78]=a[0],d[79]=a[1],a}]):c.resolve((d[80]=new c.Map(),d[80].set("error_code",c.i64.cast([0,26])),d[80].set("stored_procedure","MEBKeyDeriver"),d[80].set("error_message",""),a=[void 0,d[80]],d[78]=a[0],d[79]=a[1],a))},function(a){return a=[d[78],d[79]],d[64]=a[0],d[65]=a[1],a}]):c.resolve((d[66]=new c.Map(),d[66].set("error_code",c.i64.cast([0,25])),d[66].set("stored_procedure","MEBKeyDeriver"),d[66].set("error_message",""),a=[void 0,d[66]],d[64]=a[0],d[65]=a[1],a))},function(a){return a=[d[64],d[65]],d[56]=a[0],d[57]=a[1],a}]):c.resolve((a=[void 0,d[55]],d[56]=a[0],d[57]=a[1],a))},function(e){return d[56]!==void 0?c.sequence([function(a){return d[63]=d[39].get("backup_id"),d[39],d[64]=d[39].get("act_thread_id"),d[39],d[65]=d[39].get("timestamp"),d[39],d[66]=d[39].get("otid"),d[39],c.storedProcedure(b("LSEncryptIdentifiersV2"),c.i64.cast([0,1]),c.i64.cast([0,1]),d[63],d[64],c.i64.from_string(d[65]),d[66],d[56]).then(function(a){return a=a,d[67]=a[0],d[68]=a[1],a})},function(a){return d[69]=d[56].get("message_payload_encryption_keys"),d[56],d[70]=d[69].get("encryption_version"),d[69],d[71]=d[69].get("epoch_anon_id"),d[69],d[72]=d[69].get("epoch_root_key"),d[69],d[73]=d[39].get("act_thread_id"),d[39],d[74]=d[69].get("payload_key"),d[69],d[75]=d[39].get("backup_id"),d[39],d[76]=c.createArray(),d[106]=(d[76].push(c.i64.cast([0,6])),d[76]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[77]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[77],void 0,d[71],d[76]).then(function(a){return a=a,d[78]=a[0],a})},function(a){return d[78]?d[79]=!1:d[79]=!0,d[79]?c.resolve(d[80]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[78],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[80]=d[108]==null?"":d[108]}])},function(a){return d[81]=c.createArray(),d[106]=(d[81].push(c.i64.cast([0,6])),d[81]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[82]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[82],void 0,d[72],d[81]).then(function(a){return a=a,d[83]=a[0],a})},function(a){return d[83]?d[84]=!1:d[84]=!0,d[84]?c.resolve(d[85]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[83],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[85]=d[108]==null?"":d[108]}])},function(a){return d[86]=c.createArray(),d[106]=(d[86].push(c.i64.cast([0,6])),d[86]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[87]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[87],void 0,d[74],d[86]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[88]?d[89]=!1:d[89]=!0,d[89]?c.resolve(d[90]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[88],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[90]=d[108]==null?"":d[108]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[72]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[91]==null?"":d[91],d[73]].join("")).then(function(a){return a=a,d[92]=a[0],a})},function(a){return d[93]=c.createArray(),d[106]=(d[93].push(c.i64.cast([0,6])),d[93]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[94]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[94],void 0,d[92],d[93]).then(function(a){return a=a,d[95]=a[0],a})},function(a){return d[95]?d[96]=!1:d[96]=!0,d[96]?c.resolve(d[97]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[95],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[97]=d[108]==null?"":d[108]}])},function(a){return d[98]=":",c.blobs.neq(d[72],void 0)?c.sequence([function(a){return d[106]=c.createArray(),d[112]=(d[106].push(c.i64.cast([0,18])),d[106]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[72],d[106]).then(function(a){return a=a,d[107]=a[0],a})},function(a){return d[107]!==void 0?c.sequence([function(a){return d[112]=c.i64.of_int32(d[107].length),c.i64.ge(d[112],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[107],c.i64.cast([0,0])).then(function(a){return a=a,d[114]=a[0],d[115]=a[1],a})},function(a){return d[113]=d[114]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[114]=c.createArray(),void 0!==void 0?d[115]=(d[114].push(void 0),d[114]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[114],c.i64.cast([0,3]))},function(a){return d[113]=void 0}])},function(a){return d[108]=d[113]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[112]=c.createArray(),void 0!==void 0?d[113]=(d[112].push(void 0),d[112]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[112],c.i64.cast([0,3]))},function(a){return d[108]=void 0}])},function(a){return c.blobs.neq(d[108],void 0)?d[109]=!0:d[109]=!1,d[109]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[108]).then(function(a){return a=a,d[110]=a[0],a})},function(a){return d[110]!==void 0?d[111]=d[110]:d[111]="encodingfailed",d[99]=d[111]}]):c.resolve(d[99]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[71]).then(function(a){return a=a,d[100]=a[0],a})},function(e){return d[101]=new c.Map(),d[101].set("encryption_version",d[70]),d[101].set("epoch_anon_id",d[100]==null?"":d[100]),d[101].set("message_encryption_values",[d[80],d[98],d[85],d[98],d[90],d[98],d[97]].join("")),d[101].set("root_key_fingerprint",d[99]),d[101].set("backup_id",d[75]),d[102]=c.toJSON(d[101]),d[67]!==void 0?c.sequence([function(e){return d[106]=d[39].get("act_thread_id"),d[39],c.storedProcedure(b("LSLoadAndEncryptProtobufV2"),a[0],d[56],d[106]).then(function(a){return a=a,d[107]=a[0],d[108]=a[1],a})},function(a){return d[107]!==void 0?(d[112]=new c.Map(),d[112].set("protobuf_backup_payload",d[107]),d[112].set("encrypted_identifiers",d[67]),d[112].set("device_id",d[34]),d[112].set("identifiers",d[39]),d[112].set("encryption_keys",d[56]),d[112].set("content_type",c.i64.cast([0,1])),d[112].set("action_type",c.i64.cast([0,1])),d[112].set("value_secret_ref",d[102]),d[112].set("attachment_backup_payload",i.attachmentPayload),d[112].set("extra_data_for_eb_upload",void 0),a=[d[112],void 0,d[51]],d[109]=a[0],d[110]=a[1],d[111]=a[2],a):(a=[void 0,d[108],d[51]],d[109]=a[0],d[110]=a[1],d[111]=a[2],a),a=[d[109],d[110],d[111]],d[103]=a[0],d[104]=a[1],d[105]=a[2],a}]):c.resolve((e=[void 0,d[68],d[51]],d[103]=e[0],d[104]=e[1],d[105]=e[2],e))},function(a){return a=[d[103],d[104],d[105]],d[58]=a[0],d[59]=a[1],d[60]=a[2],a}]):c.resolve((e=[void 0,d[57],d[51]],d[58]=e[0],d[59]=e[1],d[60]=e[2],e))},function(a){return a=[d[58],d[59],d[60]],d[35]=a[0],d[36]=a[1],d[37]=a[2],a}]))})},function(a){return a=[d[35],d[36],d[37]],d[27]=a[0],d[28]=a[1],d[29]=a[2],a}]):c.resolve((d[35]=new c.Map(),d[35].set("error_code",c.i64.cast([0,24])),d[35].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[35].set("error_message",""),e=[void 0,d[35],d[11]],d[27]=e[0],d[28]=e[1],d[29]=e[2],e))},function(a){return a=[d[27],d[28],d[29]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return d[16]=c.i64.of_float(Date.now()),d[17]=c.i64.random(),d[20]="Finishing execution. Execution time: ",d[21]=c.i64.to_string(c.i64.sub(d[16],d[0])),d[22]=" ms",d[18]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadProtobufBackupSerializedPayloadData] ",d[18],d[20],d[18],d[21],d[18],d[22]].join("")),c.i64.eq(c.i64.mod_(d[17],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[23]=",",d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadProtobufBackupSerializedPayloadData",[d[20],d[23],d[21],d[23],d[22]].join(""),d[24],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[12],d[13],d[14]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsUploadProtobufOnly",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUploadProtobufOnly] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSLoadProtobufBackupSerializedPayloadData"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],a})},function(a){return d[2]!==void 0?c.sequence([function(a){return d[15]=d[2].get("encrypted_identifiers"),d[2],d[16]=d[2].get("identifiers"),d[2],d[17]=d[2].get("encryption_keys"),d[2],d[18]=d[2].get("protobuf_backup_payload"),d[2],d[19]=d[15].get("act_thread_id_ocmf_partial"),d[15],d[20]=d[15].get("otid_ocmf_partial"),d[15],d[21]=d[15].get("timestamp_encrypted"),d[15],d[22]=new c.Map(),d[22].set("list_key",d[19]),d[22].set("unique_key",d[20]),d[22].set("sort_key",d[21]),d[23]=d[2].get("value_secret_ref"),d[2],d[24]=new c.Map(),d[24].set("value",""),d[24].set("value_secret_ref",d[23]),d[25]=d[2].get("action_type"),d[2],d[26]=new c.Map(),d[26].set("list_item_id",d[22]),d[26].set("list_item",d[24]),d[26].set("action_type",d[25]),d[27]=d[16].get("server_thread_id"),d[16],d[28]=d[16].get("timestamp"),d[16],d[29]=d[16].get("otid"),d[16],d[30]=d[16].get("act_thread_id"),d[16],d[31]=new c.Map(),d[31].set("server_thread_key",d[27]),d[31].set("timestamp",d[28]),d[31].set("otid",d[29]),d[31].set("wa_thread_id",c.i64.from_string(d[30])),d[32]=d[17].get("mailbox_base_salt"),d[17],c.nativeOperation(b("LSBase64Encode.nop"),d[32]).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=d[17].get("ocmf_shared_key"),d[17],c.nativeOperation(b("LSBase64Encode.nop"),d[34]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[36]=new c.Map(),d[36].set("mailbox_root_key",d[33]==null?"":d[33]),d[36].set("ocmf_client_state_blob",d[35]==null?"":d[35]),d[37]=d[2].get("extra_data_for_eb_upload"),d[2],d[37]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[37]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[53]=new c.Map(),d[60]="ttd",d[54]=d[52].get(d[60]),d[52],d[54]?d[55]=!1:d[55]=!0,d[55]?c.resolve():c.sequence([function(a){return d[54]?d[62]=!1:d[62]=!0,d[62]?c.resolve(d[63]=void 0):c.sequence([function(a){return d[64]=new c.Map(),d[67]="message_tags",d[65]=d[54].get(d[67]),d[54],d[65]?d[66]=!1:d[66]=!0,d[66]?c.resolve():c.sequence([function(a){return d[68]=c.createArray(),d[69]=c.i64.of_int32(d[65].length),c.i64.gt(d[69],c.i64.cast([0,0]))?c.loopAsync(d[69],function(a){return d[70]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[65],d[70]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[73]=(d[68].push(d[71]),d[68])}])}):c.resolve()},function(a){return d[64].set(d[67],d[68])}])},function(a){return d[63]=d[64]}])},function(a){return d[53].set(d[60],d[63])}])},function(a){return d[61]="mt",d[56]=d[52].get(d[61]),d[52],d[56]?d[57]=!1:d[57]=!0,d[57]?c.resolve():c.sequence([function(a){return d[56]?d[62]=!1:d[62]=!0,d[62]?c.resolve(d[63]=void 0):c.sequence([function(a){return d[64]=new c.Map(),d[67]="message_tags",d[65]=d[56].get(d[67]),d[56],d[65]?d[66]=!1:d[66]=!0,d[66]?c.resolve():c.sequence([function(a){return d[68]=c.createArray(),d[69]=c.i64.of_int32(d[65].length),c.i64.gt(d[69],c.i64.cast([0,0]))?c.loopAsync(d[69],function(a){return d[70]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[65],d[70]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[73]=(d[68].push(d[71]),d[68])}])}):c.resolve()},function(a){return d[64].set(d[67],d[68])}])},function(a){return d[63]=d[64]}])},function(a){return d[53].set(d[61],d[63])}])},function(a){return d[58]=d[53].get("mt"),d[53],d[58]!==void 0?(d[62]=new c.Map(),d[66]="message_tags",d[63]=d[58].get(d[66]),d[58],d[63]?d[64]=!1:d[64]=!0,d[64]?0:d[62].set(d[66],d[63]),d[65]=c.toJSON(d[62]),d[59]=d[65]):d[59]=void 0,d[38]=d[59]}]):c.resolve(d[38]=void 0)},function(a){return d[39]=d[15].get("backup_id_ocmf_partial"),d[15],d[40]=d[2].get("device_id"),d[2],d[41]=d[17].get("message_payload_encryption_keys"),d[17],d[42]=d[41].get("epoch_id"),d[41],d[43]=d[17].get("message_payload_encryption_keys"),d[17],d[44]=d[43].get("encryption_version"),d[43],d[45]=d[2].get("content_type"),d[2],d[46]=new c.Map(),d[46].set("mailbox_partial_id",d[39]),d[46].set("action",d[26]),d[46].set("device_id",d[40]),d[46].set("echo_version",c.i64.cast([0,0])),d[46].set("epoch_id",d[42]),d[46].set("trace_id",void 0),d[46].set("encryption_version",d[44]),d[46].set("is_thread",c.i64.eq(d[45],c.i64.cast([0,2]))),d[46].set("raw_identifiers",d[31]),d[46].set("raw_tokens",d[36]),d[46].set("request_id",""),d[46].set("is_instamadillo",!0),d[47]=d[18].get("supplemental_data_encrypted"),d[18],d[47]!==void 0?c.sequence([function(a){return d[52]=d[18].get("protobuf_encrypted"),d[18],d[53]=d[18].get("backup_action"),d[18],d[54]=d[18].get("timestamp_ms"),d[18],d[55]=d[47].get("sk_ciphertext"),d[47],c.nativeOperation(b("LSBase64Encode.nop"),d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return d[57]=d[47].get("sk_hash"),d[47],c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(a){return d[59]=new c.Map(),d[59].set("supplementary_data_key",void 0),d[59].set("encrypted_protobuf",d[52]),d[59].set("key_value_backup_action",d[53]),d[59].set("protobuf_ts_ms",d[54]),d[59].set("supplemental_key_ciphertext",d[56]),d[59].set("supplemental_key_hash",d[58]),d[59].set("message_tags",d[38]),d[48]=d[59]}]):c.resolve((d[52]=d[18].get("protobuf_encrypted"),d[18],d[53]=d[18].get("backup_action"),d[18],d[54]=d[18].get("timestamp_ms"),d[18],d[55]=new c.Map(),d[55].set("supplementary_data_key",void 0),d[55].set("encrypted_protobuf",d[52]),d[55].set("key_value_backup_action",d[53]),d[55].set("protobuf_ts_ms",d[54]),d[55].set("message_tags",d[38]),d[48]=d[55]))},function(a){return d[46].set("key_value_backup_payload",d[48]),d[49]=d[2].get("attachment_backup_payload"),d[2],d[49]!==void 0?d[46].set("attachment_backup_payload",d[49]):0,d[50]=d[2].get("extra_data_for_eb_upload"),d[2],d[50]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[50]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[53]=new c.Map(),d[59]="ttd",d[54]=d[52].get(d[59]),d[52],d[54]?d[55]=!1:d[55]=!0,d[55]?c.resolve():c.sequence([function(a){return d[54]?d[61]=!1:d[61]=!0,d[61]?c.resolve(d[62]=void 0):c.sequence([function(a){return d[63]=new c.Map(),d[66]="message_tags",d[64]=d[54].get(d[66]),d[54],d[64]?d[65]=!1:d[65]=!0,d[65]?c.resolve():c.sequence([function(a){return d[67]=c.createArray(),d[68]=c.i64.of_int32(d[64].length),c.i64.gt(d[68],c.i64.cast([0,0]))?c.loopAsync(d[68],function(a){return d[69]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[64],d[69]).then(function(a){return a=a,d[70]=a[0],d[71]=a[1],a})},function(a){return d[72]=(d[67].push(d[70]),d[67])}])}):c.resolve()},function(a){return d[63].set(d[66],d[67])}])},function(a){return d[62]=d[63]}])},function(a){return d[53].set(d[59],d[62])}])},function(a){return d[60]="mt",d[56]=d[52].get(d[60]),d[52],d[56]?d[57]=!1:d[57]=!0,d[57]?c.resolve():c.sequence([function(a){return d[56]?d[61]=!1:d[61]=!0,d[61]?c.resolve(d[62]=void 0):c.sequence([function(a){return d[63]=new c.Map(),d[66]="message_tags",d[64]=d[56].get(d[66]),d[56],d[64]?d[65]=!1:d[65]=!0,d[65]?c.resolve():c.sequence([function(a){return d[67]=c.createArray(),d[68]=c.i64.of_int32(d[64].length),c.i64.gt(d[68],c.i64.cast([0,0]))?c.loopAsync(d[68],function(a){return d[69]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[64],d[69]).then(function(a){return a=a,d[70]=a[0],d[71]=a[1],a})},function(a){return d[72]=(d[67].push(d[70]),d[67])}])}):c.resolve()},function(a){return d[63].set(d[66],d[67])}])},function(a){return d[62]=d[63]}])},function(a){return d[53].set(d[60],d[62])}])},function(a){return d[58]=d[53].get("ttd"),d[53],d[58]!==void 0?(d[61]=new c.Map(),d[65]="message_tags",d[62]=d[58].get(d[65]),d[58],d[62]?d[63]=!1:d[63]=!0,d[63]?0:d[61].set(d[65],d[62]),d[64]=c.toJSON(d[61]),d[46].set("tags_to_delete",d[64])):0}]):c.resolve()},function(a){return d[51]=c.toJSON(d[46]),a=[d[51],void 0,d[4]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a}]):c.resolve((d[3]?d[15]=!1:d[15]=!0,d[15]?(a=[void 0,void 0,d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a):(a=[void 0,d[3],d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a),a=[d[16],d[17],d[18]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a))},function(a){return d[15]=new c.Map(),d[16]=d[15].set("success",d[5]),d[17]=d[15].set("failure",d[6]),d[18]=d[15].set("context",d[7]),d[19]=c.toJSON(d[15]),d[8]=d[19],d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUploadProtobufOnly] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUploadProtobufOnly",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[8],c.i64.cast([0,50042]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerMuteThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("TaskSerializerMuteThreadV2: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("mailbox_type",b.i64.cast([0,0])),c[11].set("mute_expire_time_ms",e.muteExpireTimeMs),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,144]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerMuteThreadV2StoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,c[7]=e.removeType,b.i64.neq(c[7],void 0)?(c[8]=new b.Map(),c[8].set("thread_key",e.threadKey),c[8].set("remove_type",c[7]),c[8].set("sync_group",e.syncGroup==null?b.i64.cast([0,1]):e.syncGroup),c[9]=b.toJSON(c[8]),f=[c[9],b.i64.cast([0,146]),void 0],c[4]=f[0],c[5]=f[1],c[6]=f[2],f):(d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2],d),e=[c[4],c[5],c[6]],c[0]=e[0],c[1]=e[1],c[2]=e[2],e)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerRemoveThreadStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",["LSSymmetricEncryptionCreateEncryptedString.nop","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,b=a[a.length-1],d=[],e=[];return b.sequence([function(f){return b.sequence([function(e){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[4]=b.createArray(),d[5]=(d[4].push("task ID not found"),d[4]),d[6]=(d[4].push(a[0]),d[4]),d[7]=b.toJSON(d[4]),function(a){b.logger(a).mustfix(a)}(d[7]),g=[void 0,void 0,void 0],d[0]=g[0],d[1]=g[1],d[2]=g[2],g):(f=e.item,b.sequence([function(e){return d[11]=f.offlineThreadingId,d[12]=f.messageId,d[21]=f.threadAttributionSource,d[9]=f.platformRef,d[10]=f.platformToken,d[8]=f.replySourceId,d[13]=f.replySourceType,d[20]=f.sendType,d[22]=f.markThreadRead,d[14]=f.initiatingSource,d[15]=f.skipUrlPreviewGen,d[17]=f.textHasLinks,d[18]=f.dataclassParams,d[19]=f.multitabEnv,d[16]=f.richTextFormatType,b.db.table(12).fetch([[[d[11]]],"optimistic"]).next().then(function(f,g){var e=f.done;f=f.value;return e?(d[23]=b.createArray(),d[24]=(d[23].push("OTID not found"),d[23]),d[25]=(d[23].push(d[11]),d[23]),d[26]=b.toJSON(d[23]),function(a){b.logger(a).mustfix(a)}(d[26]),e=[void 0,void 0,void 0],d[4]=e[0],d[5]=e[1],d[6]=e[2],e):(g=f.item,b.sequence([function(e){return d[30]=g.text,d[27]=g.threadKey,d[31]=g.messageId,d[39]=g.senderId,d[29]=g.stickerId,d[33]=g.mentionOffsets,d[34]=g.mentionLengths,d[28]=g.mentionIds,d[35]=g.mentionTypes,d[38]=g.replyType,d[36]=g.isForwarded,d[32]=g.forwardScore,d[37]=g.hotEmojiSize,b.db.table(9).fetch([[[d[27]]]]).next().then(function(f,h){var e=f.done;f=f.value;return e?(d[40]=b.createArray(),d[41]=(d[40].push("thread not found"),d[40]),d[42]=(d[40].push(d[27]),d[40]),d[43]=b.toJSON(d[40]),function(a){b.logger(a).mustfix(a)}(d[43]),e=[void 0,void 0,void 0],d[23]=e[0],d[24]=e[1],d[25]=e[2],e):(h=f.item,b.sequence([function(c){return d[47]=h.threadName,d[46]=h.threadKey,d[48]=h.mailboxType,d[40]=h.threadType,d[49]=h.capabilities,d[50]=h.capabilities2,d[51]=h.capabilities3,d[52]=h.capabilities4,b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var c=e.done;e=e.value;return c?d[41]=!1:(f=e.item,b.sequence([function(c){return b.islc(b.db.table(2).fetch([[[f.queueName]],"queueNameTaskId"]),0,b.i64.to_float(b.i64.cast([0,1]))).next().then(function(e,f){var c=e.done;e=e.value;return c?d[53]=!1:(f=e.item,d[53]=b.i64.eq(f.taskId,a[0]))})},function(a){return d[41]=d[53]}]))})},function(a){return b.i64.eq(h.authorityLevel,b.i64.cast([0,20]))&&(b.i64.eq(d[40],b.i64.cast([0,2]))||b.i64.eq(d[40],b.i64.cast([0,5]))||b.i64.eq(d[40],b.i64.cast([0,26])))&&d[41]?b.sequence([function(a){return d[56]=d[20]==null?b.i64.cast([0,1]):d[20],b.db.table(9).fetch([[[d[27]]]]).next().then(function(c,e){var a=c.done;c=c.value;return a?d[53]=b.i64.cast([0,1]):(e=c.item,d[71]=e.syncGroup,b.i64.neq(d[71],void 0)?d[70]=d[71]:d[70]=b.i64.cast([0,1]),d[53]=d[70])})},function(a){return d[55]=new b.Map(),d[55].set("thread_id",d[27]),d[55].set("otid",d[11]),d[55].set("source",d[21]==null?b.i64.cast([0,0]):d[21]),d[55].set("send_type",b.i64.cast([0,1])),d[55].set("sync_group",d[53]),d[55].set("mark_thread_read",d[22]),b.i64.eq(d[56],b.i64.cast([0,1]))?b.resolve(d[55].set("text",d[30])):b.i64.eq(d[56],b.i64.cast([0,2]))?b.resolve(b.i64.neq(d[29],void 0)?(d[55].set("sticker_id",d[29]),d[55].set("send_type",d[56])):0):b.i64.eq(d[56],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?b.i64.neq(d[71],void 0)?(d[55].set("url",d[70]),d[55].set("attribution_app_id",d[71]),d[55].set("send_type",d[56])):0:0}]):b.i64.eq(d[56],b.i64.cast([0,3]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,9]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,10]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[70]=void 0:(c=b.item,d[70]=c.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[72]=void 0:(c=b.item,d[72]=c.actionUrl)})},function(a){return d[70]!==void 0?(d[55].set("text",d[30]),d[72]!==void 0?d[55].set("url",d[72]):0,d[55].set("forwarded_share_id",d[70]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,5]))?b.resolve(d[12]!==void 0?(d[55].set("forwarded_msg_id",d[12]),d[55].set("send_type",d[56]),b.i64.neq(d[32],void 0)?d[55].set("forward_score",d[32]):0,d[55].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(d[56],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?(d[55].set("url",d[70]),d[55].set("text",d[30]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.actionUrl,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?(d[55].set("url",d[70]),c("gkx")("3272")?d[55].set("text",d[30]):0,d[55].set("send_type",d[56])):0}]):b.resolve(0)},function(a){return d[66]=d[8]===""?void 0:d[8],d[66]!==void 0?b.i64.neq(d[13],void 0)?(d[70]=new b.Map(),d[70].set("reply_source_id",d[66]),d[70].set("reply_source_type",d[13]),d[70].set("reply_type",d[38]==null?b.i64.cast([0,0]):d[38]),d[70].set("reply_source_attachment_id",void 0),d[55].set("reply_metadata",d[70])):0:0,d[67]=d[28]===""?void 0:d[28],d[67]!==void 0?(d[70]=d[33]===""?void 0:d[33],d[70]!==void 0?(d[71]=d[34]===""?void 0:d[34],d[71]!==void 0?(d[72]=new b.Map(),d[72].set("mention_ids",d[67]),d[72].set("mention_offsets",d[70]),d[72].set("mention_lengths",d[71]),d[72].set("mention_types",d[35]===""?void 0:d[35]),d[55].set("mention_data",d[72])):0):0):0,d[36]!==void 0?d[55].set("is_forwarded",d[36]):0,d[68]=d[9]===""?void 0:d[9],d[68]!==void 0?d[55].set("platform_ref",d[68]):0,d[69]=d[10]===""?void 0:d[10],d[69]!==void 0?d[55].set("platform_token",d[69]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(d[56],a)})?b.i64.neq(d[37],void 0)?d[55].set("hot_emoji_size",d[37]):0:0,b.i64.neq(d[14],void 0)?d[55].set("initiating_source",d[14]):0,d[15]!==void 0?d[55].set("skip_url_preview_gen",d[15]):0,b.i64.neq(d[16],void 0)?d[55].set("rich_text_format_type",d[16]):0,b.resolve()},function(a){return d[17]!==void 0?d[55].set("text_has_links",d[17]):0,d[18]!==void 0?d[55].set("dataclass_params",d[18]):0,d[19]!==void 0?d[55].set("multitab_env",d[19]):0,b.filter(b.db.table(14).fetch([[[d[46],d[39]]]]),function(a){return b.i64.eq(a.threadKey,d[46])&&b.i64.eq(b.i64.cast([0,0]),d[48])&&b.i64.eq(a.contactId,d[39])}).next().then(function(c,e){var a=c.done;c=c.value;return a?d[57]=!1:(e=c.item,b.i64.eq(d[40],b.i64.cast([0,152]))?(d[71]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?d[72]=!1:d[72]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),d[71]),b.i64.cast([0,0])),d[73]=d[49],d[74]=d[50],d[75]=d[51],d[76]=d[52],d[78]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),d[79]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(d[78],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,250]))?d[77]=!1:(b.i64.eq(d[78],b.i64.cast([0,0]))?d[80]=!b.i64.eq(b.i64.and_(d[79],d[73]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,1]))?d[81]=!b.i64.eq(b.i64.and_(d[79],d[74]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,2]))?d[82]=!b.i64.eq(b.i64.and_(d[79],d[75]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,3]))?d[83]=!b.i64.eq(b.i64.and_(d[79],d[76]),b.i64.cast([0,0])):d[83]=!1,d[82]=d[83]),d[81]=d[82]),d[80]=d[81]),d[77]=d[80]),d[72]===d[77]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[70]=d[72]):d[70]=!1,d[57]=d[70])})},function(a){return d[57]?d[55].set("perform_action_as_page",!0):0,d[59]=b.createArray(),b.forEach(b.db.table(14).fetch([[[d[27]]]]),function(a){a=a.item;return d[70]=(d[59].push(a.contactId),d[59])})},function(a){return d[60]=new b.Map(),d[60].set("participants",d[59]),d[60].set("send_payload",d[55]),d[47]!==void 0?d[60].set("thread_name",d[47]):0,b.db.table(312).fetch([[[d[27]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[61]=void 0:(c=b.item,d[61]=c.metadata)})},function(a){return d[60].set("thread_metadata",d[61]),b.forEach(b.db.table(9).fetch([[[d[46]]]]),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:g.offlineThreadingId})})},function(a){return d[61]===void 0||!1?(b.i64.eq(d[40],b.i64.cast([0,5]))||b.i64.eq(d[40],b.i64.cast([0,26]))?(function(a){b.logger(a).mustfix(a)}("For Marketplace & community chat subthreads, thread metadata cannot be null"),a=[void 0,void 0,void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a):(d[73]=b.toJSON(d[60]),a=[d[73],b.i64.cast([0,130]),void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a),a=[d[70],d[71],d[72]],d[63]=a[0],d[64]=a[1],d[65]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,5]))?(d[73]=b.toJSON(d[60]),a=[d[73],b.i64.cast([0,645]),void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,26]))?(d[76]=b.toJSON(d[60]),a=[d[76],b.i64.cast([0,696]),void 0],d[73]=a[0],d[74]=a[1],d[75]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,2]))?(d[79]=b.toJSON(d[60]),a=[d[79],b.i64.cast([0,787]),void 0],d[76]=a[0],d[77]=a[1],d[78]=a[2],a):(d[79]=b.toJSON(d[60]),a=[d[79],b.i64.cast([0,645]),void 0],d[76]=a[0],d[77]=a[1],d[78]=a[2],a),a=[d[76],d[77],d[78]],d[73]=a[0],d[74]=a[1],d[75]=a[2],a),a=[d[73],d[74],d[75]],d[70]=a[0],d[71]=a[1],d[72]=a[2],a),a=[d[70],d[71],d[72]],d[63]=a[0],d[64]=a[1],d[65]=a[2],a),a=[d[63],d[64],d[65]],d[43]=a[0],d[44]=a[1],d[45]=a[2],a}]):b.sequence([function(a){return d[56]=d[20]==null?b.i64.cast([0,1]):d[20],b.db.table(9).fetch([[[d[27]]]]).next().then(function(c,e){var a=c.done;c=c.value;return a?d[53]=b.i64.cast([0,1]):(e=c.item,d[65]=e.syncGroup,b.i64.neq(d[65],void 0)?d[64]=d[65]:d[64]=b.i64.cast([0,1]),d[53]=d[64])})},function(a){return d[55]=new b.Map(),d[55].set("thread_id",d[27]),d[55].set("otid",d[11]),d[55].set("source",d[21]==null?b.i64.cast([0,0]):d[21]),d[55].set("send_type",b.i64.cast([0,1])),d[55].set("sync_group",d[53]),d[55].set("mark_thread_read",d[22]),b.i64.eq(d[56],b.i64.cast([0,1]))?b.resolve(d[55].set("text",d[30])):b.i64.eq(d[56],b.i64.cast([0,2]))?b.resolve(b.i64.neq(d[29],void 0)?(d[55].set("sticker_id",d[29]),d[55].set("send_type",d[56])):0):b.i64.eq(d[56],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?b.i64.neq(d[65],void 0)?(d[55].set("url",d[64]),d[55].set("attribution_app_id",d[65]),d[55].set("send_type",d[56])):0:0}]):b.i64.eq(d[56],b.i64.cast([0,3]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,9]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,10]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[64]=void 0:(c=b.item,d[64]=c.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[66]=void 0:(c=b.item,d[66]=c.actionUrl)})},function(a){return d[64]!==void 0?(d[55].set("text",d[30]),d[66]!==void 0?d[55].set("url",d[66]):0,d[55].set("forwarded_share_id",d[64]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,5]))?b.resolve(d[12]!==void 0?(d[55].set("forwarded_msg_id",d[12]),d[55].set("send_type",d[56]),b.i64.neq(d[32],void 0)?d[55].set("forward_score",d[32]):0,d[55].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(d[56],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?(d[55].set("url",d[64]),d[55].set("text",d[30]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.actionUrl,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?(d[55].set("url",d[64]),c("gkx")("3272")?d[55].set("text",d[30]):0,d[55].set("send_type",d[56])):0}]):b.resolve(0)},function(a){return d[60]=d[8]===""?void 0:d[8],d[60]!==void 0?b.i64.neq(d[13],void 0)?(d[64]=new b.Map(),d[64].set("reply_source_id",d[60]),d[64].set("reply_source_type",d[13]),d[64].set("reply_type",d[38]==null?b.i64.cast([0,0]):d[38]),d[64].set("reply_source_attachment_id",void 0),d[55].set("reply_metadata",d[64])):0:0,d[61]=d[28]===""?void 0:d[28],d[61]!==void 0?(d[64]=d[33]===""?void 0:d[33],d[64]!==void 0?(d[65]=d[34]===""?void 0:d[34],d[65]!==void 0?(d[66]=new b.Map(),d[66].set("mention_ids",d[61]),d[66].set("mention_offsets",d[64]),d[66].set("mention_lengths",d[65]),d[66].set("mention_types",d[35]===""?void 0:d[35]),d[55].set("mention_data",d[66])):0):0):0,d[36]!==void 0?d[55].set("is_forwarded",d[36]):0,d[62]=d[9]===""?void 0:d[9],d[62]!==void 0?d[55].set("platform_ref",d[62]):0,d[63]=d[10]===""?void 0:d[10],d[63]!==void 0?d[55].set("platform_token",d[63]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(d[56],a)})?b.i64.neq(d[37],void 0)?d[55].set("hot_emoji_size",d[37]):0:0,b.i64.neq(d[14],void 0)?d[55].set("initiating_source",d[14]):0,d[15]!==void 0?d[55].set("skip_url_preview_gen",d[15]):0,b.i64.neq(d[16],void 0)?d[55].set("rich_text_format_type",d[16]):0,b.resolve()},function(a){return d[17]!==void 0?d[55].set("text_has_links",d[17]):0,d[18]!==void 0?d[55].set("dataclass_params",d[18]):0,d[19]!==void 0?d[55].set("multitab_env",d[19]):0,b.filter(b.db.table(14).fetch([[[d[46],d[39]]]]),function(a){return b.i64.eq(a.threadKey,d[46])&&b.i64.eq(b.i64.cast([0,0]),d[48])&&b.i64.eq(a.contactId,d[39])}).next().then(function(c,e){var a=c.done;c=c.value;return a?d[57]=!1:(e=c.item,b.i64.eq(d[40],b.i64.cast([0,152]))?(d[65]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?d[66]=!1:d[66]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),d[65]),b.i64.cast([0,0])),d[67]=d[49],d[68]=d[50],d[69]=d[51],d[70]=d[52],d[72]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),d[73]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(d[72],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,250]))?d[71]=!1:(b.i64.eq(d[72],b.i64.cast([0,0]))?d[74]=!b.i64.eq(b.i64.and_(d[73],d[67]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,1]))?d[75]=!b.i64.eq(b.i64.and_(d[73],d[68]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,2]))?d[76]=!b.i64.eq(b.i64.and_(d[73],d[69]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,3]))?d[77]=!b.i64.eq(b.i64.and_(d[73],d[70]),b.i64.cast([0,0])):d[77]=!1,d[76]=d[77]),d[75]=d[76]),d[74]=d[75]),d[71]=d[74]),d[66]===d[71]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[64]=d[66]):d[64]=!1,d[57]=d[64])})},function(a){return d[57]?d[55].set("perform_action_as_page",!0):0,d[59]=b.toJSON(d[55]),a=[d[59],b.i64.cast([0,46]),void 0],d[43]=a[0],d[44]=a[1],d[45]=a[2],a}])},function(a){return a=[d[43],d[44],d[45]],d[23]=a[0],d[24]=a[1],d[25]=a[2],a}]))})},function(a){return a=[d[23],d[24],d[25]],d[4]=a[0],d[5]=a[1],d[6]=a[2],a}]))})},function(a){return a=[d[4],d[5],d[6]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}]))})},function(a){return a=[d[0],d[1]],e[0]=a[0],e[1]=a[1],a}])},function(a){return b.resolve(e)}])}a.__sproc_name__="LSMailboxTaskSerializerSendMessageV2StoredProcedure";b=a;g["default"]=b}),98);
__d("LSTaskSerializerSyncThreadCapabilities",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSMailboxTaskSerializerSyncThreadCapabilitiesStoredProcedure";e.exports=a}),null);
__d("LSIsExperimentCapabilityEnabled.nop",["LSACSExperimentCapability","LSIntEnum","MetaConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("MetaConfig")._("87"),k=c("MetaConfig")._("156");a=function(a,e,f,g){switch((i||(i=d("LSIntEnum"))).toNumber(f)){case c("LSACSExperimentCapability").BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:return(h||(h=b("Promise"))).resolve([k]);case c("LSACSExperimentCapability").INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:return(h||(h=b("Promise"))).resolve([!1]);case c("LSACSExperimentCapability").RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:return(h||(h=b("Promise"))).resolve([j])}return(h||(h=b("Promise"))).resolve([!1])};g["default"]=a}),98);
__d("LSMailboxTaskCompletionApiOnTaskCompletion",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(233).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({success:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSCoreMailboxTaskCompletionApiOnTaskCompletionStoredProcedure";e.exports=a}),null);
__d("LSVoprfHmac.nop",["ACSCipherSuiteModule","ACSTokenHmacUtil","Promise","XPlatReactTextEncoder","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){a=d("ACSCipherSuiteModule").getACSCipherSuiteByValue(d("ACSCipherSuiteModule").VOPRF_RISTRETTO_HMACSHA512.value);if(!a)return(h||(h=b("Promise"))).resolve([void 0]);c=(yield d("ACSTokenHmacUtil").hmac(a.macAlgorithm,new Uint8Array(f).slice(),new(d("XPlatReactTextEncoder").TextEncoder)().encode(e)));return(h||(h=b("Promise"))).resolve([c.buffer])});function c(b,c,d,e){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSTaskSerializerUnauthenticatedTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsExperimentCapabilityEnabled.nop","LSMailboxTaskCompletionApiOnTaskCompletion","LSRemoveUsedTokens","LSVoprfHmac.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.projectName)})},function(e){return d[0]!==void 0?c.sequence([function(e){return a[1]!==void 0?c.sequence([function(a){return d[9]=c.createArray(),d[10]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[10])}),function(a){a=a.item;return d[16]=(d[9].push(a.configId),d[9])})},function(a){return c.sequence([function(a){return d[16]=c.createArray(),d[17]=c.i64.of_int32(d[9].length),c.i64.gt(d[17],c.i64.cast([0,0]))?c.loopAsync(d[17],function(a){return d[19]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],d[19]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return d[22]=(d[16].push(d[20]),d[16])}])}):c.resolve()},function(a){return d[18]=d[16].join(","),d[11]=d[18]}])},function(e){return c.filter(c.db.table(309).fetch(),function(a){return d[9].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,0]),d[0]).then(function(a){return a=a,d[16]=a[0],a})},function(e){return d[16]?c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[20]=c.i64.cast([0,0]):(e=b.item,d[20]=e.failureCount)})},function(b){return c.forEach(c.db.table(311).fetch([[[a[0]]]]),function(a){a=a.item;return c.forEach(c.db.table(311).fetch([[[a.taskId]]]),function(a){var b=a.update;a.item;return b({failureCount:c.i64.add(d[20],c.i64.cast([0,1]))})})})},function(a){return a=[void 0,void 0,c.i64.mul(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.mod_(d[20],c.i64.cast([0,7])))),c.i64.cast([0,500]))],d[17]=a[0],d[18]=a[1],d[19]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[20]=c.createArray(),d[21]=(d[20].push("Unauthenticated Task Serializer: no valid tokens"),d[20]),d[22]=(d[20].push(a[0]),d[20]),d[23]=(d[20].push(d[0]),d[20]),d[24]=c.toJSON(d[20]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]):(f=e.item,c.sequence([function(e){return d[20]=f.tokenId,c.nativeOperation(b("LSVoprfHmac.nop"),a[2]==null?"":a[2],f.sharedSecret).then(function(a){return a=a,d[16]=a[0],a})},function(e){return c.blobs.neq(d[16],void 0)?c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){var b=a.update;a=a.item;return b({redeemLimit:c.i64.sub(a.redeemLimit,c.i64.cast([0,1]))})})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[16]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.nonce).then(function(a){return a=a,d[22]=a[0],a})},function(b){return d[23]=new c.Map(),d[23].set("config_id",f.configId),d[23].set("tag",d[21]==null?"":d[21]),d[23].set("aux",d[22]==null?"":d[22]),d[23].set("project_name",d[0]),d[24]=c.toJSON(d[23]),d[25]=new c.Map(),d[25].set("payload",a[2]==null?"":a[2]),d[25].set("token",d[24]),d[26]=c.toJSON(d[25]),b=[d[26],c.i64.from_string(a[1]),void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}]):c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){return a["delete"]()})},function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[21]=c.createArray(),d[22]=(d[21].push("Unauthenticated Task Serializer: hmac failed"),d[21]),d[23]=(d[21].push(a[0]),d[21]),d[24]=c.toJSON(d[21]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[9]=c.createArray(),d[10]=(d[9].push("Unauthenticated Task Serializer: task has no write label"),d[9]),d[11]=(d[9].push(a[0]),d[9]),d[12]=c.toJSON(d[9]),function(a){c.logger(a).mustfix(a)}(d[12]),b=[void 0,void 0,void 0],d[6]=b[0],d[7]=b[1],d[8]=b[2],b}])},function(a){return a=[d[6],d[7],d[8]],d[2]=a[0],d[3]=a[1],d[4]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[6]=c.createArray(),d[7]=(d[6].push("Unauthenticated Task Serializer: anonymous_task_context row not found"),d[6]),d[8]=(d[6].push(a[0]),d[6]),d[9]=c.toJSON(d[6]),function(a){c.logger(a).mustfix(a)}(d[9]),b=[void 0,void 0,void 0],d[2]=b[0],d[3]=b[1],d[4]=b[2],b}])},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[0]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,1]),d[0]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[6]?c.sequence([function(a){return c.i64.neq(d[4],void 0)?c.resolve(d[8]=!0):c.sequence([function(a){return d[10]=c.createArray(),d[11]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[11])}),function(a){a=a.item;return d[15]=(d[10].push(a.configId),d[10])})},function(a){return c.sequence([function(a){return d[15]=c.createArray(),d[16]=c.i64.of_int32(d[10].length),c.i64.gt(d[16],c.i64.cast([0,0]))?c.loopAsync(d[16],function(a){return d[18]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[10],d[18]).then(function(a){return a=a,d[19]=a[0],d[20]=a[1],a})},function(a){return d[21]=(d[15].push(d[19]),d[15])}])}):c.resolve()},function(a){return d[17]=d[15].join(","),d[12]=d[17]}])},function(a){return c.filter(c.db.table(309).fetch(),function(a){return d[10].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(a,b){b=a.done;a=a.value;return b?d[13]=!0:(a.item,d[13]=!1)})},function(a){return d[8]=d[13]}])},function(a){return d[8]?c.sequence([function(a){return c.filter(c.db.table(310).fetch(),function(a){return a.projectName===d[0]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[10]=void 0:(b=a.item,d[10]=b.taskId)})},function(a){return d[9]=d[10]}]):c.resolve(d[9]=void 0)},function(a){return d[7]=d[9]}]):c.resolve(d[7]=void 0)},function(a){return d[5]=d[7]}]):c.resolve(d[5]=void 0)},function(a){return a=[d[2],d[3],d[4],d[5]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerUnauthenticatedTaskStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerUpdateThreadName",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerUpdateThreadName: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerUpdateThreadName: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("thread_name",e.threadName==null?"":e.threadName),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,32]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerUpdateThreadNameStoredProcedure";e.exports=a}),null);
__d("LSSerializeTask",["LSForceTaskExecutionImmediately","LSTaskSerializerAcsIssueNextSync","LSTaskSerializerDeleteChatHistory","LSTaskSerializerE2eeMessageIntegrityCheckV2","LSTaskSerializerE2eeMetadataThreadIntegrityCheck","LSTaskSerializerEncryptedBackupAction","LSTaskSerializerEncryptedBackupsLoopingUpload","LSTaskSerializerEncryptedBackupsOpenUpload","LSTaskSerializerEncryptedBackupsRestoreWithSerializer","LSTaskSerializerEncryptedBackupsUpload","LSTaskSerializerEncryptedBackupsUploadProtobufOnly","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","LSTaskSerializerSyncThreadCapabilities","LSTaskSerializerUnauthenticatedTask","LSTaskSerializerUpdateThreadName"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return a[1]==="46"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSendMessageV2"),a[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}]):c.sequence([function(e){return a[1]==="144"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerMuteThreadV2"),a[0]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(a){return a=[d[12],c.i64.to_string(d[13]),void 0,void 0],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}]):c.sequence([function(e){return a[1]==="146"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerRemoveThread"),a[0]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(a){return a=[d[16],c.i64.to_string(d[17]),void 0,void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}]):c.sequence([function(e){return a[1]==="32"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUpdateThreadName"),a[0]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],d[22]=a[2],a})},function(a){return a=[d[20],c.i64.to_string(d[21]),void 0,void 0],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}]):c.sequence([function(e){return a[1]==="362"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerAcsIssueNextSync"),a[0]).then(function(a){return a=a,d[24]=a[0],d[25]=a[1],d[26]=a[2],a})},function(a){return a=[d[24],c.i64.to_string(d[25]),void 0,void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}]):c.sequence([function(e){return a[1]==="50015"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsRestoreWithSerializer"),a[0]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],d[30]=a[2],a})},function(a){return a=[d[28],c.i64.to_string(d[29]),void 0,void 0],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}]):c.sequence([function(e){return a[1]==="319"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupAction"),a[0]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],d[34]=a[2],a})},function(a){return a=[d[32],c.i64.to_string(d[33]),void 0,void 0],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}]):c.sequence([function(e){return a[1]==="50026"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUpload"),a[0]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return a=[d[36],c.i64.to_string(d[37]),void 0,void 0],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}]):c.sequence([function(e){return a[1]==="50042"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUploadProtobufOnly"),a[0]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],d[42]=a[2],a})},function(a){return a=[d[40],c.i64.to_string(d[41]),void 0,void 0],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}]):c.sequence([function(e){return a[1]==="700"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMetadataThreadIntegrityCheck"),a[0]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],d[46]=a[2],a})},function(a){return a=[d[44],c.i64.to_string(d[45]),void 0,void 0],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}]):c.sequence([function(e){return a[1]==="705"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMessageIntegrityCheckV2"),a[0]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],d[50]=a[2],a})},function(a){return a=[d[48],c.i64.to_string(d[49]),void 0,void 0],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}]):c.sequence([function(e){return a[1]==="50043"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsLoopingUpload"),a[0]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],d[54]=a[2],a})},function(a){return a=[d[52],c.i64.to_string(d[53]),void 0,void 0],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}]):c.sequence([function(e){return a[1]==="50048"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsOpenUpload"),a[0]).then(function(a){return a=a,d[56]=a[0],d[57]=a[1],a})},function(a){return a=[d[56],c.i64.to_string(d[57]),void 0,void 0],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}]):c.sequence([function(e){return a[1]==="160013"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSyncThreadCapabilities"),a[0]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],d[62]=a[2],a})},function(a){return a=[d[60],c.i64.to_string(d[61]),void 0,void 0],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}]):c.sequence([function(e){return a[1]==="903"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerDeleteChatHistory"),a[0]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],d[66]=a[2],a})},function(a){return a=[d[64],c.i64.to_string(d[65]),void 0,void 0],d[60]=a[0],d[61]=a[1],d[62]=a[2],d[63]=a[3],a}]):c.resolve((e=[a[2],a[1],void 0,void 0],d[60]=e[0],d[61]=e[1],d[62]=e[2],d[63]=e[3],e))},function(a){return a=[d[60],d[61],d[62],d[63]],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}])},function(a){return a=[d[56],d[57],d[58],d[59]],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}])},function(a){return a=[d[52],d[53],d[54],d[55]],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}])},function(a){return a=[d[48],d[49],d[50],d[51]],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}])},function(a){return a=[d[44],d[45],d[46],d[47]],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}])},function(a){return a=[d[40],d[41],d[42],d[43]],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}])},function(a){return a=[d[36],d[37],d[38],d[39]],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}])},function(a){return a=[d[32],d[33],d[34],d[35]],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}])},function(a){return a=[d[28],d[29],d[30],d[31]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}])},function(a){return a=[d[24],d[25],d[26],d[27]],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}])},function(a){return a=[d[20],d[21],d[22],d[23]],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}])},function(a){return a=[d[16],d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}])},function(a){return a=[d[12],d[13],d[14],d[15]],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}])},function(a){return a=[d[8],d[9],d[10],d[11]],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}])},function(e){return a[3]?c.resolve((d[1]==="60009"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60009"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[8]=e[0],d[9]=e[1],d[10]=e[2],d[11]=e[3],e):(d[1]==="60006"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60006"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[12]=e[0],d[13]=e[1],d[14]=e[2],d[15]=e[3],e):(d[1]==="60008"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60008"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[16]=e[0],d[17]=e[1],d[18]=e[2],d[19]=e[3],e):(d[1]==="60011"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60011"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[20]=e[0],d[21]=e[1],d[22]=e[2],d[23]=e[3],e):(d[1]==="765"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","765"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[24]=e[0],d[25]=e[1],d[26]=e[2],d[27]=e[3],e):(d[1]==="1006"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","1006"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[28]=e[0],d[29]=e[1],d[30]=e[2],d[31]=e[3],e):(d[1]==="160009"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","160009"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[32]=e[0],d[33]=e[1],d[34]=e[2],d[35]=e[3],e):(d[1]==="761"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","761"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[36]=e[0],d[37]=e[1],d[38]=e[2],d[39]=e[3],e):(d[1]==="1018"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","1018"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[40]=e[0],d[41]=e[1],d[42]=e[2],d[43]=e[3],e):(d[1]==="632"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","632"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[44]=e[0],d[45]=e[1],d[46]=e[2],d[47]=e[3],e):(d[1]==="384"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","384"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[48]=e[0],d[49]=e[1],d[50]=e[2],d[51]=e[3],e):(d[1]==="384"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","384"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[52]=e[0],d[53]=e[1],d[54]=e[2],d[55]=e[3],e):(e=[d[0],d[1],d[2],d[3]],d[52]=e[0],d[53]=e[1],d[54]=e[2],d[55]=e[3],e),e=[d[52],d[53],d[54],d[55]],d[48]=e[0],d[49]=e[1],d[50]=e[2],d[51]=e[3],e),e=[d[48],d[49],d[50],d[51]],d[44]=e[0],d[45]=e[1],d[46]=e[2],d[47]=e[3],e),e=[d[44],d[45],d[46],d[47]],d[40]=e[0],d[41]=e[1],d[42]=e[2],d[43]=e[3],e),e=[d[40],d[41],d[42],d[43]],d[36]=e[0],d[37]=e[1],d[38]=e[2],d[39]=e[3],e),e=[d[36],d[37],d[38],d[39]],d[32]=e[0],d[33]=e[1],d[34]=e[2],d[35]=e[3],e),e=[d[32],d[33],d[34],d[35]],d[28]=e[0],d[29]=e[1],d[30]=e[2],d[31]=e[3],e),e=[d[28],d[29],d[30],d[31]],d[24]=e[0],d[25]=e[1],d[26]=e[2],d[27]=e[3],e),e=[d[24],d[25],d[26],d[27]],d[20]=e[0],d[21]=e[1],d[22]=e[2],d[23]=e[3],e),e=[d[20],d[21],d[22],d[23]],d[16]=e[0],d[17]=e[1],d[18]=e[2],d[19]=e[3],e),e=[d[16],d[17],d[18],d[19]],d[12]=e[0],d[13]=e[1],d[14]=e[2],d[15]=e[3],e),e=[d[12],d[13],d[14],d[15]],d[8]=e[0],d[9]=e[1],d[10]=e[2],d[11]=e[3],e),e=[d[8],d[9],d[10],d[11]],d[4]=e[0],d[5]=e[1],d[6]=e[2],d[7]=e[3],e)):c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUnauthenticatedTask"),a[0],d[1],d[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a})},function(a){return c.i64.neq(d[11],void 0)?c.storedProcedure(b("LSForceTaskExecutionImmediately"),d[11]):c.resolve()},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,d[10]],d[4]=a[0],d[5]=a[1],d[6]=a[2],d[7]=a[3],a}])},function(a){return a=[d[4],d[5],d[6],d[7]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreSerializeTaskStoredProcedure";e.exports=a}),null);
__d("LSSerializeTaskStoredProcedure",["LSSerializeTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.taskId;d[1]=b.taskLabel;d[2]=b.taskValue;d[3]=b.requiresAuthentication;return c("LSSerializeTask").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSBeginHandlingPendingTasksForQueue2",["I64","LSFactory","LSIntEnum","LSPendingTasksPluginType","LSSerializeTaskStoredProcedure","LSShape","LSVec","Promise","ReQL","XPlatReactCrypto","asyncToGeneratorRuntime","gkx","isNativeTask"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=500,l=3e4,m=5,n=50,o=7;function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield a.lightspeed_task_context.get(b));return a==null||a.requiresAuthentication});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));return a==null?{context:void 0,failureCount:(i||(i=d("I64"))).neg_one,httpUrlOverride:void 0,minTimeToSyncTimestampMs:i.neg_one,pluginType:(j||(j=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").LS_BROKER),queueName:""}:a});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b)));return a==null?0:(i||(i=d("I64"))).to_float(a.lastSyncRequestTimestampMs)});return u.apply(this,arguments)}function v(a,b,c){b=(i||(i=d("I64"))).equal(a.failureCount,(i||(i=d("I64"))).zero)||b;if(b)return 0;b=(i||(i=d("I64"))).to_float(a.failureCount)>o?(i||(i=d("I64"))).to_float(a.failureCount)-o:(i||(i=d("I64"))).to_float(a.failureCount);a=Math.min((1<<Math.min(b-1,o))*k,l);b=c+a;return Math.max(b-Date.now(),0)}function w(){var a=Array.from(d("XPlatReactCrypto").getRandomValues(new Uint32Array(2)));a[0]>>>=1;return(i||(i=d("I64"))).add(i.lsl_(i.of_float(a[0]),32),i.of_float(a[1]))}function x(){var a=(i||(i=d("I64"))).of_float(Date.now());return i.and_(i.or_(i.lsl_(a,22),i.and_(w(),i.castExn([0,4194303]))),i.castExn([2147483647,4294967295]))}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=x(),e=(yield a.network_requests.get(b,(i||(i=d("I64"))).neg_one));e==null?yield a.network_requests.add({epochId:c,failureCount:(i||(i=d("I64"))).zero,lastSentTimestampMs:i.zero,lastSyncRequestTimestampMs:i.of_float(Date.now()),syncDatabaseId:i.neg_one,taskQueueName:b}):yield a.network_requests.put(babelHelpers["extends"]({},e,{epochId:c,lastSyncRequestTimestampMs:(i||(i=d("I64"))).of_float(Date.now())}));return c});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b).filter(function(a){return a.epochId!=null})))!=null});return B.apply(this,arguments)}function C(a,b,c){var e=(i||(i=d("I64"))).to_float(a.minTimeToSyncTimestampMs),f=Date.now();e=e-f;f=e<=0;return f?v(a,b,c):e}function D(a){return a.httpUrlOverride!=null||(i||(i=d("I64"))).to_float(a.failureCount)>o}function E(a){return a.timeoutTimestampMs!=null?(i||(i=d("I64"))).to_float(a.timeoutTimestampMs)<=Date.now():!1}function F(a){return a===90..toString()||a===130..toString()||a===153..toString()}function G(a,b,c,d,e){e=e===0?void 0:e;return{failureCount:e,label:a,payload:b,queueName:c,taskId:d}}function H(a,b,c){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield c("LSSerializeTaskStoredProcedure")(c("LSFactory")(a),{requiresAuthentication:e,taskId:b.taskId,taskLabel:b.context,taskValue:b.taskValue}));e=a[0];var f=a[1];a[2];a=a[3];if(e==null){if(a!=null)return{minRetryDelayMs:a};return}return G(f,e,b.queueName,b.taskId,(i||(i=d("I64"))).to_float(b.failureCount))});return I.apply(this,arguments)}function J(a,b,c){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(b.context==null){yield a.pending_tasks["delete"](b.taskId);return}var d=E(b);if(d){yield a.pending_tasks["delete"](b.taskId);return}return H(a,b,c)});return K.apply(this,arguments)}function L(a,b){b=b>=(c("gkx")("26373")&&a===String(207)?n:m)||F(a);return!b}function M(a,b){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield a.pending_tasks.get(b.taskId));c!=null&&(i||(i=d("I64"))).equal(b.firstExecutedTimestampMs,(i||(i=d("I64"))).zero)&&(yield a.pending_tasks.put(babelHelpers["extends"]({},c,{firstExecutedTimestampMs:(i||(i=d("I64"))).of_float(Date.now())})))});return N.apply(this,arguments)}function O(a,b){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c.length===0)return{epochId:void 0,tasks:[]};var e=[],f=c[0].httpUrlOverride,g=(yield (h||(h=b("Promise"))).all(c.map(function(b){return p(a,b.taskId)}))).some(Boolean);for(c of c){var j=c.httpUrlOverride===f,k=(yield p(a,c.taskId))===g;yield M(a,c);if(!j||!k)break;j=(yield J(a,c,g));if(j!=null&&j.payload!=null)e.push(j);else if((j==null?void 0:j.minRetryDelayMs)!=null){k=(yield a.pending_tasks.get(c.taskId));if(k!=null){yield a.pending_tasks.put(babelHelpers["extends"]({},k,{failureCount:(i||(i=d("I64"))).add((k=k.failureCount)!=null?k:(i||(i=d("I64"))).zero,i.one),minTimeToSyncTimestampMs:i.add(j.minRetryDelayMs,i.of_float(Date.now()))}))}}else yield a.pending_tasks["delete"](c.taskId);if(!L(c.context,e.length))break}return{epochId:void 0,tasks:e}});return P.apply(this,arguments)}function Q(a,b,c,d,e){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e){e===void 0&&(e=!0);b=(yield O(a,b));var f=b.tasks;if(f.length===0)return{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:!1,workItemType:4};if(e===!0){f=(yield y(a,c));b.epochId=f}e=(yield r(a,c));return{httpUrlOverride:e.httpUrlOverride,networkPayload:b,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:D(e),workItemType:d}});return R.apply(this,arguments)}function S(a,b,c){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield r(a,b)),g=(yield t(a,b));f=C(f,e,g);e=f!==0;if(e)return[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:f,queueName:b,skipRealtimeGateway:!1,workItemType:3}];g=[];e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));f=e.filter(c("isNativeTask"));if(f.length>0){f=(yield Q(a,f,b,2,c("gkx")("4778")===!0));g.push(f)}f=e.filter(function(a){return!c("isNativeTask")(a)});if(f.length>0){e=(yield Q(a,f,b,1));g.push(e)}return g});return T.apply(this,arguments)}function U(a,b,c){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=!(yield A(a,b));return d?S(a,b,c):[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:b,skipRealtimeGateway:!1,workItemType:4}]});return V.apply(this,arguments)}function a(a,b){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.ignoreSoftDelay;b=b.queueName;a=(yield U(a,b,e));return a.map(function(a){var b;return d("LSShape").ofRecord({network_payload:d("LSShape").ofRecord({epoch_id:(b=a.networkPayload)==null?void 0:b.epochId,tasks:c("LSVec").ofArray(((b=(b=a.networkPayload)==null?void 0:b.tasks)!=null?b:[]).map(function(a){var b;return d("LSShape").ofRecord({failure_count:a.failureCount!=null?(i||(i=d("I64"))).of_float(a.failureCount):void 0,label:(b=a.label)!=null?b:void 0,payload:a.payload,queue_name:a.queueName,task_id:a.taskId})}))}),next_sync_ms:a.nextSyncMs!=null?(i||(i=d("I64"))).of_float(a.nextSyncMs):void 0,queue_name:a.queueName,skip_realtime_gateway:a.skipRealtimeGateway,work_item_type:(j||(j=d("LSIntEnum"))).ofNumber(a.workItemType)})})});return W.apply(this,arguments)}a._updateTaskIfNeeded=M;a._getHeadOfNormalQueue=r;a._lastSyncRequestTimestampForQueue=t;a._exponentialBackoffForNormalQueue=v;a._generateNewEpoch=x;a._openNewEpochForQueue=y;a._isEpochOpenForQueue=A;a._calculateDelayForNormalQueue=C;a._queueShouldSkipRealtimeGateway=D;a._isNativeTask=c("isNativeTask");a._taskIsTimedOut=E;a._taskShouldStopBatching=F;a._buildTaskPayloadExpressionForNormalTaskWithParameters=G;a._buildTaskPayloadExpressionForValidatedNormalTask=H;a._buildTaskPayloadExpressionForUnvalidatedNormalTask=J;a._workForNormalQueueWithoutDelay=Q;a._workForNormalQueueWithClosedEpoch=S;a._buildWorkForNormalQueue=U;a._buildNetworkPayloadShapeForTasks=O;a._canContinueBatchingForQueue=L;g["default"]=a}),98);
__d("LSDataTraceFlushDeferred",["MetaConfig","Promise","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("LSDataTraceFlush").__setRef("LSDataTraceFlushDeferred");function a(a){if(!c("MetaConfig")._("62"))return(h||(h=b("Promise"))).resolve(function(){});else return i.load().then(function(b){return b.flushExpiredDataTraces(a)})}g.watchForExpiredTraces=a}),98);
__d("LSDatabaseProviderType",[],(function(a,b,c,d,e,f){"use strict";function a(a){return g(a.persistenceTypes)}function g(a){return a.includes("indexeddb")}f.isProviderPersisted=a;f.hasPersistentType=g}),66);
__d("LSJSONOp",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({BLOCK:1,LOAD:2,STORE:3,STORE_ARRAY:4,CALL_STORED_PROCEDURE:5,CALL_NATIVE_TYPE_OPERATION:6,CALL_NATIVE_OPERATION:7,LIST:8,UNDEFINED:9,INFINITY:10,NAN:11,RETURN:12,BOOL_TO_STR:13,BLOBS_TO_STRING:14,BLOBS_OF_STRING:15,TO_BLOB:16,I64_OF_FLOAT:17,I64_TO_FLOAT:18,I64_FROM_STRING:19,I64_TO_STRING:20,READ_GK:21,READ_QE:22,IF:23,OR:24,AND:25,NOT:26,IS_NULL:27,ENFORCE_NOT_NULL:28,GENERIC_EQUAL:29,I64_EQUAL:30,BLOB_EQUAL:31,GENERIC_NOT_EQUAL:32,I64_NOT_EQUAL:33,BLOB_NOT_EQUAL:34,GENERIC_GREATER_THAN:35,I64_GREATER_THAN:36,BLOB_GREATER_THAN:37,GENERIC_GREATER_THAN_OR_EQUAL:38,I64_GREATER_THAN_OR_EQUAL:39,BLOB_GREATER_THAN_OR_EQUAL:40,GENERIC_LESS_THAN:41,I64_LESS_THAN:42,BLOB_LESS_THAN:43,GENERIC_LESS_THAN_OR_EQUAL:44,I64_LESS_THAN_OR_EQUAL:45,BLOB_LESS_THAN_OR_EQUAL:46,THROW:47,LOG_CONSOLE:48,LOGGER_LOG:49,NATIVE_OP_ARRAY_CREATE:50,NATIVE_OP_ARRAY_APPEND:51,NATIVE_OP_ARRAY_GET_SIZE:52,NATIVE_OP_MAP_CREATE:53,NATIVE_OP_MAP_GET:54,NATIVE_OP_MAP_SET:55,NATIVE_OP_MAP_KEYS:56,NATIVE_OP_MAP_DELETE:57,NATIVE_OP_MAP_HAS:58,NATIVE_OP_STR_JOIN:59,NATIVE_OP_CURRENT_TIME:60,NATIVE_OP_JSON_STRINGIFY:61,NATIVE_OP_RNG_NUM:62,NATIVE_OP_LOCALIZATION_SUPPORTED:63,NATIVE_OP_LOCALIZATION_SUPPORTED_V2:64,NATIVE_OP_RESOLVE_LOCALIZED:65,NATIVE_OP_RESOLVE_LOCALIZED_V2:66,ADD:68,I64_ADD:69,I64_CAST:70,READ_JUSTKNOB:71,READ_IGGK:72,GET_RUN_MODE:73,STR_TRIM:74,STR_REPLACE:75,JOIN:76,STR_LIKE:77,LENGTH:78,IN:79,IN_VEC:80,SUB:81,MUL:82,DIV:83,MOD:84,I64_SUB:85,I64_MUL:86,I64_DIV:87,I64_MOD:88,I64_IN:89,I64_IN_VEC:90,BITWISE_LEFT_SHIFT:91,BITWISE_RIGHT_SHIFT:92,ARITHMETIC_RIGHT_SHIFT:93,BITWISE_AND:94,BITWISE_OR:95,BITWISE_XOR:96,TERNARY:97,XOR:98,NULLISH_COALESE:99,READ_COLUMN:100,READ_COLUMN_REF:101,READ_GROUP_COUNT:102,COMMENT:103,IMPORT:104,LOOP:105,QUERY_COMPARISON_EQUAL:106,QUERY_COMPARISON_NOT_EQUAL:107,QUERY_COMPARISON_GREATER_THAN:108,QUERY_COMPARISON_GREATER_THAN_OR_EQUAL:109,QUERY_COMPARISON_LESS_THAN:110,QUERY_COMPARISON_LESS_THAN_OR_EQUAL:111,QUERY_MERGE_CONSTRAINTS:112,QUERY_FETCH_ROWS:113,QUERY_FILTER_ROWS:114,QUERY_SORT_ROWS_BY:115,QUERY_DELETE_ROWS:116,QUERY_SLICE_ROWS:117,QUERY_COUNT_ROWS:118,QUERY_PEEK_NEXT_ROW_ID:119,QUERY_UPDATE_ROWS:120,QUERY_INSERT_ROWS:121,QUERY_PUT_ROWS:122,QUERY_FOREACH_ROW:123,QUERY_SELECT_MATCH_ROW:124,QUERY_CURSOR_SLICE:125,QUERY_GROUP_BY:126,SUB_STRING:127});c=a;f["default"]=c}),66);
__d("LSSelectOrder",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["ASC","DESC"]);c=a;f["default"]=c}),66);
__d("LSDatascriptJSONEval",["FBLogger","LS","isPromise"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["2"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);j=function(){return a};return a}function k(a,b,d){if((h||(h=c("isPromise")))(a))return a.then(b,d);try{return b(a)}catch(a){if(d)return d(a);else throw a}}a=function(){function a(a,b,d,e){var f=this;e===void 0&&(e=[]);this.$4={};this.$5=[];this.$6=null;this.$7=function(a){return k(f.$8(a),function(a){return a},function(b){c("FBLogger")("messenger_web_product").catching(b).mustfix("Error evaluating step op: %s",Array.isArray(a)?a[0]:"<primitive value>");throw b})};this.$1=b;this.$2=a;this.$3=d;for(b=0;b<e.length;b++)this.$4[b]=e[b]}var d=a.prototype;d.eval=function(){return this.$2==null?this.$1.resolve([]):this.$1.resolve(this.$7(this.$2.step))};d.$8=function(a){var d=this;if(!Array.isArray(a))return a;var e=a[0];a=a.slice(1);var f=a;switch(e){case 8:return f.map(this.$7);case 2:return this.$4[f[0]];case 3:return k(this.$7(f[1]),function(a){return d.$4[f[0]]=a});case 4:return k(this.$7(f[2]),function(a){var b=f[0],c=f[1];for(var e=0;e<c;e++,b++)d.$4[b]=a[e];return a});case 12:a=f[0];e=f[1];var g=[];for(a=a;a<e;a++)g[a]=this.$4[a];return g;case 1:var h;a=function(a){h=k(h,function(){return d.$7(f[a])})};for(e=0;e<f.length;e++)a(e);return h;case 5:return(g=this.$1).storedProcedure.apply(g,f.map(this.$7));case 6:return(e=this.$1).nativeTypeOperation.apply(e,f.map(this.$7));case 7:return(a=this.$1).nativeOperation.apply(a,f.map(this.$7));case 9:return;case 10:return Infinity;case 11:return NaN;case 13:return this.$7(f[0])?"1":"0";case 14:return this.$1.blobs.to_string(this.$7(f[0]));case 15:return this.$1.blobs.of_string(this.$7(f[0]));case 16:return this.$1.blob(this.$7(f[0]));case 17:return this.$1.i64.of_float(this.$7(f[0]));case 18:g=this.$7(f[0]);return g!=null?this.$1.i64.to_float(g):void 0;case 19:return this.$1.i64.from_string(this.$7(f[0]));case 70:return this.$1.i64.cast(this.$7(f[0]));case 20:return this.$1.i64.to_string(this.$7(f[0]));case 21:return(e=this.$3)==null?void 0:(a=e.gk)==null?void 0:a[f[0]];case 22:var l;g=f[0];e=f[1];a=f[2];var m=f[3];l=(l=this.$3)==null?void 0:(l=l.qe)==null?void 0:(l=l[g])==null?void 0:(g=l[e])==null?void 0:g[a];if(l==null)return l;switch(m){case"BOOL":case"STR":return l;case"I64":if(typeof l!=="object")throw c("FBLogger")("messenger_web_product").mustfixThrow("Cannot convert value to string");return this.$1.i64.from_string(l.toString())}return;case 23:if(this.$7(f[0]))return this.$7(f[1]);else if(f[2]!=null)return this.$7(f[2]);return;case 24:return this.$7(f[0])||this.$7(f[1]);case 25:return this.$7(f[0])&&this.$7(f[1]);case 26:return!this.$7(f[0]);case 27:return this.$7(f[0])==null;case 28:return this.$1.notnull(this.$7(f[0]));case 29:return this.$7(f[0])===this.$7(f[1]);case 30:return this.$1.i64.eq(this.$7(f[0]),this.$7(f[1]));case 31:return this.$1.blobs.eq(this.$7(f[0]),this.$7(f[1]));case 32:return this.$7(f[0])!==this.$7(f[1]);case 33:return this.$1.i64.neq(this.$7(f[0]),this.$7(f[1]));case 34:return this.$1.blobs.neq(this.$7(f[0]),this.$7(f[1]));case 35:return this.$7(f[0])>this.$7(f[1]);case 36:return this.$1.i64.gt(this.$7(f[0]),this.$7(f[1]));case 37:return this.$1.blobs.gt(this.$7(f[0]),this.$7(f[1]));case 38:return this.$7(f[0])>=this.$7(f[1]);case 39:return this.$1.i64.ge(this.$7(f[0]),this.$7(f[1]));case 40:return this.$1.blobs.ge(this.$7(f[0]),this.$7(f[1]));case 41:return this.$7(f[0])<this.$7(f[1]);case 42:return this.$1.i64.lt(this.$7(f[0]),this.$7(f[1]));case 43:return this.$1.blobs.lt(this.$7(f[0]),this.$7(f[1]));case 44:return this.$7(f[0])<=this.$7(f[1]);case 45:return this.$1.i64.le(this.$7(f[0]),this.$7(f[1]));case 46:return this.$1.blobs.le(this.$7(f[0]),this.$7(f[1]));case 47:return this.$1["throw"](f[0]);case 48:return this.$1.print(this.$7(f[0]));case 49:e=this.$7(f[0]);g=f[1];a=this.$1.logger(e);switch(g){case"mustfix":return a.mustfix(e);case"info":return a.info(e);case"warn":return a.warn(e);case"debug":return a.debug(e);default:throw c("FBLogger")("messenger_web_product").mustfixThrow("Invalid logger level %s",g)}case 50:return f.length===0?this.$1.createArray():(m=this.$1).createArrayWithElements.apply(m,this.$7(f[0]));case 51:l=this.$7(f[0]);l.push(this.$7(f[1]));return l;case 52:return this.$1.i64.of_int32(this.$7(f[0]).length);case 53:return new this.$1.Map();case 54:return this.$7(f[0]).get(this.$7(f[1]));case 55:return this.$7(f[0]).set(this.$7(f[1]),this.$7(f[2]));case 56:return this.$7(f[0]).keys();case 57:return this.$7(f[0])["delete"](this.$7(f[1]));case 58:return this.$7(f[0]).has(this.$7(f[1]));case 59:return this.$7(f[0]).join(this.$7(f[1])||"");case 60:return this.$1.i64.of_float(Date.now());case 61:return this.$1.toJSON(this.$7(f[0]));case 62:return this.$1.i64.random();case 63:case 64:return!0;case 65:return this.$1.localizeAsync(this.$7(f[0]),this.$7(f[1]));case 66:return this.$1.localizeV2Async(this.$7(f[0]),this.$7(f[1]));case 68:return this.$7(f[0])+this.$7(f[1]);case 69:return this.$1.i64.add(this.$7(f[0]),this.$7(f[1]));case 71:return(a=this.$3)==null?void 0:(e=a.justknob)==null?void 0:e[f[0]];case 72:return(g=this.$3)==null?void 0:(m=g.iggk)==null?void 0:m[f[0]];case 100:return this.$5[f[0]][f[1]];case 101:if(this.$6==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("Attempting to read column ref when none exist!");return this.$6[f[0]];case 102:return this.$5[this.$7(f[0])].group_count;case 73:return this.$1.rm;case 74:return this.$7(f[0]).trim();case 75:return this.$7(f[0]).split(this.$7(f[1])).join(this.$7(f[2]));case 76:return f.map(this.$7).join("");case 77:return this.$1.like(this.$7(f[0]),this.$7(f[1]));case 78:return[0,this.$7(f[0]).length];case 79:l=f.map(this.$7);a=l[0];e=l.slice(1);return e.includes(a);case 80:return this.$7(f[1]).includes(this.$7(f[0]));case 81:return this.$7(f[0])-this.$7(f[1]);case 82:return this.$7(f[0])*this.$7(f[1]);case 83:return this.$7(f[0])/this.$7(f[1]);case 84:return this.$7(f[0])%this.$7(f[1]);case 91:return this.$1.i64.lsl_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 92:return this.$1.i64.lsr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 93:return this.$1.i64.asr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 94:return this.$1.i64.and_(this.$7(f[0]),this.$7(f[1]));case 95:return this.$1.i64.or_(this.$7(f[0]),this.$7(f[1]));case 96:return this.$1.i64.xor(this.$7(f[0]),this.$7(f[1]));case 85:return this.$1.i64.sub(this.$7(f[0]),this.$7(f[1]));case 86:return this.$1.i64.mul(this.$7(f[0]),this.$7(f[1]));case 87:return this.$1.i64.div(this.$7(f[0]),this.$7(f[1]));case 88:return this.$1.i64.mod_(this.$7(f[0]),this.$7(f[1]));case 89:g=f.map(this.$7);var n=g[0];m=g.slice(1);return m.some(function(a){return d.$1.i64.eq(n,a)});case 90:var o=this.$7(f[0]);return this.$7(f[1]).some(function(a){return d.$1.i64.eq(o,a)});case 97:return this.$7(f[0])?this.$7(f[1]):this.$7(f[2]);case 98:l=this.$7(f[0]);e=this.$7(f[1]);return(l||e)&&!(l&&e);case 99:return(a=this.$7(f[0]))!=null?a:this.$7(f[1]);case 103:return;case 104:return b.call(null,f[0]);case 105:g=function(){var b=d.$7(f[0]),e=f[1],g=c("LS").n,a,h=function(b){a=k(a,function(){d.$4[e]=b;return d.$7(f[2])})};for(var l=g(j());d.$1.i64.lt(l,b);l=d.$1.i64.add(l,g(i())))h(l);return{v:a}}();if(typeof g==="object")return g.v;case 106:return this.$7(f[0]);case 107:throw c("FBLogger")("messenger_web_product").mustfixThrow("not equal query comparison operator not supported");case 108:return{gt:this.$7(f[0])};case 109:return{gte:this.$7(f[0])};case 110:return{lt:this.$7(f[0])};case 111:return{lte:this.$7(f[0])};case 112:return f.length===1?this.$7(f[0]):(m=this.$1).merge.apply(m,f.map(this.$7));case 113:l=f[0];e=f[1];a=f.slice(2);g=a.map(this.$7);switch(e){case"ASC":return(m=this.$1.db.table(l)).fetch.apply(m,g);case"DESC":return(a=this.$1.db.table(l)).fetchDesc.apply(a,g)}return;case 114:return this.$1.filter(this.$7(f[0]),function(a){d.$6=a;a=d.$7(f[1]);d.$6=null;return a});case 115:return(e=this.$1).sortBy.apply(e,f.map(this.$7));case 116:return this.$1.forEach(this.$7(f[0]),function(a){return a["delete"]()});case 117:return this.$1.islc(this.$7(f[0]),0,this.$7(f[1]));case 118:return this.$1.count(this.$7(f[0]));case 119:return this.$1.db.table(f[0]).peekNextAutoIncrementId();case 120:return this.$1.forEach(this.$7(f[0]),function(a){var b=a.item;a=a.update;var c={};d.$6=b;for(b=1;b<f.length;b+=2)c[f[b]]=d.$7(f[b+1]);d.$6=null;return a(c)});case 121:m=f[0];l={};for(a=1;a<f.length;a+=2)l[f[a]]=this.$7(f[a+1]);return this.$1.db.table(m).add(l);case 122:g=f[0];e={};for(a=1;a<f.length;a+=2)e[f[a]]=this.$7(f[a+1]);return this.$1.db.table(g).put(e);case 123:return this.$1.forEach(this.$7(f[0]),function(a){a=a.item;d.$5[f[1]]=a;return d.$7(f[2])});case 124:return this.$7(f[0]).next().then(function(a){var b=a.done;a=a.value;if(b)return d.$7(f[3]);else{b=f[1];if(b!=null){d.$5[b]=a.item;return d.$7(f[2])}}return 0});case 125:return this.$7(f[0]).slice(0,this.$7(f[1]));case 126:return this.$1.groupBy(this.$7(f[0]),f[1]).forEach(function(a){d.$5[f[2]]=a;return d.$7(f[3])});case 127:return this.$7(f[0]).substr(this.$1.i64.to_int32(this.$7(f[1])),this.$1.i64.to_int32(this.$7(f[2])))}};return a}();g["default"]=a}),98);
__d("LSProgramTarget",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({DASM:1,JS:2,JSON:3});c=a;f["default"]=c}),66);
__d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE",["Env","TrustedTypes","err"],(function(a,b,c,d,e,f,g){"use strict";var h;d={createScript:function(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];d.forEach(function(a){if(typeof window!=="undefined"&&typeof window.trustedTypes!=="undefined"&&!window.trustedTypes.isScript(a))throw c("err")("Trusted Function requires TrustedScripts args only.")});var f=d.slice(0,-1).join(","),g=d.pop().toString();return"(function anonymous(\n     "+f+"\n     ) {\n     "+g+"\n     })"}};var i=c("TrustedTypes").createPolicy("unsafe-function-do-not-use",d);function b(){for(var b=arguments.length,d=new Array(b),e=0;e<b;e++)d[e]=arguments[e];if(c("TrustedTypes").isSupportedNatively()&&(h||(h=c("Env"))).useTrustedTypes){var f=i.createScript.apply(i,[""].concat(d));return a.eval(f)}else return babelHelpers.construct(Function,d)}g.TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE=i;g.createTrustedFunction=b}),98);
__d("LSDatascriptEvaluator",["FBLogger","LSDatascriptJSONEval","LSFactory","MWPBumpEntityKey","TrustedTypesNoOpPolicy_DO_NOT_USE","TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e=function(b){return function(c,d){var e;return a==null?void 0:(e=a.qe)==null?void 0:(e=e[c])==null?void 0:(c=e[b])==null?void 0:c[d]}},f=new Proxy({getBool:e("fb"),getNumber:e("fb"),getString:e("fb")},{get:function(a,b){return b in a?a[b]:{getBool:e(b),getNumber:e(b),getString:e(b)}}}),g=function(b){var c;return a==null?void 0:(c=a.gk)==null?void 0:c[b]};g.ig=function(b){var c;return a==null?void 0:(c=a.iggk)==null?void 0:c[b]};var h={getBool:function(b){var c;return a==null?void 0:(c=a.justknob)==null?void 0:c[b]}};return function(a){var e;e=d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE").createTrustedFunction((e=c("TrustedTypesNoOpPolicy_DO_NOT_USE")).createScript("gkx"),e.createScript("qex"),e.createScript("justknobx"),e.createScript("return "+b));return e(g,f,h)(c("LSFactory")(a,{dynamic:!0}))}}function i(a,b){var d=JSON.parse(b),e=(b=a)!=null?b:{gk:{},iggk:{},justknob:{},qe:{}};return function(a){return new(c("LSDatascriptJSONEval"))(d,c("LSFactory")(a,{dynamic:!0}),e).eval()}}function j(a,b,d){if(d==null){c("FBLogger")("lightspeed","null_target").mustfix("Received <null> target field for sync script!");return h(a,b)}switch(d){case 3:return i(a,b);case 2:return h(a,b);case 1:throw c("FBLogger")("messenger_web_product","invalid_sync_script_target").mustfixThrow("Received a sync script with LSProgramTarget of DASM, this should never happen!")}}function a(a){return function(b){if(b==null)throw c("FBLogger")("messenger_comet").mustfixThrow("Error creating eval function, db is undefined. This is likely a currying error in the definition for LSDatascriptEvaluator");return function(e){var g=e.experiments,h=e.priority,i=e.syncScript,k=e.target;e=e.taskNames;g=g!=null?JSON.parse(g):null;try{var l=j(g,i,k);return b.runInTransaction(function(b){a&&a();return l(b)},"readwrite",h,{taskNames:e,type:"sync_script"},f.id+":194")}catch(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform","eval_datascript_failure");c("FBLogger")("messenger_web_product").catching(a).mustfix("Error executing sync script");throw a}}}}a.__debugModuleName="LSDatascriptEvaluator";g.default=a}),98);
__d("LSDatascriptEvaluatorMaybeDeferred",["cr:6586"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:6586")}),98);
__d("LSTruncateTableAndSetShowError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(a){return b.forEach(b.db.table(115).fetch(),function(a){return a["delete"]()})},function(d){return c[0]=b.i64.of_float(Date.now()),b.db.table(115).add({statusId:b.i64.cast([0,0]),timestampMs:c[0],errorShouldBeShown:a[0]})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSConnectivityTruncateTableAndSetShowErrorStoredProcedure";e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatus",["LSTruncateTableAndSetShowError"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.forEach(c.db.table(114).fetch(),function(a){return a["delete"]()})},function(b){return d[0]=c.i64.of_float(Date.now()),c.db.table(114).add({statusId:void 0,timestampMs:d[0],internetConnectionState:a[0]})},function(d){return c.storedProcedure(b("LSTruncateTableAndSetShowError"),c.i64.neq(a[0],c.i64.cast([0,1])))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSConnectivityDeleteAllAndInsertConnectivityStatusStoredProcedure";e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatusStoredProcedure",["LSDeleteAllAndInsertConnectivityStatus","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.internetConnectionState;return c("LSDeleteAllAndInsertConnectivityStatus").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSSyncStoredProcedureUtils",["I64","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=c!=null?(h||(h=d("I64"))).of_float(Date.now()+c):b.minTimeToSyncTimestampMs;yield a.pending_tasks.put(babelHelpers["extends"]({},b,{failureCount:(h||(h=d("I64"))).add(b.failureCount,h.one),minTimeToSyncTimestampMs:c}))});return j.apply(this,arguments)}function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));if(b==null)return;return i(a,b,c)});return k.apply(this,arguments)}function c(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield a.network_requests.get(b,c));if(b==null)return;yield a.network_requests.put(babelHelpers["extends"]({},b,{failureCount:(h||(h=d("I64"))).add(b==null?void 0:b.failureCount,h.one)}))});return l.apply(this,arguments)}function e(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield a.network_requests.get(b,c));if(b==null)return;yield a.network_requests.put(babelHelpers["extends"]({},b,{epochId:void 0,networkTaskIdentifier:void 0}))});return m.apply(this,arguments)}g.incrementPendingTaskFailureCount=i;g.incrementPendingTasksTaskFailureCount=a;g.incrementNetworkRequestsTaskFailureCount=c;g.closeEpoch=e}),98);
__d("LSHandleTaskSendFailureForQueue2",["I64","LSSyncStoredProcedureUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){yield d("LSSyncStoredProcedureUtils").incrementPendingTasksTaskFailureCount(a,b,c),yield d("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(a,b,(h||(h=d("I64"))).neg_one),yield d("LSSyncStoredProcedureUtils").closeEpoch(a,b,h.neg_one)});return i.apply(this,arguments)}g["default"]=a}),98);
__d("LSHandleTaskSendSuccessForQueue2",["I64","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield a.network_requests.get(b,(h||(h=d("I64"))).neg_one));if(c==null||c.epochId==null)return;yield a.network_requests["delete"](b,h.neg_one)});return i.apply(this,arguments)}g["default"]=a}),98);
__d("LSPlatformDefaultUnderlyingApi",["Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return c("emptyFunction")}function d(){return(h||(h=b("Promise"))).resolve()}e={cleanup:c("emptyFunction"),onConnectionStatusChange:a,onReconnect:a,publish:d,subscribe:a};g["default"]=e}),98);
__d("LSPlatformDeviceId",["ChannelClientID","FBLogger","LSCookie","MqttWebDeviceID","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){if(c("gkx")("21118"))return c("MqttWebDeviceID").clientID;else return c("ChannelClientID").getID()}b=h();function a(a){a==null&&c("FBLogger")("messenger_browser_clients").info("Missed provider type for deviceId");return a==="persisted"?d("LSCookie").get().d:h()}g.deviceId=b;g.getDeviceIdForProviderType=a}),98);
__d("MessengerPWAVersionForUserAgent",["isMessengerPWA","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("justknobx")._("3005"))return void 0;var a=c("isMessengerPWA")();if(!a)return void 0;a=(a=new URL(window.location.href).searchParams.get("__pwa"))!=null?a:"1.0.0";return a}g["default"]=a}),98);
__d("LSPlatformRealtimeTransport",["I64","LSDynamicDependencies","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSShape","MessengerPWAVersionForUserAgent","Promise","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e="LSPlatformRealtimeTransport.NotConnected";var k="LSPlatformRealtimeTransport.Timeout";function l(a){var b=new Map();return{getAll:function(){return Array.from(b.values())},getOrStart:function(c){var d=c.toString(),e=b.get(d);e==null&&(e=a(c),b.set(d,e));return e}}}function m(){}function a(a,e,f){var g=new Map(),n={contents:m},o=new Set(),p=new Map(),q=[],r=l(function(b){b=a(b,f);q.push(b.subscribe(function(a){var b=JSON.parse(a),e=d("LSDynamicDependencies").downloadBootloaderDependencies(b.sp,b.nop,b.ntop);a=b.request_id;var f;if(a!=null){var h=g.get(a);h==null?f=!1:(c("clearTimeout")(h.timeoutId),h.resolve({downloadTask:e,payload:b,type:"taskresponse"}),g["delete"](a),f=!0)}else f=!1;if(!f){Array.from(p.entries()).forEach(function(a){return a[1](e,b)});return}}));q.push(b.onReconnect(function(){return n.contents()}));q.push(b.onConnectionStatusChange(function(a){o.forEach(function(b){return b(a)})}));return b});r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(d("LSMailboxInitialSyncCursor").syncChannel));return{cleanup:function(){q.forEach(function(a){return a()}),r.getAll().forEach(function(a){return a.cleanup()})},onConnectionStatusChange:function(a){o.add(a);return function(){o["delete"](a)}},onReconnect:function(a){n.contents=a;return function(){n.contents=m}},publish:function(a){var f=a.payload,l=a.queueName,m=a.requestId,n=a.syncChannel,o=a.type_;return new(h||(h=b("Promise")))(function(a,b){if((i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3))){var h=c("setTimeout")(function(){var a=g.get(m);a!=null&&(g["delete"](m),a.reject({RE_EXN_ID:k}));return b({RE_EXN_ID:k})},3e4);g.set(m,{queueName:l,reject:b,resolve:a,timeoutId:h,timestamp:Date.now()})}h=c("MessengerPWAVersionForUserAgent")();c("promiseDone")(r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(n)).publish(d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers["extends"]({app_id:e,payload:f},h!=null?{pwa_version:h}:{},{request_id:m,type:o}))),o),function(){if(!(i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3)))return a({type:"noresponseexpected"})},function(a){return b(a)})})},subscribeToNonTaskResponses:function(a){var b={};p.set(b,a);return function(){p["delete"](b)}}}}g.NotConnected=e;g.Timeout=k;g.LSPlatformRealtimeTransport=a}),98);
__d("shouldStubUnderlyingTransport",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return!(h||(h=c("ExecutionEnvironment"))).canUseDOM&&!(h||(h=c("ExecutionEnvironment"))).isInWorker}g["default"]=a}),98);
__d("LSPlatformMqttRealtimeTransport",["I64","LSIntEnum","LSPlatformDefaultUnderlyingApi","LSPlatformRealtimeTransport","Promise","promiseDone","shouldStubUnderlyingTransport"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){return[{payload:JSON.stringify({ls_fdid:"",ls_sv:a}),qos:1,topic:"/ls_app_settings"}]}function l(a){var e={contents:a.getConnectionState()},f={contents:function(){}},g={contents:new(j||(j=b("Promise")))(function(a,b){f.contents=a})},k={onMQTTStateChanged:function(a){a==="Connected"?f.contents():a==="Disconnected"&&e.contents==="Connected"&&(g.contents=new(j||(j=b("Promise")))(function(a,b){f.contents=a})),e.contents=a}};e.contents==="Connected"&&f.contents();a.subscribeChannelEvents(k);return[function(){a.unsubscribeChannelEvents(k)},function(e,f){return g.contents.then(function(){return new(j||(j=b("Promise")))(function(b,g){c("promiseDone")(a.publish("/ls_req",e,{listener:{onEvent:function(a){if(a==="NOT_CONNECTED")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").NotConnected})}},qos:(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(4))?0:1,skipBuffer:!1}),function(){return b()},function(a){if(a.message==="Publish Timed Out")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").Timeout});else return g(a)})})})}]}var m={contents:void 0};function a(a,b,d){if(c("shouldStubUnderlyingTransport")())return c("LSPlatformDefaultUnderlyingApi");var e=d.getInstance(b),f={getPublishMessages:function(){return k(a)}};e.registerExtraConnectPayloadProvider(f);var g={onMQTTStateChanged:function(a){var b=m.contents;if(b!=null)return b(a)}};e.subscribeChannelEvents(g);var h=e.subscribe("/ls_foreground_state",function(){});b=l(e);var i=b[0];b=b[1];return{cleanup:function(){e.unregisterExtraConnectPayloadProvider(f),d.shutdownAndClear(),e.unsubscribeChannelEvents(g),h(),i()},onConnectionStatusChange:function(a){m.contents=a;return function(){m.contents=void 0}},onReconnect:function(a){var b={contents:e.getConnectionState()},c={contents:b.contents==="Connected"},d={onMQTTStateChanged:function(d){d==="Connected"&&(c.contents&&b.contents!=="Connected"&&a(),c.contents=!0),b.contents=d}};e.subscribeChannelEvents(d);return function(){e.unsubscribeChannelEvents(d)}},publish:b,subscribe:function(a){return e.subscribe("/ls_resp",function(b){return a(b)})}}}g["default"]=a}),98);
__d("LSPlatformRequestId",[],(function(a,b,c,d,e,f){"use strict";var g=4;function a(){var a=g;g+=1;return a}b={generate:a};f["default"]=b}),66);
__d("LSPlatformRequestScheduler",["clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.requests=new Map()}var b=a.prototype;b.schedule=function(a,b,d){var e=this.requests.get(b);e!=null&&c("clearTimeout")(e);this.requests.set(b,c("setTimeout")(a,d))};b.cleanup=function(){this.requests.forEach(function(a){return c("clearTimeout")(a)})};return a}();g["default"]=a}),98);
__d("LSPlatformServerResponseHandler",["FBLogger","Promise","asyncToGeneratorRuntime","clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.eval=a,this.currentlyRunning=(h||(h=b("Promise"))).resolve()}var d=a.prototype;d.evalWhenReady=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var d=[];try{var e=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").mustfix("waited longer than 30 seconds to download dependencies")},3e4);d.push(e);yield a;c("clearTimeout")(e);a=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").mustfix("waited longer than 30 seconds to eval sync script")},3e4);d.push(a);yield this.eval(b);c("clearTimeout")(a)}catch(a){d.forEach(function(a){return c("clearTimeout")(a)}),c("FBLogger")("messenger_web_product").catching(a).mustfix("syncscript execution failed "+(a==null?void 0:a.message))}});function d(b,c){return a.apply(this,arguments)}return d}();d.evalInOrderReceived=function(a,b){var c=this,d=this.currentlyRunning.then(function(){return c.evalWhenReady(a,babelHelpers["extends"]({},b,{priority:"sync_script"}))});this.currentlyRunning=d;return d};return a}();g["default"]=a}),98);
__d("MWPBeginHandlingPendingTasksForQueue",["LSBeginHandlingFireForgetTasksForQueueStoredProcedure","LSBeginHandlingPendingTasksForQueue2","LSFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d){var e=d.fireAndForgetTask,g=d.ignoreSoftDelay,h=d.queueName;d=(yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(e===!0){var b=(yield c("LSBeginHandlingFireForgetTasksForQueueStoredProcedure")(c("LSFactory")(a),{queueName:h}));b=b[0];return[b]}return c("LSBeginHandlingPendingTasksForQueue2")(a,{ignoreSoftDelay:g,queueName:h})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":37"));return d});return h.apply(this,arguments)}g["default"]=a}),98);
__d("MWPlatformTaskUtils",["FBLogger","I64","JSScheduler","MetaConfig","Promise","ReQL","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,e){function f(){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield a(e)}catch(a){c("FBLogger")("messenger_web_product").catching(a).warn("Failed to calculate work for task queue %s",e.queueName)}});return g.apply(this,arguments)}if((j||(j=d("I64"))).gt(e.priority,(j||(j=d("I64"))).zero)&&c("MetaConfig")._("78")){var h=function(){f()};(i||(i=c("JSScheduler"))).scheduleLoggingPriCallback(h)}else c("promiseDone")(f())}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield a(b)}catch(a){c("FBLogger")("messenger_web_product").catching(a).warn("Failed to calculate work for fire forget queue %s",b.queueName)}});return m.apply(this,arguments)}function a(a,c){var e=new Set(),f=[],g=[];g.push(a.tables.pending_tasks.index("queueNameTaskId").subscribe(function(a,b){var c;if(b.operation==="delete"){e.add(a[0]);return}a=b.operation==="put"&&b.prevValue==null||b.operation==="add";c=b.operation==="put"&&(j||(j=d("I64"))).compare(b.value.failureCount,(c=(c=b.prevValue)==null?void 0:c.failureCount)!=null?c:(j||(j=d("I64"))).zero)>0;(a||c)&&e.add(b.value.queueName);(b.operation==="add"&&b.value.dataTraceId==null||b.value.dataTraceId==="")&&f.push(b.value)}));g.push(a.tables.network_requests.subscribe(function(a,b){a=a[0];if(a==="")return;b.operation==="delete"?e.add(a):b.value.epochId==null&&e.add(a)}));g.push(a.subscribeToCommit(function(){var g=Array.from(e);e.clear();f=[];g.forEach(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks.index("queueNameTaskId")).bounds({gte:[b]})));b!=null&&k(c,b)});return function(a){return e.apply(this,arguments)}}())}));return g}function e(a,e){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks))),c=new Set();for(b of b){if(c.has(b.queueName))continue;c.add(b.queueName);k(e,b)}})())}function n(a,e){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_fire_and_forget_tasks)));yield (h||(h=b("Promise"))).all(g.map(function(a){return l(e,a)}));c("promiseDone")(a.runInTransaction(function(a){return(h||(h=b("Promise"))).all(g.map(function(b){return a.pending_fire_and_forget_tasks["delete"](b.taskId)}))},"readwrite","background",void 0,f.id+":196"))})())}function o(a,b){var c=!1,d=[];d.push(a.tables.pending_fire_and_forget_tasks.subscribe(function(a,b){if(b.operation==="delete")return;a=b.operation==="put"&&b.prevValue==null||b.operation==="add";a&&(c=!0)}));d.push(a.subscribeToCommit(function(){c&&n(a,b),c=!1}));return d}g.checkQueuesWhenPendingTaskTableUpdates=a;g.checkAllPendingTasksForWork=e;g.checkAllFireForgetTasksForWork=n;g.checkQueuesWhenPendingFireForgetTaskTableUpdates=o}),98);
__d("LSPlatformTaskSystemTransport",["CurrentMessengerUser","FBLogger","I64","JSResourceForInteraction","JSScheduler","LSDatabaseProviderType","LSHandleTaskSendFailureForQueue2","LSHandleTaskSendSuccessForQueue2","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSShape","LSVec","MWPBeginHandlingPendingTasksForQueue","MWPBumpEntityKey","MWPlatformTaskUtils","Promise","ReQL","asyncToGeneratorRuntime","cr:4031","cr:6668","gkx","isInstamadillo","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=500,m=c("JSResourceForInteraction")("publishLSPlatformDeidentifiedPayload").__setRef("LSPlatformTaskSystemTransport"),n=new Set([632,765,60011,1006,1018].map(function(a){return a.toString()}));a=function(){function a(a,e,f,g){var h=this;this.key="ls";this.$8=!1;this.$18=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield c("MWPBeginHandlingPendingTasksForQueue")(h.$1,{ignoreSoftDelay:b,queueName:a}));for(a of b)yield h.$17(d("LSShape").toRecord(a))});return function(b,c){return a.apply(this,arguments)}}();this.$1=a;this.$2=e;this.$3=f;this.$4=g;this.$8=d("LSDatabaseProviderType").isProviderPersisted(a);this.$5=new(c("LSPlatformRequestScheduler"))();this.$6=new(c("LSPlatformServerResponseHandler"))(f);this.$7=this.$9();this.$10()}var e=a.prototype;e.$11=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!(c("gkx")("5962")||c("isInstamadillo")())){var d=(yield this.$2.publish(b));return d}d=a.filter(function(a){return a.label!=null&&n.has(a.label)});if(d.length<a.length){d.length>0&&c("FBLogger")("maw_ohai").mustfix("Deidentifed tasks label %s sent together with normal tasks",d[0].label);a=(yield this.$2.publish(b));return a}a=d[0];d=(yield m.load());d=(yield d(babelHelpers["extends"]({},b,{taskLabel:a.label})));return d});function d(b,c){return a.apply(this,arguments)}return d}();e.$12=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$1.runInTransaction(function(b){return c("LSHandleTaskSendFailureForQueue2")(b,a)},"readwrite",void 0,void 0,f.id+":153")});function d(b){return a.apply(this,arguments)}return d}();e.$13=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$1.runInTransaction(function(b){return c("LSHandleTaskSendSuccessForQueue2")(b,a)},"readwrite","background",void 0,f.id+":162")});function d(b){return a.apply(this,arguments)}return d}();e.$14=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=c("LSVec").toArray(a.tasks).slice(0).map(function(a){return d("LSShape").toRecord(a)});a=a[0];if(a==null)return;a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(this.$1.tables.pending_tasks).getKeyRange(a.task_id)));return a==null?void 0:a.dataTraceId});function e(b){return a.apply(this,arguments)}return e}();e.$15=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this;if(a.network_payload==null)return;var g=d("LSShape").toRecord(a.network_payload);(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return g&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(g.tasks))});var i=this.$4;try{yield (j||(j=b("Promise"))).all(c("LSVec").toArray(g.tasks).map(function(a){return d("LSShape").toRecord(a)}).map(function(b){var g=c("LSPlatformRequestId").generate();return f.$11([b],{payload:d("LSJson").stringify(d("LSShape").ofRecord({label:b.label,payload:b.payload,version:i})),queueName:a.queue_name,requestId:g,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel,type_:(h||(h=d("I64"))).of_int32(e)})}))}catch(a){}});function e(b,c){return a.apply(this,arguments)}return e}();e.$16=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(a.network_payload==null)return;var f=d("LSShape").toRecord(a.network_payload),g=c("LSVec").toArray(f.tasks).map(function(a){return d("LSShape").toRecord(a)}),j=(yield this.$14(f));(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(f.tasks))});var l=c("LSPlatformRequestId").generate(),m,n=c("qex")._("789");if(n!=null&&n!=="default"){var o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o)}try{m=(yield this.$11(g,{payload:d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers["extends"]({},f,{version_id:this.$4},j==null?{}:{data_trace_id:j}))),queueName:a.queue_name,requestId:l,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel,type_:(h||(h=d("I64"))).of_int32(e)}))}catch(b){if(n!=null&&n!=="default"){o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception");b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.notconnected")}b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected?(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_notconnected"),c("FBLogger")("messenger_web_product").warn("Publishing a task to the server not connected")):(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),c("FBLogger")("messenger_web_product").warn("Error while publishing a task for request: %s, error %s",e,JSON.stringify(b)));yield this.$12(a.queue_name)}if(m!=null&&m.type==="taskresponse")try{j=m.downloadTask;var p=m.payload;l={experiments:p.ex,sp:p.sp,syncScript:p.payload,target:p.target,taskNames:g.map(function(a){return a.label}).filter(Boolean)};this.$8?yield this.$6.evalWhenReady(j,l):yield this.$3(l);yield this.$13(a.queue_name);(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSent(f.tasks,p.payload))})}catch(b){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure"),c("FBLogger")("messenger_web_product").catching(b).mustfix("Encountered an error while processing a task response via realtime transport"),yield this.$12(a.queue_name)}});function e(b,c){return a.apply(this,arguments)}return e}();e.decideWhatToDoWithTask=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h=this,i=(yield c("MWPBeginHandlingPendingTasksForQueue")(a,{fireAndForgetTask:g,ignoreSoftDelay:!1,queueName:e,transportKey:f}));c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){for(var a of i)yield h.$17(d("LSShape").toRecord(a))})())});function e(b,c,d,e){return a.apply(this,arguments)}return e}();e.$17=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this.$5,f=this.$18;function g(a,b){e.schedule(function(){c("promiseDone")(f(a,!1))},a,b!=null?(h||(h=d("I64"))).to_float(b):l)}var i=(h||(h=d("I64"))).to_int32(a.work_item_type);switch(i){case 1:yield this.$16(a,3);break;case 5:yield this.$15(a,4);break;case 3:g(a.queue_name,a.next_sync_ms);break;case 2:yield b("cr:4031").handleLSWork(this.$1,a,d("CurrentMessengerUser").getAccountID());break;case 4:break;default:c("FBLogger")("messenger_web_product").warn("Unknown Task type of %s",i)}});function e(b){return a.apply(this,arguments)}return e}();e.$9=function(){var a=this,e=this.$1;return this.$2.onReconnect(function(){c("promiseDone")(e.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.network_requests).bounds({gte:d("ReQL").key("")})));yield (j||(j=b("Promise"))).all(e.map(function(b){b=b.taskQueueName;return c("LSHandleTaskSendFailureForQueue2")(a,b)}))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":467")),a.$10()})};e.$10=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.decideWhatToDoWithTask(a.$1,b)})};e.cleanup=function(){this.$7()};return a}();g["default"]=a}),98);
__d("LSVersion",[],(function(a,b,c,d,e,f){e.exports="8324586924293706"}),null);
__d("MWPExecuteTaskBridge",["FBLogger","QuickPerformanceLogger","cr:6551"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,d,e){var f=d.event,g=d.taskID;(h||(h=c("QuickPerformanceLogger"))).markerPoint(f,"execute_task_through_bridge",{instanceKey:g});if(b("cr:6551")==null||b("cr:6551")[e]==null){(h||(h=c("QuickPerformanceLogger"))).markerPoint(f,"handler_not_found",{instanceKey:g});throw c("FBLogger")("ls_web_init").mustfixThrow("No bridge task handler found for %s",e)}h.markerPoint(f,"bridge_api_call",{instanceKey:g});return b("cr:6551")[e](a,d)}g.executeTask=a}),98);
__d("MWPHandleNativeTaskBatched",["FBLogger","I64","LSHandleTaskSendSuccessForQueue2","LSJson","LSShape","LSSyncStoredProcedureUtils","LSVec","MWPExecuteTaskBridge","Promise","QuickPerformanceLogger","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=new Set();function l(a){try{var b=a.payload!==""?d("LSJson").parse(a.payload):"";return b}catch(b){throw c("FBLogger")("ls_web_init").catching(b).mustfix("parseLSTaskReqType: Error parsing native task payload for queue: %s, falling back to null payload",a.queue_name)}}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g){if(k.has((j||(j=d("I64"))).to_string(e.task_id))){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: Task is already being processed, skipping");return(i||(i=b("Promise"))).resolve()}k.add((j||(j=d("I64"))).to_string(e.task_id));var m=j.to_float(e.task_id),n=c("qpl")._(164763515,"1216");(h||(h=c("QuickPerformanceLogger"))).markerStart(n,m);if(e.label==null){c("FBLogger")("ls_web_init").warn("MWPHandleNativeTask: Cannot find a handler for task if task label is empty");(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"null_task_label",{instanceKey:m});h.markerEnd(n,3,m);k["delete"]((j||(j=d("I64"))).to_string(e.task_id));return a.runInTransaction(function(a){return a.pending_tasks["delete"](e.task_id)},"readwrite",void 0,void 0,f.id+":81")}var o;try{(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"parse_task",{instanceKey:m}),o=l(e)}catch(a){(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"parse_task_failed",{instanceKey:m});c("FBLogger")("ls_web_init").catching(a);k["delete"]((j||(j=d("I64"))).to_string(e.task_id));return}var p=e.label;h.markerAnnotate(n,{string:{source:"MWPHandleNativeTaskBatched_handleTask",taskName:p}},{instanceKey:m});try{(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"task_execute",{instanceKey:m}),yield d("MWPExecuteTaskBridge").executeTask(o,{actorID:g,event:n,source:"MWPHandleNativeTaskBatched_handleTask",taskID:(j||(j=d("I64"))).to_float(e.task_id)},p),yield a.runInTransaction(function(a){return a.pending_tasks["delete"](e.task_id)},"readwrite",void 0,void 0,f.id+":130"),h.markerEnd(n,2,m)}catch(g){yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield a.pending_tasks.get(e.task_id));if(b!=null)return d("LSSyncStoredProcedureUtils").incrementPendingTaskFailureCount(a,b)});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":141"),(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"task_execute_failed",{instanceKey:m}),h.markerEnd(n,3,m),c("FBLogger")("ls_web_init").catching(g).mustfix("Error handling native task for %s.",e.label)}k["delete"](j.to_string(e.task_id))});return n.apply(this,arguments)}function a(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g){var h=e.network_payload,k=e.queue_name;if(h==null){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: network_payload is empty, there's nothing to handle");return(i||(i=b("Promise"))).resolve()}e=d("LSShape").toRecord(h);h=c("LSVec").toArray(e.tasks).map(function(a){return d("LSShape").toRecord(a)});e=h.map(function(b){return m(a,b,g)});try{yield (i||(i=b("Promise"))).all(e),yield a.runInTransaction(function(a){return c("LSHandleTaskSendSuccessForQueue2")(a,k)},"readwrite",void 0,void 0,f.id+":184")}catch(e){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: tasks network_payload is empty, there's nothing to handle",k);try{yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(a,k,(j||(j=d("I64"))).neg_one),yield d("LSSyncStoredProcedureUtils").closeEpoch(a,k,j.neg_one)});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":194")}catch(a){c("FBLogger")("ls_web_init").catching(a).mustfix("Error bumping failure cound for task")}}});return o.apply(this,arguments)}e={handleLSWork:a};g["default"]=e}),98);
__d("MWPlatformTaskSystem",["LSPlatformRequestScheduler","MWPlatformTaskUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var e=this;this.$1=a;this.$2=b;this.$3=new(c("LSPlatformRequestScheduler"))();this.$4=d("MWPlatformTaskUtils").checkQueuesWhenPendingTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!1)});this.$5=d("MWPlatformTaskUtils").checkQueuesWhenPendingFireForgetTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!0)});this.$7()}var e=a.prototype;e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){yield this.$2.decideWhatToDoWithTask(a,b,c,d)});function c(b,c,d,e){return a.apply(this,arguments)}return c}();e.$7=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.$6(a.$1,b)})};e.cleanup=function(){this.$4.forEach(function(a){return a()}),this.$5.forEach(function(a){return a()}),this.$2.cleanup()};return a}();g["default"]=a}),98);
__d("getMWLSRegion",["MessengerWebRegion"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("MessengerWebRegion").regionNullable;return a==null?"":a}g["default"]=a}),98);